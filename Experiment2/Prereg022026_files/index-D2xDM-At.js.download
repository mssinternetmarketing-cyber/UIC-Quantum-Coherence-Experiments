const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/agent-B1e4Y2EN.js","assets/platform-core-CCXsg5iG.js","assets/vendors-FW5_21_J.js","assets/vite-CuyfC2og.js","assets/ThreadLossAversionModal-DnFAwuB3.js","assets/i18n-084bMT3r.js","assets/lexical-BJvXVOX6.js","assets/aether-core-BKq382E5.js","assets/pplx-icons-Do6_ClXf.js","assets/platform-components-DOCPZLUU.js","assets/LoginModalInner-CQLfIPzU.js","assets/test-ids-eafHCGHU.js","assets/react-query-r7hDIr5f.js","assets/experimentation-DuO6IR7g.js","assets/pplx-stream-p3v_-k4d.js","assets/framer-motion-DPh1AsEA.js","assets/mapbox-gl-D_rkT3p_.js","assets/mapbox-gl-B9eh9OLo.css","assets/KeyboardShortcutHelperModal-DBQnfvFa.js","assets/KeyboardShortcutEditorModal-CrZspFKL.js","assets/AskPermissionsModal-B9JzJF4Y.js","assets/DebugStreamSideEffects-DY4_yPON.js","assets/_restricted/restricted-feature-debug-Bs-dEIow.js","assets/SideCanvasViewer-lneT7Z7B.js","assets/useVersioningChain-yTE8-6AJ.js","assets/GeneratedMediaLoader-DyySFTVa.js","assets/useTrackGeneratedAssetView-D9WAb6Wp.js","assets/ImageDisplayAsset-CXcakhkU.js","assets/PDFViewerCore-CTseoe6M.js","assets/SideContentBody-oR2yrmsv.js","assets/SideMeetingTranscriptViewer-D_HJkdHn.js","assets/SidePDFViewer-DiJztL-X.js","assets/CitationSideSheet-CBfndkT_.js","assets/CheckSourcesSideSheet-DW1Guulu.js","assets/CitationCard-CZLLz0Tr.js","assets/TextBlockThrobber-DZnh-_QW.js","assets/YoutubeVideoPlayer-D03uUwmc.js","assets/InlineNavSideSheet-C8fWd6Wt.js","assets/CouncilResponseSideSheet-B2hciwoB.js","assets/ClaimsSideSheet-tDwNVSug.js","assets/DebugModeActivator-Di8Qveoa.js","assets/IncentiveProModal-CU3Nq6F3.js","assets/BraintreeSubscriptionModal-CYzJQayA.js","assets/billingKeys-F8gCkGhi.js","assets/MobileSidebar-BlLqXRpg.js","assets/MobileProductHeader-CyOpNu6b.js","assets/useSingularAttributionAppLink-DKkKWiRb.js","assets/LightboxImage-ChKrknSo.js","assets/LoginModal-D844be60.js","assets/SheetModal-BPiTb1d-.js","assets/PricingTableModal-CR8v5BmB.js","assets/billingUtils-DGT_5UET.js","assets/TierCardLayoutRedesign-CHo3LsJO.js","assets/useProFeatures-CMnmAk9R.js","assets/MarkSpinner-DLLsyHlp.js","assets/ConnectorsEnableModal-CgjIAa3C.js","assets/capabilities-DQHE0spj.js","assets/index-C8ZFoyX1.js","assets/MicrosoftFilePickerModal-DttNydhV.js","assets/SharepointSiteSelector-F3-cK0WA.js","assets/BoxFilePickerModal-2oMi1nLX.js","assets/VoiceToVoiceModal-DrSEcaaa.js","assets/useRealtimeVoice-DkUzTpyw.js","assets/useOaiRealtimeSettings-e_UpuPPg.js","assets/three-S-EeQeNm.js","assets/Shimmer-CxIrQ7-E.js","assets/SharepointSiteModal-DYOamkU6.js","assets/PremiumSourceLimitWarning-CdpRAkkh.js","assets/ShortcutModal-zDWxcyzt.js","assets/FormButton-DcwxXtil.js","assets/SearchInputNote-0woq8JZT.js","assets/InstallGateModal-DA6CfkbM.js","assets/CometDownloadInstructionsModal-B8VLx4dz.js","assets/handleProUpgrade-BzRmY-Kb.js","assets/handleSubscriptionPromo-CdEEQWrR.js","assets/handleOpenSheerIdModal-Cm59Hzah.js","assets/handleSkipBrowserAgent-hWsQ-4j7.js","assets/handleAllowBrowserAgentOnce-C2R7EOw7.js","assets/handleAlwaysAllowBrowserAgent-Dd8yjd0N.js","assets/handleContinueGeneration-exAr5NNb.js","assets/handleNoCanvasGeneration-Bc7PhS-h.js","assets/handleConnector-BSiqlsHl.js","assets/handleVirtualTryOnOnboardingModal-C308psHV.js","assets/shoppingKeys-B7duZgnz.js","assets/handleCometDownload1moProIncentive-CDtmcmKh.js","assets/handleRewriteAnswer-DJYG4ncE.js","assets/handlePermalink-DofSHsTF.js","assets/handleShortcutModal-Bho8zyV_.js","assets/handleToggleSources-NP36f6I8.js","assets/handleFullscreenModal-DcZOR8Sx.js","assets/handleTryFinanceAgent-DVjRbwOp.js","assets/SheerIDModal-CqLi5A1L.js","assets/pptxgen.es-CkA_NdID.js","assets/abap-CV_jZxTX.js","assets/abnf-BNCUoIkk.js","assets/actionscript-DdUEzyyr.js","assets/ada-CTM-i5br.js","assets/agda-D_HlvG7B.js","assets/al-CcC_DmeJ.js","assets/antlr4-C2Vn_Adw.js","assets/apacheconf-9VSZeI3x.js","assets/apex-CUQS8Pv9.js","assets/sql-CJATM1Qp.js","assets/apl-BiCRFlD6.js","assets/applescript-OsGDhAtr.js","assets/aql-K9UbBa_q.js","assets/arduino-knV3L13X.js","assets/cpp-BdJVwJpi.js","assets/c-kgVuzdLE.js","assets/arff-DXUc2Eem.js","assets/asciidoc-CJYHfSxT.js","assets/asm6502-Caqb35Na.js","assets/asmatmel-VSfemE38.js","assets/aspnet-PIXTPjK_.js","assets/csharp-Cd5Udg29.js","assets/autohotkey-Bd9dI61G.js","assets/autoit-BVeczYLs.js","assets/avisynth-BXrDhGWF.js","assets/avro-idl-BeGCdlLL.js","assets/bash-D9E8VlyO.js","assets/bash-CefCgV5_.js","assets/basic-C-qkbcWC.js","assets/basic-DBS9NaGG.js","assets/batch-D4G4oL2k.js","assets/bbcode-Dr1_GsJW.js","assets/bicep-Ckzj3k4Z.js","assets/birb-BwnkZWxs.js","assets/bison-C2M86P-f.js","assets/bnf-CqwJKlBf.js","assets/brainfuck-Cx-H0WXM.js","assets/brightscript-Dkm0arzU.js","assets/bro-Zr6TMavl.js","assets/bsl-BzTcwED9.js","assets/c-WH3bxsh3.js","assets/cfscript-BKVF-A9i.js","assets/chaiscript-CNz1Wl1d.js","assets/cil-C5Je8XVP.js","assets/clike-bg8nIv-l.js","assets/clike-B5tY_8Hg.js","assets/clojure-2qo_QJyk.js","assets/cmake-BaC7L8Yb.js","assets/cobol-CR-Up98c.js","assets/coffeescript-CatKqQn0.js","assets/concurnas-BhxsU0iU.js","assets/coq-DDgTrepg.js","assets/cpp-uXx8-CtQ.js","assets/crystal-CLBDhWRh.js","assets/ruby-DYsn9XfW.js","assets/csharp-DK-q69Vy.js","assets/cshtml-BO2XSvP7.js","assets/csp-Br7inWip.js","assets/css-extras-CVdypllm.js","assets/css-CCv4Vvbj.js","assets/css-CF9HHZb0.js","assets/csv-DDvLlsBd.js","assets/cypher-A2WkqKYS.js","assets/d-BGbfCRwr.js","assets/dart-CEB81Eae.js","assets/dataweave-BPafolc3.js","assets/dax-DpZF3oAd.js","assets/dhall-BLY5QCMc.js","assets/diff-D3mz30LW.js","assets/django-BP9dodSq.js","assets/markup-templating-BxAVv-bL.js","assets/dns-zone-file-_gEcm3FV.js","assets/docker-CzkAZtAp.js","assets/dot-CbTX0-fD.js","assets/ebnf-kgD1jvUL.js","assets/editorconfig-Dw1XnYyJ.js","assets/eiffel-CIyXigIg.js","assets/ejs-kmWvBa-6.js","assets/elixir-oJr7Moz8.js","assets/elm-BExmsuAD.js","assets/erb-DewsE-eh.js","assets/erlang-Dl84d_GC.js","assets/etlua-BlFFdw1J.js","assets/lua-DER4jxlW.js","assets/excel-formula-CPfdXlSY.js","assets/factor-qtUheGqr.js","assets/false-AcwZMSiq.js","assets/firestore-security-rules-CAXGufIy.js","assets/flow-CJflD3qb.js","assets/fortran-DmPpmt9u.js","assets/fsharp-BIYb3od7.js","assets/ftl-Bom-ReFh.js","assets/gap-B7m9c5lB.js","assets/gcode-kdC4es4O.js","assets/gdscript-B-svtcyR.js","assets/gedcom-BTUQAqsw.js","assets/gherkin-DDhx_uCX.js","assets/git-Fkz6o5kn.js","assets/glsl-CtvMG-8S.js","assets/gml-KLPn_axH.js","assets/gn-DhXMFt-Q.js","assets/go-module-CnQOt6kc.js","assets/go-CfpLUIjY.js","assets/graphql-gOFq8Hac.js","assets/groovy-BnRYVI6f.js","assets/haml-DO6fnXAU.js","assets/handlebars-Bvrg2NBv.js","assets/haskell-D45DX1u8.js","assets/haskell-Ds42Eazu.js","assets/haxe-Cz3QrPur.js","assets/hcl-Db2WVuK0.js","assets/hlsl-Cbarunv7.js","assets/hoon-BOzlMsoN.js","assets/hpkp-Z5YRa4oO.js","assets/hsts-DMP3JxNs.js","assets/http-CcBBDd2v.js","assets/ichigojam-D64jJrmw.js","assets/icon-BXMTiB0w.js","assets/icu-message-format-B0jFFGtY.js","assets/idris-DWqAIgN5.js","assets/iecst-Dk4U_4hp.js","assets/ignore-BjREke3F.js","assets/inform7-C7JfYvbO.js","assets/ini-DQrtzM4N.js","assets/io-CEhyiSAi.js","assets/j-sND6E-Fv.js","assets/java-AlF4DDxv.js","assets/java-BxMbkJZ_.js","assets/javadoc-DCJd648D.js","assets/javadoclike-myFApC35.js","assets/javadoclike-mkbO3bPU.js","assets/javascript-D8bdPg1W.js","assets/javascript-D8vYUPHd.js","assets/javastacktrace-BEiLvDTS.js","assets/jexl-Dq4zu3re.js","assets/jolie-DjhI3vQU.js","assets/jq-y0r6UCve.js","assets/js-extras-DdatupRI.js","assets/js-templates-APDQyqwU.js","assets/jsdoc-BMVln0UX.js","assets/typescript-CVO-8GEc.js","assets/json-C7Wvd00g.js","assets/json-BESjz4hO.js","assets/json5-BQ5OVqFd.js","assets/jsonp-DfmK3tRq.js","assets/jsstacktrace-BBS1miGe.js","assets/jsx-BxB5tBSS.js","assets/jsx-CWP8P1mH.js","assets/julia-DCL-sAv1.js","assets/keepalived-BFp4U2_j.js","assets/keyman-4ZK3jXee.js","assets/kotlin-CidT3Rzf.js","assets/kumir-DbpomxFH.js","assets/kusto--6s5VHR2.js","assets/latex-BZQc13NX.js","assets/latte-z4KihdSk.js","assets/php-iTdQntIy.js","assets/less-B1nWgZ8O.js","assets/lilypond-OOO7fNYk.js","assets/scheme-Cscf027c.js","assets/liquid-C8yOnRY0.js","assets/lisp-B3YmGbJF.js","assets/livescript-k3PXwrYF.js","assets/llvm-BayiUiwb.js","assets/log-D4oxAYRq.js","assets/lolcode-DfQcoIRB.js","assets/lua-BdyWVstu.js","assets/magma-BJgzmzVs.js","assets/makefile-BquElOXz.js","assets/markdown-BmtxS9dB.js","assets/markup-templating-MEHSfNjy.js","assets/markup-8ym62eBH.js","assets/markup-BONeskWm.js","assets/matlab-BZznJhFy.js","assets/maxscript-BoGzeP8k.js","assets/mel-SamOtde0.js","assets/mermaid-Cq1MtmYJ.js","assets/mizar-BHYUy01O.js","assets/mongodb-BLKRbM_W.js","assets/monkey-DDmZoEhP.js","assets/moonscript-C868Mi3v.js","assets/n1ql-CULzL9-T.js","assets/n4js-Cncz5RGN.js","assets/nand2tetris-hdl-Dm8FfwIa.js","assets/naniscript-d_OiyB-B.js","assets/nasm-mcIS3oz5.js","assets/neon-KPyUR1lL.js","assets/nevod-DPSJqefp.js","assets/nginx-Bh_l73tE.js","assets/nim-B3zgzJyb.js","assets/nix-BtTqvbOI.js","assets/nsis-BrX2QPAG.js","assets/objectivec-Cp4zpXKb.js","assets/ocaml-BytkBRnR.js","assets/opencl-Bm65caux.js","assets/openqasm-BxubsiVs.js","assets/oz-DKdg3vYN.js","assets/parigp-Diy6_xFh.js","assets/parser-C6OhS-v2.js","assets/pascal-BqGKDRCT.js","assets/pascaligo-CmtW8IQx.js","assets/pcaxis-ClLKj7xJ.js","assets/peoplecode-IXrNW5jZ.js","assets/perl-Bx3Alua_.js","assets/php-extras-B6CicCBq.js","assets/php-z0EdG6WV.js","assets/phpdoc-DBJXm2Vv.js","assets/plsql-Si0y6O4D.js","assets/powerquery--sGMe_kf.js","assets/powershell-D_yLhDJY.js","assets/processing-CrQy10cW.js","assets/prolog-D2jFgB0n.js","assets/promql-CrZPKxvU.js","assets/properties-D6pZXLPx.js","assets/protobuf-ZXfFCGcu.js","assets/psl-C386MmW5.js","assets/pug-bZC2AKHn.js","assets/puppet-CqAggpEE.js","assets/pure-kS1_fNk2.js","assets/purebasic-BfcvRshi.js","assets/purescript-BfcMXDuj.js","assets/python-DSvE31xq.js","assets/q-DeDIpVbE.js","assets/qml-DFWwROYn.js","assets/qore-CP5ZUe60.js","assets/qsharp-B20Vmn28.js","assets/r-D15T8WxR.js","assets/racket-D10txZAJ.js","assets/reason-6ANFUMu6.js","assets/regex-5Q_CxBSL.js","assets/rego-C_py_8jh.js","assets/renpy-Jf0u-xhA.js","assets/rest-DR5n3nNA.js","assets/rip-CBz-xDhl.js","assets/roboconf-CP23M5ej.js","assets/robotframework-GtZKJarU.js","assets/ruby-CcBPo7Jy.js","assets/rust-C-Oi6wFX.js","assets/sas-BuvlhEUw.js","assets/sass-3cExDpeK.js","assets/scala-BhR1Bt8C.js","assets/scheme-Bi_suX5X.js","assets/scss-61yBGSQ7.js","assets/shell-session-BBGAi-UP.js","assets/smali-Yz_2llmC.js","assets/smalltalk-DTs1iMH7.js","assets/smarty-ClvO9UTI.js","assets/sml-CcDK_1J6.js","assets/solidity-BDCwOulF.js","assets/solution-file-BtnOKdXg.js","assets/soy---ubiTwB.js","assets/sparql-ZoExV8Jl.js","assets/turtle-Ro1R6Je7.js","assets/splunk-spl-iRzlUe8w.js","assets/sqf-CJ2QA-ii.js","assets/sql-Sn6gvY4u.js","assets/squirrel-sSA_31vm.js","assets/stan-DxPzeVp4.js","assets/stylus-Y923euvO.js","assets/swift-Bb-oPOvD.js","assets/systemd-BCxsgci2.js","assets/t4-cs-DA7j0B_A.js","assets/t4-templating-B5EzSFYT.js","assets/t4-templating-BHHNbRso.js","assets/t4-vb---CsqfA0.js","assets/vbnet-BhrUc4aD.js","assets/tap-hjaObkRg.js","assets/yaml-pHjxJgpq.js","assets/tcl-BGu_P4hh.js","assets/textile-yzL6lAdU.js","assets/toml-C_zmuUNJ.js","assets/tremor-B2P1CaNJ.js","assets/tsx-CrAqIHZR.js","assets/tt2-BIhy1o3M.js","assets/turtle-BpiUfkQV.js","assets/twig-Bj46vbhb.js","assets/typescript-CcuCeyZ9.js","assets/typoscript-XVddiCoS.js","assets/unrealscript-CTdn5ouP.js","assets/uorazor-XVi1cswe.js","assets/uri-kkDNgWls.js","assets/v-BdmvWAaf.js","assets/vala-DhMt_hFC.js","assets/vbnet-Bfsm6Ky5.js","assets/velocity-ZXeY-Xjt.js","assets/verilog-DMJx1jeI.js","assets/vhdl-HO1_F4N6.js","assets/vim-Bq6xuz33.js","assets/visual-basic-xUFbJrMu.js","assets/warpscript-CTI-0qmZ.js","assets/wasm-apYZgrxE.js","assets/web-idl-CvuW1Ax4.js","assets/wiki-CDqCKzvk.js","assets/wolfram-lt6nI2d0.js","assets/wren-C5o3abeY.js","assets/xeora-CWjUBVNJ.js","assets/xml-doc-CqNWXjka.js","assets/xojo-DKDCIMmn.js","assets/xquery-PrYwilw_.js","assets/yaml-MSoHumpO.js","assets/yang-DVR1haGh.js","assets/zig-Bc_at87R.js","assets/core-DmbpZ4qJ.js","assets/CitationModal-CGYEHO-8.js","assets/GroupedCitationModal-DcJKqD2v.js","assets/TranslationModal-CH3pf6i5.js","assets/MemorySearchHistoryModal-WAvgBTO8.js","assets/index-Dp4gHirK.js","assets/katex-CmGQIWW6.js","assets/katex-DIrX_gBg.css","assets/AnimatedWorkflowHeader-B4RfOQVC.js","assets/ProgressHeader-CAcQEW3W.js","assets/Workflow-DWWtrH4d.js","assets/DebugEntry-DTApjprN.js","assets/useIsDebugMode-Dz363xwg.js","assets/AutomationModal-B7SFpMBA.js","assets/WatchlistModal-C6GPcFrF.js","assets/FinanceScreenshotBuilderModal-ByyGGf9n.js","assets/CitationListModal-4_bfX56k.js","assets/Checkbox-DY_vaYNW.js","assets/HealthOnboardingWidget-CffHUyMh.js","assets/_restricted/restricted-feature-health-DZ59kLle.js","assets/FinanceAlertModal-DkAOOJtP.js","assets/TaskModal-CZD7FuAm.js","assets/HourlyTemperature-UbN4UZMf.js","assets/LocationPermissionModal-D1sgKLhz.js","assets/index-DN6-kW0Y.js","assets/RestaurantBookingModal-DPm2cGhs.js","assets/PlaceModal-C7O6zn12.js","assets/EntityItemImageFadeCarousel-DGbo7aae.js","assets/EntityItemImage-DO69KBGv.js","assets/EntityItemSourcePile-CRx9pJzx.js","assets/ThreadEntryFooter-Dpx0Skt6.js","assets/StructuredAnswerInlineBlock-CT52cBqB.js","assets/imageConfig-DnHx7cy4.js","assets/CarouselPrimitives-Zlec_JcR.js","assets/shared-CE9u5XMA.js","assets/useInViewEffect-C3zA_dXG.js","assets/useFailedImagesStore-BapUvHkL.js","assets/EntityItemMerchantInfo-x3OPc17F.js","assets/TimeAgoTooltip-Dvp-Pz6A.js","assets/useUpdateThreadAccess-Ba_KZxEZ.js","assets/RelatedContent-CAAdYSPE.js","assets/ThreadContentResponse-DxK0IFrj.js","assets/react-stripe.esm-0eNlqULP.js","assets/useStripePromise-Dsr5x7bN.js","assets/SideBySideThreadContent-BXNO2P88.js","assets/ThreadEntryDebugTiming-BiuqRejy.js","assets/DebugModal-SWCju8ge.js","assets/ShoppingMode-tje89tdY.js","assets/useGenerativeRefinement-DO4zVV2i.js","assets/ModesNullState-CA9idFV7.js","assets/HotelsMode-CzIPWpIY.js","assets/SharedAnswerModeMap-Bhzc3TAE.js","assets/JobsMode-npdb6dOb.js","assets/VideosMode-CKc6Iaqh.js","assets/useMediaSearch-Dqy9B3Hb.js","assets/ImagesMode-BjiOYSqW.js","assets/MapsMode-BCR9o3qH.js","assets/AssetsMode-BKyKnJvi.js","assets/NewsMode-2OJMnSwJ.js","assets/VoiceToVoiceContent-gCSq5tF8.js"])))=>i.map(i=>d[i]);
import{R as A,r as f,j as l,x as vi,i as Ff,v as X9,m as $g,z as I5,A as bq,B as _q,n as jr,c as z,d as Wg,e as jC,C as Z9,D as vq,t as PC,E as fs,F as jh,G as Cq,H as Uf,I as Bf,g as wq,J as Sc,K as Sq}from"./vendors-FW5_21_J.js";import{_ as W,g as ha,c as gc,a as Hf}from"./vite-CuyfC2og.js";import{r as Bt,u as je,g as _s,G as Eq,k as nn,H as j5,I as kq,J as J9,q as yt,s as ve,K as Ct,l as Z,$ as Va,M as sr,e as St,N as hn,O as Is,Q as eN,f as mi,h as Jt,y as du,T as Mq,U as Tq,V as Aq,W as Kg,X as Nq,d as Ci,c as tN,Y as Pe,A as hs,R as Fn,Z as vs,a as Ue,_ as wi,a0 as Rq,a1 as Dq,a2 as nN,a3 as fu,a4 as pi,x as Iq,S as Za,a5 as ko,E as _e,a6 as xn,b as rN,o as jq,a7 as Pq,a8 as Oq,a9 as Lq,aa as Fq,ab as Uq,ac as Bq,ad as Mo,ae as Hq,af as Vq,ag as Gq,ah as zq,ai as qq,aj as P5,ak as O5,al as $q,am as Wq,an as L5,ao as F5,ap as sN,aq as Kq,ar as ys,L as Dt,as as Yg,at as Qg,au as Xr,av as OC,aw as aN,ax as oN,ay as LC,az as mu,aA as iN,aB as U5,aC as Pd,aD as R2,aE as Ex,aF as Yq,aG as Qq,aH as Xq,aI as El,aJ as Zq,aK as Ph,aL as lN,aM as cN,aN as uN,aO as Jq,aP as $i,aQ as dN,aR as e$,aS as t$,aT as $r,n as fN,aU as Vf,aV as kl,aW as mN,aX as FC,aY as n$,aZ as r$,a_ as s$,a$,b0 as o$,b1 as i$,b2 as l$,b3 as c$,b4 as u$,b5 as np,F as d$,P as pN,b6 as f$,b7 as B5,b8 as H5,b9 as m$,ba as p$,bb as h$}from"./platform-core-CCXsg5iG.js";import{S as To,I as _n,g as Ml,c as pu,e as ri,P as Hn,j as hu,f as qn,X as hN,Y as g$,Z as y$,B as at,i as Xg,R as gN,A as UC,k as yN,n as xN,b as gu,D as bN,C as _N,d as x$,v as Gf,_ as b$,$ as _$,p as Tl,T as wn,o as vN,L as Al,q as Ls,r as Zg,a0 as v$,s as C$,u as Cs,a1 as CN,l as of,U as w$,H as S$,N as E$,J as k$,O as M$,t as V5,W as T$}from"./aether-core-BKq382E5.js";import{i as mn,u as Lt,a as BC,g as ul,b as js,c as Si,C as Xo,d as wN,e as G5,D as SN,f as A$,h as N$,j as R$,s as HC,k as kx,l as D$,m as I$,n as j$,E as P$,t as si,o as O$,p as L$,q as F$,r as U$,v as B$,w as Xu,x as H$,y as Nl,z as V$,A as Od,B as EN,F as G$,G as kN,H as VC,I as z$,J as q$,K as Oh,L as $$,M as W$,N as GC,O as MN,P as zC}from"./experimentation-DuO6IR7g.js";import{A as Yr,u as Kt,M as Ke,P as yu,B as Y,T as B,a as pt,g as wo,b as qC,c as xu,I as $C,R as WC,d as Qe,h as K$,e as Y$,f as Q$,F as X$,i as Z$,S as z5,j as st,k as TN,D as bu,l as AN,m as Md,n as NN,o as RN,p as J$,q as eW,r as tW,s as dl,t as DN,v as Zu,w as Mx,x as Xl,U as Ju,_ as q5,y as ed,$ as va,z as Ca,C as $5,E as W5,G as K5,H as Tx,J as Ax,K as lo,L as nW,N as rW,O as sW,Q as aW,V as Y5,W as oW,X as Q5,Y as X5,Z as Z5,a0 as td,a1 as J5,a2 as ek,a3 as iW,a4 as lW,a5 as cW,a6 as tk,a7 as nk,a8 as uW,a9 as dW,aa as fW,ab as mW,ac as pW,ad as hW,ae as gW,af as yW,ag as xW,ah as bW,ai as _W,aj as vW,ak as CW,al as wW,am as SW,an as EW,ao as Td,ap as KC,aq as zf,ar as kW,as as MW,at as TW,au as AW,av as NW,aw as RW,ax as DW,ay as Nx,az as IN,aA as IW,aB as jW,aC as PW,aD as OW}from"./lexical-BJvXVOX6.js";import{u as jn,i as jN,a as Be,r as oa,c as Jg,b as YC,E as ar,d as LW,e as FW,G as UW,R as BW}from"./platform-components-DOCPZLUU.js";import{u as Q,s as HW,d as Me,a as V,b as VW,S as Rx,D as PN,g as ON,c as GW,M as be,F as Dx,e as rk,f as D2,h as zW,i as LN,j as sk,k as qW,l as I2,m as $W,n as ak,o as ok}from"./i18n-084bMT3r.js";import{$ as D,I as ut,a as WW,T as ye,c as Rl,i as FN,e as ik,s as KW}from"./pplx-icons-Do6_ClXf.js";import{b as gt,Q as Se,u as It,k as Ja,a as on,d as QC,f as UN,P as YW,g as QW,h as XW}from"./react-query-r7hDIr5f.js";import{M as ZW,u as JW,a as eK,b as qf,c as XC,d as tK,e as nK,C as rK,P as Lh,s as _r,i as Ix,f as sK,S as aK,g as oK,h as iK,j as lK,k as cK,l as BN,m as uK,n as dK,o as fK,p as jx,q as mK}from"./pplx-stream-p3v_-k4d.js";import{A as Wt,m as ze,c as HN,e as lf,a as ai,L as e0,u as ZC}from"./framer-motion-DPh1AsEA.js";import"./mapbox-gl-D_rkT3p_.js";const pK=`<svg xmlns="http://www.w3.org/2000/svg" style="display:none">
  <!-- Mark Logo -->
  <symbol id="pplx-logo-mark">
    <path
      fill="currentColor"
      fillRule="evenodd"
      clipRule="evenodd"
      d="M15 0.124727C15.4832 0.124727 15.8748 0.516607 15.875 0.999727V8.88645L24.3809 0.380586C24.6311 0.130476 25.0081 0.0557816 25.335 0.191133C25.6618 0.326537 25.8749 0.645944 25.875 0.999727V10.1003H28.75L28.8398 10.1052C29.2809 10.1502 29.625 10.5224 29.625 10.9753V23.5007C29.6246 23.9836 29.233 24.3757 28.75 24.3757H25.875V30.9997C25.875 31.3536 25.6619 31.6729 25.335 31.8083C25.008 31.9438 24.6311 31.8691 24.3809 31.6189L15.875 23.113V30.9997C15.875 31.483 15.4832 31.8747 15 31.8747C14.5168 31.8747 14.125 31.483 14.125 30.9997V23.113L5.61914 31.6189C5.36889 31.8691 4.992 31.9438 4.66504 31.8083C4.33815 31.6729 4.125 31.3536 4.125 30.9997V24.3757H1.25C0.76699 24.3757 0.375388 23.9836 0.375 23.5007V10.9753C0.375 10.4921 0.766751 10.1003 1.25 10.1003H4.125V0.999727C4.12511 0.645944 4.33818 0.326537 4.66504 0.191133C4.99192 0.0557816 5.36892 0.130476 5.61914 0.380586L14.125 8.88645V0.999727C14.1252 0.516607 14.5168 0.124727 15 0.124727ZM5.875 20.1462V28.8864L14.125 20.6364V12.9275L5.875 20.1462ZM15.875 20.6364L24.125 28.8864V20.1462L15.875 12.9275V20.6364ZM2.125 22.6257H4.125V19.7497L4.12988 19.656C4.15334 19.4388 4.25778 19.2369 4.42383 19.0915L12.6992 11.8503H5.20312C5.13787 11.8658 5.07001 11.8747 5 11.8747C4.92999 11.8747 4.86213 11.8658 4.79688 11.8503H2.125V22.6257ZM25.5762 19.0915C25.7659 19.2576 25.8749 19.4976 25.875 19.7497V22.6257H27.875V11.8503H25.2031C25.1379 11.8658 25.07 11.8747 25 11.8747C24.93 11.8747 24.8621 11.8658 24.7969 11.8503H17.3008L25.5762 19.0915ZM5.875 10.1003H12.8623L5.875 3.11301V10.1003ZM17.1377 10.1003H24.125V3.11301L17.1377 10.1003Z"
    />
  </symbol>

  <!-- Full Logo -->
  <symbol id="pplx-logo-full">
    <path
      fill="var(--logo-fill, currentColor)"
      d="M196.978 27.8931H200.033V34.1872H196.079C192.979 34.1872 190.669 34.9333 189.14 36.4254C187.615 37.9176 186.85 40.3662 186.85 43.7711V64.401H180.606V28.0333H186.85V33.8367C186.85 34.1622 187.014 34.3274 187.337 34.3274C187.52 34.3274 187.659 34.2823 187.754 34.1872C187.848 34.0921 187.938 33.9068 188.032 33.6264C189.234 29.8058 192.219 27.8931 196.983 27.8931H196.978ZM237.763 35.6894C239.402 38.6036 240.227 42.1137 240.227 46.2146C240.227 50.3156 239.407 53.8257 237.763 56.7399C236.119 59.6541 233.993 61.8323 231.38 63.2794C228.767 64.7265 225.956 65.4476 222.951 65.4476C217.03 65.4476 212.868 63.0691 210.464 58.3122C210.28 57.9417 210.046 57.7514 209.768 57.7514C209.49 57.7514 209.351 57.8916 209.351 58.172V77.6853H203.107V28.0333H209.351V34.2573C209.351 34.5377 209.49 34.6779 209.768 34.6779C210.046 34.6779 210.275 34.4926 210.464 34.1171C212.868 29.3602 217.03 26.9817 222.951 26.9817C225.956 26.9817 228.767 27.7028 231.38 29.1499C233.993 30.597 236.119 32.7751 237.763 35.6894ZM233.983 46.2146C233.983 41.9234 232.841 38.5786 230.551 36.1801C228.261 33.7816 225.246 32.5799 221.496 32.5799C217.745 32.5799 214.73 33.7816 212.44 36.1801C210.151 38.5836 209.311 41.9284 209.311 46.2146C209.311 50.5009 210.151 53.8507 212.44 56.2492C214.73 58.6527 217.75 59.8494 221.496 59.8494C225.241 59.8494 228.261 58.6477 230.551 56.2492C232.841 53.8507 233.983 50.5009 233.983 46.2146ZM134.595 35.7445C136.235 38.6587 137.059 42.1688 137.059 46.2697C137.059 50.3707 136.24 53.8808 134.595 56.795C132.951 59.7092 130.825 61.8874 128.213 63.3345C125.6 64.7816 122.788 65.5026 119.783 65.5026C113.863 65.5026 109.7 63.1242 107.296 58.3673C107.112 57.9967 106.879 57.8065 106.601 57.8065C106.322 57.8065 106.183 57.9467 106.183 58.2271V77.7404H99.9446V28.0883H106.188V34.3124C106.188 34.5928 106.327 34.733 106.606 34.733C106.884 34.733 107.112 34.5477 107.301 34.1722C109.705 29.4153 113.867 27.0368 119.788 27.0368C122.793 27.0368 125.605 27.7579 128.218 29.205C130.83 30.6521 132.956 32.8302 134.6 35.7445H134.595ZM130.815 46.2697C130.815 41.9785 129.673 38.6336 127.383 36.2352C125.093 33.8367 122.078 32.6349 118.328 32.6349C114.578 32.6349 111.563 33.8367 109.273 36.2352C106.983 38.6387 106.144 41.9835 106.144 46.2697C106.144 50.5559 106.983 53.9058 109.273 56.3043C111.563 58.7078 114.578 59.9045 118.328 59.9045C122.078 59.9045 125.093 58.7028 127.383 56.3043C129.673 53.9058 130.815 50.5559 130.815 46.2697ZM169.112 52.8543H175.703C174.824 56.2592 173.031 59.2085 170.329 61.7021C167.622 64.1957 163.748 65.4425 158.706 65.4425C154.911 65.4425 151.573 64.6614 148.682 63.0991C145.791 61.5369 143.561 59.3137 141.986 56.4195C140.412 53.5303 139.627 50.1253 139.627 46.2096C139.627 42.294 140.392 38.889 141.917 35.9998C143.442 33.1106 145.583 30.8824 148.335 29.3201C151.086 27.7579 154.31 26.9767 158.011 26.9767C161.711 26.9767 164.776 27.7479 167.344 29.2851C169.912 30.8223 171.829 32.8653 173.101 35.404C174.372 37.9477 175.008 40.7317 175.008 43.7611V47.9572H146.219C146.447 51.5925 147.664 54.4867 149.859 56.6298C152.055 58.7729 155.005 59.8494 158.706 59.8494C161.711 59.8494 164.016 59.2335 165.61 57.9967C167.205 56.7599 168.372 55.0475 169.112 52.8543ZM146.288 42.7146H168.074C168.074 39.545 167.264 37.0614 165.645 35.2638C164.026 33.4712 161.483 32.5699 158.015 32.5699C154.777 32.5699 152.129 33.4461 150.073 35.1937C148.017 36.9412 146.755 39.4498 146.293 42.7096L146.288 42.7146ZM245.169 64.396H251.413V14.043H245.169V64.401V64.396ZM331.801 24.0625H339.093V16.1911H331.801V24.0625ZM357.526 58.9782C356.393 59.0933 355.708 59.1534 355.479 59.1534C355.156 59.1534 354.898 59.0583 354.714 58.873C354.531 58.6877 354.436 58.4324 354.436 58.1019C354.436 57.8716 354.496 57.1806 354.61 56.0389C354.724 54.8972 354.784 53.1347 354.784 50.7612V33.361H363.69L361.937 28.0333H354.789V18.2391H348.545V28.0283H341.755V33.356H348.545V52.5038C348.545 56.5146 349.519 59.4989 351.461 61.4568C353.403 63.4146 356.363 64.396 360.342 64.396H365.2V58.8029H362.771C360.412 58.8029 358.663 58.863 357.531 58.9782H357.526ZM394.059 28.0283L383.723 58.5425C383.583 58.9181 383.365 59.4088 382.655 59.4088C381.944 59.4088 381.726 58.9181 381.587 58.5425L371.25 28.0283H364.882L376.853 64.396H381.085C381.363 64.396 381.572 64.4211 381.711 64.4661C381.85 64.5112 381.964 64.6264 382.059 64.8166C382.242 65.097 382.217 65.5177 381.989 66.0735L380.047 71.3862C379.769 72.0872 379.237 72.4377 378.452 72.4377C378.174 72.4377 377.529 72.3776 376.51 72.2624C375.492 72.1473 374.176 72.0872 372.556 72.0872H367.49V77.6803H374.151C378.035 77.6803 380.375 77.0143 382.386 75.6874C384.398 74.3605 385.958 72.0171 387.07 68.6572L400 29.4203V28.0233H394.059V28.0283ZM311.406 41.5979L301.626 28.0283H294.756V29.4253L306.478 45.1631L292.188 62.999V64.396H299.197L310.576 49.7798L321.191 64.396H327.922V62.999L315.504 46.2146L328.965 29.5004V28.0333H321.956L311.411 41.603L311.406 41.5979ZM332.467 64.396H338.71V28.0333H332.467V64.401V64.396ZM292.471 52.8543C291.592 56.2592 289.799 59.2085 287.097 61.7021C284.39 64.1957 280.515 65.4425 275.474 65.4425C271.679 65.4425 268.341 64.6614 265.45 63.0991C262.559 61.5369 260.329 59.3137 258.754 56.4195C257.18 53.5303 256.395 50.1253 256.395 46.2096C256.395 42.294 257.16 38.889 258.685 35.9998C260.21 33.1106 262.35 30.8824 265.102 29.3201C267.854 27.7579 271.078 26.9767 274.778 26.9767C278.479 26.9767 281.543 27.7479 284.111 29.2851C286.679 30.8223 288.597 32.8653 289.868 35.404C291.14 37.9477 291.776 40.7317 291.776 43.7611V47.9572H262.986C263.215 51.5925 264.432 54.4867 266.627 56.6298C268.823 58.7729 271.773 59.8494 275.474 59.8494C278.479 59.8494 280.783 59.2335 282.378 57.9967C283.972 56.7599 285.14 55.0475 285.88 52.8543H292.471ZM263.056 42.7146H284.842C284.842 39.545 284.032 37.0614 282.413 35.2638C280.793 33.4712 278.25 32.5699 274.783 32.5699C271.545 32.5699 268.897 33.4461 266.841 35.1937C264.784 36.9412 263.523 39.4498 263.061 42.7096L263.056 42.7146Z"
    />
    <path
      fill="none"
      stroke="var(--logo-stroke, currentColor)"
      class="transition-all duration-300"
      stroke-width="4.30504"
      stroke-miterlimit="10"
      d="M38.6936 29.9832L12.8633 5.88983V29.9832H38.6936Z M39.5005 29.9832L65.3308 5.88983V29.9832H39.5005Z M38.7227 2L38.7227 90.2534 M64.5246 53.7584L38.6943 30.0068V62.9404L64.5246 85.9724V53.7584Z M12.8924 53.7584L38.7227 30.0068V62.9404L12.8924 85.9724V53.7584Z M2.28711 29.9832V64.4236H12.8863V53.7348L38.7226 29.9832H2.28711Z M38.6943 30.3L64.5246 54.0515V64.7403H75.2872V30.3L38.6943 30.3Z"
    />
  </symbol>

  <!-- Pro Logo -->
  <symbol id="pplx-logo-pro">
     <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M30 0C13.4308 0 0 13.4308 0 30C0 46.5692 13.4308 60 30 60H78.4609C95.03 59.9998 108.463 46.5691 108.463 30C108.463 13.6898 95.4474 0.420676 79.2363 0.00976563L78.4609 0H30ZM21.3223 14.793H35.0527C36.945 14.793 38.6781 15.1381 40.2012 15.8535C41.7473 16.5458 42.9691 17.5619 43.8691 18.9004C44.769 20.2388 45.207 21.8762 45.207 23.8145C45.207 25.7529 44.746 27.369 43.8691 28.7305V28.7539C42.9692 30.1153 41.7472 31.1538 40.2012 31.8691C38.655 32.5845 36.945 32.9316 35.0527 32.9316H27.7148V44.7012H21.3223V14.793ZM75.4609 22.4766C77.6992 22.4766 79.7072 22.9157 81.4609 23.7695C83.2144 24.6233 84.6 25.8922 85.6152 27.5996C86.6306 29.2842 87.1602 31.3616 87.1602 33.877C87.1602 35.7462 86.8621 37.3838 86.2852 38.8145V38.793C85.7083 40.2005 84.878 41.3766 83.8398 42.3457C82.7782 43.2919 81.5538 44.031 80.123 44.5156C78.7155 44.9771 77.1684 45.2304 75.4609 45.2305C73.2226 45.2305 71.2147 44.8146 69.4609 43.9609C67.7071 43.1071 66.322 41.8385 65.3066 40.1309C64.2912 38.4462 63.7852 36.3458 63.7852 33.8535C63.7852 31.9613 64.0833 30.3217 64.6602 28.9141C65.2371 27.4835 66.069 26.3074 67.1074 25.3613C68.1689 24.4152 69.3912 23.678 70.7988 23.1934C72.2296 22.7088 73.7763 22.4766 75.4609 22.4766ZM61.123 22.6758C61.4569 22.6877 61.8045 22.7135 62.168 22.7539V27.8496C60.747 27.6456 59.4863 27.6713 58.3848 27.9238C57.3002 28.1776 56.4219 28.7543 55.7988 29.6543C55.1759 30.5543 54.8535 31.8929 54.8535 33.6465V44.7227H48.7383V22.9844H54.5996V26.2852H55.0156C55.3156 25.5008 55.7315 24.8073 56.2852 24.2305C56.8621 23.6305 57.6009 23.2164 58.5469 22.9395C59.2564 22.7318 60.1214 22.6401 61.123 22.6758ZM27.6934 19.4766V28.2461H33.7617C35.3078 28.2461 36.5301 27.8771 37.4531 27.1387C38.3992 26.4002 38.8613 25.3151 38.8613 23.8613C38.8613 22.4078 38.399 21.3243 37.4531 20.5859C36.5877 19.8936 35.4383 19.5238 34.043 19.4805L33.7617 19.4766L27.6934 19.4766ZM75.4609 26.9316C74.3532 26.9316 73.3835 27.1841 72.5527 27.7148C71.7452 28.2225 71.1001 29.0087 70.6387 30.0469C70.2002 31.0622 69.9688 32.3306 69.9688 33.8535C69.9688 36.1149 70.4765 37.8231 71.4688 39C72.461 40.1769 73.7994 40.7539 75.4609 40.7539C76.5684 40.7538 77.5381 40.4994 78.3457 39.9688C79.1764 39.438 79.8237 38.677 80.2852 37.6387C80.7467 36.6003 80.9765 35.3549 80.9766 33.832C80.9766 31.5704 80.4689 29.8393 79.4766 28.6855C78.4843 27.5088 77.1453 26.9316 75.4609 26.9316Z"
      fill="currentColor"
    />
  </symbol>

  <!-- Max Logo -->
  <symbol id="pplx-logo-max">
        <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M30 0C13.4308 0 0 13.4308 0 30C0 46.5692 13.4308 60 30 60H94.6152C111.184 60 124.615 46.5692 124.615 30C124.615 13.4308 111.184 0 94.6152 0H30ZM21.1602 14.8613H29.332L37.3145 36.3691H37.7305L45.7148 14.8613H53.8848V44.7695H48.0469V24.3691H47.6309L40.0605 44.7695H35.0312L27.4609 24.3691H27.0469V44.7695H21.1602V14.8613ZM68.9316 22.5234L69.6289 22.5371C71.2293 22.6024 72.6375 22.8956 73.8691 23.4004C75.2999 23.9773 76.3834 24.8532 77.168 26.0762C77.9526 27.2762 78.3457 28.8463 78.3457 30.7617V39.3691C78.3457 40.4306 78.3917 41.3537 78.4609 42.1152C78.5532 42.8767 78.7153 43.5461 78.9922 44.123V44.7461L78.9688 44.7695H73.2227C73.1304 44.4465 73.0384 44.0761 72.9922 43.707C72.9576 43.4128 72.9233 43.0941 72.9082 42.748L72.9004 42.3926H72.4844C72.1383 42.8539 71.7001 43.2922 71.1465 43.7305C70.6157 44.1459 69.946 44.4922 69.1152 44.7461C68.3076 44.9999 67.2695 45.1386 66.0235 45.1387C64.4774 45.1387 63.1156 44.8843 61.8926 44.3535C60.6926 43.8227 59.7232 43.0392 59.0078 42.0469C58.2925 41.0546 57.9473 39.8537 57.9473 38.4922C57.9473 37.0384 58.2703 35.8372 58.9395 34.9141C59.6087 33.9912 60.5297 33.2776 61.6602 32.793C62.814 32.2853 64.0845 31.9845 65.4922 31.8691L70.4531 31.3613C71.1684 31.3152 71.7223 31.1538 72.0684 30.877C72.4376 30.6 72.5996 30.1621 72.5996 29.5391C72.5995 28.5931 72.2769 27.8987 71.6309 27.4141C71.0654 26.9901 70.2692 26.7447 69.2598 26.6895L68.8145 26.6777C67.6607 26.6777 66.6932 26.9065 65.9317 27.4141C65.1701 27.8757 64.7766 28.5913 64.7305 29.5605H59.2149V28.9395C59.4457 26.9549 60.4388 25.3847 62.1465 24.2539C63.8772 23.1002 66.1394 22.5235 68.9316 22.5234ZM81.6934 23.0312H87.9922L92.7695 29.7461H93.1855L97.9844 23.0312H104.191V23.6543L96.668 33.7148L104.492 44.1465V44.7695H98.2148L93.1152 37.707H92.7012L87.623 44.7695H81.3926V44.1465L89.2383 33.7148L81.6934 23.6543V23.0312ZM72.1855 34.4316C71.8393 34.6162 71.445 34.7538 71.0527 34.8691V34.8926C70.6604 34.9849 70.1086 35.0773 69.4395 35.1465L67.0605 35.4004C66.1838 35.4927 65.4223 35.745 64.8223 36.1602C64.2224 36.5986 63.9238 37.2682 63.9238 38.168C63.9238 39.0679 64.2462 39.7381 64.8691 40.2227C65.5152 40.7303 66.4163 40.9609 67.5469 40.9609C68.3084 40.9609 69.069 40.7996 69.8535 40.4766C70.6381 40.1535 71.2838 39.6229 71.8145 38.8613C72.3452 38.0767 72.5996 37.0379 72.5996 35.7227V34.4316L72.1855 34.4316Z"
      fill="currentColor"
    />
  </symbol>

  <!-- Word Pplx Enterprise -->
  <symbol id="pplx-logo-word-ent">
    <path
      d="M687.018 0V8.8457H693.277V0H687.018ZM300.316 2.7832V12.873H309.639V2.7832H300.316ZM248.664 49.7598C248.661 49.7701 248.659 49.7788 248.656 49.7891H248.693L248.664 49.7598ZM323.252 5.39648V17.9336H314.574V24.7637H323.252V49.2988C323.252 54.4361 324.498 58.2662 326.975 60.7734C329.451 63.2804 333.233 64.541 338.324 64.541H344.523V57.373H341.418C338.403 57.373 336.172 57.4497 334.727 57.6035C333.281 57.7573 332.402 57.834 332.109 57.834C331.694 57.8339 331.358 57.7109 331.127 57.4648C330.896 57.2341 330.771 56.8956 330.771 56.4805C330.772 56.1879 330.85 55.2966 331.004 53.8359C331.142 52.3746 331.219 50.1138 331.219 47.0684V24.7773H342.602L340.355 17.9492H331.219V5.39648H323.252ZM301.162 17.9492V64.541H309.146V17.9492H301.162ZM252.031 17.9492V19.7344L267.016 39.8984L248.756 62.7559V64.541H257.707L272.244 45.8066L285.812 64.541H294.41V62.7559L278.535 41.252L295.732 19.8398V17.9648H286.779L273.318 35.3281L260.814 17.9492H252.031ZM188.15 0.0292969V64.541H196.135V0.0292969H188.15ZM679.551 17.334C677.364 17.2871 675.512 17.5157 673.988 18.0117C671.958 18.6731 670.374 19.5949 669.189 20.7637C668.005 21.9327 667.081 23.102 666.404 24.2402H665.482V17.8438H659.639V64.543H665.574V37.5312C665.574 31.5939 667.053 27.534 670.006 25.3652C672.959 23.1964 676.912 22.3032 681.85 22.7031V17.4727C681.046 17.3958 680.28 17.3496 679.551 17.334ZM600.271 17.334C598.085 17.2871 596.233 17.5157 594.711 18.0117C592.681 18.6731 591.094 19.5949 589.91 20.7637C588.726 21.9327 587.804 23.102 587.127 24.2402H586.203V17.8438H580.359V64.543H586.297V37.5312C586.297 31.5939 587.773 27.534 590.727 25.3652C593.68 23.1964 597.633 22.3032 602.57 22.7031V17.4727C601.767 17.3958 601 17.3496 600.271 17.334ZM511.219 4.72266V17.8438H501.588V22.5645H511.219V55.3145C511.219 61.4672 514.448 64.543 520.908 64.543H528.045V59.5898H521.463C519.925 59.5898 518.816 59.2208 518.154 58.4824C517.493 57.7442 517.154 56.6512 517.154 55.2363V22.5645H528.414V17.8438H517.154V4.72266H511.219ZM480.762 16.7812C477.424 16.7812 474.701 17.2447 472.578 18.1523C470.456 19.0598 468.825 20.1508 467.641 21.4121C466.456 22.6734 465.611 23.8588 465.088 24.9355H464.164V17.8438H458.318V64.543H464.258V37.5781C464.258 34.0865 464.979 31.1637 466.395 28.7949C467.81 26.4262 469.685 24.6431 472.023 23.4434C474.361 22.2437 476.899 21.6426 479.652 21.6426C483.236 21.6426 486.145 22.5818 488.406 24.4277C490.667 26.2735 491.789 29.2423 491.789 33.3184V64.543H497.729V32.9023C497.729 27.5956 496.158 23.582 493.021 20.8594C489.883 18.1369 485.791 16.7813 480.762 16.7812ZM125.531 17.7812C119.455 17.7812 115.642 20.2257 114.104 25.1172C113.981 25.4862 113.871 25.7168 113.748 25.8398C113.625 25.9629 113.442 26.0234 113.211 26.0234C112.811 26.0234 112.596 25.8098 112.596 25.3945V17.9648H104.629V64.5566H112.596V38.1309C112.596 33.7626 113.581 30.6241 115.52 28.7168C117.488 26.7941 120.441 25.8398 124.395 25.8398H129.438V17.7812H125.531ZM687.172 17.8438V64.5566H693.107V17.8438H687.172ZM765.279 16.7207C758.542 16.7207 753.237 18.8423 749.346 23.0723C745.454 27.3024 743.498 33.3486 743.498 41.1934C743.498 49.0379 745.452 55.0826 749.359 59.3125C753.266 63.5425 758.589 65.666 765.326 65.666C768.756 65.666 771.664 65.1883 774.062 64.25C776.463 63.2963 778.432 62.0821 779.955 60.6055C781.478 59.129 782.646 57.558 783.445 55.9277C784.245 54.2974 784.753 52.791 784.969 51.4375V50.0527H779.51C779.264 51.7447 778.587 53.4365 777.51 55.0977C776.433 56.7588 774.894 58.144 772.879 59.2207C770.864 60.2974 768.34 60.8359 765.279 60.8359C760.403 60.8359 756.543 59.2041 753.697 55.9277C750.852 52.6514 749.391 48.0989 749.299 42.2539H786V39.0547C786 32.2868 784.245 26.8713 780.738 22.8105C777.341 18.8766 772.341 16.8495 765.906 16.7266L765.279 16.7207ZM765.279 21.5488L765.732 21.5547C770.385 21.6422 773.926 23.086 776.355 25.9024C778.863 28.8096 780.124 32.6861 780.154 37.5313H749.438C749.778 32.7085 751.301 28.8531 754.006 25.9336C756.698 23.0111 760.403 21.5488 765.279 21.5488ZM719.273 16.7656C713.705 16.7656 709.29 17.8911 706.014 20.1523C702.738 22.4134 701.107 25.6427 701.107 29.8418H701.121L701.127 30.2188C701.21 34.0724 702.577 36.916 705.244 38.7637C707.997 40.671 711.46 41.9619 715.629 42.6387L722.627 43.8398C725.965 44.3935 728.671 45.2544 730.778 46.3926C732.886 47.5308 733.932 49.5152 733.932 52.084C733.932 54.6527 732.856 56.7743 730.672 58.4355C728.488 60.1121 725.226 60.9434 720.965 60.9434C716.704 60.9433 713.182 60.022 710.397 58.207C707.613 56.3919 706.09 53.8066 705.813 50.4688H700.199V51.8516C700.768 56.1432 702.86 59.5135 706.506 61.9746C710.151 64.4357 714.981 65.666 720.965 65.666C726.948 65.666 731.579 64.4357 734.84 61.9746C738.101 59.5289 739.731 56.129 739.731 51.8066C739.731 48.9304 739.039 46.6385 737.686 44.9004C736.332 43.1622 734.47 41.8231 732.102 40.8848C729.733 39.9466 727.011 39.2085 723.92 38.6855L716.967 37.5312C714.198 37.0391 711.828 36.2405 709.859 35.1484C707.906 34.0563 706.922 32.18 706.922 29.6113C706.922 27.0427 708.013 25.042 710.213 23.627C712.397 22.1964 715.414 21.4902 719.336 21.4902L720.061 21.498C723.648 21.5881 726.561 22.3536 728.811 23.7812C731.195 25.3041 732.471 27.7344 732.625 31.0723H738.285V29.6875C737.839 25.7346 735.963 22.5978 732.625 20.2598C729.496 18.0823 725.394 16.9181 720.305 16.7812L719.273 16.7656ZM552.426 16.7207C545.689 16.7207 540.382 18.8423 536.49 23.0723C532.599 27.3024 530.645 33.3486 530.645 41.1934C530.645 49.0377 532.599 55.0826 536.506 59.3125C540.413 63.5425 545.735 65.666 552.473 65.666C555.903 65.666 558.809 65.1883 561.209 64.25C563.608 63.2963 565.577 62.0821 567.1 60.6055C568.622 59.1288 569.792 57.5582 570.592 55.9277C571.392 54.2974 571.898 52.791 572.113 51.4375V50.0527H566.654C566.408 51.7447 565.731 53.4365 564.654 55.0977C563.578 56.7588 562.038 58.144 560.023 59.2207C558.008 60.2974 555.487 60.8359 552.426 60.8359C547.55 60.8359 543.689 59.2041 540.844 55.9277C537.998 52.6514 536.536 48.0989 536.443 42.2539H573.145V39.0547C573.145 32.2868 571.392 26.8713 567.885 22.8105C564.487 18.8766 559.487 16.8495 553.053 16.7266L552.426 16.7207ZM552.426 21.5488L552.879 21.5547C557.531 21.6422 561.073 23.086 563.502 25.9024C566.009 28.8096 567.27 32.6861 567.301 37.5313H536.582C536.923 32.7085 538.446 28.8531 541.15 25.9336C543.842 23.0111 547.55 21.5488 552.426 21.5488ZM430.369 16.7207C423.632 16.7207 418.327 18.8423 414.436 23.0723C410.544 27.3024 408.59 33.3486 408.59 41.1934C408.59 49.0379 410.542 55.0826 414.449 59.3125C418.356 63.5425 423.679 65.666 430.416 65.666C433.846 65.666 436.753 65.1883 439.152 64.25C441.552 63.2963 443.522 62.0821 445.045 60.6055C446.568 59.1288 447.735 57.5582 448.535 55.9277C449.335 54.2974 449.843 52.791 450.059 51.4375V50.0527H444.6C444.354 51.7447 443.676 53.4365 442.6 55.0977C441.523 56.7588 439.984 58.144 437.969 59.2207C435.954 60.2974 433.43 60.8359 430.369 60.8359C425.493 60.8359 421.633 59.2041 418.787 55.9277C415.942 52.6514 414.481 48.0989 414.389 42.2539H451.09V39.0547C451.09 32.2868 449.335 26.8713 445.828 22.8105C442.431 18.8766 437.43 16.8495 430.996 16.7266L430.369 16.7207ZM430.369 21.5488L430.822 21.5547C435.474 21.6422 439.016 23.086 441.445 25.9024C443.952 28.8096 445.213 32.6861 445.244 37.5313H414.527C414.868 32.7085 416.391 28.8531 419.096 25.9336C421.788 23.0111 425.493 21.5488 430.369 21.5488ZM226.068 16.627C221.331 16.627 217.208 17.6274 213.701 19.627C210.179 21.6266 207.455 24.4708 205.502 28.1777C203.564 31.8694 202.58 36.2375 202.58 41.252C202.58 46.2664 203.581 50.6193 205.596 54.3262C207.611 58.0332 210.455 60.8812 214.146 62.8809C217.838 64.8805 222.098 65.8789 226.943 65.8789C233.388 65.8789 238.344 64.2951 241.805 61.0957C245.242 57.9038 247.531 54.1444 248.656 49.7891L240.266 49.7891C239.312 52.5885 237.819 54.7888 235.789 56.373C233.743 57.9574 230.791 58.7422 226.961 58.7422C222.223 58.7422 218.454 57.3725 215.654 54.6191C212.84 51.8812 211.284 48.1743 210.992 43.5137H247.771V38.1309C247.771 34.255 246.972 30.6845 245.342 27.4238C243.727 24.163 241.264 21.5489 237.988 19.5801C234.712 17.6113 230.806 16.627 226.068 16.627ZM225.99 23.7637C230.42 23.7637 233.666 24.9171 235.742 27.209C237.803 29.5162 238.836 32.6992 238.836 36.7598H211.01C211.594 32.5762 213.21 29.3612 215.84 27.1309C218.47 24.8852 221.853 23.7637 225.99 23.7637ZM76.3398 16.627C71.6023 16.627 67.4952 17.6274 63.9727 19.627C60.4503 21.6266 57.7115 24.4708 55.7734 28.1777C53.8353 31.8694 52.8516 36.2375 52.8516 41.252C52.8517 46.2664 53.8522 50.6193 55.8672 54.3262C57.8822 58.0332 60.7265 60.8812 64.418 62.8809C68.1096 64.8805 72.3717 65.8789 77.2168 65.8789C83.6617 65.8789 88.6152 64.2951 92.0762 61.0957C95.5217 57.8963 97.8126 54.1283 98.9355 49.7598H90.5234V49.7891C89.5697 52.5885 88.0772 54.7889 86.0469 56.3731C84.0011 57.9574 81.0621 58.7422 77.2168 58.7422C72.4793 58.7421 68.7097 57.3724 65.9102 54.6191C63.111 51.8812 61.5578 48.1742 61.2656 43.5137H98.043V38.1309C98.043 34.2549 97.2454 30.6846 95.6152 27.4238C93.9848 24.163 91.5378 21.5489 88.2617 19.5801C84.9855 17.6113 81.0773 16.627 76.3398 16.627ZM76.0645 23.7637C80.4944 23.7637 83.738 24.9172 85.8145 27.209C87.891 29.5162 88.9237 32.6992 88.9238 36.7598H61.082C61.6666 32.5762 63.2801 29.3612 65.9102 27.1309C68.5405 24.8852 71.9268 23.7637 76.0645 23.7637ZM382.947 17.9336L382.934 17.9492L369.721 57.0488C369.552 57.5256 369.257 58.1562 368.365 58.1563C367.473 58.1563 367.181 57.5256 366.996 57.0488L353.783 17.9492H345.646L360.938 64.541H366.352L366.6 64.5469C366.831 64.5584 367.012 64.5869 367.15 64.6329C367.32 64.6944 367.475 64.8322 367.598 65.0782C367.828 65.432 367.798 65.9706 367.506 66.6934L365.027 73.5098C364.674 74.4018 363.998 74.8476 362.998 74.8477C362.644 74.8477 361.813 74.7691 360.521 74.6153C359.214 74.4615 357.538 74.3848 355.477 74.3848H349V81.5528H357.506C362.474 81.5528 365.459 80.7073 368.027 79C370.596 77.2927 372.597 74.2932 374.012 70.002L390.531 19.7344V17.9336L382.947 17.9336ZM159.664 16.6113C152.096 16.6114 146.789 19.6568 143.713 25.748C143.467 26.2399 143.189 26.4706 142.82 26.4707C142.451 26.4707 142.281 26.2852 142.281 25.9316V17.9492H134.301V81.584H142.281V56.5898C142.281 56.236 142.467 56.0488 142.82 56.0488C143.174 56.0489 143.482 56.2967 143.713 56.7734C146.774 62.8645 152.096 65.9101 159.664 65.9102C163.51 65.9102 167.094 64.9728 170.432 63.127C173.77 61.2658 176.492 58.48 178.584 54.7422C180.676 51.0045 181.723 46.5124 181.723 41.252C181.723 36.3203 180.803 32.0652 178.965 28.4727L178.584 27.7637V27.7773C176.492 24.0396 173.769 21.2403 170.432 19.3945C167.094 17.5333 163.51 16.6113 159.664 16.6113ZM157.803 23.7793C162.602 23.7793 166.447 25.3181 169.369 28.3945C172.292 31.4708 173.754 35.7607 173.754 41.252C173.754 46.7433 172.292 51.035 169.369 54.1113C166.447 57.1876 162.586 58.7266 157.803 58.7266C153.019 58.7265 149.157 57.1876 146.234 54.1113C143.312 51.035 142.236 46.7432 142.236 41.252C142.236 35.7608 143.312 31.4708 146.234 28.3945C149.157 25.3181 153.004 23.7793 157.803 23.7793ZM630.92 16.7812C627.828 16.7812 625.214 17.1967 623.061 18.0273C620.907 18.8579 619.152 19.9204 617.799 21.1816C616.43 22.4428 615.384 23.7353 614.646 25.0273H613.723V17.8438H607.893V81.6309H613.83V57.498H614.754L615.045 57.9766C615.758 59.0905 616.706 60.191 617.877 61.2812C619.215 62.527 620.952 63.5735 623.09 64.3887C625.213 65.2039 627.828 65.6191 630.92 65.6191C635.027 65.6191 638.702 64.6956 641.947 62.8652C645.193 61.0348 647.746 58.298 649.623 54.668C651.484 51.0378 652.424 46.5138 652.424 41.207C652.424 35.9004 651.484 31.425 649.623 27.7949C647.746 24.165 645.193 21.4122 641.947 19.5664C638.702 17.7053 635.027 16.7813 630.92 16.7812ZM630.027 21.6895C634.903 21.6895 638.857 23.3798 641.887 26.7637C644.917 30.1478 646.426 34.9637 646.426 41.1934C646.426 47.4228 644.917 52.2371 641.887 55.6211C638.857 59.0051 634.873 60.6972 630.027 60.6973C625.182 60.6973 621.245 59.0051 618.215 55.6211C615.185 52.2371 613.678 47.4382 613.678 41.1934C613.678 34.9637 615.185 30.1478 618.215 26.7637C621.245 23.3797 625.151 21.6895 630.027 21.6895ZM25.3496 16.6738C17.7817 16.6738 12.4748 19.7192 9.39844 25.8105C9.15235 26.3026 8.87498 26.5312 8.50586 26.5312C8.13702 26.5312 7.96689 26.3476 7.9668 25.9941V18.0273H0V81.6602H7.9668V56.6641C7.96693 56.3107 8.15241 56.1271 8.50586 56.127C8.85958 56.127 9.16772 56.3729 9.39844 56.8496C12.4594 62.9408 17.7817 65.9863 25.3496 65.9863C29.195 65.9863 32.7794 65.0489 36.1172 63.2031C39.455 61.3419 42.1776 58.5562 44.2695 54.8184C46.3613 51.0808 47.4062 46.5903 47.4062 41.3301C47.4062 36.0696 46.3614 31.5776 44.2695 27.8398C42.1623 24.1022 39.4548 21.3029 36.1172 19.457C32.9879 17.7122 29.6429 16.7918 26.0684 16.6836L25.3496 16.6738ZM23.4883 23.8398C28.272 23.8398 32.134 25.3787 35.0566 28.4551C37.979 31.5314 39.4395 35.8232 39.4395 41.3145C39.4394 46.8057 37.9791 51.0975 35.0566 54.1738C32.134 57.2502 28.2874 58.7891 23.4883 58.7891C18.6892 58.7891 14.8444 57.2501 11.9219 54.1738C8.99935 51.0975 7.92189 46.8057 7.92188 41.3145C7.92188 35.8232 8.99938 31.5315 11.9219 28.4551C14.8445 25.3787 18.7045 23.8398 23.4883 23.8398Z"
      fill="currentColor"
    />
  </symbol>

 <!-- Word Enterprise Pro -->
  <symbol id="pplx-logo-word-ent-pro">
    <path
      fill="currentColor"
      d="m 283.82031,0 v 9.9667969 h 9.21289 V 0 Z m 0.83399,15.013672 V 61.09375 h 7.89453 V 15.013672 Z m -8.80469,-0.183594 c -6.016,0 -9.78774,2.40836 -11.30274,7.255859 -0.12099,0.3635 -0.2286,0.591791 -0.3496,0.712891 -0.121,0.1212 -0.3023,0.181541 -0.5293,0.181641 -0.394,0 -0.60742,-0.212194 -0.60742,-0.621094 v -7.345703 h -7.89453 V 61.09375 h 7.89453 V 34.947266 c 0,-4.3172 0.97053,-7.422807 2.89453,-9.316407 1.94,-1.8935 4.86344,-2.832031 8.77344,-2.832031 h 5 v -7.96875 z m -80.69141,0 c -6.016,0 -9.80336,2.40836 -11.31836,7.255859 -0.121,0.3632 -0.22861,0.591791 -0.34961,0.712891 -0.121,0.1212 -0.30229,0.181641 -0.52929,0.181641 -0.409,-2e-4 -0.6211,-0.212294 -0.6211,-0.621094 v -7.345703 h -7.89648 V 61.09375 h 7.89648 V 34.947266 c 0,-4.3171 0.96858,-7.422807 2.89258,-9.316407 1.94,-1.8935 4.86539,-2.831931 8.77539,-2.832031 h 5 v -7.96875 z M 102.10352,2.5898438 V 14.998047 h -8.593754 v 6.753906 h 8.593754 v 24.269531 c 0,5.0898 1.22664,8.861304 3.68164,11.345703 2.455,2.484401 6.19751,3.726563 11.22851,3.726563 h 6.13672 v -7.087891 h -3.07617 c -2.985,0 -5.19805,0.07321 -6.62305,0.22461 v -0.01367 c -1.439,0.1514 -2.30184,0.226562 -2.58984,0.226562 -0.409,0 -0.74175,-0.120881 -0.96875,-0.363281 -0.228,-0.2272 -0.34961,-0.560275 -0.34961,-0.984375 0,-0.2879 0.0765,-1.166894 0.22851,-2.621094 0.136,-1.4391 0.21094,-3.680787 0.21094,-6.679687 V 21.751953 h 10.98633 V 14.998047 H 109.98242 V 2.5898438 Z M 73.902344,14.845703 c -6.3187,0 -10.986878,2.075066 -14.017578,6.134766 -0.0909,0.0757 -0.513725,0.771484 -0.953125,0.771484 -0.4392,-10e-5 -0.605469,-0.164415 -0.605469,-0.603516 v -5.015625 h -7.791016 v 44.945313 h 7.791016 V 37.736328 c 0,-10.6343 4.923784,-15.998047 13.833984,-15.998047 7.8643,10e-5 12.107422,4.332569 12.107422,12.542969 v 26.8125 h 7.789063 V 32.994141 l 0.01563,0.01563 c 0,-11.4978 -6.835222,-18.164063 -18.169922,-18.164063 z M 479.625,14.267578 c -2.17008,-0.04966 -4.01414,0.168094 -5.52539,0.667969 -2.016,0.6666 -3.59144,1.575787 -4.77344,2.742187 -1.181,1.1662 -2.08948,2.317225 -2.77148,3.453125 h -0.92578 v -6.361328 h -5.78711 v 46.445313 h 5.89257 V 34.357422 c 10e-6,-5.8928 1.45649,-9.921691 4.39649,-12.087891 2.94,-2.1663 6.86444,-3.046243 11.77344,-2.652344 V 14.40625 c -0.7955,-0.07573 -1.55594,-0.122119 -2.2793,-0.138672 z m 25.88867,-0.603515 c -6.819,0 -12.27519,2.121781 -16.36719,6.363281 -4.091,4.2415 -6.13671,10.224143 -6.13671,17.964843 0,7.7712 2.04571,13.771547 6.13671,17.998047 4.092,4.2262 9.57819,6.332032 16.36719,6.332032 6.788,0 12.22699,-2.105732 16.33399,-6.332032 4.106,-4.2265 6.15234,-10.257147 6.15234,-17.998047 0,-7.7407 -2.04634,-13.723343 -6.15234,-17.964843 -4.107,-4.2415 -9.51499,-6.363281 -16.33399,-6.363281 z m 0,4.832031 c 4.924,0 8.89345,1.665547 11.93945,4.998047 3.04601,3.3478 4.5625,8.181247 4.5625,14.498046 0,6.3169 -1.51649,11.149722 -4.5625,14.482422 -3.046,3.3326 -6.99945,4.998047 -11.93945,4.998047 -4.94,0 -8.92703,-1.665347 -11.95703,-4.998047 -3.031,-3.3327 -4.54492,-8.150321 -4.54492,-14.482422 0,-6.331899 1.51392,-11.165446 4.54492,-14.498046 3.015,-3.3326 7.03203,-4.998047 11.95703,-4.998047 z M 318.11133,13.648438 c -5.591,0 -10.19814,1.241206 -13.74414,3.816406 -3.546,2.5601 -5.31641,6.015681 -5.31641,10.363281 0,7.453 4.69566,10.996234 12.84766,12.677734 l 8.42578,1.773438 c 2.743,0.6211 4.78941,1.075428 5.9414,1.423828 2.37901,0.6968 3.80274,1.940425 3.80274,4.515625 0,3.8932 -3.4413,7.087891 -11.1543,7.087891 -8.773,-10e-5 -12.10581,-3.378513 -13.25781,-10.195313 h -8.42578 c 1.501,10.3768 7.19901,17.285156 21.29101,17.285156 11.714,0 19.51758,-6.10564 19.51758,-14.61914 0,-7.7103 -5.04559,-10.632794 -14.18359,-12.496094 l -8.42578,-1.771484 c -6.122,-1.333 -8.42383,-2.39581 -8.42383,-5.84961 0,-3.984 3.89272,-6.90625 10.63672,-6.90625 7.803,0 11.97015,2.923328 12.41015,8.861328 h 8.42579 l 0.0137,-0.01367 c -0.348,-9.6648 -8.86386,-15.953124 -20.38086,-15.953124 z m 46.82422,0.01563 c -4.668,-1e-6 -8.74352,0.984349 -12.22852,2.968749 -3.47,1.9845 -6.18147,4.80275 -8.10547,8.46875 -1.925,3.6659 -2.89648,7.968801 -2.89648,12.9375 0,4.9687 0.98633,9.269647 2.98633,12.935547 2.001,3.666 4.8187,6.48425 8.4707,8.46875 3.652,1.9843 7.87997,2.96875 12.66797,2.96875 6.379,0 11.27326,-1.574334 14.69726,-4.740234 3.425,-3.1509 5.68307,-6.893637 6.78907,-11.210938 h -8.34766 c -0.94,2.772 -2.41078,4.937747 -4.42578,6.498047 -2.015,1.5754 -4.92452,2.347657 -8.72852,2.347657 -4.682,0 -8.40864,-1.362719 -11.18164,-4.074219 -2.773,-2.7115 -4.31942,-6.377422 -4.60742,-10.982422 h 36.38281 v -5.318359 c 0,-3.8325 -0.80415,-7.361291 -2.41015,-10.587891 -1.606,-3.2115 -4.03144,-5.801659 -7.27344,-7.755859 -3.243,-1.9389 -7.12206,-2.923829 -11.78906,-2.923828 z m -0.25586,7.089843 0.80468,0.01172 c 3.969,0.1331 6.91371,1.266184 8.84571,3.396484 2.046,2.2723 3.07617,5.4232 3.07617,9.4375 h -27.5332 c 0.58987,-4.127549 2.17747,-7.302496 4.75976,-9.513672 2.606,-2.2115 5.95488,-3.332031 10.04688,-3.332032 z M 146.47266,13.664063 c -4.667,-1e-6 -8.74547,0.98445 -12.23047,2.968749 -3.47,1.9845 -6.18147,4.80275 -8.10547,8.46875 -1.925,3.6659 -2.89649,7.9689 -2.89649,12.9375 0,4.9686 0.98533,9.269647 2.98633,12.935547 2,3.666 4.81871,6.48425 8.47071,8.46875 3.652,1.9843 7.87996,2.96875 12.66796,2.96875 6.38,0 11.27522,-1.574234 14.69922,-4.740234 3.41,-3.1508 5.68207,-6.893737 6.78907,-11.210938 h -8.34961 c -0.94,2.7721 -2.41079,4.937747 -4.42579,6.498047 -2.01499,1.5754 -4.92356,2.347657 -8.72656,2.347657 -4.683,0 -8.41059,-1.362619 -11.18359,-4.074219 -2.773,-2.7115 -4.32042,-6.377422 -4.60742,-10.982422 h 36.38281 v -5.318359 c 0,-3.8326 -0.80416,-7.361291 -2.41016,-10.587891 -1.606,-3.2115 -4.02948,-5.801759 -7.27148,-7.755859 -3.243,-1.939 -7.12206,-2.923828 -11.78906,-2.923828 z m -0.25782,7.089843 0.80664,0.01172 c 3.969,0.1332 6.91175,1.266284 8.84375,3.396484 2.046,2.2723 3.07618,5.4231 3.07618,9.4375 H 131.4082 c 0.5898,-4.127071 2.17712,-7.302536 4.75977,-9.513672 0,0 0.002,-0.002 0.002,-0.002 0,0 0.002,0 0.002,0 0,0 0.002,-0.002 0.002,-0.002 0.004,-0.003 0.006,-0.0068 0.01,-0.0098 2.60373,-2.20269 5.94856,-3.31836 10.03125,-3.31836 z M 23.230469,13.664063 c -4.667,-1e-6 -8.743416,0.984349 -12.228516,2.968749 -3.4700799,1.9845 -6.1829718,4.80275 -8.1074217,8.46875 C 0.97013525,28.767462 0,33.070363 0,38.039062 c 2.52061e-6,4.9686 0.98422,9.269647 2.984375,12.935547 2.00023,3.666 4.8206762,6.48425 8.472656,8.46875 3.6518,1.9843 7.877716,2.96875 12.666016,2.96875 6.3793,0 11.274619,-1.574434 14.699219,-4.740234 3.4094,-3.1508 5.682862,-6.893638 6.789062,-11.210938 h -8.349609 c -0.9395,2.7721 -2.410481,4.937747 -4.425782,6.498047 -2.0154,1.5754 -4.923062,2.347657 -8.726562,2.347657 -4.6822,-10e-5 -8.410694,-1.362719 -11.183594,-4.074219 C 10.152781,48.520922 8.6082625,44.855 8.3203125,40.25 H 44.701172 v -5.318359 c 0,-3.8325 -0.802003,-7.361291 -2.408203,-10.587891 -1.6062,-3.2114 -4.030838,-5.801759 -7.273438,-7.755859 -3.2428,-1.939 -7.121862,-2.923828 -11.789062,-2.923828 z m -0.257813,7.089843 c 4.3791,10e-5 7.591544,1.136003 9.652344,3.408203 2.0456,2.2723 3.076172,5.4232 3.076172,9.4375 H 8.1386719 c 0.59095,-4.1354 2.1804841,-7.315643 4.7714841,-9.527343 l 0.01563,0.01367 c 2.6063,-2.2116 5.955575,-3.332031 10.046875,-3.332031 z M 431.24609,13.708984 c -3.061,0 -5.66768,0.408988 -7.80468,1.242188 -2.136,0.8331 -3.87857,1.877565 -5.22657,3.134765 -1.349,1.257301 -2.39372,2.532613 -3.13672,3.820313 h -0.92578 v -7.136719 h -5.80273 v 63.078125 h 5.89453 V 54.201172 h 0.92578 l 0.28516,0.472656 c 0.706,1.1 1.65431,2.196203 2.82031,3.283203 1.334,1.2422 3.06064,2.273797 5.18164,3.091797 2.121,0.8179 4.71306,1.226563 7.78906,1.226563 4.091,0 7.74466,-0.907235 10.97266,-2.740235 3.227,-1.8178 5.75709,-4.54509 7.62109,-8.15039 1.864,-3.6053 2.78907,-8.090253 2.78907,-13.376954 0,-5.286699 -0.92507,-9.740403 -2.78907,-13.345703 -1.849,-3.6053 -4.39409,-6.33344 -7.62109,-8.18164 -3.228,-1.8481 -6.88166,-2.771485 -10.97266,-2.771485 z m -0.84961,4.892578 c 4.865,10e-7 8.78969,1.682122 11.80469,5.044922 3.016,3.3629 4.51758,8.150104 4.51758,14.345703 0,6.195601 -1.50158,10.982704 -4.51758,14.345704 -3.015,3.363 -6.97069,5.044921 -11.80469,5.044921 -4.833,-9.9e-5 -8.74281,-1.682021 -11.75781,-5.044921 -3.016,-3.363 -4.51562,-8.135003 -4.51562,-14.345704 0,-6.195599 1.49962,-10.982803 4.51562,-14.345703 3.015,-3.3628 6.89481,-5.044821 11.75781,-5.044922 z M 228.89062,13.677734 c -7.48599,1e-4 -12.74406,3.016022 -15.78906,9.044922 -0.243,0.4845 -0.5309,0.712691 -0.8789,0.712891 -0.349,0 -0.53125,-0.18285 -0.53125,-0.53125 v -7.890625 h -7.89454 v 62.910156 h 7.89454 V 53.201172 c 0,-0.3635 0.18225,-0.529297 0.53125,-0.529297 0.348,1e-4 0.6509,0.243391 0.8789,0.712891 3.045,6.0288 8.30306,9.042968 15.78906,9.042968 3.80301,0 7.34935,-0.909187 10.65235,-2.742187 3.303,-1.8329 6.00017,-4.59111 8.07617,-8.28711 2.076,-3.696199 3.10742,-8.134178 3.10742,-13.330078 0,-5.196 -1.04642,-9.650931 -3.10742,-13.332031 v -0.0293 c -2.076,-3.696 -4.77317,-6.452256 -8.07617,-8.285156 -3.303,-1.833 -6.84934,-2.744141 -10.65235,-2.744141 z m -1.82031,7.107422 c 4.743,0 8.56436,1.513694 11.44336,4.558594 2.894,3.0447 4.33203,7.286284 4.33203,12.708984 0,5.423 -1.43803,9.681238 -4.33203,12.710938 -2.895,3.0297 -6.71536,4.558594 -11.44336,4.558594 -4.727,-10e-5 -8.54545,-1.513794 -11.43945,-4.558594 -2.894,-3.0449 -3.95508,-7.287738 -3.95508,-12.710938 0,-5.4229 1.06108,-9.679384 3.95508,-12.708984 2.894,-3.0297 6.69645,-4.558594 11.43945,-4.558594 z"
    />
  </symbol>

  <!-- Word Enterprise Pro -->
  <!-- Word Enterprise Max -->
  <symbol id="pplx-logo-word-ent-max">
    <path
      fill="currentColor"
      d="m 524.98437,15.375 v 1.365234 l 16.26954,21.136719 -17.13477,22.048828 v 1.363281 h 5.97461 l 14.52539,-19.179687 h 0.91016 l 14.58789,19.179687 h 5.97461 V 59.925781 L 548.95703,37.876953 565.22656,16.740234 V 15.375 h -5.88281 l -13.75391,18.271484 h -0.9082 L 530.92773,15.375 Z m -24.94531,-1.076172 c -5.338,0 -9.70431,1.137609 -13.07031,3.412109 -3.381,2.274501 -5.29109,5.397444 -5.74609,9.339844 v 1.34961 h 5.56445 c 0.122,-3.1539 1.38072,-5.518278 3.76172,-7.080079 2.38,-1.561799 5.50251,-2.351562 9.35351,-2.351562 3.852,0 6.83927,0.835481 8.94727,2.488281 2.107,1.6528 3.16992,4.168956 3.16992,7.535156 0,1.9712 -0.54667,3.320604 -1.63867,4.033204 -1.091,0.7127 -2.65355,1.167609 -4.68555,1.349609 l -10.70508,1.001953 c -3.003,0.2729 -5.71532,0.892881 -8.11132,1.863281 -2.396,0.9705 -4.3068,2.396619 -5.7168,4.261719 -1.411,1.8651 -2.12305,4.275097 -2.12305,7.216797 0,4.0334 1.50021,7.324697 4.53321,9.841797 3.032,2.5171 6.97604,3.77539 11.87304,3.77539 4.565,10e-7 8.09761,-0.819331 10.59961,-2.457031 2.502,-1.6527 4.382,-3.668653 5.625,-6.064453 h 0.91016 c 0.061,2.3807 0.78797,4.215431 2.16797,5.519531 1.38,1.304 3.45779,1.955078 6.21679,1.955078 h 3.1543 v -1.363281 l 2.54492,-3.27539 h -5.30469 c -2.48599,0 -3.73046,-1.229147 -3.73046,-3.685547 V 30.236328 c 0,-5.5194 -1.60702,-9.569687 -4.79102,-12.117187 -3.185,-2.5474 -7.46183,-3.820313 -12.79883,-3.820313 z m 11.11524,22.912109 h 0.91015 v 3.275391 c 0,4.0789 -0.75876,7.383716 -2.25976,9.916016 -1.501,2.5323 -3.47244,4.382756 -5.89844,5.535156 -2.442,1.1524 -5.04984,1.728516 -7.83984,1.728516 -3.351,0 -6.06521,-0.834054 -8.15821,-2.501954 -2.092,-1.668 -3.13867,-3.89655 -3.13867,-6.65625 l 0.0156,0.01563 c 0,-2.744499 0.97111,-4.776928 2.91211,-6.111328 1.941,-1.3343 4.74576,-2.182975 8.38476,-2.546875 l 7.83984,-0.773437 c 2.274,-0.2123 3.88227,-0.471666 4.82227,-0.759766 0.94,-0.2881 1.74216,-0.666194 2.41016,-1.121094 z M 428.27148,14.330078 c -2.926,0 -5.2774,0.363472 -7.0664,1.076172 -1.789,0.7127 -3.19847,1.621191 -4.23047,2.712891 -1.031,1.0918 -1.84808,2.200165 -2.45508,3.322265 h -0.91016 V 15.375 h -5.74804 v 45.929687 h 5.83789 V 34.011719 c 0,-4.8825 1.22792,-8.598035 3.66992,-11.115235 2.456,-2.5171 5.65761,-3.77539 9.59961,-3.77539 3.503,0 6.09497,0.985306 7.79297,2.941406 1.698,1.956 2.54687,4.580169 2.54687,7.855469 v 31.386718 h 5.79297 V 34.011719 c 0,-4.8825 1.21267,-8.598035 3.63867,-11.115235 2.426,-2.5171 5.59652,-3.77539 9.47852,-3.77539 3.488,0 6.10952,0.985306 7.85352,2.941406 1.743,1.956 2.62304,4.580169 2.62304,7.855469 v 31.386718 h 5.83789 V 29.599609 c 0,-3.6088 -0.69812,-6.536625 -2.07812,-8.765625 -1.395,-2.2441 -3.22758,-3.881534 -5.51758,-4.927734 -2.29,-1.0463 -4.80811,-1.576172 -7.53711,-1.576172 -4.337,0 -7.65764,0.877819 -9.93164,2.636719 -2.29,1.7741 -3.95853,3.791906 -5.01953,6.066406 h -0.91016 c -0.682,-2.1835 -2.04542,-4.185834 -4.10742,-5.990234 -2.062,-1.8044 -5.12616,-2.712891 -9.16016,-2.712891 z M 318.32227,13.662109 c -5.595,0 -10.20396,1.242513 -13.75196,3.820313 -3.548,2.5626 -5.32226,6.021147 -5.32226,10.373047 0,7.4603 4.69942,11.008206 12.85742,12.691406 l 8.43164,1.773437 c 2.744,0.6217 4.79036,1.077082 5.94336,1.425782 2.38,0.6975 3.80664,1.941731 3.80664,4.519531 0,3.897 -3.44216,7.095703 -11.16016,7.095703 -8.78,0 -12.11557,-3.381578 -13.26758,-10.205078 h -8.43164 c 1.501,10.3869 7.20269,17.300781 21.30469,17.300781 11.722,0 19.53125,-6.111112 19.53125,-14.632812 0,-7.7182 -5.05036,-10.644666 -14.19336,-12.509766 l -8.43164,-1.773437 c -6.126,-1.3343 -8.43164,-2.396316 -8.43164,-5.853516 0,-3.988 3.89849,-6.914063 10.64649,-6.914063 7.809,10e-7 11.97796,2.926994 12.41796,8.871094 h 8.42969 l 0.0176,-0.01563 c -0.349,-9.6742 -8.87248,-15.966797 -20.39648,-15.966797 z M 73.951172,14.859375 c -6.3231,0 -10.992691,2.078878 -14.025391,6.142578 -0.091,0.0759 -0.515278,0.773438 -0.955078,0.773438 -0.4397,0 -0.607422,-0.167622 -0.607422,-0.607422 v -5.019532 h -7.792969 v 44.990235 h 7.792969 V 37.771484 c 0,-10.6447 4.92775,-16.011718 13.84375,-16.011718 7.8697,0 12.115235,4.336187 12.115235,12.554687 v 26.839844 h 7.794921 V 33.025391 l 0.01563,0.01563 c 0,-11.5089 -6.83944,-18.181641 -18.18164,-18.181641 z m 210.892578,0.167969 v 46.126953 h 7.89844 V 15.027344 Z M 284.00977,0 v 9.9765625 h 9.21875 V 0 Z M 102.16992,2.59375 v 12.417969 h -8.597654 v 6.763672 h 8.597654 v 24.291015 c 0,5.0948 1.22855,8.870622 3.68555,11.357422 2.456,2.4868 6.20233,3.730469 11.23633,3.730469 h 6.14062 v -7.097656 h -3.07812 c -2.987,0 -5.20196,0.07691 -6.62696,0.228515 v -0.01563 c -1.441,0.1517 -2.30379,0.226563 -2.59179,0.226563 -0.41,0 -0.74271,-0.120681 -0.97071,-0.363282 -0.227,-0.2275 -0.34961,-0.561728 -0.34961,-0.986328 0,-0.2881 0.0765,-1.167346 0.22852,-2.623047 0.136,-1.4405 0.21094,-3.683246 0.21094,-6.685546 v -22.0625 h 10.99414 V 15.011719 H 110.05469 V 2.59375 Z m 263.00781,11.083984 c -4.671,0 -8.74932,0.984303 -12.23632,2.970703 -3.472,1.9864 -6.18829,4.806963 -8.11329,8.476563 -1.926,3.6695 -2.89648,7.975719 -2.89648,12.949219 0,4.9736 0.98628,9.281672 2.98828,12.951172 2.001,3.6695 4.82156,6.488209 8.47656,8.474609 3.654,1.9864 7.88479,2.972656 12.67579,2.972656 6.384,0 11.28198,-1.576994 14.70898,-4.746094 3.427,-3.154 5.68597,-6.899103 6.79297,-11.220703 h -8.35547 c -0.94,2.7749 -2.41073,4.94396 -4.42773,6.50586 -2.016,1.577 -4.92838,2.349609 -8.73438,2.349609 -4.685,0 -8.41445,-1.363925 -11.18945,-4.078125 -2.775,-2.7143 -4.32138,-6.38454 -4.60938,-10.994141 h 36.40625 v -5.322265 c 0,-3.8363 -0.80315,-7.36981 -2.41015,-10.59961 -1.607,-3.2146 -4.0343,-5.807571 -7.2793,-7.763671 -3.245,-1.9409 -7.12688,-2.925782 -11.79688,-2.925782 z m -0.25781,7.095703 c 4.382,0 7.5962,1.13761 9.6582,3.41211 2.047,2.2745 3.07813,5.428965 3.07813,9.447265 h -27.55078 c 0.59072,-4.130636 2.17866,-7.310237 4.76172,-9.523437 2.608,-2.2138 5.95873,-3.335937 10.05273,-3.335938 z M 23.246094,13.677734 c -4.6703,0 -8.750781,0.984303 -12.238281,2.970703 C 7.5353725,18.634837 4.8222244,21.4554 2.8964844,25.125 0.97074538,28.7945 0,33.100719 0,38.074219 c 0,4.9736 0.98477212,9.281672 2.9863281,12.951172 2.00156,3.6695 4.8221625,6.488209 8.4765629,8.474609 3.6543,1.9864 7.886134,2.972656 12.677734,2.972656 6.3837,0 11.280131,-1.576994 14.707031,-4.746094 3.4117,-3.154 5.686069,-6.899103 6.792969,-11.220703 h -8.353516 c -0.9401,2.7749 -2.411034,4.94396 -4.427734,6.50586 -2.0168,1.577 -4.928375,2.349609 -8.734375,2.349609 -4.6855,0 -8.416506,-1.363925 -11.191406,-4.078125 -2.7749,-2.7143 -4.3212752,-6.38454 -4.6093752,-10.994141 H 44.732422 v -5.322265 c 0,-3.8363 -0.804809,-7.36981 -2.41211,-10.59961 -1.607299,-3.2146 -4.032443,-5.807571 -7.277343,-7.763671 -3.245,-1.9409 -7.126575,-2.925782 -11.796875,-2.925782 z m -0.257813,7.095703 c 4.3822,0 7.596003,1.13761 9.658203,3.41211 2.047,2.2745 3.078125,5.428965 3.078125,9.447265 H 8.1425781 c 0.59137,-4.139599 2.1844439,-7.325262 4.7773439,-9.539062 l 0.01367,0.01563 c 2.6081,-2.2138 5.960587,-3.335937 10.054687,-3.335938 z M 146.56836,13.677734 c -4.671,0 -8.74933,0.984303 -12.23633,2.970703 -3.473,1.9864 -6.18728,4.806963 -8.11328,8.476563 -1.925,3.6695 -2.89648,7.975719 -2.89648,12.949219 0,4.9736 0.98728,9.281672 2.98828,12.951172 2.002,3.6695 4.82156,6.488209 8.47656,8.474609 3.654,1.9864 7.88478,2.972656 12.67578,2.972656 6.384,0 11.28198,-1.576994 14.70898,-4.746094 3.411,-3.154 5.68597,-6.899103 6.79297,-11.220703 h -8.35547 c -0.94,2.7749 -2.41073,4.94396 -4.42773,6.50586 -2.017,1.577 -4.92837,2.349609 -8.73437,2.349609 -4.685,0 -8.41546,-1.363925 -11.18946,-4.078125 -2.775,-2.7143 -4.32137,-6.38454 -4.60937,-10.994141 h 36.40625 v -5.322265 c 0,-3.8363 -0.80316,-7.36981 -2.41016,-10.59961 -1.607,-3.2146 -4.0343,-5.807571 -7.2793,-7.763671 -3.245,-1.9409 -7.12687,-2.925782 -11.79687,-2.925782 z m -0.25781,7.095703 c 4.382,0 7.59815,1.13761 9.66015,3.41211 2.047,2.2745 3.07813,5.428965 3.07813,9.447265 h -27.55274 c 0.59072,-4.130636 2.17866,-7.310237 4.76172,-9.523437 2.608,-2.2138 5.95874,-3.335937 10.05274,-3.335938 z m 82.73242,-7.080078 c -7.491,0 -12.75474,3.015882 -15.80274,9.050782 -0.242,0.4853 -0.5299,0.71289 -0.8789,0.71289 -0.349,0 -0.53125,-0.180497 -0.53125,-0.529297 v -7.90039 h -7.89844 V 78 h 7.89844 V 53.253906 c 0,-0.3639 0.18225,-0.53125 0.53125,-0.53125 0.349,0 0.6519,0.242791 0.8789,0.712891 3.048,6.035 8.31174,9.052734 15.80274,9.052734 3.806,0 7.3532,-0.90944 10.6582,-2.74414 3.306,-1.8348 6.00503,-4.595122 8.08203,-8.294922 2.078,-3.6999 3.10938,-8.14275 3.10938,-13.34375 0,-5.201 -1.04638,-9.65915 -3.10938,-13.34375 v -0.03125 c -2.077,-3.6998 -4.77603,-6.458169 -8.08203,-8.292969 -3.305,-1.8347 -6.8522,-2.744141 -10.6582,-2.744141 z m -1.82031,7.111328 c 4.746,0 8.56626,1.516654 11.44726,4.564454 2.896,3.0478 4.33789,7.292203 4.33789,12.720703 0,5.4285 -1.44189,9.689956 -4.33789,12.722656 -2.896,3.0327 -6.71626,4.564453 -11.44726,4.564453 -4.731,0 -8.55322,-1.516653 -11.44922,-4.564453 -2.896,-3.0478 -3.95703,-7.294156 -3.95703,-12.722656 0,-5.4285 1.06103,-9.688003 3.95703,-12.720703 2.896,-3.0327 6.70322,-4.564454 11.44922,-4.564454 z m 48.81054,-5.958984 c -6.02,0 -9.7965,2.409419 -11.3125,7.261719 -0.122,0.3639 -0.22861,0.591591 -0.34961,0.71289 -0.121,0.1213 -0.30129,0.181641 -0.52929,0.181641 -0.394,0 -0.60743,-0.211694 -0.60743,-0.621094 v -7.353515 h -7.89843 v 46.126953 h 7.89843 V 34.982422 c 0,-4.3215 0.97049,-7.430772 2.89649,-9.326172 1.941,-1.8954 4.8673,-2.835938 8.7793,-2.835938 h 5.0039 v -7.974609 z m -80.75976,0 c -6.01171,0.0038 -9.7977,2.413261 -11.3125,7.261719 -0.121,0.3639 -0.22861,0.591591 -0.34961,0.71289 -0.121,0.1213 -0.30325,0.181641 -0.53125,0.181641 -0.409,0 -0.61914,-0.211694 -0.61914,-0.621094 v -7.353515 h -7.90039 v 46.126953 h 7.90039 V 34.982422 c 0,-4.3215 0.96853,-7.430772 2.89453,-9.326172 1.941,-1.8954 4.8673,-2.835938 8.7793,-2.835938 h 5.0039 v -7.974609 h -3.85156 z"
    />
  </symbol>

  <!-- Word Pro -->
  <symbol id="pplx-logo-word-pro">
    <path
      d="M368.029 3.37305V15.7207H379.453V3.37305H368.029ZM304.73 60.9238C304.727 60.9362 304.725 60.9486 304.722 60.9609H304.769L304.73 60.9238ZM396.137 6.57812V21.9414H385.504V30.3105H396.137V60.377C396.137 66.6729 397.662 71.3669 400.697 74.4395C403.732 77.5119 408.368 79.0565 414.607 79.0566H422.205V70.2734H418.396C414.702 70.2734 411.969 70.3681 410.197 70.5566C408.425 70.7451 407.35 70.8398 406.992 70.8398C406.483 70.8397 406.07 70.6881 405.787 70.3867C405.504 70.104 405.354 69.6886 405.354 69.1797C405.354 68.8212 405.448 67.7277 405.637 65.9375C405.806 64.1467 405.9 61.3766 405.9 57.6445V30.3301H419.85L417.098 21.9609H405.9V6.57812H396.137ZM369.066 21.9609V79.0566H378.852V21.9609H369.066ZM308.859 21.9609V24.1484L327.221 48.8594L304.846 76.8711V79.0566H315.814L333.629 56.0977L350.256 79.0566H360.793V76.8711L341.34 50.5195L362.412 24.2793V21.9805H351.441L334.945 43.2578L319.623 21.9609H308.859ZM230.574 0V79.0566H240.357V0H230.574ZM153.836 21.752C146.39 21.7521 141.715 24.75 139.83 30.7441C139.679 31.1965 139.547 31.4801 139.396 31.6309C139.246 31.7814 139.019 31.8555 138.736 31.8555C138.246 31.8555 137.982 31.5929 137.982 31.084V21.9805H128.219V79.0762H137.982V46.6914C137.982 41.3382 139.189 37.4936 141.564 35.1562C143.977 32.7999 147.597 31.6309 152.441 31.6309H158.623V21.752H153.836ZM592.904 20.8848C590.205 20.8228 587.911 21.0929 586.031 21.7148C583.524 22.5442 581.564 23.6756 580.094 25.127C578.624 26.5784 577.493 28.0121 576.645 29.4258H575.494V21.5098H568.295V79.3027H575.627V45.8809C575.627 38.5485 577.437 33.5355 581.094 30.8398C584.751 28.1443 589.631 27.051 595.738 27.541V21.0566C594.749 20.9624 593.804 20.9054 592.904 20.8848ZM625.107 20.1309C616.625 20.131 609.841 22.7709 604.752 28.0488C599.662 33.3268 597.115 40.7721 597.115 50.4043C597.115 60.0744 599.662 67.5396 604.752 72.7988C609.841 78.0577 616.663 80.6777 625.107 80.6777C633.552 80.6777 640.321 78.0578 645.43 72.7988C650.538 67.5396 653.082 60.0367 653.082 50.4043C653.082 40.7721 650.538 33.3268 645.43 28.0488C640.321 22.7708 633.59 20.1309 625.107 20.1309ZM625.09 26.1445C631.216 26.1445 636.154 28.2183 639.943 32.3652C643.732 36.531 645.617 42.544 645.617 50.4043C645.617 58.2648 643.732 64.2787 639.943 68.4258C636.155 72.5726 631.235 74.6445 625.09 74.6445C618.945 74.6445 613.987 72.5728 610.217 68.4258C606.447 64.2787 604.562 58.2837 604.562 50.4043C604.564 42.5253 606.447 36.5122 610.217 32.3652C613.968 28.2182 618.964 26.1445 625.09 26.1445ZM277.041 20.3203C271.235 20.3203 266.183 21.5456 261.885 23.9961C257.568 26.4466 254.232 29.9339 251.838 34.4766C249.463 39.0006 248.258 44.3549 248.258 50.5C248.258 56.6449 249.482 61.9806 251.951 66.5234C254.421 71.0661 257.908 74.5516 262.432 77.002C266.956 79.4525 272.177 80.6777 278.115 80.6777C286.013 80.6777 292.083 78.7371 296.324 74.8164C300.537 70.9047 303.342 66.2985 304.722 60.9609H294.439C293.271 64.3916 291.441 67.0877 288.953 69.0293C286.446 70.9709 282.828 71.9316 278.135 71.9316C272.329 71.9316 267.71 70.255 264.279 66.8809C260.83 63.5256 258.925 58.9811 258.566 53.2695H303.639V46.6738C303.639 41.9238 302.658 37.5488 300.66 33.5527C298.681 29.5565 295.663 26.3523 291.648 23.9395C287.884 21.6775 283.442 20.4772 278.117 20.3359L277.041 20.3203ZM276.945 29.0859C282.374 29.0859 286.352 30.4999 288.896 33.3086C291.422 36.136 292.686 40.0376 292.688 45.0137H258.586C259.302 39.8867 261.283 35.948 264.506 33.2148C267.729 30.4626 271.875 29.0859 276.945 29.0859ZM93.5527 20.3203C87.7469 20.3203 82.715 21.5456 78.3984 23.9961C74.0818 26.4466 70.7267 29.9339 68.3516 34.4766C65.9765 39.0006 64.7695 44.3549 64.7695 50.5C64.7696 56.6449 65.9955 61.9806 68.4648 66.5234C70.9341 71.0661 74.4195 74.5516 78.9434 77.002C83.4675 79.4525 88.6892 80.6777 94.627 80.6777C102.525 80.6777 108.597 78.7371 112.838 74.8164C117.06 70.8956 119.868 66.2772 121.244 60.9238H110.934V60.9609C109.765 64.3917 107.935 67.0877 105.447 69.0293C102.94 70.9707 99.3393 71.9316 94.627 71.9316C88.8212 71.9316 84.2041 70.2551 80.7734 66.8809C77.3429 63.5256 75.4382 58.9809 75.0801 53.2695H120.15V46.6738C120.15 41.9238 119.172 37.5488 117.174 33.5527C115.176 29.5565 112.177 26.3523 108.162 23.9395C104.147 21.5267 99.3583 20.3204 93.5527 20.3203ZM93.2148 29.0859C98.6436 29.0859 102.619 30.4999 105.164 33.3086C107.709 36.136 108.973 40.0376 108.973 45.0137H74.8535C75.5699 39.8867 77.5502 35.948 80.7734 33.2148C83.9967 30.4627 88.1441 29.086 93.2148 29.0859ZM469.293 21.9238L469.273 21.9414L453.082 69.8594C452.875 70.4437 452.517 71.2148 451.424 71.2148C450.331 71.2147 449.97 70.4437 449.744 69.8594L433.555 21.9414H423.582L442.318 79.0391H448.953L449.258 79.0469C449.541 79.061 449.764 79.0958 449.934 79.1523C450.141 79.2277 450.33 79.3959 450.48 79.6973C450.763 80.1309 450.725 80.7918 450.367 81.6777L447.332 90.0273C446.898 91.1206 446.071 91.6679 444.846 91.668C444.412 91.668 443.394 91.5733 441.811 91.3848C440.208 91.1964 438.153 91.1015 435.627 91.1015H427.689V99.8867H438.115C444.204 99.8867 447.862 98.8502 451.01 96.7578C454.158 94.6654 456.608 90.9895 458.342 85.7305L478.586 24.1269V21.9238L469.293 21.9238ZM195.664 20.3203C186.39 20.3204 179.887 24.053 176.117 31.5176C175.816 32.1208 175.476 32.4023 175.023 32.4023C174.571 32.4023 174.363 32.1776 174.363 31.7441V21.9609H164.58V99.9434H174.363V69.3105C174.363 68.8773 174.59 68.6524 175.023 68.6523L175.184 68.666C175.55 68.7318 175.87 69.0278 176.117 69.5391C179.868 77.0036 186.39 80.7361 195.664 80.7363C200.377 80.7363 204.769 79.5843 208.859 77.3223C212.95 75.0415 216.288 71.6294 218.852 67.0488C221.415 62.4683 222.695 56.966 222.695 50.5195C222.695 44.0727 221.415 38.5669 218.852 33.9863V34.0059C216.288 29.4253 212.95 25.9944 208.859 23.7324C204.769 21.4516 200.377 20.3203 195.664 20.3203ZM193.385 29.1055C199.266 29.1055 203.977 30.9899 207.559 34.7598C211.14 38.5298 212.932 43.79 212.932 50.5195C212.932 57.2489 211.14 62.5073 207.559 66.2773C203.977 70.0471 199.247 71.9316 193.385 71.9316C187.522 71.9316 182.789 70.0474 179.207 66.2773C175.626 62.5074 174.309 57.2489 174.309 50.5195C174.309 43.7901 175.626 38.5298 179.207 34.7598C182.789 30.9897 187.504 29.1055 193.385 29.1055ZM532.725 20.1895C528.917 20.1895 525.673 20.6976 523.016 21.7344C520.358 22.7711 518.191 24.0704 516.514 25.6348C514.836 27.1994 513.533 28.7845 512.609 30.3867H511.461V21.5078H504.24V100H511.574V70.5762H512.725L512.898 70.8691C513.793 72.3357 515.033 73.8009 516.588 75.25C518.247 76.7957 520.396 78.0778 523.035 79.0957C525.674 80.1135 528.898 80.623 532.725 80.623C537.814 80.623 542.356 79.4917 546.371 77.2109C550.386 74.9489 553.535 71.5545 555.854 67.0684C558.172 62.5821 559.32 57.0025 559.32 50.4238C559.32 43.8453 558.172 38.3046 555.854 33.8184C553.554 29.332 550.386 25.9384 546.371 23.6387C542.356 21.3391 537.814 20.1895 532.725 20.1895ZM531.648 26.2773C537.699 26.2774 542.583 28.37 546.334 32.5547C550.085 36.7394 551.951 42.6968 551.951 50.4062C551.951 58.116 550.085 64.0712 546.334 68.2559C542.583 72.4406 537.662 74.5332 531.648 74.5332C525.635 74.5332 520.773 72.4405 517.021 68.2559C513.27 64.0712 511.404 58.1347 511.404 50.4062C511.404 42.6968 513.271 36.7394 517.021 32.5547C520.773 28.37 525.598 26.2773 531.648 26.2773ZM31.0645 20.3945C21.7903 20.3945 15.2876 24.1291 11.5176 31.5938C11.216 32.197 10.8762 32.4785 10.4238 32.4785C9.97177 32.4784 9.76572 32.2517 9.76562 31.8184V22.0547H0V100.02H9.76562V69.3887C9.76562 68.9552 9.9905 68.7267 10.4238 68.7266C10.8573 68.7266 11.2348 69.029 11.5176 69.6133C15.2688 77.0779 21.7903 80.8105 31.0645 80.8105C35.7768 80.8105 40.1694 79.6603 44.2598 77.3984C48.3502 75.1176 51.6884 71.7056 54.252 67.125C56.8155 62.5445 58.0957 57.0402 58.0957 50.5938C58.0957 44.1472 56.8155 38.643 54.252 34.0625V34.082C51.6695 29.5014 48.3502 26.0686 44.2598 23.8066C40.4252 21.6685 36.3255 20.5428 31.9453 20.4102L31.0645 20.3945ZM28.7852 29.1797C34.6476 29.1797 39.3793 31.0658 42.9609 34.8359C46.5423 38.6059 48.332 43.8643 48.332 50.5938C48.332 57.3231 46.5422 62.5816 42.9609 66.3516C39.3793 70.1217 34.6664 72.0078 28.7852 72.0078C22.9039 72.0078 18.1909 70.1217 14.6094 66.3516C11.028 62.5816 9.70898 57.3231 9.70898 50.5938C9.70898 43.8643 11.028 38.6059 14.6094 34.8359C18.1909 31.0658 22.9228 29.1797 28.7852 29.1797Z"
      fill="currentColor"
    />
  </symbol>

  <!-- Word Max -->
  <symbol id="pplx-logo-word-max">
    <path
      d="M367.961 3.37305V15.7188H379.383V3.37305H367.961ZM304.674 60.9121C304.671 60.9248 304.667 60.9385 304.664 60.9512H304.713L304.674 60.9121ZM396.062 6.57812V21.9375H385.432V30.3066H396.062V60.3652C396.062 66.6599 397.587 71.3518 400.621 74.4238C403.655 77.4957 408.291 79.0429 414.529 79.043H422.127V70.2598H418.318C414.625 70.2598 411.893 70.3545 410.121 70.543C408.35 70.7314 407.276 70.8261 406.918 70.8262C406.409 70.8262 405.994 70.6745 405.711 70.373C405.428 70.0903 405.277 69.6768 405.277 69.168C405.277 68.8099 405.372 67.716 405.561 65.9258C405.73 64.1354 405.822 61.3644 405.822 57.6328V30.3242H419.771L417.02 21.957H405.822V6.57812H396.062ZM368.996 21.957V79.043H378.777V21.957H368.996ZM308.803 21.957V24.1426L327.158 48.8516L304.787 76.8555V79.043H315.756L333.564 56.0879L350.188 79.043H360.725V76.8555L341.273 50.5098L362.346 24.2734V21.9766H351.377L334.883 43.25L319.562 21.957H308.803ZM230.531 0V79.043H240.312V0H230.531ZM153.807 21.748C146.362 21.7481 141.689 24.747 139.805 30.7402C139.654 31.1922 139.52 31.4743 139.369 31.625C139.218 31.7755 138.993 31.8516 138.711 31.8516C138.221 31.8516 137.957 31.5869 137.957 31.0781V21.9766H128.193V79.0605H137.957V46.6816C137.957 41.3294 139.162 37.4854 141.537 35.1484C143.949 32.7929 147.569 31.625 152.412 31.625H158.594V21.748H153.807ZM529.627 20.7109C525.99 20.7109 523.07 21.165 520.846 22.0508C518.622 22.9366 516.867 24.0669 515.586 25.4238C514.304 26.7808 513.287 28.158 512.533 29.5527H511.402V22.0137H504.26V79.0977H511.516V45.1738C511.516 39.1054 513.042 34.4897 516.076 31.3613C519.129 28.2329 523.106 26.668 528.006 26.668C532.359 26.668 535.583 27.893 537.693 30.3242C539.804 32.7554 540.859 36.0151 540.859 40.0859V79.0977H548.059V45.1738C548.059 39.1054 549.567 34.4897 552.582 31.3613C555.597 28.2328 559.537 26.668 564.361 26.668C568.696 26.668 571.956 27.893 574.123 30.3242C576.29 32.7554 577.385 36.0152 577.385 40.0859V79.0977H584.641V39.6895C584.641 35.2045 583.773 31.5691 582.059 28.7988C580.325 26.0096 578.043 23.9742 575.197 22.6738C572.351 21.3733 569.222 20.7109 565.83 20.7109C560.44 20.7109 556.313 21.804 553.486 23.9902C550.641 26.1953 548.567 28.7043 547.248 31.5312H546.117C545.269 28.8175 543.575 26.3286 541.012 24.0859C538.449 21.8432 534.64 20.7109 529.627 20.7109ZM618.828 20.6562C612.194 20.6562 606.766 22.0695 602.582 24.8965C598.379 27.7235 596.005 31.6058 595.439 36.5059V38.1816H602.355C602.506 34.2619 604.071 31.3221 607.029 29.3809C609.988 27.4397 613.871 26.4609 618.658 26.4609C623.445 26.461 627.158 27.4984 629.777 29.5527C632.397 31.6069 633.717 34.7341 633.717 38.918C633.717 41.368 633.039 43.0459 631.682 43.9316C630.325 44.8173 628.383 45.3833 625.857 45.6094L612.553 46.8516C608.821 47.1909 605.447 47.9657 602.469 49.1719C599.491 50.3781 597.116 52.1487 595.363 54.4668C593.611 56.7849 592.727 59.7814 592.727 63.4375C592.727 68.4507 594.59 72.5395 598.359 75.668C602.129 78.7966 607.03 80.3613 613.117 80.3613C618.79 80.3613 623.181 79.344 626.291 77.3086C629.401 75.2543 631.738 72.7473 633.283 69.7695H634.414L634.437 70.3164C634.604 73.011 635.5 75.1113 637.107 76.6309C638.822 78.2517 641.406 79.0605 644.836 79.0605H648.775V79.0801H656.201L674.256 55.2383H675.387L693.518 79.0801H700.941V77.3848L679.646 49.9805L699.867 23.707V22.0117H692.557L675.463 44.7227H674.33L657.236 22.0117H649.85V23.707L670.072 49.9805L651.953 73.293H645.326C642.235 73.293 640.69 71.7678 640.689 68.7148V40.4648C640.689 33.6047 638.692 28.5724 634.734 25.4062C630.777 22.2401 625.462 20.6562 618.828 20.6562ZM632.643 49.1328H633.773V53.2031C633.773 58.2726 632.831 62.382 630.965 65.5293C629.099 68.6766 626.65 70.9759 623.635 72.4082C620.6 73.8405 617.358 74.5566 613.891 74.5566C609.726 74.5566 606.351 73.5203 603.75 71.4473C601.149 69.3742 599.85 66.6037 599.85 63.1738L599.867 63.1934C599.867 59.7824 601.074 57.2561 603.486 55.5977C605.899 53.9392 609.385 52.8839 613.908 52.4316L623.652 51.4687C626.479 51.2049 628.477 50.8854 629.646 50.5273C630.814 50.1693 631.813 49.6982 632.643 49.1328ZM276.988 20.3164C271.184 20.3164 266.133 21.5421 261.836 23.9922C257.52 26.4422 254.183 29.9287 251.789 34.4707C249.415 38.9938 248.211 44.3464 248.211 50.4902C248.211 56.6341 249.433 61.9678 251.902 66.5098C254.371 71.0517 257.86 74.5382 262.383 76.9883C266.906 79.4383 272.127 80.6641 278.062 80.6641C285.959 80.6641 292.029 78.7227 296.27 74.8027C300.481 70.8919 303.285 66.2873 304.664 60.9512L294.385 60.9512C293.216 64.3811 291.386 67.0745 288.898 69.0156C286.392 70.9567 282.773 71.918 278.08 71.918C272.276 71.918 267.659 70.2423 264.229 66.8691C260.781 63.5144 258.878 58.9702 258.52 53.2598H303.58V46.6641C303.58 41.9148 302.601 37.5423 300.604 33.5469C298.625 29.5515 295.61 26.3479 291.596 23.9355C287.581 21.5232 282.793 20.3164 276.988 20.3164ZM276.895 29.0801C282.322 29.0802 286.3 30.4947 288.844 33.3027C291.369 36.1296 292.631 40.0304 292.631 45.0059H258.537C259.253 39.8798 261.232 35.9398 264.455 33.207C267.678 30.4554 271.825 29.0801 276.895 29.0801ZM93.5352 20.3164C87.7306 20.3165 82.6986 21.5422 78.3828 23.9922C74.0671 26.4422 70.7125 29.9288 68.3379 34.4707C65.9633 38.9939 64.7559 44.3463 64.7559 50.4902C64.756 56.6341 65.9823 61.9678 68.4512 66.5098C70.9201 71.0517 74.4066 74.5383 78.9297 76.9883C83.4528 79.4383 88.6746 80.6641 94.6113 80.6641C102.508 80.664 108.574 78.7227 112.814 74.8027C117.036 70.8826 119.847 66.2645 121.223 60.9121H110.912V60.9512C109.744 64.3811 107.915 67.0745 105.428 69.0156C102.921 70.9566 99.3225 71.918 94.6113 71.918C88.8067 71.918 84.1879 70.2424 80.7578 66.8691C77.3278 63.5144 75.4245 58.9702 75.0664 53.2598H120.129V46.6641C120.129 41.9148 119.148 37.5423 117.15 33.5469C115.153 29.5514 112.157 26.3479 108.143 23.9355C104.128 21.5232 99.3399 20.3164 93.5352 20.3164ZM93.1973 29.0801C98.6251 29.0801 102.601 30.4945 105.146 33.3027C107.69 36.1296 108.951 40.0304 108.951 45.0059H74.8398C75.556 39.8796 77.5351 35.9398 80.7578 33.207C83.9806 30.4554 88.1276 29.0801 93.1973 29.0801ZM469.205 21.918L469.186 21.9375L452.996 69.8457C452.789 70.4299 452.431 71.2012 451.338 71.2012C450.245 71.2012 449.886 70.4299 449.66 69.8457L433.473 21.9375H423.502L442.234 79.0234H448.869C449.303 79.0234 449.623 79.0613 449.85 79.1367C450.057 79.2122 450.245 79.3822 450.396 79.6836C450.678 80.1171 450.639 80.7764 450.281 81.6621L447.248 90.0117C446.815 91.1045 445.987 91.6522 444.762 91.6523C444.328 91.6523 443.31 91.5575 441.727 91.3691C440.125 91.1806 438.07 91.0859 435.545 91.0859H427.609V99.8691H438.031C444.119 99.8691 447.776 98.8321 450.924 96.7402C454.071 94.6481 456.522 90.9727 458.256 85.7148L478.496 24.123V21.918H469.205ZM195.629 20.3164C186.356 20.3164 179.853 24.0485 176.084 31.5117C175.782 32.1148 175.443 32.3984 174.99 32.3984C174.538 32.3983 174.33 32.1697 174.33 31.7363V21.957H164.551V99.9238H174.33V69.2988C174.33 68.8655 174.557 68.6389 174.99 68.6387L175.15 68.6523C175.517 68.718 175.837 69.0142 176.084 69.5254C179.834 76.9884 186.357 80.7188 195.629 80.7188C200.34 80.7188 204.731 79.5701 208.82 77.3086C212.91 75.0282 216.245 71.6168 218.809 67.0371C221.372 62.4574 222.652 56.9553 222.652 50.5098C222.652 44.2657 221.452 38.9046 219.047 34.4121L218.809 33.9805V33.998C216.245 29.4185 212.91 25.9882 208.82 23.7266C204.731 21.4463 200.34 20.3165 195.629 20.3164ZM193.348 29.0996C199.228 29.0996 203.939 30.9829 207.52 34.752C211.1 38.5213 212.891 43.7816 212.891 50.5098C212.891 57.238 211.1 62.4944 207.52 66.2637C203.939 70.033 199.209 71.918 193.348 71.918C187.487 71.9179 182.757 70.0329 179.176 66.2637C175.595 62.4944 174.273 57.238 174.273 50.5098C174.273 43.7816 175.595 38.5213 179.176 34.752C182.757 30.983 187.468 29.0997 193.348 29.0996ZM31.0605 20.3906C21.788 20.3906 15.285 24.1227 11.5156 31.5859C11.2141 32.189 10.8742 32.4727 10.4219 32.4727C9.96988 32.4726 9.7638 32.2476 9.76367 31.8145V22.0508H0V100H9.76367V69.373C9.76376 68.9398 9.98866 68.7149 10.4219 68.7148L10.582 68.7285C10.9484 68.7942 11.2683 69.0904 11.5156 69.6016C15.2661 77.0647 21.7881 80.7949 31.0605 80.7949C35.772 80.7949 40.1624 79.6463 44.252 77.3848C48.3415 75.1044 51.6772 71.6909 54.2402 67.1113C56.8033 62.5316 58.0859 57.0294 58.0859 50.584C58.0858 44.1386 56.8033 38.6362 54.2402 34.0566V34.0742C51.6584 29.4948 48.3414 26.0642 44.252 23.8027C40.4177 21.6647 36.3193 20.5387 31.9395 20.4062L31.0605 20.3906ZM28.7773 29.1738C34.6385 29.1738 39.3704 31.059 42.9512 34.8281C46.532 38.5974 48.3222 43.8559 48.3223 50.584C48.3223 57.3122 46.532 62.5705 42.9512 66.3398C39.3703 70.1091 34.6574 71.9941 28.7773 71.9941C22.8974 71.994 18.1863 70.109 14.6055 66.3398C11.0247 62.5705 9.70508 57.3122 9.70508 50.584C9.70512 43.8559 11.0247 38.5974 14.6055 34.8281C18.1863 31.0591 22.9164 29.1739 28.7773 29.1738Z"
      fill="currentColor"
    />
  </symbol>

  <!-- Word -->
  <symbol id="pplx-logo-word">
    <path
      d="M310.846 43.922H320.632V63.8822H307.966C298.037 63.8822 290.638 66.2483 285.737 70.9803C280.852 75.7123 278.401 83.4772 278.401 94.2751V159.698H258.4V44.3666H278.401V62.7707C278.401 63.8028 278.926 64.3269 279.961 64.3269C280.549 64.3269 280.995 64.1839 281.297 63.8822C281.6 63.5805 281.886 62.993 282.188 62.1038C286.039 49.9879 295.602 43.922 310.862 43.922H310.846ZM441.502 68.646C446.753 77.8877 449.395 89.0191 449.395 102.024C449.395 115.029 446.769 126.161 441.502 135.402C436.235 144.644 429.425 151.552 421.055 156.141C412.685 160.73 403.679 163.016 394.052 163.016C375.084 163.016 361.75 155.474 354.048 140.388C353.459 139.213 352.712 138.61 351.82 138.61C350.929 138.61 350.484 139.055 350.484 139.944V201.825H330.482V44.3666H350.484V64.1045C350.484 64.9938 350.929 65.4384 351.82 65.4384C352.712 65.4384 353.444 64.8509 354.048 63.6599C361.75 48.5746 375.084 41.032 394.052 41.032C403.679 41.032 412.685 43.3186 421.055 47.9077C429.425 52.4968 436.235 59.4043 441.502 68.646ZM429.393 102.024C429.393 88.4157 425.733 77.8083 418.397 70.2022C411.062 62.596 401.403 58.785 389.389 58.785C377.376 58.785 367.717 62.596 360.381 70.2022C353.046 77.8242 350.357 88.4316 350.357 102.024C350.357 115.617 353.046 126.24 360.381 133.846C367.717 141.468 377.392 145.263 389.389 145.263C401.387 145.263 411.062 141.452 418.397 133.846C425.733 126.24 429.393 115.617 429.393 102.024ZM111.004 68.8207C116.255 78.0624 118.897 89.1938 118.897 102.199C118.897 115.204 116.271 126.335 111.004 135.577C105.737 144.819 98.9266 151.726 90.5568 156.315C82.1869 160.904 73.1806 163.191 63.5536 163.191C44.5862 163.191 31.2517 155.648 23.5502 140.563C22.9614 139.388 22.2135 138.785 21.3225 138.785C20.4314 138.785 19.9858 139.229 19.9858 140.119V202H0V44.5413H20.0017V64.2792C20.0017 65.1685 20.4473 65.6131 21.3384 65.6131C22.2295 65.6131 22.9614 65.0256 23.5661 63.8346C31.2676 48.7493 44.6021 41.2067 63.5696 41.2067C73.1965 41.2067 82.2028 43.4933 90.5727 48.0824C98.9426 52.6715 105.753 59.579 111.02 68.8207H111.004ZM98.8948 102.199C98.8948 88.5904 95.235 77.983 87.8994 70.3769C80.5639 62.7707 70.9051 58.9597 58.8913 58.9597C46.8776 58.9597 37.2188 62.7707 29.8833 70.3769C22.5477 77.9989 19.8585 88.6062 19.8585 102.199C19.8585 115.792 22.5477 126.415 29.8833 134.021C37.2188 141.643 46.8776 145.438 58.8913 145.438C70.9051 145.438 80.5639 141.627 87.8994 134.021C95.235 126.415 98.8948 115.792 98.8948 102.199ZM221.578 123.08H242.694C239.878 133.878 234.133 143.231 225.477 151.139C216.805 159.047 204.393 163.001 188.242 163.001C176.085 163.001 165.392 160.523 156.131 155.569C146.87 150.615 139.726 143.564 134.682 134.386C129.637 125.224 127.123 114.426 127.123 102.008C127.123 89.5908 129.574 78.7929 134.459 69.6305C139.344 60.4682 146.202 53.4019 155.017 48.4476C163.833 43.4933 174.16 41.0161 186.015 41.0161C197.869 41.0161 207.687 43.4615 215.914 48.3365C224.14 53.2114 230.283 59.6901 234.356 67.7409C238.43 75.8076 240.466 84.6364 240.466 94.2434V107.55H148.239C148.971 119.079 152.869 128.257 159.902 135.053C166.936 141.849 176.388 145.263 188.242 145.263C197.869 145.263 205.252 143.31 210.36 139.388C215.468 135.466 219.208 130.035 221.578 123.08ZM148.462 90.9246H218.253C218.253 80.873 215.659 72.9969 210.472 67.2963C205.284 61.6115 197.137 58.7532 186.03 58.7532C175.656 58.7532 167.174 61.5321 160.587 67.074C153.999 72.6158 149.957 80.5713 148.477 90.9087L148.462 90.9246ZM465.227 159.682H485.229V0H465.227V159.698V159.682ZM742.753 31.7744H766.113V6.8122H742.753V31.7744ZM825.163 142.5C821.535 142.866 819.339 143.056 818.607 143.056C817.573 143.056 816.745 142.755 816.157 142.167C815.568 141.579 815.266 140.77 815.266 139.722C815.266 138.991 815.457 136.8 815.823 133.179C816.189 129.559 816.379 123.969 816.379 116.443V61.2622H844.91L839.293 44.3666H816.395V13.3068H796.394V44.3508H774.642V61.2463H796.394V121.969C796.394 134.688 799.512 144.152 805.734 150.361C811.956 156.569 821.44 159.682 834.185 159.682H849.748V141.945H841.966C834.408 141.945 828.807 142.135 825.179 142.5H825.163ZM942.198 44.3508L909.084 141.119C908.639 142.31 907.939 143.866 905.663 143.866C903.388 143.866 902.688 142.31 902.242 141.119L869.129 44.3508H848.729L887.078 159.682H900.635C901.526 159.682 902.194 159.761 902.64 159.904C903.086 160.047 903.451 160.412 903.754 161.016C904.343 161.905 904.263 163.239 903.531 165.001L897.309 181.849C896.418 184.072 894.716 185.184 892.201 185.184C891.31 185.184 889.242 184.993 885.98 184.628C882.718 184.263 878.501 184.072 873.314 184.072H857.083V201.809H878.421C890.865 201.809 898.359 199.698 904.804 195.49C911.248 191.281 916.245 183.85 919.809 173.195L961.229 48.7652V44.3349H942.198V44.3508ZM677.418 87.3835L646.086 44.3508H624.08V48.7811L661.633 98.6896L615.853 155.251V159.682H638.305L674.76 113.33L708.765 159.682H730.326V155.251L690.545 102.024L733.667 49.0193V44.3666H711.215L677.433 87.3994L677.418 87.3835ZM744.886 159.682H764.887V44.3666H744.886V159.698V159.682ZM616.76 123.08C613.943 133.878 608.199 143.231 599.543 151.139C590.871 159.047 578.459 163.001 562.308 163.001C550.151 163.001 539.458 160.523 530.197 155.569C520.936 150.615 513.792 143.564 508.747 134.386C503.703 125.224 501.189 114.426 501.189 102.008C501.189 89.5908 503.64 78.7929 508.525 69.6305C513.41 60.4682 520.268 53.4019 529.083 48.4476C537.899 43.4933 548.226 41.0161 560.08 41.0161C571.935 41.0161 581.753 43.4615 589.98 48.3365C598.206 53.2114 604.348 59.6901 608.422 67.7409C612.495 75.8076 614.532 84.6364 614.532 94.2434V107.55H522.305C523.037 119.079 526.935 128.257 533.968 135.053C541.002 141.849 550.453 145.263 562.308 145.263C571.935 145.263 579.318 143.31 584.426 139.388C589.534 135.466 593.273 130.035 595.644 123.08H616.76ZM522.527 90.9246H592.319C592.319 80.873 589.725 72.9969 584.538 67.2963C579.35 61.6115 571.203 58.7532 560.096 58.7532C549.721 58.7532 541.24 61.5321 534.653 67.074C528.065 72.6158 524.023 80.5713 522.543 90.9087L522.527 90.9246Z"
      fill="currentColor"
    />
  </symbol>

  <!-- Education Pro -->
   <symbol id="pplx-logo-word-edu-pro">
    <path
      fill="currentColor"
      d="m 331.48047,12 c -2.202,0 -4.19447,0.350081 -5.98047,1.050781 -1.785,0.7006 -3.32233,1.73245 -4.61133,3.09375 -1.27,1.3612 -2.24201,3.022575 -2.91601,4.984375 -0.674,1.9418 -1.01172,4.184163 -1.01172,6.726563 0,3.3831 0.59415,6.254987 1.78515,8.617187 1.19,2.3421 2.8776,4.1338 5.0586,5.375 2.182,1.2411 4.73978,1.861328 7.67578,1.861328 2.201,0 4.19547,-0.350081 5.98047,-1.050781 1.785,-0.7006 3.31203,-1.7213 4.58203,-3.0625 1.269,-1.3613 2.24101,-3.022475 2.91601,-4.984375 0.694,-1.9818 1.04102,-4.233559 1.04102,-6.755859 0,-3.3632 -0.60445,-6.225691 -1.81445,-8.587891 -1.19,-2.3622 -2.8766,-4.16505 -5.0586,-5.40625 C 336.96495,12.620228 334.41547,12 331.48047,12 Z m 0,3.152344 c 3.173,0 5.74303,1.08214 7.70703,3.24414 1.963,2.1621 2.94531,5.315085 2.94531,9.458985 0,2.7625 -0.44684,5.083144 -1.33984,6.964843 -0.892,1.8818 -2.14105,3.314022 -3.74805,4.294922 -1.586,0.9609 -3.44245,1.441407 -5.56445,1.441407 -3.174,0 -5.74208,-1.080188 -7.70508,-3.242188 -1.964,-2.1821 -2.94727,-5.335184 -2.94727,-9.458984 0,-2.7426 0.44685,-5.0558 1.33985,-6.9375 0.893,-1.9018 2.13175,-3.332069 3.71875,-4.292969 1.607,-0.9809 3.47075,-1.472656 5.59375,-1.472656 z m -16.5918,-2.761719 c -1.40212,-0.02999 -2.58598,0.118919 -3.55273,0.449219 -1.289,0.4204 -2.32271,1.012737 -3.09571,1.773437 -0.754,0.7607 -1.34815,1.511253 -1.78515,2.251953 h -0.59571 v -4.144531 h -3.74804 v 30.267578 h 3.80859 V 25.482422 c 0,-2.5623 0.4263,-4.573756 1.2793,-6.035156 0.873,-1.4613 2.0819,-2.463407 3.6289,-3.003907 1.567,-0.5605 3.41316,-0.750512 5.53516,-0.570312 v -3.392578 c -0.51575,-0.05002 -1.00723,-0.07985 -1.47461,-0.08984 z m -31.10156,-0.361328 c -1.983,0 -3.66959,0.270047 -5.05859,0.810547 -1.368,0.5405 -2.48833,1.222168 -3.36133,2.042969 -0.873,0.8007 -1.54744,1.631387 -2.02344,2.492187 h -0.5957 V 12.720703 H 269 V 55 h 3.80859 V 38.423828 h 0.59375 c 0.476,0.8007 1.14114,1.612894 1.99414,2.433594 0.873,0.8208 1.99429,1.500515 3.36329,2.041015 1.369,0.5205 3.04434,0.78125 5.02734,0.78125 1.984,0 3.80761,-0.329634 5.47461,-0.990234 1.686,-0.6807 3.14305,-1.682706 4.37305,-3.003906 1.25,-1.3413 2.22201,-3.002475 2.91601,-4.984375 0.694,-1.9818 1.04102,-4.263303 1.04102,-6.845703 0,-3.4433 -0.60446,-6.337488 -1.81446,-8.679688 -1.19,-2.3622 -2.82715,-4.14265 -4.91015,-5.34375 -2.082,-1.2011 -4.44208,-1.802734 -7.08008,-1.802734 z m -0.56445,3.183594 c 3.134,0 5.67223,1.100634 7.61523,3.302734 1.944,2.182 2.91602,5.296044 2.91602,9.339844 0,2.0218 -0.25844,3.822797 -0.77344,5.404297 -0.496,1.5614 -1.20958,2.88189 -2.14258,3.96289 -0.932,1.081 -2.04303,1.902291 -3.33203,2.462891 -1.289,0.5405 -2.7162,0.810547 -4.2832,0.810547 -3.114,0 -5.64389,-1.091438 -7.58789,-3.273438 -1.944,-2.2021 -2.91602,-5.323487 -2.91602,-9.367187 0,-2.0219 0.24814,-3.8135 0.74414,-5.375 0.516,-1.5614 1.23988,-2.883844 2.17188,-3.964844 0.932,-1.081 2.04303,-1.900438 3.33203,-2.460938 1.289,-0.5606 2.70886,-0.841796 4.25586,-0.841796 z m -45.2461,-1.660157 c -4.236,0 -7.82989,1.2567 -9.96289,4.5 h -0.4668 v -3.828125 h -4.99609 V 44 h 5.14063 V 27.375 c 0,-6.5159 4.03218,-9.525391 9.11718,-9.525391 4.646,0 7.27539,2.132022 7.27539,6.982422 V 44 h 5.14258 V 24.335937 c 0,-7.2756 -4.325,-10.783203 -11.25,-10.783203 z m -34.33398,-0.0293 c -9.058,0 -15.16602,5.552015 -15.16602,15.603515 0,10.0223 6.10802,15.574219 15.16602,15.574219 9.029,0 15.16406,-5.551919 15.16406,-15.574219 0,-10.0515 -6.13506,-15.603516 -15.16406,-15.603515 z m 0,4.238281 c 5.932,0 9.93359,3.972734 9.93359,11.365234 0,7.3633 -4.00159,11.367188 -9.93359,11.367188 -5.96,0 -9.96485,-4.003888 -9.96485,-11.367188 0,-7.3925 4.00485,-11.365234 9.96485,-11.365234 z M 179.16211,3.5019531 V 9.140625 h 5.96094 V 3.5019531 Z m 0.38086,10.7226559 V 44 h 5.14258 V 14.224609 Z M 162.20898,6.0449219 v 8.1796871 h -7.04101 v 4.179688 h 7.04101 v 18.320312 c 0,4.8504 2.7753,7.275391 7.6543,7.275391 h 6.3125 v -4.441406 h -8.35742 l -0.4668,-0.466797 v -20.6875 h 8.91211 v -4.179688 h -8.91211 V 6.0449219 Z m -20.43945,7.4785161 c -7.714,0 -12.4485,3.448203 -13.0625,8.970703 v 0.876953 h 4.82227 c 0.409,-3.9154 3.27304,-5.75586 8.12304,-5.75586 4.822,0 7.30469,1.840528 7.30469,6.486328 v 1.082032 l -11.19141,1.402343 c -6.019,0.7597 -10.49023,3.359319 -10.49023,9.261719 0,5.5517 4.49974,8.794922 10.92773,8.794922 6.10701,0 9.20494,-2.424122 10.46094,-4.732422 h 0.46875 V 44 h 4.79102 V 24.394531 c 0,-7.4217 -4.4983,-10.871093 -12.1543,-10.871093 z m 7.1875,15.632812 v 1.841797 c 0,6.5744 -4.4693,9.496094 -9.9043,9.496094 -4.062,0 -6.66211,-1.78356 -6.66211,-4.88086 0,-3.1265 2.45344,-4.587281 6.39844,-5.113281 z M 112.25586,13.523438 c -8.912,0 -14.814454,5.493615 -14.814454,15.603515 0,10.0807 5.873454,15.574219 14.814454,15.574219 8.912,0 12.82692,-5.40536 13.29492,-10.25586 v -0.876953 h -4.82226 c -0.379,3.331 -2.48443,6.896485 -8.35743,6.896485 -5.99,0 -9.75976,-3.974591 -9.75976,-11.337891 0,-7.3925 3.79876,-11.365234 9.75976,-11.365234 5.785,0 8.00683,3.623403 8.29883,6.720703 h 4.79297 v -0.876953 c -0.38,-4.6751 -4.38303,-10.082031 -13.20703,-10.082031 z m -45.128907,0.701171 v 19.666016 c 0,7.2756 4.266406,10.78125 11.191406,10.78125 4.2369,0 7.800497,-1.256603 9.904297,-4.470703 h 0.46875 V 44 H 93.6875 V 14.224609 h -5.142578 v 16.626953 c 0,6.516 -3.974394,9.525391 -9.058594,9.525391 -4.6459,0 -7.216797,-2.133875 -7.216797,-6.984375 V 14.224609 Z M 56.679687,1.9238281 V 18.169922 h -0.466796 c -2.2207,-3.3018 -5.786347,-4.617188 -9.935547,-4.617188 -7.7431,0 -13.644532,5.259719 -13.644532,15.574219 0,10.2852 5.901432,15.544922 13.644532,15.544922 4.2369,0 7.832131,-1.343019 10.082031,-4.761719 h 0.466797 V 44 h 4.996094 V 1.9238281 Z M 47.330078,17.820312 c 5.6977,10e-7 9.554688,4.060241 9.554688,11.306641 0,7.2172 -3.856988,11.279297 -9.554688,11.279297 -5.6686,0 -9.52539,-4.062097 -9.525391,-11.279297 0,-7.2464 3.856791,-11.30664 9.525391,-11.306641 z M 16.888672,13.523438 c -8.8243301,0 -14.4335939,5.464218 -14.4335939,15.574218 0,10.1391 5.6678975,15.603516 14.4921879,15.603516 8.9411,0 12.388446,-5.492131 13.060546,-9.144531 v -0.876954 h -4.615234 c -0.4675,2.746601 -3.010706,5.873047 -8.503906,5.873047 -5.7855,0 -9.349927,-3.973368 -9.466797,-10.167968 H 30.621094 V 27.8125 c 0,-8.7658 -4.879022,-14.289062 -13.732422,-14.289062 z m -0.0293,4.121093 c 5.7855,0 8.795116,3.593535 8.853516,8.677735 H 7.5097656 c 0.40908,-5.0257 3.6811094,-8.677735 9.3496094,-8.677735 z"
    />
   </symbol>
</svg>
`,hK=A.memo(function(){return f.useEffect(()=>{const t=n=>{n.ctrlKey&&n.preventDefault()};return document.addEventListener("wheel",t,{passive:!1}),()=>{document.removeEventListener("wheel",t)}},[]),null}),FKe={default:{termsOfService:"https://www.perplexity.com/hub/legal/terms-of-service",enterpriseTermsOfService:"https://www.perplexity.com/hub/legal/enterprise-terms-of-service",privacyPolicy:"https://www.perplexity.com/hub/legal/privacy-policy"},"ja-JP":{termsOfService:"https://www.perplexity.com/ja/hub/legal/terms-of-service",privacyPolicy:"https://www.perplexity.com/ja/hub/legal/privacy-policy"}},Qi=4e4,VN=2e3,gK=10,UKe=10,yK=5e3,xK=50,lk=10,ck=1024*1024,bK=3,_K=500,_u="2.18",vK="default",JC="windowsapp",CK="ios",wK="android",uk=["audio/midi","audio/x-midi","application/zip","application/x-tar","application/x-bzip","application/vnd.rar"],ew=[".bash",".bat",".c",".coffee",".conf",".config",".cpp",".cs",".css",".csv",".cxx",".dart",".diff",".doc",".docx",".fish",".go",".h",".hpp",".htm",".html",".in",".ini",".ipynb",".java",".js",".json",".jsx",".ksh",".kt",".kts",".latex",".less",".log",".lua",".m",".markdown",".md",".pdf",".php",".pl",".pm",".pptx",".py",".r",".R",".rb",".rmd",".rs",".scala",".sh",".sql",".swift",".t",".tex",".text",".toml",".ts",".tsx",".txt",".xlsx",".xml",".yaml",".yml",".zsh"],SK=ew.join(","),GN=[".jpeg",".jpg",".jpe",".jp2",".png",".gif",".bmp",".tiff",".tif",".svg",".webp",".ico",".avif",".heic",".heif"],zN=[".mp3",".wav",".aiff",".ogg",".flac",".mp4",".mpeg",".mov",".avi",".flv",".mpg",".webm",".wmv",".3gp"],EK=GN.join(","),qN=[...ew,...GN],kK=qN.join(","),MK=[...ew,...zN],TK=MK.join(","),AK=[...qN,...zN],$N=AK.join(",");Yr.PUBLIC_READ;const BKe=Yr.PRIVATE_READ,dk=Yr.PRIVATE_READ,tw="login-source",fk="login-new",mk="pplx.tracked_singular_user_subscribed_paying",pk="pplx.tracked_singular_user_subscribed_paying_enterprise",WN=5,KN="/static/images/data-connectors/factset/factset-avatar.svg",YN="FactSet",QN="/static/images/data-connectors/crunchbase/crunchbase-avatar.svg",NK="Crunchbase",nw="/static/images/data-connectors/google/google-drive-avatar.svg",XN="/static/images/data-connectors/google/gmail-avatar.svg",RK="Gmail",rw="Google Drive",t0="/static/images/data-connectors/google/gcal-gmail-avatar.svg",ZN="Gmail with Calendar",rp="Microsoft",sw="/static/images/data-connectors/microsoft/onedrive-avatar.svg",aw="OneDrive",ow="/static/images/data-connectors/microsoft/sharepoint-avatar.svg",iw="SharePoint",lw="/static/images/data-connectors/dropbox/dropbox-avatar.svg",cw="Dropbox",n0="/static/images/data-connectors/box/box-avatar.svg",uw="Box",r0="/static/images/data-connectors/notion/notion-avatar.svg",dw="Notion",s0="/static/images/data-connectors/linear/linear-avatar.svg",fw="Linear",a0="/static/images/data-connectors/slack/slack-avatar.svg",mw="Slack (deprecated)",pw="Slack",o0="/static/images/data-connectors/github/github-avatar.svg",hw="GitHub",i0="/static/images/data-connectors/asana/asana-avatar.svg",Uc="Asana",l0="/static/images/data-connectors/atlassian/atlassian-avatar.svg",gw="Atlassian",yw="/static/images/data-connectors/jira/jira-avatar.svg",xw="Jira",bw="/static/images/data-connectors/confluence/confluence-avatar.svg",_w="Confluence",vw="/static/images/data-connectors/microsoft/teams-avatar.svg",Cw="Microsoft Teams",sp="search-model-change",Zl="source-selection-change",DK="windows-app",HKe=DK,VKe="If4YwAeizGHdB3eOhX2JxYcjeCgy0N9c",Px="pplx.windowsApp.microphonePermission",IK={silenceThreshold:30,silenceDuration:5e3},JN=["answer_modes","media_items","knowledge_cards","inline_entity_cards","place_widgets","finance_widgets","prediction_market_widgets","sports_widgets","flight_status_widgets","news_widgets","shopping_widgets","jobs_widgets","search_result_widgets","inline_images","inline_assets","placeholder_cards","diff_blocks","inline_knowledge_cards","entity_group_v2","refinement_filters","canvas_mode","maps_preview","answer_tabs","price_comparison_widgets","preserve_latex","generic_onboarding_widgets","in_context_suggestions","inline_claims"],jK=[...JN,"workflow_steps"],eR=({isWorkflowRedesignEnabled:e})=>e?jK:JN,hk=["google_drive","onedrive","sharepoint","dropbox","box"],tR=["google_drive","onedrive","sharepoint","dropbox","box"],nR="Outlook",ww="/static/images/data-connectors/microsoft/outlook-avatar.svg",Sw="Zoom",Ew="/static/images/data-connectors/zoom/zoom-avatar.svg";function PK(e){const t=new Uint8Array(e);return Array.from(t).map(n=>n.toString(16).padStart(2,"0")).join("")}async function OK(e){const n=new TextEncoder().encode(e);return await crypto.subtle.digest("SHA-256",n)}async function rR(e){const t=await OK(e);return PK(t)}async function LK(e){return`match_${await rR(e)}`}const FK=async({reason:e})=>{try{const{data:t,error:n}=await ve.POST("/rest/attribution/comet/session",e,{timeoutMs:Ct(),numRetries:1});if(n)throw n;return{success:t.success}}catch(t){return Z.error("Failed to start Comet session",t),{success:!1}}},UK=async({eventName:e,reason:t})=>{try{const{data:n,error:r}=await ve.POST("/rest/attribution/comet/event/{event_name}",t,{timeoutMs:Ct(),params:{path:{event_name:e}}});if(r)throw r;return{success:n?.success??!1}}catch(n){return Z.error("Failed to send Comet event",n),{success:!1}}},sR=Bt("SingularAttributionContext",{sendQueryEventSingular:()=>Promise.resolve(),maybeSendNthQueryEventSingular:()=>Promise.resolve(),sendSubscribedEventSingular:()=>Promise.resolve(),sendAppDownloadClickedEventSingular:()=>Promise.resolve(),sendResurrectedActivationEventSingular:()=>Promise.resolve(),sendCometDownloadPageLoadEventSingular:()=>Promise.resolve(),sendCometDownloadPageSignInEventSingular:()=>Promise.resolve(),sendCometDownloadedEventSingular:()=>Promise.resolve(),sendCometDownloadButtonClickedEventSingular:()=>Promise.resolve(),sendCometWaitlistButtonClickedEventSingular:()=>Promise.resolve(),sendCometDownloadLinkEmailEventSingular:()=>Promise.resolve(),sendSubscribedMaxEventSingular:()=>Promise.resolve(),sendAssistantConnectorClickedEventSingular:()=>Promise.resolve(),sendEmailAssistantTrialEnrolledEventSingular:()=>Promise.resolve(),sendAssistantPaywallPageVisitEventSingular:()=>Promise.resolve(),sendAssistantStartFreeTrialClickedEventSingular:()=>Promise.resolve(),sendAssistantUpgradeToMaxClickedEventSingular:()=>Promise.resolve(),sendAssistantUpgradeToProClickedEventSingular:()=>Promise.resolve(),sendAssistantPaywallDismissedEventSingular:()=>Promise.resolve(),sendAssistantConnectPageVisitEventSingular:()=>Promise.resolve(),sendAssistantGreetingPageVisitEventSingular:()=>Promise.resolve(),sendAssistantCalendarSelectionPageVisitEventSingular:()=>Promise.resolve(),sendAssistantTimeSettingsPageVisitEventSingular:()=>Promise.resolve(),sendAssistantAutoLabelPageVisitEventSingular:()=>Promise.resolve(),sendAssistantAutoDraftPageVisitEventSingular:()=>Promise.resolve(),sendAssistantCompletePageVisitEventSingular:()=>Promise.resolve(),sendAssistantOnboardingEmailSentEventSingular:()=>Promise.resolve(),sendStudyHubPageVisitedEventSingular:()=>Promise.resolve(),sendChatWithTutorClickedEventSingular:()=>Promise.resolve(),sendPracticeQuestionsClickedEventSingular:()=>Promise.resolve(),sendStudyGuideClickedEventSingular:()=>Promise.resolve(),sendFlashcardsClickedEventSingular:()=>Promise.resolve(),sendOnePagerClickedEventSingular:()=>Promise.resolve(),sendSpacedRepetitionClickedEventSingular:()=>Promise.resolve(),sendMaterialsUploadedEventSingular:()=>Promise.resolve(),sendStudyHubActivatedEventSingular:()=>Promise.resolve(),sendThirdStudyHubEngagementEventSingular:()=>Promise.resolve(),sendFifthStudyHubEngagementEventSingular:()=>Promise.resolve(),sendTenthStudyHubEngagementEventSingular:()=>Promise.resolve(),setMatchIdWithEmail:()=>Promise.resolve()}),gk={1:"activated",3:"true activated",5:"quality activated",10:"super activated"},yk={1:"first comet query",3:"third comet query"},BK="ai.testing.perplexity",HK="ai.perplexity",aR=async(e,t)=>{if(!e)return null;const n=new Date;n.setMilliseconds(0);const r=`${e}-${n.toISOString()}-${t}`;return await rR(r)},VK="perplexity_ai_039eb8fb",GK="1e0179ca95965b57a3e91c1cf3049b64",zK=async({productId:e,visitorId:t,userId:n})=>{const{SingularConfig:r,singularSdk:s}=await W(async()=>{const{SingularConfig:c,singularSdk:u}=await import("./singular-sdk-77vC0ODm.js").then(d=>d.s);return{SingularConfig:c,singularSdk:u}},[]),a=new r(VK,GK,e);n&&a.withCustomUserId(n),s.init(a);const o="initialized singular",i=await aR(t,o);return s.event(o,{visitorId:t,eventId:i}),s},qK=({children:e})=>{const{session:t}=je(),n=_s(Eq),{env:{isProduction:r,isStaging:s},device:{isMobile:a}}=jn(),o=f.useRef([]),i=f.useRef([]),c=nn(),[u,d]=f.useState(void 0);f.useEffect(()=>{const y=t?.user?.id,b=r||s?HK:BK;n&&zK({userId:y,productId:b,visitorId:n}).then(x=>{!x||(d({sdk:x}),!y||!mn())||j5()>1||FK({reason:"comet attribution"})})},[r,s,t?.user?.id,n]);const m=f.useCallback(async(y,b)=>{if(!u){o.current.push({name:y,extraArguments:b});return}if(!n)return;const x=await aR(n,y),_={...b,visitorId:n,eventId:x,isMobile:a};i.current.includes(y)||(u.sdk.event(y,_),i.current.push(y))},[u,n,a]),p=f.useCallback(async({isCometBrowser:y})=>{const b=kq(),x=j5(),_=J9();b&&gk[b]&&await m(gk[b]),x&&yk[x]&&await m(yk[x]),y&&_===1&&UK({eventName:"activated",reason:"comet attribution"})},[m]),h=f.useCallback(async y=>{if(!u)return;const b=await LK(y);u.sdk.setMatchID(b)},[u]),g=f.useCallback(async y=>{await m("user sign in",{isNewUser:y}),t?.user?.id&&u&&u.sdk.login(t.user.id)},[t?.user?.id,u,m]);return f.useEffect(()=>{u&&o.current.length>0&&(o.current.filter((b,x,_)=>x===_.findIndex(v=>v.name===b.name)).forEach(({name:b,extraArguments:x})=>{m(b,x)}),o.current=[])},[u,m]),f.useEffect(()=>{if(c?.get(tw)&&c?.get(fk)){const y=c?.get(fk)==="true";g(y),y?(m("new user sign in"),t?.user?.email&&h(t.user.email)):m("existing user sign in"),mn()&&m("comet user sign in")}},[c,g,m,t?.user?.email,h]),f.useEffect(()=>{t?.user?.subscription_tier&&t?.user?.payment_tier==="paid"&&(yt.getItem(mk)||(m("user subscribed paying"),yt.setItem(mk,"true")),t?.user?.subscription_source==="enterprise"&&!yt.getItem(pk)&&(m("user subscribed paying enterprise"),yt.setItem(pk,"true")))},[t?.user?.subscription_tier,t?.user?.payment_tier,t?.user?.subscription_source,m]),l.jsx(sR.Provider,{value:f.useMemo(()=>({sendQueryEventSingular:()=>m("query submitted"),maybeSendNthQueryEventSingular:p,sendSubscribedEventSingular:()=>m("user subscribed"),sendAppDownloadClickedEventSingular:y=>m("app download button clicked",{origin:y}),sendResurrectedActivationEventSingular:()=>m("resurrected activated"),sendCometDownloadPageLoadEventSingular:y=>m(`${y} page loaded`),sendCometDownloadPageSignInEventSingular:y=>m(`${y} page signed in`),sendCometDownloadedEventSingular:()=>m("download-comet comet downloaded"),sendCometDownloadButtonClickedEventSingular:y=>m(`${y} download button clicked`),sendCometWaitlistButtonClickedEventSingular:y=>m(`${y} waitlist button clicked`),sendCometDownloadLinkEmailEventSingular:y=>m(`${y} send download link`),sendSubscribedMaxEventSingular:()=>m("user subscribed max"),sendAssistantConnectorClickedEventSingular:y=>m("assistant connector clicked",{connectorType:y}),sendEmailAssistantTrialEnrolledEventSingular:()=>m("email assistant trial enrolled"),sendAssistantPaywallPageVisitEventSingular:()=>m("assistant paywall page visit"),sendAssistantStartFreeTrialClickedEventSingular:()=>m("assistant start trial clicked"),sendAssistantUpgradeToMaxClickedEventSingular:()=>m("assistant upgrade max clicked"),sendAssistantUpgradeToProClickedEventSingular:()=>m("assistant upgrade pro clicked"),sendAssistantPaywallDismissedEventSingular:()=>m("assistant paywall dismissed"),sendAssistantConnectPageVisitEventSingular:()=>m("assistant connect page visit"),sendAssistantGreetingPageVisitEventSingular:()=>m("assistant greeting page visit"),sendAssistantCalendarSelectionPageVisitEventSingular:()=>m("assistant cal selection visit"),sendAssistantTimeSettingsPageVisitEventSingular:()=>m("assistant time settings visit"),sendAssistantAutoLabelPageVisitEventSingular:()=>m("assistant auto label page visit"),sendAssistantAutoDraftPageVisitEventSingular:()=>m("assistant auto draft page visit"),sendAssistantCompletePageVisitEventSingular:()=>m("assistant complete page visit"),sendAssistantOnboardingEmailSentEventSingular:()=>m("assistant onboarding email sent"),sendStudyHubPageVisitedEventSingular:()=>m("study hub page visited"),sendChatWithTutorClickedEventSingular:()=>m("chat with tutor clicked"),sendPracticeQuestionsClickedEventSingular:()=>m("practice questions clicked"),sendStudyGuideClickedEventSingular:()=>m("study guide clicked"),sendFlashcardsClickedEventSingular:()=>m("flashcards clicked"),sendOnePagerClickedEventSingular:()=>m("one pager clicked"),sendSpacedRepetitionClickedEventSingular:()=>m("spaced repetition clicked"),sendMaterialsUploadedEventSingular:()=>m("materials uploaded"),sendStudyHubActivatedEventSingular:()=>m("study hub activated"),sendThirdStudyHubEngagementEventSingular:()=>m("third study hub engagement"),sendFifthStudyHubEngagementEventSingular:()=>m("fifth study hub engagement"),sendTenthStudyHubEngagementEventSingular:()=>m("tenth study hub engagement"),setMatchIdWithEmail:h}),[m,p,h]),children:e})},oR=()=>{const e=f.useContext(sR);if(!e)throw new Error("useSingularAttribution must be used within SingularAttributionContext");return e};var un;(function(e){e.Preview="preview",e.Source="source"})(un||(un={}));function GKe(){return{loading:!1,activeTab:un.Preview,title:void 0,icon:void 0}}const zKe=(e,t)=>Va(t).with({type:"setLoading"},({loading:n,assetType:r})=>({...e,loading:n,loadingAssetType:r})).with({type:"setAsset"},({assetUuid:n,title:r,backendUuid:s,asset:a})=>({...e,assetUuid:n,title:r,backendUuid:s,asset:a})).with({type:"setTitle"},({title:n,icon:r})=>({...e,title:n,icon:r})).with({type:"setTab"},({tab:n})=>({...e,activeTab:n})).exhaustive(),iR=Bt("CanvasContext",{openCanvas:()=>{},closeCanvas:()=>{},isCanvasOpen:!1,doCanvasAction:()=>{},setCanvasDispatch:()=>{},setCanvasState:()=>{},createAssetClickHandler:()=>()=>{}}),Dl=()=>f.useContext(iR),$K=e=>{switch(e?.asset_type){case"CODE_ASSET":return"Python";case"CHART":return e.chart?.name??"Chart";case"CODE_FILE":return e.code_file?.filename??"Code File";case"APP":case"SLIDES":return e.app?.name??"App";case"PDF_FILE":return e.pdf_file?.name??"PDF";case"DOCX_FILE":return e.docx_file?.name??"Document";case"DOC_FILE":return e.doc_file?.name??"Document";case"XLSX_FILE":return e.xlsx_file?.name??"Spreadsheet";case"QUIZ":return e.quiz?.title??"Quiz";case"FLASHCARDS":return e.flashcards?.title??"Flashcards";case"GENERATED_IMAGE":return"Generated Image";case"GENERATED_VIDEO":return"Generated Video";default:return"Asset"}},kw=e=>{const{$t:t}=Q();return Va(e?.asset_type).with("CODE_ASSET",()=>({description:t({defaultMessage:"Programming",id:"4MsdoHG9QN"}),title:t({defaultMessage:"Python",id:"/Z1NW3qKj6"}),Icon:D("code")})).with("CHART",()=>({description:t({defaultMessage:"Code Interpreter Graph",id:"F3E5l9GC7U"}),title:e?.chart?.name??t({defaultMessage:"Chart",id:"nFVuBOECC+"}),Icon:D("chart-histogram")})).with("CODE_FILE",()=>({description:t({defaultMessage:"Generated File",id:"x6KEQZ7oaM"}),title:e?.code_file?.filename??"",Icon:D("file")})).with("APP",()=>({description:t({defaultMessage:"Generated App",id:"t7mMyC1O7+"}),title:e?.app?.name??"",Icon:D("layout-collage")})).with("SLIDES",()=>({description:t({defaultMessage:"Presentation",id:"7zHbpiyvPE"}),title:e?.app?.name??"",Icon:D("presentation")})).with("GENERATED_IMAGE",()=>({description:"",title:t({defaultMessage:"Generated Image",id:"Kt4lbw5KkH"}),Icon:D("image-in-picture")})).with("GENERATED_VIDEO",()=>({description:"",title:t({defaultMessage:"Generated Video",id:"Gh4spqP8w0"}),Icon:D("video")})).with("PDF_FILE",()=>({description:t({defaultMessage:"PDF Document",id:"Idloyb3SW4"}),title:e?.pdf_file?.name??t({defaultMessage:"PDF Document",id:"Idloyb3SW4"}),Icon:D("file-type-pdf")})).with("DOCX_FILE",()=>({description:t({defaultMessage:"Word Document",id:"q+bgjo7qbJ"}),title:e?.docx_file?.name??"",Icon:D("file-type-docx")})).with("DOC_FILE",()=>({description:t({defaultMessage:"Document",id:"wmirkPk7bp"}),title:e?.doc_file?.name??"",Icon:D("file-type-doc")})).with("RESEARCH_REPORT",()=>({description:t({defaultMessage:"Deep research report",id:"PrFYCTLzHd"}),title:e?.research_report?.name??t({defaultMessage:"Research Report",id:"3I+Y0b82To"}),Icon:D("file-report")})).with("XLSX_FILE",()=>({description:t({defaultMessage:"Excel Spreadsheet",id:"eMPZOuxga0"}),title:e?.xlsx_file?.name??"",Icon:D("file-spreadsheet")})).with("QUIZ",()=>({description:t({defaultMessage:"Quiz",id:"OuR/Ijtl93"}),title:e?.quiz?.title??"",Icon:D("checklist")})).with("FLASHCARDS",()=>({description:t({defaultMessage:"Flashcards",id:"c2+pp7T4ws"}),title:e?.flashcards?.title??"",Icon:D("cards")})).otherwise(()=>({description:"",title:t({defaultMessage:"Generated Document",id:"wsE2DeDuOG"}),Icon:D("file")}))},Js=Object.freeze({tab:void 0,citations:void 0,checkSources:void 0,inlineNav:void 0,councilResponse:void 0,claimsPanel:void 0});function WK(e){switch(e.tabType){case"citations":return{...Js,tab:{name:"citations",resizable:!1,size:"narrow"},citations:e.citations};case"check_sources":return{...Js,tab:{name:"check_sources",resizable:!0,size:"wide"},checkSources:e.checkSources};case"inline_nav":return{...Js,tab:{name:"inline_nav",resizable:!1,size:"narrow"},inlineNav:e.inlineNav};case"canvas":return{...Js,tab:{name:"canvas",resizable:!0,size:"wide"}};case"pdf":return{...Js,tab:{name:"pdf",resizable:!0,size:"wide"}};case"transcript":return{...Js,tab:{name:"transcript",resizable:!0,size:"wide"}};case"council_response":return{...Js,tab:{name:"council_response",resizable:!0,size:"wide"},councilResponse:e.councilResponse};case"claims":return{...Js,tab:{name:"claims",resizable:!1,size:"narrow"},claimsPanel:e.claimsPanel};default:return St(e)}}function KK(e,t){switch(t.action){case"open":return WK(t);case"close":return Js;case"updateCheckSources":return e.checkSources?{...e,checkSources:{...e.checkSources,...t.checkSources}}:e;default:return St(t)}}const lR=Bt("SideContentContext",{...Js,dispatch:()=>null});function vu(){return f.useContext(lR)}const YK=({children:e})=>{const[t,n]=f.useReducer(KK,Js),r=sr(),s=f.useRef(r);f.useEffect(()=>{s.current!==r&&(s.current=r,n({action:"close"}))},[r]);const a=f.useMemo(()=>({...t,dispatch:n}),[t]);return l.jsx(lR.Provider,{value:a,children:e})},QK=A.memo(function({children:t}){const{tab:n,dispatch:r}=vu(),s=f.useRef(void 0),[a,o]=f.useState(),i=hn(),c=sr(),u=nn(),d=f.useRef(c),m=f.useRef(u);d.current=c,m.current=u;const p=f.useCallback(()=>{r({action:"open",tabType:"canvas"});const v=new URLSearchParams(m.current?.toString());v.set("preview","1"),i.replace(`${d.current}?${v.toString()}`)},[i,r]),h=f.useCallback(()=>{r({action:"close"}),s.current=void 0;const v=new URLSearchParams(m.current?.toString());v.delete("preview"),i.replace(`${d.current}?${v.toString()}`)},[i,r]),g=f.useRef([]),y=f.useCallback(v=>{s.current?s.current(v):g.current.push(v)},[]),b=f.useCallback(v=>{s.current=v,g.current.length>0&&v&&(g.current.forEach(C=>v(C)),g.current=[])},[]),x=f.useCallback(({backendUuid:v})=>C=>{if(!C)return;const w=$K(C);p(),y({type:"setAsset",assetUuid:C.uuid??"",title:w,backendUuid:v,asset:C}),y({type:"setTab",tab:un.Preview})},[p,y]),_=f.useMemo(()=>({openCanvas:p,closeCanvas:h,isCanvasOpen:n?.name==="canvas",setCanvasDispatch:b,doCanvasAction:y,canvasState:a,setCanvasState:o,createAssetClickHandler:x}),[p,h,b,y,a,n,x]);return l.jsx(iR.Provider,{value:_,children:t})}),cR=(e,t)=>{const{value:n,loading:r}=Lt({flag:"comet-mcp-enabled",defaultValue:e,extraAttributes:t,subjectType:"visitor_id"});return f.useMemo(()=>({variation:n,loading:r}),[n,r])},XK=(e,t)=>{const{value:n,loading:r}=BC({flag:"comet-mobile-classifier-timeout",defaultValue:e,extraAttributes:t,subjectType:"visitor_id"});return f.useMemo(()=>({variation:n,loading:r}),[n,r])},Cu=async({entryUUID:e,reason:t})=>{try{const{error:n}=await ve.POST("/rest/sse/perplexity_terminate",t,{headers:{"content-type":"application/json"},body:{entry_uuid:e},timeoutMs:Ct({productionMs:5e3}),numRetries:1});return!n}catch(n){return Z.error("Failed to terminate entry",n),!1}},xk=Object.freeze({version:"",minVersion:0,webResourcesBuild:""});function nl(){return typeof window<"u"?window.__PPL_CONFIG__??xk:xk}const uR="comet-sidecar-threads-by-id",eo=()=>!!ul(),Mw=e=>!(e.defaultPrevented||!mn()||e.ctrlKey||e.metaKey),ZK=e=>{const t=yt.getItem(uR);if(t){const n=JSON.parse(t);for(const[r,{url:s,updatedAt:a}]of Object.entries(n))e.getState().actions.setSidecarUrlById(r,s,a)}},bk=e=>{const t=e.getState().sidecarUrlById,n={};t.forEach((r,s)=>{s!=="-1"&&(r.url==="/sidecar/"||r.url==="/sidecar"||(n[s]={url:r.url,updatedAt:r.updatedAt}))}),yt.setItem(uR,JSON.stringify(n))},JK=(e,t)=>{const n=e.getState().sidecarSourceTab,r=js(n.tabId,n.secondaryTab?.tabId),s=e.getState().sidecarUrlById.get(r)?.url;!s||new URL(window.location.href).pathname===s||t.replace(s,"Sidecar thread restored from cache")},eY="npclhjbddhklpbnacpjloidibaggcgon",tY="entropy-agent-extension-main";function nY(){return{sendMessage:()=>Promise.reject(new Xo("MOBILE_BROWSER_ERROR")),sendMessageToPort:()=>()=>{},isConnected:()=>!1}}function _k({onMessage:e,extensionId:t,name:n}){if(Si())return nY();const r=1;let s,a,o=!1,i=!1,c=!1,u=0,d=!0;const m=()=>{d||u++,d=!1,s&&clearTimeout(s),u++,s=setTimeout(g,1e3)},p=()=>{a=void 0,u>r&&mn()&&!i&&(Z.warn("Disconnected. Attempting to reconnect...",{extensionId:t}),i=!0),m()},h=()=>{if(a){a.onMessage.removeListener(e),a.onDisconnect.removeListener(p),clearTimeout(s);try{a.disconnect()}catch{}a=void 0}};function g(){if(h(),typeof chrome>"u"||!chrome.runtime){mn()&&(o||(Z.error("Comet browser is missing chrome.runtime",{extensionId:t}),o=!0),m());return}try{a=chrome.runtime.connect(t,{name:n}),a.onMessage.addListener(e),a.onDisconnect.addListener(p),o=!1,i=!1,c=!1,u>r&&mn()&&Z.info("Extension reconnected successfully",{extensionId:t,reconnect_attempts:u})}catch(y){a=void 0,m(),Z.error("Failed to connect to extension",{err:y,extensionId:t})}}return mn()&&(g(),Is("web.frontend.comet_extension_connected",{extensionId:t,startTime:eN(),duration:performance.now()})),{sendMessage:y=>(!a&&u>r&&mn()&&!c&&(Z.warn("Attempting to send message while main port is not connected",{extensionId:t}),c=!0),rY(t,y)),sendMessageToPort:y=>{if(!mn())return()=>{};!a&&u>r&&!c&&(Z.warn("Attempting to send message to port while main port is not connected",{extensionId:t}),c=!0);const b=chrome.runtime.connect(t,{name:`${n}_${crypto.randomUUID()}`});return b.postMessage(y),()=>{try{b.disconnect()}catch{}}},isConnected:()=>!!a}}async function rY(e,t){return new Promise((n,r)=>{if(wN()){r(new Xo("INCOGNITO_BROWSER_ERROR"));return}if(!mn()){r(new Xo("INVALID_BROWSER_ERROR"));return}if(typeof chrome>"u"||!chrome.runtime){r(new Xo("MISSING_RUNTIME_ERROR",{details:{extensionId:e,messageType:typeof t=="object"&&t!==null&&"type"in t?t.type:void 0,message:t}}));return}chrome.runtime.sendMessage(e,t,s=>{if(chrome.runtime.lastError){r(new Xo("RUNTIME_LAST_ERROR",{message:chrome.runtime.lastError.message,cause:chrome.runtime.lastError,details:{extensionId:e,messageType:typeof t=="object"&&t!==null&&"type"in t?t.type:void 0,message:t}}));return}n(s)})})}class sY{requests=new Map;bridge;get isAvailable(){if(!(typeof window>"u"))return window.cometBridge!=null}constructor(){this.bridge=new Proxy({},{get:(t,n)=>r=>{const s=crypto.randomUUID(),a={request_id:s,[n]:r??{}};return new Promise((o,i)=>{this.requests.set(s,c=>{"error"in c?i(new Error(String(c.error))):o(c)}),window.cometBridge?.postMessage(JSON.stringify(a))})}}),this.startListenMessages()}startListenMessages(){window.cometBridge&&(window.cometBridge.onmessage=t=>{const n=t.data;if(n)try{const r=JSON.parse(n),s=this.requests.get(r.request_id);s?(this.requests.delete(r.request_id),s(r)):(console.warn("No callback found for requestId",r.request_id,r),Z.warn("No callback found for requestId",r.request_id,r))}catch(r){console.warn("Failed to parse bridge response",n,r),Z.warn("Failed to parse bridge response",n,r)}})}}class vk{bridge;get isAvailable(){if(!(typeof window>"u"))return window.webkit?.messageHandlers?.cometBridge!=null}constructor(){this.bridge=new Proxy({},{get:(t,n)=>async r=>{const a={request_id:crypto.randomUUID(),[n]:r??{}},o=await window.webkit?.messageHandlers?.cometBridge?.postMessage(JSON.stringify(a));if(!o)throw new Error("No response from cometBridge");return JSON.parse(o)}})}}const ch="mcp_tools_settings_v1";function aY(){return vi((e,t)=>({platformInfo:void 0,sidecarSourceTab:{url:"/",title:"",tabId:-1,secondaryTab:null},sidecarAutoOpenedThreads:{},screenshotToolEnabled:!0,activeTab:{url:"/",title:"",tabId:-1},voiceAssistantAssociatedWindowId:-1,voiceAssistantActiveTab:{url:"/",title:"",tabId:-1},sidecarUrlById:new Map,tasksState:{},navigationResults:{},classifierResults:{},omniboxInput:{},navigationMeta:{},taskScreenshots:{},taskComputerActions:{},userSelection:void 0,userSelectionByThreadId:new Map,mcpStdioServers:void 0,mcpTools:void 0,mcpDisabledServers:void 0,installedDxts:void 0,taskTabs:void 0,mcpToolsSettings:void 0,pendingTasks:new Map,inlineAssistantParams:{action:void 0,isWritingMode:!1,canInsert:!0},inlineAssistantDraggableRegions:new Map,navigationResultTimers:{},actions:{setPlatformInfo:n=>{e({platformInfo:n})},setSidecarUrlById:(n,r,s)=>{const a=t().sidecarUrlById;a.set(n,{url:r,updatedAt:s??Date.now()}),e({sidecarUrlById:a})},deleteSidecarUrlById:n=>{const r=t().sidecarUrlById;r.delete(n),e({sidecarUrlById:r})},setSourceTab:n=>{const r=t().sidecarSourceTab;if(Ff(r,n))return;let s=!0;try{const i=new URL(n.url);s=!((i.protocol==="chrome:"||i.protocol==="comet:")&&i.hostname!=="newtab")}catch{}const a=r.tabId===n.tabId&&r.secondaryTab?.tabId===n.secondaryTab?.tabId,o=r.url!==n.url;if(a&&o){const i=js(r.tabId,r.secondaryTab?.tabId);e(c=>{const u=new Map(c.userSelectionByThreadId);return u.delete(i),{sidecarSourceTab:n,screenshotToolEnabled:s,userSelectionByThreadId:u}})}else e({sidecarSourceTab:n,screenshotToolEnabled:s})},setSidecarAutoOpened:(n,r)=>{const s=t().sidecarAutoOpenedThreads;if(n)e({sidecarAutoOpenedThreads:{...s,[r]:!0}});else{const{[r]:a,...o}=s;e({sidecarAutoOpenedThreads:o})}},setActiveTab:n=>{const r=t().activeTab;r.tabId===n.tabId&&r.url===n.url&&r.title===n.title||(e({activeTab:n}),n.windowId===t().voiceAssistantAssociatedWindowId&&e({voiceAssistantActiveTab:n}))},setVoiceAssistantAssociatedWindow:n=>{t().voiceAssistantAssociatedWindowId!==n&&e({voiceAssistantAssociatedWindowId:n})},setVoiceAssistantActiveTab:n=>{const r=t().voiceAssistantActiveTab;r.tabId===n.tabId&&r.url===n.url&&r.title===n.title||e({voiceAssistantActiveTab:n})},setLastOmniboxInput:(n,r)=>{e(s=>({omniboxInput:{...s.omniboxInput,[n]:r}}))},createNavigationResultsTimer:(n,r)=>{e(s=>({navigationResultTimers:{...s.navigationResultTimers,[n]:mi(r)}}))},getNavigationResultsTimer:n=>t().navigationResultTimers[n],addNavigationResults:(n,{results:r,classifierResult:s,...a})=>{r?.length&&e(o=>{o.actions.getNavigationResultsTimer(n)?.addTimingOnce("web.frontend.comet_navigation_results_received_ms",{count:r.length});const i={navigationResults:{...o.navigationResults,[n]:r}};return s&&(i.classifierResults={...o.classifierResults,[n]:s}),a&&!o.navigationMeta[n]&&(i.navigationMeta={...o.navigationMeta,[n]:a}),i})},addTaskScreenshot:(n,r)=>{e(s=>({taskScreenshots:{...s.taskScreenshots,[n]:[...s.taskScreenshots[n]||[],r.startsWith("data:image/")?r:`data:image/png;base64,${r}`]}}))},addComputerAction:(n,r)=>{e(s=>({taskComputerActions:{...s.taskComputerActions,[n]:[...s.taskComputerActions[n]||[],r]}}))},setTaskState:(n,r)=>{e(s=>{const a={...s.tasksState};return r===void 0?delete a[n]:a[n]={is_paused:r},{tasksState:a}})},setUserSelection:n=>{{const r=t(),s=js(r.sidecarSourceTab.tabId,r.sidecarSourceTab.secondaryTab?.tabId);e(a=>{const o=new Map(a.userSelectionByThreadId);return o.set(s,n),{userSelectionByThreadId:o}})}},clearUserSelection:()=>{{const n=t(),r=js(n.sidecarSourceTab.tabId,n.sidecarSourceTab.secondaryTab?.tabId);e(s=>{const a=new Map(s.userSelectionByThreadId);return a.delete(r),{userSelectionByThreadId:a}})}},getUserSelection:()=>{const n=t();{const r=js(n.sidecarSourceTab.tabId,n.sidecarSourceTab.secondaryTab?.tabId);return n.userSelectionByThreadId?.get(r)}},setMcpStdioServers:n=>{e({mcpStdioServers:n})},setMcpTools:(n,r)=>{e(s=>({mcpTools:{...s.mcpTools,[n]:r}}))},removeMcpTools:n=>{e(r=>{const s={...r.mcpTools};return delete s[n],{mcpTools:s}})},setMcpDisabledServers:n=>{e({mcpDisabledServers:n}),yt.setItem("mcp_disabled_servers_v1",JSON.stringify(Array.from(n)))},setMcpToolsSettings:n=>{e({mcpToolsSettings:n}),yt.setItem(ch,JSON.stringify(n))},setMcpToolEnabled:(n,r,s)=>{e(a=>{const o=a.mcpToolsSettings||{},i={...o[n]||{}},c=i[r]??{enabled:!0},u={...i,[r]:{...c,enabled:s}},d={...o,[n]:u};return yt.setItem(ch,JSON.stringify(d)),{mcpToolsSettings:d}})},renameMcpServerInToolsSettings:(n,r)=>{e(s=>{const a=s.mcpToolsSettings||{};if(!a[n]||n===r)return s;const o={...a},i=a[n];return o[r]={...i},delete o[n],yt.setItem(ch,JSON.stringify(o)),{mcpToolsSettings:o}})},setInstalledDxts:n=>{e({installedDxts:n})},setTaskTabs:n=>{e({taskTabs:n})},setPendingTask:(n,r)=>{e(s=>{const a=new Map(s.pendingTasks);return a.set(n,r),{pendingTasks:a}})},deletePendingTask:n=>{e(r=>{const s=new Map(r.pendingTasks);return s.delete(n),{pendingTasks:s}})},getPendingTask:n=>t().pendingTasks.get(n),setInlineAssistantParams:n=>{e(r=>({inlineAssistantParams:{...r.inlineAssistantParams,...n}}))},setInlineAssistantDraggableRegion:n=>{const r=G5(n),s=Math.floor(n.origin.x),a=Math.floor(n.origin.y),o=Math.floor(n.size.width),i=Math.floor(n.size.height);e(c=>{const u=new Map(c.inlineAssistantDraggableRegions);return u.set(r,{origin:{x:s,y:a},size:{width:o,height:i}}),{inlineAssistantDraggableRegions:u}})},removeInlineAssistantDraggableRegion:n=>{const r=G5(n);e(s=>{const a=new Map(s.inlineAssistantDraggableRegions);return a.delete(r),{inlineAssistantDraggableRegions:a}})}}}))}const oY="mcjlamohcooanphmebaiigheeeoplihb",iY="streamId",lY=Object.freeze([]);class cY{tools;mobileProxy=new vk;isTestDebugMode=!1;platform="web";store=aY();mainExtension;agentExtension;taskTeardowns=new Map;emitter=X9();pendingServerRename;classifierApiTimeoutMs=SN;mobileAgentModule;managedOrganizationUUIDPromise;constructor(){const t=ul();t?.android_version&&(this.platform="android"),t?.ios_version&&(this.platform="ios"),this.mainExtension=_k({onMessage:this.handleMessage,extensionId:oY,name:"entropy_client_context"}),this.agentExtension=_k({onMessage:this.handleAgentExtensionMessage,extensionId:eY,name:tY}),this.tools=uY(this.agentExtension),this.platform==="web"?this.mainExtension.sendMessage({type:"INIT"}).then(n=>{n&&(this.isTestDebugMode=!!n.isTestDebugMode)},n=>{if(mn())throw n}):(this.mobileProxy=this.platform==="android"?new sY:new vk,this.mobileAgentModule=W(()=>import("./agent-B1e4Y2EN.js"),__vite__mapDeps([0,1,2,3])),this.fetchCurrentPageTab().catch(n=>{Z.error("[cometMobile] Error fetchCurrentPageTab",{error:n})})),A$()}getStore(){return this.store}getMobileProxy(){return this.mobileProxy}setClassifierApiTimeoutMs(t){this.classifierApiTimeoutMs=t}isAgentAvailable(){return this.platform!=="web"?!0:this.agentExtension.isConnected()}async openNewTab(t){const n=new URL(t);n.searchParams.delete("erp"),n.pathname=n.pathname.replace("/sidecar",""),await this.openTab({url:n.toString(),request_id:"openNewTab",key:"openNewTab",navigation_history:!1})}async moveSidecarToThread(t){try{return(await this.agentExtension.sendMessage({type:"MOVE_SIDECAR_TO_THREAD",payload:{tab_id:t}})).success}catch(n){return Z.error("MOVE_SIDECAR_TO_THREAD failed",n),!1}}_getNavigationResults(t){return this.store.getState().navigationResults[t]??lY}async closeSideCar(t={}){return this.send({type:"HIDE_SIDECAR",payload:t})}async openTab(t){if(this.platform!=="web"){const s=(await this.mobileProxy?.bridge.tabs_create({url:t.url,hidden:!1})).tab;return{is_success:!0,_metadata:{time:1},result:{tab_id:s.id,url:s.url??"",title:s.title??"",last_accessed:s.last_accessed??0,visit_count:1}}}return{is_success:!0,result:(await this.tools.OpenTab({key:t.key??"unknown",request_id:t.request_id??"unknown",url:t.url,tab_id:t.tabId,navigation_history:t.navigation_history})).tab}}async fetchMobileSearchResults(t,n){const[r,s]=await Promise.all([this.mobileProxy.bridge.fetch_navigation_search_results({query:t,stream_id:n}),N$(t,this.classifierApiTimeoutMs).catch(a=>(Z.error("Classifier API call failed, using defaults",{error:a,query:t,streamId:n}),R$))]);return{...r.nav_search_response,classifierResult:s}}async fetchNavigationResults(t,n){if(this.platform==="web"){const r=await this.send({type:"NAV_SEARCH",payload:{query:t,streamId:n}});if(!r.is_success)throw new Error("Failed to inject search results");return r}else return{...await this.fetchMobileSearchResults(t,n),_metadata:void 0}}async injectSearchResults(t,n,r={}){try{const s=mi(),a={streamId:n,...r};Jt("web.frontend.comet_navigation_run_inject",a),this.store.getState().actions.createNavigationResultsTimer(n,r),this.store.getState().actions.getNavigationResultsTimer(n)?.addTimingOnce("web.frontend.comet_navigation_request_sent_ms");const o=await this.fetchNavigationResults(t,n);if(this.store.getState().actions.addNavigationResults(n,o),this.platform!=="web"&&o.results?.length){const m=this.store.getState();HC({clientPayloadCacheKey:`nav-${n}`,cometBrowser:this,reason:"mobile_search_injection",navigationResults:o.results,maxChars:5e4,includeSidecar:!1,attachedTabs:[],cometState:m}).catch(p=>{Z.error("Failed to save mobile navigation results",{streamId:n,error:p})})}const c={type:o.type??"unknown",...a};s.addTiming("web.frontend.comet_navigation_search_results",c);const u=s.getAbsoluteStartTime(),d={...c,startTime:u};o.searchTime&&Is("web.frontend.comet_navigation_search_time",{duration:o.searchTime,...d}),o.classifyTime&&Is("web.frontend.comet_navigation_classify_time",{duration:o.classifyTime,...d}),o.networkingTime&&Is("web.frontend.comet_navigation_networking_time",{duration:o.networkingTime,...d}),this.platform==="web"&&o._metadata?.time&&Is("web.frontend.comet_navigation_extension_processing",{duration:o._metadata.time,...d})}catch(s){Z.error(new Xo("NAV_RESULTS_INJECTION_FAILED",{details:{streamId:n},cause:s}))}}async getIsCometDefaultBrowser(t){try{const n=await this.send({type:"GET_IS_DEFAULT_BROWSER",key:t});return n.is_success?n.isDefault:null}catch{return null}}async setCometAsDefaultBrowser(t){return this.send({type:"SET_AS_DEFAULT_BROWSER",key:t})}async getDidSkipCookieImportOnboarding(t){const r=(await this.send({type:"GET_ONBOARDING_IMPORT_STATUS",key:t})).importStatus==="NOT_IMPORTED";return Z.info("[getDidSkipCookieImportOnboarding]",r),r}notifyUserStateChanged(t){this.send({type:"USER_STATE_CHANGED",payload:t}).catch(()=>{})}subscribeCometNavigate(t){const n=r=>{const s=new URL(r.detail.url);I$({cometAdapter:this,urlSearchParams:s.searchParams}),delete window.pplxNavIntentEvent,Jt("comet_navigate");const a="/search/new";s.pathname==="/search"&&s.searchParams.has("q")&&(s.pathname=a);let o=a;if(o="/sidecar"+a,s.pathname===o){const i=crypto.randomUUID();s.searchParams.set(iY,i);const c=r.detail.text||"";this.store.getState().actions.setLastOmniboxInput(i,c)}t({url:s})};return window.pplxNavIntentEvent&&n(window.pplxNavIntentEvent),document.addEventListener("comet-navigate",n),()=>{document.removeEventListener("comet-navigate",n)}}subscribeToAgentStepUpdate(){const t=n=>{this.sendThreadStatusToMobile({status:"working",streamId:n.detail.streamId,displayDataId:n.detail.stepAction,allowClarifications:!0})};return document.addEventListener("comet-agent-step-update",t),()=>{document.removeEventListener("comet-agent-step-update",t)}}subscribeToCometQuery(t){const n=r=>{const s=r.detail.query;delete window.pplxCometQuery,t(s,{source:r.detail.source})};return window.pplxCometQuery&&n(window.pplxCometQuery),document.addEventListener("comet-query",n),()=>{document.removeEventListener("comet-query",n)}}getLastOmniboxInput(t){return this.store.getState().omniboxInput[t]}async getCookies(){if(this.platform!=="web")return{base64_cookies:(await this.mobileProxy.bridge.agent_get_cookies()).base64_cookies};const t=await this.agentExtension.sendMessage({type:"GET_ALL_COOKIES"});if(!t.success||!t.cookies)throw new Error(t.error??"Failed to get cookies");const n=JSON.stringify(t.cookies);return{base64_cookies:btoa(n)}}async searchTabs(t){if(this.platform!=="web"){const{tabs:r}=await this.mobileProxy.bridge.tabs_query();return{is_success:!0,tabs:r.map(s=>({tabId:s.id,title:s.title??"",url:s.url,isCurrent:!1,lastAccess:s.last_accessed??0,snippet:""})),_metadata:{time:1}}}return{is_success:!0,tabs:((await this.tools.SearchBrowser({queries:[],sources:["OPEN_TABS"],key:t,history_max_results:0,open_tabs_max_results:500,closed_tabs_max_results:0,request_id:t})).open_tabs_results??[]).map(r=>({...r,url:r.url??"",title:r.title??"",tabId:r.tab_id??-1,lastAccess:r.last_accessed??0}))}}async ungroupTabs(t,n,r){return{is_success:!0,tabIds:((await this.tools.UngroupTabs({group_ids:t.groupIds,tab_ids:t.tabIds,key:n,request_id:r})).ungrouped_tabs??[]).map(a=>({id:a.tab_id??-1,error:a.error})),groupIds:t.groupIds.map(a=>({id:a}))}}showNotification(){this.send({type:"SHOW_NOTIFICATION"}).catch(()=>{})}hideInlineAssistant(){this.send({type:"CLOSE_INLINE_ASSISTANT"}).catch(()=>{})}setInlineAssistantContentsSize(t){this.send({type:"SET_INLINE_ASSISTANT_CONTENTS_SIZE",payload:{size:t}}).catch(()=>{})}setInlineAssistantDraggableRegions(t){this.send({type:"SET_INLINE_ASSISTANT_DRAGGABLE_REGIONS",payload:{regions:t}}).catch(()=>{})}addInlineAssistantDraggableRegion(t){this.store.getState().actions.setInlineAssistantDraggableRegion(t);const n=Array.from(this.store.getState().inlineAssistantDraggableRegions.values());this.setInlineAssistantDraggableRegions(n)}removeInlineAssistantDraggableRegion(t){this.store.getState().actions.removeInlineAssistantDraggableRegion(t);const n=Array.from(this.store.getState().inlineAssistantDraggableRegions.values());this.setInlineAssistantDraggableRegions(n)}sendThreadStatusToMobile(t){const{status:n,streamId:r,text:s,displayDataId:a,allowClarifications:o}=t;this.mobileProxy.bridge.thread_status({type:n,text:s,stream_id:r,display_data_id:a,allow_clarifications:o??!1}).catch(i=>{Z.error("Failed to send thread status to mobile bridge",i)})}sendVoiceStatusToMobile(t){const{status:n,text:r}=t;this.mobileProxy.bridge.voice_status({type:n,text:r}).catch(s=>{Z.error("Failed to send voice status to mobile bridge",s)})}openUserSettings(){this.platform!=="web"&&this.mobileProxy.bridge.open_user_settings().catch(t=>{Z.error("Failed to open user settings on mobile",t)})}setNativeInputVisibility(t){this.platform!=="web"&&this.mobileProxy.bridge.set_native_input_visibility({visible:t}).catch(n=>{Z.error("Failed to set native input visibility",n)})}openNativeSheet(t){this.platform!=="web"&&this.mobileProxy.bridge.app_navigate({target:t}).catch(n=>{Z.error(`Failed to open native ${t} sheet`,n)})}subscribeToMobileCommands(t){const n=r=>{r.detail.cmd==="update-context"?this.store.getState().actions.setSourceTab({secondaryTab:null,tabId:r.detail.tab.id,title:r.detail.tab.title,url:r.detail.tab.url}):t?t(r.detail):r.detail.cmd==="stop"&&r.detail.subject==="thread"?this.emitter.emit("BROWSER_TASK_STOP"):Z.warn("[comet-mobile] Unknown mobile command",r.detail.cmd)};return document.addEventListener("comet-mobile-cmd",n),()=>{document.removeEventListener("comet-mobile-cmd",n)}}setTabProgress(t){this.send({type:"SET_TAB_PROGRESS",payload:t}).catch(()=>{})}voiceAssistantUserSpeakingVADChanged(t){this.send({type:"VOICE_ASSISTANT_USER_SPEAKING_VAD_CHANGED",payload:{isSpeaking:t}}).catch(()=>{})}voiceAssistantNotifyConnected(){this.send({type:"VOICE_ASSISTANT_NOTIFY_CONNECTED"}).catch(()=>{})}voiceAssistantNotifyDisconnected(){this.send({type:"VOICE_ASSISTANT_NOTIFY_DISCONNECTED"}).catch(()=>{})}voiceAssistantStop(){this.send({type:"VOICE_ASSISTANT_STOP"}).catch(()=>{})}voiceAssistantShowWindow(){this.send({type:"VOICE_ASSISTANT_SHOW_WINDOW"}).catch(()=>{})}voiceAssistantHideWindow(){this.send({type:"VOICE_ASSISTANT_HIDE_WINDOW"}).catch(()=>{})}voiceAssistantSetDraggableRegions(t){this.send({type:"VOICE_ASSISTANT_SET_DRAGGABLE_REGIONS",payload:{regions:t}}).catch(()=>{})}voiceAssistantSetWindowSize(t){this.send({type:"VOICE_ASSISTANT_SET_WINDOW_SIZE",payload:{size:t}}).catch(()=>{})}async searchTabGroups(t,n,r){return{is_success:!0,results:((await this.tools.SearchTabGroups({queries:t.queries,request_id:r,key:n})).tab_groups??[]).map(a=>({...a,id:a.id??-1,collapsed:a.collapsed??!1,color:a.color,tabs:(a.tabs??[]).map(o=>({...o,url:o.url??"",title:o.title??"",tabId:o.tab_id??-1,isCurrent:o.is_current_tab??!1}))}))}}showFeedbackForm(){this.send({type:"SHOW_FEEDBACK_FORM"}).catch(()=>{})}subscribeScreenshotCaptured(t){return this.emitter.on("SCREENSHOT_CAPTURED",t)}handleAgentExtensionMessage=t=>{try{Va(t).with({type:"SCREENSHOT_CAPTURED"},async({payload:{screenshot:n}})=>{const s=await(await fetch(n)).blob(),a=new File([s],"screenshot.png",{type:s.type});Z.info("Screenshot captured"),this.emitter.emit("SCREENSHOT_CAPTURED",a)}).with({type:"BROWSER_TASK_PROGRESS_SCREENSHOT"},async({payload:{screenshot:n,taskUuid:r}})=>{this.store.getState().actions.addTaskScreenshot(r,n)}).with({type:"ACTION_STARTED"},({payload:{uuid:n,action:r}})=>{this.store.getState().actions.addComputerAction(n,{action:r.action?.toLowerCase()??"",text:r.text,duration:r.duration})}).with({type:"BROWSER_TASK_PROGRESS"},({payload:{taskUuid:n,progress:r}})=>{const s=this.store.getState().actions.getPendingTask(n);s?.onProgress&&s.onProgress(r),this.emitter.emit("BROWSER_TASK_PROGRESS",n,r)}).with({type:"BROWSER_TASK_COMPLETE"},({payload:{taskUuid:n,result:r}})=>{const s=this.store.getState().actions.getPendingTask(n);s&&(this.store.getState().actions.deletePendingTask(n),s.resolve(r)),this.emitter.emit("BROWSER_TASK_COMPLETE",n,r)}).with({type:"BROWSER_TASK_STOP"},({payload:n})=>{Z.info("Browser task stopped"),this.emitter.emit("BROWSER_TASK_STOP",n.entryId)}).with({type:"BROWSER_TASK_PAUSE_RESUME_FRONTEND"},({payload:n})=>{Z.info("Browser task paused/resumed"),this.store.getState().actions.setTaskState(n.task_uuid,n.is_paused)}).with({type:"AGENT_TASK_FAILURE"},({payload:{taskUuid:n,extraHeaders:r,error:s}})=>{const a=this.store.getState().actions.getPendingTask(n);a&&(this.store.getState().actions.deletePendingTask(n),a.reject(new Error(s))),kx({clientPayloadCacheKey:n,errorType:s,errorMsg:"Agent task failure."},r,"CometAdapter").catch(o=>{Z.error("Error sending tool failure",o)})}).with({type:"USER_SELECTION_CAPTURED"},({payload:{selection:n}})=>{this.store.getState().actions.setUserSelection(n)}).with({type:"ACTIVE_TAB_CHANGED"},({payload:n})=>{this.store.getState().actions.setActiveTab(n)}).with({type:"VOICE_ASSISTANT_ASSOCIATED_WINDOW_CHANGED"},({payload:{windowId:n,activeTab:r}})=>{this.store.getState().actions.setVoiceAssistantAssociatedWindow(n),this.store.getState().actions.setVoiceAssistantActiveTab(r)}).with({type:"MOVE_THREAD_TO_SIDECAR"},({payload:{url:n,task_tab_ids:r,entry_id:s,thread_url_slug:a,auto_opened:o}})=>{if(o!==void 0){const u=this.store.getState().sidecarSourceTab,d=js(u.tabId,u.secondaryTab?.tabId);this.store.getState().actions.setSidecarAutoOpened(o,d)}let i,c;a?(c=new URL(window.location.href),c.pathname="/sidecar/search/"+a,i=c.toString()):s?(c=new URL(window.location.href),c.pathname="/sidecar/search/"+s,i=c.toString()):(c=new URL(n),c.pathname="/sidecar"+D$(c.pathname),i=c.toString()),r.forEach(u=>{const d=js(u,void 0);this.store.getState().actions.setSidecarUrlById(d,c.pathname)}),!(a&&window.location.pathname.includes(a))&&document.dispatchEvent(new CustomEvent("comet-navigate",{detail:{url:i,text:""}}))}).with({type:"GET_TASK_TABS"},({payload:{tabs:n}})=>{this.store.getState().actions.setTaskTabs(n)}).with({type:"MCP_STDIO_SERVER_CHANGED"},({payload:{serverName:n,changes:r,server:s}})=>{this.handleMcpStdioServerChanged(n,r,s)}).with({type:"MCP_PERSISTED_STDIO_SERVERS_LOADED"},()=>{this.handleMcpPersistedStdioServersLoaded()}).with({type:"MCP_STDIO_SERVER_ADDED"},({payload:{server:n}})=>{this.handleMcpStdioServerAdded(n)}).with({type:"MCP_STDIO_SERVER_REMOVED"},({payload:{serverName:n}})=>{this.handleMcpStdioServerRemoved(n)}).otherwise(n=>{Z.log("Unknown message type",n)})}catch(n){Z.error("Error parsing entropy message",n)}};async fetchOpenedTabs(){const t=await this.searchTabs("fetch_opened_tabs");return t.is_success?t.tabs.filter(n=>(n.url.startsWith("https://")||n.url.startsWith("file://"))&&!n.isCurrent).sort((n,r)=>r.lastAccess-n.lastAccess):[]}async getPersonalSuggestions(t,n){return this.send({type:"GET_PERSONAL_SUGGESTIONS",payload:t,key:n})}async getTopMostVisitedUrls(t,n){return this.send({type:"GET_TOP_MOST_VISITED_URLS",payload:t,key:n})}getQuickActions(t){return this.send({type:"GET_QUICK_ACTIONS",key:t})}async getHistorySummary(t,n=[],r=14,s=20){return this.SearchBrowser({queries:n,sources:["HISTORY"],key:t,request_id:"",start_time:r*24*60*60*1e3,history_max_results:s,open_tabs_max_results:s,closed_tabs_max_results:s})}async GetContent(t){return this.platform!=="web"?{contents:(await Promise.allSettled((t.pages??[]).map(async r=>r.id?(await this.mobileProxy.bridge.tabs_get_content({id:r.id})).tab_content:(await this.mobileProxy.bridge.tabs_get_url_content({url:r.url??""})).tab_content))).map(r=>r.status==="fulfilled"?r.value:void 0).filter(r=>r!==void 0).map(r=>({html:"",id:r.id,url:r.url,title:r.title??"",og_meta:r.og_meta??{},markdown:r.markdown??""}))}:this.tools.GetContent({pages:(t.pages??[]).map(n=>({id:n.id??-1,url:n.url??""})),key:t.key??"",request_id:t.request_id??"",filter:t.filter??"ALL"})}async GetVisibleTabScreenshot(t){return this.tools.GetVisibleTabScreenshot(t)}async SearchBrowser(t){const n=t.sources??[],r=t.queries??[];if(this.platform!=="web"){const s=n.includes("HISTORY")?Promise.allSettled((r.length?r:[""]).map(async c=>await this.mobileProxy.bridge.history_search({text:c,max_results:t.history_max_results,start_time:t.start_time,end_time:t.end_time}))):[],[{tabs:a},o]=await Promise.all([n.includes("OPEN_TABS")?this.mobileProxy.bridge.tabs_query():{tabs:[]},s]),i=o.map(c=>c.status==="fulfilled"?c.value.history_items:[]).flat().map(c=>({title:c.title??"",url:c.url,last_accessed:c.last_visit_time??Date.now(),visit_count:c.visit_count??1}));return{closed_tabs_results:[],history_results:i,open_tabs_results:a.map(c=>({tab_id:c.id,title:c.title??"",url:c.url??"",last_accessed:c.last_accessed??0,visit_count:1}))}}return this.tools.SearchBrowser(t)}async GetSidecarContext(t){if(this.platform!=="web"){const r=(await this.mobileProxy.bridge.tabs_query()).tabs.sort((o,i)=>(i.last_accessed??-1)-(o.last_accessed??-1))[0];if(!r)return{content:void 0,contents:[]};const s=(await this.mobileProxy.bridge.tabs_get_content({id:r?.id})).tab_content,a={id:s.id,html:"",markdown:s.markdown??"",og_meta:s.og_meta??{},title:s.title??"",url:s.url??""};return{content:a,contents:[a]}}return this.tools.GetSidecarContext({key:t.key??"",request_id:t.request_id??""})}async closeTabs(t,n,r){if(this.platform!=="web"){const{tabs:a}=await this.mobileProxy.bridge.tabs_query(),o=t.tabIds??[],i=a.filter(c=>o.includes(c.id));return i.forEach(c=>{this.mobileProxy.bridge.tabs_close({id:c.id})}),{is_success:!0,result:i.map(c=>({id:c.id,url:c.url,title:c.title??""}))}}return{is_success:!0,result:((await this.tools.CloseTabs({tab_ids:t.tabIds??[],key:n,request_id:r})).tabs??[]).map(a=>({id:a.tab_id??-1,url:a.url??"",title:a.title??"",...a}))}}async groupTabs(t,n,r){const s=await this.tools.GroupTabs({...t,tab_ids:t.tabIds,group_id:t.groupId,key:n,request_id:r});if(!s.tab_group)throw new Error("[GroupTabs] Tab group not found");return{is_success:!0,tabGroup:{id:s.tab_group.id??-1,title:s.tab_group.title,collapsed:s.tab_group.collapsed??!1,color:s.tab_group.color}}}async maybeSendSearchResult(t,n,r){if(!this.isTestDebugMode||!t)return;const a=[...t.web_results??[],...t.extra_web_results??[]].map(o=>({name:o.name,snippet:o.snippet,url:o.url,isClientContext:!!o.is_client_context}));return this.send({type:"PERPLEXITY_SEARCH_RESULT",payload:{answer:t.answer,webResults:a,isPending:r,steps:n.map(o=>o.step_type)}})}submitTask(t,n){return new Promise((r,s)=>{const a=t.entryId,o=t.uuid??"";this.store.getState().actions.setPendingTask(o,{entryId:t.entryId,uuid:o,resolve:r,reject:s,onProgress:n});const i=this.taskTeardowns.get(a)??[];if(this.taskTeardowns.set(a,i),this.platform!=="web"){let c=!1;try{const u=JSON.parse(t.extra_headers??"{}");typeof u.use_native_agent=="boolean"&&(c=u.use_native_agent)}catch{}if(c){const u=ul();Z.info("[comet] Starting native agent",{entryId:a,uuid:t.uuid,platform:this.platform,task:t.task,androidVersion:u?.android_version}),i.push(d=>{Z.info("[comet] Native agent task finished",{entryId:a,uuid:t.uuid,platform:this.platform,reason:d,task:t.task,androidVersion:u?.android_version}),this.mobileProxy.bridge.agent_stop({entry_id:a}).catch(m=>{Z.error("[comet] Native agent stop failed",{error:m,entryId:a,platform:this.platform,uuid:t.uuid,task:t.task,androidVersion:u?.android_version})}),this.store.getState().actions.setTaskState(o,void 0)}),this.mobileProxy.bridge.agent_start({task:t.task??"",start_url:t.start_url??"",uuid:o,tab_id:t.tab_id??-1,base_url:t.base_url??"",extra_headers:t.extra_headers??"{}",entry_id:t.entryId}).then(d=>{d.success?r({message:"Native agent started",success:!0}):s(new Error("Native agent failed to start"))}).catch(d=>{Z.error("[comet] Native agent start failed",{error:d}),s(d)});return}this.mobileAgentModule.then(async({startAgent:u})=>{try{const d=await u(t,this.mobileProxy.bridge,(m,p)=>{this.store.getState().actions.addTaskScreenshot(p,m)},(m,p)=>{this.store.getState().actions.addComputerAction(m,{action:p.action?.toLowerCase()??"",text:p.text,duration:p.duration})});i.push(m=>{d(m),this.store.getState().actions.setTaskState(o,void 0)}),r({message:"Mobile task started",success:!0})}catch(d){Z.error("[comet] Mobile agent failed to start",{error:d});const m=this.store.getState().actions.getPendingTask(o);m&&(this.store.getState().actions.deletePendingTask(o),m.reject(d instanceof Error?d:new Error(String(d))));let p={};try{p=JSON.parse(t.extra_headers??"{}")}catch{}kx({clientPayloadCacheKey:o,errorType:"unhandled",errorMsg:d instanceof Error?d.message:String(d)},p,"CometAdapter").catch(h=>{Z.error("Error sending tool failure",h)}),s(d)}}).catch(u=>{Z.error("[comet] Mobile agent module failed to load",{error:u}),s(u)});return}this.agentExtension.sendMessage(t).then(()=>{i.push(c=>{this.agentExtension.sendMessage({type:"CLEANUP_AGENT_TASKS",payload:{entryId:t.entryId,reason:c}})})}).catch(c=>{let u={};try{u=JSON.parse(t.extra_headers??"{}")}catch{}Z.error("[comet] Unhandled error while submitting task",c),kx({clientPayloadCacheKey:o,errorType:c,errorMsg:"Agent task start failure."},u,"CometAdapter").catch(d=>{Z.error("Error sending tool failure",d)})})})}async moveThreadToSidecar({activeTaskUuid:t,entryId:n,isMissionControl:r,isSubagent:s,reason:a,animate:o,takeFocus:i,autoOpened:c=!0}){try{return(await this.agentExtension.sendMessage({type:"MOVE_THREAD_TO_SIDECAR",payload:{active_task_uuid:t,is_mission_control:r,is_subagent:s,entry_id:n,animate:o,takeFocus:i,auto_opened:c}})).success}catch(u){return Z.error(new Xo("MOVE_THREAD_TO_SIDECAR_FAILED",{cause:u,message:`Failed to move thread to sidecar for ${a}`})),!1}}getTaskTabs(){this.agentExtension.sendMessage({type:"GET_TASK_TABS"})}async openYoutubeVideo(t,n){try{return(await this.agentExtension.sendMessage({type:"OPEN_YOUTUBE_VIDEO",payload:{url:t}})).success}catch(r){return Z.error(new Xo("OPEN_YOUTUBE_VIDEO_FAILED",{cause:r,message:`Failed to open youtube reason for ${n}`})),!1}}async sendMissionControlStatus(t){await this.agentExtension.sendMessage({type:"MISSION_CONTROL_STATUS",payload:t})}async makeTaskVisible(t){const n=await this.agentExtension.sendMessage({type:"MAKE_TASK_VISIBLE",payload:{task_uuid:t}});if(n.tab_ids){const r=new URL(window.location.href).pathname;n.tab_ids.forEach(s=>{this.store.getState().actions.setSidecarUrlById(js(s,void 0),r)})}}cleanupTasks(t,n){if(!t)return;const r=this.taskTeardowns.get(t);if(!r){this.platform==="web"?this.agentExtension.sendMessage({type:"CLEANUP_AGENT_TASKS",payload:{entryId:t,reason:n}}):this.mobileProxy.bridge.agent_stop({entry_id:t}).catch(s=>{Z.error("[comet] Native agent stop failed",{error:s,entryId:t})});return}r.forEach(s=>s(n)),this.taskTeardowns.delete(t)}captureSourceTabScreenshotV2({sourceTabUrl:t=""}){this.agentExtension.sendMessage({type:"CAPTURE_SCREENSHOT_V2",payload:{tabId:void 0,sourceTabUrl:t}})}deactivateScreenshotTool(){this.agentExtension.sendMessage({type:"DEACTIVATE_SCREENSHOT_TOOL",payload:{tabId:void 0}})}subscribeToSidecarBrowserTaskStop(t){return this.emitter.on("BROWSER_TASK_STOP",t)}subscribeForceSubmitQuery(t){return this.emitter.on("FORCE_SUBMIT_QUERY",t)}subscribeQuickActionButtonFired(t){return this.emitter.on("QUICK_ACTION_BUTTON_FIRED",t)}subscribeVoiceAssistantStarted(t){return this.emitter.on("VOICE_ASSISTANT_STARTED",t)}subscribeVoiceAssistantStopped(t){return this.emitter.on("VOICE_ASSISTANT_STOPPED",t)}subscribeVoiceAssistantMuteMicRequested(t){return this.emitter.on("VOICE_ASSISTANT_MUTE_MIC_REQUESTED",t)}subscribeVoiceAssistantUnmuteMicRequested(t){return this.emitter.on("VOICE_ASSISTANT_UNMUTE_MIC_REQUESTED",t)}subscribeSourceTabChanged(t){return this.emitter.on("SOURCE_TAB_CHANGED",t)}getMcpTools(t){return this.sendToAgent({type:"GET_MCP_TOOLS",payload:{serverName:t}})}callMcpTool(t,n){return this.sendToAgent({type:"CALL_MCP_TOOL",payload:t,context:n})}getMcpStdioServers(){const t=this.sendToAgent({type:"GET_STDIO_MCP_SERVERS",payload:void 0});return t.then(n=>{this.getStore().getState().actions.setMcpStdioServers(n)}).catch(()=>{}),t}addMcpStdioServer(t){return this.sendToAgent({type:"ADD_STDIO_MCP_SERVER",payload:t})}async updateMcpStdioServer(t,n){try{return await this.sendToAgent({type:"UPDATE_STDIO_MCP_SERVER",payload:{existingServerName:t,updates:n}})}catch(r){if(!(r instanceof Error)||!r.message.startsWith("Error in invocation of perplexity.mcp.updateStdioServer")&&!r.message.startsWith("chrome.perplexity.mcp.updateStdioServer is not a function"))throw r;return n.name&&n.name!==t?this.pendingServerRename={oldName:t,newName:n.name}:this.pendingServerRename=void 0,await this.removeMcpStdioServer(t,!0),this.addMcpStdioServer(n)}}async removeMcpStdioServer(t,n){await this.sendToAgent({type:"REMOVE_STDIO_MCP_SERVER",payload:{name:t}}),this.clearStateAfterRemovingMcpServer(t,n)}installDxt(t){return this.sendToAgent({type:"INSTALL_DXT",payload:{url:t}})}async uninstallDxt(t){await this.sendToAgent({type:"UNINSTALL_DXT",payload:{name:t}}),this.clearStateAfterRemovingMcpServer(t)}getInstalledDxts(){const t=this.sendToAgent({type:"GET_INSTALLED_DXT"});return t.then(n=>{this.getStore().getState().actions.setInstalledDxts(n)}).catch(()=>{}),t}async refreshDxtAndMcpState(){await Promise.all([this.getMcpStdioServers(),this.getInstalledDxts()])}async hasPermission(t){try{return await this.sendToAgent({type:"HAS_PERMISSION",payload:{permission:t}})}catch{return null}}async requestPermission(t){try{return await this.sendToAgent({type:"REQUEST_PERMISSION",payload:{permission:t}})}catch{return null}}getManagedOrganizationUUIDPromise(){return this.managedOrganizationUUIDPromise||(this.managedOrganizationUUIDPromise=this.sendToAgent({type:"GET_MANAGED_ORGANIZATION_UUID"}).catch(()=>null)),this.managedOrganizationUUIDPromise}handleMcpStdioServerChanged(t,n,r){const s=this.getStore().getState(),a=s.mcpStdioServers??[],o=a.findIndex(c=>c.name===t);if(o===-1)return;const i=[...a];i[o]=r,s.actions.setMcpStdioServers(i)}async handleMcpPersistedStdioServersLoaded(){await this.getMcpStdioServers()}handleMcpStdioServerAdded(t){const n=this.getStore().getState(),r=n.mcpStdioServers??[];if(r.findIndex(o=>o.name===t.name)!==-1)return;const a=[...r,t];n.actions.setMcpStdioServers(a)}handleMcpStdioServerRemoved(t){const n=this.getStore().getState(),s=(n.mcpStdioServers??[]).filter(a=>a.name!==t);n.actions.setMcpStdioServers(s)}async fetchCurrentPageTab(){if(this.platform==="web")return;const n=(await this.mobileProxy.bridge.tabs_query()).tabs.sort((r,s)=>(s.last_accessed??-1)-(r.last_accessed??-1))[0];n&&this.store.getState().actions.setSourceTab({tabId:n.id,title:n.title??"",url:n.url,secondaryTab:null})}async send(t){return this.mainExtension.sendMessage(t).then(n=>(n.is_success=!n.errorType,n))}async sendToAgent(t){return this.agentExtension.sendMessage(t).then(n=>{if(!n.success)throw new Error(n.error);return n.response})}handleMessage=t=>{try{Va(t).with({type:"UPDATE_SOURCE_TAB"},r=>{this.store.getState().actions.setSourceTab(r.payload),r.payload.url!==this.store.getState().sidecarSourceTab.url&&this.store.getState().actions.clearUserSelection(),this.emitter.emit("SOURCE_TAB_CHANGED")}).with({type:"FORCE_SUBMIT_QUERY"},r=>{this.isTestDebugMode&&this.emitter.emit("FORCE_SUBMIT_QUERY",r.payload)}).with({type:"QUICK_ACTION_BUTTON_FIRED"},()=>{this.emitter.emit("QUICK_ACTION_BUTTON_FIRED")}).with({type:"VOICE_ASSISTANT_STARTED"},()=>{this.emitter.emit("VOICE_ASSISTANT_STARTED")}).with({type:"VOICE_ASSISTANT_STOPPED"},()=>{this.emitter.emit("VOICE_ASSISTANT_STOPPED")}).with({type:"VOICE_ASSISTANT_MUTE_MIC_REQUESTED"},()=>{this.emitter.emit("VOICE_ASSISTANT_MUTE_MIC_REQUESTED")}).with({type:"VOICE_ASSISTANT_UNMUTE_MIC_REQUESTED"},()=>{this.emitter.emit("VOICE_ASSISTANT_UNMUTE_MIC_REQUESTED")}).with({type:"EDITABLE_ELEMENT_FOCUS_STATE"},r=>{this.store.getState().actions.setInlineAssistantParams({canInsert:r.payload.canInsert})}).with({type:"INIT"},r=>{this.isTestDebugMode=!!r.payload.isTestDebugMode,this.store.getState().actions.setPlatformInfo(r.payload.platform);const s=this.store.getState().actions;s.setSourceTab({tabId:r.payload.sourceTabId??-1,url:r.payload.sourceTabUrl??"",title:r.payload.sourceTabTitle??"",secondaryTab:r.payload.sourceSecondaryTab??null}),r.payload.selection&&s.setUserSelection(r.payload.selection)}).otherwise(r=>{Z.log("Unknown message type",r)})}catch(n){Z.error("Error parsing entropy message",n)}};clearStateAfterRemovingMcpServer(t,n){const r=this.getStore().getState(),s=r.mcpDisabledServers??new Set;if(s.has(t)){const o=new Set(s);o.delete(t),r.actions.setMcpDisabledServers(o)}if(n&&!this.pendingServerRename)return;if(this.pendingServerRename&&this.pendingServerRename.oldName===t){r.actions.renameMcpServerInToolsSettings(this.pendingServerRename.oldName,this.pendingServerRename.newName),this.pendingServerRename=void 0;return}const a=r.mcpToolsSettings??{};if(a[t]){const o={...a};delete o[t],r.actions.setMcpToolsSettings(o)}}async getPrivacyInfo(t){try{const n=await this.send({type:"GET_PRIVACY_INFO",key:t});return n.is_success?n:null}catch{return null}}async insertInlineAssistantSelection(t,n){try{return(await this.agentExtension.sendMessage({type:"INSERT_INLINE_TEXT",payload:{text:n},key:t})).success}catch{return!1}}async getSiteOnboardingStatus(t){try{const n=await this.mainExtension.sendMessage({type:"GET_SITE_ONBOARDING_STATUS",key:t});return n.started===null?void 0:n.started}catch{return}}async setSiteOnboardingStatus(t,n){try{await this.mainExtension.sendMessage({type:"SET_SITE_ONBOARDING_STATUS",key:t,payload:{started:n}})}catch{}}}const uY=e=>new Proxy({},{get(t,n){return r=>e.sendMessage({type:"CALL_TOOL",method:n,request:r}).then(({success:s,response:a})=>{if(!s)throw a;return a}).catch(s=>{throw Z.error("Error calling tool",s),"errorType"in s?s:{errorType:"unhandled",errorMsg:"Proxy error."}})}});class dY{mobileProxy;cometAdapter;_shouldUseMobileProxyForMCP=null;constructor(t,n){this.mobileProxy=t,this.cometAdapter=n}get shouldUseMobileProxyForMCP(){if(this._shouldUseMobileProxyForMCP===null)if(Si())this._shouldUseMobileProxyForMCP=!0;else if(mn())this._shouldUseMobileProxyForMCP=!1;else{const t=this.mobileProxy.isAvailable;t!==void 0&&(this._shouldUseMobileProxyForMCP=t)}return this._shouldUseMobileProxyForMCP??!1}async getMcpTools(t){if(this.shouldUseMobileProxyForMCP){const n=this.mobileProxy.bridge.get_mcp_tools({server_name:t});return n.catch(r=>{Z.error("get_mcp_tools failed:",r)}),n.then(r=>r.tools)}return this.cometAdapter.getMcpTools(t)}async callMcpTool(t,n){if(this.shouldUseMobileProxyForMCP){const r=this.mobileProxy.bridge.call_mcp_tool({params:t});return r.catch(s=>{Z.error("call_mcp_tool failed:",s)}),r.then(s=>({content:s.result}))}return this.cometAdapter.callMcpTool(t,n)}async getMcpStdioServers(){if(this.shouldUseMobileProxyForMCP){const t=this.mobileProxy.bridge.get_mcp_servers();return t.catch(n=>{Z.error("get_mcp_servers failed:",n)}),t.then(n=>(this.cometAdapter.getStore().getState().actions.setMcpStdioServers(n.servers),n.servers))}return this.cometAdapter.getMcpStdioServers()}async getInstalledDxts(){return this.shouldUseMobileProxyForMCP?[]:this.cometAdapter.getInstalledDxts()}async refreshDxtAndMcpState(){await Promise.all([this.getMcpStdioServers(),this.getInstalledDxts()])}initializeFromWindowTools(t){try{if(!t?.servers)return;const n=this.cometAdapter.getStore();Object.entries(t.servers).forEach(([r,s])=>{s&&Array.isArray(s)&&n.getState().actions.setMcpTools(r,s)})}catch(n){Z.error("Failed to initialize MCP tools from window",n)}}}const dR="native_bridge";function fY(e){try{const t=JSON.parse(e);return{info_version:typeof t.info_version=="string"?t.info_version:void 0,local_mcp:{call:t.local_mcp?.call===!0,edit:t.local_mcp?.edit===!0}}}catch(t){Z.warn("[NativeClientCapabilities] Invalid JSON",t);return}}const mY=$g(function(){const t=_s(dR);if(t)return fY(t)},()=>Math.floor(Date.now()/(3600*1e3)));function pY(){return!!_s(dR)}const hY=$g(function(){const t=mY();if(t)return t;if(!Si()&&mn())return{info_version:"1",local_mcp:{call:!0,edit:!0}}},()=>Math.floor(Date.now()/(3600*1e3))),Ms=new cY,Fh=new dY(Ms.getMobileProxy(),Ms),{Provider:gY,useTrackedState:yY}=du("CometContext",()=>Ms.getStore()),fR=Bt("EntropyBrowserContext",void 0),mR=Bt("McpAdapterContext",void 0),xY=({children:e})=>{const t=hn(),n=Mq(),r=mn(),{session:s,status:a}=je(),{variation:o,loading:i}=XK(SN),c=pY();f.useLayoutEffect(()=>{c&&window.initialMCPTools!=null&&(Fh.initializeFromWindowTools(window.initialMCPTools),window.initialMCPTools=void 0)},[c]),f.useEffect(()=>{i||Ms.setClassifierApiTimeoutMs(o)},[o,i]);const u=s?.user?.id,d=s?.user?.subscription_tier;f.useEffect(()=>{if(r)switch(a){case"authenticated":return u?Ms.notifyUserStateChanged({status:a,userId:u,subscriptionTier:d??"free"}):void 0;case"unauthenticated":return Ms.notifyUserStateChanged({status:a})}},[a,u,d,r]),f.useMemo(()=>{},[]),f.useLayoutEffect(()=>{const h=nl();h.erp&&(document.documentElement.dataset.erp=h.erp);const g=Ms.subscribeCometNavigate(({url:v})=>{if(v.origin===window.location.origin&&v.pathname.startsWith(t.base)&&(v.pathname=v.pathname.replace(t.base,""),n(v.pathname))){const C=v.searchParams.toString(),w=`${v.pathname}${C?`?${C}`:""}`;t.push(w,void 0,"Comet navigate");return}{Z.error("Invalid soft navigation in Sidecar",{url:v}),Ms.openTab({url:v.toString()});return}}),y=Ms.getStore(),b=setInterval(()=>{y.getState().sidecarUrlById.forEach((C,w)=>{C.updatedAt<Date.now()-1e3*60*60*24*7&&y.getState().actions.deleteSidecarUrlById(w)}),bk(y)},1e3*60*60*6);ZK(y),JK(y,t);let x=y.getState().sidecarSourceTab;const _=y.subscribe((v,C)=>{if(Ff(v.sidecarSourceTab,C.sidecarSourceTab))return;const w=v.sidecarSourceTab,S=js(x.tabId,x.secondaryTab?.tabId),E=js(w.tabId,w.secondaryTab?.tabId);if(E===S)return;const T=new URL(window.location.href).pathname;j$(x.tabId,x.secondaryTab?.tabId).forEach(P=>{y.getState().actions.setSidecarUrlById(P,T)});const N=y.getState().sidecarUrlById.get(E)?.url??"/";x=w,N!==T&&(t.replace(N,"Sidecar source tab changed"),bk(y))});return()=>{clearInterval(b),g(),_()}},[t,n]),f.useEffect(()=>Ms.subscribeToSidecarBrowserTaskStop(h=>{h&&(Cu({entryUUID:h,reason:"terminate-from-comet-adapter"}),Ms.cleanupTasks(h,"query_stopped"))}),[]);const{variation:m}=cR(!1),p=r?m:c;return l.jsx(gY,{children:l.jsx(fR.Provider,{value:Ms,children:l.jsxs(mR.Provider,{value:Fh,children:[e,p&&l.jsx(_Y,{})]})})})};function Xt(e=!0){const t=f.useContext(fR);if(!t&&e)throw new Error("useEntropyBrowser must be used inside EntropyBrowserProvider");return t}function bY(e=!0){const t=f.useContext(mR);if(!t&&e)throw new Error("useMcpAdapter must be used inside EntropyBrowserProvider");return t}const Sn=yY,_Y=()=>{const e=Sn();return f.useEffect(()=>{Fh.refreshDxtAndMcpState().catch(()=>{})},[]),f.useEffect(()=>{if(!e.mcpDisabledServers)try{const t=yt.getItem("mcp_disabled_servers_v1"),n=t?JSON.parse(t):[];e.actions.setMcpDisabledServers(new Set(n))}catch{e.actions.setMcpDisabledServers(new Set)}},[e.mcpDisabledServers,e.actions]),f.useEffect(()=>{if(!e.mcpToolsSettings)try{const t=yt.getItem(ch),n=t?JSON.parse(t):{};e.actions.setMcpToolsSettings(n)}catch{e.actions.setMcpToolsSettings({})}},[e.mcpToolsSettings,e.actions]),l.jsx(l.Fragment,{children:e.mcpStdioServers?.map(t=>l.jsx(vY,{server:t},t.name))})},vY=({server:e})=>{const t=Sn(),{data:n}=gt({queryKey:Se.makeQueryKey("comet/mcp_tools",e.name),queryFn:async()=>(await Fh.getMcpTools(e.name).catch(()=>[])).map(s=>({...s,mcp_server:e.name,mcp_server_type:"MCP_SERVER_TYPE_LOCAL",app:e.name})),enabled:!!e.name});return f.useEffect(()=>{if(n)return t.actions.setMcpTools(e.name,n),()=>{t.actions.removeMcpTools(e.name)}},[n,t.actions,e.name]),null},Tw=Bt("FileViewerContext",{file:void 0,openFile:()=>{},closeViewer:()=>{},doViewerAction:()=>{},isViewerOpen:!1,setViewerDispatch:()=>{}}),CY=A.memo(function({children:t}){const[n,r]=f.useState(),{dispatch:s}=vu(),[a,o]=f.useState(),i=f.useRef(void 0),c=f.useCallback(g=>{r(g);const y=g?.fileSource==="MEETING_TRANSCRIPT"?"transcript":"pdf";s({action:"open",tabType:y})},[r,s]),u=f.useCallback(()=>{s({action:"close"}),r(void 0),o(void 0),i.current=void 0},[r,o,s]),d=f.useRef([]),m=f.useCallback(g=>{i.current?i.current(g):d.current.push(g)},[]),p=f.useCallback(g=>{o(()=>g),i.current=g,d.current.length>0&&g&&(d.current.forEach(y=>g(y)),d.current=[])},[o]),h=f.useMemo(()=>({file:n,openFile:c,closeViewer:u,doViewerAction:m,isViewerOpen:!!a,setViewerDispatch:p}),[n,c,u,m,a,p]);return l.jsx(Tw.Provider,{value:h,children:t})}),wY=A.memo(function(){const{session:t}=je(),n=f.useMemo(()=>{if(t)return{id:t.user.id,name:t.user.name,email:t.user.email,orgId:t.user.org_uuid,isPro:!!t.user.subscription_status&&t.user.subscription_status!=="none"}},[t]);if(!n)return null;const r=jN(globalThis.navigator?.userAgent??"");return l.jsxs(l.Fragment,{children:[l.jsx(Tq,{session:n,isWindowsApp:r}),l.jsx(Aq,{session:n,isWindowsApp:r})]})});async function SY(){try{return(await(await fetch("/cdn-cgi/trace")).text()).split(`
`).reduce((n,r)=>{const[s,a]=r.split("=");return n[s]=a??"",n},{loc:"US"})}catch(e){return Z.error("Error getting Cloudflare trace",e),{loc:"US"}}}function c0(){const{data:e}=gt({queryKey:Se.makeEphemeralQueryKey("cloudflare-trace"),queryFn:SY,staleTime:6e4});return f.useMemo(()=>e?.loc??"US",[e])}const EY=({children:e,hostname:t})=>{const{session:n}=je(),r=c0();return l.jsx(P$,{hostname:t,session:n??void 0,cfCountry:r,children:e})};let Ck=0;class nd{eventTime=-1;setOnce(){return this.eventTime==-1?(this.eventTime=Date.now(),!0):!1}timeSinceTimestamp(t){return this.eventTime===-1||t==null?-1:this.eventTime<t?(Z.log(`TimeMarker.timeSinceTimestamp found inconsistency: mytime ${this.eventTime}, old: ${t}`),-1):this.eventTime-t}timeBeforeTimestamp(t){return this.eventTime===-1||t==null?-1:this.eventTime>t?(Z.log(`TimeMarker.timeBeforeTimestamp found inconsistency: mytime ${this.eventTime}, next: ${t}`),-1):t-this.eventTime}wasSet(){return this.eventTime!=-1}}const kY={firstServerResponseReceived:!1,firstLLMTokenReceived:!1,isPerplexityBrowser:!1},Ei=new Map,MY=(e,{hasLLMToken:t,hasSearchResults:n,hasSources:r},s)=>{TY(e,s),AY(e,t,s),NY(e,n),RY(e,r)},TY=(e,t)=>{const n=Ei.get(e);if(!n||n.firstServerResponseReceived||!n.submitTimestamp||!n.startFirstServerResponseMarker?.setOnce())return;n.firstServerResponseReceived=!0;const{queryStr:r,isFollowup:s,queryParams:a}=n,o=PY(e);o>0&&si({name:"query first server response",data:{startFirstServerResponseElapsed:o,queryStr:r,isFollowup:s,mode:a?.mode??"unknown",isPerplexityBrowser:n.isPerplexityBrowser},user:t??void 0})},AY=(e,t,n)=>{const r=Ei.get(e);if(!r||r.firstLLMTokenReceived||!t||!r.startLLMTokenMarker?.setOnce())return;r.firstLLMTokenReceived=!0;const{queryStr:s,isFollowup:a,queryParams:o}=r,i=OY(e);i>0&&si({name:"query first llm token",data:{startLLMTokenElapsed:i,queryStr:s,isFollowup:a,mode:o?.mode??"unknown",isPerplexityBrowser:r.isPerplexityBrowser},user:n??void 0})},NY=(e,t)=>{const n=Ei.get(e);if(n){if(!t)return}else return;n.firstSearchResultsMarker?.setOnce()},RY=(e,t)=>{const n=Ei.get(e);if(n){if(!t)return}else return;n.firstSourcesMarker?.setOnce()},DY=({latencies:e,isMobile:t})=>{Jt("web.frontend.autosuggest_latency",{latencies:e,isMobile:t})},Ox=(e,t)=>e?JC:t??void 0,Ad=e=>{if(e)return JC;const t=ul();if(t?.android_version)return"browser_android_mweb";if(t?.ios_version)return"browser_ios_mweb"},wk=(e,{session:t,source:n,name:r})=>{const s=Ei.get(e);s&&(s.endStreamTimestamp||(s.endStreamTimestamp=Date.now(),si({name:r,data:s,user:{id:t?.user?.id,subscription_status:t?.user?.subscription_status},source:n})))},IY=e=>Kg(e)?.host??"",jY=(e,{name:t,queryStr:n,queryParams:r,isFollowup:s,frontendUUID:a,isPerplexityBrowser:o,session:i,browserVersion:c,source:u,connectors:d,mentions:m,inlineAssistantAction:p})=>{Ck+=1;const h={...kY};h.submissionType=t,h.submitTimestamp=Date.now(),h.queryStr=n,h.queryParams=r,h.frontendUUID=a,h.submissionCount=Ck,h.isFollowup=s,h.startFirstServerResponseMarker=new nd,h.startLLMTokenMarker=new nd,h.firstSearchResultsMarker=new nd,h.firstSourcesMarker=new nd,h.firstSourcesRenderMarker=new nd,h.isPerplexityBrowser=o,h.browserVersion=c,h.enabledConnectors=d?.enabled,h.disabledConnectors=d?.disabled,h.referrer=document.referrer,h.inlineAssistantAction=p;const g=m?.filter(x=>x.type==="tab"&&x.url)??[];h.attachedTabsDomains=[...new Set(g.map(x=>IY(x.url)).filter(Boolean))],h.attachedTabsCount=g.length;const y=m?.filter(x=>x.type==="space")??[];h.mentionedSpacesCount=y.length;const b=m?.filter(x=>x.type==="shortcut")??[];h.mentionedShortcutsCount=b.length,Ei.set(e,h),si({name:"submit query",data:h,user:i?.user??void 0,source:u})},PY=e=>{const t=Ei.get(e);let n=-1;return t&&(n=t.startFirstServerResponseMarker?.timeSinceTimestamp(t.submitTimestamp)??-1),n},OY=e=>{const t=Ei.get(e);let n=-1;return t&&(n=t.startLLMTokenMarker?.timeSinceTimestamp(t.submitTimestamp)??-1),n};var Sk;(function(e){e.FLASHCARD="FLASHCARD",e.QUIZ="QUIZ"})(Sk||(Sk={}));const Ze=e=>{const{device:{isWindowsApp:t}}=jn(),n=f.useRef(new Set),r=f.useCallback((i,c={})=>{const u=Ad(t);si({name:i,data:c,source:u,user:{id:e?.user?.id,subscription_status:e?.user?.subscription_status}})},[t,e?.user?.id,e?.user?.subscription_status]),s=f.useCallback(i=>{const c=Ad(t),u=i.map(({name:d,data:m})=>({name:d,data:m,source:c,user:{id:e?.user?.id,subscription_status:e?.user?.subscription_status}}));O$(u)},[t,e?.user?.id,e?.user?.subscription_status]),a=f.useCallback((i,c)=>{const u=Ad(t);si({name:i,data:c,source:u,user:{id:e?.user?.id,subscription_status:e?.user?.subscription_status}})},[t,e?.user?.id,e?.user?.subscription_status]),o=f.useCallback((i,c={})=>{if(n.current.has(i))return;n.current.add(i);const u=Ad(t);si({name:i,data:c,source:u,user:{id:e?.user?.id,subscription_status:e?.user?.subscription_status}})},[t,e?.user?.id,e?.user?.subscription_status]);return f.useMemo(()=>({trackEvent:r,trackEventTyped:a,trackEventOnce:o,trackEventBatch:s}),[r,s,a,o])},Il=A.memo(function(){return l.jsx("div",{className:"bg-backdrop/70 fixed inset-0 z-[999] flex items-center justify-center backdrop-blur-sm",children:l.jsx(To,{})})});function wt(){const{status:e}=je(),t=e==="authenticated";return f.useEffect(()=>{t&&Nq()},[t]),t}function pR(){const{status:e}=je();return e==="loading"}const Aw="pplx.chosen-locale",j2="pplx.la-status",hR="pplx.source-selection-v3",Ek="pplx.prefers-metric",gR="pplx.default-search-session",LY="pplx.utm-source",yR="pplx.pt",FY="pplx.finance-uxr-prompt-impressions",qKe="pplx.show-moderated-content",xR=400,UY=30,BY=7,HY=e=>{Ci(Aw,e,{expires:xR})},VY=()=>_s(Aw),GY=()=>{tN(Aw)},zY=e=>{Ci(j2,e,{})},Lx=(e,t)=>{const n=`${hR}-${t}`;Ci(n,JSON.stringify(e),{expires:BY})},qY=e=>{const t=`${hR}-${e}`,n=_s(t);return n?JSON.parse(n):null},$Y=()=>{Ci("pplx.has-discovered-space-mentions","true",{expires:xR})},WY=e=>{Ci(gR,e,{expires:UY})},KY=()=>_s(gR),YY=()=>_s(LY),$Ke=()=>_s(yR),QY=e=>{Ci(yR,e)},bR=()=>{const e=f.useCallback(r=>{zY(r)},[]),t=_s(j2),n=f.useCallback(()=>tN(j2),[]);return f.useMemo(()=>({lossAversionStatus:t,setLossAversionStatus:e,unsetLossAversion:n}),[t,e,n])},XY=Pe(async()=>{const{ThreadLossAversionModal:e}=await W(async()=>{const{ThreadLossAversionModal:t}=await import("./ThreadLossAversionModal-DnFAwuB3.js");return{ThreadLossAversionModal:t}},__vite__mapDeps([4,2,3,5,1,6,7,8,9,10,11,12,13,14,15,16,17]));return{default:e}}),ZY=()=>{const{lossAversionStatus:e,setLossAversionStatus:t}=bR(),n=sr(),r=wt(),s=f.useMemo(()=>!r&&e==="allowed"&&n?.startsWith("/search"),[r,e,n]),{openModal:a}=Kt(),o=f.useCallback(i=>{a(XY,i),t("cooldown")},[a,t]);return f.useMemo(()=>({shouldShowLossAversionModal:s,handleOpenLossAversion:o}),[s,o])},JY=Pe(async()=>{const{KeyboardShortcutHelperModal:e}=await W(async()=>{const{KeyboardShortcutHelperModal:t}=await import("./KeyboardShortcutHelperModal-DBQnfvFa.js");return{KeyboardShortcutHelperModal:t}},__vite__mapDeps([18,2,3,5,1,6,7,8,9,13,12,14,15,16,17]));return{default:e}},{loading:()=>l.jsx(Il,{})}),eQ=Pe(async()=>{const{KeyboardShortcutEditorModal:e}=await W(async()=>{const{KeyboardShortcutEditorModal:t}=await import("./KeyboardShortcutEditorModal-CrZspFKL.js");return{KeyboardShortcutEditorModal:t}},__vite__mapDeps([19,2,3,5,1,6,7,8,9,13,12,14,15,16,17]));return{default:e}},{loading:()=>l.jsx(Il,{})}),tQ=({children:e})=>{const{session:t}=je(),{trackEvent:n}=Ze(t),{device:{isMacOS:r,isWindowsApp:s}}=jn(),{shouldShowLossAversionModal:a,handleOpenLossAversion:o}=ZY(),i=hn(),{openModal:c}=Kt(),u=f.useCallback(d=>{if(r?d.metaKey&&d.key==="k":d.ctrlKey&&d.key==="i")d.preventDefault(),a?o({origin:Ke.NEW_THREAD_SHORTCUT,callback:()=>{n("quick ask keyboard shortcut",{}),i.push("/",void 0,"Quick ask keyboard shortcut (loss aversion)")}}):(n("quick ask keyboard shortcut",{}),i.push("/",void 0,"Quick ask keyboard shortcut"));else if(r?d.metaKey&&d.key==="/":d.ctrlKey&&d.key==="/")d.preventDefault(),s?c(eQ,{}):c(JY,{});else if(s&&d.ctrlKey&&d.key==="d"){d.preventDefault();const m=new CustomEvent("toggleDictation");document.dispatchEvent(m)}},[r,s,a,o,c,n,i]);return f.useEffect(()=>(document.addEventListener("keydown",u),()=>{document.removeEventListener("keydown",u)}),[u]),l.jsx(l.Fragment,{children:e})};function nQ(){return null}async function rQ(){"serviceWorker"in navigator&&await navigator.serviceWorker.getRegistrations().then(e=>Promise.all(e.map(t=>t.unregister())))}const sQ=A.memo(function(){return f.useEffect(()=>{{rQ();return}},[]),null}),aQ=async({file:e,fileSource:t="default",forceImage:n=!1,reason:r})=>{const s=await ve.POST("/rest/uploads/create_upload_url",r,{body:{filename:e.name,content_type:e.type,source:t,file_size:e.size,force_image:n},timeoutMs:hs.MEDIUM,retries:2});return s.data?s.data:null},oQ=async({filesWithUuids:e,fileSource:t="default",forceImage:n=!1,reason:r})=>{const s={};e.forEach(({uuid:o,file:i})=>{s[o]={filename:i.name,content_type:i.type,source:t,file_size:i.size,force_image:n}});const a=await ve.POST("/rest/uploads/batch_create_upload_urls",r,{body:{files:s},timeoutMs:hs.MEDIUM,retries:2});return a.data?a.data.results:null},iQ=async({remote_file_id:e,connection_type:t,source:n,reason:r})=>{const s=await ve.POST("/rest/connectors/attachments/upload",r,{body:{remote_file_id:e,connection_type:t,source:n??"default"},timeoutMs:hs.VERY_HIGH,retries:2});return s.data?s.data:null};async function lQ({request:e,reason:t}){return new Promise((n,r)=>{ve.SSE("/rest/sse/attachment_processing/subscribe",t,{params:e,handlers:{message:s=>{n(s)}}}).catch(r)})}const Qs=e=>{if(!e)return{};try{return JSON.parse(e)}catch{return{}}};function cQ({reason:e}){const t=mn(),n=Xt(),r=f.useCallback(async(s,a,o)=>{if(Z.info("browserStep",s),s.browser_open_tab_content){const i=s.browser_open_tab_content;if(!i.url||!s.uuid)return;const c=Qs(i.extra_headers);Z.info("browserTool: browser_open_tab",{tool:i},{request_id:c[Fn]}),await L$({url:i.url,cometBrowser:n,stepUuid:s.uuid,extraHeaders:Qs(i.extra_headers),reason:e})}else if(s.search_browser_content){const i=s.search_browser_content;if(!s.uuid)return;const c=Qs(i.extra_headers);Z.info("browserTool: search_browser",{tool:i},{request_id:c[Fn]}),await F$(i,n,s.uuid,c,e)}else if(s.browser_close_tabs_content){const i=s.browser_close_tabs_content,c=i.payload;if(!c||!s.uuid)return;const u=Qs(i.extra_headers);Z.info("browserTool: browser_close_tabs",{tool:i},{request_id:u[Fn]}),await U$(c,n,s.uuid,u,e)}else if(s.browser_group_tabs_content){const i=s.browser_group_tabs_content,c=i.payloads;if(!c||!s.uuid)return;const u=Qs(i.extra_headers);Z.info("browserTool: browser_group_tabs",{tool:i},{request_id:u[Fn]}),await B$(c,n,s.uuid,u,e)}else if(s.entropy_request_content){const i=s.entropy_request_content;if(!i.tasks)return;const c=i.extra_headers,u=Qs(c)[Fn];Z.info("browserTool: entropy_request",{tool:i},{request_id:u}),i.tasks.forEach(d=>{Z.info("[comet] Submitting agent task",{task_id:d.uuid,entry_uuid:a,request_id:u}),n.submitTask({action:"startAgentFromPerplexity",type:"START_AGENT",extra_headers:c,base_url:i.base_url,entryId:a,...d,use_current_page:d.use_current_page&&!0,capture_screenshot:!d.use_current_page&&!d.tab_id,is_mission_control:window.location.pathname.startsWith("/b/mission-control")||window.location.pathname.startsWith("/b/assistants")||i.is_mission_control,thread_url_slug:o})})}else if(s.get_url_content_content){const i=s.get_url_content_content;if(!s.uuid)return;const c=Qs(i.extra_headers);if(Z.info("browserTool: get_url_content",{tool:i},{request_id:c[Fn]}),!t)return;const u={...i,key:s.uuid,request_id:c[Fn],pages:[...i.pages||[]]},d=n.GetContent(u);await Xu(d,s.uuid,{request_id:c[Fn]??""},e)}else if(s.browser_ungroup_content){const i=s.browser_ungroup_content;if(!i.payload||!s.uuid||!i.payload.group_ids||!i.payload.tab_ids)return;const c={groupIds:i.payload.group_ids,tabIds:i.payload.tab_ids},u=Qs(i.extra_headers),d=n.ungroupTabs(c,s.uuid,u[Fn]??"").then(m=>{if(!m.is_success)throw m;return{group_ids:m.groupIds,tab_ids:m.tabIds}});await Xu(d,s.uuid,{request_id:u[Fn]??""},e)}else if(s.browser_search_tab_groups_content){const i=s.browser_search_tab_groups_content,c=i.payload;if(!c||!s.uuid||!c.queries)return;const u=Qs(i.extra_headers),d=n.searchTabGroups({...c,queries:c.queries},s.uuid,u[Fn]??"").then(m=>{if(!m.is_success)throw m;return{results:m.results.map(p=>({...p,color:H$(p.color)}))}});await Xu(d,s.uuid,{request_id:u[Fn]??""},e)}else if(s.browser_get_visible_tab_screenshot_content){const i=s.browser_get_visible_tab_screenshot_content;if(!s.uuid)return;const c=Qs(i.extra_headers),u=n.GetVisibleTabScreenshot({key:s.uuid,request_id:c[Fn]??"",...i}).then(async d=>{if(!d.data_url)throw new Error("Failed to capture screenshot - no data URL returned");const p=await(await fetch(d.data_url)).blob(),h=new File([p],"screenshot."+(i.format??"png"),{type:p.type}),g=await aQ({file:h,forceImage:!0,reason:e,fileSource:"entropy"});if(!g||!g?.fields||!g.s3_bucket_url)throw new Error("Failed to create upload URL");const y=new FormData;Object.entries(g.fields).forEach(([_,v])=>{y.append(_,v)}),y.append("file",h);const b=await fetch(g.s3_bucket_url,{method:"POST",body:y});if(!b.ok)throw new Error(`Failed to upload screenshot: ${b.statusText}`);const x=await b.json();if(!x.secure_url)throw Z.error("[GetVisibleTabScreenshot] Upload did not return a secure URL",{response:x}),new Error("Upload did not return a secure URL");return{screenshot_url:x.secure_url}});await Xu(u,s.uuid,{request_id:c[Fn]??""},e)}else if(s.browser_get_cookies_content){const i=s.browser_get_cookies_content;if(!s.uuid)return;const c=Qs(i.extra_headers);Z.info("browserTool: browser_get_cookies",{tool:i},{request_id:c[Fn]}),await Xu(n.getCookies(),s.uuid,{request_id:c[Fn]??""},e)}else Z.error("[useExecuteBrowserTool] Unknown browser tool step",{browserStep:s},{reason:e,backend_uuid:a})},[n,t,e]);return f.useMemo(()=>({executeBrowserTool:r}),[r])}const uQ=A.memo(function(){const{executeBrowserTool:t}=cQ({reason:"StreamMiddlewares"}),n=f.useCallback((s,a)=>{if(!s||!s.browser_tool)return s;t(s.browser_tool,s.backend_uuid,a)},[t]),r=f.useMemo(()=>[n],[n]);return l.jsx(ZW,{middlewares:r})}),dQ=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"workflow-redesign-2026",defaultValue:e,extraAttributes:t,subjectType:"visitor_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},fQ="pplx.workflow-redesign-2026.eppo_cache";function Nw(){const{variation:e,loading:t}=dQ(!1),[n,r]=vs(fQ,!1);return f.useEffect(()=>{!t&&e!==n&&r(e)},[e,t,n,r]),n}const mQ=()=>{const e=Nw();return f.useMemo(()=>eR({isWorkflowRedesignEnabled:e}),[e])},pQ=async({slugOrUUID:e,headers:t,options:n,numRetries:r=0,reason:s})=>{const a="getThreadByUUID";if(!e||e==="undefined"||e==="new"){Z.log(`Tried to ${a} with bad slugOrUUID: ${e}`);return}const o=n?.withParentInfo,i=n?.version??_u,c=n?.source??vK,u=n?.limit??0,d=n?.offset??0,m=n?.fromFirst,p=n?.supportedBlockUseCases??[],h=n?.cursor??null;try{const{data:g,error:y,response:b}=await ve.GET("/rest/thread/{entry_uuid_or_slug}",s,{params:{path:{entry_uuid_or_slug:e},query:{with_parent_info:o,with_schematized_response:!0,version:i,source:c,limit:u,offset:d,from_first:m,supported_block_use_cases:p,cursor:h}},timeoutMs:hs.HIGH,numRetries:r,headers:t});if(!g||y)throw new Ue("API_CLIENTS_ERROR",{cause:y,status:b.status??0});return g}catch(g){throw Z.error("Failed to get thread by uuid",g),g}},hQ=10,Rw=hQ,_R=Rw*10,gQ=_R*10+Rw,Bc="all_results",yQ=({slugOrUUID:e,enabled:t,isSidecar:n,reason:r})=>{const s=It(),a=mQ(),o=f.useCallback(async(i,c,u=[])=>{const d=await pQ({slugOrUUID:i,options:{withParentInfo:!0,supportedBlockUseCases:a,limit:c?_R:Rw,fromFirst:!0,cursor:c},numRetries:wi,reason:r});if(!d?.entries?.length||d.status!=="success")return u;const m=Se.makeQueryKey(Bc,i),p=d.entries;return u.push(...p),s.setQueryData(m,h=>{const g=new Map,y=b=>g.set(b.backend_uuid,b);return h?.forEach(y),p.forEach(y),Array.from(g.values())}),d.next_cursor&&u.length<gQ?o(i,d.next_cursor,u):s.setQueryData(m,u),s.getQueryData(m)??[]},[r,s,a]);return gt({queryKey:Se.makeQueryKey(Bc,e),enabled:!!e&&t,retry:(i,c)=>!!(c instanceof Ue&&c.status===403&&n&&i<2),queryFn:async()=>await o(e,null,[]),placeholderData:Ja})},Dw=()=>{const e=It();return f.useCallback((t,n)=>{!n&&!t||[Se.makeQueryKey(Bc,t?.thread_url_slug||n?.at(0)?.thread_url_slug||""),Se.makeQueryKey(Bc,t?.backend_uuid||n?.at(0)?.backend_uuid||"")].forEach(r=>{if(Se.unmakeQueryKey(r).at(-1)){if(t){const s=e.getQueryData(r)??[],a=n?.some(i=>i.backend_uuid===t?.backend_uuid),o=s.findIndex(i=>i.backend_uuid===t?.backend_uuid);if(o!==-1){const i=[...s];i[o]=t,e.setQueryData(r,i);return}else if(a&&o===-1){const i=[...s,t];e.setQueryData(r,i);return}}if(n&&!t){const s=[...n];e.setQueryData(r,s);return}e.invalidateQueries({queryKey:r})}})},[e])},vR=()=>{const e=It();return f.useCallback(t=>{t?e.getQueriesData({queryKey:Se.makeQueryKey(Bc),exact:!1})?.forEach(([n,r])=>{if(!r)return;const s=r.filter(a=>a.backend_uuid!==t&&a.thread_url_slug!==t);s.length!==r.length&&(s.length?e.setQueryData(n,s):e.removeQueries({queryKey:n,exact:!0}))}):e.removeQueries({queryKey:Se.makeQueryKey(Bc),exact:!1})},[e])},CR=({windowsAppOnly:e=!0}={})=>{const[t,n]=f.useState(()=>globalThis.Notification?globalThis.Notification.permission:"denied"),{device:{isWindowsApp:r}}=jn();f.useEffect(()=>{globalThis.Notification&&globalThis.Notification.permission!==t&&n(globalThis.Notification.permission)},[t]);const s=f.useCallback(async()=>{if(globalThis.Notification){if(t==="granted")return!0;if(t==="denied")return!1;const o=await globalThis.Notification.requestPermission();return n(o),o==="granted"}return!1},[t]),a=f.useCallback(async({title:o,body:i,icon:c="https://r2cdn.perplexity.ai/pplx-desktop-icon.png",onClick:u})=>{if(!(e&&!r||!await s())&&globalThis.Notification){const m=new globalThis.Notification(o,{body:i,icon:c});u&&(m.onclick=()=>{u(),window.focus()})}},[e,r,s]);return f.useMemo(()=>({sendNotification:a,requestPermission:s,permission:t,isWindowsApp:r}),[r,t,s,a])},wR=()=>Se.makeQueryKey("/rest/rate-limit/all",{});function xQ(){const e=It();return f.useCallback(()=>{e.invalidateQueries({queryKey:wR()})},[e])}const bQ=(e,t)=>{const{value:n,loading:r}=Nl({flag:"sapi-ranking-navigate",defaultValue:e,extraAttributes:t,subjectType:"visitor_id"});return f.useMemo(()=>({variation:n,loading:r}),[n,r])},_Q=async({query:e,reason:t,streamId:n,streamTimer:r,provider:s,userIdentity:a})=>{r?.addTimingOnce("web.frontend.v3_navigation_request_sent_ms");const o={query:e,...n&&{cache_key:n},provider:s,...a&&{user_identity:a}},i=await Rq({resource:"https://suggest.perplexity.ai/search/v3/navigate",method:"POST",options:{headers:{"content-type":"application/json","X-Client-Name":"agi_ui_navigate_v3","X-Client-Env":"production"}},body:JSON.stringify(o),timeoutMs:1e3,reason:t});return r?.addTimingOnce("web.frontend.v3_navigation_results_received_ms"),i.json()},P2=e=>Se.makeEphemeralQueryKey("navigationResults",e),SR=e=>Se.makeEphemeralQueryKey("navigationClassifier",e),vQ=async({query:e,userIdentity:t,queryClient:n,reason:r,sapiSearchNavigateConfig:s,streamTimer:a,isComet:o,streamId:i})=>{try{a?.addTimingOnce("web.frontend.web_v3_search_request_sent_ms");const c=n.getQueryData(P2(e));if(c&&c.length>0){a?.addTimingOnce("web.frontend.web_v3_search_results_received_ms",{count:c.length,from_cache:!0});return}const u=s?[`sapi-ranking-navigate-cfg=${JSON.stringify(s)}`]:[],d=await _Q({query:e,reason:r,streamId:i,streamTimer:a,provider:o?"v3":"v2",userIdentity:{lang:t.lang,country:t.country,ab_active_tests:u}}),m=d?.hits,p=d?.classifier;if(i&&p&&n.setQueryData(SR(i),p),m&&m.length>0){const h=m.map(g=>({url:g.url,title:g.title??"",snippet:g.snippet??"",domain:g.domain??void 0,score:g.score??void 0,sitelinks:g.sitelinks}));a?.addTimingOnce("web.frontend.web_v3_search_results_received_ms",{count:h.length,from_cache:!1}),n.setQueryData(P2(e),h)}}catch(c){Z.error("Failed to fetch navigational search results:",c)}},CQ=35,ER=({query:e,isFollowup:t,attachmentsLength:n,sourcesLength:r,isStudyMode:s})=>e.length<=CQ&&!t&&n===0&&r>0&&!s,wQ=()=>{const e=It(),t=c0(),{variation:n,loading:r}=bQ({});return f.useCallback(({query:s,params:a,reason:o,streamTimer:i,isComet:c,streamId:u})=>{if(ER({query:s,isFollowup:!!a.last_backend_uuid,attachmentsLength:a.attachments.length,sourcesLength:a.sources?.length??0,isStudyMode:a.model_preference==="pplx_study"})){const m={lang:a.language,country:t};vQ({query:s,userIdentity:m,queryClient:e,reason:o,sapiSearchNavigateConfig:r?void 0:n,streamTimer:i,isComet:c,streamId:u})}},[e,t,n,r])},wu=(e={})=>Se.makeQueryKey("/rest/user/settings",e),SQ=()=>Se.makeQueryKey("/rest/user/get_user_ai_profile",{}),WKe=()=>Se.makeQueryKey("/rest/user/promotions",{}),EQ=e=>Se.makeQueryKey("/rest/auth/get_special_profile",{profile_name:e}),kR=/(\[\d{1,3}\])/,MR=/(\[\d{1,3},\s*\{ts:\d+\}\])/,Ec=new RegExp(kR.source+"|"+MR.source),Iw=(e,t)=>{if(!Ec.test(e))return;const n=e.match(/\[(\d{1,3})/);if(!n)return;const r=parseInt(n[1],10)-1;return t?.[r]??void 0};function cf(e,t){const n={};for(const r of e){const s=t(r);Object.prototype.hasOwnProperty.call(n,s)?n[s].push(r):Object.defineProperty(n,s,{value:[r],configurable:!0,enumerable:!0,writable:!0})}return n}const Qo={web:"web",scholar:"scholar",social:"social",edgar:"edgar",wiley:"wiley",org:"org",my_files:"my_files",crunchbase:"crunchbase",factset:"factset",google_drive:"google_drive",onedrive:"onedrive",sharepoint:"sharepoint",dropbox:"dropbox",box:"box",notion_mcp:"notion_mcp",outlook:"outlook",linear:"linear",linear_alt:"linear_alt",slack:"slack",github_mcp_direct:"github_mcp_direct",github_delegate_bot:"github_delegate_bot",asana_mcp_direct:"asana_mcp_direct",asana_mcp_merge:"asana_mcp_merge",atlassian_mcp_direct:"atlassian_mcp_direct",slack_direct:"slack_direct",jira_mcp_merge:"jira_mcp_merge",confluence_mcp_merge:"confluence_mcp_merge",microsoft_teams_mcp_merge:"microsoft_teams_mcp_merge",wiley_mcp_cashmere:"wiley_mcp_cashmere",cbinsights_mcp_cashmere:"cbinsights_mcp_cashmere",pitchbook_mcp_cashmere:"pitchbook_mcp_cashmere",statista_mcp_cashmere:"statista_mcp_cashmere",space:"space",gcal:"gcal",sports:"sports",zoom:"zoom",apple_healthkit:"apple_healthkit",google_docs:"google_docs"},kQ=Object.values(Qo).filter(e=>e!=="wiley"&&e!=="edgar"),MQ=["linear","linear_alt","slack","notion_mcp","github_mcp_direct","asana_mcp_direct","asana_mcp_merge","atlassian_mcp_direct","slack_direct","jira_mcp_merge","confluence_mcp_merge","microsoft_teams_mcp_merge","wiley_mcp_cashmere","cbinsights_mcp_cashmere","pitchbook_mcp_cashmere","statista_mcp_cashmere"],TQ={wiley_mcp_cashmere:"wiley_mcp_cashmere",cbinsights_mcp_cashmere:"cbinsights_mcp_cashmere",pitchbook_mcp_cashmere:"pitchbook_mcp_cashmere",statista_mcp_cashmere:"statista_mcp_cashmere"},Ga=e=>kQ.includes(e),jw=e=>Array.isArray(e)?e.filter(Ga):[],AQ=e=>Array.isArray(e)?e.filter(Ga).filter(t=>MQ.includes(t)):[],hi=e=>e?Object.keys(TQ).includes(e):!1,TR=e=>e?.entity_group_type!=="CALENDAR_ACTION"&&!!e?.entities?.length,AR=e=>{const t=!!e?.multiple_choice_quiz_card_block?.questions?.length,n=!!e?.flash_card_section_block;return t||n},kk=e=>!!(e.chunks&&e.chunks.length>0),Mk=e=>!!(e.answer&&e.answer.length>0),Tk=e=>!!e.structured_answer_blocks?.some(t=>t.markdown_block?.chunks?.length||t.entity_list_block?.chunks?.length),Ak=e=>!!e.structured_answer_blocks?.some(t=>t.markdown_block?.answer?.length||t.entity_list_block?.text?.length||TR(t.entity_group_block)),Nk=e=>!!e.structured_answer_blocks?.some(t=>AR(t.inline_entity_block)),Rk=e=>!!e.structured_answer_blocks?.some(t=>t.inline_entity_block?.media_block?.generated_media_items?.some(n=>n.status==="COMPLETED")),NQ=e=>!!e.structured_answer_blocks?.some(t=>t.inline_entity_block?.media_block?.media_items?.some(n=>n.image||n.medium==="image"||n.medium==="video"));class Yt{static hasContent(t){return kk(t)||Mk(t)||Tk(t)||Ak(t)||Rk(t)||NQ(t)||Nk(t)}static hasAnswer(t,n){const r=Rk(t)&&n;return kk(t)||Mk(t)||Tk(t)||Ak(t)||r||Nk(t)}static isPerplexityMessage(t){return t?.blocks!==void 0}static isPerplexityArticleSection(t){return t?.message!==void 0}static isArticleSection(t){return t?.article_info!==void 0}static mergePlaceBlocks(t){const n=t.filter(o=>!!o);if(!n.length)return;const[r,...s]=n;return Object.assign({},r,...s.map(o=>({review_summary:o.review_summary})))}static mergeMediaBlocks(t){const n=t.filter(s=>!!s);return n.length?{media_items:n.flatMap(s=>s?.media_items||[]),generated_media_items:n[n.length-1].generated_media_items||[],progress:n[n.length-1].progress}:void 0}static mergeShoppingBlocks(t){const n=t.filter(o=>!!o);if(!n.length)return;const[r,...s]=n;return Object.assign({},r,...s.map(o=>({review_summary:o.review_summary})))}static mergeEntityListItems(t){const n=cf(t,s=>s.index?.toString()??"0"),r=[];return Object.values(n).forEach(s=>{const a=s[0];r.push({title:a.title,text:s.map(({text:o})=>o).join(""),chunks:s.flatMap(o=>o.chunks??[]).filter(Boolean),chunk_starting_offset:0,index:a.index,awaiting_backfill:s.reduce((o,i)=>i.awaiting_backfill??o,!1),place_block:Yt.mergePlaceBlocks(s.map(o=>o.place_block)),shopping_block:Yt.mergeShoppingBlocks(s.map(o=>o.shopping_block))})}),r}static parseStructuredAnswerBlocks(t){if(!this.isPerplexityMessage(t)||!t.structured_answer_block_usages?.length)return null;const n=cf(t.blocks??[],s=>s.intended_usage),r=[];return t.structured_answer_block_usages.forEach(s=>{const a=n[s];if(!a)return;const{markdownBlocks:o,placeBlocks:i,mediaBlocks:c,shoppingPreviewBlocks:u,entityListBlocks:d,jobsPreviewBlocks:m,hotelsPreviewBlocks:p,placesPreviewBlocks:h,knowledgeCardsBlocks:g,calendarEventBlocks:y,entityGroupBlocks:b,entityGroupV2Blocks:x,assetsPreviewBlocks:_,assetsInlineBlocks:v,shoppingBlocks:C,placeholderBlocks:w,multipleChoiceQuizCardBlocks:S,flashCardSectionBlocks:E,jsonBlocks:T}=a.reduce((k,M)=>(M.markdown_block?k.markdownBlocks.push(M.markdown_block):M.inline_entity_block?.place_block?k.placeBlocks.push(M.inline_entity_block.place_block):M.inline_entity_block?.media_block?k.mediaBlocks.push(M.inline_entity_block.media_block):M.inline_entity_block?.shopping_preview_block?k.shoppingPreviewBlocks.push(M.inline_entity_block.shopping_preview_block):M.entity_list_block?k.entityListBlocks.push(M.entity_list_block):M.inline_entity_block?.jobs_preview_block?k.jobsPreviewBlocks.push(M.inline_entity_block.jobs_preview_block):M.inline_entity_block?.hotels_preview_block?k.hotelsPreviewBlocks.push(M.inline_entity_block.hotels_preview_block):M.inline_entity_block?.places_preview_block?k.placesPreviewBlocks.push(M.inline_entity_block.places_preview_block):M.inline_entity_block?.knowledge_card_block?k.knowledgeCardsBlocks.push(M.inline_entity_block.knowledge_card_block):M.inline_entity_block?.calendar_event_block?k.calendarEventBlocks.push(M.inline_entity_block.calendar_event_block):M.entity_group_block?k.entityGroupBlocks.push(M.entity_group_block):M.entity_group_v2_block?k.entityGroupV2Blocks.push(M.entity_group_v2_block):M.inline_entity_block?.assets_preview_block?k.assetsPreviewBlocks.push(M.inline_entity_block.assets_preview_block):M.inline_entity_block?.assets_inline_block?k.assetsInlineBlocks.push(M.inline_entity_block.assets_inline_block):M.inline_entity_block?.shopping_block?k.shoppingBlocks.push(M.inline_entity_block?.shopping_block):M.inline_entity_block?.placeholder_block?k.placeholderBlocks.push(M.inline_entity_block?.placeholder_block):M.inline_entity_block?.multiple_choice_quiz_card_block?k.multipleChoiceQuizCardBlocks.push(M.inline_entity_block.multiple_choice_quiz_card_block):M.inline_entity_block?.flash_card_section_block?k.flashCardSectionBlocks.push(M.inline_entity_block.flash_card_section_block):M.json_block&&k.jsonBlocks.push(M.json_block),k),{markdownBlocks:[],placeBlocks:[],mediaBlocks:[],shoppingPreviewBlocks:[],entityListBlocks:[],jobsPreviewBlocks:[],hotelsPreviewBlocks:[],placesPreviewBlocks:[],knowledgeCardsBlocks:[],calendarEventBlocks:[],entityGroupBlocks:[],entityGroupV2Blocks:[],assetsPreviewBlocks:[],assetsInlineBlocks:[],shoppingBlocks:[],placeholderBlocks:[],multipleChoiceQuizCardBlocks:[],flashCardSectionBlocks:[],jsonBlocks:[]});if(o.length){const k=o[o.length-1],M=o.flatMap(N=>N.chunks??[]).filter(Boolean);r.push({intended_usage:s,markdown_block:{answer:M.join(""),chunks:M,chunk_starting_offset:0,progress:k.progress,media_items:o.flatMap(N=>N.media_items||[]),inline_token_annotations:o.flatMap(N=>N.inline_token_annotations||[])}})}if(u.length&&r.push({intended_usage:s,inline_entity_block:{shopping_preview_block:u[u.length-1]}}),m.length&&r.push({intended_usage:s,inline_entity_block:{jobs_preview_block:m[m.length-1]}}),p.length&&r.push({intended_usage:s,inline_entity_block:{hotels_preview_block:p[p.length-1]}}),h.length&&r.push({intended_usage:s,inline_entity_block:{places_preview_block:h[h.length-1]}}),i.length&&r.push({intended_usage:s,inline_entity_block:{place_block:Yt.mergePlaceBlocks(i)}}),c.length&&r.push({intended_usage:s,inline_entity_block:{media_block:Yt.mergeMediaBlocks(c)}}),d.length&&r.push({intended_usage:s,entity_list_block:{text:d.map(({text:k})=>k).join(""),chunks:d.flatMap(k=>k.chunks??[]).filter(Boolean),chunk_starting_offset:0,entities:Yt.mergeEntityListItems(d.flatMap(k=>k.entities??[]).filter(Boolean))}}),g.length&&r.push({intended_usage:s,inline_entity_block:{knowledge_card_block:g[g.length-1]}}),y.length&&r.push({intended_usage:s,inline_entity_block:{calendar_event_block:y[y.length-1]}}),b.length&&r.push({intended_usage:s,entity_group_block:{entities:b[b.length-1].entities,entity_group_type:b[b.length-1].entity_group_type}}),x.length){const k=x[x.length-1];r.push({intended_usage:s,entity_group_v2_block:k})}_.length&&r.push({intended_usage:s,inline_entity_block:{assets_preview_block:_[_.length-1]}}),v.length&&r.push({intended_usage:s,inline_entity_block:{assets_inline_block:v[v.length-1]}}),C.length&&r.push({intended_usage:s,inline_entity_block:{shopping_block:this.mergeShoppingBlocks(C)}}),w.length&&r.push({intended_usage:s,inline_entity_block:{placeholder_block:w[w.length-1]}}),S.length&&r.push({intended_usage:s,inline_entity_block:{multiple_choice_quiz_card_block:S[S.length-1]}}),E.length&&r.push({intended_usage:s,inline_entity_block:{flash_card_section_block:E[E.length-1]}}),T.length&&r.push({intended_usage:s,json_block:T[T.length-1]})}),r}static parseAskTextField(t){if(!this.isPerplexityMessage(t))return this.legacyParseBackendOutputStr(t.text);if(!t.blocks?.length)return null;const n={answer:""};n.structured_answer_blocks=Yt.parseStructuredAnswerBlocks(t);const r=t.blocks?.filter(a=>a.intended_usage==="ask_text"&&a.markdown_block).map(a=>a.markdown_block);if(r.length>0){const a=r.flatMap(o=>o.chunks??[]).filter(Boolean);n.chunks=a,n.answer=a.join("")}const s=t.blocks?.filter(a=>a.intended_usage==="web_results"&&a.web_result_block).flatMap(a=>a.web_result_block.web_results??[]).filter(Boolean);return s.length>0&&(n.web_results=s),n}static legacyParseBackendOutputStr(t){let n=null;try{if(n=JSON.parse(t??""),Array.isArray(n)){const r=n[n.length-1];r.step_type=="FINAL"&&r?.content?.answer!=null&&(n=JSON.parse(r.content.answer))}}catch{return null}return n}static isStatusPending(t){return t.status?.toLowerCase()==="pending"}static isStatusBlocked(t){return t.status?.toLowerCase()==="blocked"}static isStatusFailed(t){return t.status?.toLowerCase()==="failed"}static isStatusCompleted(t){return t.status?.toLowerCase()==="completed"}static isCopilotMode(t){return t.mode?.toLowerCase()==="copilot"}static isArticleMode(t){return this.isPerplexityMessage(t)?t?.mode==="ARTICLE":this.isPerplexityArticleSection(t)?t?.message?.mode==="ARTICLE":t?.mode==="article"}static isSourceListType(t){return Array.isArray(t)&&t.every(n=>Object.values(Qo).includes(n))}static hasUnspecifiedSelectionStatus(t){return t?.selection_status==="SELECTION_STATUS_UNSPECIFIED"}static hasMultipleSiblingEntries(t,n){return n?t.filter(s=>s.side_by_side_metadata?.sibling_uuid===n).length>1:!1}}function RQ(e){return e||{connectors:[]}}const Dk=e=>({hasLoadedSettings:!0,pagesLimit:e?.pages_limit??0,uploadLimit:e?.upload_limit,defaultImageGenerationModel:e?.default_image_generation_model??"default",defaultVideoGenerationModel:e?.default_video_generation_model??"default",articleImageUploadLimit:e?.article_image_upload_limit??0,maxFilesPerUser:e?.max_files_per_user??0,maxFilesPerRepository:e?.max_files_per_repository??0,queryCount:e?.query_count??0,queryCountCopilot:e?.query_count_copilot??0,queryCountMobile:e?.query_count_mobile??0,hasAiProfile:e?.has_ai_profile??!1,referralCode:e?.referral_code??"",referralNumSuccess:e?.referral_num_success??0,referralNumCoupons:e?.referral_num_coupons??0,disableTraining:e?.disable_training??!1,isSidebarCollapsed:e?.is_sidebar_collapsed??!1,isSidebarPinned:e?.is_sidebar_pinned??!1,sidebarHiddenHubs:e?.sidebar_hidden_hubs??[],subscriptionTier:e?.subscription_tier??e?.subscription_tier??"null",stripeStatus:e?.stripe_status??"none",revenuecatStatus:e?.revenuecat_status??"none",revenuecatSource:e?.revenuecat_source??"none",createLimit:e?.create_limit??0,notifStatus:e?.notif_status??"daily",emailStatus:e?.email_status??"daily",hasDataRetentionWarning:e?.has_data_retention_warning??!1,allowArticleCreation:e?.allow_article_creation??!1,isVerified:e?.is_verified??!1,connectors:RQ(e?.connectors),connectorLimits:e?.connector_limits??{global_file_count:void 0,repo_type_limits:void 0,max_file_size_mb:void 0,max_attachment_file_size_mb:void 0},alwaysAllowBrowserAgent:e?.always_allow_browser_agent??!1,hasAcceptedApiTerms:e?.has_accepted_api_terms??!1,sources:e?.sources??{source_to_limit:{}}});function DQ(e,t){return e?e.place_widget_block&&t.place_widget_block?{...t,place_widget_block:{...e.place_widget_block,review_summary:t.place_widget_block.review_summary}}:e.shopping_widget_block&&t.shopping_widget_block?{...t,shopping_widget_block:{...e.shopping_widget_block,review_summary:t.shopping_widget_block.review_summary}}:t:t}const NR=async({skipConnectorPickerCredentials:e=!0,headers:t,reason:n})=>{try{const{error:r,data:s,response:a}=await ve.GET("/rest/user/settings",n,{params:{query:{skip_connector_picker_credentials:e}},timeoutMs:1500,numRetries:wi,headers:t});if(r||!s)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to get user settings",cause:r,status:a.status??0});return Dk(s)}catch(r){return Z.error(r),Dk({})}},Ik={hasLoadedSettings:!1,pagesLimit:0,uploadLimit:void 0,articleImageUploadLimit:0,defaultImageGenerationModel:"default",defaultVideoGenerationModel:"default",maxFilesPerUser:0,maxFilesPerRepository:0,queryCount:0,queryCountCopilot:0,queryCountMobile:0,hasAiProfile:!1,referralCode:"",referralNumSuccess:0,referralNumCoupons:0,disableTraining:!1,isSidebarCollapsed:!1,isSidebarPinned:!1,sidebarHiddenHubs:[],subscriptionTier:void 0,stripeStatus:"none",revenuecatStatus:"none",revenuecatSource:"none",createLimit:0,notifStatus:"",emailStatus:"",hasDataRetentionWarning:!1,allowArticleCreation:!1,isVerified:!1,connectors:{connectors:[]},connectorLimits:{global_file_count:void 0,repo_type_limits:void 0,max_file_size_mb:void 0,max_attachment_file_size_mb:void 0},alwaysAllowBrowserAgent:!1,hasAcceptedApiTerms:!1,sources:{source_to_limit:{}}},IQ=()=>{const e=_s("isCollapsed"),{device:{isWindowsApp:t}}=jn();return e===null?t:e==="true"},ga=({enabled:e,reason:t,refetchOnMount:n,skipConnectorPickerCredentials:r=!0})=>{const{locale:s}=Q(),a=wt(),o=IQ(),i=s?{"accept-language":s}:{},c=()=>NR({headers:i,reason:t,skipConnectorPickerCredentials:r}),{data:u,refetch:d,isLoading:m,isStale:p}=gt({enabled:a?typeof e>"u"?!0:e:!1,queryKey:wu({skipConnectorPickerCredentials:r}),queryFn:c,refetchOnMount:n,placeholderData:Ik});f.useEffect(()=>{u&&Dq({queryCount:u.queryCount,queryCountCopilot:u.queryCountCopilot,queryCountMobile:u.queryCountMobile})},[u]);const h=f.useMemo(()=>({...u??Ik,isSidebarCollapsed:o}),[u,o]);return f.useMemo(()=>({...h,refetch:d,isLoading:m,isStale:p}),[h,d,m,p])},jQ=Object.freeze({}),Do=({reason:e,enabled:t=!0,skipConnectorPickerCredentials:n=!0})=>{const{connectors:r}=ga({reason:e,enabled:t,skipConnectorPickerCredentials:n}),s=f.useMemo(()=>r?.connectors?.length?r.connectors.reduce((a,o)=>(a[o.name]=o,a),{}):jQ,[r]);return f.useMemo(()=>({connectorsMap:s}),[s])},RR=({reason:e,enabled:t=!0})=>{const{connectors:n,isLoading:r,isStale:s,refetch:a}=ga({reason:e,enabled:t}),{connectorsMap:o}=Do({reason:e,enabled:t}),i=f.useMemo(()=>(n?.connectors??[]).filter(d=>hk.includes(d.name)&&o[d.name]&&o[d.name].connected),[o,n]),c=f.useMemo(()=>(n?.connectors??[]).filter(d=>!hk.includes(d.name)&&o[d.name]&&o[d.name].connected),[o,n]),u=f.useMemo(()=>(n?.connectors??[]).filter(d=>o[d.name]&&o[d.name].connected),[o,n]);return f.useMemo(()=>({enabledFileConnectors:i,enabledNonFileConnectors:c,enabledConnectors:u,isConnectorsLoading:r,isConnectorsStale:s,refetchConnectors:a}),[u,i,c,r,s,a])},DR=({reason:e})=>{const{connectors:t}=ga({reason:e}),{connectorsMap:n}=Do({reason:e}),r=f.useMemo(()=>(t?.connectors??[]).filter(a=>(a.name==="google_drive"||a.name==="onedrive"||a.name==="sharepoint"||a.name==="dropbox"||a.name==="box")&&!n[a.name]?.connected),[n,t]),s=f.useMemo(()=>(t?.connectors??[]).filter(a=>!n[a.name]?.connected),[n,t]);return f.useMemo(()=>({disabledFileConnectors:r,disabledConnectors:s}),[s,r])},PQ=({reason:e})=>{const t=RR({reason:e}),n=DR({reason:e});return f.useMemo(()=>{const r=I5([...t.enabledConnectors,...t.enabledFileConnectors,...t.enabledNonFileConnectors].map(a=>a.name)),s=I5([...n.disabledConnectors,...n.disabledFileConnectors].map(a=>a.name));return{enabled:r,disabled:s}},[t,n])},OQ=async({headers:e={},params:t,reason:n})=>{try{const{data:r,error:s,response:a}=await ve.GET("/rest/collections/get_collection",n,{params:{query:t},headers:e,timeoutMs:Ct()});if(s)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to get collection",cause:s,status:a.status??0});if(!r?.status||r?.status==="failed")throw new Ue("API_CLIENTS_ERROR",{message:"Failed to get collection",cause:r,status:a.status??0});return r}catch(r){Z.error(r);return}},Pw=e=>Se.makeQueryKey("/rest/collections/get_collection",{collection_slug:e.slice(-22)}),IR=e=>Se.makeQueryKey("/rest/collections/list_collection_threads",e?.slice(-22)),Fx=e=>e?[...IR(e.collection_slug),e.filter_by_user,e.filter_by_shared_threads]:Se.makeQueryKey("/rest/collections/list_collection_threads"),lr=()=>Se.makeQueryKey("/rest/collections/list_user_collections",{}),jR=({collectionSlug:e,reason:t,enabled:n=!!e})=>{const r=async()=>e?await OQ({params:{collection_slug:e,version:_u},reason:t})??null:null,{data:s,isLoading:a}=gt({enabled:n,queryKey:Pw(e??""),queryFn:r,placeholderData:Ja});return f.useMemo(()=>({collection:s??void 0,isLoading:a}),[s,a])},LQ=e=>e?.context_uuid??void 0,FQ=e=>e?.frontend_context_uuid??void 0,UQ=e=>e?.thread_title??"",BQ=e=>e?.query_str??void 0,HQ=e=>e?.search_focus??void 0,VQ=e=>e.sources?.sources??void 0,GQ=e=>e?.author_id??void 0,zQ=e=>e?.author_username??void 0,qQ=e=>e?.author_image??void 0,$Q=e=>{if(e.parent_info)return e.parent_info},WQ=e=>e?.mode??null,KQ=e=>e?.personalized??void 0,YQ=e=>e?.collection_info??void 0,QQ=e=>e?.bookmark_state??void 0,XQ=e=>e?.thread_access??void 0,ZQ=e=>e?.thread_url_slug??void 0,JQ=e=>e?.updated_datetime??void 0,eX=e=>e?.expiry_time??null,tX=e=>e?.privacy_state??void 0,O2=e=>({forkCount:e?.fork_count??0,likeCount:e?.like_count??0,viewCount:e?.view_count??0,userLikes:e?.user_likes??!1}),nX={},Ux=e=>e?{author_id:GQ(e),author_image:qQ(e),author_username:zQ(e),bookmarkState:QQ(e),collection:YQ(e),contextUUID:LQ(e),expiry_time:eX(e)??void 0,first_query:BQ(e),focus:HQ(e),frontendContextUUID:FQ(e),mode:WQ(e)??void 0,parent_info:$Q(e)??void 0,personalized:KQ(e)??void 0,privacy_state:tX(e)??void 0,rwToken:e.read_write_token,sources:VQ(e)??void 0,text_completed:!1,thread_access:XQ(e)??void 0,thread_url_slug:ZQ(e),title:UQ(e),updated_datetime:JQ(e)}:nX;function rX({entries:e,threads:t,streams:n,currentStreamId:r,currentThreadId:s}){const a=r?n[r]:void 0,o=a?.threadId??s;if(o){const i=t.find(c=>c.id===o);if(i){const c=i.entryIds.map(u=>e[u]).filter(u=>u!=null);return a?.placeholderChunk&&!a.entryId&&c.push(a.placeholderChunk),c}}return a?.placeholderChunk?[a.placeholderChunk]:[]}const $f=Bt("ResultsContext",null),sX=({children:e})=>{const t=qf(),[n,r]=f.useState(),[s,a]=f.useState(),o=f.useCallback(p=>{if(r(p),p){const{streams:h}=t.getState(),g=Object.values(h).find(y=>y.threadId===p);a(g?.id.description)}},[t]),i=f.useCallback(p=>{if(a(p),p){const h=t.getState().streams[p];h?.threadId&&r(h.threadId)}},[t]),c=f.useMemo(()=>({setCurrentThreadId:o,setCurrentStreamId:i,clear:()=>{o(void 0),i(void 0)}}),[o,i]),u=f.useCallback(p=>{const h=rX({entries:p.entries,threads:p.threads,streams:p.streams,currentStreamId:s,currentThreadId:n}),g=bq(h),y=_q(h),b=h.find(x=>Yt.isStatusPending(x));return{results:h,firstResult:g,lastResult:y,inFlightEntry:b,inFlight:!!b,inFlightLatest:h.length>0&&y!==void 0&&Yt.isStatusPending(y),socialStats:O2(g?.social_info),resultsLength:h.length}},[n,s]),d=nN(t,u),m=f.useMemo(()=>({...d,actions:c,currentThreadId:n,currentStreamId:s}),[n,s,d,c]);return l.jsx($f.Provider,{value:m,children:e})};function Ht(){const e=f.useContext($f);if(!e)throw new Error("useResults must be used within a ResultsProvider");return e.useProxy()}function Ow(e){const t=f.useContext($f);if(!t)throw new Error("useResultsSelector must be used within a ResultsProvider");return t.useSelector(e)}function u0(){const e=f.useContext($f);if(!e)throw new Error("useResultsActions must be used within a ResultsProvider");return e.actions}const Lw=()=>{const e=f.useContext($f),t=eK(),n=Dw();return f.useCallback(r=>t(e?.currentThreadId,s=>{const a=r(s);if(a)return n(void 0,a),a}),[t,e?.currentThreadId,n])},PR=()=>{const e=JW(),t=Dw();return f.useCallback((n,r)=>{e(n,s=>{const a=r(s);if(a)return t(a,void 0),a})},[e,t])},Fw=({reason:e,collectionSlugOverride:t,collectionUuidOverride:n})=>{const r=sr(),s=fu(),{firstResult:a}=Ht(),o=a?.collection_info?.uuid,i=r?.includes("/search/")&&!!o,c=t??(Array.isArray(s?.slug)?s.slug[0]:s?.slug),{collection:u}=jR({collectionSlug:c,reason:e,enabled:!n}),d=f.useMemo(()=>{let m,p;return i?(m="COLLECTION",p=o??""):r?.includes("/collections")||r?.includes("/spaces")?(m="COLLECTION",p=n||u?.uuid||""):r?.includes("/health")?(m="HEALTH",p=""):(m="ORG",p=""),{file_repository_type:m,owner_id:p}},[i,r,o,n,u?.uuid]);return f.useMemo(()=>({fileRepoInfo:d}),[d])},Uw=10,KKe=Uw*41+46,L2=async({request:e,reason:t})=>{const{fileRepositoryInfo:n,limit:r,offset:s,searchTerm:a,fileStates:o,email:i}=e;try{let c;o.includes("COMPLETE")?c={file_repository_info:n,limit:r,offset:s??0,search_term:a,file_states_in_filter:o}:c={file_repository_info:n,limit:r,offset:s??0,search_term:a,file_states_in_filter:o,email_in_filter:[i]};const{data:u,error:d,response:m}=await ve.POST("/rest/file-repository/list-files",t,{headers:{"content-type":"application/json"},body:c,timeoutMs:Ct(),numRetries:1});if(d)throw new Ue("API_CLIENTS_ERROR",{cause:d,status:m.status??0});return{files:u?.files??[],numTotalFiles:u?.num_total_files??0}}catch(c){return Z.error(c),null}};async function OR({request:e,reason:t}){return new Promise((n,r)=>{ve.SSE("/rest/sse/index_files",t,{params:e,headers:{"content-type":"application/json",accept:"text/event-stream"},handlers:{message:s=>{s.status==="success"?n():r(new Error("Indexing failed"))}}}).catch(r)})}const Bw=(e,t=!1)=>Se.makeQueryKey(t?"/rest/file-repository/list-files-infinite":"/rest/file-repository/list-files",e.file_repository_type,e.owner_id),aX=(e,t,n,r=0,s,a=!1)=>Se.makeQueryKey(...Se.unmakeQueryKey(Bw({file_repository_type:e,owner_id:t},a)),n,...a?[]:[r],s),F2="/rest/files/list",U2="/rest/files/list-infinite",YKe="/rest/files/has-uploaded",jk=(e,t)=>e?Se.makeQueryKey(t?U2:F2,e):Se.makeQueryKey(t?U2:F2),QKe=e=>Se.makeQueryKey("/rest/connectors/sharepoint/sites",e??{}),oX="/rest/file-repository/uploads",iX=e=>Se.makeQueryKey(oX,e),XKe="/rest/files/list-errors",uf=(e,t)=>Se.makeQueryKey("file_exists",e,...t?[t]:[]),ap=e=>Se.makeQueryKey("download-image-url",...e?[e]:[]),LR={keyProp:0,message:null,variant:"success",timeout:null,description:void 0,isVisible:!1,ctaText:void 0,ctaOnClick:void 0,openToast:()=>{},closeToast:()=>{}},FR=Bt("ToastStateContext",LR),lX=A.memo(function({children:t}){const[n,r]=f.useState(LR),s=f.useCallback(({message:i,variant:c,timeout:u,description:d,ctaText:m,ctaOnClick:p,handleClick:h,iconOverride:g,position:y="top"})=>{r(b=>({...b,message:i,variant:c,timeout:u,description:d,ctaText:m,ctaOnClick:p,handleClick:h,iconOverride:g,position:y??"top",isVisible:!0,keyProp:(b.keyProp||0)+1}))},[]),a=f.useCallback(()=>{r(i=>({...i,isVisible:!1}))},[]),o=f.useMemo(()=>({...n,openToast:s,closeToast:a}),[n,s,a]);return l.jsx(FR.Provider,{value:o,children:t})}),cn=()=>{const e=f.useContext(FR);if(!e)throw new Error("useToastState must be used within ToastContext");return e},cX=({fileRepoInfo:e,reason:t})=>{const{$t:n}=Q(),r=It(),s=Bw(e),{openToast:a}=cn(),{session:o}=je(),i=o?.user?.email??"",c=on({mutationFn:async u=>{if(!u.nextURL)throw new Error("File must have a url");const{data:d,error:m,response:p}=await ve.POST("/rest/file-repository/move-attachment-to-persistent-file-path",t,{body:{file_repository_info:e,file_url:u.nextURL},timeoutMs:hs.MEDIUM,retries:2});if(m||!d)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to save file persistently",cause:m,status:p.status??0});return await OR({request:{file_repository_info:e,file_index_params:[{file_s3_url:d.file_url_params.s3_object_url,file_size:u.file.size,filename:u.file.name,file_uuid:d.file_url_params.file_uuid,replace_existing:!1}]},reason:t}),d},onSuccess:(u,d)=>{const m={name:d.file.name,file_s3_url:u.file_url_params.s3_object_url,file_uuid:u.file_url_params.file_uuid,file_title:d.file.name,file_description:null,uploadedBy:i,date:new Date().toLocaleString(),state:"COMPLETE",size:d.file.size,isOptimistic:!0};r.setQueriesData({queryKey:s},h=>{if(!h)return h;const g=h.completedFiles||[];return{...h,completedFiles:[...g,m]}});const p=uf(e.owner_id,d.file.name);r.invalidateQueries({queryKey:p}),a({message:n({defaultMessage:"Saved file",id:"2HZW5WnkV3"}),variant:"success",timeout:3})},onError:(u,d)=>{a({message:n({defaultMessage:"Failed to upload file",id:"x2gE8tKhMn"}),variant:"error",timeout:3}),Z.error("Error saving file with name",d.file.name,u)},onSettled:async()=>{await r.invalidateQueries({queryKey:s})}});return f.useMemo(()=>({saveFile:c.mutate,isLoading:c.isPending}),[c.isPending,c.mutate])},UR=({fileRepoInfo:e,fileName:t,reason:n,enabled:r=!0})=>{const{session:s}=je();return gt({queryKey:uf(e.owner_id,t),refetchOnMount:!0,queryFn:async()=>((await L2({request:{fileRepositoryInfo:e,limit:Uw,offset:0,searchTerm:t,fileStates:["COMPLETE"],email:s?.user?.email??""},reason:n}))?.files.length??0)>0,enabled:r&&e.file_repository_type==="COLLECTION"&&!!e.owner_id&&t.length>0})},jl=()=>{const{session:e}=je(),t=e?.user?.org_uuid;return!!(t&&t!=="none")};class Hw extends Error{constructor(){super("Downloads are disabled"),this.name="DownloadsDisabledError"}}class Vw extends Error{constructor(){super("PDF downloads are restricted"),this.name="PdfUntrustedOriginError"}}class Gw extends Error{constructor(){super("This file belongs to a different organization"),this.name="UserNotInFileOrgError"}}const uX=async({connectionType:e,content:t,reason:n})=>{const{data:r,error:s,response:a}=await ve.POST("/rest/connectors/picker/log",n,{body:{connection_type:e,content:t}});if(s)throw new Ue("API_CLIENTS_ERROR",{message:"Failed log connector picker",cause:s,status:a.status??0});return r},dX=async({request:e,reason:t})=>{const{data:n,error:r,response:s}=await ve.POST("/rest/file-repository/delete-files",t,{body:e});if(r)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to delete files",cause:r,status:s.status??0});return n},BR=async({request:e,reason:t})=>{const{data:n,error:r,response:s}=await ve.POST("/rest/file-repository/download",t,{body:e,timeoutMs:2e3,numRetries:1});if(r){if(r.detail&&typeof r.detail=="object"&&"error_details"in r.detail){if(r.detail.error_details==="DOWNLOADS_DISABLED")throw new Hw;if(r.detail.error_details==="PDF_UNTRUSTED_ORIGIN")throw new Vw;if(r.detail.error_details==="USER_NOT_IN_FILE_ORG")throw new Gw}throw new Ue("API_CLIENTS_ERROR",{message:"Failed to download file",cause:r,status:s.status??0})}return n},fX=async({request:e,reason:t})=>{const{data:n,error:r,response:s}=await ve.POST("/rest/file-repository/download-attachment",t,{body:e,timeoutMs:2e3,numRetries:1});if(r){if(r.detail&&typeof r.detail=="object"&&"error_details"in r.detail){if(r.detail.error_details==="DOWNLOADS_DISABLED")throw new Hw;if(r.detail.error_details==="PDF_UNTRUSTED_ORIGIN")throw new Vw;if(r.detail.error_details==="USER_NOT_IN_FILE_ORG")throw new Gw}throw new Ue("API_CLIENTS_ERROR",{message:"Failed to download attachment",cause:r,status:s.status??0})}return n},zw=()=>Se.makeQueryKey("/rest/enterprise/user/organization",{}),mX="/rest/enterprise/user/organization/users",pX=e=>Se.makeQueryKey(mX,"members"),hX=()=>Se.makeQueryKey("/rest/enterprise/user/organization/seat-info"),gX=({fileRepositoryType:e,offset:t,searchTerm:n,ownerId:r,reason:s})=>{const{$t:a}=Q(),o=It(),i=fu(),{openToast:c}=cn(),u=jl(),d=zw(),m=aX(e,r,Uw,t,n),p=uf(r),h=Array.isArray(i?.slug)?i.slug[0]:i?.slug,g=h?Pw(h):void 0,y=e==="USER"||e==="ORG"||e==="HEALTH"||e==="COLLECTION"&&!!r;return{...on({mutationFn:async x=>{if(!y){c({message:a({defaultMessage:"Unable to delete files.",id:"QYfmPDehhb"}),variant:"error",timeout:3});return}return dX({request:{file_uuids:x,file_repository_info:{file_repository_type:e,owner_id:r}},reason:s})},onMutate:async x=>{await o.cancelQueries({queryKey:m});const _=o.getQueryData(m);return _&&o.setQueryData(m,v=>({...v,completedFiles:v.completedFiles.filter(C=>!x.includes(C.file_uuid)),processingFiles:v.processingFiles.filter(C=>!x.includes(C.file_uuid)),failedFiles:v.failedFiles.filter(C=>!x.includes(C.file_uuid)),numTotalFiles:Math.max((v.numTotalFiles||0)-x.length,0)})),{previousData:_}},onSuccess:()=>{u&&o.invalidateQueries({queryKey:d}),o.invalidateQueries({queryKey:m}),h&&o.invalidateQueries({queryKey:g}),o.invalidateQueries({queryKey:p})},onError:(x,_,v)=>{v?.previousData&&o.setQueryData(m,v.previousData),c({message:a({defaultMessage:"Failed to delete file",id:"aJlra1/tgY"}),variant:"error",timeout:3})}}),isDeleteEnabled:y}},yX=async({headers:e,reason:t})=>{const n={organization:void 0,org_user:void 0,is_in_organization:!1,pending_invitation:null};try{const{data:r,error:s,response:a}=await ve.GET("/rest/enterprise/user/organization",t,{headers:e,timeoutMs:Ct({productionMs:2e3}),numRetries:1});if(s)throw new Ue("API_CLIENTS_ERROR",{cause:s,status:a.status??0,details:{reason:t}});return r.status!=="success",r}catch(r){return Z.error(r),n}};function Hs({shouldRefetchOnMount:e=!0,shouldRefetchOnWindowFocus:t,forceFetch:n=!1,reason:r}){const s=jl(),{data:a,refetch:o,isSuccess:i,isFetching:c}=gt({enabled:n||s,queryKey:zw(),queryFn:()=>yX({reason:r}),placeholderData:Ja,refetchOnMount:e,refetchOnWindowFocus:t});return f.useMemo(()=>({orgUser:a?.org_user,isAdmin:a?.org_user?.role==="ADMIN",organization:a?.organization,isEnterprise:s,refetch:o,isLoading:!a&&c,isFetching:c,isSuccess:i}),[a,s,c,i,o])}const xX=async({fileRepositoryType:e,ownerId:t,limit:n,offset:r,searchTerm:s,email:a,reason:o})=>{const[i,c]=await Promise.all([L2({request:{fileRepositoryInfo:{file_repository_type:e,owner_id:t},limit:n,offset:r,searchTerm:s,fileStates:["COMPLETE"],email:a},reason:o}),L2({request:{fileRepositoryInfo:{file_repository_type:e,owner_id:t},limit:100,offset:0,searchTerm:"",fileStates:["PROCESSING","FAILED"],email:a},reason:o})]),u=d=>({name:d.filename,file_uuid:d.file_uuid,file_s3_url:d.file_s3_url??"",file_title:d.file_title,file_description:d.file_description,uploadedBy:d.uploaded_by,state:d.file_state,size:d.file_size??0,date:new Date(d.time_created).toLocaleString(void 0,{dateStyle:"short",timeStyle:"short"}),error:d.error??void 0,isOptimistic:!1});if(i||c){const d=i?.files?.map(u)||[],m=c?.files?.map(u)||[];return{completedFiles:d,processingFiles:m.filter(p=>p.state==="PROCESSING"),failedFiles:m.filter(p=>p.state==="FAILED"),numTotalFiles:i?.numTotalFiles||0}}return{completedFiles:[],processingFiles:[],failedFiles:[],numTotalFiles:0}},bX=async({request:e,reason:t})=>{try{const{data:n,error:r,response:s}=await ve.POST("/rest/file-repository/uploads",t,{headers:{"content-type":"application/json"},body:e,timeoutMs:Ct(),numRetries:1});if(r)throw new Ue("API_CLIENTS_ERROR",{cause:r,status:s.status??0});return n??null}catch(n){return Z.error(n),null}},_X=({initialIntervalMs:e,maxIntervalMs:t=6e4,timeoutMs:n=9e5})=>{const r=f.useRef(null);return{getInterval:()=>{if(r.current===null)return r.current=Date.now(),e;const o=Date.now()-r.current,i=Math.floor(o/6e4);if(o>=n)return!1;let c=e;for(let u=0;u<i;u++)c<t&&(c=Math.min(c*2,t));return c},reset:()=>{r.current=null}}},vX=5e3,CX=6e4,wX=({reason:e,fileRepoInfo:t,enablePolling:n=!1,forceActivePolling:r=!1})=>{const s=iX(t),{getInterval:a,reset:o}=_X({initialIntervalMs:vX}),{data:i}=gt({queryKey:s,queryFn:()=>bX({request:{file_repository_info:t},reason:e}),refetchInterval:c=>{if(!n)return o(),!1;const{pending_files:u=0}=c.state.data?.summary??{};return u===0&&!r?(o(),CX):a()},refetchIntervalInBackground:!1,staleTime:HW(30)});return{total:i?.summary?.total_files??0,pending:i?.summary?.pending_files??0,errors:i?.summary?.error_files??0,uploads:i?.summary?.total_uploads??0}},SX=({fileRepoInfo:e,reason:t,enablePolling:n=!0})=>{const{isMonitoryingFileRepository:r,getLocalProgress:s,clearLocalFileUploads:a}=GR(),o=It(),[i,c]=f.useState(!1),[u,d]=f.useState(0),[m,p]=f.useState(0),[h,g]=f.useState(0),{total:y,pending:b,errors:x}=wX({enablePolling:n,forceActivePolling:r(e),fileRepoInfo:e,reason:t}),_=s(e),v=u+m,C=b+_.pending,w=x+_.errors,S=v-C;return f.useEffect(()=>{y>u&&d(y),_.total>m&&p(_.total),w>h&&g(w);const E=u>0||m>0,T=y===0,k=_.pending===0;E&&T&&k&&!i&&(c(!0),a(e),o.invalidateQueries({queryKey:jk()}),o.invalidateQueries({queryKey:jk(void 0,!0)})),i&&(y>0||_.pending>0)&&(c(!1),d(0),p(0),g(0))},[y,_.total,_.pending,w,u,m,h,i,o,e,a]),{total:v,pending:C,errors:h,uploaded:S,isFinished:i}},qw={tension:700,friction:50},$w={tension:300,friction:30},EX=f.lazy(async()=>{const{animated:e,useTransition:t}=await W(async()=>{const{animated:r,useTransition:s}=await Promise.resolve().then(()=>YS);return{animated:r,useTransition:s}},void 0);function n({isVisible:r,children:s,className:a,onDestroyed:o}){return t(r,{from:{opacity:0},enter:{opacity:1},leave:{opacity:0},config:{...qw,clamp:!0},onDestroyed:o})((c,u)=>u?l.jsx(e.div,{style:c,className:a,children:s}):null)}return{default:n}});function kX(e){return l.jsx(f.Suspense,{fallback:null,children:l.jsx(EX,{...e})})}function HR(e){const[t,n]=f.useState(e),[r,s]=f.useState(e?"enter":"idle"),[a,o]=f.useState(!1);f.useLayoutEffect(()=>{e?t||(n(!0),s("enter")):t&&s("exit")},[e,t]),f.useLayoutEffect(()=>{r==="idle"&&!a&&o(!0)},[r,a]);const i=f.useCallback(()=>{r==="enter"?s("idle"):r==="exit"&&n(!1)},[r]);return{isPresent:t,animationState:r,isInitialEnter:r==="enter"&&!a,handleAnimationEnd:i}}const MX=f.lazy(async()=>{const{animated:e,useSpring:t}=await W(async()=>{const{animated:r,useSpring:s}=await Promise.resolve().then(()=>YS);return{animated:r,useSpring:s}},void 0);function n({isVisible:r,children:s,className:a}){const{isPresent:o,animationState:i,handleAnimationEnd:c}=HR(r),u=f.useRef(null),[d,m]=f.useState(null);f.useLayoutEffect(()=>{const y=u.current;if(!y||!o)return;const b=()=>{const _=y.scrollHeight;m(_)};b();const x=new ResizeObserver(()=>{b()});return x.observe(y),()=>{x.disconnect()}},[o]);const g=t({to:i==="exit"?{height:0,opacity:0}:{height:d??0,opacity:1},from:{height:0,opacity:0},immediate:!(d!==null),config:{...qw,clamp:!0},onRest:c});return o?l.jsx(e.div,{style:{overflow:"hidden",position:"relative",...g},className:a,children:l.jsx("div",{ref:u,children:s})}):null}return{default:n}});function TX(e){return l.jsx(f.Suspense,{fallback:null,children:l.jsx(MX,{...e})})}const AX=f.lazy(async()=>{const{animated:e,useSpring:t}=await W(async()=>{const{animated:s,useSpring:a}=await Promise.resolve().then(()=>YS);return{animated:s,useSpring:a}},void 0),n=s=>({top:{enter:{transform:"translateY(0px)"},exit:{transform:`translateY(-${s}px)`}},bottom:{enter:{transform:"translateY(0px)"},exit:{transform:`translateY(${s}px)`}},left:{enter:{transform:"translateX(0px)"},exit:{transform:`translateX(-${s}px)`}},right:{enter:{transform:"translateX(0px)"},exit:{transform:`translateX(${s}px)`}}});function r({isVisible:s,children:a,className:o,side:i="bottom",slideDistancePx:c=3}){const{isPresent:u,animationState:d,isInitialEnter:m,handleAnimationEnd:p}=HR(s),h=n(c)[i],g=t({to:d==="exit"?{...h.exit,opacity:0}:{...h.enter,opacity:1},from:{...h.exit,opacity:0},immediate:m,reset:d==="enter"&&!m,config:{...qw,clamp:!0},onRest:p});return u?l.jsx(e.div,{style:{position:"relative",...g},className:o,children:a}):null}return{default:r}});function NX(e){return l.jsx(f.Suspense,{fallback:null,children:l.jsx(AX,{...e})})}const da={Fade:kX,Height:TX,Slide:NX},fl=A.memo(function({keyProp:t=0,message:n,variant:r,description:s,ctaText:a,ctaOnClick:o,closeOnCtaClick:i=!0,isVisible:c=!1,timeout:u,handleClick:d,handleClose:m,onTimeout:p=jr,position:h="top",iconOverride:g,...y}){const[b,x]=f.useState(c);f.useEffect(()=>{x(c)},[c]);const _=u!=null&&u>0;f.useEffect(()=>{let S;return c&&_&&(S=setTimeout(()=>{x(!1),p()},u*1e3)),()=>{clearTimeout(S)}},[b,u,c,p,_]);const v=f.useCallback(()=>{x(!1),m?.()},[m]),C=f.useCallback(()=>{o?.(),i&&v()},[o,v,i]),w=f.useMemo(()=>{if(g)return g;switch(r){case"success":return D("circle-check");case"error":return D("alert-circle");case"refresh":return D("refresh");case"warning":return D("alert-circle")}},[g,r]);return l.jsx(yu,{children:l.jsx("div",{className:z(`right-toastHMargin fixed ${h==="top"?"top-toastVMargin":"bottom-toastVMargin"} z-30 flex items-center justify-center`,{"cursor-pointer":d}),children:l.jsx(da.Slide,{isVisible:b,side:"right",children:l.jsx("div",{...y,children:l.jsxs(Y,{variant:"raised",className:z("gap-x-sm p-md shadow-overlay flex items-center rounded-lg",{"cursor-pointer":r==="refresh"}),onClick:d??jr,children:[l.jsx(Y,{variant:"subtler",className:"p-sm dark:bg-subtle rounded-md",children:l.jsx(B,{variant:"smallBold",color:r==="error"?"red":r==="warning"?"yellow":"super",children:l.jsx(_n,{icon:w,size:"small"})})}),l.jsxs(Y,{className:"flex-1",children:[l.jsx(B,{variant:"small",color:"default",children:n}),s&&l.jsx(B,{variant:"tinyRegular",color:"light",className:"mt-1 whitespace-pre-line",children:s})]}),a&&o&&l.jsx(pt,{text:a,variant:"subtle",onClick:C,size:"small",extraCSS:"ml-xl"}),!_&&l.jsx(pt,{variant:"primary",size:"tiny",icon:D("x"),onClick:v,extraCSS:"ml-sm",noPadding:!0})]})},t)})})})}),RX=({fileRepoInfo:e,collectionSlug:t,onClose:n})=>{const r="upload-progress-toast",{$t:s}=Q(),a=hn(),{total:o,pending:i,errors:c,isFinished:u}=SX({fileRepoInfo:e,reason:r,enablePolling:!0}),d=s({defaultMessage:"See files",id:"p+DFrrlLh2"}),m=f.useCallback(()=>{switch(e.file_repository_type){case"USER":a.push("/account/files");break;case"ORG":a.push("/account/org/files");break;case"COLLECTION":if(!t){pi.error("Collection slug is not set",{fileRepoInfo:e});return}a.push(`/spaces/${t}?showUploadModal`);break;default:pi.warn("Unsupported file repository type",{fileRepoInfo:e})}},[e,a,t]);if(!o)return null;if(u){const y=s({defaultMessage:"{total, number} files synced",id:"1rpVYk4ZN/"},{total:o}),b=s({defaultMessage:"Ready to search",id:"n813XUWD4Q"});return l.jsx(fl,{message:y,description:b,variant:"success",iconOverride:D("circle-check"),ctaText:d,ctaOnClick:m,isVisible:!0,handleClose:n,timeout:null})}const p=Math.round((o-i)/o*100),h=s({defaultMessage:"Syncing {total, plural, one {# file} other {# files}}",id:"bAaiOcNQKr"},{total:o}),g=isNaN(p)?"":c===0?s({defaultMessage:"{percentage, number}% complete",id:"1rUNFit3re"},{percentage:p}):s({defaultMessage:"{percentage, number}% complete with {errors, plural, one {# error} other {# errors}}",id:"WewISkdOck"},{percentage:p,errors:c});return l.jsx(fl,{message:h,description:g,variant:"success",iconOverride:D("refresh"),ctaText:d,ctaOnClick:m,closeOnCtaClick:!1,isVisible:!0,handleClose:n,timeout:null})},Go=(e,t)=>e.file_repository_type===t.file_repository_type&&e.owner_id===t.owner_id,DX=e=>{const t=e.filter(s=>s.status==="uploading").length,n=e.filter(s=>s.status==="failed").length;return{total:e.length,pending:t,errors:n}},VR=Bt("UploadProgressContext",null),GR=()=>{const e=f.useContext(VR);if(!e)throw new Error("useUploadProgress must be used within an UploadProgressProvider");return e},IX=A.memo(function({children:t}){const[n,r]=f.useState([]),s=f.useCallback(({fileRepoInfo:x,collectionSlug:_})=>{r(v=>v.some(w=>Go(w.fileRepoInfo,x)&&w.collectionSlug===_)?v:[...v,{id:v.length+1,fileRepoInfo:x,collectionSlug:_,localFileUploads:[],progressBarVisible:!1}])},[]),a=f.useCallback(x=>{r(_=>_.filter(v=>v.id!==x))},[]),o=f.useCallback(x=>n.some(_=>Go(_.fileRepoInfo,x)),[n]),i=f.useCallback(({fileRepoInfo:x,visible:_})=>{r(v=>v.map(C=>Go(C.fileRepoInfo,x)?{...C,progressBarVisible:_}:C))},[]),c=f.useCallback(({fileRepoInfo:x,fileId:_})=>{r(v=>v.map(C=>Go(C.fileRepoInfo,x)?{...C,localFileUploads:[...C.localFileUploads,{fileId:_,status:"uploading"}]}:C))},[]),u=f.useCallback(x=>{r(_=>_.map(v=>Go(v.fileRepoInfo,x)?{...v,localFileUploads:[]}:v))},[]),d=f.useCallback(({fileRepoInfo:x,fileId:_,status:v})=>{r(C=>C.map(w=>{if(!Go(w.fileRepoInfo,x))return w;const S=w.localFileUploads.map(E=>E.fileId===_?{...E,status:v}:E);return{...w,localFileUploads:S}}))},[]),m=f.useCallback(({fileRepoInfo:x,fileId:_})=>{r(v=>v.map(C=>{if(!Go(C.fileRepoInfo,x))return C;const w=C.localFileUploads.filter(S=>S.fileId!==_);return{...C,localFileUploads:w}}))},[]),p=f.useCallback(x=>{const _=n.find(v=>Go(v.fileRepoInfo,x));return _?DX(_.localFileUploads):{total:0,pending:0,errors:0}},[n]),h=f.useMemo(()=>({startMonitoring:s,isMonitoryingFileRepository:o,setProgressBarVisible:i,addLocalFileUpload:c,updateLocalFileUploadStatus:d,removeLocalFileUpload:m,clearLocalFileUploads:u,getLocalProgress:p}),[s,o,i,c,d,m,u,p]),g=n.at(-1),y=g&&!g.progressBarVisible,b=f.useCallback(()=>{g?.id&&a(g.id)},[g?.id,a]);return l.jsxs(VR.Provider,{value:h,children:[t,y&&g&&l.jsx(RX,{fileRepoInfo:g.fileRepoInfo,collectionSlug:g.collectionSlug,onClose:b})]})}),yc="__temp__",jX=[Yr.OWNER_ONLY,Yr.PRIVATE_READ,Yr.COLLECTION_READ],PX=async({request:e,reason:t})=>{const{data:n,error:r,response:s}=await ve.POST("/rest/file-repository/get-file-upload-urls",t,{body:e,timeoutMs:5e3,numRetries:1});if(r)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to get fileUploadUrl",cause:r,status:s.status??0});return n},Pk=10,OX=async(e,t)=>{const s=new FormData;Object.entries(t.fields).forEach(([o,i])=>{s.append(o,i)}),s.append("file",e);let a=null;for(let o=0;o<1;o++)try{o>0&&await new Promise(c=>setTimeout(c,2e3));const i=await fetch(t.s3_bucket_url,{method:"POST",body:s});if(Z.info("S3 upload response received",{fileUrl:t.s3_bucket_url,fileUuid:t.file_uuid,status:i.status,statusText:i.statusText,ok:i.ok}),!i.ok)throw new Error(`HTTP error ${i.status}: ${i.statusText}`);return}catch(i){a=i instanceof Error?i:new Error(String(i)),Z.error("S3 upload error",{fileUuid:t.file_uuid,attempt:o,errorMessage:a.message,errorName:a.name,errorStack:a.stack})}throw new Error(`UPLOAD_FAILED after 1 attempts: ${a?.message||"Unknown error"}`)},LX=({fileRepoInfo:e,setTotalFilesUploading:t,replaceExisting:n,reason:r,onLocalFileUploadSuccess:s})=>{const{$t:a}=Q(),o=It(),i=zw(),c=fu(),u=Array.isArray(c?.slug)?c.slug[0]:c?.slug,d=u?Pw(u):void 0,{openToast:m}=cn(),{session:p}=je(),h=p?.user?.email??"",g=ga({reason:r}),{addLocalFileUpload:y,updateLocalFileUploadStatus:b}=GR(),x=Bw(e),_=Se.makeQueryKey("list_file_directory_infinite",e.file_repository_type,e.owner_id),v=e.file_repository_type==="USER"||e.file_repository_type==="ORG"||e.file_repository_type==="HEALTH"||e.file_repository_type==="COLLECTION"&&!!e.owner_id&&e.owner_id!==yc;return{...on({mutationFn:async w=>{if(!v){m({message:a({defaultMessage:"Unable to upload files.",id:"GrtfijFWiu"}),variant:"error",timeout:3});return}t(w.length);const S=new Map;w.forEach(E=>{const T=crypto.randomUUID();S.set(E.name,T),y({fileRepoInfo:e,fileId:T})});for(let E=0;E<w.length;E+=Pk){const T=w.slice(E,E+Pk),k=await PX({request:{file_upload_params:T.map(O=>({filename:O.name,content_type:O.type,file_size:O.size})),file_repository_info:e},reason:r}),M=k.limits_reached[0];if(M==="FILE_REPOSITORY_LIMIT_EXCEEDED"){const O=g.connectorLimits?.repo_type_limits?.[e.file_repository_type].max_files??g.maxFilesPerRepository;m({message:a({defaultMessage:"You have reached the file limit of {limit} files per repository.",id:"J0uyf2gB1u"},{limit:O}),variant:"error",timeout:3});break}else if(M==="USER_FILE_LIMIT_EXCEEDED"){const O=g.maxFilesPerUser;m({message:a({defaultMessage:"You've reached your total file limit of {limit} files across My Files and all Spaces. Delete some files or upgrade your plan to add more",id:"3CuAQ4xs/C"},{limit:O}),variant:"error",timeout:3});break}const P=(await Promise.allSettled(k.file_url_params.map((O,L)=>O&&T[L]?{fileUploadUrlInfo:O,file:T[L]}:null).filter(O=>O!==null).map(async({fileUploadUrlInfo:O,file:L})=>{const H=S.get(L.name);try{return await OX(L,O),Z.info("S3 upload completed successfully",{fileUuid:O.file_uuid}),{file_s3_url:O.s3_object_url,filename:L.name,file_size:L.size,file_uuid:O.file_uuid,replace_existing:n}}catch(R){H&&b({fileRepoInfo:e,fileId:H,status:"failed"});const I=R instanceof Error?{message:R.message,name:R.name,stack:R.stack}:{error:String(R)};throw Z.error("Upload promise caught error",{fileUuid:O.file_uuid,...I}),m({message:a({defaultMessage:"Failed to upload file",id:"x2gE8tKhMn"}),variant:"error",timeout:3}),R}}))).filter(O=>O.status==="fulfilled").map(O=>O.value);if(Z.info("Starting file indexing",{fileCount:P.length,fileUuids:P.map(O=>O.file_uuid)}),P.length>0&&(await OR({request:{file_repository_info:e,file_index_params:P},reason:r}),P.forEach(O=>{const L=S.get(O.filename);L&&b({fileRepoInfo:e,fileId:L,status:"success"})})),k.limits_reached.length>0)break}},onMutate:async w=>{await o.cancelQueries({queryKey:x});const S=o.getQueryData(x),E=w.map(T=>({name:T.name,file_s3_url:"",file_title:null,file_description:null,file_uuid:crypto.randomUUID(),uploadedBy:h,state:"PROCESSING",size:T.size,date:new Date().toLocaleString(),isOptimistic:!0}));return o.setQueriesData({queryKey:x},T=>T&&{...T,processingFiles:[...T.processingFiles||[],...E]}),{previousData:S,optimisticFiles:E,uploadedFilesCount:w.length}},onError:(w,S,E)=>{m({message:a({defaultMessage:"Failed to upload file",id:"x2gE8tKhMn"}),variant:"error",timeout:3}),E?.previousData&&o.setQueriesData({queryKey:x},E.previousData)},onSettled:()=>{o.invalidateQueries({queryKey:x}),o.invalidateQueries({queryKey:_}),o.invalidateQueries({queryKey:Se.makeQueryKey(F2)}),o.invalidateQueries({queryKey:Se.makeQueryKey(U2)}),e.file_repository_type==="ORG"&&o.invalidateQueries({queryKey:i}),u&&o.invalidateQueries({queryKey:d})},onSuccess:()=>{s?.()}}),isUploadEnabled:v}},FX=async({thread_uuid:e,format:t,filename:n,reason:r})=>{const{data:s,error:a,response:o}=await ve.POST("/rest/thread/export",r,{body:{thread_uuid:e,format:t,filename:n},timeoutMs:Ct({productionMs:hs.VERY_HIGH,clientSideMs:hs.VERY_HIGH,devMs:hs.VERY_HIGH})});if(a)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to export thread",cause:a,status:o.status??0});return s},UX=({fileRepoInfo:e,fileExists:t,reason:n})=>{const{openToast:r}=cn(),{session:s}=je(),a=f.useMemo(()=>s?.user?.email??"",[s]),o=It(),{mutate:i}=LX({fileRepoInfo:e,setTotalFilesUploading:()=>1,replaceExisting:t,reason:n}),{mutateAsync:c}=gX({fileRepositoryType:e.file_repository_type,offset:0,searchTerm:"",ownerId:e.owner_id,reason:n}),u=f.useCallback(async(m,p)=>{try{if(!m||!p)return;const h=await FX({thread_uuid:m,format:"md",filename:p,reason:n}),g=atob(h.file_content_64),y=new Array(g.length);for(let v=0;v<g.length;v++)y[v]=g.charCodeAt(v);const b=new Uint8Array(y),x=new Blob([b],{type:"application/md"}),_=new File([x],h.filename,{type:"application/md"});await i([_]),o.setQueryData(uf(e.owner_id,p),!0),t||r({message:"Successfully saved to space",variant:"success",timeout:3})}catch(h){r({message:`Failed to save to space: ${h}`,variant:"error",timeout:3})}},[i,r,t,e,o,n]),d=f.useCallback(async m=>{try{const h=(await xX({fileRepositoryType:e.file_repository_type,limit:10,offset:0,searchTerm:"",email:a,ownerId:e.owner_id,reason:n}))?.completedFiles.find(g=>g.name.includes(m??""));if(!h?.file_uuid)return;await c([h.file_uuid]),o.setQueryData(uf(e.owner_id,m),!1),r({message:"File removed from space",variant:"success",timeout:3})}catch(p){r({message:`Failed to remove from space: ${p}`,variant:"error",timeout:3})}},[c,r,o,e.owner_id,a,n,e.file_repository_type]);return f.useMemo(()=>({saveThreadToSpace:u,removeThreadFromSpace:d}),[d,u])},BX={pro:"pro",max:"max"},HX=e=>Object.keys(BX).includes(e);function Mt(){const{session:e}=je(),t=e?.user?.subscription_status??"none",n=t==="active"||t==="trialing"||t==="white_glove_past_due",r=e?.user?.subscription_tier,s=HX(r)?r:void 0,a=n&&(s==="pro"||!s),o=n&&s==="max",i=a||o,c=n?e?.user?.subscription_source:"none",u=n&&c==="enterprise",d=u&&(s==="pro"||!s),m=u&&s==="max";return f.useMemo(()=>({isPro:a,isMax:o,hasAccessToProFeatures:i,hasActiveSubscription:n,subscriptionSource:c,subscriptionStatus:t,subscriptionTier:s,isEnterprise:u,isEnterprisePro:d,isEnterpriseMax:m}),[i,o,a,n,c,t,s,u,d,m])}const zR=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"enable-opus-4-6-web",defaultValue:e,extraAttributes:t,subjectType:"visitor_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])};var te;(function(e){e.DEFAULT="turbo",e.PPLX_PRO_UPGRADED="pplx_pro_upgraded",e.PRO="pplx_pro",e.SONAR="experimental",e.GPT_4o="gpt4o",e.GPT_4_1="gpt41",e.GPT_5_1="gpt51",e.GPT_5_2="gpt52",e.CLAUDE_2="claude2",e.GEMINI_2_5_PRO="gemini25pro",e.GEMINI_3_0_PRO="gemini30pro",e.GEMINI_3_0_FLASH="gemini30flash",e.GEMINI_3_0_FLASH_HIGH="gemini30flash_high",e.GROK="grok",e.PPLX_REASONING="pplx_reasoning",e.CLAUDE_3_7_SONNET_THINKING="claude37sonnetthinking",e.O4_MINI="o4mini",e.GPT_5_1_THINKING="gpt51_thinking",e.GPT_5_2_THINKING="gpt52_thinking",e.CLAUDE_4_0_OPUS="claude40opus",e.CLAUDE_4_1_OPUS="claude41opus",e.CLAUDE_4_5_OPUS="claude45opus",e.CLAUDE_4_0_OPUS_THINKING="claude40opusthinking",e.CLAUDE_4_1_OPUS_THINKING="claude41opusthinking",e.CLAUDE_4_5_OPUS_THINKING="claude45opusthinking",e.CLAUDE_4_6_OPUS="claude46opus",e.CLAUDE_4_6_OPUS_THINKING="claude46opusthinking",e.CLAUDE_4_5_SONNET="claude45sonnet",e.CLAUDE_4_5_SONNET_THINKING="claude45sonnetthinking",e.KIMI_K2_5_THINKING="kimik25thinking",e.GROK_4="grok4",e.GROK_4_NON_THINKING="grok4nonthinking",e.GROK_4_1_REASONING="grok41reasoning",e.GROK_4_1_NON_REASONING="grok41nonreasoning",e.PPLX_SONAR_INTERNAL_TESTING="pplx_sonar_internal_testing",e.PPLX_SONAR_INTERNAL_TESTING_V2="pplx_sonar_internal_testing_v2",e.ALPHA="pplx_alpha",e.BETA="pplx_beta",e.STUDY="pplx_study",e.AGENTIC_RESEARCH="pplx_agentic_research",e.BROWSER_AGENT="comet_browser_agent",e.BROWSER_AGENT_SONNET="comet_browser_agent_sonnet",e.BROWSER_AGENT_OPUS="comet_browser_agent_opus",e.ASI="pplx_asi"})(te||(te={}));var Ne;(function(e){e.GPT_4="gpt4",e.CLAUDE_3_OPUS="claude3opus",e.CLAUDE_3_5_HAIKU="claude35haiku",e.GEMINI="gemini",e.LLAMA_X_LARGE="llama_x_large",e.MISTRAL="mistral",e.GROK2="grok2",e.COPILOT="copilot",e.O3_MINI="o3mini",e.CLAUDE_OMBRE_EAP="claude_ombre_eap",e.CLAUDE_LACE_EAP="claude_lace_eap",e.R1="r1",e.GAMMA="pplx_gamma",e.O3="o3",e.GEMINI_2_FLASH="gemini2flash",e.GPT_5="gpt5",e.GPT_5_THINKING="gpt5_thinking",e.GPT5_PRO="gpt5_pro",e.O3_PRO="o3pro",e.O3_PRO_RESEARCH="o3pro_research",e.O3_PRO_LABS="o3pro_labs",e.TESTING_MODEL_C="testing_model_c",e.O3_RESEARCH="o3_research",e.CLAUDE40SONNET_RESEARCH="claude40sonnet_research",e.CLAUDE40SONNETTHINKING_RESEARCH="claude40sonnetthinking_research",e.CLAUDE40OPUS_RESEARCH="claude40opus_research",e.CLAUDE40OPUSTHINKING_RESEARCH="claude40opusthinking_research",e.O3_LABS="o3_labs",e.CLAUDE40SONNETTHINKING_LABS="claude40sonnetthinking_labs",e.CLAUDE40OPUSTHINKING_LABS="claude40opusthinking_labs",e.KIMI_K2_THINKING="kimik2thinking"})(Ne||(Ne={}));var K;(function(e){e.SEARCH="search",e.RESEARCH="research",e.AGENTIC_RESEARCH="agentic_research",e.STUDIO="studio",e.STUDY="study",e.BROWSER_AGENT="browser_agent",e.ASI="asi"})(K||(K={}));function Ww(e){return Object.values(K).includes(e)}function VX(e){switch(e){case"SEARCH":return K.SEARCH;case"RESEARCH":return K.RESEARCH;case"STUDIO":return K.STUDIO;case"STUDY":return K.STUDY;case"AGENTIC_RESEARCH":return K.AGENTIC_RESEARCH;case"BROWSER_AGENT":return K.BROWSER_AGENT;case"ASI":return K.ASI;case"SEARCH_MODE_UNSPECIFIED":case void 0:return K.SEARCH;default:try{St(e)}catch{return Z.error(`Unknown PerplexityMessage search mode: ${e}`),K.SEARCH}}}const GX=[te.DEFAULT,te.PRO],df=e=>GX.includes(e),B2=3;var zn;(function(e){e.PRO="pro",e.MAX="max"})(zn||(zn={}));const Kw={[te.DEFAULT]:K.SEARCH,[te.PPLX_PRO_UPGRADED]:K.SEARCH,[te.PRO]:K.SEARCH,[te.SONAR]:K.SEARCH,[te.CLAUDE_2]:K.SEARCH,[te.CLAUDE_4_5_SONNET]:K.SEARCH,[te.CLAUDE_4_5_SONNET_THINKING]:K.SEARCH,[te.KIMI_K2_5_THINKING]:K.SEARCH,[te.GPT_4o]:K.SEARCH,[te.GPT_4_1]:K.SEARCH,[te.GPT_5_1]:K.SEARCH,[te.GPT_5_2]:K.SEARCH,[te.GEMINI_2_5_PRO]:K.SEARCH,[te.GEMINI_3_0_PRO]:K.SEARCH,[te.GEMINI_3_0_FLASH]:K.SEARCH,[te.GEMINI_3_0_FLASH_HIGH]:K.SEARCH,[te.GROK]:K.SEARCH,[te.PPLX_REASONING]:K.SEARCH,[te.CLAUDE_3_7_SONNET_THINKING]:K.SEARCH,[te.CLAUDE_4_0_OPUS]:K.SEARCH,[te.CLAUDE_4_0_OPUS_THINKING]:K.SEARCH,[te.CLAUDE_4_1_OPUS]:K.SEARCH,[te.CLAUDE_4_1_OPUS_THINKING]:K.SEARCH,[te.CLAUDE_4_5_OPUS]:K.SEARCH,[te.CLAUDE_4_5_OPUS_THINKING]:K.SEARCH,[te.CLAUDE_4_6_OPUS]:K.SEARCH,[te.CLAUDE_4_6_OPUS_THINKING]:K.SEARCH,[te.GROK_4]:K.SEARCH,[te.GROK_4_NON_THINKING]:K.SEARCH,[te.GROK_4_1_REASONING]:K.SEARCH,[te.GROK_4_1_NON_REASONING]:K.SEARCH,[te.GPT_5_1_THINKING]:K.SEARCH,[te.GPT_5_2_THINKING]:K.SEARCH,[te.PPLX_SONAR_INTERNAL_TESTING]:K.SEARCH,[te.PPLX_SONAR_INTERNAL_TESTING_V2]:K.SEARCH,[Ne.TESTING_MODEL_C]:K.SEARCH,[Ne.GPT_5_THINKING]:K.SEARCH,[Ne.GPT_5]:K.SEARCH,[Ne.GPT5_PRO]:K.SEARCH,[Ne.GPT_4]:K.SEARCH,[Ne.CLAUDE_3_OPUS]:K.SEARCH,[Ne.CLAUDE_3_5_HAIKU]:K.SEARCH,[Ne.GEMINI]:K.SEARCH,[Ne.LLAMA_X_LARGE]:K.SEARCH,[Ne.MISTRAL]:K.SEARCH,[Ne.GROK2]:K.SEARCH,[Ne.COPILOT]:K.SEARCH,[Ne.O3_MINI]:K.SEARCH,[Ne.CLAUDE_OMBRE_EAP]:K.SEARCH,[Ne.CLAUDE_LACE_EAP]:K.SEARCH,[Ne.R1]:K.SEARCH,[Ne.GAMMA]:K.SEARCH,[Ne.O3]:K.SEARCH,[Ne.GEMINI_2_FLASH]:K.SEARCH,[Ne.O3_PRO]:K.SEARCH,[Ne.O3_PRO_RESEARCH]:K.RESEARCH,[Ne.O3_PRO_LABS]:K.STUDIO,[Ne.O3_RESEARCH]:K.RESEARCH,[Ne.CLAUDE40SONNET_RESEARCH]:K.RESEARCH,[Ne.CLAUDE40SONNETTHINKING_RESEARCH]:K.RESEARCH,[Ne.CLAUDE40OPUS_RESEARCH]:K.RESEARCH,[Ne.CLAUDE40OPUSTHINKING_RESEARCH]:K.RESEARCH,[Ne.O3_LABS]:K.STUDIO,[Ne.CLAUDE40SONNETTHINKING_LABS]:K.STUDIO,[Ne.CLAUDE40OPUSTHINKING_LABS]:K.STUDIO,[Ne.KIMI_K2_THINKING]:K.SEARCH,[te.ALPHA]:K.RESEARCH,[te.O4_MINI]:K.RESEARCH,[te.BETA]:K.STUDIO,[te.STUDY]:K.STUDY,[te.AGENTIC_RESEARCH]:K.AGENTIC_RESEARCH,[te.BROWSER_AGENT]:K.BROWSER_AGENT,[te.BROWSER_AGENT_SONNET]:K.BROWSER_AGENT,[te.BROWSER_AGENT_OPUS]:K.BROWSER_AGENT,[te.ASI]:K.ASI},zX=(e,t)=>Kw[e]===t,Yw=(e,t=K.SEARCH)=>e&&Kw[e]||t;var Ge;(function(e){e.PERPLEXITY="perplexity",e.ANTHROPIC="anthropic",e.OPENAI="openai",e.GOOGLE="google",e.XAI="xai",e.KIMI="kimi"})(Ge||(Ge={}));const qR={[te.DEFAULT]:Ge.PERPLEXITY,[te.PPLX_PRO_UPGRADED]:Ge.PERPLEXITY,[te.PRO]:null,[te.SONAR]:Ge.PERPLEXITY,[te.PPLX_REASONING]:Ge.PERPLEXITY,[te.ALPHA]:Ge.PERPLEXITY,[te.BETA]:Ge.PERPLEXITY,[te.STUDY]:Ge.PERPLEXITY,[te.AGENTIC_RESEARCH]:Ge.PERPLEXITY,[te.ASI]:Ge.PERPLEXITY,[te.PPLX_SONAR_INTERNAL_TESTING]:Ge.PERPLEXITY,[te.PPLX_SONAR_INTERNAL_TESTING_V2]:Ge.PERPLEXITY,[te.BROWSER_AGENT]:Ge.ANTHROPIC,[te.BROWSER_AGENT_SONNET]:Ge.ANTHROPIC,[te.BROWSER_AGENT_OPUS]:Ge.ANTHROPIC,[te.CLAUDE_2]:Ge.ANTHROPIC,[te.CLAUDE_3_7_SONNET_THINKING]:Ge.ANTHROPIC,[te.CLAUDE_4_0_OPUS]:Ge.ANTHROPIC,[te.CLAUDE_4_1_OPUS]:Ge.ANTHROPIC,[te.CLAUDE_4_5_OPUS]:Ge.ANTHROPIC,[te.CLAUDE_4_0_OPUS_THINKING]:Ge.ANTHROPIC,[te.CLAUDE_4_1_OPUS_THINKING]:Ge.ANTHROPIC,[te.CLAUDE_4_5_OPUS_THINKING]:Ge.ANTHROPIC,[te.CLAUDE_4_6_OPUS]:Ge.ANTHROPIC,[te.CLAUDE_4_6_OPUS_THINKING]:Ge.ANTHROPIC,[te.CLAUDE_4_5_SONNET]:Ge.ANTHROPIC,[te.CLAUDE_4_5_SONNET_THINKING]:Ge.ANTHROPIC,[te.GPT_4o]:Ge.OPENAI,[te.GPT_4_1]:Ge.OPENAI,[te.GPT_5_1]:Ge.OPENAI,[te.GPT_5_2]:Ge.OPENAI,[te.O4_MINI]:Ge.OPENAI,[te.GPT_5_1_THINKING]:Ge.OPENAI,[te.GPT_5_2_THINKING]:Ge.OPENAI,[te.GEMINI_2_5_PRO]:Ge.GOOGLE,[te.GEMINI_3_0_PRO]:Ge.GOOGLE,[te.GEMINI_3_0_FLASH]:Ge.GOOGLE,[te.GEMINI_3_0_FLASH_HIGH]:Ge.GOOGLE,[te.GROK]:Ge.XAI,[te.GROK_4]:Ge.XAI,[te.GROK_4_NON_THINKING]:Ge.XAI,[te.GROK_4_1_REASONING]:Ge.XAI,[te.GROK_4_1_NON_REASONING]:Ge.XAI,[te.KIMI_K2_5_THINKING]:Ge.KIMI,[Ne.GPT_4]:Ge.OPENAI,[Ne.GPT_5]:Ge.OPENAI,[Ne.GPT_5_THINKING]:Ge.OPENAI,[Ne.GPT5_PRO]:Ge.OPENAI,[Ne.O3_MINI]:Ge.OPENAI,[Ne.O3]:Ge.OPENAI,[Ne.O3_PRO]:Ge.OPENAI,[Ne.O3_PRO_RESEARCH]:Ge.OPENAI,[Ne.O3_PRO_LABS]:Ge.OPENAI,[Ne.O3_RESEARCH]:Ge.OPENAI,[Ne.O3_LABS]:Ge.OPENAI,[Ne.CLAUDE_3_OPUS]:Ge.ANTHROPIC,[Ne.CLAUDE_3_5_HAIKU]:Ge.ANTHROPIC,[Ne.CLAUDE_OMBRE_EAP]:Ge.ANTHROPIC,[Ne.CLAUDE_LACE_EAP]:Ge.ANTHROPIC,[Ne.R1]:Ge.ANTHROPIC,[Ne.GEMINI]:Ge.GOOGLE,[Ne.GEMINI_2_FLASH]:Ge.GOOGLE,[Ne.GROK2]:Ge.XAI,[Ne.MISTRAL]:null,[Ne.LLAMA_X_LARGE]:null,[Ne.COPILOT]:null,[Ne.GAMMA]:Ge.PERPLEXITY,[Ne.TESTING_MODEL_C]:null,[Ne.CLAUDE40SONNET_RESEARCH]:Ge.ANTHROPIC,[Ne.CLAUDE40SONNETTHINKING_RESEARCH]:Ge.ANTHROPIC,[Ne.CLAUDE40OPUS_RESEARCH]:Ge.ANTHROPIC,[Ne.CLAUDE40OPUSTHINKING_RESEARCH]:Ge.ANTHROPIC,[Ne.CLAUDE40SONNETTHINKING_LABS]:Ge.ANTHROPIC,[Ne.CLAUDE40OPUSTHINKING_LABS]:Ge.ANTHROPIC,[Ne.KIMI_K2_THINKING]:Ge.KIMI},qX=e=>qR[e],$X={[Ge.PERPLEXITY]:D("custom-perplexity-mark"),[Ge.ANTHROPIC]:D("custom-brand-anthropic"),[Ge.OPENAI]:D("custom-brand-openai"),[Ge.GOOGLE]:D("custom-brand-google"),[Ge.XAI]:D("custom-brand-xai"),[Ge.KIMI]:D("custom-brand-kimi")},WX=e=>$X[e],Qw=e=>{const t=qR[e];return t?WX(t):null},$R={[K.SEARCH]:D("search"),[K.RESEARCH]:D("telescope"),[K.STUDIO]:D("table-plus"),[K.STUDY]:D("book"),[K.AGENTIC_RESEARCH]:D("gavel"),[K.BROWSER_AGENT]:D("click"),[K.ASI]:D("sparkles")},gi=e=>$R[e],KX={...$R,[K.SEARCH]:D("search")},YX=e=>KX[e];te.DEFAULT,K.SEARCH,te.PPLX_REASONING,K.SEARCH,te.ALPHA,K.RESEARCH;const QX=e=>typeof e=="string"&&e in Kw,WR=Object.values(K),XX=[K.SEARCH,K.BROWSER_AGENT,K.AGENTIC_RESEARCH];function uh(e){return XX.includes(e)}function KR(e,t){const n=e===K.AGENTIC_RESEARCH?K.SEARCH:e;return t.filter(r=>zX(r,n))}const Yn={[K.SEARCH]:Me({askInputPlaceholder:{defaultMessage:"Ask anything",id:"AUouhaZgFv"},name:{defaultMessage:"Search",id:"xmcVZ0BU63"},description:{defaultMessage:"Get fast answers to everyday questions",id:"9w9MKw/DzR"}}),[K.RESEARCH]:Me({askInputPlaceholder:{defaultMessage:"Deep research anything",id:"+LRFB6AK9s"},name:{defaultMessage:"Deep research",id:"gP4/7g8Ps1"},description:{defaultMessage:"Create in-depth reports with more sources, charts, and advanced reasoning",id:"v+naw8f6SY"}}),[K.STUDIO]:Me({askInputPlaceholder:{defaultMessage:"Create anything",id:"pmtrj6Tjm9"},name:{defaultMessage:"Create files and apps",id:"DwoODHf+gf"},description:{defaultMessage:"Turn your ideas into docs, slides, dashboards, and more",id:"jglNqkODFU"}}),[K.STUDY]:Me({askInputPlaceholder:{defaultMessage:"Study anything",id:"UOEDdZ+cnD"},name:{defaultMessage:"Learn step by step",id:"ecHuLjb6pR"},description:{defaultMessage:"Study and understand topics with interactive questions",id:"b2qt+pagaU"}}),[K.AGENTIC_RESEARCH]:Me({askInputPlaceholder:{defaultMessage:"Ask anything",id:"AUouhaZgFv"},name:{defaultMessage:"Model council",id:"Vogw3sJFoa"},description:{defaultMessage:"Compare responses from multiple AI models",id:"zz9eXmfAgf"}}),[K.BROWSER_AGENT]:Me({askInputPlaceholder:{defaultMessage:"Ask Comet to do anything",id:"7WovdByJIp"},name:{defaultMessage:"Control browser",id:"4SgYV+4mxC"},description:{defaultMessage:"Autonomously browse the web to complete tasks for you",id:"BfGiO2EJx4"}}),[K.ASI]:Me({askInputPlaceholder:{defaultMessage:"Gamma",id:"Wb9IyuuCJO"},name:{defaultMessage:"Gamma",id:"Wb9IyuuCJO"},description:{defaultMessage:"Gamma",id:"Wb9IyuuCJO"}})},ZX={[K.SEARCH]:V({defaultMessage:"Search",id:"xmcVZ0BU63"}),[K.RESEARCH]:V({defaultMessage:"Deep research",id:"gP4/7g8Ps1"}),[K.STUDIO]:V({defaultMessage:"Create files and apps",id:"DwoODHf+gf"}),[K.STUDY]:V({defaultMessage:"Learn step by step",id:"ecHuLjb6pR"}),[K.AGENTIC_RESEARCH]:V({defaultMessage:"Model council",id:"Vogw3sJFoa"}),[K.BROWSER_AGENT]:V({defaultMessage:"Control browser",id:"4SgYV+4mxC"}),[K.ASI]:V({defaultMessage:"Gamma",id:"Wb9IyuuCJO"})},Ia=e=>ZX[e],JX={[K.STUDIO]:V({defaultMessage:"Previously known as Labs",id:"31jGSOzHTh"})},Xw=e=>JX[e],dn={[te.DEFAULT]:Me({name:{defaultMessage:"Best",id:"PzlMqGwwkm"},description:{defaultMessage:"Adapts to each query",id:"SsTMNu/s/A"}}),[te.PRO]:Me({name:{defaultMessage:"Best",id:"PzlMqGwwkm"},description:{defaultMessage:"Automatically selects the best model based on the query",id:"3ZgFQznYO0"}}),[te.PPLX_PRO_UPGRADED]:Me({name:{defaultMessage:"Pro",id:"R/eOkjWqNU"},description:{defaultMessage:"Automatically selects the most responsive model based on the query",id:"DuOz+H05Us"}}),[te.SONAR]:Me({name:{defaultMessage:"Sonar",id:"sT9VX563o6"},description:{defaultMessage:"Perplexity's latest model",id:"ZBUx6ziNIY"}}),[te.GPT_4o]:Me({name:{defaultMessage:"GPT-4o",id:"nebbHBgxX/"},description:{defaultMessage:"OpenAI's versatile model",id:"zdAw82CyOA"}}),[te.GPT_4_1]:Me({name:{defaultMessage:"GPT-4.1",id:"+LPr/f6Fal"},description:{defaultMessage:"OpenAI's advanced model",id:"+uCLZVt7uh"}}),[Ne.GPT_5]:Me({name:{defaultMessage:"GPT-5",id:"VfhmdGpVc7"},description:{defaultMessage:"OpenAI's latest model",id:"5VYr+wSh/Y"}}),[te.GPT_5_1]:Me({name:{defaultMessage:"GPT-5.1",id:"uOMpo0agAL"},description:{defaultMessage:"OpenAI's latest model",id:"5VYr+wSh/Y"}}),[Ne.GPT_5_THINKING]:Me({name:{defaultMessage:"GPT-5 Thinking",id:"/IA3KV+qFr"},description:{defaultMessage:"OpenAI's latest model with thinking",id:"r+tIMgEnyZ"}}),[te.GPT_5_1_THINKING]:Me({name:{defaultMessage:"GPT-5.1 Thinking",id:"74//SO976H"},description:{defaultMessage:"OpenAI's latest model with thinking",id:"r+tIMgEnyZ"}}),[Ne.GPT5_PRO]:Me({name:{defaultMessage:"GPT-5 Pro",id:"GwvubEn/BR"},description:{defaultMessage:"OpenAI's latest, most powerful reasoning model",id:"3Z57hOWKDd"}}),[te.GPT_5_2]:Me({name:{defaultMessage:"GPT-5.2",id:"X26Ei/S8vd"},description:{defaultMessage:"OpenAI's latest model",id:"5VYr+wSh/Y"}}),[te.GPT_5_2_THINKING]:Me({name:{defaultMessage:"GPT-5.2 Thinking",id:"9NodtkoSox"},description:{defaultMessage:"OpenAI's latest model with thinking",id:"r+tIMgEnyZ"}}),[te.CLAUDE_2]:Me({name:{defaultMessage:"Claude Sonnet 4.0",id:"4UrgPEhdwq"},description:{defaultMessage:"Anthropic's advanced model",id:"b5CqfvLw4b"}}),[te.GEMINI_2_5_PRO]:Me({name:{defaultMessage:"Gemini 2.5 Pro",id:"hec4NYL1Ib"},description:{defaultMessage:"Google's latest model",id:"XBL8FigIeX"}}),[te.GEMINI_3_0_PRO]:Me({name:{defaultMessage:"Gemini 3 Pro",id:"UK0QXlryM2"},description:{defaultMessage:"Google's most advanced model",id:"fz0xqlVIaF"}}),[te.GEMINI_3_0_FLASH]:Me({name:{defaultMessage:"Gemini 3 Flash",id:"wBxtNZNdaJ"},description:{defaultMessage:"Google's fast model",id:"Vm1k26HpRd"}}),[te.GEMINI_3_0_FLASH_HIGH]:Me({name:{defaultMessage:"Gemini 3 Flash Thinking",id:"WGU4v3vcgP"},description:{defaultMessage:"Google's fast model",id:"Vm1k26HpRd"}}),[te.GROK]:Me({name:{defaultMessage:"Grok 3 Beta",id:"Ybq0GDRm0J"},description:{defaultMessage:"xAI's Grok 3 model",id:"gwIHPQy1c/"}}),[te.PPLX_REASONING]:Me({name:{defaultMessage:"Reasoning",id:"Aw3qRf7hyO"},description:{defaultMessage:"Advanced problem solving",id:"4J0akc6m53"}}),[te.CLAUDE_3_7_SONNET_THINKING]:Me({name:{defaultMessage:"Claude Sonnet 4.0 Thinking",id:"a3LiLxX42G"},description:{defaultMessage:"Anthropic's reasoning model",id:"vRfGVNHXG3"}}),[te.CLAUDE_4_0_OPUS]:Me({name:{defaultMessage:"Claude Opus 4.0",id:"fwViXd5wrs"},description:{defaultMessage:"Anthropic's Opus reasoning model",id:"e0FjrIe1O/"}}),[te.CLAUDE_4_0_OPUS_THINKING]:Me({name:{defaultMessage:"Claude Opus 4.0 Thinking",id:"hwrQNTIYLG"},description:{defaultMessage:"Anthropic's Opus reasoning model with thinking",id:"ipx+1wZCy6"}}),[te.CLAUDE_4_1_OPUS]:Me({name:{defaultMessage:"Claude Opus 4.1",id:"aq+8T//8S9"},description:{defaultMessage:"Anthropic's Opus reasoning model",id:"e0FjrIe1O/"}}),[te.CLAUDE_4_1_OPUS_THINKING]:Me({name:{defaultMessage:"Claude Opus 4.1 Thinking",id:"Vd2LxNSW/4"},description:{defaultMessage:"Anthropic's Opus reasoning model with thinking",id:"ipx+1wZCy6"}}),[te.CLAUDE_4_5_OPUS]:Me({name:{defaultMessage:"Claude Opus 4.5",id:"c8oGQdxIXE"},description:{defaultMessage:"Anthropic's most advanced model",id:"4l6C+Dcw8g"}}),[te.CLAUDE_4_5_OPUS_THINKING]:Me({name:{defaultMessage:"Claude Opus 4.5 Thinking",id:"oBSH9hOxZC"},description:{defaultMessage:"Anthropic's Opus reasoning model with thinking",id:"ipx+1wZCy6"}}),[te.CLAUDE_4_6_OPUS]:Me({name:{defaultMessage:"Claude Opus 4.6",id:"udBZy8mI67"},description:{defaultMessage:"Anthropic's latest model",id:"CBk3f58XFE"}}),[te.CLAUDE_4_6_OPUS_THINKING]:Me({name:{defaultMessage:"Claude Opus 4.6 Thinking",id:"kVfMSt+5AX"},description:{defaultMessage:"Anthropic's latest model with reasoning",id:"rMPiVZRId8"}}),[te.CLAUDE_4_5_SONNET]:Me({name:{defaultMessage:"Claude Sonnet 4.5",id:"TreRV15OSF"},description:{defaultMessage:"Anthropic's fast model",id:"zkLN9uB0Ho"}}),[te.CLAUDE_4_5_SONNET_THINKING]:Me({name:{defaultMessage:"Claude Sonnet 4.5 Thinking",id:"POJuSUD1gU"},description:{defaultMessage:"Anthropic's newest reasoning model",id:"MIjO2w9Cui"}}),[te.KIMI_K2_5_THINKING]:Me({name:{defaultMessage:"Kimi K2.5",id:"EoucZwIu5O"},description:{defaultMessage:"Moonshot AI's latest model",id:"/JWHGx0t9p"}}),[te.GROK_4]:Me({name:{defaultMessage:"Grok 4",id:"+Y775fAOqr"},description:{defaultMessage:"xAI's reasoning model",id:"tYRPjba3cL"}}),[te.GROK_4_NON_THINKING]:Me({name:{defaultMessage:"Grok 4",id:"+Y775fAOqr"},description:{defaultMessage:"xAI's advanced model",id:"av1iNKEP7e"}}),[te.GROK_4_1_REASONING]:Me({name:{defaultMessage:"Grok 4.1",id:"gWMQFuyUxZ"},description:{defaultMessage:"xAI's latest model",id:"e2CghRZC7d"}}),[te.GROK_4_1_NON_REASONING]:Me({name:{defaultMessage:"Grok 4.1",id:"gWMQFuyUxZ"},description:{defaultMessage:"xAI's latest model",id:"e2CghRZC7d"}}),[Ne.O3_PRO]:Me({name:{defaultMessage:"o3-pro",id:"lyV2e5kFYG"},description:{defaultMessage:"OpenAI's powerful reasoning model",id:"BodLv+J6l0"}}),[te.O4_MINI]:Me({name:{defaultMessage:"o4-mini",id:"BwwjXFHgz7"},description:{defaultMessage:"OpenAI's latest reasoning model",id:"VKonAfIZbf"}}),[te.PPLX_SONAR_INTERNAL_TESTING]:Me({name:{defaultMessage:"Sonar Testing - Alpha",id:"2oa4bWRfNL"},description:{defaultMessage:"Sonar model alpha variant",id:"EvwN/e7vAD"}}),[te.PPLX_SONAR_INTERNAL_TESTING_V2]:Me({name:{defaultMessage:"Sonar Testing - Beta",id:"VNsK+ZGei/"},description:{defaultMessage:"Sonar model beta variant",id:"Dzfl36DNyM"}}),[te.ALPHA]:Me({name:{defaultMessage:"Deep research",id:"gP4/7g8Ps1"},description:{defaultMessage:"Fast and thorough for routine research",id:"v/MuahlVJE"}}),[te.BETA]:Me({name:{defaultMessage:"Create files and apps",id:"DwoODHf+gf"},description:{defaultMessage:"Multi-step tasks with advanced troubleshooting",id:"Sf0AeuilA5"}}),[te.STUDY]:Me({name:{defaultMessage:"Study",id:"UTFsoN8Z1P"},description:{defaultMessage:"Fast model for routine research",id:"prWIV9FsWt"}}),[te.AGENTIC_RESEARCH]:Me({name:{defaultMessage:"Model council",id:"Vogw3sJFoa"},description:{defaultMessage:"Compare responses from multiple AI models",id:"zz9eXmfAgf"}}),[te.BROWSER_AGENT]:Me({name:{defaultMessage:"Control browser",id:"4SgYV+4mxC"},description:{defaultMessage:"Performs actions in your browser",id:"0SUwifmsoZ"}}),[te.BROWSER_AGENT_SONNET]:Me({name:{defaultMessage:"Claude Sonnet 4.5",id:"TreRV15OSF"},description:{defaultMessage:"Browser agent powered by Claude 4.5 Sonnet",id:"KNJWQkoPNo"}}),[te.BROWSER_AGENT_OPUS]:Me({name:{defaultMessage:"Claude Opus 4.6",id:"udBZy8mI67"},description:{defaultMessage:"Browser agent powered by Claude 4.6 Opus",id:"fW3OB8Q9e8"}}),[te.ASI]:Me({name:{defaultMessage:"ASI",id:"fATkWrA7fQ"},description:{defaultMessage:"Gamma",id:"Wb9IyuuCJO"}}),[Ne.O3_MINI]:Me({name:{defaultMessage:"o3-mini",id:"GdJwPgWWId"},description:{defaultMessage:"OpenAI's reasoning model",id:"V9t5CKw8kf"}}),[Ne.GROK2]:Me({name:{defaultMessage:"Grok-2",id:"9X3jPx+0vk"},description:{defaultMessage:"xAI's latest model",id:"e2CghRZC7d"}}),[Ne.GPT_4]:Me({name:{defaultMessage:"GPT-4",id:"6TGiMlP7f4"},description:{defaultMessage:"OpenAI's previous generation model",id:"U3OQoJ211e"}}),[Ne.CLAUDE_3_OPUS]:Me({name:{defaultMessage:"Claude 3 Opus",id:"gLSCHWGsu1"},description:{defaultMessage:"Anthropic's previous generation model",id:"hAevdn8yGl"}}),[Ne.CLAUDE_3_5_HAIKU]:Me({name:{defaultMessage:"Claude 3.5 Haiku",id:"zEJWYa05R2"},description:{defaultMessage:"Anthropic's smaller model",id:"pQia6E7J8i"}}),[Ne.GEMINI]:Me({name:{defaultMessage:"Gemini",id:"XoqZkcqFZ/"},description:{defaultMessage:"Previous version of Google's Gemini model",id:"9C0LtRWLFh"}}),[Ne.LLAMA_X_LARGE]:Me({name:{defaultMessage:"Llama X Large",id:"2zxgnSWUyX"},description:{defaultMessage:"Meta's large Llama model",id:"+95UnVOxgQ"}}),[Ne.MISTRAL]:Me({name:{defaultMessage:"Mistral",id:"dUBSpMbbs4"},description:{defaultMessage:"Mistral AI model",id:"rYRyt8I2Zr"}}),[Ne.COPILOT]:Me({name:{defaultMessage:"Copilot",id:"b3QbnXgawD"},description:{defaultMessage:"Legacy Pro Search",id:"pg83InaW1o"}}),[Ne.CLAUDE_OMBRE_EAP]:Me({name:{defaultMessage:"Claude Ombre",id:"F12IlTx8R1"},description:{defaultMessage:"Anthropic's research preview",id:"LKt7UBXwdw"}}),[Ne.CLAUDE_LACE_EAP]:Me({name:{defaultMessage:"Claude Lace",id:"8ydOdGYWef"},description:{defaultMessage:"Anthropic's opus research preview",id:"GHW8xWfe9i"}}),[Ne.R1]:Me({name:{defaultMessage:"R1 1776",id:"e8N3MYqmIQ"},description:{defaultMessage:"Perplexity's unbiased reasoning model",id:"R5Tg1hC1um"}}),[Ne.GAMMA]:Me({name:{defaultMessage:"Gamma",id:"Wb9IyuuCJO"},description:{defaultMessage:"Fast model for routine research",id:"prWIV9FsWt"}}),[Ne.O3]:Me({name:{defaultMessage:"o3",id:"BBaBURoUEg"},description:{defaultMessage:"OpenAI's reasoning model",id:"V9t5CKw8kf"}}),[Ne.GEMINI_2_FLASH]:Me({name:{defaultMessage:"Gemini 2.5 Pro",id:"hec4NYL1Ib"},description:{defaultMessage:"Google's latest model",id:"XBL8FigIeX"}}),[Ne.TESTING_MODEL_C]:Me({name:{defaultMessage:"Testing Model C",id:"sgSu9ApFvP"},description:{defaultMessage:"Debug model for testing",id:"AG6p6ERvyn"}}),[Ne.O3_RESEARCH]:Me({name:{defaultMessage:"o3",id:"BBaBURoUEg"},description:{defaultMessage:"OpenAI's reasoning model",id:"V9t5CKw8kf"}}),[Ne.O3_PRO_RESEARCH]:Me({name:{defaultMessage:"o3-pro",id:"lyV2e5kFYG"},description:{defaultMessage:"OpenAI's most powerful reasoning model",id:"1ntkiZj5rM"}}),[Ne.CLAUDE40SONNET_RESEARCH]:Me({name:{defaultMessage:"Claude Sonnet 4.0",id:"4UrgPEhdwq"},description:{defaultMessage:"Anthropic's advanced model",id:"b5CqfvLw4b"}}),[Ne.CLAUDE40SONNETTHINKING_RESEARCH]:Me({name:{defaultMessage:"Claude Sonnet 4.0 Thinking",id:"a3LiLxX42G"},description:{defaultMessage:"Anthropic's reasoning model",id:"vRfGVNHXG3"}}),[Ne.CLAUDE40OPUS_RESEARCH]:Me({name:{defaultMessage:"Claude Opus 4.0",id:"fwViXd5wrs"},description:{defaultMessage:"Anthropic's most advanced model",id:"4l6C+Dcw8g"}}),[Ne.CLAUDE40OPUSTHINKING_RESEARCH]:Me({name:{defaultMessage:"Claude Opus 4.0 Thinking",id:"hwrQNTIYLG"},description:{defaultMessage:"Anthropic's advanced reasoning model",id:"RwUx0WhdZb"}}),[Ne.O3_LABS]:Me({name:{defaultMessage:"o3",id:"BBaBURoUEg"},description:{defaultMessage:"OpenAI's reasoning model",id:"V9t5CKw8kf"}}),[Ne.O3_PRO_LABS]:Me({name:{defaultMessage:"o3-pro",id:"lyV2e5kFYG"},description:{defaultMessage:"OpenAI's most powerful reasoning model",id:"1ntkiZj5rM"}}),[Ne.CLAUDE40SONNETTHINKING_LABS]:Me({name:{defaultMessage:"Claude Sonnet 4.0 Thinking",id:"a3LiLxX42G"},description:{defaultMessage:"Anthropic's reasoning model",id:"vRfGVNHXG3"}}),[Ne.CLAUDE40OPUSTHINKING_LABS]:Me({name:{defaultMessage:"Claude Opus 4.0 Thinking",id:"hwrQNTIYLG"},description:{defaultMessage:"Anthropic's advanced reasoning model",id:"RwUx0WhdZb"}}),[Ne.KIMI_K2_THINKING]:Me({name:{defaultMessage:"Kimi K2",id:"3S9KJaXDPI"},description:{defaultMessage:"Moonshot AI's latest model",id:"/JWHGx0t9p"}})},Ok=[{label:dn[te.SONAR].name,description:dn[te.SONAR].description,nonReasoningModel:te.SONAR,reasoningModel:null,hasNewTag:!1,subscriptionTier:zn.PRO},{label:dn[te.BROWSER_AGENT_SONNET].name,description:dn[te.BROWSER_AGENT_SONNET].description,nonReasoningModel:te.BROWSER_AGENT_SONNET,reasoningModel:null,hasNewTag:!1,subscriptionTier:zn.PRO,hideInPaywall:!0},{label:dn[te.BROWSER_AGENT_OPUS].name,description:dn[te.BROWSER_AGENT_OPUS].description,nonReasoningModel:te.BROWSER_AGENT_OPUS,reasoningModel:null,hasNewTag:!1,subscriptionTier:zn.MAX,hideInPaywall:!0},{label:dn[te.GEMINI_3_0_FLASH].name,description:dn[te.GEMINI_3_0_FLASH].description,nonReasoningModel:te.GEMINI_3_0_FLASH,reasoningModel:te.GEMINI_3_0_FLASH_HIGH,hasNewTag:!1,subscriptionTier:zn.PRO},{label:dn[te.GEMINI_3_0_PRO].name,description:dn[te.GEMINI_3_0_PRO].description,nonReasoningModel:null,reasoningModel:te.GEMINI_3_0_PRO,hasNewTag:!1,subscriptionTier:zn.PRO},{label:dn[te.GPT_5_2].name,description:dn[te.GPT_5_2].description,nonReasoningModel:te.GPT_5_2,reasoningModel:te.GPT_5_2_THINKING,hasNewTag:!1,subscriptionTier:zn.PRO},{label:dn[te.CLAUDE_4_5_SONNET].name,description:dn[te.CLAUDE_4_5_SONNET].description,nonReasoningModel:te.CLAUDE_4_5_SONNET,reasoningModel:te.CLAUDE_4_5_SONNET_THINKING,hasNewTag:!1,subscriptionTier:zn.PRO},{label:dn[te.CLAUDE_4_5_OPUS].name,description:dn[te.CLAUDE_4_5_OPUS].description,nonReasoningModel:te.CLAUDE_4_5_OPUS,reasoningModel:te.CLAUDE_4_5_OPUS_THINKING,hasNewTag:!1,subscriptionTier:zn.MAX},{label:dn[te.GROK_4_1_NON_REASONING].name,description:dn[te.GROK_4_1_NON_REASONING].description,nonReasoningModel:te.GROK_4_1_NON_REASONING,reasoningModel:te.GROK_4_1_REASONING,hasNewTag:!1,subscriptionTier:zn.PRO},{label:dn[te.KIMI_K2_5_THINKING].name,description:dn[te.KIMI_K2_5_THINKING].description,nonReasoningModel:null,reasoningModel:te.KIMI_K2_5_THINKING,hasNewTag:!0,subscriptionTier:zn.PRO,subheading:V({defaultMessage:"Hosted in the US",id:"5F33MSbZ40"})}],eZ={label:dn[te.CLAUDE_4_6_OPUS].name,description:dn[te.CLAUDE_4_6_OPUS].description,nonReasoningModel:te.CLAUDE_4_6_OPUS,reasoningModel:te.CLAUDE_4_6_OPUS_THINKING,hasNewTag:!0,subscriptionTier:zn.MAX},tZ=e=>e.reduce((t,n)=>(n.nonReasoningModel&&(t[n.nonReasoningModel]=n),n.reasoningModel&&(t[n.reasoningModel]=n),t),{}),Wf=()=>{const{variation:e}=zR(!1),t=f.useMemo(()=>e?Ok.map(s=>s.reasoningModel===te.CLAUDE_4_5_OPUS_THINKING?eZ:s):Ok,[e]),n=f.useMemo(()=>tZ(t),[t]),r=f.useCallback(s=>n[s],[n]);return f.useMemo(()=>({models:t,getModelConfig:r}),[t,r])},nZ=(e,t,n)=>{const{value:r,loading:s}=BC({flag:"remove-reasoning-model-selection",defaultValue:e,extraAttributes:t,subjectType:"user_nextauth_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},rZ=()=>{const{variation:e,loading:t}=nZ(0);return f.useMemo(()=>({hours:e,loading:t,enabled:e>0}),[e,t])};function sZ(e){try{const t=new Date(e);return isNaN(t.getTime())?null:t}catch{return null}}function aZ({getPreferredSearchModelUpdatedAt:e,setPreferredSearchModelUpdatedAt:t}){const{hours:n,loading:r,enabled:s}=rZ();return f.useMemo(()=>{const a=e();if(r||!s)return{shouldAutoDisableReasoning:!1};if(!a)return{shouldAutoDisableReasoning:!1};const o=sZ(a);return o?{shouldAutoDisableReasoning:(new Date().getTime()-o.getTime())/(1e3*60*60)>=n}:(t(new Date().toISOString()),{shouldAutoDisableReasoning:!1})},[n,r,s,e,t])}const oZ=(e=!1,t,n)=>{const{value:r,loading:s}=Lt({flag:"search-model-menu-rewrite",defaultValue:e,extraAttributes:t,subjectType:"visitor_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},iZ="search-model-menu-redesign-enabled",Pl=()=>{const[e,t]=vs(iZ,!1),{variation:n,loading:r}=oZ(!1);return f.useEffect(()=>{r||t(n)},[n,r,t]),{isSearchModelMenuRewriteEnabled:e}},lZ="v1",cZ={models:{[te.SONAR]:{label:"Sonar",description:"Perplexity's latest model",mode:"search"},[te.BROWSER_AGENT_SONNET]:{label:"Claude Sonnet 4.5",description:"Anthropic's fast model",mode:"browser_agent"},[te.BROWSER_AGENT_OPUS]:{label:"Claude Opus 4.6",description:"Anthropic's most advanced model",mode:"browser_agent"},[te.ASI]:{label:"Agent",description:"Agent",mode:"asi"}},config:[{label:"Sonar",description:"Perplexity's fast model",non_reasoning_model:te.SONAR,reasoning_model:null,has_new_tag:!1,subscription_tier:zn.PRO,text_only_model:!1},{label:"Claude Sonnet 4.5",description:"Anthropic's fast model",non_reasoning_model:te.BROWSER_AGENT_SONNET,reasoning_model:null,has_new_tag:!1,subscription_tier:zn.PRO,text_only_model:!1},{label:"Claude Opus 4.6",description:"Anthropic's most advanced model",non_reasoning_model:te.BROWSER_AGENT_OPUS,reasoning_model:null,has_new_tag:!1,subscription_tier:zn.MAX,text_only_model:!1}],default_models:{search:"turbo",research:"pplx_alpha",studio:"pplx_beta",study:"pplx_study",agentic_research:"pplx_agentic_research",browser_agent:te.BROWSER_AGENT_SONNET,asi:"pplx_asi"}},YR=({config:e,models:t,default_models:n})=>{const r=e.reduce((m,p)=>(p.non_reasoning_model&&m.set(p.non_reasoning_model,p),p.reasoning_model&&m.set(p.reasoning_model,p),m),new Map),s=m=>r.get(m),a=m=>t[m]?.label,o=m=>t[m]?.description,i=m=>s(m)?.subheading??void 0,c=m=>{const p=t[m]?.mode;if(Ww(p))return p},u=m=>n[m];function d(m){return typeof m=="string"&&m in t}return{config_schema:"v1",models:t,config:e,default_models:n,getModelConfig:s,getModelLabel:a,getModelDescription:o,getModelSubheading:i,getModelMode:c,getDefaultModelForMode:u,isSearchModel:d}},uZ=()=>Se.makeQueryKey("/rest/models/config"),dZ=async({reason:e})=>{const{error:t,data:n,response:r}=await ve.GET("/rest/models/config",e,{params:{query:{config_schema:lZ}},timeoutMs:Ct(),numRetries:wi});if(t)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to fetch models",cause:t,status:r.status??0});const s=YR(n);return{...n,...s}},fZ=YR(cZ),ki=({reason:e,enabled:t})=>{const{isSearchModelMenuRewriteEnabled:n}=Pl(),r=gt({queryFn:()=>dZ({reason:e}),queryKey:uZ(),enabled:t??n}),s=r.data??fZ;return f.useMemo(()=>({query:r,...s}),[r,s])},mZ=async({profileName:e,reason:t})=>{try{const{error:n,data:r,response:s}=await ve.GET("/rest/auth/get_special_profile",t,{params:{query:{profile_name:e}},timeoutMs:1500,numRetries:1});if(n||!r)throw new Ue("API_CLIENTS_ERROR",{message:`Failed to get special profile ${e}`,cause:n,status:s.status??0});return{unlimitedProSearch:!!r.unlimited_pro_search,maxModelSelection:!!r.max_model_selection,unlimitedResearch:!!r.unlimited_research,fileUpload:!!r.file_upload}}catch(n){return Z.error(n),{unlimitedProSearch:!1,maxModelSelection:!1,unlimitedResearch:!1,fileUpload:!1}}};function pZ(e,t){return gt({enabled:!!e,queryKey:EQ(e),queryFn:async()=>mZ({profileName:e,reason:t})})}const hZ=async({reason:e})=>{const{error:t,data:n,response:r}=await ve.GET("/rest/user/info",e,{timeoutMs:1500,numRetries:wi});if(t||!n)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to get user info",cause:t,status:r.status??0});return{isEnterprise:n.is_enterprise,isGov:n.is_gov,isStudent:n.is_student,hasNonPublicEmail:n.has_non_public_email}},QR=["user-info"],Lk={isEnterprise:!1,isGov:!1,isStudent:!1,hasNonPublicEmail:!1},Zw=({enabled:e,reason:t})=>{const n=gt({enabled:e??!0,queryKey:QR,queryFn:async()=>hZ({reason:t}),placeholderData:Lk}),r=n.data??Lk;return f.useMemo(()=>({query:n,...r}),[n,r])};function gr(){const{query:e}=Zw({enabled:!0,reason:"user-capabilities"}),t=e.data?.isGov,n=t?"us_government_or_military":"",{data:r}=pZ(n,"user-capabilities");return f.useMemo(()=>{const a={unlimitedProSearch:!!r?.unlimitedProSearch,maxModelSelection:!!r?.maxModelSelection,unlimitedResearch:!!r?.unlimitedResearch,fileUpload:!!r?.fileUpload};return{isGovernmentRequestOrigin:t,specialCapabilities:a}},[t,r])}const gZ=async({reason:e})=>{const{error:t,data:n}=await ve.GET("/rest/rate-limit/status",e);if(t||!n)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to get rate limit statuses",cause:t,status:0});return n},Fk={available:!1,remaining_detail:{kind:"exact",remaining:0}},XR=({enabled:e=!0,reason:t,refetchOnMount:n="always"})=>{const r=wt(),{data:s,isSuccess:a,isFetching:o}=gt({enabled:r&&e,queryKey:wR(),queryFn:()=>gZ({reason:t}),refetchOnMount:n}),i=a&&!o&&!!s,c=f.useCallback(u=>{try{return s?.modes[u]??Fk}catch(d){return Z.warn("[useRateLimitsQuery] Failed to get mode rate limit",{loaded:i,mode:u,error:d}),Fk}},[s,i]);return f.useMemo(()=>({loaded:i,getModeRateLimit:c}),[i,c])},Vs=()=>{const{isSearchModelMenuRewriteEnabled:e}=Pl(),{getModeRateLimit:t}=XR({reason:"use_default_search_model"}),{getDefaultModelForMode:n}=ki({reason:"use_default_search_model"}),{specialCapabilities:r}=gr(),{hasAccessToProFeatures:s}=Mt(),a=f.useMemo(()=>{const{available:o}=t("pro_search");return o},[t]);return f.useMemo(()=>e?n(K.SEARCH):r.unlimitedProSearch||a&&s?"pplx_pro":"turbo",[e,n,a,s,r.unlimitedProSearch])},yr=()=>{const{isSearchModelMenuRewriteEnabled:e}=Pl(),{getModelMode:t}=ki({reason:"use_search_mode_for_search_model"});return f.useCallback((n,r=K.SEARCH)=>e?n?t(n)??r:r:Yw(n,r),[t,e])},yZ=()=>{const e="use-is-search-model",{isSearchModelMenuRewriteEnabled:t}=Pl(),{isSearchModel:n}=ki({reason:e,enabled:t});return f.useCallback(r=>t?n(r):QX(r),[n,t])},ZR="pplx.local-user-settings.";function ml(e,t){return vs(`${ZR}${e}`,t)}const xZ=1;function Ol(){const e=yZ(),[t,n]=ml("preferredSearchModelUpdatedAt",void 0),[r,s,a]=ml(`preferredSearchModels-v${xZ}`,Iq),[o,i]=f.useState(r),c=f.useCallback(m=>{s(m),i(m)},[s]),u=f.useRef(!0),d=f.useCallback((m,p)=>{c(h=>{const g={...h};return p?g[m]=p:m&&delete g[m],g})},[c]);return f.useEffect(()=>{if(u.current){u.current=!1;return}n(new Date().toISOString())},[o.search,n]),f.useEffect(()=>{function m(){if(document.visibilityState!=="visible")return;const p=a();i(h=>{let g=!1;const y={...h};for(const[b,x]of Object.entries(p)){const _=b,v=h[_];e(x)&&x!==v&&(y[_]=x,g=!0)}return g?y:h})}return document.addEventListener("visibilitychange",m),()=>{document.removeEventListener("visibilitychange",m)}},[e,i,a]),f.useMemo(()=>({preferredSearchModels:o,preferredSearchModelUpdatedAt:t,setPreferredSearchModel:d,setPreferredSearchModelUpdatedAt:n}),[o,t,d,n])}const bZ=["presentpicker"],JR=e=>e?bZ.includes(e):!1;function _Z(e){const t=nn(),n=wt(),{hasAccessToProFeatures:r}=Mt(),{session:s}=je(),{trackEvent:a}=Ze(s),{preferredSearchModels:o,preferredSearchModelUpdatedAt:i,setPreferredSearchModel:c,setPreferredSearchModelUpdatedAt:u}=Ol(),d=Vs(),{getModelConfig:m}=Wf(),p=t?.get("copilot"),h=t?.get("pro"),g=t?.get("utm_source"),y=p==="false"||h==="false",b=!y&&(p==="true"||h==="true"||JR(g??void 0)),x=o[K.SEARCH],_=yr();f.useEffect(()=>{x&&(_(x)!==K.SEARCH?(pi.warn(`Resetting preferred search model from ${x} to ${te.PRO}`),o[K.SEARCH]=te.PRO,c(K.SEARCH,te.PRO)):x===te.DEFAULT&&r&&c(K.SEARCH,void 0))},[r,x,o,c,_]);const v=f.useCallback(()=>i,[i]),{shouldAutoDisableReasoning:C}=aZ({getPreferredSearchModelUpdatedAt:v,setPreferredSearchModelUpdatedAt:u});f.useEffect(()=>{if(!C||!x)return;const T=m(x);T&&T.nonReasoningModel&&T.reasoningModel===x&&c(K.SEARCH,T.nonReasoningModel)},[C,c,m,x]);const w=t?.get("model_id")==="pplx_alpha"?null:t?.get("model_id");let S;w&&(w==="deep_research"?S=te.ALPHA:Object.values(te).includes(w)&&(S=w));let E;return y?E=te.DEFAULT:S?E=S:b&&(E=te.PRO),E&&S&&S==E&&a("search mode utm",{mode:_(E)}),f.useMemo(()=>{let T=te.DEFAULT;return n?E||(T=o[K.SEARCH]??d,T):T},[n,E,o,d])}function op(e){return{available:e>0,exactCount:e}}function ip(e){return{available:e.available,exactCount:e.remaining_detail.kind==="exact"?e.remaining_detail.remaining:void 0}}const eD={sources:["web"],gpt4Limit:{available:!1,exactCount:0},pplxAlphaLimit:{available:!1,exactCount:0},pplxBetaLimit:{available:!1,exactCount:0},agenticResearchLimit:{available:!1,exactCount:0},modelSpecificLimits:{},uploadRateLimit:void 0,createLimit:0,setConfiguredModel(){},setSources:()=>{},decrementCreateLimit:()=>{},setModelSpecificLimits:()=>{},setUploadRateLimit:()=>{},configuredModel:te.DEFAULT,compareModels:[],setCompareModels(){},exhaustedSearchMode:void 0,setExhaustedSearchMode(){}},tD=Bt("ThreadConfigContext",eD),vZ=({children:e,shouldFetchSettings:t})=>{const r=ga({enabled:t,reason:"thread-settings-provider"}),{isMax:s}=Mt(),{getModeRateLimit:a,loaded:o}=XR({enabled:t,reason:"thread_settings_provider_mount"}),i=_Z(),c=f.useMemo(()=>({proLimit:ip(a("pro_search")),researchLimit:ip(a("research")),labsLimit:ip(a("labs")),agenticResearchLimit:ip(a("agentic_research")),modelSpecificLimits:{}}),[a]),u=yr(),[d,m]=f.useState({...eD,gpt4Limit:op(c.proLimit.exactCount??0),pplxAlphaLimit:op(c.researchLimit.exactCount??0),pplxBetaLimit:op(c.labsLimit.exactCount??0),agenticResearchLimit:op(c.agenticResearchLimit.exactCount??0),modelSpecificLimits:c.modelSpecificLimits??{},configuredModel:i,compareModels:[],exhaustedSearchMode:void 0}),p=f.useRef(!1);f.useEffect(()=>{if(p.current){p.current=!1;return}m(E=>E.configuredModel===i?E:{...E,configuredModel:i})},[i]);const h=f.useCallback(E=>(p.current=!0,m(T=>({...T,configuredModel:E}))),[]),g=f.useCallback(E=>{m(T=>({...T,sources:E}))},[]),y=f.useCallback(E=>{const T=E.slice(0,B2);m(k=>({...k,compareModels:T}))},[]),b=f.useCallback(E=>{m(T=>({...T,exhaustedSearchMode:E}))},[]);f.useEffect(()=>{r.createLimit!==null&&m(E=>({...E,createLimit:r.createLimit}))},[r.createLimit]),f.useEffect(()=>{r.uploadLimit!==null&&r.uploadLimit!==void 0&&m(E=>({...E,uploadRateLimit:r.uploadLimit}))},[r.uploadLimit]),f.useEffect(()=>{c&&m(E=>({...E,gpt4Limit:c.proLimit,pplxAlphaLimit:c.researchLimit,pplxBetaLimit:c.labsLimit,agenticResearchLimit:c.agenticResearchLimit,modelSpecificLimits:c.modelSpecificLimits}))},[c,d.gpt4Limit.available,d.pplxAlphaLimit.available,d.pplxBetaLimit.available,d.agenticResearchLimit.available]);const x=f.useCallback(()=>{h(te.DEFAULT)},[h]),_=f.useRef(d.configuredModel);_.current=d.configuredModel,f.useEffect(()=>{if(!o||!c)return;const E=c.proLimit.available,T=c.researchLimit.available,k=c.labsLimit.available,M=c.agenticResearchLimit.available,N=_.current,P=u(N),O=P===K.RESEARCH&&!T&&!s,L=P===K.STUDIO&&!k&&!s,H=P===K.AGENTIC_RESEARCH&&!M;O?b(K.RESEARCH):L&&b(K.STUDIO),(![te.DEFAULT,te.STUDY].includes(N)&&!E||O||L||H)&&x()},[c,x,o,s,u,b]);const v=f.useCallback(()=>{const E=Math.max(d.createLimit-1,0);m(T=>({...T,createLimit:E}))},[d.createLimit]),C=f.useCallback((E=1)=>{if(d.uploadRateLimit==null)return;const T=Math.max(d.uploadRateLimit-E,0);m(k=>({...k,uploadRateLimit:T}))},[d.uploadRateLimit]),S={...d,setConfiguredModel:h,setSources:g,decrementCreateLimit:v,setUploadRateLimit:C,setModelSpecificLimits:E=>{m(T=>({...T,modelSpecificLimits:E}))},compareModels:d.compareModels,setCompareModels:y,exhaustedSearchMode:d.exhaustedSearchMode,setExhaustedSearchMode:b};return l.jsx(tD.Provider,{value:S,children:e})},En=()=>{const e=f.useContext(tD);if(!e)throw new Error("useThreadConfig must be used within ThreadSettingsContext");return e};function ns(){const{configuredModel:e}=En(),t=yr();return f.useMemo(()=>e===te.DEFAULT?K.SEARCH:t(e),[e,t])}var qr;(function(e){e.EXPOSURE="sbs exposure",e.JUDGMENT="sbs judgment",e.BANNER="sbs banner"})(qr||(qr={}));const Uh=-1,CZ="sbs_analytics_",wZ=e=>{const t=e?.experiment_override;return t?JSON.stringify(t):""},SZ=(e,t)=>{const n=e.side_by_side_metadata;return{displayPosition:t,experimentRole:n?.experiment_role||`entry_${t}`,entryUUID:e.backend_uuid,experimentOverride:wZ(n)}},nD=(e,t)=>`${CZ}${e}_${t}`,Bx=(e,t)=>{try{const n=nD(e,t);return yt.getItem(n)==="true"}catch(n){return Z.error("Error checking localStorage for SBS event:",n),!1}},Hx=(e,t)=>{try{const n=nD(e,t);yt.setItem(n,"true")}catch(n){Z.error("Error setting localStorage for SBS event:",n)}},ZKe=({results:e,session:t,trackEvent:n})=>{const r=f.useCallback(()=>{if(!e[0])return null;const c=e[0].side_by_side_metadata;if(!c?.sibling_uuid)return null;const u=c.experiment_override,d=u&&Object.keys(u)[0]||"";return{evaluationUUID:c.sibling_uuid,experimentVariationKey:d,evaluatorID:t?.user?.id||t?.user?.email||"anonymous"}},[e,t?.user?.id,t?.user?.email]),s=f.useCallback(c=>{try{const u=r();if(!u)return null;let d,m;if(c===Uh)d=Uh,m=void 0;else if(d=c,d>=0&&d<e.length)m=e[d]?.backend_uuid;else return Z.warn(`Invalid SBS selection index: ${c}, results length: ${e.length}`),null;const p={};return e.forEach(h=>{h.backend_uuid&&h.side_by_side_metadata?.execution_log&&(p[h.backend_uuid]=h.side_by_side_metadata.execution_log)}),{eventType:qr.JUDGMENT,timestampMs:Date.now(),eventData:{evaluationUUID:u.evaluationUUID,evaluatorID:u.evaluatorID,experimentVariationKey:u.experimentVariationKey,experimentRoles:e.map(h=>h.side_by_side_metadata?.experiment_role||`entry_${e.indexOf(h)}`),preferredPosition:d,entryUUID:m,executionLogs:p}}}catch(u){return Z.error("Failed to build SBS judgment payload:",u),null}},[r,e]),a=f.useCallback(c=>{try{const u=r();if(!u||Bx(u.evaluationUUID,qr.JUDGMENT))return;const d=s(c);d&&(n(qr.JUDGMENT,d),Hx(u.evaluationUUID,qr.JUDGMENT))}catch(u){Z.error("Failed to track SBS judgment:",u)}},[r,s,n]),o=f.useCallback(()=>{try{const c=r();if(!c||Bx(c.evaluationUUID,qr.BANNER))return;const u={eventType:qr.BANNER,timestampMs:Date.now(),eventData:{evaluationUUID:c.evaluationUUID,evaluatorID:c.evaluatorID,experimentVariationKey:c.experimentVariationKey,experimentRoles:e.map(d=>d.side_by_side_metadata?.experiment_role||`entry_${e.indexOf(d)}`)}};n(qr.BANNER,u),Hx(c.evaluationUUID,qr.BANNER)}catch(c){Z.error("Failed to track SBS banner exposure:",c)}},[r,e,n]),i=f.useCallback(()=>{try{const c=r();if(!c||Bx(c.evaluationUUID,qr.EXPOSURE))return;const u={eventType:qr.EXPOSURE,timestampMs:Date.now(),eventData:{evaluationUUID:c.evaluationUUID,evaluatorID:c.evaluatorID,experimentVariationKey:c.experimentVariationKey,entries:e.map(SZ)}};n(qr.EXPOSURE,u),Hx(c.evaluationUUID,qr.EXPOSURE)}catch(c){Z.error("Failed to track SBS exposure:",c)}},[r,e,n]);return f.useMemo(()=>({trackJudgment:a,trackBannerExposure:o,trackSBSExposure:i}),[a,o,i])},EZ=async({entryUUID:e,params:t,siblingUUID:n,reason:r})=>{const{error:s,response:a}=await ve.POST("/rest/entry/set-entry-selection/{entry_uuid}",r,{params:{path:{entry_uuid:e}},body:{selection_status:t,sibling_uuid:n},timeoutMs:Ct({productionMs:5e3}),numRetries:1});if(s)throw new Ue("API_CLIENTS_ERROR",{cause:s,status:a.status??0})};var Uk;(function(e){e.SAVE_PROFILE="save_profile",e.DELETE_PROFILE="delete_profile",e.TOGGLE_DISABLED="toggle_disabled"})(Uk||(Uk={}));const rD={has_profile:!1,disabled:!1,bio:"",occupation:"",location:"",response_language:"",location_lng:"",location_lat:"",use_memory:!1,use_search_history:!1,language:"",answer_styling_preferences:null},kZ=async({headers:e,reason:t})=>{try{const{error:n,data:r,response:s}=await ve.GET("/rest/user/get_user_ai_profile",t,{timeoutMs:1500,numRetries:wi,headers:e});if(n||!r)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to get user profile",cause:n,status:s.status??0});return r}catch(n){return Z.error(n),rD}},MZ=({enabled:e,reason:t})=>{const{locale:n}=Q(),r=n?{"accept-language":n}:{},s=async()=>kZ({headers:r,reason:t}),a=wt(),{data:o}=gt({enabled:a?typeof e>"u"?!0:e:!1,queryKey:SQ(),queryFn:s});return o??rD};function TZ(){const{session:e}=je(),{trackEvent:t}=Ze(e),{locale:n}=Q(),[r,s]=f.useState(Rx.includes(n)?n:VW),a=VY();return a?Rx.includes(a)?r!==a&&s(a):GY():r!==n&&Rx.includes(n)&&s(n),f.useMemo(()=>({locale:r,hasChosenLocale:!!a,saveLocale(o){s(o),HY(o),t("set locale cookie",{locale:o})}}),[r,a,t])}const sD=e=>[...e].sort((t,n)=>t.backend_uuid.localeCompare(n.backend_uuid,void 0,{sensitivity:"base"})),d0=e=>{if(!e.length)return[];const t=new Map;return e.forEach(n=>{if(n.side_by_side_metadata?.sibling_uuid&&n.side_by_side_metadata?.selection_status==="UNSELECTED")return;const r=n.side_by_side_metadata?.sibling_uuid??n.backend_uuid;t.has(r)||t.set(r,[]),t.get(r).push(n)}),[...t.values()].map(n=>{const r=sD(n);return r[0]?.side_by_side_metadata?.selection_status==="TIE"?[r[0]]:r})},AZ="side-by-side-experiments";function NZ(e,t={}){const{value:n,loading:r,error:s}=V$({flag:AZ,defaultValue:{side_by_side_config:{}},subjectType:"context_uuid",extraAttributes:t},e);return f.useMemo(()=>({sideBySideOverrides:n,loading:r,error:s}),[n,r,s])}const aD="sbs_trigger_count",oD="sbs_config",H2="[control]",RZ=e=>e?.startsWith(H2)??!1,DZ=[],IZ={isEnabled:!1,sbsVariations:DZ,isLoading:!1,error:null,incrementTriggerCount:()=>{},triggerCount:0},jZ="sbsMaxTriggerCntPerThread";function PZ(e,t,n,r,s,a,o,i,c,u){const{isPro:d,isMax:m,hasAccessToProFeatures:p}=e,{isEnterprise:h=!1}=t,g=d||m||h||p,y=d||m||p,b=s?.localeObj?.language||n?.language||null,x=r?.toLowerCase()||null,_=h?"ENTERPRISE":"INDIVIDUAL",v=typeof window<"u"&&window.navigator.userAgent.includes("Mobile");return{isPriority:g,isSubscribed:y,language:b,country:i,searchFocus:x,userCategory:_,isFollowUp:!!u,isMobile:v,appApiClient:"web",configuredModel:c,[jZ]:a,turnCount:o}}const OZ=e=>{try{if(!e||!e.side_by_side_config)return!1;const t=e.side_by_side_config;if(!t||typeof t!="object")return!1;const n=!!(t.experiment_flag&&typeof t.experiment_flag=="string"&&t.experiment_flag.length>0),r=!!(t.variations&&Array.isArray(t.variations)&&t.variations.length>0);return n||r}catch{return!1}},LZ=e=>{if(!e||!e.side_by_side_config)return[];const t=e.side_by_side_config;if(!t.experiment_flag||!t.variations||!Array.isArray(t.variations))return[];if(t.variations.length===0)return[];const n=[],r=wo(),s=t.experiment_flag;let a=!1;return t.variations.forEach(o=>{if(!o||!o.identifier)return;const i=o.is_control===!0;i&&(a=!0);const c=i?`${H2}${s}:${o.identifier}`:`${s}:${o.identifier}`,u={[s]:o.attributes_override??{}};n.push({sibling_uuid:r,experiment_role:c,experiment_override:u})}),!a&&ko(n)&&(n[0].experiment_role=`${H2}${s}:${t.variations[0]?.identifier}`),n},Bk=e=>{try{const t=Za.getItem(`${aD}_${e}`);return t?parseInt(t,10):0}catch{return 0}},FZ=(e,t)=>{try{Za.setItem(`${aD}_${e}`,t.toString())}catch{}};function UZ(e,t){try{Za.setItem(`${oD}_${e}`,JSON.stringify(t))}catch{}}function JKe(e){try{const t=Za.getItem(`${oD}_${e}`);if(t)return JSON.parse(t)}catch{}return null}function BZ({frontendContextUUID:e,disableSideBySide:t=!1}){const n=ns(),{sources:r,configuredModel:s}=En();AQ(r||[]);const{results:a}=Ht(),o=f.useMemo(()=>!a||a.length===0?1:d0(a).length+1,[a]),i=Mt(),c=Hs({reason:"sbs-experiment-attributes"}),u=MZ({reason:"sbs-experiment-attributes"}),d=TZ(),m=c0(),{session:p}=je(),h=mn()||!0;p?.user?.email?.endsWith("@perplexity.ai"),t=t||n===K.STUDIO||n===K.RESEARCH||h;const[g,y]=f.useState(()=>e?Bk(e):0),b=e?PZ(i,c,u,n,d,g,o,m??null,s,e):{},{sideBySideOverrides:x,loading:_,error:v}=NZ(e||"",b),C=v?String(v):null,w=OZ(x);f.useEffect(()=>{if(e){const E=Bk(e);y(Math.max(0,E))}else y(0)},[e]),f.useEffect(()=>{w&&e&&g>0&&FZ(e,g)},[e,g,w]),f.useEffect(()=>{w&&e&&x&&UZ(e,x)},[w,e,x]);const S=f.useCallback(()=>{w&&y(E=>Math.max(0,E+1))},[w]);return f.useMemo(()=>{if(t||!w||C)return IZ;const E=LZ(x);return{isEnabled:w,sbsVariations:E,isLoading:_,error:C,incrementTriggerCount:S,triggerCount:g}},[t,C,S,w,_,x,g])}const eYe=async(e,t,n,r)=>{const s=(a,o)=>{r(i=>i.filter(c=>t.some(u=>u.backend_uuid===c.backend_uuid)?c.backend_uuid===a.backend_uuid:!0).map(c=>c.backend_uuid===a.backend_uuid?{...c,side_by_side_metadata:c.side_by_side_metadata?{...c.side_by_side_metadata,selection_status:o}:void 0}:c))};try{const a=t.map((c,u)=>{let d;return e===Uh?d="TIE":d=u===e?"SELECTED":"UNSELECTED",EZ({entryUUID:c.backend_uuid,params:d,siblingUUID:n,reason:"user-sbs-selection"}).catch(m=>{throw Z.error(`Failed to update selection for entry ${c.backend_uuid}:`,m),m})});await Promise.all(a);let o,i;if(e===Uh?(o=sD(t)[0],i="TIE"):(o=t[e],i="SELECTED"),!o)throw new Error("No target result found");s(o,i)}catch(a){throw Z.error("Failed to update entry selection:",a),a}},HZ=/^\/b\//;function VZ(e){return e&&HZ.test(e)}function GZ(e){return e?new URL(window.location.href).pathname.endsWith(`/search/${e}`):!1}function zZ(e){return e?.startsWith("/collections")||e?.startsWith("/spaces")}const Jw=({serverName:e,iconUrl:t,size:n="md",border:r=!1})=>t?l.jsx("img",{src:t,alt:`${e} Logo`,className:z("object-contain",n==="sm"&&"size-5",n==="md"&&"p-xs size-12",r&&"ring-subtlest rounded-md ring-1")}):l.jsx(ut,{name:D("box"),className:z(n==="sm"&&"size-4",n==="md"&&"p-xs size-12",r&&"ring-subtlest rounded-md ring-1")}),qZ=()=>typeof window<"u"&&window.location?.origin?window.location.origin:"https://www.perplexity.ai",Hk=e=>{const t=qZ();return Kg(`${t}${e}`)?.href||`${t}${e}`},$Z=()=>[{id:"imessage",icon_url:Hk("/static/mcpb/imessage.png"),download_url:Hk("/static/mcpb/imessage_v0.0.10.mcpb"),manifest:{$schema:"https://static.modelcontextprotocol.io/schemas/2025-08-26/mcpb.manifest.schema.json",dxt_version:"0.1",name:"imessage",display_name:"Messages",version:"0.0.10",description:"Send and read messages using Apple's Messages app",long_description:`This tool lets Perplexity work with your Mac's Messages app. You can send messages, read messages, and ask Perplexity to help you understand what's important.

It uses Mac system features to connect to Messages. Your Mac will ask for permission before it can access Messages or Contacts. This is not made by Apple.`,license:"MIT",author:{name:"Perplexity Inc",email:"support@perplexity.ai",url:"https://www.perplexity.ai/"},homepage:"https://www.perplexity.ai/",icon:"icon.png",tools:[{name:"list_contacts",description:'List contacts. When query is provided, search for contacts by name. Use it first to get a handle id, phone numbers, or emails. This tool is more preferred to be used first than "list_chats" tool. If this tool returns empty results, try to use "list_chats" tool to find a contact.'},{name:"list_chats",description:"List chats from Messages. When query is provided, search for chats by phone number (preferrable) or chat name (if phone number is not available)."},{name:"create_chat",description:"Create a new chat with a specific contact"},{name:"read_chat",description:"Read Messages from a specific chat"},{name:"send_imessage",description:"Send a Message to specific chat"}],server:{type:"node",entry_point:"server/index.js",mcp_config:{command:"node",args:["${__dirname}/server/index.js"],env:{HOME:"${HOME}"}}},compatibility:{comet:">=139.0.0",platforms:["darwin"],runtimes:{node:">=22.0.0"},permissions:{full_disk_access:!0,contacts:{for_tools:["list_contacts"]}}}}}],eS=()=>{const e=Sn(),t=f.useMemo(()=>{if(!e.platformInfo)return;const{isMac:n,isWindows:r,isLinux:s}=e.platformInfo;if(n)return"darwin";if(r)return"win32";if(s)return"linux"},[e.platformInfo]);return f.useMemo(()=>t?$Z().filter(n=>n.manifest.compatibility?.platforms?t&&n.manifest.compatibility.platforms.includes(t):!0):_e,[t])},iD=(e,t)=>t.dxt_name?e?.find(n=>n.id===t.dxt_name)?.icon_url:void 0,lD=e=>Object.fromEntries(Object.entries(e.compatibility?.permissions??{}).filter(([t,n])=>!!n).map(([t,n])=>typeof n=="object"?[t,n]:[t,{}])),V2=e=>Object.entries(lD(e)).filter(([,{for_tools:t}])=>!t).map(([t])=>t),WZ=({cometState:e})=>f.useMemo(()=>{if(!e.installedDxts)return[];const t=e.installedDxts.flatMap(({manifest:n})=>V2(n));return Array.from(new Set(t))},[e.installedDxts]),KZ=Pe(async()=>{const{AskPermissionsModal:e}=await W(async()=>{const{AskPermissionsModal:t}=await import("./AskPermissionsModal-B9JzJF4Y.js");return{AskPermissionsModal:t}},__vite__mapDeps([20,2,3,5,1,6,7,8,9,13,12,14,15,16,17]));return{default:e}}),Su=()=>{const e=Sn(),{openModal:t}=Kt(),n=eS(),r=WZ({cometState:e}),s=Xt(),a=QC({queries:r.map(x=>({queryKey:Se.makeQueryKey("comet/permission",x),queryFn:()=>s.hasPermission(x)}))}).map(x=>x.data),i=f.useMemo(()=>{let x;return _=>(xn(x,_)||(x=_),x)},[])(a),c=f.useMemo(()=>new Set(e.mcpStdioServers?.filter(x=>{const _=Od(e.installedDxts,x);return(_?V2(_):[]).some(w=>{const S=r.indexOf(w);return S!==-1&&i[S]===!1})}).map(x=>x.name)),[e.mcpStdioServers,e.installedDxts,r,i]),u=f.useMemo(()=>Object.fromEntries(e.mcpStdioServers?.map(x=>{const _=Od(e.installedDxts,x),v=iD(n,x),C=_?.display_name??_?.name??x.name,w=c.has(x.name);return[x.name,{icon:void 0,avatar:l.jsx(Jw,{serverName:C,iconUrl:v,size:"sm"}),text:C,disabled:x.status!=="running"||!x.tools_count||w,description:"",type:"toggle",iconUrl:v}]})??[]),[e.mcpStdioServers,e.installedDxts,n,c]),d=f.useCallback((x,_)=>{if(!c.has(x)){_();return}const v=e.mcpStdioServers?.find(w=>w.name===x);if(!v)return;const C=Od(e.installedDxts,v);C&&t(KZ,{serverName:x,permissions:V2(C),onPermissionsGranted:_})},[e.mcpStdioServers,e.installedDxts,c,t]),m=f.useCallback(x=>{const _=new Set(e.mcpStdioServers?.map(v=>v.name)??[]);x.forEach(v=>_.delete(v)),e.actions.setMcpDisabledServers(_)},[e.actions,e.mcpStdioServers]),p=f.useCallback(x=>{d(x,()=>{const v=e.mcpDisabledServers??new Set,C=new Set(v);v.has(x)?C.delete(x):C.add(x),e.actions.setMcpDisabledServers(C)})},[e.actions,e.mcpDisabledServers,d]),h=f.useCallback(x=>{d(x,()=>{const v=e.mcpDisabledServers??new Set,C=new Set(v);C.delete(x),e.actions.setMcpDisabledServers(C)})},[e.actions,e.mcpDisabledServers,d]),g=f.useCallback(x=>{const _=e.mcpDisabledServers??new Set,v=new Set(_);v.add(x),e.actions.setMcpDisabledServers(v)},[e.actions,e.mcpDisabledServers]),y=f.useMemo(()=>new Set([...e.mcpDisabledServers??[],...c]),[e.mcpDisabledServers,c]),b=f.useCallback(x=>x in u&&!y?.has(x),[u,y]);return f.useMemo(()=>({cometMcpSources:u,setCometMcpSources:m,toggleCometMcpSource:p,addCometMcpSource:h,removeCometMcpSource:g,hasCometMcpSource:b,cometMcpDisabledServers:y}),[u,m,p,h,g,b,y])},Bh={DEFAULT:"DEFAULT",GOVERNMENT:"GOVERNMENT"},YZ="pplx.is-incognito";function cD(){const{value:e,setCookie:t}=rN(YZ);return f.useMemo(()=>({isIncognitoLocal:e===void 0?void 0:e==="true",setIsIncognito:n=>{t(String(n))}}),[e,t])}const f0=({reason:e})=>{const{organization:t}=Hs({reason:e}),{isGovernmentRequestOrigin:n}=gr(),r=t?.settings?.always_incognito,{isIncognitoLocal:s}=cD(),a=r||(s??n??!1),o=n?Bh.GOVERNMENT:Bh.DEFAULT;return{isIncognito:a,incognitoType:o}},QZ=1e3*60*30,uD={enableHighAccuracy:!0,timeout:1e4,maximumAge:0},tS=({origin:e="unknown",onPermissionSuccess:t,onPermissionError:n,onLocationRequested:r}={})=>{const[s,a]=vs("locationMetadata",void 0),o=f.useCallback((m,p)=>{a({location:m,permissionState:p,updatedAt:Date.now()})},[a]),i=f.useCallback(m=>{t?.(m),o({latitude:m.coords.latitude,longitude:m.coords.longitude},"granted")},[o,t]),c=f.useCallback(m=>{n?.(m),o(void 0,"denied")},[o,n]),u=XZ({onSuccess:i,onError:c,origin:e,onRequest:r}),d=Date.now()-(s?.updatedAt??0)>QZ;return f.useEffect(()=>{if(!navigator.geolocation||!("permissions"in navigator)||!d)return;let m=null,p=!0;const h=()=>{navigator.geolocation.getCurrentPosition(y=>{p&&o({latitude:y.coords.latitude,longitude:y.coords.longitude},"granted")},()=>{p&&o(void 0,"denied")},uD)},g=()=>{p&&(m?.state==="denied"?o(void 0,"denied"):m?.state==="granted"&&h())};return navigator.permissions.query({name:"geolocation"}).then(y=>{p&&(m=y,y.state==="granted"?h():o(void 0,y.state),y.addEventListener("change",g))}).catch(()=>{}),()=>{p=!1,m&&m.removeEventListener("change",g)}},[o,d]),f.useMemo(()=>({location:s?.location,permissionState:s?.permissionState,isPreciseLocationEnabled:s?.permissionState==="granted"&&!isNaN(s?.location?.latitude??0)&&!isNaN(s?.location?.longitude??0),requestLocation:u}),[s?.location,s?.permissionState,u])},XZ=({onRequest:e,onSuccess:t,onError:n,origin:r})=>{const{$t:s}=Q(),{session:a}=je(),{trackEvent:o}=Ze(a);return f.useCallback(()=>{e?.(),navigator.geolocation?navigator.geolocation.getCurrentPosition(i=>{t(i),o("precise location granted",{origin:r})},i=>{let c;switch(i.code){case i.PERMISSION_DENIED:n(s({defaultMessage:"Looks like permission was denied. Please allow location access in your browser site settings.",id:"9P7nG1a2Cl"})),c="permission_denied";break;case i.POSITION_UNAVAILABLE:n(s({defaultMessage:"Unable to determine your location. Please try again.",id:"VLgkyqQ5LO"})),c="position_unavailable";break;case i.TIMEOUT:n(s({defaultMessage:"Request timed out. Please try again.",id:"VIQi5rKvh3"})),c="timeout";break;default:n(s({defaultMessage:"An error occurred while getting your location. Please try again.",id:"oOu0W+N9Re"})),c="unsupported"}o("precise location modal denied",{origin:r,reason:c})},uD):(n(s({defaultMessage:"Location services are not supported by your browser.",id:"1eN9TO+Fjt"})),o("precise location modal denied",{origin:r,reason:"unsupported"}))},[s,n,t,e,r,o])};function Mi(){const{firstResult:e}=Ht();return e?.read_write_token}const dD=()=>{const e=mn(),t=Xt(),n=XC(),r=yr(),s=f.useCallback(a=>{const o=!!a.last_backend_uuid;return r(a.model_preference)===K.RESEARCH||(r(a.model_preference),K.STUDIO),(a.sources?.some(c=>c==="web")??!0)&&e&&!o&&!1},[e,r]);return f.useCallback((a,o,i)=>{!a||!s(o)||!n(i)||t.injectSearchResults(a,i,{})},[t,s,n])},ZZ="pplx_backend_flag_overrides",JZ=()=>{try{const e=_s(ZZ);return e?JSON.parse(e):{}}catch{return{}}},eJ=e=>{try{return new URL(e),!0}catch{return!1}},tJ=({isCometBrowser:e,frontendUUID:t,shouldUseNavV3CacheKey:n})=>{if(e&&t)return`nav-${t}`;if(n&&t)return t},nJ=({isCometBrowser:e,isMobile:t,isWindowsApp:n,clientPayloadUUID:r})=>e?{source:EN(),client_payload_cache_key:r}:{source:jq(t,n)},rJ=({inPageOverride:e,dslQuery:t,existingEntryUUID:n,existingUuid:r,deletedUrls:s,redoSearch:a,collection:o,isRelatedQuery:i,isSponsored:c,relatedQueryUUID:u,inDomain:d,inPage:m,newFrontendContextUUID:p,promptSource:h,querySource:g,timeFromFirstType:y,utmSource:b,disableWidgets:x,isNavSuggestionsDisabled:_,entropyBrowser:v,clientPayloadUUID:C,isIncognito:w,modelPreferenceSubmit:S,compareModelPreferences:E,lastBackendUUID:T,deviceLocation:k,newAttachments:M,threadMetadataRwToken:N,forceNew:P,finalSources:O,mode:L,frontendUUID:H,isWindowsApp:R,isMobile:I,mentions:F,side_by_side_metadata:G,skipSearchEnabled:j,sidecarTabId:$,sidecarUrl:q,sidecarTitle:U,sidecarSecondaryTabId:X,sidecarSecondaryUrl:J,sidecarSecondaryTitle:ne,isFirstEntry:ae,alwaysSearchOverride:de,overrideNoSearch:oe,cometIsMissionControl:le,mcpTools:se,refinementFiltersMetadata:re,browserAgentAllowOnceFromToggle:he,forceEnableBrowserAgent:ie,forceDisableBrowserAgent:ue,inlineMode:ce,canonicalPageContext:me,shouldUseNavV3CacheKey:pe,isFinanceAgentAllowed:xe,supportedBlockUseCases:Oe})=>{const Te=k?{location_lat:k.latitude,location_lng:k.longitude}:null,ke=nl().erp,Fe=eo(),ot=JZ();Object.keys(ot).length>0&&Z.info("Sending backend flag overrides to API",{overrideCount:Object.keys(ot).length,flagKeys:Object.keys(ot),flagValues:ot});const ge=nJ({isCometBrowser:Fe,isMobile:I,isWindowsApp:R,clientPayloadUUID:C});let Ce=!1,Ae="",He,rt=!1,Ft;rt=!0,Ft=g==="followup"?"followup-sidecar":"sidecar";let Qt;if(Fe){Qt={rendering_place:ke,sidecar_tab_id:$,sidecar_url:q,sidecar_title:U,sidecar_secondary_tab_id:X,sidecar_secondary_url:J,sidecar_secondary_title:ne};const Ye=wN(),We=v.isAgentAvailable();if(Ce=We&&!Ye,We?Ye&&Z.info("[comet] Local search disabled - incognito mode",{reason:"incognito_mode",frontendUUID:H}):Z.info("[comet] Local search disabled - agent not available",{reason:"agent_not_available",frontendUUID:H}),ae&&(Ae=v.getLastOmniboxInput(H)??""),g==="default_search"&&(eJ(Ae)&&(Ce=!1,Ft="default_search",Z.info("[comet] Local search disabled due to URL input in omnibox",{lastOmniboxInput:Ae})),!Ae)){const it=Kg(document.referrer);(!it||it.origin!==location.origin||it.pathname!=="/.well-known/comet-omnibox-text"&&it.pathname!=="/onboarding-comet")&&(Ce=!1,Ft="default_search",Z.info("[comet] Local search disabled due to unsecure referer",{lastOmniboxInput:Ae,parsedReferrer:it}))}}else g==="default_search"&&(He="external_url");return{last_backend_uuid:T??void 0,read_write_token:P?void 0:N,existing_entry_uuid:P?void 0:n,deleted_urls:s??void 0,attachments:M,language:ON(),timezone:PN,in_page:e??m,in_domain:d,search_focus:O.length===0?"writing":"internet",sources:O,frontend_uuid:r??H,redo_search:a,mode:L,target_collection_uuid:o?.uuid,model_preference:S??void 0,compare_model_preferences:E&&E.length>0?E:void 0,is_related_query:i??!1,is_sponsored:c??!1,related_query_uuid:u,frontend_context_uuid:p??void 0,prompt_source:h??void 0,query_source:Ft??g??"",is_incognito:w,time_from_first_type:y??void 0,local_search_enabled:Ce,use_schematized_api:!0,send_back_text_in_streaming_api:!1,supported_block_use_cases:Oe,utm_source:b,client_coordinates:Te,mentions:F,dsl_query:t,skip_search_enabled:j,is_nav_suggestions_disabled:_||rt,...g==="followup"?{followup_source:"link"}:{},...ge,...x?{disable_widgets:x}:{},always_search_override:de??!1,override_no_search:oe??!1,comet_info:Qt,...G&&{side_by_side_metadata:G},client_search_results_cache_key:tJ({isCometBrowser:Fe,frontendUUID:H,shouldUseNavV3CacheKey:pe}),comet_is_mission_control:le,mcp_tools:se,risky_query_source:He,should_ask_for_mcp_tool_confirmation:!0,refinement_filters_metadata:re,experiment_overrides:Object.keys(ot).length>0?ot:void 0,browser_agent_allow_once_from_toggle:he,force_enable_browser_agent:ie,force_disable_browser_agent:ue,supported_features:["browser_agent_permission_banner_v1.1"],...ce,canonical_page_context:me,is_finance_agent_allowed:xe}},sJ=async({reason:e})=>{try{const{data:t,error:n}=await ve.POST("/rest/incentives/comet-activation",e,{timeoutMs:Ct()});if(n)throw n;return t}catch(t){return Z.error("Failed to handle comet activation incentive",t),null}},aJ=async({eventName:e,isDeferred:t,clickId:n,nextauthUserId:r,reason:s})=>{try{const{data:a,error:o,response:i}=await ve.POST("/rest/attribution/dub/lead",s,{timeoutMs:Ct(),body:{event_name:e,is_deferred:t,click_id:n,nextauth_user_id:r}});if(o)throw new Ue("API_CLIENTS_ERROR",{cause:o,status:i.status??0});return{success:a?.success??!1}}catch(a){return Z.error("Failed to save post install redirect",a),{success:!1}}},oJ=async({entryUUID:e,params:t,reason:n})=>{try{const{data:r,error:s,response:a}=await ve.POST("/rest/entry/should-show-feedback/{entry_uuid}",n,{params:{path:{entry_uuid:e}},body:t,timeoutMs:Ct({productionMs:500,devMs:1e3,clientSideMs:1e3}),numRetries:0});if(s)throw new Ue("API_CLIENTS_ERROR",{cause:s,status:a.status??0});return r?.should_show_feedback??!1}catch(r){return Z.error("Failed to check if should show feedback",r),!1}},iJ="signUpBannerDismissed",lJ=()=>Za.setItem(iJ,"reset"),cJ=2,uJ=10,dJ=({response:e,isUserLoggedIn:t,submissionQueryCount:n,session:r,queryCountMobile:s,addKeyRequiringRerender:a,trackEvent:o,setShouldShowProductFeedback:i,setFeedbackEntryUUID:c,sendQueryEventSingular:u,maybeSendNthQueryEventSingular:d,reason:m,refetchHomepageUpsells:p})=>{const h=eo();if(h&&Pq(t),e?.backend_uuid){const y=e.backend_uuid;oJ({entryUUID:e.backend_uuid,params:{query:e.query_str||"",sources:e.sources?.sources??[]},reason:m}).then(b=>{i(b),b&&o("query feedback shown",{entry_uuid:y})}),c(y)}!t&&n===cJ&&(lJ(),a("floating-signup")),t&&r?.user?.id&&s===0&&n===uJ&&a("floating-mobile-download"),p(),u(),d({isCometBrowser:h});const g=J9();h&&g===1?(aJ({eventName:"activated",isDeferred:!1,clickId:null,nextauthUserId:r?.user?.id??null,reason:"comet attribution"}),sJ({reason:"comet activation incentive"}),o("first comet query finished",{})):h&&g===3&&o("third comet query finished",{})},fJ=()=>Se.makeQueryKey("/rest/homepage-widgets/upsell",{}),tYe=()=>Se.makeQueryKey("/rest/ntp/upsell/",{}),fD=()=>Se.makeQueryKey("/rest/visitor/information",{}),mJ={visitor_queries_past_day:0},mD=async({reason:e})=>{try{const{error:t,data:n,response:r}=await ve.GET("/rest/visitor/information",e,{timeoutMs:1500});if(t||!n)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to get visitor information",cause:t,status:r.status??0});return n}catch(t){return Z.error(t),mJ}},pD=({enabled:e=!0,reason:t})=>gt({queryKey:fD(),queryFn:()=>mD({reason:t}),enabled:e}),pJ=()=>{const e=It();return f.useCallback(()=>{const t=fD(),n=e.getQueryData(t);n!==void 0?e.setQueryData(t,{visitor_queries_past_day:n.visitor_queries_past_day+1}):e.ensureQueryData({queryKey:t,queryFn:()=>mD({reason:"increment-wait-for-cache"})}).then(r=>{e.setQueryData(t,{visitor_queries_past_day:r.visitor_queries_past_day+1})}).catch(()=>{})},[e])},hJ=({inPage:e})=>e?window.getSelection()?.toString():void 0;function gJ(){const{value:e}=G$({flag:"client-context-max-chars",subjectType:"visitor_id",defaultValue:5e4});return e}const yJ=(e,t,n)=>{const{value:r,loading:s}=BC({flag:"max-file-upload-count",defaultValue:e,extraAttributes:t,subjectType:"user_nextauth_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])};function nS(){const{variation:e}=yJ(10);return e}const xJ=({isFollowup:e,isInSameThread:t,sourcesOverride:n,firstResultSources:r,defaultSources:s})=>n?{finalSources:n}:!e||!t?{finalSources:s}:{finalSources:Array.isArray(r)?r:[]},Ld=/<q>(.*?)<\/q>/s;function hD(e){if(!e)return{quote:null,actualQuery:null};if(!Ld.test(e))return{quote:null,actualQuery:e};const r=e.match(Ld)?.[1]||null,s=e.replace(Ld,"").trim();return{quote:r,actualQuery:s}}function bJ(e,t){const n=t.trim();return n?Ld.test(e)?e.replace(Ld,`<q>${n}</q>`):e.length===0?n:`<q>${n}</q> ${e}`:e}const _J={submitQuery:()=>{Z.error("submitQuery must be used within PerplexityQueryStateProvider")},handleBotStep:()=>{Z.error("handleBotStep must be used within PerplexityQueryStateProvider")},deleteLastResult:()=>{Z.error("deleteLastResult must be used within PerplexityQueryStateProvider")},shouldShowProductFeedback:!1,feedbackEntryUUID:null,quote:null,setQuote:()=>{},updateLocalStatePostStream:()=>{},submissionQueryCount:0},gD=Bt("PplxQueryStateContext",_J),vJ=(e,t,n,r,s)=>{if(!(n&&!r)&&!(e&&!t))return r?r.backend_uuid:s},CJ=({children:e,shouldFetchSettings:t})=>{const n="perplexity-query-state-provider",r=hn(),{session:s}=je(),{trackEvent:a}=Ze(s),o=Xt(),{location:i}=tS(),[c,u]=f.useState(null),{device:{isWindowsApp:d,isMobile:m}}=jn(),p=ns(),h=yr(),g=Oq(),{sources:y,configuredModel:b,compareModels:x}=En(),{specialCapabilities:_}=gr(),v=Mi(),{firstResult:C,lastResult:w}=Ht(),{setCurrentStreamId:S}=u0(),{hasAiProfile:E,queryCountMobile:T}=ga({enabled:t,reason:n}),[k,M]=f.useState(!1),[N,P]=f.useState(null),O=wt(),{addKeyRequiringRerender:L}=kN(),{value:H}=Lt({flag:"skip-search-button",subjectType:"visitor_id",defaultValue:!1}),R=gJ(),{isIncognito:I}=f0({reason:n}),[F,G]=f.useState(0),{sendQueryEventSingular:j,maybeSendNthQueryEventSingular:$,sendResurrectedActivationEventSingular:q}=oR(),U=Sn(),{cometMcpDisabledServers:X}=Su(),J=Nw(),ne=eR({isWorkflowRedesignEnabled:J}),ae=tK(),de=pJ(),oe=nS(),le=dD(),se=It(),re=f.useCallback(()=>{se.invalidateQueries({queryKey:fJ()})},[se]),he=f.useCallback(({rawQuery:pe,dslQuery:xe,fork:Oe,inPageOverride:Te,copilotOverride:we,existingEntryUUID:ke,existingUuid:Fe,deletedUrls:ot,redoSearch:ge,attachments:Ce,collection:Ae,modelPreferenceOverride:He,isRelatedQuery:rt,isSponsored:Ft,relatedQueryUUID:Qt,inDomain:Ye,inPage:We,newFrontendContextUUID:it,existingFrontendContextUUID:Ee,promptSource:et,querySource:xt,sourcesOverride:Ut,submitFromArticleOverride:Tt,timeFromFirstType:gn,utmSource:ir,disableWidgets:br,isNavSuggestionsDisabled:lt,deviceLocation:mt,shouldRedirectToBackendUUID:At,onThreadSlugReceived:Vt,incognitoOverride:dt,mentions:en=[],shouldUsePageStartTime:jt,side_by_side_metadata:Gt,frontendUUID:fe=crypto.randomUUID(),alwaysSearchOverride:De,overrideNoSearch:Ve,cometIsMissionControl:ct,refinementFiltersMetadata:tt,browserAgentAllowOnceFromToggle:bt,forceEnableBrowserAgent:Tn,forceDisableBrowserAgent:Vn,canonicalPageContext:An,isFinanceAgentAllowed:zt})=>{if(pe.trim().length===0&&!c){Z.error("Submit failed: empty query");return}const Wn=en.filter(Nn=>Nn.type==="tab").map(Nn=>({id:Number(Nn.id),url:Nn.url})),_a=!!it,Uo=[...new Set([...Ce??[]])].slice(0,oe).filter(Nn=>!ot?.includes(Nn)),qu=!0,$u=mn()&&qu,Wl=$u?wo():void 0,Pi=we||qu,as="copilot";let oo=b;He&&(oo=He);const io=p===K.AGENTIC_RESEARCH&&x.length>0?x:void 0,Oi=vJ(_a,Oe??!1,C?.backend_uuid===ke,Tt??null,w?.backend_uuid??null);Lq(),de(),G(Nn=>Nn+1),Fq(()=>{a("resurrected activated"),q()}),h(oo)===K.RESEARCH?Uq():h(oo)===K.STUDIO&&Bq();const qm=!!Oi,$m=C?.frontend_context_uuid===Ee,Wm=xJ({isFollowup:qm,isInSameThread:$m,sourcesOverride:Ut,firstResultSources:C?.sources?.sources,defaultSources:y??[]}),{finalSources:Wu}=Wm;let Km;U.mcpTools&&(Km=Object.entries(U.mcpTools).filter(([Nn])=>!X?.has(Nn)).flatMap(([Nn,Xm])=>{const Zm=U.mcpToolsSettings?.[Nn]??{};return Xm.filter(Yu=>{const Jm=Yu.tool?.name??Yu.id??"",Qu=Zm[Jm];return Qu?Qu.enabled!==!1:!0})}));const Ku=hJ({inPage:Te??We})||c,Vo=(Ku?bJ(pe,Ku):pe).trim();if(!Vo){Z.error("Submit failed: empty query");return}const Ym=ke==C?.backend_uuid||!Oi,Kl=!mn()&&ER({query:Vo,isFollowup:qm,attachmentsLength:Uo.length,sourcesLength:Wu?.length??0,isStudyMode:oo===te.STUDY}),Yl=nK({rawQuery:Vo,fork:Oe,existingEntryUUID:ke,existingUuid:Fe,collection:Ae,isRelatedQuery:rt,newFrontendContextUUID:it,existingFrontendContextUUID:Ee,submitFromArticleOverride:Tt,isNavSuggestionsDisabled:lt,isCopilot:Pi,modelPreferenceSubmit:oo,newAttachments:Uo,firstResultFrontendContextUUID:C?.frontend_context_uuid,isPersonalized:E,forceNew:_a,querySource:xt,lastResultBackendUUID:w?.backend_uuid,finalSources:Wu,uuid:fe,threadMetadataTitle:C?.thread_title,threadMetadataThreadUrlSlug:C?.thread_url_slug,side_by_side_metadata:Gt}),Ys=rJ({redoSearch:ge,collection:Ae,dslQuery:xe,isRelatedQuery:rt,isSponsored:Ft,relatedQueryUUID:Qt,inDomain:Ye,inPage:We,newFrontendContextUUID:it,promptSource:et,querySource:xt,timeFromFirstType:gn,utmSource:ir,disableWidgets:br,isNavSuggestionsDisabled:lt,isWindowsApp:d,isIncognito:dt??I,modelPreferenceSubmit:oo,compareModelPreferences:io,clientPayloadUUID:Wl,lastBackendUUID:Oi,deviceLocation:mt=mt??i,newAttachments:Uo,threadMetadataRwToken:v,forceNew:_a,finalSources:Wu,mode:as,frontendUUID:fe,entropyBrowser:o,existingEntryUUID:ke,deletedUrls:ot,mentions:en,side_by_side_metadata:Gt,skipSearchEnabled:H,sidecarTabId:U.sidecarSourceTab.tabId,sidecarTitle:U.sidecarSourceTab.title,sidecarUrl:U.sidecarSourceTab.url,sidecarSecondaryTabId:U.sidecarSourceTab.secondaryTab?.tabId,sidecarSecondaryUrl:U.sidecarSourceTab.secondaryTab?.url,sidecarSecondaryTitle:U.sidecarSourceTab.secondaryTab?.title,isFirstEntry:Ym,alwaysSearchOverride:De,overrideNoSearch:Ve,cometIsMissionControl:ct,mcpTools:Km,refinementFiltersMetadata:tt,browserAgentAllowOnceFromToggle:bt,forceEnableBrowserAgent:Tn||p===K.BROWSER_AGENT,forceDisableBrowserAgent:Vn,canonicalPageContext:An,isFinanceAgentAllowed:zt,inlineMode:void 0,isMobile:m,shouldUseNavV3CacheKey:Kl,supportedBlockUseCases:ne});it&&le(Vo,Ys,Ys.frontend_uuid),u(null);const Ql={params:{...Ys,version:_u},query_str:Vo};function Qm(Nn){if(Vt){if(Yt.isStatusFailed(Nn))throw new Lh("STREAM_FAILED_FIRST_CHUNK_ERROR",{message:"failed status on first message",details:{request_id:Nn.frontend_uuid??"unknown",backend_uuid:Nn.backend_uuid}});if(!Nn.thread_url_slug)throw new Lh("STREAM_FAILED_FIRST_CHUNK_ERROR",{message:"thread_url_slug is required on first message",details:{request_id:Nn.frontend_uuid??"unknown",backend_uuid:Nn.backend_uuid}});Vt(Nn.thread_url_slug)}At&&r.push(`/search/${Nn.thread_url_slug}`)}const Li=ae(Ql,{onFirstMessageReceived:Qm,placeholderChunk:{...Yl,backend_uuid:ke||rK},timer:jt?g():mi(void 0,{nowFromTimeOrigin:performance.now()}),reason:n});$u&&Wl&&HC({clientPayloadCacheKey:Wl,cometBrowser:o,maxChars:R,attachedTabs:Wn,includeSidecar:qu,reason:n,cometState:U,requestId:Li.id.description}),S(Li.id.description)},[c,_.unlimitedProSearch,oe,b,p,C?.backend_uuid,C?.frontend_context_uuid,C?.sources?.sources,C?.thread_title,C?.thread_url_slug,w?.backend_uuid,y,U,E,d,I,i,v,o,H,ae,g,S,m,a,q,X,le,r,R,x,h,de,ne]),ie=f.useCallback(pe=>{dJ({response:pe,isUserLoggedIn:O,submissionQueryCount:F,session:s??void 0,queryCountMobile:T,addKeyRequiringRerender:L,setShouldShowProductFeedback:M,setFeedbackEntryUUID:P,trackEvent:a,sendQueryEventSingular:j,maybeSendNthQueryEventSingular:$,reason:n,refetchHomepageUpsells:re})},[L,re,O,T,j,$,s,F,a]),ue=Lw(),ce=vR(),me=f.useCallback(async()=>{const pe=w?.backend_uuid;!pe||!v||(a("delete last result",{entryUUID:pe}),await ve.DELETE("/rest/entry/delete-ask-entry/{entry_uuid}",n,{params:{path:{entry_uuid:pe}},body:{read_write_token:v}}),ce(pe),ue(xe=>{if(!xe)return;const Oe=xe??[];if(Oe.length<1){r.push("/",void 0,"Delete last result");return}return Oe.slice(0,-1)}))},[w?.backend_uuid,v,a,ue,ce,r]);return l.jsx(gD.Provider,{value:{submitQuery:he,deleteLastResult:me,shouldShowProductFeedback:k,feedbackEntryUUID:N,quote:c,setQuote:u,updateLocalStatePostStream:ie,submissionQueryCount:F},children:e})},ya=()=>{const e=f.useContext(gD);if(!e)throw new Error("usePerplexityQueryState must be used within PerplexityQueryStateContext");return e},m0=e=>e?Se.makeQueryKey("/rest/thread/list_ask_threads",e):Se.makeQueryKey("/rest/thread/list_ask_threads"),wJ=m0,SJ=e=>Se.makeQueryKey("/rest/thread/{entry_uuid_or_slug}",{uuid:e}),rS="comet_mcp_";function la(e){return e.startsWith(rS)}function Eu(e){return e.replace(rS,"")}function yD(e){return`${rS}${e}`}const Kf=({enabled:e=!0}={})=>{const n=ga({reason:"use-source-limits",enabled:e}),r=It(),s=f.useCallback(i=>{if(la(i))return{monthlyLimit:1/0,remaining:1/0};const{monthly_limit:c=0,remaining:u=0}=n.sources.source_to_limit[i]??{};return{monthlyLimit:c??1/0,remaining:u??1/0}},[n.sources.source_to_limit]),a=f.useCallback(i=>{const{remaining:c=0}=s(i);return c===0},[s]),o=f.useCallback(async()=>{if(Object.values(n.sources.source_to_limit).some(({monthly_limit:c})=>c!==null)){if(!e){r.invalidateQueries({queryKey:wu()});return}await n.refetch()}},[n,e,r]);return f.useMemo(()=>({getSourceLimit:s,getSourceLimited:a,checkSourceLimits:o}),[s,a,o])},sS="pplx.activeQuery";function xD(){const e=Za.getItem(sS);if(!e)return{};try{return JSON.parse(e)}catch{return{}}}function EJ(e){Za.setItem(sS,JSON.stringify(e))}function kJ(){Za.removeItem(sS)}const bD=du("QueryInputStateContext",()=>vi(e=>({userInput:"",userInputJson:void 0,hasStartedTyping:!1,shouldTriggerFocus:!1,actions:{restoreInput:()=>{const t=xD();t.rawQuery&&e({userInput:t.rawQuery,userInputJson:t.rawQueryJson})},setUserInput:(t,n)=>{e({userInput:t,userInputJson:n}),EJ({rawQuery:t,rawQueryJson:n})},setHasStartedTyping:t=>e({hasStartedTyping:t}),setStartTypingTime:t=>e({startTypingTime:t}),resetInput:()=>{e({userInput:"",userInputJson:void 0}),kJ()},markInputAsSubmitted:()=>{e({userInput:"",userInputJson:void 0,startTypingTime:void 0})},setShouldTriggerFocus:t=>{e({shouldTriggerFocus:t})}}}))),MJ=bD.Provider,ku=bD.useSelector,TJ=A.memo(function(){const{setUserInput:t,resetInput:n}=p0(),r=sr(),s=Mo(r);return f.useLayoutEffect(()=>{const a=xD();a.rawQuery&&t(a.rawQuery,a.rawQueryJson)},[t]),f.useLayoutEffect(()=>{!s||s===r||s==="/"&&r?.startsWith("/search/new")||s.startsWith("/search/new")&&r?.startsWith("/search")||s.startsWith("/search/new")&&r==="/"||n()},[r,s,n]),null}),_D=()=>ku(e=>e.userInput),vD=()=>ku(e=>e.userInputJson),CD=()=>ku(e=>e.hasStartedTyping),AJ=()=>ku(e=>e.startTypingTime),NJ=()=>ku(e=>e.shouldTriggerFocus),p0=()=>ku(e=>e.actions);var Hh;(function(e){e[e.NONE=0]="NONE",e[e.READER=1]="READER",e[e.WRITER=2]="WRITER",e[e.EDITOR=5]="EDITOR",e[e.ADMIN=3]="ADMIN",e[e.OWNER=4]="OWNER",e[e.OWNER_DEFAULT_BOOKMARKS=6]="OWNER_DEFAULT_BOOKMARKS",e[e.INVITED_READER=11]="INVITED_READER",e[e.INVITED_WRITER=12]="INVITED_WRITER",e[e.INVITED_EDITOR=15]="INVITED_EDITOR",e[e.INVITED_ADMIN=13]="INVITED_ADMIN"})(Hh||(Hh={}));function nYe(e){return e>=Hh.WRITER&&e<Hh.INVITED_READER}var kc;(function(e){e.PageAccessNotAllowed="pageAccessNotAllowed",e.ThreadAccessNotAllowed="threadAccessNotAllowed",e.InvalidThread="invalidThread",e.ThreadExpired="threadExpired",e.ThreadStreamError="threadStreamError",e.CollectionAccessNotAllowed="collectionAccessNotAllowed",e.SpaceAccessNotAllowed="spaceAccessNotAllowed",e.InvalidCollection="invalidCollection",e.SubscriptionAlreadyActive="subscriptionAlreadyActive",e.UnableToGrantAccess="unableToGrantAccess"})(kc||(kc={}));const RJ="ENTRY_EXPIRED",Vk="VIEW_THREAD_NOT_ALLOWED",DJ=Pe(async()=>{const{DebugStreamSideEffects:e}=await W(async()=>{const{DebugStreamSideEffects:t}=await import("./DebugStreamSideEffects-DY4_yPON.js");return{DebugStreamSideEffects:t}},__vite__mapDeps([21,12,2,3,1,9,5,7,8,22,14]));return{default:e}},{restricted:!0}),IJ=A.memo(function(){const t="stream-side-effects",n=hn(),r=mn(),{session:s}=je(),{trackEvent:a}=Ze(s),{$t:o}=Q(),i=jN(globalThis.navigator?.userAgent),{sendNotification:c}=CR({windowsAppOnly:!1}),u=dD(),d=wQ(),{addKeyRequiringRerender:m}=kN(),p=nl(),h=Xt(),g=Si(),y=typeof window<"u"&&(window.location.pathname.startsWith("/b/mission-control")||window.location.pathname.startsWith("/b/assistants")),{fileRepoInfo:b}=Fw({reason:t}),{firstResult:x}=Ht(),_=x?.thread_url_slug,{data:v}=UR({fileRepoInfo:b,fileName:_??"",reason:t}),{saveThreadToSpace:C}=UX({fileRepoInfo:b,fileExists:v??!0,reason:t}),w=Dw(),{resetInput:S,restoreInput:E}=p0(),T=_D(),k=f.useRef(T);k.current=T;const M=PQ({reason:t}),N=It(),P=xQ(),{updateLocalStatePostStream:O}=ya(),{checkSourceLimits:L}=Kf({enabled:!1}),H=Sn(),{preferredSearchModels:R}=Ol(),{setConfiguredModel:I}=En(),F=Vs();f.useLayoutEffect(()=>_r.on("created",async({stream:j,query:$,params:q})=>{if(j.isReconnect||!$||!q)return;if(Ix(q)&&q.side_by_side_metadata){const{experiment_role:J}=q.side_by_side_metadata;if(!RZ(J))return}const U=ul(),X=Ox(i,p.erp);jY(j.id,{name:"perplexity_ask",queryStr:$,queryParams:q,isFollowup:Ix(q)&&(q.query_source==="followup"||q.query_source==="followup-sidecar"||q.query_source==="followup-mobile-sidecar"),isPerplexityBrowser:r,frontendUUID:q.frontend_uuid??"",session:s??void 0,browserVersion:U?.browser_version,source:X,connectors:M,mentions:"mentions"in q?q.mentions:[],inlineAssistantAction:H.inlineAssistantParams.action}),h?.setTabProgress(!0),g&&h.sendThreadStatusToMobile({status:"working",streamId:j.id.description})}),[r,i,s,M,p.erp,h,g,H.inlineAssistantParams.action]),f.useLayoutEffect(()=>_r.on("progress",({stream:j,message:$})=>{const{blocks:q,status:U,telemetry_data:X}=$,J=q?.some(de=>!!de?.markdown_block?.chunks?.length)??!1,ne=q?.some(de=>!!de?.web_result_block?.web_results?.length)??!1,ae=q?.some(de=>!!de?.sources_mode_block?.rows?.length)??!1;if(X){const{has_displayed_search_results:de,has_first_output_token:oe,has_first_token:le,has_widget_data:se,has_nav_results:re,early_nav_v3_call:he,first_widget_type:ie,country:ue,is_followup:ce,source:me,engine_mode:pe,search_implementation_mode:xe,has_useful_renderable_content:Oe,region:Te}=X,we={country:ue,is_followup:ce,source:me,engine_mode:pe,search_implementation_mode:xe,region:Te};de&&j.timer.addTimingOnce("web.frontend.first_search_results_latency_ms",we),oe&&j.timer.addTimingOnce("web.frontend.first_output_token_latency_ms",we),le&&j.timer.addTimingOnce("web.frontend.first_token_latency_ms",we),se&&j.timer.addTimingOnce("web.frontend.first_widget_data_latency_ms",{...we,first_widget_type:ie}),Oe&&j.timer.addTimingOnce("web.frontend.first_useful_renderable_content_latency_ms",we),re&&j.timer.addTimingOnce("web.frontend.first_has_nav_results_latency_ms",we),he&&j.timer.addTimingOnce("web.frontend.early_nav_v3_call_latency_ms",we)}MY(j.id,{hasLLMToken:J,hasSearchResults:ne,hasSources:ae},{id:s?.user?.id,subscription_status:s?.user?.subscription_status}),U==="FAILED"&&Z.error(new Lh("STREAM_FAILED_CHUNK_ERROR",{details:{request_id:j.id.description,backend_uuid:j.entryId??"unknown"}}),{message:$})}),[s?.user?.id,s?.user?.subscription_status]),f.useLayoutEffect(()=>_r.on("progress",({stream:j,isFirstMessage:$})=>{$&&j.placeholderChunk&&j.placeholderChunk.query_source&&!k.current&&S()}),[S]),f.useLayoutEffect(()=>_r.on("completed",({stream:j})=>{const $=nl(),q=Ox(i,$.erp);wk(j.id,{name:"SUCCESSFUL response",session:s??void 0,source:q})}),[s,i]),f.useLayoutEffect(()=>{const j=({thread:q,message:U})=>{U&&w(U,q)},$=[_r.on("progress",j),_r.on("completed",j),_r.on("error",j),_r.on("aborted",j)];return()=>{$.forEach(q=>q())}},[w]);const G=yr();return f.useLayoutEffect(()=>_r.on("completed",({stream:j,thread:$})=>{if(!j.threadId||!j.entryId)return;const q=$?.find(X=>X?.uuid===j.id.description||X?.backend_uuid===j.entryId);let U;G(q?.display_model)===K.RESEARCH?U=o({defaultMessage:"Your report is ready",id:"CEIDgftq5U"}):G(q?.display_model)===K.STUDIO&&(U=o({defaultMessage:"Your project is ready",id:"UXOU5ST+Nc"})),PJ({lastResponse:q,backend_uuid:j.entryId,trackEvent:a,sendNotification:c,notificationText:U,cometAdapter:h,isMissionControl:y,getSearchModeForSearchModel:G,preferredSearchModels:R,setConfiguredModel:I,defaultSearchModel:F})}),[o,a,c,h,y,G,R,I,F]),f.useLayoutEffect(()=>_r.on("completed",async({stream:j})=>{!_||!j.entryId||v&&await C(j.entryId,_)}),[v,C,_]),f.useLayoutEffect(()=>{const j=({stream:U})=>{const{id:X}=U,J=nl(),ne=Ox(i,J.erp),oe=new URL(window.location.href).pathname.replace("/search/new/","");wk(X,{name:"FAILED response",session:s??void 0,source:ne}),oe===X.description&&(E(),n.replace(`/?error=${kc.ThreadStreamError}`,"StreamSideEffects")),h?.setTabProgress(!1)},$=_r.on("error",j),q=_r.on("aborted",j);return()=>{$(),q()}},[s,i,E,n,h]),f.useLayoutEffect(()=>_r.on("created",({query:j,params:$,stream:{isReconnect:q,id:U,timer:X}})=>{if(!(!j||!$||q||!Ix($))){if(r){u(j,{model_preference:$.model_preference,last_backend_uuid:"last_backend_uuid"in $?$.last_backend_uuid:void 0,sources:$.sources,override_no_search:$.override_no_search},U.description);return}d({query:j,params:$,reason:"streamEvents.on(created)",streamTimer:X,isComet:r,streamId:U.description})}}),[u,d,r]),f.useEffect(()=>{if(!r)return;const j=[_r.on("completed",({stream:$})=>{h.cleanupTasks($.entryId,"stream_completed"),g&&h.sendThreadStatusToMobile({status:"ready",streamId:$.id.description})}),_r.on("aborted",({stream:$})=>{h.cleanupTasks($.entryId,"stream_aborted"),g&&h.sendThreadStatusToMobile({status:"ready",streamId:$.id.description})}),_r.on("error",({stream:$,message:q})=>{(q&&!q.reconnectable||$.abortController?.signal.aborted)&&h.cleanupTasks($.entryId,"stream_error"),g&&h.sendThreadStatusToMobile({status:"error",streamId:$.id.description})})];return()=>{j.forEach($=>$())}},[h,g,r]),f.useEffect(()=>_r.on("completed",async({message:j,thread:$})=>{if(!j||(O(j),j.collection_info?.slug&&N.invalidateQueries({queryKey:IR(j.collection_info.slug),exact:!1}),P(),L(),GZ(j.thread_url_slug)))return;const q=!!j.parent_info,U=$.findIndex(X=>X.uuid===j.uuid)>0;(q||!U)&&(m("floating-signup"),N.invalidateQueries({queryKey:m0(),refetchType:"all"}))}),[N,i,m,P,O,L]),f.useEffect(()=>{const j=()=>{h?.setTabProgress(!1)};return window.addEventListener("beforeunload",j),()=>{window.removeEventListener("beforeunload",j)}},[h]),null}),jJ=A.memo(function(){const{pendingTasks:t,navigationMeta:n}=Sn();return l.jsx(DJ,{pendingTasks:t,navigationMeta:n})});function PJ({lastResponse:e,backend_uuid:t,trackEvent:n,notificationText:r,sendNotification:s,cometAdapter:a,isMissionControl:o,getSearchModeForSearchModel:i,preferredSearchModels:c,setConfiguredModel:u,defaultSearchModel:d}){if(!t)return Z.error(new Error("No backend_uuid found in response")),!1;if(!e)return Z.error(new Error("No last response found in query client")),!1;if((i(e.display_model)===K.RESEARCH||i(e.display_model)===K.STUDIO)&&r&&s&&document.visibilityState!=="visible"&&s({title:r,body:e.query_str,onClick:()=>{window.focus()}}),e.blocks){e.blocks.filter(p=>p.intended_usage?.endsWith("_markdown")).forEach(p=>{p.markdown_block?.media_items&&n&&p.markdown_block.media_items.forEach(h=>{n("inline image data received",{image_url:h.image??"",entryUUID:t})})});const m=e.blocks.find(p=>p.intended_usage==="knowledge_cards")?.knowledge_card_block?.knowledge_cards?.[0];m&&n&&n("knowledge card in results",{entryUUID:t,name:m.title??"",id:m.id??"",type:m.card_type??""})}if(a?.setTabProgress(!1),o||a?.showNotification(),e.search_mode==="AGENTIC_RESEARCH"&&u){const p=c?.[K.SEARCH]??d;u(p)}return!0}const OJ=(e,t,n)=>{const{value:r,loading:s}=VC({flag:"vis-refresh-2026-color-variant",defaultValue:e,extraAttributes:t,subjectType:"visitor_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},Vx="visRefresh2026Colors";function LJ(){const{variation:e,loading:t}=OJ("none"),n=f.useRef(null);return f.useEffect(()=>{if(t)return;const r=document.documentElement;if(r.classList.remove(Vx),n.current&&(r.classList.remove(n.current),n.current=null),e&&e!=="none"){const s=`visRefresh2026Colors${e.substring(0,1).toUpperCase()}${e.substring(1)}`;r.classList.add(Vx,s),n.current=s}return()=>{r.classList.remove(Vx),n.current&&(r.classList.remove(n.current),n.current=null)}},[e,t]),null}const FJ=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"vis-refresh-2026-fonts-serif-answer",defaultValue:e,extraAttributes:t,subjectType:"visitor_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},UJ=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"vis-refresh-2026-fonts",defaultValue:e,extraAttributes:t,subjectType:"visitor_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])};function BJ(){const{variation:e,loading:t}=UJ(!1),{variation:n,loading:r}=FJ(!1);return f.useEffect(()=>{t||e&&(document.documentElement.style.setProperty("--pplx-sans","gtStandard"),document.documentElement.style.setProperty("--pplx-mono","gtStandardMono"),document.documentElement.style.setProperty("--pplx-serif","gtCanon"),document.body.classList.add("visRefresh2026Fonts"))},[e,t]),f.useEffect(()=>{if(!r)return n?document.body.classList.add("visRefresh2026AnswerSerif"):document.body.classList.remove("visRefresh2026AnswerSerif"),()=>{document.body.classList.remove("visRefresh2026AnswerSerif")}},[n,r]),null}const wD=Bt("PaywallModalsContext",null),HJ=()=>{const e=f.useContext(wD);if(!e)throw new Error("usePaywallModals must be used within a PaywallModalsProvider");return e};var Rn;(function(e){e.MACOS="macos",e.WINDOWS="windows"})(Rn||(Rn={}));var er;(function(e){e.NEW_THREAD="NEW_THREAD",e.STOP_GENERATING="STOP_GENERATING",e.TOGGLE_INCOGNITO="TOGGLE_INCOGNITO",e.SHOW_SHORTCUTS="SHOW_SHORTCUTS",e.FOCUS_ASK_INPUT="FOCUS_ASK_INPUT",e.TOGGLE_DICTATION="TOGGLE_DICTATION",e.TOGGLE_V2V="TOGGLE_V2V"})(er||(er={}));const VJ="keyboard-shortcuts",GJ={[er.NEW_THREAD]:{[Rn.MACOS]:[],[Rn.WINDOWS]:[]},[er.STOP_GENERATING]:{[Rn.MACOS]:[],[Rn.WINDOWS]:[]},[er.TOGGLE_INCOGNITO]:{[Rn.MACOS]:[],[Rn.WINDOWS]:[]},[er.SHOW_SHORTCUTS]:{[Rn.MACOS]:[],[Rn.WINDOWS]:[]},[er.FOCUS_ASK_INPUT]:{[Rn.MACOS]:[],[Rn.WINDOWS]:[]},[er.TOGGLE_DICTATION]:{[Rn.MACOS]:[],[Rn.WINDOWS]:[]},[er.TOGGLE_V2V]:{[Rn.MACOS]:[],[Rn.WINDOWS]:[]}},zJ={[er.NEW_THREAD]:{type:er.NEW_THREAD,label:V({defaultMessage:"New Thread",id:"76XSxT3hV8"}),macos:["","K"],windows:["Ctrl","I"],editable:!0,global:!0},[er.TOGGLE_INCOGNITO]:{type:er.TOGGLE_INCOGNITO,label:V({defaultMessage:"Toggle Incognito",id:"YNMg3vd9IG"}),macos:["",";"],windows:["Ctrl",";"],editable:!1},[er.SHOW_SHORTCUTS]:{type:er.SHOW_SHORTCUTS,label:V({defaultMessage:"Show Shortcuts",id:"8o6rUVckYq"}),macos:["","/"],windows:["Ctrl","/"],editable:!1},[er.FOCUS_ASK_INPUT]:{type:er.FOCUS_ASK_INPUT,label:V({defaultMessage:"Focus Ask Input",id:"RP5ybIk9wM"}),macos:["","J"],windows:["Ctrl","J"],editable:!1}},qJ=Object.values(zJ),{useSelector:$J,Provider:WJ}=du("NativeBridgeContext",e=>vi(e)),KJ=WJ,aS=$J,h0=()=>aS(e=>e.actions),YJ=()=>({defaultGlobalShortcuts:qJ,keyboardShortcutHandlers:{},authStatus:"loading",BridgeComponent:()=>null,actions:{registerShortcut:()=>jr,publishIpcMessage:jr,registerKeyboardShortcutHandler:jr,subscribeToIpcMessage:()=>()=>jr,setAuthStatus:()=>{},openExternalURL:e=>{window.open(e,"_blank")},registerDeepLinkHandler:()=>jr}});function QJ(){const{status:e}=je(),t=h0();return f.useEffect(()=>{t.setAuthStatus(e)},[t,e]),null}function XJ(){const e=aS(n=>n.BridgeComponent),t=h0();return l.jsx(e,{actions:t})}function ZJ({children:e,stateCreator:t=YJ,shouldRenderBridgeComponent:n=!0}){return l.jsxs(KJ,{initialValue:t,children:[l.jsx(QJ,{}),n&&l.jsx(XJ,{}),e]})}var g0="Tabs",[JJ]=pu(g0,[xu]),SD=xu(),[eee,oS]=JJ(g0),ED=f.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:a,orientation:o="horizontal",dir:i,activationMode:c="automatic",...u}=e,d=qC(i),[m,p]=Ml({prop:r,onChange:s,defaultProp:a??"",caller:g0});return l.jsx(eee,{scope:n,baseId:ri(),value:m,onValueChange:p,orientation:o,dir:d,activationMode:c,children:l.jsx(Hn.div,{dir:d,"data-orientation":o,...u,ref:t})})});ED.displayName=g0;var kD="TabsList",MD=f.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...s}=e,a=oS(kD,n),o=SD(n);return l.jsx(WC,{asChild:!0,...o,orientation:a.orientation,dir:a.dir,loop:r,children:l.jsx(Hn.div,{role:"tablist","aria-orientation":a.orientation,...s,ref:t})})});MD.displayName=kD;var TD="TabsTrigger",AD=f.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...a}=e,o=oS(TD,n),i=SD(n),c=RD(o.baseId,r),u=DD(o.baseId,r),d=r===o.value;return l.jsx($C,{asChild:!0,...i,focusable:!s,active:d,children:l.jsx(Hn.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...a,ref:t,onMouseDown:qn(e.onMouseDown,m=>{!s&&m.button===0&&m.ctrlKey===!1?o.onValueChange(r):m.preventDefault()}),onKeyDown:qn(e.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&o.onValueChange(r)}),onFocus:qn(e.onFocus,()=>{const m=o.activationMode!=="manual";!d&&!s&&m&&o.onValueChange(r)})})})});AD.displayName=TD;var ND="TabsContent",Ta=f.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:s,children:a,...o}=e,i=oS(ND,n),c=RD(i.baseId,r),u=DD(i.baseId,r),d=r===i.value,m=f.useRef(d);return f.useEffect(()=>{const p=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(p)},[]),l.jsx(hu,{present:s||d,children:({present:p})=>l.jsx(Hn.div,{"data-state":d?"active":"inactive","data-orientation":i.orientation,role:"tabpanel","aria-labelledby":c,hidden:!p,id:u,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:m.current?"0s":void 0},children:p&&a})})});Ta.displayName=ND;function RD(e,t){return`${e}-trigger-${t}`}function DD(e,t){return`${e}-content-${t}`}var ID=ED,tee=MD,nee=AD,ree=Ta;const see=Pe(async()=>{const{SideCanvasViewer:e}=await W(async()=>{const{SideCanvasViewer:t}=await import("./SideCanvasViewer-lneT7Z7B.js");return{SideCanvasViewer:t}},__vite__mapDeps([23,2,3,5,1,7,8,24,6,9,25,15,26,27,28,29,13,12,14,16,17]));return{default:e}}),aee=Pe(async()=>{const{SideMeetingTranscriptViewer:e}=await W(async()=>{const{SideMeetingTranscriptViewer:t}=await import("./SideMeetingTranscriptViewer-D_HJkdHn.js");return{SideMeetingTranscriptViewer:t}},__vite__mapDeps([30,2,3,5,1,6,7,8,9,15,29,12,13,14,16,17]));return{default:e}}),oee=Pe(async()=>{const{SidePDFViewer:e}=await W(async()=>{const{SidePDFViewer:t}=await import("./SidePDFViewer-DiJztL-X.js");return{SidePDFViewer:t}},__vite__mapDeps([31,2,3,28,5,1,6,7,8,9,29,13,12,14,15,16,17]));return{default:e}}),iee=Pe(async()=>{const{CitationSideSheet:e}=await W(async()=>{const{CitationSideSheet:t}=await import("./CitationSideSheet-CBfndkT_.js");return{CitationSideSheet:t}},__vite__mapDeps([32,2,3,5,1,6,7,8,9,29,13,12,14,15,16,17]));return{default:e}}),lee=Pe(async()=>{const{CheckSourcesSideSheet:e}=await W(async()=>{const{CheckSourcesSideSheet:t}=await import("./CheckSourcesSideSheet-DW1Guulu.js");return{CheckSourcesSideSheet:t}},__vite__mapDeps([33,3,2,5,1,6,7,8,9,29,34,35,15,36,13,12,14,16,17]));return{default:e}}),cee=Pe(async()=>{const{InlineNavSideSheet:e}=await W(async()=>{const{InlineNavSideSheet:t}=await import("./InlineNavSideSheet-C8fWd6Wt.js");return{InlineNavSideSheet:t}},__vite__mapDeps([37,2,3,5,1,6,7,8,9,12,14,29,15,13,16,17]));return{default:e}}),uee=Pe(async()=>{const{CouncilResponseSideSheet:e}=await W(async()=>{const{CouncilResponseSideSheet:t}=await import("./CouncilResponseSideSheet-B2hciwoB.js");return{CouncilResponseSideSheet:t}},__vite__mapDeps([38,2,3,5,1,7,8,29,6,9,13,12,14,15,16,17]));return{default:e}}),dee=Pe(async()=>{const{ClaimsSideSheet:e}=await W(async()=>{const{ClaimsSideSheet:t}=await import("./ClaimsSideSheet-tDwNVSug.js");return{ClaimsSideSheet:t}},__vite__mapDeps([39,2,3,5,1,29,6,7,8,9,13,12,14,15,16,17]));return{default:e}}),fee=A.memo(function(){const{tab:t}=vu();return l.jsxs(ID,{value:t?.name??"",className:"h-full bg-base",children:[l.jsx(Ta,{value:"citations",className:"h-full",children:l.jsx(iee,{})}),l.jsx(Ta,{value:"canvas",className:"h-full",children:l.jsx(see,{})}),l.jsx(Ta,{value:"pdf",className:"h-full",children:l.jsx(oee,{})}),l.jsx(Ta,{value:"transcript",className:"h-full",children:l.jsx(aee,{})}),l.jsx(Ta,{value:"check_sources",className:"h-full",children:l.jsx(lee,{})}),l.jsx(Ta,{value:"inline_nav",className:"h-full",children:l.jsx(cee,{})}),l.jsx(Ta,{value:"council_response",className:"h-full",children:l.jsx(uee,{})}),l.jsx(Ta,{value:"claims",className:"h-full",children:l.jsx(dee,{})})]})}),Ll=(e="sm")=>{const[t,n]=f.useState(e);f.useEffect(()=>{const c=()=>{window.innerWidth>=1536?n("2xl"):window.innerWidth>=1280?n("xl"):window.innerWidth>=1024?n("lg"):window.innerWidth>=768?n("md"):window.innerWidth>=640&&n("sm")};return window.addEventListener("resize",c),c(),()=>window.removeEventListener("resize",c)},[]);const r=!0,s=["md","lg","xl","2xl"].includes(t),a=["lg","xl","2xl"].includes(t),o=["xl","2xl"].includes(t),i=["2xl"].includes(t);return f.useMemo(()=>({breakpoint:t,isSmallScreen:r,isMediumScreen:s,isLargeScreen:a,isXLargeScreen:o,is2XLargeScreen:i}),[t,i,a,s,r,o])},mee=Pe(async()=>await W(()=>import("./lexical-BJvXVOX6.js").then(e=>e.aX),__vite__mapDeps([6,2,3,5,1,7,8,9]))),dh={wide:{maxWidth:800,xlRatio:.5,smallRatio:.6},narrow:{maxWidth:400,xlRatio:.25,smallRatio:.3},fallback:720},jD=Bt("SearchSideContainerContext",{isOpen:!1,width:dh.fallback,setWidth:()=>{},isResizing:!1,setIsResizing:()=>{},resizable:!0,size:"wide",scrollableContainerRef:{current:null}}),y0=()=>f.useContext(jD),pee=A.memo(function({children:t,isOpen:n,resizable:r=!0,size:s="wide"}){const{isXLargeScreen:a}=Ll(),[o,i]=vs("search-side-content-width",dh.fallback),c=f.useCallback(_=>{if(typeof window>"u")return dh.fallback;const v=window.innerWidth,C=dh[_];return a?Math.min(C.maxWidth,v*C.xlRatio):v*C.smallRatio},[a]),[u,d]=f.useState(()=>r&&o?o:c(s)),[m,p]=f.useState(!1),h=f.useRef(null),g=Mo(r),y=Mo(s),b=f.useCallback(_=>{d(_),r&&i(_)},[i,d,r]);f.useEffect(()=>{if(!(g!==r)&&!(y!==s))return;const C=c(s);d(r&&o||C)},[r,s,o,c,g,y]);const x=f.useMemo(()=>({isOpen:n,width:u,setWidth:b,isResizing:m,setIsResizing:p,resizable:r,size:s,scrollableContainerRef:h}),[n,u,b,m,p,r,s,h]);return l.jsx(jD.Provider,{value:x,children:t})}),hee=f.memo(function({containerRef:t}){const{setWidth:n,setIsResizing:r,isResizing:s,resizable:a}=y0(),o=f.useRef(null);f.useEffect(()=>()=>{o.current&&o.current()},[]);const i=f.useCallback(c=>{if(!a)return;c.preventDefault(),r(!0),document.body.style.userSelect="none",document.body.style.cursor="col-resize";const u=c.clientX,d=t.current?.offsetWidth??0,m=g=>{const y=g.clientX-u,b=d-y;n(b)},p=()=>{r(!1),document.body.style.userSelect="",document.body.style.cursor="",document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",h),document.removeEventListener("contextmenu",h),o.current=null},h=()=>{p()};document.addEventListener("mousemove",m),document.addEventListener("mouseup",h),document.addEventListener("contextmenu",h),o.current=p},[n,r,t,a]);return l.jsxs("div",{className:z("absolute inset-y-0 left-0 z-10 hidden xl:block",{"group cursor-col-resize":a}),children:[l.jsx("div",{className:"absolute inset-y-0 left-0 h-full w-px",children:l.jsx("div",{className:z("bg-subtle pointer-events-none absolute inset-0 origin-center",{"group-hover:bg-super duration-normal group-hover:scale-x-[250%]":a,"!bg-super scale-x-[250%] delay-0":s,"delay-0 group-hover:delay-300":!s&&a})})}),a&&l.jsxs(l.Fragment,{children:[l.jsx(Y,{variant:"background",className:z("left-half duration-quick absolute top-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full p-px group-hover:!opacity-0",{"!opacity-0 delay-0":s,"delay-0 group-hover:delay-300":!s}),children:l.jsx("div",{className:"bg-inverse w-three h-5 rounded-full opacity-20"})}),l.jsx("div",{className:"absolute top-0 h-full w-5 -translate-x-1/2 cursor-col-resize",onMouseDown:i})]})]})}),gee=f.memo(function({children:t}){const{isMobileStyle:n}=Be(),{isOpen:r,isResizing:s}=y0(),a=PD(),{isXLargeScreen:o}=Ll(),i=f.useRef(null),c=!o;return n?l.jsx(mee,{variant:"full-sheet",isOpen:r,headerClassname:"hidden",renderCloseButton:!1,wrapperClassname:"flex-1 !px-0 !pb-0",modalContentClassname:"min-h-0 !flex-1 !p-0",children:l.jsx("div",{className:"flex h-full min-h-0 flex-1 flex-col",children:t})}):l.jsxs("div",{ref:i,className:z("fixed inset-y-0 right-0 flex h-full w-[60vw] min-w-0 flex-1 flex-col text-clip border-l shadow-lg xl:border-l-0 xl:shadow-none",{"z-[100]":c,"pointer-events-none w-0 translate-x-full opacity-0":!r,"duration-normal transition-transform ease-in-out":!s}),style:{width:r&&!c?a:void 0},children:[l.jsx(hee,{containerRef:i}),l.jsx(hN,{portalTargetElement:i.current,renderModals:!1,children:t}),s&&l.jsx("div",{className:"absolute inset-0"})]})}),PD=()=>{const{width:e}=y0(),[t]=ml("isSidebarPinned",!1),[n,r]=f.useState(window.innerWidth);return f.useEffect(()=>{const s=()=>r(window.innerWidth);return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s)}},[]),f.useMemo(()=>`calc(max(500px,min(calc(100vw - ${t?720:520}px),${e/n*100}vw)))`,[e,n,t])},yee=A.memo(function({children:t}){const{isOpen:n,isResizing:r}=y0(),{isXLargeScreen:s}=Ll(),a=PD();return l.jsx("div",{className:z("flex size-full flex-1",r?"duration-0":"duration-normal ease-in-out"),style:{transitionProperty:r?"none":"padding",paddingRight:n&&s?a:void 0},children:t})}),Gk=Object.assign({},{Root:pee,Primary:yee,Secondary:gee}),OD=du("VoiceSessionStoreContext",()=>vi(e=>({isActive:!1,setIsActive:t=>e({isActive:t})}))),xee=OD.Provider,bee=()=>OD.useStore();function _ee(){const e=bee();return f.useCallback(()=>e.getState().isActive,[e])}const Mc={cacheName:{prefix:"pplx",suffix:"v2",runtime:"runtime",html:"html"}},vee=[Mc.cacheName.prefix,Mc.cacheName.html,Mc.cacheName.suffix].join("-"),Cee=[Mc.cacheName.prefix,Mc.cacheName.runtime,Mc.cacheName.suffix].join("-");async function LD(){if("serviceWorker"in navigator){await caches.delete(vee),await caches.delete(Cee);return}}const FD=1e3*60,Gx=60*FD,wee=FD/2,zk="internal-refresh",See={isOutdated:()=>!1,canRefresh:()=>!1,refresh:async()=>!1,channel:null},UD=Bt("RefreshContext",{outdated:!1,refresh:async()=>!1,canRefresh:()=>!1,channel:null}),Eee=A.memo(function({children:t,enabled:n,buildVersion:r,ref:s}){const a=sK(),o=_ee(),{env:{isLocalhost:i}}=jn(),c=f.useRef(r),u=f.useRef(!1),[d,m]=f.useState(0),p=f.useRef(null);p.current??=typeof BroadcastChannel<"u"?new BroadcastChannel(zk):null;const h=n&&u.current,g=f.useCallback(async()=>{try{const _=z$()?.comet_web_resources_extension_version;if(i||u.current||!n||!_)return;const v=_;if(Jt("build_version_refresh_check_version",{isCometSidecarClient:!0,currentVersion:r,latestVersion:v}),!r&&v){c.current=v;return}r&&v&&v!==r&&(u.current=!0,m(Date.now()+Math.random()*Gx))}catch{Z.log("Error getting build version")}},[r,n,i]),y=f.useCallback(()=>!(!h||!d||document.hidden||a()||o()||Date.now()<d),[a,o,h,d]),b=f.useCallback(async(_,v)=>{if(!h||!d)return!1;if(!v&&!y())return!0;try{await LD()}catch{Z.log("Error clearing service worker runtime cache")}try{await UN()}catch{Z.log("Error clearing persisted cache")}return Jt("build_version_refresh"),p.current?.postMessage(zk),_?oa(_,"Build version refresh (redirect)"):Jg("Build version refresh (reload)"),!1},[y,h,d]),x=f.useMemo(()=>Wg(g,wee,{maxWait:Gx,leading:!1,trailing:!0}),[g]);return f.useEffect(()=>{document.addEventListener("visibilitychange",x),window.addEventListener("focus",x),window.addEventListener("keydown",x),window.addEventListener("mousedown",x);const _=setInterval(g,Gx);return()=>{document.removeEventListener("visibilitychange",x),window.removeEventListener("focus",x),window.removeEventListener("keydown",x),window.removeEventListener("mousedown",x),clearInterval(_)}},[x,g]),f.useEffect(()=>{const _=p.current;return()=>{_&&_.close()}},[]),f.useImperativeHandle(s,()=>({isOutdated:()=>h,canRefresh:()=>y(),refresh:async _=>await b(_),channel:p.current})),l.jsx(UD.Provider,{value:f.useMemo(()=>({outdated:h,refresh:b,canRefresh:y,channel:p.current}),[h,b,y]),children:t})}),kee=()=>f.useContext(UD),Mee=2880*60*1e3,Tee=A.memo(function({buildTimestamp:t}){const{outdated:n,refresh:r,canRefresh:s,channel:a}=kee(),{openToast:o,closeToast:i}=cn(),{$t:c}=Q(),[u,d]=f.useState(!1),m=n&&s()&&Date.now()-t>=Mee;return f.useEffect(()=>{},[a,n]),f.useEffect(()=>{if(!u)return;const p=()=>{document.visibilityState==="visible"&&(i(),r(void 0,!0))};return document.addEventListener("visibilitychange",p),()=>document.removeEventListener("visibilitychange",p)},[i,r,u]),f.useEffect(()=>{m&&o({variant:"refresh",message:c({defaultMessage:"Update to latest version",id:"uJhjfhU3E7"}),description:c({defaultMessage:"Click to update",id:"b3O/fzAfH4"}),handleClick:()=>r(void 0,!0),timeout:null})},[c,o,r,m]),null}),Aee=A.memo(function(){const{message:t,variant:n,description:r,ctaText:s,ctaOnClick:a,isVisible:o,timeout:i,handleClick:c,closeToast:u,position:d,iconOverride:m,keyProp:p}=cn(),h=f.useCallback(()=>{n==="refresh"&&c===void 0?window.location.reload():c&&c()},[n,c]);return l.jsx(fl,{keyProp:p,isVisible:o,variant:n,message:t,description:r,ctaText:s,ctaOnClick:a,timeout:i,handleClick:h,onTimeout:u,position:d,iconOverride:m},p)});function Nee(e={}){const{isMobileStyle:t,isMobileUserAgent:n}=Be(),{isSidecarBuild:r="1",isInlineAssistantBuild:s=""}=e;return f.useMemo(()=>({isMobileStyle:r||s?!1:t,isMobileUserAgent:n}),[t,n,r,s])}const Ree=A.memo(function({children:t,colorScheme:n,logger:r,getSpriteUrl:s,renderModals:a}){const{isMobileStyle:o,isMobileUserAgent:i}=Nee();return l.jsx(hN,{isMobileStyle:o,isMobileUserAgent:i,renderModals:a,logger:r,children:l.jsx(WW,{src:s,children:l.jsx(g$,{initialOverrideColorScheme:n,children:l.jsxs(lX,{children:[t,l.jsx(Aee,{})]})})})})});Pe(async()=>{const{RenderToolbar:e}=await W(async()=>{const{RenderToolbar:t}=await import("./_restricted/restricted-feature-debug-Bs-dEIow.js").then(n=>n.R);return{RenderToolbar:t}},__vite__mapDeps([22,2,3,12,1,9,5,7,8]));return{default:e}},{restricted:!0});Pe(async()=>{const{ReactQueryDevtools:e}=await W(async()=>{const{ReactQueryDevtools:t}=await import("./react-query-r7hDIr5f.js").then(n=>n.j);return{ReactQueryDevtools:t}},__vite__mapDeps([12,2,3,1,9,5,7,8]));return{default:e}});const Dee=Pe(async()=>{const{DebugModeActivator:e}=await W(async()=>{const{DebugModeActivator:t}=await import("./DebugModeActivator-Di8Qveoa.js");return{DebugModeActivator:t}},__vite__mapDeps([40,2,3,22,12,1,9,5,7,8]));return{default:e}},{restricted:!0}),Iee=Pe(async()=>({default:(await W(()=>import("./IncentiveProModal-CU3Nq6F3.js"),__vite__mapDeps([41,2,3,5,1,6,7,8,9,12,13,14,15,16,17]))).default})),jee=Pe(async()=>({default:(await W(()=>import("./BraintreeSubscriptionModal-CYzJQayA.js"),__vite__mapDeps([42,2,3,12,1,9,5,7,8,6,43,15,13,14,16,17]))).default})),Pee=({children:e,hostname:t,buildTimestamp:n,buildVersion:r,buildVersionRefresh:s,spaRoutes:a,shouldOpenNonSpaRouteInNewTab:o,base:i,nativeBridgeStateCreator:c})=>{const u=sr(),d=f.useRef(See),{env:{isSingleTenant:m}}=jn(),{status:p}=je();if(m){if(p==="loading")return null;if(p==="unauthenticated")return oa("/auth/signin","Single tenant requires login"),null}return l.jsx(Hq,{ssrPath:u??"/",ssrSearch:"",base:i,children:l.jsx(Vq,{spaRoutes:a,openNonSpaRouteInNewTab:o,appRef:d,children:l.jsx(Lee,{children:l.jsxs(MJ,{children:[l.jsx(wY,{}),l.jsxs(YW,{buildVersion:r,allowPersist:!0,children:[l.jsx(Ree,{logger:Z,renderModals:!1,children:l.jsx(IX,{children:l.jsxs(EY,{hostname:t,children:[l.jsx(nQ,{}),l.jsx(BJ,{}),l.jsx(LJ,{}),l.jsx(xY,{children:l.jsx(aK,{children:l.jsx(sX,{children:l.jsx(vZ,{shouldFetchSettings:!0,children:l.jsx(qK,{children:l.jsx(CJ,{shouldFetchSettings:!1,children:l.jsx(ZJ,{stateCreator:c,children:l.jsx(tQ,{children:l.jsx(wD.Provider,{value:{IncentiveProModal:Iee,BraintreeSubscriptionModal:jee},children:l.jsx(xee,{children:l.jsx(YK,{children:l.jsx(QK,{children:l.jsx(CY,{children:l.jsxs(Oee,{children:[l.jsx(Eee,{buildVersion:r,enabled:s,ref:d,children:l.jsx(Tee,{buildTimestamp:n})}),l.jsx(IJ,{}),l.jsx(uQ,{}),l.jsx(TJ,{}),l.jsx(sQ,{}),l.jsx(jJ,{}),l.jsx(Dee,{}),e,l.jsx(y$,{logger:Z})]})})})})})})})})})})})})})})]})})}),!1]})]})})})})},Oee=({children:e})=>{const{tab:t}=vu();return l.jsxs(Gk.Root,{isOpen:!!t,resizable:t?.resizable,size:t?.size,children:[e,l.jsx(Gk.Secondary,{children:l.jsx(fee,{})})]})},Lee=({children:e})=>{const{startTimeFromTimeOriginRef:t}=hn();return l.jsx(Gq,{startTimeFromTimeOriginRef:t,children:e})},Fee=["49a618ae-2fee-4bac-9150-81c466a49187"];function Uee(e){let t=e;t=t.replace(/^\^/,"").replace(/\$$/,""),t=t.replace(/\\\//g,"/");const n=[],r=t.match(/^\/\(([^)]+\|[^)]+)\)/);if(r){const h=r[1]?.split("|").map(g=>`/${g}`);n.push({type:"alternation",value:"",optional:!1,alternatives:h}),t=t.substring(r[0].length)}else{const h=t.match(/^([^(]+)/);if(h&&h[1]){const g=h[1];n.push({type:"literal",value:g,optional:!1}),t=t.substring(g.length)}}let s=t,a=0,o=0;const i=100;for(;s.length>0&&o++<i;){const h=s.match(/^\(\?:\/\(\?<(\w+)>([^)]+)\)\)\?/);if(h){const[v,C,w]=h,S=w===C;n.push({type:S?"literal":"param",value:S?`/${C}`:`/:${C}`,optional:!0,paramName:S?void 0:C}),s=s.substring(v.length);continue}const g=s.match(/^\(\?:\/\(\?<(\w+)>([^)]+)\)\)/);if(g){const[v,C,w]=g,S=w===C;n.push({type:S?"literal":"param",value:S?`/${C}`:`/:${C}`,optional:!1,paramName:S?void 0:C}),s=s.substring(v.length);continue}const y=s.match(/^\/?\(([^)]+)\)\?/),b=s.match(/^\(\?:\/\(([^)]+)\)\)\?/),x=y||b;if(x){const[v]=x;a++,n.push({type:"param",value:`/:param${a}`,optional:!0,paramName:`param${a}`}),s=s.substring(v.length);continue}const _=s.match(/^\/?\?+/);if(_&&_[0].length>0){s=s.substring(_[0].length);continue}break}const c=[],u=n.find(h=>h.type==="alternation"),d=n.filter(h=>h.type!=="alternation"),m=u?u.alternatives.map(h=>`/${h}`):[""];for(const h of m){const g=d.filter(_=>_.optional),y=d.filter(_=>!_.optional),b=g.some(_=>_.paramName?.startsWith("param"));if(g.every(_=>_.paramName?.startsWith("param"))&&b){const _=g.length;for(let v=0;v<=_;v++){let C=h;for(const w of y)C+=w.value;for(let w=0;w<v;w++)C+=g[w]?.value??"";C=C.replace(/\/+/g,"/"),C=C.replace(/\/\?/g,""),C=C||"/",c.push(C)}}else{const _=g.length,v=Math.pow(2,_);for(let C=0;C<v;C++){let w=h;for(const S of y)w+=S.value;for(let S=0;S<_;S++)C&1<<S&&(w+=g[S]?.value??"");w=w.replace(/\/+/g,"/"),w=w.replace(/\/\?/g,""),w=w||"/",c.push(w)}}}return[...new Set(c)].sort((h,g)=>{const y=h.split("/").filter(Boolean),b=g.split("/").filter(Boolean);if(y.length!==b.length)return b.length-y.length;for(let x=0;x<y.length;x++){const _=y[x]?.startsWith(":"),v=b[x]?.startsWith(":");if(_&&!v)return 1;if(!_&&v)return-1;if(y[x]!==b[x])return y[x].localeCompare(b[x])}return 0})}const Bee="x-ppl-region";let qk=!1;const Hee=performance.now(),$k="pub4ecf63e3fd1ad28de1a9027c01181601",Vee="4705c1a2-db1e-42f0-8a66-cd6208ae9e65";function BD({bootstrapConfig:e,user:t,routes:n,base:r=""}){if(qk||typeof document>"u")return;const a=e.version,o=e.env??"local",i=ul(),c=t?.email?.endsWith("@perplexity.ai"),u=o==="local",d=o==="testing"||u||i||c?100:1,m=u||c?100:0;if(!Fee.includes(t?.org_uuid??"")){zq({applicationId:Vee,clientToken:$k,version:a,env:o,debug:u,sessionSampleRate:100,sessionReplaySampleRate:m,beforeSend:(g,y)=>{if(g.context&&Gee(y,g)){const b=y.response?.headers?.get(Bee);b&&(g.context.region=b);const x=y.response,_=x?$q(x):void 0;_&&(g.context.normalizedPath=_)}if(n&&g.view.url&&g.context)try{const b=new URL(g.view.url).pathname,x=Wq(b,r),_=L5(n,x);if(_)if(_.route.startsWith("^")){const v=L5(Uee(_.route),x);v&&(g.context.normalizedName=F5(v.route,r))}else g.context.normalizedName=F5(_.route,r)}catch{}return!0}}),qq({clientToken:$k,version:a,env:o,debug:u,sessionSampleRate:d});const h=typeof navigator<"u"&&"serviceWorker"in navigator&&!!navigator.serviceWorker.controller;if(P5({useServiceWorker:h,webResourcesBuild:"2026.2.6.257"}),O5({useServiceWorker:h,webResourcesBuild:"2026.2.6.257"}),i){const g={cometAgentExtensionVersion:i?.agent_extension_version,cometDeviceId:i.device_id,cometMainExtensionVersion:i.extension_version,cometVersion:i?.browser_version,erp:e.erp,cometAndroidVersion:i?.android_version,cometIosVersion:i?.ios_version};P5(g),O5(g)}Is("web.frontend.module_exec_start",{startTime:eN(),duration:Hee})}qk=!0}function Gee(e,t){return t.type==="resource"&&t.resource.type==="fetch"&&"response"in e}const HD="^\\/search(?:\\/(?<new>new))?(?:\\/(?<uuid>.+))?$",VD=["ask-input"],zee=["thread-title"],qee=e=>{const t=[];if(!e)return t;const n=r=>{if(r.type==="mention"){const a=r.props;a.variant==="source"&&t.push(a.uuid)}"children"in r&&Array.isArray(r.children)&&r.children.forEach(n)};return n(e),t},GD=e=>{const t=[];if(!e)return{dslQuery:void 0,mentions:t};let n=0;const r=s=>{let a="";if(s.type==="text"&&"text"in s)a=s.text;else if(s.type==="linebreak")a=`
`;else{if((s.type==="link"||s.type==="autolink")&&"url"in s)return a=`[${"children"in s&&Array.isArray(s.children)&&s.children.map(r).reduce((i,c)=>(i+=c,i),"")||""}](${s.url})`,a;if(s.type==="mention"){const i=s.props;if(i.variant==="tab")return t.push({id:i.uuid,url:i.url??"",type:i.variant}),n++,a=`<attachment citation_id="${n}" />`,a;if(i.variant==="space")return t.push({id:i.uuid,url:"",type:i.variant}),a="",a;if(i.variant==="shortcut")return t.push({id:i.uuid,url:"",type:i.variant}),a=i.queryText??"",a;if(i.variant==="source")return t.push({id:i.uuid,url:"",type:"sources"}),a="",a}}return"children"in s&&Array.isArray(s.children)?s.children.map(r).reduce((o,i)=>(o+=i,o),a):a};return{dslQuery:r(e)||void 0,mentions:t}};function zD({onSubmit:e,immediate:t=!0}){const n=_D(),r=vD(),s=CD(),a=AJ(),{setUserInput:o,setHasStartedTyping:i,setStartTypingTime:c,markInputAsSubmitted:u}=p0(),d=f.useRef(!1);f.useEffect(()=>()=>{d.current&&(u(),d.current=!1)},[u,t]);const m=f.useCallback(h=>{Z.info("ask input submitted");const g=a?performance.now()-a:void 0,{dslQuery:y,mentions:b}=GD(h.json?.root);e?.({timeFromFirstType:g,...h,dslQuery:y,mentions:h.mentions??b}),t?u():d.current=!0},[t,u,e,a]),p=f.useCallback((h,g)=>{!s&&h&&i(!0),a||c(performance.now()),o(h,g)},[s,o,i,a,c]);return[n,r,f.useMemo(()=>({onChange:p,onSubmit:m,setUserInput:o}),[p,m,o])]}const iS=3e3;function $ee({handleSubmitQuery:e,isHomepage:t,contextUuid:n,disableSideBySide:r=!1}){const{isEnabled:s,sbsVariations:a,incrementTriggerCount:o}=BZ({frontendContextUUID:n,disableSideBySide:r});return f.useCallback(c=>{s?(o(),a.forEach(u=>{const{experiment_override:d,sibling_uuid:m,experiment_role:p}=u,g={...c,newFrontendContextUUID:n,side_by_side_metadata:{experiment_role:p,sibling_uuid:m,experiment_override:d,selection_status:"SELECTION_STATUS_UNSPECIFIED",execution_log:{}}};e(g)})):e(c)},[e,s,a,o,t,n])}const Wee=()=>{const{session:e}=je(),{trackEvent:t}=Ze(e),n=hn(),r="clicked spaces ad",s=f.useCallback(async o=>{o.preventDefault(),t(r,{source:"createSpaceSidebar"}),n.push("/spaces/templates")},[t,n]),a=f.useCallback(async()=>{t("space mentioned in query"),$Y()},[t]);return f.useMemo(()=>({handleCreateSpaceSidebarAdClick:s,handleSubmitQueryWithMention:a}),[s,a])};function Kee({collection:e,onSubmit:t,redirectToNewThread:n=!0,csrRedirect:r=!1}){const{$t:s}=Q(),{submitQuery:a}=ya(),{clear:o}=u0(),i=hn(),c=ns(),{handleSubmitQueryWithMention:u}=Wee(),d=f.useMemo(()=>wo(),[]),m=f.useCallback(v=>{const C=v.query?.trim();if(!C)return;t?.(v),v.mentions&&v.mentions.some(E=>E.type==="space")&&u();const w=v.newFrontendContextUUID??wo(),S=wo();n&&(o(),a({rawQuery:C,dslQuery:v.dslQuery,mentions:v.mentions,attachments:v.attachments,collection:e||null,newFrontendContextUUID:w,promptSource:v.promptSource||"user",querySource:v.querySource,timeFromFirstType:v.timeFromFirstType,modelPreferenceOverride:v.modelPreferenceOverride,browserAgentAllowOnceFromToggle:v.browserAgentAllowOnceFromToggle,forceEnableBrowserAgent:v.forceEnableBrowserAgent,shouldRedirectToBackendUUID:!r,...v.side_by_side_metadata&&{side_by_side_metadata:v.side_by_side_metadata},frontendUUID:S,...v.canonicalPageContext&&{canonicalPageContext:v.canonicalPageContext},onThreadSlugReceived:E=>{if(!r)return;const T=window.location.pathname;T.startsWith(`${i.base}/search/`)&&sN(T.split("/").pop())&&i.replace(`/search/${E}`,"Home ask input")}}),r&&i.push(`/search/new/${S}`,void 0,"Home ask input"))},[t,n,o,a,e,r,i,u]),p=$ee({handleSubmitQuery:m,isHomepage:!0,contextUuid:d}),h=f.useRef(!1),g=f.useCallback(v=>{h.current||(h.current=!0,setTimeout(()=>h.current=!1,iS),p(v))},[p]),[y,b,x]=zD({onSubmit:g,immediate:!r}),_=s(Yn[c].askInputPlaceholder);return[y,b,f.useMemo(()=>({...x,placeholder:_}),[x,_])]}const lS=du("AskInputContext",()=>vi((e,t)=>({activeMenu:null,fileUploadUpsellTooltipOpen:!1,suggestions:_e,blankStateSuggestions:{[K.SEARCH]:null,[K.RESEARCH]:null,[K.STUDIO]:null,[K.STUDY]:null,[K.AGENTIC_RESEARCH]:null,[K.BROWSER_AGENT]:null,[K.ASI]:null},showSuggestDropdown:!1,browserAgentAllowOnceFromToggle:!1,forceEnableBrowserAgent:!1,actions:{onActiveMenuChange:n=>{e({activeMenu:n})},setFileUploadUpsellTooltipOpen:n=>{e({fileUploadUpsellTooltipOpen:n})},setSuggestions:n=>{e({suggestions:n})},setBlankStateSuggestions:(n,r)=>{const s=t().blankStateSuggestions;e({blankStateSuggestions:{...s,[r]:n}})},setShowSuggestDropdown:n=>{e({showSuggestDropdown:n})},setBrowserAgentAllowOnce:n=>{e({browserAgentAllowOnceFromToggle:n})},setForceEnableBrowserAgent:n=>{e({forceEnableBrowserAgent:n})}},inputRef:f.createRef()}))),x0=lS.Provider,Yee=lS.useSelector,Qee=lS.useTrackedState,Fs=()=>Yee(e=>e.actions),Fr=Qee,Xee=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"sidecar-privacy-education",defaultValue:e,extraAttributes:t,subjectType:"comet_device_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},cS=Bt("ScrollContainerRefContext",null),Zee=({children:e,scrollContainerRef:t})=>l.jsx(cS.Provider,{value:{scrollContainerRef:t},children:e}),xa=()=>{const e=f.useContext(cS);if(!e)throw new Error("useScrollContainerRef must be used within a ScrollContainerRefProvider");return e},qD=Bt("AppLayoutContext",void 0),rYe=()=>{const e=f.useContext(qD);if(!e)throw new Error("useAppLayout must be used within an AppLayoutProvider");return e},Jee=({children:e})=>{const[t,n]=f.useState(!1);return l.jsx(qD.Provider,{value:{isMobileSidebarOpen:t,setMobileSidebarOpen:n},children:e})},Wk=200,ete=()=>{const{locale:e}=Q();return GW(e)==="rtl"};Pe(async()=>{const{MobileSidebar:e}=await W(async()=>{const{MobileSidebar:t}=await import("./MobileSidebar-BlLqXRpg.js");return{MobileSidebar:t}},__vite__mapDeps([44,2,3,6,5,1,7,8,9,13,12,14,15,16,17]));return{default:e}});Pe(async()=>{const{MobileProductHeader:e}=await W(async()=>{const{MobileProductHeader:t}=await import("./MobileProductHeader-CyOpNu6b.js");return{MobileProductHeader:t}},__vite__mapDeps([45,2,3,5,1,46,9,7,8,6,13,12,14,15,16,17]));return{default:e}});const tte=({children:e,ref:t})=>{const n=f.useRef(null);return l.jsx(Jee,{children:l.jsx(Zee,{scrollContainerRef:n,children:l.jsx(Y,{variant:"background",children:l.jsx("div",{className:"isolate flex h-dvh",ref:t,children:e})})})})},nte=({children:e,fillHeight:t=!0,ref:n,banner:r})=>{const[s]=ml("isSidebarPinned",!1),{isMobileStyle:a}=Be({evaluateOnInit:!0}),o=s&&!a,i=ete(),c=f.useMemo(()=>i?{paddingRight:o?Wk:0}:{paddingLeft:o?Wk:0},[i,o]);return l.jsxs("div",{style:{...c,transition:"padding-left 0.2s cubic-bezier(0.16, 1, 0.3, 1), padding-right 0.2s cubic-bezier(0.16, 1, 0.3, 1)"},className:"erp-tab:p-0 erp-tab:gap-0 isolate flex h-auto max-h-screen min-w-0 grow flex-col",ref:n,children:[r,l.jsxs(Y,{variant:"background",className:"@container/main relative isolate min-h-0 flex-1 overflow-clip bg-clip-border",children:[l.jsx("div",{className:z("mx-auto flex w-full flex-col",{"h-full":t}),children:e}),l.jsx(Y,{className:"rounded-inherit pointer-events-none absolute inset-0 z-20 hidden md:dark:block md:!border-y-0 md:!border-r-0"})]})]})},$D=({children:e,className:t,childrenWidth:n,containerClassName:r=""})=>{const{isMobileUserAgent:s}=Be(),a=Va(n).with("small",()=>"max-w-screen-sm px-md md:px-lg").with("default",()=>"max-w-screen-md px-md md:px-lg").with("static",()=>"max-w-screen-lg px-md py-lg md:px-xl").with("large",()=>"max-w-threadWidth px-md md:px-lg").with("none",()=>"max-w-none").otherwise(()=>"max-w-screen-md px-md md:px-lg"),i=f.useContext(cS)?.scrollContainerRef;return l.jsx("div",{ref:i,className:z("scrollable-container flex flex-1 basis-0 overflow-auto [scrollbar-gutter:stable]",{"scrollbar-subtle":!s},t),children:l.jsx("div",{className:z("mx-auto size-full",a,r),children:e})})},rte=({children:e,fixed:t=!1})=>{const[n,r]=f.useState(!1),{scrollContainerRef:s}=xa();return f.useLayoutEffect(()=>{const a=s?.current;if(!a)return;a.scrollTop>0&&r(!0)},[s]),f.useEffect(()=>{const a=s?.current;if(!a)return;const o=()=>{const u=a.scrollTop;r(u>0)},c=a===document.documentElement?window:a;return c.addEventListener("scroll",o,{passive:!0}),()=>c.removeEventListener("scroll",o)},[s]),l.jsxs(l.Fragment,{children:[e,l.jsx("div",{className:z("border-subtlest top-headerHeight pointer-events-none inset-x-0 z-[2] h-px border-b transition-opacity duration-200",t?"fixed":"absolute"),style:{opacity:n?1:0}})]})},ste=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"cf-ping",defaultValue:e,extraAttributes:t,subjectType:"user_nextauth_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},fh="/rest/thread/list_recent";async function ate({reason:e}){try{const{error:t}=await ve.GET("/rest/ping",e);if(t)throw t;return}catch(t){Z.error("Failed to ping.",t);return}}async function ote({reason:e}){try{const{data:t,error:n,response:r}=await ve.GET("/rest/thread/list_recent",e);if(n||!t)throw new Ue("API_CLIENTS_ERROR",{cause:n,status:r.status??0});return t}catch(t){throw Z.error("Failed to get recent threads.",t),t}}const ite=({reason:e})=>{const{variation:t}=ste(!1),n=f.useRef(t);n.current=t;const{isIncognito:r}=f0({reason:e}),{inFlightLatest:s}=Ht(),{session:a}=je(),o=a?.user?.email,{data:i,refetch:c,isLoading:u}=gt({queryKey:Se.makeQueryKey(fh,o),queryFn:async()=>{if(!o||r)return _e;const d=await ote({reason:e});return n.current&&ate({reason:e}),d}});return f.useEffect(()=>{s||c({cancelRefetch:!1})},[s,c]),f.useMemo(()=>!o||r?{data:[],isLoading:!1}:{data:i??_e,isLoading:u},[i,o,r,u])};function lte({reason:e}){const{data:t,isLoading:n}=ite({reason:e}),r=oK();return f.useMemo(()=>{const s=new Set(r.map(o=>o.id)),a=new Set(r.filter(o=>o.slug!==null).map(o=>o.slug));return{isLoading:n,data:[...r.filter(o=>!t.some(i=>i.link.split("/").pop()===o.slug)).filter(o=>!t.some(i=>i.uuid===o.id)).filter(o=>o.slug!==null).map(o=>({uuid:o.id,variant:"thread",link:`/search/${o.slug}`,title:o.title??"",isStreaming:!0,unread:!1})),...t.map(o=>({...o,isStreaming:s.has(o.uuid)||a.has(o.link.split("/").pop())||o.status==="pending"}))]}},[t,r,n])}const cte=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"close-sidecar-on-open-in-new-tab",defaultValue:e,extraAttributes:t,subjectType:"visitor_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},ute=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"sidecar-back-to-thread-button",defaultValue:e,extraAttributes:t,subjectType:"visitor_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},WD={searchTerm:"",updateUserInput:e=>{}},dte=Bt("UserInputStateContext",WD),KD=()=>{const e=f.useContext(dte);return e||WD},fte=async({entryUUIDs:e,rwToken:t,reason:n})=>{const{error:r,response:s}=await ve.DELETE("/rest/thread",n,{body:{entry_uuids:e,read_write_token:t??""}});if(r)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to delete threads",cause:r,status:s.status??0})},mte=async({entryUUID:e,rwToken:t,callback:n,reason:r})=>{n?.();const{error:s,response:a}=await ve.DELETE("/rest/thread/delete_thread_by_entry_uuid",r,{body:{entry_uuid:e,read_write_token:t??""}});if(s)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to delete thread",cause:s,status:a.status??0})},pte=async({backendUUID:e,url:t,rwToken:n,reason:r})=>{if(!n)return;const{data:s,error:a,response:o}=await ve.PUT("/rest/thread/entry/remove_widget",r,{timeoutMs:Ct(),body:{entry_uuid:e,read_write_token:n,url:t}});if(a)throw new Ue("API_CLIENTS_ERROR",{message:"Error removing widget from entry",cause:a,status:o.status??0});return s},hte=async({contextUUID:e,reason:t})=>{const{data:n,error:r,response:s}=await ve.POST("/rest/thread/mark_viewed/{context_uuid}",t,{params:{path:{context_uuid:e}},timeoutMs:Ct(),numRetries:1});if(r)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to mark thread as viewed",cause:r,status:s.status??0});return n},sYe=async({contextUUID:e,action:t,rwToken:n,reason:r})=>{const{data:s,error:a,response:o}=await ve.POST("/rest/thread/reply/simulated",r,{body:{context_uuid:e,read_write_token:n,action:t},timeoutMs:hs.HIGH});if(a)throw new Ue("API_CLIENTS_ERROR",{message:"Error simulating turn",cause:a,status:o.status??0});if(!s)throw new Ue("API_CLIENTS_ERROR",{message:"No data returned from reply simulated",status:0});const i={...s.message,parent_info:s.message.parent_info||{}};return{...s,message:i}};function G2(e){return e&&"is_widget"in e&&e.is_widget===!0}function gte(e){return e&&"card_type"in e}function Kk(e){return"is_code_interpreter"in e&&e.is_code_interpreter===!0&&e.is_image===!0}const uS=({reason:e})=>{const t=It(),{searchTerm:n}=KD(),r=m0({search_term:n??""}),s=vR(),a=iK(),o=lK(),i=qf(),c=PR(),u=Mi(),{mutate:d}=on({mutationKey:["removeWidget"],mutationFn:async({entryUUID:g,data:y})=>G2(y)&&y.url?pte({backendUUID:g,url:y.url,rwToken:u,reason:e}):Promise.resolve(),onMutate:async({entryUUID:g,data:y})=>{await t.cancelQueries({queryKey:Se.makeQueryKey("results")}),c(g,b=>G2(y)?{...b,widget_data:b.widget_data?.filter(x=>x.url!==y.url)}:b)}}),{mutate:m}=on({mutationFn:async g=>{try{const{error:y,response:b}=await ve.DELETE("/rest/thread/delete_all_threads",e,{body:{delete_all:g==="all"},timeoutMs:0});if(y)throw new Ue("API_CLIENTS_ERROR",{cause:y,status:b.status??0})}catch(y){Z.error(y)}},onMutate:async g=>{await t.cancelQueries({queryKey:r}),await t.cancelQueries({queryKey:lr()});const y=t.getQueryData(r),b=t.getQueryData(lr()),x=[];return g==="all"?(t.setQueryData(lr(),_=>{_=_||{pages:[],pageParams:[]};const v=_.pages.map(C=>C.map(w=>({...w,thread_count:0})));return{..._,pages:v}}),t.setQueryData(r,_=>({..._,pages:[]}))):g==="standalone"&&t.setQueryData(r,_=>({..._,pages:_.pages.map(v=>v.filter(C=>C.collection?.uuid?!0:(x.push(C.uuid),!1)))})),{previousThreads:y,previousCollections:b,deletedUUIDs:x}},onSettled:(g,y,b,x)=>{y?(t.setQueryData(r,x?.previousThreads),t.setQueryData(lr(),x?.previousCollections)):(t.invalidateQueries({queryKey:r}),t.invalidateQueries({queryKey:lr()}),t.invalidateQueries({queryKey:Fx()}),t.invalidateQueries({queryKey:Se.makeQueryKey(fh)}),b==="all"?(s(),i.getState().threads.forEach(_=>o(_.id))):b==="standalone"&&x?.deletedUUIDs.forEach(_=>{a(_),s(_)}))}}),{mutate:p}=on({mutationFn:async({entryUUID:g,callback:y})=>{y?.(),await mte({entryUUID:g,rwToken:u,callback:y,reason:e})},onMutate:async({entryUUID:g,collectionSlug:y})=>{await t.cancelQueries({queryKey:r}),await t.cancelQueries({queryKey:lr()});const b=t.getQueryData(r),x=t.getQueryData(lr());return t.setQueryData(r,_=>{_=_||{pages:[],pageParams:[]};const v=_.pages.map(C=>C.filter(w=>w.uuid!==g));return{..._,pages:v}}),y&&(t.setQueryData(lr(),_=>{_=_||{pages:[],pageParams:[]};const v=_.pages.map(C=>C.map(w=>w.slug===y?{...w,thread_count:(w.thread_count??0)-1}:w));return{..._,pages:v}}),t.setQueryData(Fx({collection_slug:y}),_=>{_=_||{pages:[],pageParams:[]};const v=_.pages.map(C=>C.filter(w=>w.uuid!==g));return{..._,pages:v}})),{previousThreads:b,previousCollections:x}},onSettled:(g,y,{entryUUID:b},x)=>{y?(t.setQueryData(r,x?.previousThreads),t.setQueryData(lr(),x?.previousCollections)):(t.invalidateQueries({queryKey:r}),t.invalidateQueries({queryKey:lr()}),t.invalidateQueries({queryKey:Fx()}),t.invalidateQueries({queryKey:Se.makeQueryKey(fh)}),a(b),s(b))}}),{mutate:h}=on({mutationFn:async({entryUUIDs:g,callback:y})=>{y?.(),await fte({entryUUIDs:g,rwToken:u,reason:e})},onMutate:async({entryUUIDs:g})=>{await t.cancelQueries({queryKey:r});const y=t.getQueryData(r),b=t.getQueryData(lr());return t.setQueryData(r,x=>{x=x||{pages:[],pageParams:[]};const _=x.pages.map(v=>v.filter(C=>!g.includes(C.uuid)));return{...x,pages:_}}),{previousThreads:y,previousCollections:b}},onSettled:(g,y,{entryUUIDs:b},x)=>{y?t.setQueryData(r,x?.previousThreads):(t.invalidateQueries({queryKey:r}),t.invalidateQueries({queryKey:Se.makeQueryKey(fh)}),b.forEach(_=>{a(_),s(_)}))}});return f.useMemo(()=>({removeWidgetFromEntry:d,deleteAllThreads:m,deleteThread:p,deleteThreads:h}),[m,p,h,d])};function yte(){const e=aS(a=>a.defaultGlobalShortcuts),[t,n]=vs(VJ,GJ),r=f.useCallback((a,o,i)=>n(c=>({...c,[a]:{...c[a]||{},[o]:i}})),[n]);return{globalShortcuts:f.useMemo(()=>Object.fromEntries(e.map(a=>[a.type,{[Rn.MACOS]:t[a.type]?.[Rn.MACOS]||a.macos,[Rn.WINDOWS]:t[a.type]?.[Rn.WINDOWS]||a.windows}])),[e,t]),setShortcut:r,defaultGlobalShortcuts:e}}const xte={Meta:"",Alt:"",Shift:"",ArrowUp:"",ArrowDown:"",ArrowLeft:"",ArrowRight:"",Enter:"",Period:".",Semicolon:";",Slash:"/",Escape:"Esc"},bte={"":"Meta","":"Alt","":"Shift","":"ArrowUp","":"ArrowDown","":"ArrowLeft","":"ArrowRight","":"Enter"},_te=(e,t=Rn.MACOS)=>e==="Meta"?t===Rn.WINDOWS?"Win":"":xte[e]||e,aYe=e=>e==="Win"?"Meta":bte[e]||e,YD=/\[([^\]]+)\]\(((?:\([^)]*\)|[^()])*)\)/g,vte=e=>e?e.replace(YD,"$1"):"",Cte=e=>{if(!e)return{displayTitle:"",links:[]};const t=[];let n="",r=0,s=0,a;const o=new RegExp(YD);for(;(a=o.exec(e))!==null;){const i=a[1],c=a[2],u=a.index;if(n+=e.substring(r,u),s+=u-r,i){const d=s;n+=i,s+=i.length;const m=s;c&&t.push({url:c,startOffset:d,endOffset:m})}r=o.lastIndex}return n+=e.substring(r),{displayTitle:n,links:t}},wte=A.memo(function(){const t=Xt(),{inFlight:n}=Ht(),{$t:r}=Q(),{session:s}=je(),{trackEvent:a}=Ze(s),o=f.useCallback(async()=>{const i=t.getStore().getState().sidecarSourceTab.tabId;a("sidecar button clicked",{buttonType:"back_to_thread"}),await t.moveSidecarToThread(i)},[t,a]);return l.jsx(at,{variant:"text",size:"small",disabled:n,icon:D("arrow-bar-to-left"),"aria-label":r({defaultMessage:"Back to thread",id:"C1eDCaAWRL",description:"Return sidecar query to the thread tab."}),onClick:o})}),Ste=5,Ete=()=>{const{device:{isMacOS:e}}=jn(),{globalShortcuts:{[er.NEW_THREAD]:t},defaultGlobalShortcuts:n}=yte(),r=e?Rn.MACOS:Rn.WINDOWS,s=f.useMemo(()=>{const o=t?.[r];if(o&&o.length>0)return o;const i=n.find(c=>c.type===er.NEW_THREAD);return i?i[r]:Kq},[r,t,n]),a=f.useMemo(()=>(s??[]).map(o=>_te(o,r)),[s,r]);return f.useMemo(()=>a.join(e?"":"+"),[e,a])},kte=A.memo(function(){const{$t:t}=Q(),{session:n}=je(),{trackEvent:r}=Ze(n),s=hn(),a=Ete(),o=f.useCallback(()=>{r("sidecar button clicked",{buttonType:"new_thread"}),s.push("/")},[r,s]),i=a?`${t({defaultMessage:"New thread",id:"ITYqY7w9pw"})} (${a})`:t({defaultMessage:"New thread",id:"ITYqY7w9pw"});return l.jsx(at,{variant:"text",size:"small",icon:D("pencil-plus"),"aria-label":i,onClick:o})}),Mte=A.memo(function({ref:t,disableOpenInTab:n}){const{$t:r}=Q(),{data:s,isLoading:a}=lte({reason:"sidecar-controls-library"}),{session:o}=je(),{trackEvent:i}=Ze(o),{inFlight:c,results:u}=Ht(),{deleteThread:d}=uS({reason:"sidecar-controls-library"}),m=sr(),p=hn(),[h,g]=f.useState(()=>new Set),y=Xt(),b=Sn(),{variation:x}=cte(!1),_=f.useMemo(()=>(s??[]).filter(E=>!h.has(E.uuid)).slice(0,Ste),[s,h]),v=f.useCallback(E=>{i("sidecar button clicked",{buttonType:"delete_thread"}),g(T=>new Set([...T,E.uuid])),d({entryUUID:E.uuid,callback:()=>{E.link===m&&p.push("/")}})},[d,m,p,i]),C=f.useCallback(async()=>{const E=b.sidecarSourceTab.tabId;x&&y.closeSideCar({tabId:E}).catch(()=>{}),y.openNewTab(location.href),i("sidecar button clicked",{buttonType:"open_in_tab"})},[y,i,x,b.sidecarSourceTab.tabId]),w=f.useCallback(()=>{i("sidecar library clicked",{type:"opened"}),i("sidecar button clicked",{buttonType:"library"})},[i]),S=f.useMemo(()=>s?.find(E=>!h.has(E.uuid)&&(E.link===m||u.some(T=>T.backend_uuid===E.uuid))),[s,h,m,u]);return l.jsxs(Qe,{triggerElement:l.jsx(at,{variant:"text",size:"small",disabled:a||!s.length,icon:D("dots"),"aria-label":r({defaultMessage:"Menu",id:"/wFZYLAHuk",description:"Show Perplexity threads library."}),ref:t}),minWidthPx:240,maxWidthPx:240,maxHeightPx:400,align:"end",onOpen:w,children:[!n&&l.jsxs(l.Fragment,{children:[l.jsx(Qe.Item,{disabled:c,leadingAccessory:D("external-link"),onSelect:C,children:r({defaultMessage:"Open in new tab",id:"Kl9f3MwImT",description:"Open the Perplexity sidebar in a new tab."})}),S&&l.jsx(Qe.Item,{leadingAccessory:D("trash"),onSelect:()=>v(S),children:r({defaultMessage:"Delete thread",id:"2WxP2iMtPx"})}),l.jsx(Qe.Separator,{})]}),_.map(E=>{const T=u.some(k=>k.backend_uuid===E.uuid);return l.jsx(Qe.LinkItem,{href:E.link,className:"group/item",trailingAccessory:T?l.jsx(_n,{icon:D("check"),size:"small"}):void 0,onSelect:()=>{i("sidecar library clicked",{type:"selected"})},children:l.jsx("span",{className:"line-clamp-1",children:vte(E.title)})},E.uuid)}),l.jsx(Qe.LinkItem,{href:"/library",className:"text-quiet",onSelect:()=>{i("sidecar library clicked",{type:"view_all"})},children:r({defaultMessage:"View all",id:"yr9iXqRRXf"})})]})}),Tte=A.memo(function({disableNewThread:t,disableOpenInTab:n}){const r=f.useRef(null),[s,a]=f.useState(!1),o=Sn(),{variation:i}=ute(!1),c=f.useMemo(()=>js(o.sidecarSourceTab.tabId,o.sidecarSourceTab.secondaryTab?.tabId),[o.sidecarSourceTab.tabId,o.sidecarSourceTab.secondaryTab?.tabId]),u=o.sidecarAutoOpenedThreads[c]??!1,d=i&&u,m=f.useCallback(()=>{s&&r.current?.focus()},[s,r]);return f.useEffect(()=>{const p=g=>{["Tab","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(g.key)&&a(!0)},h=()=>{a(!1)};return window.addEventListener("keydown",p),window.addEventListener("click",h),()=>{window.removeEventListener("keydown",p),window.removeEventListener("click",h)}},[]),l.jsx("div",{className:"relative z-20",children:l.jsxs(Y,{variant:"background",className:"py-sm px-md h-headerHeight relative flex items-center justify-between",children:[l.jsx("div",{className:"flex items-center",children:d&&l.jsx(wte,{})}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("button",{className:"size-0 appearance-none opacity-0",onFocus:m}),!t&&l.jsx(kte,{}),l.jsx(Mte,{ref:r,disableOpenInTab:n})]})]})})}),dS=A.memo(function({children:t,withoutHeader:n,disableNewThread:r,disableOpenInTab:s}){return l.jsx(tte,{children:l.jsxs(nte,{children:[!n&&l.jsx(rte,{children:l.jsx(Tte,{disableNewThread:r,disableOpenInTab:s})}),l.jsx($D,{childrenWidth:"none",children:t})]})})});function Ate(){const e=Xt(),[t,n]=f.useState(null),[r,s]=f.useState(!0);return f.useEffect(()=>{e.getManagedOrganizationUUIDPromise().then(a=>{n(a)}).finally(()=>{s(!1)})},[e]),{data:t,isLoading:r}}const Nte=async({orgUuid:e,domainName:t,headers:n,reason:r})=>{const{data:s,error:a,response:o}=await ve.GET("/rest/enterprise/organization/{org_uuid}/comet/domain/{domain_name}/permissions",r,{params:{path:{org_uuid:e,domain_name:t}},headers:n,timeoutMs:Ct({productionMs:2e3}),numRetries:1});if(a)throw new Ue("API_CLIENTS_ERROR",{cause:a,status:o.status??0,details:{reason:r,orgUuid:e,domainName:t}});return s},Rte=async({domainName:e,headers:t,reason:n})=>{const{data:r,error:s,response:a}=await ve.GET("/rest/enterprise/comet/domain/{domain_name}/permissions",n,{params:{path:{domain_name:e}},headers:t,timeoutMs:Ct({productionMs:2e3}),numRetries:1});if(s)throw new Ue("API_CLIENTS_ERROR",{cause:s,status:a.status??0,details:{reason:n,domainName:e}});return r},Yk={allow_agentic_actions:!0,allow_non_agentic_actions:!0,agentic_actions_needs_human_approval:!1};function Qk({managedOrgUuid:e,isManagedOrgLoading:t=!1,domainName:n,headers:r,reason:s}){const a=jl(),o=!!e,i=!o&&a,c=!t&&!!n&&(o||i);return gt({queryKey:Se.makeQueryKey("comet-domain-permissions-unified",e,n,o?"managed":"user"),queryFn:async()=>{if(!n)throw new Error("Domain name is required");if(o&&e){const u=await Nte({orgUuid:e,domainName:n,headers:r,reason:s});if(!u)throw new Error("Failed to fetch Comet domain permissions");return u}if(i){const u=await Rte({domainName:n,headers:r,reason:s});if(!u)throw new Error("Failed to fetch Comet domain permissions for user");return u}return Yk},enabled:c,placeholderData:c?void 0:Yk,staleTime:1e3*60*5,gcTime:1e3*60*10})}function fS(){const{sidecarSourceTab:{url:e,secondaryTab:t}}=Sn(),n=t?.url,{data:r,isLoading:s}=Ate(),{data:a}=Qk({managedOrgUuid:r,isManagedOrgLoading:s,domainName:ys(e),reason:"useSidecarDomainPermissions"}),{data:o}=Qk({managedOrgUuid:r,isManagedOrgLoading:s,domainName:n?ys(n):void 0,reason:"useSidecarDomainPermissions"});return f.useMemo(()=>({isAgenticActionsDisabled:a?.allow_agentic_actions===!1||o?.allow_agentic_actions===!1,isNonAgenticActionsDisabled:a?.allow_non_agentic_actions===!1||o?.allow_non_agentic_actions===!1}),[a,o])}function QD(e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}const Dte=({children:e,className:t,delimiter:n="",...r})=>{const s=A.Children.toArray(e),a=s.map((o,i)=>{if(A.isValidElement(o)&&o.type===XD){const c=o.props.id;return l.jsxs(A.Fragment,{children:[o,i!==s.length-1&&l.jsxs(B,{className:"inline-flex !text-inherit",children:[" ",n," "]})]},c)}return null});return l.jsx("div",{className:`gap-sm flex items-center ${t}`,...r,children:a})},XD=({children:e})=>l.jsx(l.Fragment,{children:e}),Ao=Dte,Un=XD,Ite=Pe(async()=>{const{LightboxImage:e}=await W(async()=>{const{LightboxImage:t}=await import("./LightboxImage-ChKrknSo.js");return{LightboxImage:t}},__vite__mapDeps([47,2,3,6,5,1,7,8,9,13,12,14,15,16,17]));return{default:e}}),to=A.memo(function({src:t,lightboxSrc:n,alt:r,fadeIn:s,fallbackSrc:a,fallback:o,hasShadow:i=!1,includeLightBoxModal:c=!0,lightboxFooter:u,origin:d,draggable:m=!0,imageClassName:p,maskClassName:h,containerClassName:g,rounded:y="md",onClick:b,AIProps:x,authorName:_,authorUrl:v,onLoad:C,onFail:w,softBlockSaveImage:S=!1,imageRef:E,imageProps:T,testId:k,onDownload:M,referrerPolicy:N,...P}){const[O,L]=f.useState(!1),[H,R]=f.useState(!1),[I,F]=f.useState(!1),G=f.useRef(null),{isAI:j,AILabel:$}=x||{isAI:!1,AILabel:""},q=f.useRef(Date.now()),U=f.useCallback(re=>{L(!0),w?.({isConnected:re.currentTarget.isConnected,loadTime:Date.now()-q.current})},[w]),X=f.useCallback(()=>{R(!0),C?.()},[R,C]);f.useEffect(()=>{if(G.current){if(G.current.complete){X();return}G.current.src||(G.current.src=t)}},[t,X,G]);const J=z(p,"transition-all ease-in-out",{"opacity-100 duration-200 scale-100":H&&s,"opacity-0 scale-[0.98]":!H&&s,"hidden opacity-0":O&&!a,"max-h-[90vh]":c,"cursor-zoom-in hover:shadow-lg duration-200 ":c&&!I}),ne=f.useMemo(()=>({className:J,src:t,alt:r,onError:U,onClick:()=>F(!0),...T}),[r,J,T,U,t]),ae=f.useMemo(()=>({ref:G,onLoad:X,...ne}),[X,ne]),de=f.useMemo(()=>({...ne,src:n??t}),[n,ne,t]),oe=f.useCallback(re=>{re.stopPropagation()},[]),le=l.jsxs(l.Fragment,{children:[l.jsx(B,{variant:"tiny",color:"white",className:"px-xs py-two h-5 rounded-md bg-black/60 opacity-0 transition-all group-hover:opacity-100",children:l.jsxs(Ao,{className:"gap-xs",children:[l.jsx(Un,{id:"authorName",children:_}),v?l.jsx(Un,{id:"authorDomain",children:ys(v)}):null]})}),l.jsx("div",{className:"size-xs bg-black/60 opacity-0 transition-all group-hover:opacity-100"})]}),se=f.useCallback(()=>F(!1),[]);if(O){if(a&&G.current)G.current.src=a;else if(o!==void 0)return o}return l.jsxs(l.Fragment,{children:[l.jsx("div",{onClick:b,className:g,"data-testid":k,children:l.jsxs("div",{className:z("bg-subtler group relative size-full overflow-hidden",h,{"shadow-md":i&&H,"transition-all duration-200 ease-in-out hover:scale-[1.02] hover:shadow-lg":i,"rounded-sm":y==="sm","rounded-md":y==="md",rounded:y===!0}),children:[j&&l.jsxs("div",{className:"bottom-xs right-xs absolute z-10 flex items-center justify-center",children:[l.jsx("div",{children:l.jsx(B,{variant:"tiny",color:"white",className:"gap-x-two px-xs py-two flex h-5 items-center rounded-md bg-black/60 opacity-0 transition-all group-hover:opacity-100",children:l.jsx("span",{children:$})})}),l.jsx("div",{className:"size-xs bg-black/60 opacity-0 transition-all group-hover:opacity-100"}),l.jsx("div",{children:l.jsx(B,{variant:"tiny",color:"white",className:"gap-x-two p-two flex h-5 items-center rounded-md bg-black/60",children:l.jsx(ye,{icon:D("cpu-2"),size:"xs"})})})]}),_&&(v?l.jsx(Dt,{href:v??"",target:"_blank",onClick:oe,className:"bottom-xs right-xs absolute z-10 flex items-center justify-center",children:le}):l.jsx("div",{onClick:oe,className:"bottom-xs right-xs absolute z-10 flex items-center justify-center",children:le})),S&&!j&&l.jsx("div",{className:"absolute inset-0",onClick:c?()=>F(!0):void 0}),l.jsx("img",{width:P.width,height:P.height,alt:r,...ae,ref:QD([E,G]),draggable:m,referrerPolicy:N})]})}),c&&l.jsx(Ite,{onClose:se,isOpen:I,imgProps:de,origin:d,width:P.width,height:P.height,alt:r,onDownload:M,footer:u})]})}),jte={APPLE_HEALTHKIT_LOCAL_MCP:"APPLE_HEALTHKIT_LOCAL_MCP",LOCAL_MCP:"LOCAL_MCP"};var z2;(function(e){e.token_limit_exceeded="token_limit_exceeded",e.parsing_error="parsing_error",e.unknown_error="unknown_error",e.unauthorized="unauthorized",e.no_data_received="no_data_received",e.file_type_not_supported="file_type_not_supported",e.image_failed_moderation="image_failed_moderation"})(z2||(z2={}));var xc;(function(e){e.generic_upload_error="generic_upload_error",e.unsupported_type="unsupported_type",e.too_large="too_large",e.too_small="too_small",e.no_name="no_name",e.failed_moderation="failed_moderation",e.over_file_count="over_file_count",e.over_image_count="over_image_count",e.attachments_disabled_by_organization="attachments_disabled_by_organization"})(xc||(xc={}));function oYe(e){const t=e.file_metadata?.file_repository_type,n=e.meta_data;return!!e.is_attachment&&!t&&!n?.file_uuid}function Pte(e){if(!e)return!1;try{return new URL(e).hostname.includes("s3.amazonaws.com")}catch{return!1}}const wa=Me({token_limit_exceeded:{id:"cnFlyTXVDl",defaultMessage:"File {filename} exceeds the model's token limit."},parsing_error:{id:"RdRRX8+YG/",defaultMessage:"Failed to parse file {filename}."},file_type_not_supported:{id:"IaflMSTTq6",defaultMessage:"File type not supported for {filename}."},unknown_error:{id:"zhy7qBi3Eu",defaultMessage:"Unknown error for file {filename}."},unauthorized:{id:"6bOe+cTUhc",defaultMessage:"User not authorised to access file {filename}."},no_data_received:{id:"34PXW7VvKh",defaultMessage:"No data received for file {filename}."},generic_upload_error:{id:"xVFvYDY5wK",defaultMessage:"File upload failed"},unsupported_type:{id:"VUOyYEDS96",defaultMessage:"The file type you uploaded is not supported."},too_large:{id:"XBcIjOYq8V",defaultMessage:"File too large: {max} maximum."},too_small:{id:"ZUyiNCx0Aw",defaultMessage:"File too small."},no_name:{id:"IkAmckATMw",defaultMessage:"File name is required."},image_failed_moderation:{id:"YCCLnMQDPb",defaultMessage:"File {filename} failed moderation."},failed_moderation:{id:"hnN6c9ExET",defaultMessage:"File upload failed moderation."},over_file_count:{id:"2+5sg16GUy",defaultMessage:"You are allowed up to {maxNumFiles, plural, one {# file} other {# files}} at once."},over_image_count:{id:"FIudmpgA1s",defaultMessage:"You are allowed up to {maxNumImages, plural, one {# image} other {# images}} at once."},attachments_disabled_by_organization:{id:"3N0C1GH7jP",defaultMessage:"Your organization has disabled attachments."}});function b0(e){if(e.startsWith("/rest/connectors/wiley/"))return"WILEY";if(e.includes("drive.google.com")||e.includes("connectors/google-drive")||e.includes("docs.google.com"))return"GOOGLE_DRIVE";if(e.includes("onedrive.live.com")||e.includes("1drv.ms")||e.includes("connectors/onedrive"))return"ONEDRIVE";if(e.includes(".sharepoint.com")||e.includes("connectors/sharepoint"))return"SHAREPOINT";if(e.includes("dropbox.com/preview")||e.includes("connectors/dropbox"))return"DROPBOX";if(e.includes("app.box.com/file")||e.includes("connectors/box"))return"BOX"}function Ote(e){const n=e.meta_data?.connection_type??e.file_metadata?.connector_type;if(n)return n;if(e.url)return b0(e.url)}function Io(e){return!!e?.meta_data?.patent_name||!!e?.url&&Yg(e.url)}function Xk(e){const t=e?.meta_data;return!!(t?.connection_type&&t.connection_type!=="LOCAL")||!!e.is_attachment&&!!e.url&&!!b0(e.url)}function Yf(e){return!!e.is_attachment&&!!e.url&&Qg(e.url)}function ZD(e){if(!e)return!1;const t=e.meta_data;return Object.values(jte).includes(t?.mcp_server)}function Lte(e,t,n=2){if(e==null)return"";const r=e.includes(".")?e.slice(e.lastIndexOf(".")):"",s=e.substring(0,e.length-r.length);return s.length>t?s.substring(0,t-r.length-3)+".".repeat(n)+r:s+r}const Fl=e=>{try{return(new URL(e).pathname.split("/").pop()||"").split(".").pop()?.toLowerCase()}catch{return e.split(".").pop()?.toLowerCase()}},JD=e=>e.file.type.includes("image"),Fte=e=>e.file.type==="application/pdf",Ute=e=>e.file.type==="text/csv"||e.file.type=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",Bte=e=>e.file.type==="text/plain"||e.file.type==="application/msword"||e.file.type==="application/vnd.openxmlformats-officedocument.wordprocessingml.document"||e.file.type==="text/markdown",mS={txt:"text/plain",pdf:"application/pdf",jpeg:"image/jpeg",jpg:"image/jpeg",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",md:"text/markdown",png:"image/png",csv:"text/csv"},Hte=e=>{if(e<0)throw new Error("Number of bytes cannot be negative");const t=["B","KB","MB","GB"];let n=0,r=e;for(;r>=1e3&&n<t.length-1;)r/=1e3,n++;return`${r%1===0?r.toString():r.toFixed(1)} ${t[n]}`},ks={PDF:"pdf",TXT:"txt",CSV:"csv",XLSX:"xlsx",DOCX:"docx",PPTX:"pptx",MARKDOWN:"md",JSON:"json",JPG:"jpg",JPEG:"jpeg",PNG:"png"},iYe=e=>!!(Fl(e)===ks.PDF||Yg(e)),eI=e=>{const t=Fl(e);if(Yg(e))return D("file-type-pdf");switch(t){case ks.TXT:return D("file-text");case ks.MARKDOWN:return D("file-text");case ks.PDF:return D("file-type-pdf");case ks.XLSX:return D("file-spreadsheet");case ks.CSV:return D("file-type-csv");case ks.DOCX:return D("file-type-doc");case ks.PPTX:return D("file-type-ppt");case ks.JPG:case ks.JPEG:case ks.PNG:return D("photo");default:return D("file")}},Qf=e=>e?.file_metadata?.file_source==="MEETING_TRANSCRIPT";function tI(e,t){return!1}const Vte=A.memo(function({uploadedFiles:t,onRemoveFile:n,ref:r}){return l.jsxs("div",{ref:r,className:"gap-x-sm scrollbar-none flex snap-x snap-mandatory overflow-x-auto",children:[l.jsx("div",{className:"w-xs shrink-0"}),t.map((s,a)=>l.jsx(Gte,{uploadedFile:s,onRemoveFile:n},a)),l.jsx("div",{className:"w-xs shrink-0"})]})}),Gte=A.memo(function({uploadedFile:t,onRemoveFile:n}){const r="uploaded-files-list",{session:s}=je(),{trackEvent:a}=Ze(s),o=t.status==="uploading",{$t:i}=Q(),{fileRepoInfo:c}=Fw({reason:r}),{saveFile:u,isLoading:d}=cX({fileRepoInfo:c,reason:r}),{data:m}=UR({fileRepoInfo:c,fileName:t.file.name,reason:r}),p=Object.values(ks),h=Fl(t.file.name),y=h&&!Xr(t.file.name)&&p.includes(h)&&Pte(t.nextURL),b=c.file_repository_type==="COLLECTION"&&!o&&y,x=f.useMemo(()=>i(m?{defaultMessage:"File exists in Space",id:"pD1m2AH9FU"}:{defaultMessage:"Save attachment to Space",id:"/Pbth8CiTs"}),[m,i]),_=f.useMemo(()=>JD(t)?D("photo"):Fte(t)?D("pdf"):Ute(t)?D("file-spreadsheet"):Bte(t)?D("file-text"):D("file"),[t]),v=f.useCallback(()=>{a("remove attachment clicked"),t.nextURL&&n?.(t.nextURL,t.file_uuid??"")},[a,t,n]),C=f.useCallback(()=>u(t),[u,t]);return l.jsxs("div",{className:z("scroll-mx-md px-sm py-xs border-subtlest bg-subtler dark:bg-subtle gap-x-md flex h-[48px] w-fit snap-start items-center justify-between rounded-lg",{"opacity-70":o}),children:[l.jsxs("div",{className:"gap-x-md flex items-center",children:[t.thumbnailSource&&!o?l.jsx(to,{alt:t.file.name,src:t.thumbnailSource,containerClassName:"size-8 shrink-0",imageClassName:"w-full h-full object-cover object-center",rounded:"md",includeLightBoxModal:!1}):l.jsx("div",{className:"bg-subtle dark:bg-subtler flex size-8 items-center justify-center rounded-lg","data-testid":o?"file-loading-icon":"file-type-icon",children:l.jsx(ye,{icon:o?D("loader-2"):_,size:"sm",color:"#64645F",className:o?"animate-spin":void 0})}),l.jsxs("div",{className:"flex-col",children:[l.jsx(B,{variant:"tiny",color:"light",className:"text-nowrap",children:Lte(t.file.name,30)}),t.file.size>0&&l.jsx(B,{variant:"tinyRegular",color:"light",className:"text-nowrap",children:Hte(t.file.size)})]})]}),l.jsxs("div",{className:"gap-x-sm flex items-center",children:[b&&l.jsx(pt,{icon:D("device-floppy"),size:"tiny",onClick:C,disabled:m||d,variant:"common",toolTip:x,isLoading:d,pill:!0,noPadding:!0}),t.nextURL&&l.jsx(pt,{icon:D("x"),size:"tiny",testId:"remove-uploaded-file",onClick:v,variant:"common",pill:!0,noPadding:!0})]})]})});var zx,_0="HoverCard",[nI]=pu(_0,[Xg]),v0=Xg(),[zte,C0]=nI(_0),rI=e=>{const{__scopeHoverCard:t,children:n,open:r,defaultOpen:s,onOpenChange:a,openDelay:o=700,closeDelay:i=300}=e,c=v0(t),u=f.useRef(0),d=f.useRef(0),m=f.useRef(!1),p=f.useRef(!1),[h,g]=Ml({prop:r,defaultProp:s??!1,onChange:a,caller:_0}),y=f.useCallback(()=>{clearTimeout(d.current),u.current=window.setTimeout(()=>g(!0),o)},[o,g]),b=f.useCallback(()=>{clearTimeout(u.current),!m.current&&!p.current&&(d.current=window.setTimeout(()=>g(!1),i))},[i,g]),x=f.useCallback(()=>g(!1),[g]);return f.useEffect(()=>()=>{clearTimeout(u.current),clearTimeout(d.current)},[]),l.jsx(zte,{scope:t,open:h,onOpenChange:g,onOpen:y,onClose:b,onDismiss:x,hasSelectionRef:m,isPointerDownOnContentRef:p,children:l.jsx(gN,{...c,children:n})})};rI.displayName=_0;var sI="HoverCardTrigger",aI=f.forwardRef((e,t)=>{const{__scopeHoverCard:n,...r}=e,s=C0(sI,n),a=v0(n);return l.jsx(UC,{asChild:!0,...a,children:l.jsx(Hn.a,{"data-state":s.open?"open":"closed",...r,ref:t,onPointerEnter:qn(e.onPointerEnter,Gh(s.onOpen)),onPointerLeave:qn(e.onPointerLeave,Gh(s.onClose)),onFocus:qn(e.onFocus,s.onOpen),onBlur:qn(e.onBlur,s.onClose),onTouchStart:qn(e.onTouchStart,o=>o.preventDefault())})})});aI.displayName=sI;var pS="HoverCardPortal",[qte,$te]=nI(pS,{forceMount:void 0}),oI=e=>{const{__scopeHoverCard:t,forceMount:n,children:r,container:s}=e,a=C0(pS,t);return l.jsx(qte,{scope:t,forceMount:n,children:l.jsx(hu,{present:n||a.open,children:l.jsx(yN,{asChild:!0,container:s,children:r})})})};oI.displayName=pS;var Vh="HoverCardContent",iI=f.forwardRef((e,t)=>{const n=$te(Vh,e.__scopeHoverCard),{forceMount:r=n.forceMount,...s}=e,a=C0(Vh,e.__scopeHoverCard);return l.jsx(hu,{present:r||a.open,children:l.jsx(Wte,{"data-state":a.open?"open":"closed",...s,onPointerEnter:qn(e.onPointerEnter,Gh(a.onOpen)),onPointerLeave:qn(e.onPointerLeave,Gh(a.onClose)),ref:t})})});iI.displayName=Vh;var Wte=f.forwardRef((e,t)=>{const{__scopeHoverCard:n,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:o,...i}=e,c=C0(Vh,n),u=v0(n),d=f.useRef(null),m=gu(t,d),[p,h]=f.useState(!1);return f.useEffect(()=>{if(p){const g=document.body;return zx=g.style.userSelect||g.style.webkitUserSelect,g.style.userSelect="none",g.style.webkitUserSelect="none",()=>{g.style.userSelect=zx,g.style.webkitUserSelect=zx}}},[p]),f.useEffect(()=>{if(d.current){const g=()=>{h(!1),c.isPointerDownOnContentRef.current=!1,setTimeout(()=>{document.getSelection()?.toString()!==""&&(c.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",g),()=>{document.removeEventListener("pointerup",g),c.hasSelectionRef.current=!1,c.isPointerDownOnContentRef.current=!1}}},[c.isPointerDownOnContentRef,c.hasSelectionRef]),f.useEffect(()=>{d.current&&Yte(d.current).forEach(y=>y.setAttribute("tabindex","-1"))}),l.jsx(bN,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:o,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:qn(a,g=>{g.preventDefault()}),onDismiss:c.onDismiss,children:l.jsx(_N,{...u,...i,onPointerDown:qn(i.onPointerDown,g=>{g.currentTarget.contains(g.target)&&h(!0),c.hasSelectionRef.current=!1,c.isPointerDownOnContentRef.current=!0}),ref:m,style:{...i.style,userSelect:p?"text":void 0,WebkitUserSelect:p?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})})}),Kte="HoverCardArrow",lI=f.forwardRef((e,t)=>{const{__scopeHoverCard:n,...r}=e,s=v0(n);return l.jsx(xN,{...s,...r,ref:t})});lI.displayName=Kte;function Gh(e){return t=>t.pointerType==="touch"?void 0:e()}function Yte(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;n.nextNode();)t.push(n.currentNode);return t}var Qte=rI,Xte=aI,Zte=oI,Jte=iI,ene=lI,w0="Popover",[cI]=pu(w0,[Xg]),Xf=Xg(),[tne,Ti]=cI(w0),uI=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:s,onOpenChange:a,modal:o=!1}=e,i=Xf(t),c=f.useRef(null),[u,d]=f.useState(!1),[m,p]=Ml({prop:r,defaultProp:s??!1,onChange:a,caller:w0});return l.jsx(gN,{...i,children:l.jsx(tne,{scope:t,contentId:ri(),triggerRef:c,open:m,onOpenChange:p,onOpenToggle:f.useCallback(()=>p(h=>!h),[p]),hasCustomAnchor:u,onCustomAnchorAdd:f.useCallback(()=>d(!0),[]),onCustomAnchorRemove:f.useCallback(()=>d(!1),[]),modal:o,children:n})})};uI.displayName=w0;var dI="PopoverAnchor",nne=f.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=Ti(dI,n),a=Xf(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:i}=s;return f.useEffect(()=>(o(),()=>i()),[o,i]),l.jsx(UC,{...a,...r,ref:t})});nne.displayName=dI;var fI="PopoverTrigger",mI=f.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=Ti(fI,n),a=Xf(n),o=gu(t,s.triggerRef),i=l.jsx(Hn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":bI(s.open),...r,ref:o,onClick:qn(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?i:l.jsx(UC,{asChild:!0,...a,children:i})});mI.displayName=fI;var hS="PopoverPortal",[rne,sne]=cI(hS,{forceMount:void 0}),pI=e=>{const{__scopePopover:t,forceMount:n,children:r,container:s}=e,a=Ti(hS,t);return l.jsx(rne,{scope:t,forceMount:n,children:l.jsx(hu,{present:n||a.open,children:l.jsx(yN,{asChild:!0,container:s,children:r})})})};pI.displayName=hS;var Hc="PopoverContent",hI=f.forwardRef((e,t)=>{const n=sne(Hc,e.__scopePopover),{forceMount:r=n.forceMount,...s}=e,a=Ti(Hc,e.__scopePopover);return l.jsx(hu,{present:r||a.open,children:a.modal?l.jsx(one,{...s,ref:t}):l.jsx(ine,{...s,ref:t})})});hI.displayName=Hc;var ane=x$("PopoverContent.RemoveScroll"),one=f.forwardRef((e,t)=>{const n=Ti(Hc,e.__scopePopover),r=f.useRef(null),s=gu(t,r),a=f.useRef(!1);return f.useEffect(()=>{const o=r.current;if(o)return K$(o)},[]),l.jsx(Y$,{as:ane,allowPinchZoom:!0,children:l.jsx(gI,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:qn(e.onCloseAutoFocus,o=>{o.preventDefault(),a.current||n.triggerRef.current?.focus()}),onPointerDownOutside:qn(e.onPointerDownOutside,o=>{const i=o.detail.originalEvent,c=i.button===0&&i.ctrlKey===!0,u=i.button===2||c;a.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:qn(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),ine=f.forwardRef((e,t)=>{const n=Ti(Hc,e.__scopePopover),r=f.useRef(!1),s=f.useRef(!1);return l.jsx(gI,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{e.onCloseAutoFocus?.(a),a.defaultPrevented||(r.current||n.triggerRef.current?.focus(),a.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:a=>{e.onInteractOutside?.(a),a.defaultPrevented||(r.current=!0,a.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=a.target;n.triggerRef.current?.contains(o)&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&s.current&&a.preventDefault()}})}),gI=f.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:a,disableOutsidePointerEvents:o,onEscapeKeyDown:i,onPointerDownOutside:c,onFocusOutside:u,onInteractOutside:d,...m}=e,p=Ti(Hc,n),h=Xf(n);return Q$(),l.jsx(X$,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:a,children:l.jsx(bN,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:d,onEscapeKeyDown:i,onPointerDownOutside:c,onFocusOutside:u,onDismiss:()=>p.onOpenChange(!1),children:l.jsx(_N,{"data-state":bI(p.open),role:"dialog",id:p.contentId,...h,...m,ref:t,style:{...m.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),yI="PopoverClose",lne=f.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=Ti(yI,n);return l.jsx(Hn.button,{type:"button",...r,ref:t,onClick:qn(e.onClick,()=>s.onOpenChange(!1))})});lne.displayName=yI;var cne="PopoverArrow",xI=f.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=Xf(n);return l.jsx(xN,{...s,...r,ref:t})});xI.displayName=cne;function bI(e){return e?"open":"closed"}var une=uI,dne=mI,fne=pI,mne=hI,pne=xI;function hne({isOpen:e,onOpenChange:t}){const[n,r]=f.useState(!1),s=f.useRef(e),a=f.useRef(t);s.current=e,a.current=t;const o=()=>{e||r(!1)},i=()=>{s.current&&(r(!0),a.current(!1))};return f.useEffect(o,[e]),f.useEffect(()=>(window.addEventListener("scroll",i,{capture:!0}),()=>{window.removeEventListener("scroll",i,{capture:!0})}),[]),{isClosedByScroll:n}}const gne=8,Zk=10,yne=200,xne=300,Jk="rounded-xl",e4="p-sm",t4=Rl(["rounded-xl","shadow-overlay","origin-[var(--radix-popover-content-transform-origin)]","data-[state=open]:animate-scaleAndFadeIn","data-[state=closed]:animate-scaleAndFadeOut"],{variants:{appearance:{dark:"bg-dark",light:"bg-base"}},defaultVariants:{appearance:"dark"}});function fa({triggerElement:e,children:t,appearance:n="system",side:r="bottom",align:s="center",open:a,onOpenChange:o,maxWidthPx:i=320,offsetPx:c=gne,shouldShowArrow:u=!1,disabled:d=!1,interaction:m="click",openDelayMs:p,closeDelayMs:h,onWheelContent:g,onContentMouseEnter:y,onContentMouseLeave:b,autoFocusFirstFocusableElement:x=!1,..._}){const{isMobileStyle:v,portalTargetElement:C}=Gf(),{isOpen:w,handleOpenChange:S}=b$({open:a,onOpenChange:o}),E=_$(),T=n!=="system"?n:E?.colorScheme||"dark",k=Tl(_),M=z("overflow-hidden -translate-y-two [clip-path:inset(1px_1px_0px_1px)]",{"fill-[oklch(var(--dark-background-base-color))] dark:stroke-[1.5px] dark:stroke-subtler":T==="dark","fill-[oklch(var(--background-base-color))] stroke-[1.5px] stroke-subtler":T==="light"}),N=f.useCallback(R=>{g?.({deltaX:R.deltaX,deltaY:R.deltaY})},[g]),{isClosedByScroll:P}=hne({isOpen:m==="hover"&&w,onOpenChange:S}),O=f.useCallback(R=>{R.preventDefault(),R.target?.querySelector("button, a")?.focus()},[]);if(d)return e;if(v)return l.jsx(Z$,{isOpen:w,onToggle:S,triggerElement:e,children:l.jsx("div",{className:"text-sm",children:t})});const L="calc(var(--radix-popper-available-height) - var(--size-md))",H=l.jsx("div",{className:z("text-sm",{"text-white":T==="dark","text-default":T==="light"}),style:{maxWidth:i},children:t});return m==="hover"?l.jsxs(Qte,{open:w&&!P,onOpenChange:S,openDelay:p??yne,closeDelay:h??xne,children:[l.jsx(Xte,{asChild:!0,...k,children:e}),l.jsx(Zte,{container:C,children:l.jsxs(Jte,{side:r,align:s,sideOffset:c,avoidCollisions:!0,collisionPadding:Zk,className:z(t4({appearance:T}),"min-w-[var(--radix-hover-card-trigger-width)]","origin-[var(--radix-hover-card-content-transform-origin)]"),onWheel:N,onMouseEnter:y,onMouseLeave:b,onPointerEnter:y,onPointerLeave:b,children:[l.jsx(z5,{className:Jk,maxHeight:L,children:l.jsx("div",{className:e4,children:H})}),u&&l.jsx(ene,{width:12,height:6,className:M})]})})]}):l.jsxs(une,{open:w,onOpenChange:S,children:[l.jsx(dne,{asChild:!0,...k,children:e}),l.jsx(fne,{container:C,children:l.jsxs(mne,{side:r,align:s,sideOffset:c,avoidCollisions:!0,collisionPadding:Zk,onOpenAutoFocus:x?O:void 0,className:z(t4({appearance:T}),"min-w-[var(--radix-popover-trigger-width)]","origin-[var(--radix-popover-content-transform-origin)]"),onWheel:N,onMouseEnter:y,onMouseLeave:b,onPointerEnter:y,onPointerLeave:b,children:[l.jsx(z5,{className:Jk,maxHeight:L,children:l.jsx("div",{className:e4,children:H})}),u&&l.jsx(pne,{width:12,height:6,className:M})]})})]})}Pe(async()=>{const{LoginModal:e}=await W(async()=>{const{LoginModal:t}=await import("./LoginModal-D844be60.js");return{LoginModal:t}},__vite__mapDeps([48,2,3,5,1,6,7,8,9,10,11,12,13,49,14,15,16,17]));return{default:e}});const ws=({enabled:e})=>{const{openModal:t}=Kt(),{isMobileUserAgent:n}=Be(),r=wt(),s=f.useCallback(({title:o,description:i,origin:c,image:u,imageAlt:d,closeCallback:m})=>{},[e,t,r]),a=f.useCallback(({title:o,description:i,origin:c,sheetModalVariant:u,closeCallback:d,overrideRedirectUrl:m,disallowedMethods:p,overrideMobileVariant:h=!1})=>{},[e,n,t,r]);return f.useMemo(()=>({openVisitorLoginUpsell:a,openVisitorLoginImageUpsell:s}),[s,a])};function bne({uploadRateLimit:e}){const t=wt(),{specialCapabilities:n}=gr();return f.useCallback(()=>!t&&!n.fileUpload?{canUpload:!1,reason:"auth"}:e!=null&&e<=0?{canUpload:!1,reason:"rate_limit"}:{canUpload:!0},[t,e,n.fileUpload])}const lYe=Me({monthly:{defaultMessage:"Pay monthly",id:"dC8ig5S+30"},yearly:{defaultMessage:"Pay yearly",id:"szrzn7zQJJ"},unknown:{defaultMessage:"Unknown",id:"5jeq8PJZg7"}}),cYe=Me({monthly:{defaultMessage:"{price} per month",id:"MdFvGXMUO4"},yearly:{defaultMessage:"{price} per year",id:"1YmVZcwG/X"},unknown:{defaultMessage:"Unknown",id:"5jeq8PJZg7"}}),uYe="unset",dYe="USD",n4={RAMP:"Welcome Ramp members. Your 6 month Perplexity Pro free trial starts now!",FREEATT:"Welcome ATT Employees.  Your complimentary 1-year subscription starts now!",FREEAWS:"Welcome AWS Employees.  Your complimentary 1-year subscription starts now!",RABBIT:"Welcome r1 owners.  Your complimentary 1-year Perplexity Pro subscription starts now!",FREEUT:"Welcome UT Staff.  Your complimentary 1-year Perplexity Pro subscription starts now!",FREEDATABRICKS:"Welcome Databricks team.  Your complimentary 1-year Perplexity Pro subscription starts now!",FREESRA:"Welcome SRA team. Your complimentary 1-year Perplexity Pro subscription starts now!",HBSTECH:"Welcome HBS Tech Conference Attendees.  Your complimentary 6 month Perplexity Pro subscription starts now!",HBSSTAFF:"Welcome HBS Tech Conference Attendees.  Your complimentary 1 year Perplexity Pro subscription starts now!",FREENEWSROOM:"Welcome Friends!  Your complimentary 1-year Perplexity Pro subscription starts now!",FREEINKITT:"Welcome Inkitt Writers!  Your complimentary 1-year subscription to Perplexity Pro starts now!",FREETIME:"Welcome Time team!  Your complimentary 1-year subscription to Perplexity Pro starts now!",FREETMOBILE:"Welcome T-Mobile team!  Your complimentary 1-year subscription to Perplexity Pro starts now!","11LABS":"Welcome! Your complimentary 3-month subscription to Perplexity Pro starts now!",FREECAVS:"Welcome Cavs team! Your complimentary 1-year Perplexity Pro subscription starts now!",NOTHING6:"Welcome Nothing owners. Your complimentary 6-month Perplexity Pro subscription starts now!",FREENOTHING6:"Welcome Nothing owners. Your complimentary 6-month Perplexity Pro subscription starts now!",NOTHING1:"Welcome Nothing owners. Your complimentary 1-year Perplexity Pro subscription starts now!",FREENOTHING1:"Welcome Nothing owners. Your complimentary 1-year Perplexity Pro subscription starts now!",HOOHACKS:"Welcome HooHacks Community. Your 1-year Perplexity Pro free trial starts now!",NJED:"Welcome NJ ED Community. Your 1-year Perplexity Pro free trial starts now!",COPYAI:"Welcome Copy AI customers! Your 6-month complimentary Perplexity Pro subscription starts now!",RAYCAST6:"Welcome Raycast users! Your 6-month complimentary Perplexity Pro subscription starts now!",RAYCAST3:"Welcome Raycast users! Your 3-month complimentary Perplexity Pro subscription starts now!",FREEMAGENTALOVE:"Welcome Deutsche Telekom!  Your complimentary 1-year Perplexity Pro subscription starts now!",FREEPPLXVIP:"Welcome friend of Perplexity! Your complimentary 1-year Perplexity Pro subscription starts now.",FREEUTA1:"Welcome UTA team! Your complimentray 1-year Perplexity Pro subscription starts now.",DT:"Willkommen Deutsche Telekom Kunde! Sie erhalten dank Magenta Moments ein kostenloses 1-Jahres-Abonnement fr Perplexity Pro.",MY:"Welcome! Your complimentary 1-year Perplexity Pro subscription starts now."},lp="pplx.discount_code",qx="pplx.discount_code_expiry",_ne=()=>{const[e,t]=f.useState(null),[n,r]=f.useState(null),s=hn(),a=nn(),o=sr(),i=a?.get("discount_code"),{$t:c}=Q(),u=Array.isArray(i)?i[0]:i,[d,m]=f.useState(u||null),{hasAccessToProFeatures:p}=Mt(),h=f.useCallback(()=>{yt.removeItem(lp),yt.removeItem(qx),r(null),t(null)},[]),g=f.useCallback(()=>{h(),m(null)},[h]),y=f.useCallback(()=>{if(n&&e)return;const _=yt.getItem(lp);_?.startsWith("REPLIT")?(t("/static/images/replit.svg"),r("/static/images/replit_dark.svg")):_?.startsWith("BREX")?(t("/static/images/brex.svg"),r("/static/images/brex_dark.svg")):(r(null),t(null))},[n,e]),b=f.useCallback(()=>{const _=yt.getItem(lp),v=yt.getItem(qx);if(p){h();return}if(!(!_&&!u)){if(v&&new Date(v)<new Date){h();return}if(!_||u&&u!==_){const C=new Date;C.setDate(C.getDate()+2),yt.setItem(lp,String(u)),yt.setItem(qx,C.toString()),m(String(u)),y(),o==="/pro"&&s.push("/",void 0,"Pro page");return}if(_){m(_),y();return}}},[u,y,p,o,h,s]),x=f.useCallback(_=>{for(const v in n4)if(_&&_.startsWith(v))return n4[v];return c({defaultMessage:"Redeem your promo code {discountCode}. Get started",id:"Vapo/CiOwF"},{discountCode:_})},[c]);return f.useEffect(()=>{b()},[u,b]),f.useMemo(()=>({discountCode:d,setDiscountCode:m,partnerLogoDark:n,partnerLogoLight:e,message:x(d??""),clearDiscountCode:g}),[g,d,x,n,e])},$x="referral_code",Wx="referral_code_expiry",vne=()=>{const[e,t]=f.useState(null),[n,r]=f.useState(!1),a=nn()?.get("referral_code"),o=Array.isArray(a)?a[0]:a,i=f.useCallback(()=>{const c=yt.getItem($x),u=yt.getItem(Wx);if(!(!c&&!o)){if(u&&new Date(u)<new Date){yt.removeItem($x),yt.removeItem(Wx),t(null);return}if(!c||o&&o!==c){const d=new Date;d.setDate(d.getDate()+1),yt.setItem($x,String(o)),yt.setItem(Wx,d.toString()),t(String(o));return}if(c){t(c);return}}},[o]);return f.useEffect(()=>{i(),r(!0)},[o,i]),f.useMemo(()=>({referralCode:e,referralEvaluated:n}),[e,n])},Cne=()=>{const e=hn(),{session:t}=je(),{trackEvent:n}=Ze(t),r=f.useCallback(async({origin:s,discountCode:a,tier:o,referralCode:i,subscriptionTier:c="pro",redirectPath:u,closePath:d})=>{const m=new URL(`/${c}/payment`,window.location.origin);return m.searchParams.set("plan",o),m.searchParams.set("origin",s),a&&m.searchParams.set("promotion_code",a),u&&m.searchParams.set("redirect_path",u),d&&m.searchParams.set("close_path",d),n("pro checkout started",{subscriptionTier:c,origin:s,discountCode:a??"",referralCode:i??"",tier:o,flowType:"embedded_checkout"}),window.open(m.toString(),"_blank"),!0},[e,n]);return f.useMemo(()=>({navigateToPayment:r}),[r])},wne=()=>{const[e,t]=vs("pplx.persistent_promo_code",null);return[e,t]};function zh(e={}){const t=new URL(window.location.href);for(const[n,r]of Object.entries(e))typeof r>"u"?t.searchParams.delete(n):t.searchParams.set(n,r);_I(Object.fromEntries(t.searchParams))}function _I(e){const t=new URL(window.location.href),r=(e?new URLSearchParams(e):new URLSearchParams).toString();r!==t.searchParams.toString()&&window.history.replaceState({},"",`?${r}`)}const qh="interval";function fYe({ignoreUrlParams:e=!1}={}){const t=nn(),r=!e&&t.get(qh)==="monthly"?"monthly":"yearly",[s,a]=f.useState(r),o=f.useCallback(()=>{a(i=>{const c=i==="yearly"?"monthly":"yearly";return e||zh({[qh]:c}),c})},[e]);return{billingPeriod:s,handleToggleBillingPeriod:o}}const Sne=({reason:e,onSuccess:t,onError:n,onSettled:r})=>{const s=pX(),a=It(),{openToast:o}=cn(),{$t:i}=Q();return on({mutationFn:async({orgUserUUID:c,tier:u})=>{const{data:d,error:m,response:p}=await ve.POST("/rest/enterprise/organization/user/subscription-tier-update",e,{body:{org_user_uuid:c,subscription_tier:u},timeoutMs:Ct({productionMs:5e3})});if(m?.detail&&"error_code"in m.detail&&m.detail.error_code==="already_has_subscription_tier")return{status:"success"};if(m)throw new Ue("API_CLIENTS_ERROR",{cause:m,status:p.status??0});return d},onSuccess:c=>{a.invalidateQueries({queryKey:s}),a.invalidateQueries({queryKey:hX()}),o({message:i({defaultMessage:"Subscription tier updated",id:"/Kb6qzWZAC"}),variant:"success",timeout:5}),t?.(c)},onError:c=>{o({message:i({defaultMessage:"Failed to update subscription tier",id:"2zlidsUac2"}),variant:"error",timeout:5}),n?.(c)},onSettled:(c,u)=>{r?.(c,u)}})},Ene={enterprise_pro:"pro",enterprise_max:"max"},r4=e=>Ene[e],kne=async({request:e,reason:t})=>{const n=q$(),r={"content-type":"application/json",...n?{"Screen-Dimensions":n}:{}};try{const{data:s,error:a,response:o}=await ve.POST("/rest/stripe/checkout-session",t,{body:{referral_code:e.referralCode,discount_code:e.discountCode,origin:e.origin,tier:e.tier,locale:e.locale,embedded:e.embedded??!1,subscription_tier:e.subscriptionTier,success_redirect_url:e.success_redirect_url},timeoutMs:5e3,headers:r,reason:t});if(a)throw new Ue("API_CLIENTS_ERROR",{cause:a,status:o.status??0,details:{reason:t}});return{subscriptionStatus:s.subscription_status,status:s.status,url:s.url??null,clientSecret:s.client_secret??void 0,errorCode:s.error_code??void 0,subscriptionTier:e.subscriptionTier}}catch{return}},Mne=Me({pro:{defaultMessage:"Perplexity Enterprise Pro Request",id:"c8Vh79Ma17"},max:{defaultMessage:"Perplexity Enterprise Max Request",id:"5x+WE7gjCk"}}),Tne=Me({pro:{defaultMessage:"Dear Admin Team,%0D%0A%0D%0AI'd like to request an upgrade to Perplexity Enterprise Pro for our team. It would give us unlimited searches with the top AI models, better research tools, and custom workspaces while ensuring data security and administrative controls.%0D%0A%0D%0ABest regards,%0D%0A[Your Name]",id:"NQKslzlMIS"},max:{defaultMessage:"Hi there,%0D%0A[requestor email] is requesting an upgrade to Perplexity Enterprise Max, our most powerful tier yet.%0D%0A%0D%0AIt would give them access to:%0D%0A Unlimited access to deep research and file and app creation  get comprehensive research reports, build dashboards, analyze data, and create interactive web appsall in one place%0D%0A Access to advanced AI models - Get in-depth answers powered by o3-pro, GPT 5 Thinking, or Opus 4.1 Thinking%0D%0A Greater file upload limits - from 5,000 to 10,000 in your files and 500 to 5,000 in Spaces%0D%0A Enhanced video generation - from 3 to 15 videos a month with sound powered by Veo 3%0D%0A%0D%0A[Upgrade your team member to Enterprise Max]",id:"Yrb559i689"}}),Ane=Me({pro:{defaultMessage:"Dear Admin Team,%0D%0A%0D%0AI'd like to request a downgrade to Perplexity Enterprise Pro, as I no longer require the additional functionality offered by Enterprise Max.%0D%0A%0D%0ABest regards,%0D%0A[Your Name]",id:"BcKiJLVOOh"}});function Nne({toTier:e,fromTier:t,$t:n}){return n(e==="pro"&&t==="max"?Ane.pro:Tne[e])}function Rne({toTier:e,fromTier:t,organization:n,$t:r}){const s=n?.admins?.map(i=>i?.email).filter(i=>i!==void 0).join(";"),a=r(Mne[e]),o=Nne({toTier:e,fromTier:t,$t:r});return`mailto:${s}?subject=${a}&body=${o}`}const vI=({reason:e,redirectPath:t,closePath:n})=>{const{$t:r}=Q(),s=hn(),{hasAccessToProFeatures:a,isEnterprisePro:o,isEnterpriseMax:i}=Mt(),{discountCode:c}=_ne(),[u]=wne(),{referralCode:d}=vne(),m=wt(),{openVisitorLoginUpsell:p}=ws({enabled:!m}),{session:h,update:g}=je(),{trackEvent:y}=Ze(h),{organization:b,orgUser:x,isAdmin:_}=Hs({reason:e}),{subscriptionTier:v}=Mt(),{mutate:C}=Sne({reason:e,onSuccess:async()=>{await g(),s.refresh("Subscription tier updated")}}),{navigateToPayment:w}=Cne(),{device:{isWindowsApp:S}}=jn(),E=f.useCallback(async k=>{const{billingPeriod:M,subscriptionTier:N="pro",origin:P}=k;if(m){if(await w({origin:P,discountCode:c??u??void 0,tier:M,referralCode:d??void 0,subscriptionTier:N,redirectPath:t,closePath:n}))return;y("pro checkout started",{subscriptionTier:N,origin:P,discountCode:c??"",referralCode:d??"",tier:M,flowType:"stripe_checkout"});const O=await kne({request:{tier:M,referralCode:a?"":d,discountCode:a?"":c,origin:P,locale:ON(),subscriptionTier:N},reason:e});O?.url?oa(O.url,`Handle click pricing ${M} checkout started`):s.refresh(`Handle click ${M}`)}else p({title:r({defaultMessage:"Sign in to unlock {tier}",id:"8E/VXpzNhf"},{tier:N==="max"?"Max":"Pro"}),origin:P})},[m,w,c,d,y,a,s,p,r,u,e,t,n]),T=f.useCallback(k=>{const{tier:M="enterprise_pro",origin:N,billingPeriod:P}=k;if(x&&b)if(_){if(o||i){const O=x.uuid,L=r4(M);O&&C({orgUserUUID:O,tier:L})}else S?oa(`https://www.perplexity.ai/onboarding/onboarding-org-subscription?tier=${M}`,"Handle click enterprise WindowsApp"):s.push(`/onboarding/onboarding-org-subscription?tier=${M}`);return}else{const O=r4(M),L=Rne({toTier:O,fromTier:v,organization:b,$t:r});y("enterprise email request generated",{toTier:O,fromTier:v,origin:N}),oa(L,"Handle click enterprise")}else y("enterprise pro onboarding started",{origin:N}),S?oa(`https://www.perplexity.ai/onboarding/org/create?tier=${M}&${qh}=${P}`,"Handle click enterprise WindowsApp"):s.push(`/onboarding/org/create?tier=${M}&${qh}=${P}`)},[x,_,S,s,C,b,r,y,o,i,v]);return f.useMemo(()=>({handleClickPersonal:E,handleClickEnterprise:T}),[E,T])},Dne=Pe(async()=>{const{PricingTableModal:e}=await W(async()=>{const{PricingTableModal:t}=await import("./PricingTableModal-CR8v5BmB.js").then(n=>n.P);return{PricingTableModal:t}},__vite__mapDeps([50,2,3,5,1,6,7,8,9,13,12,43,51,52,53,54,49]));return{default:e}}),On=()=>{const e=wt(),{isPro:t,isMax:n}=Mt(),{openModal:r}=Kt(),s=Xt(!1),{handleClickPersonal:a,handleClickEnterprise:o}=vI({reason:"paywall-upsell"}),{openVisitorLoginUpsell:i}=ws({enabled:!e}),{IncentiveProModal:c,BraintreeSubscriptionModal:u}=HJ(),d=f.useRef(()=>{}),m=f.useCallback(p=>{const{allowDowngrade:h=!1}=p;if(!e){Z.warn("User is not logged in, skipping paywall upsell",p);return}if(n&&!h){Z.warn("User is on Max tier, skipping paywall upsell",p);return}if(Si()){if(!s){Z.error("Comet adapter not available in mobile Comet browser context");return}s.openNativeSheet("upgrade");return}r(Dne,{highlightTier:t?"max":void 0,...p,handleClickPersonal:a,handleClickEnterprise:o,openPaywallUpsell:d.current,openVisitorLoginUpsell:i,IncentiveProModal:c,BraintreeSubscriptionModal:u})},[t,e,r,n,s,a,o,i,c,u]);return d.current=m,m};function Ine({uploadRateLimit:e}){const{$t:t}=Q(),n=wt(),r=On(),{openVisitorLoginUpsell:s}=ws({enabled:!n}),a=bne({uploadRateLimit:e}),o=f.useCallback(()=>{s({title:t({defaultMessage:"Sign in to upload files and photos",id:"gEOi1eLJ7C"}),description:t({defaultMessage:"Analyze files and photos for free",id:"nu4bK5/Y5T"}),origin:Ke.FILE_UPLOAD})},[s,t]),i=f.useCallback(()=>{r({pitchMessage:{title:t({defaultMessage:"Upgrade for additional document analysis",id:"Al7GL1NbHp"})},origin:Ke.FILE_UPLOAD})},[t,r]);return f.useCallback(()=>{const c=a();if(c.canUpload)return!1;switch(c.reason){case"auth":return o(),!0;case"rate_limit":return i(),!0;default:St(c)}},[a,o,i])}const jne=({reason:e})=>{const{organization:t}=Hs({reason:e});return f.useMemo(()=>({disabledByOrganization:!(t?.settings?.file_attachments_allowed??!0)}),[t?.settings?.file_attachments_allowed])},Pne=({enabled:e,handleFileInput:t,fileUploadErrorMessage:n,fileUploadWarningMessage:r,setAttachmentErrorMessage:s})=>{const a="ask-input-attachments-hook",{uploadRateLimit:o}=En(),i=Ine({uploadRateLimit:o}),c=f.useCallback(()=>{s?.("")},[s]),{disabledByOrganization:u}=jne({reason:a});return f.useMemo(()=>e&&t?{showAttachments:!0,disabledByOrganization:u,onFilesSelected:t,gateUploadFile:i,fileUploadErrorMessage:n??null,fileUploadWarningMessage:r??null,onCloseErrorToast:c}:{showAttachments:!1},[e,t,i,n,r,c,u])};function CI(){const e=jl(),{organization:t}=Hs({reason:"useBrowserAgentDisabledByOrg"});return e?t?.settings?.comet_agentic_actions_allowed===!1:!1}function One(e){const{enabled:t,isFollowUp:n}=e,{forceEnableBrowserAgent:r}=Fr(),{setForceEnableBrowserAgent:s}=Fs(),{isAgenticActionsDisabled:a}=fS(),i=CI()||a;f.useEffect(()=>{i&&r&&s(!1)},[i,r,s]);const c=f.useCallback(u=>{s(u)},[s]);return f.useMemo(()=>!t||n?{showBrowseForMe:!1}:{showBrowseForMe:!0,browseForMe:r,onChangeBrowseForMe:c,isBrowseForMeDisabledByOrg:i},[t,n,r,c,i])}function Lne(e){const{enabled:t,handleFileInput:n}=e,{sidecarSourceTab:{url:r}}=Sn(),s=Xt(),{isNonAgenticActionsDisabled:a}=fS();f.useEffect(()=>{if(t)return s.subscribeScreenshotCaptured(i=>{n?.([i],"local")})},[s,n,t]);const o=f.useCallback(()=>{s.captureSourceTabScreenshotV2({sourceTabUrl:r})},[s,r]);return f.useMemo(()=>t?{showScreenshot:!0,onCaptureScreenshot:o,isScreenshotDisabledByOrg:a}:{showScreenshot:!1},[t,o,a])}const Fne=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"ask-input-simplification-release",defaultValue:e,extraAttributes:t,subjectType:"visitor_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},Une="ask-input-simplification-enabled",Zf=()=>{const{session:e}=je(),[t,n]=vs(Une,!1),{variation:r,loading:s}=Fne(!1,{orgUUID:e?.user?.org_uuid??"",subscriptionTier:e?.user?.subscription_tier??""});return f.useEffect(()=>{s||n(r)},[r,s,n]),t},wI=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"perplexity-ask-asi",defaultValue:e,extraAttributes:t,subjectType:"visitor_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},SI=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"browser-agent-search-mode",defaultValue:e,extraAttributes:t,subjectType:"user_nextauth_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])};function Mu(){const{variation:e}=SI(!1),t=CI(),{session:n}=je(),r=mn()&&e,s=n?.user?.payment_tier==="free";return{isEnabled:r,isDisabledByOrg:t,shouldShowModelSelector:r&&!s}}const Bne=(e=!1,t,n)=>{const{value:r,loading:s}=Lt({flag:"enable-llm-council",defaultValue:e,extraAttributes:t,subjectType:"user_nextauth_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},Hne="llm-council-enabled",Vne=()=>{const[e,t]=vs(Hne,!1),{variation:n,loading:r}=Bne(!1);return f.useEffect(()=>{r||t(n)},[n,r,t]),e};function gS(){const{isEnterprise:e}=Hs({reason:"max-tier"}),{value:t,loading:n}=Lt({flag:"max-upsell",defaultValue:!1,subjectType:"visitor_id",extraAttributes:{isEnterprise:e??!1}});return f.useMemo(()=>({isMaxUpsellEnabled:e?!0:t,loading:n}),[t,n,e])}function Tu(){const{isMax:e,isPro:t}=Mt(),{isMaxUpsellEnabled:n}=gS(),{gpt4Limit:r,pplxAlphaLimit:s,pplxBetaLimit:a}=En();return f.useMemo(()=>i=>{let c=!1;return i===K.RESEARCH?c=!r.available||!s.available:c=!r.available||!a.available,n&&!e&&t&&c&&(i===K.RESEARCH||i===K.STUDIO||i===K.AGENTIC_RESEARCH)},[n,e,t,r,s,a])}function S0(){const{gpt4Limit:e,pplxAlphaLimit:t,pplxBetaLimit:n,modelSpecificLimits:r}=En(),{specialCapabilities:s}=gr(),a=wt(),{hasAccessToProFeatures:o,isMax:i}=Mt(),c=Tu(),{results:u}=Ht(),{getModelConfig:d}=Wf(),m=!s.unlimitedProSearch&&!e.available&&!o,p=!s.unlimitedResearch&&(!e.available||!t.available),h=!e.available||!n.available,{isStudent:g}=Zw({reason:"study-mode-access"}),y=Zf(),b=Vne(),{isEnabled:x}=Mu(),{variation:_}=wI(!1),v=f.useMemo(()=>u.some(w=>w.display_model===te.STUDY),[u]),C=yr();return f.useCallback(w=>{const S=C(w),E=d(w),T=S===K.SEARCH&&!df(w);if(w===te.DEFAULT)return!0;if(!a){const k=s.unlimitedProSearch&&C(w)===K.SEARCH&&!c(S),M=s.unlimitedResearch&&C(w)===K.RESEARCH&&!c(S);return k||M}return C(w)===K.STUDY&&(y||g||v)?!0:C(w)===K.AGENTIC_RESEARCH&&(!b||!i&&!s.maxModelSelection)||C(w)===K.BROWSER_AGENT&&!x||C(w)===K.ASI&&!_?!1:i?!0:!(E?.subscriptionTier==="max"&&(r[w]??0)<=0||m||C(w)===K.RESEARCH&&p||C(w)===K.STUDIO&&h||c(S)||!o&&T&&!s.unlimitedProSearch)},[m,p,h,o,s.unlimitedProSearch,s.unlimitedResearch,s.maxModelSelection,a,c,i,g,v,d,r,y,b,x,C,_])}function jo({openPaywallUpsell:e}){const{$t:t}=Q(),n=wt(),{openVisitorLoginUpsell:r}=ws({enabled:!n}),s=Tu(),a=S0(),{specialCapabilities:o}=gr(),{getModelConfig:i}=Wf(),c=yr(),u=f.useCallback((m,p)=>{const h=c(m);if(m===te.DEFAULT&&!p)return!1;const g=a(m)===!1||p;if(n)if(g){const y={[K.SEARCH]:t({defaultMessage:"Upgrade for premium AI models and advanced search",id:"diYdd8SPLC"}),[K.RESEARCH]:t({defaultMessage:"Upgrade for advanced research capabilities",id:"eT2Jtlxdm4"}),[K.STUDIO]:t({defaultMessage:"Try Perplexity file and app creation",id:"iHM4NQjnsp"}),[K.STUDY]:t({defaultMessage:"Step-by-step learning",id:"UGHOn5vTUx"}),[K.AGENTIC_RESEARCH]:t({defaultMessage:"Upgrade to Max for Model council",id:"/3eJagC0vg"}),[K.BROWSER_AGENT]:t({defaultMessage:"Let Comet browse the web for you",id:"3KYGkwR+/P"}),[K.ASI]:t({defaultMessage:"Upgrade to Max to use Agent",id:"92HmEYEscK"})},b={[K.SEARCH]:t({defaultMessage:"With {pplx} {pro}, get as many as you want",id:"jRMiP6Ut4n"},{pplx:"Perplexity",pro:"Pro"}),[K.RESEARCH]:s(h)?t({defaultMessage:"Upgrade to Max for enhanced access to Perplexity deep research.",id:"0wwLn3Y5X+"}):t({defaultMessage:"Extended access for subscribers",id:"ATGyCTI4+V"}),[K.STUDIO]:s(h)?t({defaultMessage:"Upgrade to Max for enhanced access to Perplexity file and app creation.",id:"iekw4hFm+M"}):t({defaultMessage:"Exclusive access for subscribers",id:"1LB4QwRSMw"}),[K.STUDY]:t({defaultMessage:"Ask questions and learn",id:"8RzCMAs2/c"}),[K.AGENTIC_RESEARCH]:t({defaultMessage:"Compare responses from multiple AI models",id:"zz9eXmfAgf"}),[K.BROWSER_AGENT]:t({defaultMessage:"Autonomously browse the web to complete tasks for you",id:"BfGiO2EJx4"}),[K.ASI]:s(h)?t({defaultMessage:"Upgrade to Max for enhanced access to Perplexity ASI.",id:"um1hy/mvhW"}):t({defaultMessage:"Extended access for subscribers",id:"ATGyCTI4+V"})},x=y[h??K.SEARCH],_=b[h??K.SEARCH],C={[K.SEARCH]:Ke.TRY_COPILOT,[K.RESEARCH]:Ke.TRY_RESEARCH,[K.STUDIO]:Ke.TRY_LABS,[K.AGENTIC_RESEARCH]:Ke.TRY_MODEL_COUNCIL}[h??K.SEARCH]??Ke.TRY_COPILOT,w=h===K.AGENTIC_RESEARCH||s(h)?zn.MAX:void 0;return e({pitchMessage:{title:x,description:_},origin:C,highlightTier:w}),!0}else return!1;else{if(m===te.PRO&&o.unlimitedProSearch)return!1;const y={[K.SEARCH]:t({defaultMessage:"Sign in to access Pro Search",id:"AARKXJYL5U"}),[K.RESEARCH]:t({defaultMessage:"Sign in to access Perplexity deep research",id:"0efyoyN2yu"}),[K.STUDIO]:t({defaultMessage:"Sign in to try Perplexity file and app creation",id:"CiDuFrwzv2"}),[K.STUDY]:t({defaultMessage:"Sign in to access Perplexity learning help",id:"zby1tcrj65"}),[K.AGENTIC_RESEARCH]:t({defaultMessage:"Sign in to access Model council",id:"iSEp3gYBna"}),[K.BROWSER_AGENT]:t({defaultMessage:"Sign in to let Comet browse the web for you",id:"rIklPk+wHh"}),[K.ASI]:t({defaultMessage:"Sign in to access Perplexity ASI",id:"Di4sKpsM4Q"})},b={[K.SEARCH]:t({defaultMessage:"10x as many citations in answers",id:"D0fULpN8/D"}),[K.RESEARCH]:t({defaultMessage:"Deep research and analysis on any topic",id:"vZzVhXmhZo"}),[K.STUDIO]:t({defaultMessage:"Create projects from scratch, exclusive access for subscribers",id:"STPFx+8/sC"}),[K.STUDY]:t({defaultMessage:"Step-by-step learning",id:"UGHOn5vTUx"}),[K.AGENTIC_RESEARCH]:t({defaultMessage:"Compare responses from multiple AI models",id:"zz9eXmfAgf"}),[K.BROWSER_AGENT]:t({defaultMessage:"Autonomously browse the web to complete tasks for you",id:"BfGiO2EJx4"}),[K.ASI]:t({defaultMessage:"Agent",id:"QGVI63s1dJ"})},x=y[h??K.SEARCH],_=b[h??K.SEARCH];return r({title:x,description:_,origin:Ke.TRY_PRO}),!0}},[t,a,n,e,r,s,o.unlimitedProSearch,c]),d=f.useCallback(m=>{if(a(m))return!1;const h=i(m)?.subscriptionTier==="max";return n?e({pitchMessage:{title:t({defaultMessage:"Upgrade to access the latest AI models in one subscription",id:"7IeSYLBZMN"}),description:t(h?{defaultMessage:"With Perplexity Max, you get access to all the latest AI models in one subscription",id:"GTGX9oEOEB"}:{defaultMessage:"With Perplexity Pro, you get access to more of the latest AI models in one subscription",id:"ty7emtND3N"})},origin:Ke.MODEL_SELECTOR,highlightTier:h?zn.MAX:void 0}):r({title:t({defaultMessage:"Sign in to choose a model",id:"BhbQUiYsTB"}),description:t({defaultMessage:"Access the latest AI models from Perplexity, OpenAI, Anthropic (Claude), Google Gemini and more",id:"DDVABeGeBG"}),origin:Ke.MODEL_SELECTOR}),!0},[a,n,e,r,t,i]);return f.useMemo(()=>({gateSearchModeSelection:u,gateSearchModelSelection:d}),[u,d])}function Gne({openPaywallUpsell:e}){const{setPreferredSearchModel:t}=Ol(),{setConfiguredModel:n}=En(),r=yr(),{gateSearchModelSelection:s}=jo({openPaywallUpsell:e}),a=Vs();return f.useCallback((o=a)=>{if(s(o))return;const c=r(o);c!==K.AGENTIC_RESEARCH&&t(c,o),n(o)},[s,a,t,n,r])}function Po({openPaywallUpsell:e}){const t=Gne({openPaywallUpsell:e}),{publishIpcMessage:n,subscribeToIpcMessage:r}=h0(),s=f.useRef(t);return f.useEffect(()=>{s.current=t},[t]),f.useEffect(()=>r(sp,o=>{o.type===sp&&s.current(o.model)}),[r]),f.useCallback(o=>{n(sp,{type:sp,model:o}),s.current(o)},[n])}const E0=()=>{const{isSearchModelMenuRewriteEnabled:e}=Pl(),{getDefaultModelForMode:t}=ki({reason:"use_default_search_models_for_search_mode"}),n=Vs(),{isMax:r}=Mt();return f.useCallback(s=>{switch(s){case K.SEARCH:return n;case K.RESEARCH:return e?t(K.RESEARCH):te.ALPHA;case K.STUDIO:return e?t(K.STUDIO):te.BETA;case K.STUDY:return e?t(K.STUDY):te.STUDY;case K.AGENTIC_RESEARCH:return e?t(K.AGENTIC_RESEARCH):te.AGENTIC_RESEARCH;case K.BROWSER_AGENT:return e?t(K.BROWSER_AGENT):r?te.BROWSER_AGENT_OPUS:te.BROWSER_AGENT_SONNET;case K.ASI:return e?t(K.ASI):te.ASI;default:return Z.warn(`useDefaultSearchModels: Unhandled search mode "${s}", falling back to default search model.`),n}},[n,e,t,r])},k0=()=>{const{preferredSearchModels:e}=Ol(),t=E0(),n=f.useCallback(r=>{switch(r){case K.SEARCH:return e[K.SEARCH]||t(K.SEARCH);case K.RESEARCH:return e[K.RESEARCH]||t(K.RESEARCH);case K.STUDIO:return e[K.STUDIO]||t(K.STUDIO);case K.STUDY:return e[K.STUDY]||t(K.STUDY);case K.AGENTIC_RESEARCH:return e[K.AGENTIC_RESEARCH]||t(K.AGENTIC_RESEARCH);case K.BROWSER_AGENT:return e[K.BROWSER_AGENT]||t(K.BROWSER_AGENT);case K.ASI:return e[K.ASI]||t(K.ASI);default:St(r)}},[e,t]);return f.useMemo(()=>({getPreferredSearchModelForSearchMode:n}),[n])};function zne({enabled:e,searchMode:t,onClearSearchMode:n,isFollowUp:r}){return t===K.SEARCH?{showSearchModeMenu:!1}:t===K.BROWSER_AGENT&&r?{showSearchModeMenu:!0,searchMode:t,onClearSearchMode:n,disabled:!0,disabledTooltip:"Start a new thread to turn off browser control"}:e?{showSearchModeMenu:!0,searchMode:t,onClearSearchMode:n}:{showSearchModeMenu:!1}}const qne=({enabled:e,searchMode:t,onSearchModeSelect:n,omittedSearchModes:r=_e,isFollowUp:s=!1})=>{const{getPreferredSearchModelForSearchMode:a}=k0(),o=ns(),i=On(),c=Po({openPaywallUpsell:i}),{setExhaustedSearchMode:u}=En(),d=t??o,m=f.useCallback(b=>{u(void 0);const x=b===d?K.SEARCH:b,_=a(x);c(_)},[c,a,d,u]),p=f.useCallback(()=>{m(K.SEARCH)},[m]),h=n??m,g=f.useMemo(()=>e?{showSearchMode:!0,searchMode:d,onSearchModeSelect:h,omittedSearchModes:r}:{showSearchMode:!1},[e,d,h,r]),y=f.useMemo(()=>zne({enabled:e,searchMode:d,onClearSearchMode:p,isFollowUp:s}),[e,d,p,s]);return f.useMemo(()=>({plusMenuSearchModeProps:g,searchModeMenuProps:y}),[g,y])},$ne=["web","scholar","social","org","my_files"],za=e=>$ne.includes(e),M0={web:{type:"web",icon:D("world"),label:e=>e.formatMessage({defaultMessage:"Web",id:"B6CB3748fZ"}),description:e=>e.formatMessage({defaultMessage:"Search across the entire Internet",id:"L+Gw+J7uDs"})},scholar:{type:"scholar",icon:D("books"),label:e=>e.formatMessage({defaultMessage:"Academic",id:"mbxIJyT8C5"}),description:e=>e.formatMessage({defaultMessage:"Search academic papers",id:"IVRQQmrqTD"})},social:{type:"social",icon:D("social"),label:e=>e.formatMessage({defaultMessage:"Social",id:"qOLogguG/7"}),description:e=>e.formatMessage({defaultMessage:"Discussions and opinions",id:"g9xPuArp4v"})},org:{type:"org",icon:D("files"),label:e=>e.formatMessage({defaultMessage:"Organization files",id:"Cxcu0UiR/p"}),description:e=>e.formatMessage({defaultMessage:"Search files from your organization",id:"Ak5CW53mGi"})},my_files:{type:"my_files",icon:D("file-export"),label:e=>e.formatMessage({defaultMessage:"My files",id:"bYbrKKlKgS"}),description:e=>e.formatMessage({defaultMessage:"Search my files",id:"EYmiG70whM"})}},Vc="/static/images/data-connectors/wiley/wiley-avatar.svg",T0="/static/images/data-connectors/cbinsights/cbinsights-avatar.svg",A0="/static/images/data-connectors/pitchbook/pitchbook-avatar.svg",N0="/static/images/data-connectors/statista/statista-avatar.svg",R0="Wiley",yS="CB Insights",xS="PitchBook",bS="Statista",EI=e=>{switch(e){case"GOOGLE_DRIVE":return rw;case"ONEDRIVE":return aw;case"SHAREPOINT":return iw;case"DROPBOX":return cw;case"BOX":return uw;case"WILEY":return R0;case"GCAL":return ZN;case"NOTION_MCP":return dw;case"LINEAR":case"LINEAR_ALT":return fw;case"SLACK":return mw;case"SLACK_DIRECT":return pw;case"GITHUB_MCP_DIRECT":return hw;case"ASANA_MCP_DIRECT":return Uc;case"ASANA_MCP_MERGE":return Uc;case"ATLASSIAN_MCP_DIRECT":return gw;case"JIRA_MCP_MERGE":return xw;case"CONFLUENCE_MCP_MERGE":return _w;case"MICROSOFT_TEAMS_MCP_MERGE":return Cw;case"OUTLOOK":return nR;case"FACTSET":return YN;case"ZOOM":return Sw;default:return""}},Jf=e=>{switch(e){case"crunchbase":return QN;case"factset":return KN;case"wiley":return Vc;case"google_drive":return nw;case"onedrive":return sw;case"sharepoint":return ow;case"gcal":return t0;case"dropbox":return lw;case"box":return n0;case"gmail":return XN;case"notion_mcp":return r0;case"outlook":return ww;case"linear":case"linear_alt":return s0;case"slack":case"slack_direct":return a0;case"github_mcp_direct":return o0;case"asana_mcp_direct":case"asana_mcp_merge":return i0;case"atlassian_mcp_direct":return l0;case"jira_mcp_merge":return yw;case"confluence_mcp_merge":return bw;case"microsoft_teams_mcp_merge":return vw;case"wiley_mcp_cashmere":return Vc;case"cbinsights_mcp_cashmere":return T0;case"pitchbook_mcp_cashmere":return A0;case"statista_mcp_cashmere":return N0;case"zoom":return Ew;default:return null}},Wne={pdf:"file-type-pdf",doc:"file-type-doc",docx:"file-type-docx",xls:"file-type-xls",xlsx:"file-type-xls",ppt:"file-type-ppt",pptx:"file-type-ppt",csv:"file-type-csv",txt:"file-type-txt",html:"file-type-html",css:"file-type-css",xml:"file-type-xml",py:"brand-python",js:"brand-javascript",mjs:"brand-javascript",cjs:"brand-javascript",jsx:"brand-react",ts:"brand-typescript",tsx:"brand-react",rs:"brand-rust",go:"brand-golang",cpp:"brand-cpp",cc:"brand-cpp",cxx:"brand-cpp",php:"brand-php",swift:"brand-swift",kt:"brand-kotlin",java:"file-code",c:"file-code",h:"file-code",rb:"file-code",cs:"file-code",scala:"file-code",json:"file-type-js",sql:"file-type-sql",vue:"file-type-vue",jpg:"file-type-jpg",jpeg:"file-type-jpg",png:"file-type-png",svg:"file-type-svg",bmp:"file-type-bmp",zip:"file-type-zip"},mYe=e=>e?Wne[e]??"file":"file";function pYe(e){if(e===0)return"0 bytes";const t=1024,n=["bytes","KB","MB","GB","TB"],r=Math.floor(Math.log(e)/Math.log(t));return Math.ceil(e/Math.pow(t,r))+" "+n[r]}const kI=e=>{if(!e)return;const t=e.lastIndexOf(".");if(!(t<=0||t===e.length-1))return e.substring(t+1).toLowerCase()},Kne=200,q2=(e,t={})=>{const{maxLength:n=Kne,replacement:r=" ",fallback:s="file"}=t;if(!e)return s;const a=e.lastIndexOf("."),o=a>0&&a<e.length-1;let i=o?e.substring(0,a):e;const c=o?e.substring(a):"";if(i=i.replace(/[/\\:*?"<>|]/g,r).trim(),i||(i=s),i.length+c.length>n){const u=n-c.length;if(u>0)i=i.substring(0,u).trim();else return s+c}return i+c},hYe=e=>{const t=e.file_metadata.file_type;return t==="FOLDER"||t==="DATABASE"||t==="WORKSPACE"||t==="PAGE"};function gYe(e){const t=e.file_metadata.file_type;return t==="FOLDER"||t==="DATABASE"||t==="WORKSPACE"?D("folder-filled"):D("file")}const Yne=e=>{switch(e){case"GOOGLE_DRIVE":return nw;case"ONEDRIVE":return sw;case"SHAREPOINT":return ow;case"DROPBOX":return lw;case"BOX":return n0;case"GCAL":return t0;case"NOTION_MCP":return r0;case"OUTLOOK":return ww;case"LINEAR":case"LINEAR_ALT":return s0;case"SLACK":case"SLACK_DIRECT":return a0;case"GITHUB_MCP_DIRECT":return o0;case"ASANA_MCP_DIRECT":case"ASANA_MCP_MERGE":return i0;case"ATLASSIAN_MCP_DIRECT":return l0;case"JIRA_MCP_MERGE":return yw;case"CONFLUENCE_MCP_MERGE":return bw;case"MICROSOFT_TEAMS_MCP_MERGE":return vw;case"ZOOM":return Ew;default:return null}},Qne={crunchbase:"crunchbase",factset:"factset",wiley:"wiley",google_drive:"google_drive",onedrive:"onedrive",sharepoint:"sharepoint",gcal:"gcal",dropbox:"dropbox",box:"box",notion_mcp:"notion_mcp",outlook:"outlook",linear:"linear",linear_alt:"linear_alt",slack:"slack",slack_direct:"slack_direct",github_mcp_direct:"github_mcp_direct",asana_mcp_direct:"asana_mcp_direct",asana_mcp_merge:"asana_mcp_merge",atlassian_mcp_direct:"atlassian_mcp_direct",jira_mcp_merge:"jira_mcp_merge",confluence_mcp_merge:"confluence_mcp_merge",microsoft_teams_mcp_merge:"microsoft_teams_mcp_merge",wiley_mcp_cashmere:"wiley_mcp_cashmere",cbinsights_mcp_cashmere:"cbinsights_mcp_cashmere",pitchbook_mcp_cashmere:"pitchbook_mcp_cashmere",statista_mcp_cashmere:"statista_mcp_cashmere",zoom:"zoom",edgar:"edgar",apple_healthkit:"apple_healthkit",google_docs:"google_docs"},yi=e=>Object.keys(Qne).includes(e)||e==="gmail",$2=e=>{switch(e){case"crunchbase":return QN;case"factset":return KN;case"wiley":return Vc;case"google_drive":return nw;case"onedrive":return sw;case"sharepoint":return ow;case"gcal":return t0;case"dropbox":return lw;case"box":return n0;case"gmail":return XN;case"notion_mcp":return r0;case"outlook":return ww;case"linear":case"linear_alt":return s0;case"slack":case"slack_direct":return a0;case"github_mcp_direct":return o0;case"asana_mcp_direct":case"asana_mcp_merge":return i0;case"atlassian_mcp_direct":return l0;case"jira_mcp_merge":return yw;case"confluence_mcp_merge":return bw;case"microsoft_teams_mcp_merge":return vw;case"wiley_mcp_cashmere":return Vc;case"cbinsights_mcp_cashmere":return T0;case"pitchbook_mcp_cashmere":return A0;case"statista_mcp_cashmere":return N0;case"zoom":return Ew;default:return null}},Xi=e=>{switch(e){case"crunchbase":return NK;case"factset":return YN;case"google_drive":return rw;case"onedrive":return aw;case"sharepoint":return iw;case"gcal":return ZN;case"dropbox":return cw;case"box":return uw;case"gmail":return RK;case"notion_mcp":return dw;case"outlook":return nR;case"linear":case"linear_alt":return fw;case"slack":return mw;case"slack_direct":return pw;case"github_mcp_direct":return hw;case"asana_mcp_direct":return Uc;case"asana_mcp_merge":return Uc;case"atlassian_mcp_direct":return gw;case"jira_mcp_merge":return xw;case"confluence_mcp_merge":return _w;case"microsoft_teams_mcp_merge":return Cw;case"wiley_mcp_cashmere":return R0;case"cbinsights_mcp_cashmere":return yS;case"pitchbook_mcp_cashmere":return xS;case"statista_mcp_cashmere":return bS;case"zoom":return Sw;default:return e}},yYe=e=>{switch(e){case"GOOGLE_DRIVE":return rw;case"ONEDRIVE":return aw;case"SHAREPOINT":return iw;case"DROPBOX":return cw;case"BOX":return uw;case"NOTION_MCP":return dw;case"LINEAR":case"LINEAR_ALT":return fw;case"SLACK":return mw;case"SLACK_DIRECT":return pw;case"GITHUB_MCP_DIRECT":return hw;case"ASANA_MCP_DIRECT":return Uc;case"ASANA_MCP_MERGE":return Uc;case"ATLASSIAN_MCP_DIRECT":return gw;case"JIRA_MCP_MERGE":return xw;case"CONFLUENCE_MCP_MERGE":return _w;case"MICROSOFT_TEAMS_MCP_MERGE":return Cw;case"ZOOM":return Sw;default:return""}},xYe=(e,t)=>new Date(e+"Z").toLocaleString(t,{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone}),bYe=(e,t,n)=>{switch(e){case"RECEIVED":case"QUEUED":case"RATE_LIMITED":return{label:t.formatMessage({id:"Cnm0QAkWnp",defaultMessage:"Queued"})};case"SYNCING":return{label:t.formatMessage({id:"eOnwqs6QFY",defaultMessage:"Syncing"})};case"EVALUATING_RESYNC":case"READY":return{label:t.formatMessage({id:"IZFEUgrg25",defaultMessage:"Ready"})};case"SYNC_ERROR":return Xne(n,t)}},Xne=(e,t)=>{if(!e)return{label:t.formatMessage({id:"N1cqoEe4CZ",defaultMessage:"Sync error"}),description:t.formatMessage({defaultMessage:"An unknown error occurred while syncing this file",id:"FrOCoiVasC"})};switch(e){case"INVALID_FILE_SIZE":return{label:t.formatMessage({id:"fTNSna6r/X",defaultMessage:"File too large"}),description:t.formatMessage({defaultMessage:"File size exceeds the maximum allowed limit",id:"NTNLSYG0+u"}),suggestion:t.formatMessage({defaultMessage:"Try uploading a smaller file or contact support to increase your limit",id:"k2ucsfBcdH"})};case"INVALID_FILE_TYPE":return{label:t.formatMessage({id:"+FiyOTaUCW",defaultMessage:"Not supported"}),description:t.formatMessage({defaultMessage:"File type is not supported",id:"NMMfOTMPPN"}),suggestion:t.formatMessage({defaultMessage:"Check the list of supported file formats and convert your file if needed",id:"2zDaBv+l45"})};case"BAD_FILE":return{label:t.formatMessage({id:"+FiyOTaUCW",defaultMessage:"Not supported"}),description:t.formatMessage({defaultMessage:"File is corrupted or cannot be read",id:"2DRBESYiY3"}),suggestion:t.formatMessage({defaultMessage:"Try re-uploading the file or check if it opens correctly on your device",id:"XMnV6UR4G5"})};case"TOKEN_LIMIT_EXCEEDED":return{label:t.formatMessage({id:"t7EERfdOMB",defaultMessage:"Content too long"}),description:t.formatMessage({defaultMessage:"File content exceeds the token limit for processing",id:"S5ij+lXT2m"}),suggestion:t.formatMessage({defaultMessage:"Try splitting the file into smaller parts or contact support",id:"eu5ByuYBzE"})};case"FAILED_MODERATION":return{label:t.formatMessage({id:"+0cMy9/Uvq",defaultMessage:"Content policy violation"}),description:t.formatMessage({defaultMessage:"File content does not meet our content policy",id:"5+WSrKKHWX"}),suggestion:t.formatMessage({defaultMessage:"Review the file content and try again with appropriate content",id:"T+5YJmz9Uu"})};case"FILE_ALREADY_EXISTS":return{label:t.formatMessage({id:"rj9KIiC1cY",defaultMessage:"File already exists"}),description:t.formatMessage({defaultMessage:"A file with this name already exists",id:"v6hLP22U9C"}),suggestion:t.formatMessage({defaultMessage:"Rename the file or remove the existing file first",id:"lHS2xLoVfC"})};case"FAILED_TO_PARSE_FILE":return{label:t.formatMessage({id:"N1cqoEe4CZ",defaultMessage:"Sync error"}),description:t.formatMessage({defaultMessage:"Unable to process the file contents",id:"+JPkVmVP/P"}),suggestion:t.formatMessage({defaultMessage:"This is likely a temporary issue. Try resyncing the file.",id:"x2TrdA7gdq"})};case"FAILED_TO_INDEX_FILE":return{label:t.formatMessage({id:"N1cqoEe4CZ",defaultMessage:"Sync error"}),description:t.formatMessage({defaultMessage:"Unable to index the file for search",id:"VZXlZSjnzh"}),suggestion:t.formatMessage({defaultMessage:"This is likely a temporary issue. Try resyncing the file.",id:"x2TrdA7gdq"})};case"FILE_DOWNLOAD_ERROR":return{label:t.formatMessage({id:"N1cqoEe4CZ",defaultMessage:"Sync error"}),description:t.formatMessage({defaultMessage:"Unable to download the file from the source",id:"WQEt2fv0+0"}),suggestion:t.formatMessage({defaultMessage:"Check your connection permissions and try resyncing",id:"oMx/8oRlEl"})};case"RATE_LIMIT_RETRIES_EXCEEDED":return{label:t.formatMessage({id:"N1cqoEe4CZ",defaultMessage:"Sync error"}),description:t.formatMessage({defaultMessage:"Rate limit exceeded after multiple retries",id:"x/gkqQmJpB"}),suggestion:t.formatMessage({defaultMessage:"Please wait a few minutes and try resyncing the file",id:"9178BZbGzP"})};case"AUTOSYNC_FAILED":return{label:t.formatMessage({id:"N1cqoEe4CZ",defaultMessage:"Sync error"}),description:t.formatMessage({defaultMessage:"Automatic sync failed",id:"W/IGnlqOCp"}),suggestion:t.formatMessage({defaultMessage:"Try manually resyncing the file",id:"t77201iPJg"})};case"PERMISSION_DENIED":return{label:t.formatMessage({id:"QvPgDhBXKe",defaultMessage:"Permission denied"}),description:t.formatMessage({defaultMessage:"You don't have permission to access this file",id:"QgxFCxTqiT"}),suggestion:t.formatMessage({defaultMessage:"Ask the file owner to grant you access, or try reconnecting your account",id:"uR+F23DWlR"})};case"FILE_NOT_FOUND":return{label:t.formatMessage({id:"gcaJtRf4b0",defaultMessage:"File not found"}),description:t.formatMessage({defaultMessage:"This file may have been deleted or moved",id:"1OGOp60sN9"}),suggestion:t.formatMessage({defaultMessage:"Check if the file still exists in your connected account",id:"JHUziqne/7"})};case"FILE_METADATA_ERROR":return{label:t.formatMessage({id:"N1cqoEe4CZ",defaultMessage:"Sync error"}),description:t.formatMessage({defaultMessage:"Unable to retrieve file information",id:"Qr/kBQiYLb"}),suggestion:t.formatMessage({defaultMessage:"Try resyncing the file or reconnecting your account",id:"Iv7plRfs3c"})};default:return{label:t.formatMessage({id:"N1cqoEe4CZ",defaultMessage:"Sync error"}),description:t.formatMessage({defaultMessage:"An error occurred while syncing this file",id:"layd6ZWzub"})}}},MI=(e,t)=>{if(t==="WILEY")return EI(t);if(t||e.is_memory||e.is_conversation_history)return e.name&&e.name.trim()?e.name:void 0},TI=e=>e.isFile,AI=e=>e.isDirectory,Zne=async(e,t=gK)=>{const n=[e],r=[];for(;n.length>0;){const s=n.pop();if(s){if(TI(s)){const a=await new Promise(o=>{s.file(o)});if(r.push(a),r.length>t)return r}else if(AI(s)){const a=s.createReader(),o=await new Promise(i=>a.readEntries(i));n.push(...o)}}}return r},Gc={"fill-foreground":"--foreground-color","fill-quiet":"--foreground-quiet-color","fill-inverse":"--foreground-inverse-color","fill-light":"--dark-foreground-color","fill-dark":"--light-foreground-color","fill-super":"--super-color","fill-caution":"--caution-color","fill-max":"--max-color","stroke-foreground":"--foreground-color","stroke-quiet":"--foreground-quiet-color","stroke-subtler":"--foreground-subtler-color","stroke-inverse":"--foreground-inverse-color","stroke-light":"--dark-foreground-color","stroke-dark":"--light-foreground-color","stroke-super":"--super-color","stroke-caution":"--caution-color"},Jne=A.memo(function({lineColor:t,width:n,fillColor:r,...s}){const a=z("h-auto group",n),o=Gc[r]||"--foreground-color",i=Gc[t]||"--foreground-color";return l.jsx("div",{className:a,style:{"--logo-fill":`oklch(var(${o}))`,"--logo-stroke":`oklch(var(${i}))`},...s,children:l.jsx("svg",{viewBox:"0 0 400 91",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("use",{href:"#pplx-logo-full"})})})}),ere=A.memo(function({fillColor:t,width:n,...r}){const s=z("h-auto group",n),a=Gc[t]||"--foreground-color";return l.jsx("div",{className:s,style:{color:`oklch(var(${a}))`},...r,children:l.jsx("svg",{viewBox:"0 0 30 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"h-auto w-full",children:l.jsx("use",{href:"#pplx-logo-mark"})})})}),tre=A.memo(function({width:t="w-14",fillColor:n="fill-max",svgClassName:r,...s}){const a=z("h-auto group",t),o=Gc[n]||"--max-color";return l.jsx("div",{className:a,style:{color:`oklch(var(${o}))`},...s,children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 125 60",className:r,children:l.jsx("use",{href:"#pplx-logo-max"})})})}),nre=A.memo(function({width:t="w-10",fillColor:n="fill-super",svgClassName:r,...s}){const a=z("h-auto group",t),o=Gc[n]||"--super-color";return l.jsx("div",{className:a,style:{color:`oklch(var(${o}))`},...s,children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 109 60",className:r,children:l.jsx("use",{href:"#pplx-logo-pro"})})})}),rre=A.memo(function({width:t,fillColor:n,isPro:r,isMax:s,isEnterprise:a,isEducation:o,...i}){const c=z("h-auto group",t),u=Gc[n]||"--foreground-color";return o?l.jsx("div",{className:c,style:{color:`oklch(var(${u}))`},...i,children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 348 55",children:l.jsx("use",{href:"#pplx-logo-word-edu-pro"})})}):a?r?l.jsx("div",{className:c,style:{color:`oklch(var(${u}))`},...i,children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 528 78",children:l.jsx("use",{href:"#pplx-logo-word-ent-pro"})})}):s?l.jsx("div",{className:c,style:{color:`oklch(var(${u}))`},...i,children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 567 78",children:l.jsx("use",{href:"#pplx-logo-word-ent-max"})})}):l.jsx("div",{className:c,style:{color:`oklch(var(${u}))`},...i,children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 786 82",children:l.jsx("use",{href:"#pplx-logo-word-ent"})})}):r?l.jsx("div",{className:c,style:{color:`oklch(var(${u}))`},...i,children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 654 101",children:l.jsx("use",{href:"#pplx-logo-word-pro"})})}):s?l.jsx("div",{className:c,style:{color:`oklch(var(${u}))`},...i,children:l.jsx("svg",{viewBox:"0 0 701 100",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("use",{href:"#pplx-logo-word-max"})})}):l.jsx("div",{className:c,style:{color:`oklch(var(${u}))`},...i,children:l.jsx("svg",{viewBox:"0 0 962 202",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("use",{href:"#pplx-logo-word"})})})}),sre={tiny:"w-4 md:w-6",small:"",md:"w-10","md-large":"w-20",large:"w-24",xl:"w-36"},are="w-6 md:w-8",xi=A.memo(function({size:t="large",includeEffects:n=!1,isPro:r=!1,isMax:s=!1,isEnterprise:a=!1,isEducation:o=!1,variant:i="full",color:c="foreground",...u}){let d="w-28 md:w-[140px]";t==="tiny"?d="w-14 md:w-16":t==="small"?d="w-24":t==="large"?d="w-40 md:w-52":t==="xl"&&(d=a?"w-80":"w-64");const m=sre?.[t]||are;let p="w-6";t==="large"?p="w-12":t==="md-large"?p="w-8":t==="xl"&&(p="w-36");const h=z("",{"stroke-foreground":c==="foreground","stroke-quiet":c==="quiet","stroke-super":c==="super"||c==="mixed","stroke-caution":c==="caution","stroke-light":c==="white","stroke-inverse":c==="background","group-hover:stroke-super transition-colors duration-300":n}),g=z({"fill-foreground":c==="foreground"||c==="mixed","fill-quiet":c==="quiet","fill-super":c==="super","fill-caution":c==="caution","fill-light":c==="white","fill-inverse":c==="background","group-hover:fill-super transition-colors duration-300":n});return i==="pro"?l.jsx(nre,{width:p,fillColor:g,...u}):i==="max"?l.jsx(tre,{width:p,...u}):i==="mark"?l.jsx("div",{className:z({"transition-all duration-300 ease-in-out hover:scale-105":n}),children:l.jsx(ere,{fillColor:g,width:m,...u})}):i==="text"?l.jsx(rre,{fillColor:g,width:d,isPro:r,isMax:s,isEnterprise:a,isEducation:o,...u}):i==="full"?l.jsx(Jne,{fillColor:g,lineColor:h,width:d,...u}):null}),ore=A.memo(function({size:t="medium",user:n,showEdit:r,onChange:s,anon:a,altText:o,defaultIcon:i=D("user-filled"),rounded:c=!0,showBackground:u=!0,showProBadge:d,showMaxBadge:m,className:p,badgeProps:h}){const g=a?D("sunglasses-filled"):i,y=f.useCallback(()=>{const b=document.createElement("input");b.type="file",b.accept="image/*",b.onchange=x=>{const _=x.target.files?.[0];if(_){const v=new FileReader;v.onload=C=>{s&&s(C.target?.result)},v.readAsDataURL(_)}},b.click()},[s]);return l.jsx("div",{className:z("text-inverse relative",p),children:l.jsxs("div",{className:z("relative flex aspect-square shrink-0 items-center justify-center",u?"bg-subtler":"bg-transparent",{"rounded-full":c,"size-3":t==="tiny","size-4":t==="mini","size-5":t==="small","size-6":t==="base","size-8":t==="medium","size-10":t==="large","size-20":t==="xlarge","ring-super border-inverse border-2 ring-[1.5px]":d,"ring-max border-inverse border-2 ring-[1.5px]":m}),children:[h?.show&&l.jsx("div",{className:z("absolute right-0 top-0 size-3 -translate-y-1/4 translate-x-1/4 select-none rounded-full border-2",h?.className)}),n&&!a?l.jsx("img",{alt:o??"User avatar",className:z("size-full object-cover",{"rounded-full":c}),src:n}):l.jsx(B,{color:"light",className:"flex items-center justify-center",children:l.jsx(ut,{name:g,className:"size-[65%]"})}),r&&t!=="small"&&l.jsx("div",{className:"bg-base absolute -bottom-1 -right-2 rounded-full",children:l.jsx(st,{ariaLabel:"Edit avatar",variant:n?"common":"primary",size:t!=="xlarge"?"tiny":"small",pill:!0,icon:n?D("edit"):D("plus"),onClick:y})}),d&&l.jsx("div",{className:z("absolute top-full -translate-y-1/2 w-7 rounded-full bg-current p-[1.5px] [&>div]:w-full",{"opacity-0":t==="small"},{"w-lg mt-[-10px]":t==="xlarge"}),children:l.jsx(xi,{size:"tiny",color:"super",variant:"pro",isPro:!0})}),m&&l.jsx("div",{className:z("absolute left-1/2 top-full -translate-y-1/2 flex w-[30px] -translate-x-1/2 items-center justify-center rounded-full bg-current p-[1.5px] [&>div]:w-full",{"opacity-0":t==="small"},{"w-xl mt-[-10px]":t==="xlarge"}),children:l.jsx(xi,{size:"small",variant:"max",isMax:!0})})]})})}),ire=({cometMcpSources:e})=>{const t=Q();return f.useCallback(r=>{if(za(r))return M0[r].icon;if(yi(r))return lre(r,t);if(la(r)){const s=Eu(r);return e[s]?.avatar}},[t,e])};function lre(e,t){const n=Jf(e);if(!n)return;const r=Xi(e),s=t.formatMessage({id:"egoZUguuZl",defaultMessage:"{name} logo"},{name:r});return l.jsx(ore,{user:n,size:"mini",rounded:!1,showBackground:!1,altText:s})}const cre=e=>e?e.toLowerCase().replace(/[\s-]/g,"_").replace(/([a-z])([A-Z])/g,"$1_$2").replace(/^_+|_+$/g,"").replace(/_+/g,"_"):"",NI=e=>e.replace(/_/g," ").replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substring(1).toLowerCase()),_S=e=>{if(!e)return null;try{const t=parseInt(e,16);return String.fromCodePoint(t)}catch{return null}},ure=(e,t=60)=>{if(e.length<=t)return e;const n="",r=t-n.length,s=Math.ceil(r/2),a=Math.floor(r/2);return e.substring(0,s)+n+e.substring(e.length-a)},RI="|",_Ye=e=>e.join(RI),vYe=e=>e?e.split(RI).filter(Boolean):[],DI=({cometMcpSources:e})=>{const t=Q();return f.useCallback(r=>{const s=NI(r);if(za(r))return M0[r].label(t);if(la(r)){const a=Eu(r);return e[a]?.text??a}return yi(r)?Xi(r)??s:s},[t,e])},Gs=()=>{const{cometMcpSources:e}=Su(),t=DI({cometMcpSources:e}),n=ire({cometMcpSources:e});return f.useMemo(()=>({getSourceLabel:t,getSourceIcon:n}),[t,n])},dre=(e,t)=>{const n=t?.isOverlapping??!1,r=t?.stackDirection??"left";if(!e.length)return l.jsx(ye,{icon:D("custom-perplexity-sources-active"),size:"sm"});const s=Math.max(1,t?.maxVisuals??3),a=d=>{if(!(!n||d))switch(t?.size){case"sm":return"-0.25rem";case"md":return"-0.375rem";case"lg":return"-0.5rem";case"xl":return"-0.625rem";default:return}},o=()=>{const d=z("relative flex items-center justify-center",{"rounded-full":t?.shape==="circle"||!t?.shape,"rounded-none":t?.shape==="square","size-4":t?.size==="sm","size-5":t?.size==="md","size-6":t?.size==="lg","size-7":t?.size==="xl"});return!n||!e||!(e.length>1||(t?.alwaysApplyOverlappingStyles??!1))?d:z(d,t?.overlappingClassName??"bg-base ring-subtlest",{"ring-1":t?.size==="sm"||t?.size==="md","ring-2":t?.size==="lg"||t?.size==="xl"})},i=(t?.showRemainderCount??!0)&&e.length>s,c=s===1&&e.length>1&&i?0:i?s-1:Math.min(s,e.length),u=e.slice(0,c).map((d,m)=>l.jsx("div",{className:o(),style:{zIndex:r==="left"?e.length-m-1:e.length+m,marginLeft:a(m===0)},children:d},m));return l.jsxs("div",{className:z("isolate",t?.containerClass??"my-xs flex items-center"),children:[l.jsxs("div",{className:t?.innerClassName??z("flex items-center",{"gap-2":!n}),children:[u,i&&l.jsx("div",{className:z(o(),{"mx-1":c===0}),style:{zIndex:r==="left"?-1:e.length+s,marginLeft:a(c===0)},children:l.jsxs(B,{variant:"tinyMono",color:"light",inline:!0,children:["+",e.length-c]})})]}),t?.rightText&&l.jsx("div",{className:"ml-2",children:t.rightText})]})},fre=5;function mre(e){return e!=null}const II=A.memo(function({sources:t,size:n="default",maxVisuals:r=fre}){const{getSourceIcon:s}=Gs();if(t.length>0){const a=i=>{const c=s(i);return c?FN(c)?l.jsx(_n,{icon:c,size:n},i):l.jsx("span",{className:"inline-flex",children:c},i):null},o=t.map(a).filter(mre);return dre(o,{isOverlapping:!0,maxVisuals:r,size:"md",stackDirection:"right",overlappingClassName:"overflow-hidden bg-base ring-subtlest"})}return l.jsx(_n,{icon:D("custom-perplexity-sources-active"),size:n})}),pre=f.memo(function({source:t,enabled:n,onToggle:r,menuItemType:s="switch"}){const{cometMcpSources:a}=Su(),{getSourceLabel:o,getSourceIcon:i}=Gs(),c=Eu(t),u=a[c];u||Z.error(`Server config not found for comet MCP source: ${t}`);const d=o(t),m=i(t),p=u?.description,h=s==="checkbox"?Qe.CheckboxItem:Qe.SwitchItem,g=l.jsx(h,{leadingAccessory:m,checked:n,onCheckedChange:r,disabled:u?.disabled,children:d});return p?l.jsx(wn,{content:p,side:"right",children:g}):g});var $h;(function(e){e.CONNECTED="connected",e.DISCONNECTED="disconnected"})($h||($h={}));const jI={linear_alt:{name:"Linear",tagline:V({defaultMessage:"Plan and track projects, issues, and team workflows in Linear",id:"6u9Zf65BGW"}),bullets:[V({defaultMessage:"Search across Linear issues, projects, and teams",id:"MicGE6HssU"}),V({defaultMessage:"Create and update Linear issues and projects",id:"scUqB1LbKr"}),V({defaultMessage:"Track progress, plan cycles, and manage workflows",id:"n+QsTyX68H"}),V({defaultMessage:"Data is retrieved from and written back to Linear whenever you query in Perplexity",id:"b/8mLQxIqE"})],developer:V({defaultMessage:"Merge",id:"NLSvjhxxpO"}),websiteUrl:"https://www.linear.app",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/articles/12167711-linear-connector-for-enterprise-pro",footnote:{link:"https://www.perplexity.ai/help-center/en/articles/12167711-linear-connector-for-enterprise-pro",text:V({defaultMessage:"This connector is available through Merge API, Inc. By adding this connector, you agree that Merge will be a data sub-processor.",id:"Hoyn19HgZg"})}},google_drive:{name:"Google Drive",tagline:V({defaultMessage:"Get in-depth answers from your Google Drive content",id:"CDmY5AQsRD"}),bullets:[V({defaultMessage:"Selected files and folders are catalogued for higher accuracy search results",id:"zU56hsbCOC"}),V({defaultMessage:"Updates to your Google Drive files are automatically synced to Perplexity",id:"k0B4qzv3NH"}),V({defaultMessage:"File and folder selection is based on your existing Google Drive permissions",id:"J1Fu/3n3pb"})],consumerBullets:[V({defaultMessage:"Attach files from Google Drive to your query",id:"aUk7jts0tb"})],connectedBullets:[V({defaultMessage:"File and folder selection is based on your existing Google Drive permissions",id:"J1Fu/3n3pb"}),V({defaultMessage:"Opt into High-Precision Search for even more comprehensive answers",id:"5Q/lMIa53X"})],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://drive.google.com",supportUrl:"https://www.perplexity.ai/help-center/en/articles/12870620-connecting-perplexity-with-google-drive",documentationUrl:null,footnote:null},sharepoint:{name:"SharePoint",tagline:V({defaultMessage:"Get in-depth answers from your SharePoint content",id:"H/XGo2cLQi"}),bullets:[V({defaultMessage:"Selected files and folders are catalogued for higher accuracy search results",id:"zU56hsbCOC"}),V({defaultMessage:"Updates to your SharePoint files are automatically synced to Perplexity",id:"3asA6JKlOn"}),V({defaultMessage:"File and folder selection is based on your existing SharePoint permissions",id:"m2/iFnRhkg"})],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://microsoft.sharepoint.com/",supportUrl:"https://www.perplexity.ai/help-center/en/articles/12569435-how-to-use-the-microsoft-sharepoint-connector",documentationUrl:null,footnote:null},onedrive:{name:"OneDrive",tagline:V({defaultMessage:"Get in-depth answers from your OneDrive content",id:"6HI2ZlxJGV"}),bullets:[V({defaultMessage:"Selected files and folders are catalogued for higher accuracy search results",id:"zU56hsbCOC"}),V({defaultMessage:"Updates to your OneDrive files are automatically synced to Perplexity",id:"gCHhNKes4R"}),V({defaultMessage:"File and folder selection is based on your existing OneDrive permissions",id:"YCVPoXax40"})],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://www.microsoft.com/en-us/microsoft-365/onedrive/online-cloud-storage",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/articles/13014066-microsoft-onedrive-connector",footnote:null},box:{name:"Box",tagline:V({defaultMessage:"Get in-depth answers from your Box content",id:"vj5W7AIDE6"}),bullets:[V({defaultMessage:"Selected files and folders are catalogued for higher accuracy search results",id:"zU56hsbCOC"}),V({defaultMessage:"Updates to your Box files are automatically synced to Perplexity",id:"tkl3HRlwOf"}),V({defaultMessage:"File and folder selection is based on your existing Box permissions",id:"LuX1iT7lFa"})],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"http://www.box.com/",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/articles/13130932-using-the-box-connector",footnote:null},dropbox:{name:"Dropbox",tagline:V({defaultMessage:"Get in-depth answers from your Dropbox content",id:"+RPvqEE51/"}),bullets:[V({defaultMessage:"Selected files and folders are catalogued for higher accuracy search results",id:"zU56hsbCOC"}),V({defaultMessage:"Updates to your Dropbox files are automatically synced to Perplexity",id:"Qnsbs8527p"}),V({defaultMessage:"File and folder selection is based on your existing Dropbox permissions",id:"kzOZ3ZFcW4"})],consumerBullets:[V({defaultMessage:"Attach files from Dropbox to your query",id:"E/rzAALT5B"})],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"http://www.dropbox.com/",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/articles/13060839-using-the-dropbox-connector",footnote:null},notion_mcp:{name:"Notion",tagline:V({defaultMessage:"Search and create content on your Notion pages",id:"rXdfDrSVlj"}),bullets:[V({defaultMessage:"Search across your pages and data ",id:"Ib2j2yH5wv"}),V({defaultMessage:"Create new pages in your teamspace from Perplexity",id:"Ltbp+B60OB"}),V({defaultMessage:"Update your data on existing pages directly from Perplexity",id:"ldpNlZAKLQ"}),V({defaultMessage:"Data is retrieved from and written back to Notion whenever you query in Perplexity",id:"nbLEAiWYzT"})],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"http://www.notion.so/",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/articles/12167654-notion-connector-for-enterprise-pro",footnote:null},github_mcp_direct:{name:"GitHub",tagline:V({defaultMessage:"Search and manage your GitHub repositories",id:"67uxBLu4RH"}),bullets:[V({defaultMessage:"Search, analyze, and summarize your repositories and issues",id:"hi8CvW/ld8"}),V({defaultMessage:"Create, update, and manage issues and pull requests ",id:"6eZgVvjZEw"}),V({defaultMessage:"Monitor workflows ",id:"EduR5immBI"}),V({defaultMessage:"Search and manage notifications to streamline communication",id:"+zOuCOpAH8"}),V({defaultMessage:"Data is retrieved from and written back to GitHub whenever you query in Perplexity",id:"9EQO9mj0sd"})],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://github.com/",supportUrl:"https://www.perplexity.ai/help-center/en/articles/12275669-github-connector-for-enterprise",documentationUrl:null,footnote:null},asana_mcp_direct:{name:"Asana",tagline:V({defaultMessage:"Plan and track projects, tasks, and team workflows in Asana",id:"9AhVP0Y+6c"}),bullets:[V({defaultMessage:"Search across Asana tasks, projects, and teams",id:"GKC+Sx/2dm"}),V({defaultMessage:"Create and update Asana tasks and projects",id:"TnQ0Far/ZY"}),V({defaultMessage:"Track progress, plan cycles, and manage workflows",id:"n+QsTyX68H"}),V({defaultMessage:"Data is retrieved from and written back to Asana whenever you query in Perplexity",id:"9NNVAEg7U3"})],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://asana.com/",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/articles/12524801-connecting-perplexity-with-asana",footnote:null},asana_mcp_merge:{name:"Asana",tagline:V({defaultMessage:"Plan and track projects, tasks, and team workflows in Asana",id:"9AhVP0Y+6c"}),bullets:[V({defaultMessage:"Search across Asana tasks, projects, and teams",id:"GKC+Sx/2dm"}),V({defaultMessage:"Create and update Asana tasks and projects",id:"TnQ0Far/ZY"}),V({defaultMessage:"Track progress, plan cycles, and manage workflows",id:"n+QsTyX68H"}),V({defaultMessage:"Data is retrieved from and written back to Asana whenever you query in Perplexity",id:"9NNVAEg7U3"})],developer:V({defaultMessage:"Merge",id:"NLSvjhxxpO"}),websiteUrl:"https://asana.com/",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/articles/12524801-connecting-perplexity-with-asana",footnote:{link:"https://www.perplexity.ai/help-center/en/articles/12524801-connecting-perplexity-with-asana",text:V({defaultMessage:"This connector is available through Merge API, Inc. By adding this connector, you agree that Merge will be a data sub-processor.",id:"Hoyn19HgZg"})}},atlassian_mcp_direct:{name:"Atlassian",tagline:V({defaultMessage:"Plan and track projects, tasks, and team workflows in Atlassian",id:"OKCrVfJwqD"}),bullets:[V({defaultMessage:"Search across Atlassian tasks, projects, and teams",id:"3UDuuWRtR5"}),V({defaultMessage:"Create and update Atlassian tasks and projects",id:"u+44P4c8w+"}),V({defaultMessage:"Track progress, plan cycles, and manage workflows",id:"n+QsTyX68H"}),V({defaultMessage:"Data is retrieved from and written back to Atlassian whenever you query in Perplexity",id:"7gmOJCXim3"})],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://www.atlassian.com/",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/collections/15347354-app-connectors",footnote:null},jira_mcp_merge:{name:"Jira",tagline:V({defaultMessage:"Plan and track projects, tasks, and team workflows in Jira",id:"DBNOet3M55"}),bullets:[V({defaultMessage:"Search across Jira tasks, projects, and teams",id:"nWIt8qYQz1"}),V({defaultMessage:"Create and update Jira tasks and projects",id:"mUCQ5Z26EF"}),V({defaultMessage:"Track progress, plan cycles, and manage workflows",id:"n+QsTyX68H"}),V({defaultMessage:"Data is retrieved from and written back to Jira whenever you query in Perplexity",id:"CfzDXfmKKD"})],developer:V({defaultMessage:"Merge",id:"NLSvjhxxpO"}),websiteUrl:"https://www.atlassian.com/",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/articles/12524825-connecting-perplexity-with-jira",footnote:{link:"https://www.perplexity.ai/help-center/en/articles/12524825-connecting-perplexity-with-jira",text:V({defaultMessage:"This connector is available through Merge API, Inc. By adding this connector, you agree that Merge will be a data sub-processor.",id:"Hoyn19HgZg"})}},confluence_mcp_merge:{name:"Confluence",tagline:V({defaultMessage:"Search and create content on your Confluence pages",id:"7maYua4COa"}),bullets:[V({defaultMessage:"Search across your pages and data ",id:"Ib2j2yH5wv"}),V({defaultMessage:"Create new pages in your teamspace from Perplexity",id:"Ltbp+B60OB"}),V({defaultMessage:"Update your data on existing pages directly from Perplexity",id:"ldpNlZAKLQ"}),V({defaultMessage:"Data is retrieved from and written back to Confluence whenever you query in Perplexity",id:"Ifp49Im16y"})],developer:V({defaultMessage:"Merge",id:"NLSvjhxxpO"}),websiteUrl:"https://www.atlassian.com/",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/articles/12524852-connecting-perplexity-with-confluence",footnote:{link:"https://www.perplexity.ai/help-center/en/articles/12524852-connecting-perplexity-with-confluence",text:V({defaultMessage:"This connector is available through Merge API, Inc. By adding this connector, you agree that Merge will be a data sub-processor.",id:"Hoyn19HgZg"})}},microsoft_teams_mcp_merge:{name:"Microsoft Teams",tagline:V({defaultMessage:"Search and send messages in Microsoft Teams",id:"Rfl+yanh+2"}),bullets:[V({defaultMessage:"Search across Microsoft Teams messages and channels",id:"LF+Ow88sFq"}),V({defaultMessage:"Send and receive messages in Microsoft Teams",id:"1t8qQ+bxf2"}),V({defaultMessage:"Data is retrieved from and written back to Microsoft Teams whenever you query in Perplexity",id:"+bTrwFjG66"})],developer:V({defaultMessage:"Merge",id:"NLSvjhxxpO"}),websiteUrl:"https://teams.microsoft.com",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/articles/12674820-microsoft-teams-connector",footnote:{link:"https://www.perplexity.ai/help-center/en/articles/12674820-microsoft-teams-connector",text:V({defaultMessage:"This connector is available through Merge API, Inc. By adding this connector, you agree that Merge will be a data sub-processor.",id:"Hoyn19HgZg"})}},slack_direct:{name:"Slack",tagline:V({defaultMessage:"Search and post messages across your Slack workspace",id:"eGJ5wb/MzJ"}),bullets:[V({defaultMessage:"Search messages across DMs, private channels, and public channels you have access to in Slack",id:"Om6FOnY7N3"}),V({defaultMessage:"Post messages directly to Slack",id:"UOgLjThccO"}),V({defaultMessage:"Data is retrieved from and written back to Slack whenever you run a query in Perplexity",id:"Fy/OA6Fd79"})],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://slack.com",supportUrl:"https://www.perplexity.ai/help-center/en/articles/12167980-using-the-connector-for-slack",documentationUrl:null,footnote:null},gcal:{name:"Gmail with Calendar",tagline:V({defaultMessage:"Search, create, and manage your emails and calendar events",id:"R3VofVJjT+"}),bullets:[V({defaultMessage:"Search your Gmail and calendar",id:"GCr38D/MA3"}),V({defaultMessage:"Draft and send emails",id:"rMtvi6WyKE"}),V({defaultMessage:"Manage and monitor emails and events",id:"p70DVe/3eQ"}),V({defaultMessage:"Create and update calendar events",id:"ZLhGXocN5/"}),V({defaultMessage:"Data is retrieved from and written back to Gmail and Gcal whenever you query in Perplexity",id:"HsjdaQ7NYa"})],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://accounts.google.com/InteractiveLogin?emr=1&ltmpl=default&nojavascript=1&rm=false&service=mail&ss=1",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/articles/12168040-connecting-perplexity-with-gmail-and-google-calendar",footnote:null},outlook:{name:"Outlook",tagline:V({defaultMessage:"Search your emails and calendar events",id:"zNVRcAj90b"}),bullets:[V({defaultMessage:"Search your Outlook e-mail and calendar",id:"z5Tw6ljNsF"}),V({defaultMessage:"Manage and monitor emails and events",id:"p70DVe/3eQ"}),V({defaultMessage:"Data is retrieved from and written back to Outlook whenever you query in Perplexity",id:"xX8KEtSv2M"})],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://www.microsoft.com/en-us/microsoft-365/outlook/log-in",documentationUrl:null,supportUrl:"https://www.perplexity.ai/help-center/en/articles/12301355-connecting-perplexity-with-outlook-com",footnote:null},zoom:{name:"Zoom",tagline:V({defaultMessage:"Create and manage your Zoom meetings",id:"92puu01bno"}),bullets:[V({defaultMessage:"Create and schedule Zoom meetings",id:"Hg2Nbj5f0/"}),V({defaultMessage:"Manage your Zoom meeting settings",id:"Tb/8DnYiVx"}),V({defaultMessage:"Data is retrieved from and written back to Zoom whenever you query in Perplexity",id:"91ZZe8Fgz9"})],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://zoom.us",documentationUrl:null,supportUrl:null,footnote:null},factset:{name:"FactSet",tagline:V({defaultMessage:"Access financial data and research from FactSet",id:"csQI8CVJ2n"}),bullets:[],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://www.factset.com",documentationUrl:null,supportUrl:null,footnote:null},crunchbase:{name:"Crunchbase",tagline:V({defaultMessage:"Access company and startup data from Crunchbase",id:"K/lfyKAVXx"}),bullets:[],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://www.crunchbase.com",documentationUrl:null,supportUrl:null,footnote:null},wiley:{name:"Wiley",tagline:V({defaultMessage:"Access academic research and publications from Wiley",id:"EpMrMGNDQ2"}),bullets:[],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://www.wiley.com",documentationUrl:null,supportUrl:null,footnote:null},edgar:{name:"EDGAR",tagline:V({defaultMessage:"Access SEC filings and corporate reports",id:"njDhAKsJmy"}),bullets:[],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://www.sec.gov/edgar",documentationUrl:null,supportUrl:null,footnote:null},linear:{name:"Linear",tagline:V({defaultMessage:"Get in-depth answers from your Linear content",id:"TDJJ2nF0Dy"}),bullets:[],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://www.linear.app",documentationUrl:null,supportUrl:null,footnote:null},slack:{name:"Slack",tagline:V({defaultMessage:"Get in-depth answers from your Slack content",id:"XRQBjZFm1m"}),bullets:[],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"https://slack.com",documentationUrl:null,supportUrl:null,footnote:null},wiley_mcp_cashmere:{name:"Wiley",tagline:V({defaultMessage:"Access academic research and publications from Wiley",id:"EpMrMGNDQ2"}),bullets:[],developer:V({defaultMessage:"Cashmere",id:"J/fsB5IZSu"}),websiteUrl:"https://www.wiley.com",documentationUrl:null,supportUrl:null,footnote:{link:"https://www.perplexity.ai/help-center",text:V({defaultMessage:"This connector is available through Cashmere. By adding this connector, you agree that Cashmere will be a data sub-processor.",id:"RcTCE2ZvMT"})}},cbinsights_mcp_cashmere:{name:"CB Insights",tagline:V({defaultMessage:"Access market intelligence and company data",id:"ey7oCLYTbw"}),bullets:[],developer:V({defaultMessage:"Cashmere",id:"J/fsB5IZSu"}),websiteUrl:"https://www.cbinsights.com",documentationUrl:null,supportUrl:null,footnote:{link:"https://www.perplexity.ai/help-center",text:V({defaultMessage:"This connector is available through Cashmere. By adding this connector, you agree that Cashmere will be a data sub-processor.",id:"RcTCE2ZvMT"})}},pitchbook_mcp_cashmere:{name:"PitchBook",tagline:V({defaultMessage:"Access private capital market data",id:"JWsOkBIFuV"}),bullets:[],developer:V({defaultMessage:"Cashmere",id:"J/fsB5IZSu"}),websiteUrl:"https://www.pitchbook.com",documentationUrl:null,supportUrl:null,footnote:{link:"https://www.perplexity.ai/help-center",text:V({defaultMessage:"This connector is available through Cashmere. By adding this connector, you agree that Cashmere will be a data sub-processor.",id:"RcTCE2ZvMT"})}},statista_mcp_cashmere:{name:"Statista",tagline:V({defaultMessage:"Access market and consumer data",id:"XJHKfhIMA3"}),bullets:[],developer:V({defaultMessage:"Cashmere",id:"J/fsB5IZSu"}),websiteUrl:"https://www.statista.com",documentationUrl:null,supportUrl:null,footnote:{link:"https://www.perplexity.ai/help-center",text:V({defaultMessage:"This connector is available through Cashmere. By adding this connector, you agree that Cashmere will be a data sub-processor.",id:"RcTCE2ZvMT"})}},apple_healthkit:{name:"Apple Health",tagline:V({defaultMessage:"Access your apple health data",id:"+Awt09WDyw"}),bullets:[],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"",supportUrl:null,documentationUrl:null,footnote:null},google_docs:{name:"Google Docs",tagline:V({defaultMessage:"Read and edit your Google Docs",id:"GDwDDgdhnx"}),bullets:[],developer:V({defaultMessage:"Perplexity",id:"KCWNcPqV2E"}),websiteUrl:"",documentationUrl:null,supportUrl:null,footnote:null}},hre=e=>e in jI,gre=(e,t=$h.DISCONNECTED)=>{const{$t:n}=Q(),r=jl(),s=eS(),a=f.useMemo(()=>s?.find(o=>o.id===e),[s,e]);return f.useMemo(()=>{if(hre(e)){const{websiteUrl:o,documentationUrl:i,tagline:c,supportUrl:u="https://www.perplexity.ai/help-center/en/articles/10672063-introduction-to-file-connectors-for-enterprise-organizations",footnote:d,consumerBullets:m,bullets:p,connectedBullets:h}=jI[e],g=[{label:"Website",url:o,icon:D("link")}];i&&g.push({label:"Documentation",url:i,icon:D("book")}),u&&g.push({label:"Support",url:u,icon:D("help")});let y=p;return t===$h.CONNECTED&&h?y=h:!r&&m&&(y=m),{name:Xi(e),tagline:c?n(c):null,footnote:d?{link:d.link,text:n(d.text)}:null,bullets:y.map(b=>n(b)),links:g}}if(a){const{name:o,display_name:i,description:c,long_description:u,homepage:d}=a.manifest,m=[];return d&&m.push({label:"Website",url:d,icon:D("link")}),{name:i??o,tagline:c,footnote:null,bullets:u?.split(`
`).map(p=>p.trim()).filter(Boolean)??[],links:m}}return{name:e,tagline:null,footnote:null,bullets:[],links:[]}},[n,e,r,a,t])},no=({reason:e})=>{const{connectorsMap:t}=Do({reason:e});return f.useMemo(()=>({isAllowed:n=>!!t[n],isConnected:n=>t[n]?.connected===!0,getConnectionType:n=>t[n]?.connection_type??null}),[t])},yre=Pe(async()=>{const{ConnectorsEnableModal:e}=await W(async()=>{const{ConnectorsEnableModal:t}=await import("./ConnectorsEnableModal-CgjIAa3C.js");return{ConnectorsEnableModal:t}},__vite__mapDeps([55,2,3,12,1,9,5,7,8,6,56,13,14,15,16,17]));return{default:e}}),xre=A.memo(function({source:t,enabled:n,onToggle:r,menuItemType:s="switch"}){const{tagline:a}=gre(t),o=On(),i=f.useCallback(()=>{o({origin:Ke.SOURCES_VIEW_MORE})},[o]),c=l.jsx(bre,{source:t,enabled:n,onToggle:r,handleOpenPaywall:i,menuItemType:s});return a?l.jsx(wn,{content:a,side:"right",children:l.jsx("span",{children:c})}):c}),bre=({source:e,enabled:t,onToggle:n,handleOpenPaywall:r,menuItemType:s="switch"})=>{const a="sources-menu-item-connector",{isConnected:o,getConnectionType:i}=no({reason:a}),{openModal:c}=Kt(),{getSourceLabel:u,getSourceIcon:d}=Gs(),m=o(e),p=u(e),h=d(e),g=f.useCallback(()=>{c(yre,{connectorName:e,connectorAvatar:$2(e),connectionType:i(e),referrer:"ask",openInNewTab:!0,reason:a,handleOpenPaywall:r})},[c,e,a,i,r]);if(!m){const b=l.jsx(_n,{icon:D("arrow-up-right"),size:"small"});return l.jsx(Qe.Item,{leadingAccessory:h,trailingAccessory:b,onSelect:g,children:p})}const y=s==="checkbox"?Qe.CheckboxItem:Qe.SwitchItem;return l.jsx(y,{leadingAccessory:h,checked:t,onCheckedChange:n,children:p})},PI=f.createContext(null);function _re(){const e=f.useContext(PI);if(!e)throw new Error("useBannerContext must be used within a Banner component");return e}const vre=PI.Provider,Cre={info:{primary:"[&_button]:bg-super [&_button:hover]:bg-super/80 [&_a]:bg-super [&_a:hover]:bg-super/80",secondary:"[&_button]:bg-transparent [&_button]:border-super [&_button]:text-super [&_button:hover]:bg-super/10 [&_a]:bg-transparent [&_a]:border-super [&_a]:text-super [&_a:hover]:bg-super/10",text:"[&_button]:text-super [&_button:hover]:bg-super/10 [&_a]:text-super [&_a:hover]:bg-super/10",tonal:""},success:{primary:"[&_button]:bg-positive [&_button:hover]:bg-positive/80 [&_a]:bg-positive [&_a:hover]:bg-positive/80",secondary:"[&_button]:bg-transparent [&_button]:border-positive [&_button]:text-positive [&_button:hover]:bg-positive/10 [&_a]:bg-transparent [&_a]:border-positive [&_a]:text-positive [&_a:hover]:bg-positive/10",text:"[&_button]:text-positive [&_button:hover]:bg-positive/10 [&_a]:text-positive [&_a:hover]:bg-positive/10",tonal:""},warning:{primary:"[&_button]:bg-attention [&_button:hover]:bg-attention/80 [&_a]:bg-attention [&_a:hover]:bg-attention/80",secondary:"[&_button]:bg-transparent [&_button]:border-attention [&_button]:text-attention [&_button:hover]:bg-attention/10 [&_a]:bg-transparent [&_a]:border-attention [&_a]:text-attention [&_a:hover]:bg-attention/10",text:"[&_button]:text-attention [&_button:hover]:bg-attention/10 [&_a]:text-attention [&_a:hover]:bg-attention/10",tonal:""},error:{primary:"[&_button]:bg-negative [&_button:hover]:bg-negative/80 [&_a]:bg-negative [&_a:hover]:bg-negative/80",secondary:"[&_button]:bg-transparent [&_button]:border-negative [&_button]:text-negative [&_button:hover]:bg-negative/10 [&_a]:bg-transparent [&_a]:border-negative [&_a]:text-negative [&_a:hover]:bg-negative/10",text:"[&_button]:text-negative [&_button:hover]:bg-negative/10 [&_a]:text-negative [&_a:hover]:bg-negative/10",tonal:""}},wre=(e,t)=>e==="default"?"":Cre[e][t]??"";function Sre(e){const{ref:t,variant:n,children:r,disabled:s=!1,...a}=e,{size:o,variant:i}=_re(),c=vN(t),u=Tl(a),d=o==="default"?"small":"tiny",m=!!("href"in e&&e.href),p={ref:c,...u,size:d,disabled:s,fullWidth:!0,variant:n,children:r};let h;if(m){const{href:y,target:b,rel:x,onTrackEvent:_}=e;h=l.jsx(Al,{...p,href:y,target:b,rel:x,onTrackEvent:_})}else{const{onClick:y}=e;h=l.jsx(at,{...p,onClick:y})}const g=z("@md/banner:w-auto w-full",wre(i,n));return l.jsx("div",{className:g,children:h})}const Ere=Rl(z("pt-3","relative flex flex-col items-center w-full","rounded-xl","shadow-sm ","@md/banner:flex-row @md/banner:flex-wrap @md/banner:py-3"),{variants:{size:{default:"gap-md p-md @md/banner:gap-md",compact:"gap-sm p-sm @md/banner:gap-sm"},variant:{default:"bg-subtler",info:"bg-super/10",success:"bg-positive/10",warning:"bg-attention/10",error:"bg-negative/10"}},defaultVariants:{size:"default",variant:"default"}}),kre=Rl("font-semibold",{variants:{size:{default:"text-sm",compact:"text-xs"},variant:{default:"",info:"text-super",success:"text-positive",warning:"text-attention",error:"text-negative"}},defaultVariants:{size:"default",variant:"default"}}),Mre=Rl("mb-0 font-normal leading-[1.3]",{variants:{size:{default:"text-sm",compact:"text-xs"},variant:{default:"text-quiet",info:"text-super/70",success:"text-positive/70",warning:"text-attention/70",error:"text-negative/70"}},defaultVariants:{size:"default",variant:"default"}}),Tre=z("relative flex w-full flex-row items-center","gap-3","@md/banner:mr-sm","@md/banner:flex-[1_1_60%]"),Are=z("flex w-full flex-col items-stretch","gap-sm","@md/banner:flex-row-reverse @md/banner:flex-wrap @md/banner:justify-end @md/banner:gap-sm @md/banner:w-auto @md/banner:items-center","@md/banner:ml-auto"),Nre={default:"",info:"text-super",success:"text-positive",warning:"text-attention",error:"text-negative"};function Rre({title:e,description:t,leadingAccessory:n,children:r,size:s="default",variant:a="default",...o}){const{onClose:i,closeButtonLabel:c}="onClose"in o?o:{onClose:void 0,closeButtonLabel:void 0},u=f.useMemo(()=>({size:s,variant:a}),[s,a]),d=f.useMemo(()=>r?[...Array.isArray(r)?r:[r]].reverse():[],[r]),m=s==="default"?"small":"tiny",p=i&&c?l.jsx(at,{icon:D("x"),variant:"text",size:m,onClick:i,"aria-label":c}):null,h=d.length>0,g=h||!!p,y=h;return l.jsx(vre,{value:u,children:l.jsx("div",{className:"@container/banner",children:l.jsxs("div",{className:Ere({size:s,variant:a}),children:[l.jsxs("div",{className:Tre,children:[n&&l.jsx("div",{className:z("shrink-0",Nre[a]),children:l.jsx(_n,{icon:n,size:s==="compact"?"small":"default"})}),l.jsxs("div",{className:"flex-1 overflow-hidden",children:[p&&l.jsx("div",{className:"float-right ml-2 @md/banner:hidden",children:p}),l.jsx("div",{className:kre({size:s,variant:a}),children:e}),t&&l.jsx("div",{className:Mre({size:s,variant:a}),children:t}),l.jsx("div",{className:"clear-both"})]})]}),g&&l.jsxs("div",{className:z(Are,!y&&"hidden @md/banner:block"),children:[p&&l.jsx("div",{className:"hidden shrink-0 @md/banner:block",children:p}),d]})]})})})}const Zi=Object.assign(Rre,{Action:Sre}),Dre=(e,t)=>{switch(e){case"wiley_mcp_cashmere":return t.formatMessage({defaultMessage:"Search business, medical, STEM, and psychology books, and medical & life sciences journals",id:"RX0/lKeA+h"});case"cbinsights_mcp_cashmere":return t.formatMessage({defaultMessage:"Search market insights, market maps, and company activity",id:"7NjNyz7XKj"});case"pitchbook_mcp_cashmere":return t.formatMessage({defaultMessage:"Search firmographics for private and public companies",id:"pCeNCFTGuu"});case"statista_mcp_cashmere":return t.formatMessage({defaultMessage:"Search aggregated statistics, market data, trends, and forecasts",id:"vo4Zj58C7M"});default:St(e)}},Ire=e=>{switch(e){case"wiley_mcp_cashmere":return R0;case"cbinsights_mcp_cashmere":return yS;case"pitchbook_mcp_cashmere":return xS;case"statista_mcp_cashmere":return bS;default:return e}},OI=[{type:"patents",label:{id:"fqp+hGjNR9",defaultMessage:"Perplexity Patents"},visual:{kind:"icon",icon:D("award")},match:e=>!!e?.meta_data?.patent_name||!!e?.url&&Yg(e.url)},{type:"wiley",label:{id:"wiley-branded-source",defaultMessage:R0},visual:{kind:"avatar",url:Vc},match:e=>e?.meta_data?.mcp_server==="wiley_mcp_cashmere"||e?.meta_data?.connection_type==="WILEY"},{type:"pitchbook",label:{id:"pitchbook-branded-source",defaultMessage:xS},visual:{kind:"avatar",url:A0},match:e=>e?.meta_data?.mcp_server==="pitchbook_mcp_cashmere"},{type:"cbinsights",label:{id:"cbinsights-branded-source",defaultMessage:yS},visual:{kind:"avatar",url:T0},match:e=>e?.meta_data?.mcp_server==="cbinsights_mcp_cashmere"},{type:"statista",label:{id:"statista-branded-source",defaultMessage:bS},visual:{kind:"avatar",url:N0},match:e=>e?.meta_data?.mcp_server==="statista_mcp_cashmere"}],jre=Object.fromEntries(OI.map(e=>[e.type,e.label]));function em(e){if(!e)return null;const t=OI.find(n=>n.match(e));return t?{type:t.type,label:t.label,visual:t.visual}:null}function Pre(e){return em(e)?.label??null}function Ore(e){const t=e.meta_data,n=typeof t?.citation_domain_name=="string"?t.citation_domain_name:void 0;if(n)return n;const r=Pre({url:e.url,meta_data:t});if(r&&typeof r.defaultMessage=="string")return r.defaultMessage;if(t?.connection_type||e.is_memory||e.is_conversation_history)return e.name}function D0(e){if(!e)return!1;const t=e.meta_data,n=typeof t?.wiley_book_uuid=="string"&&t?.wiley_book_uuid!=="",r=typeof t?.is_premium_datasource=="boolean"&&t?.is_premium_datasource===!0;return n||r}function vS(e){if(!e)return{source_type:"unknown",is_premium:!1};const t=D0(e),n=Ore(e);let r="web";const s=e.meta_data;return e.is_attachment?r="attachment":e.is_image?r="image":e.is_memory?r="memory":e.is_conversation_history?r="conversation_history":e.is_knowledge_card?r="knowledge_card":e.is_navigational?r="navigational":e.is_code_interpreter?r="code_interpreter":Io(e)?r="patent":s?.connection_type?r=String(s.connection_type).toLowerCase():t&&(r="premium_datasource"),{source_name:n,source_type:r,is_premium:t}}const Lre=({variant:e})=>{switch(e){case"premium":return l.jsx(be,{id:"Hw1hSDsL+0",defaultMessage:"Premium data"})}},CS=f.memo(function({variant:t,appearance:n}){const r=l.jsx(Lre,{variant:t}),s="inline-flex h-5 shrink-0 items-center gap-0.5 whitespace-nowrap rounded border px-1 font-mono";return n==="dark"?l.jsx("span",{className:z(s,"border-[var(--dark-super-color)] text-2xs text-[var(--dark-super-color)]"),children:r}):n==="light"?l.jsx("span",{className:z(s,"border-[var(--light-super-color)] text-2xs text-[var(--light-super-color)]"),children:r}):l.jsx(B,{variant:"micro",color:"super",className:z(s,"border-super"),children:r})});function LI(e){return D0(e)||Io(e)?"premium":null}function xo(e){return!!LI(e)}const FI=f.memo(function({result:t}){const n=LI(t);return n?l.jsx(CS,{variant:n}):null}),Fre={wiley_mcp_cashmere:"https://www.perplexity.ai/help-center/en/articles/12868503-using-perplexity-with-wiley",pitchbook_mcp_cashmere:"https://www.perplexity.ai/help-center/en/articles/12869442-leveraging-pitchbook-data-with-perplexity",statista_mcp_cashmere:"https://www.perplexity.ai/help-center/en/articles/12869733-using-premium-statista-data-with-perplexity",cbinsights_mcp_cashmere:"https://www.perplexity.ai/help-center/en/articles/12869855-integrating-cb-insights-data-with-perplexity"},UI=({source:e})=>{const t=Q(),{isMax:n}=Mt(),r=Ire(e),s=Dre(e,t),{getSourceLimit:a}=Kf(),o=Fre[e],i=f.useMemo(()=>{const{remaining:c}=a(e);return c===0},[a,e]);return l.jsxs("div",{className:z("flex flex-col gap-2 p-2",{"max-super-override":n}),children:[l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsx(B,{variant:"tinyBold",color:"white",children:r}),l.jsx(CS,{variant:"premium",appearance:"dark"})]}),l.jsx(B,{variant:"tiny",color:"white",className:"text-pretty",children:s}),o&&l.jsx("p",{className:"text-pretty text-xs text-white",children:l.jsx(Al,{href:o,target:"_blank",rel:"noopener",variant:"inline",muted:!0,children:t.formatMessage({defaultMessage:"Learn about complementary paid content from {sourceName}",id:"8uL70j2Vzs"},{sourceName:r})})}),i&&l.jsx("div",{className:"mt-2",children:l.jsx(Zi,{variant:"warning",size:"compact",leadingAccessory:D("alert-triangle"),title:t.formatMessage({defaultMessage:"You've reached your monthly limit for this source.",id:"AWo+MH4QlU"})})}),l.jsx(Bre,{})]})},Ure=({variant:e,onClick:t,children:n})=>l.jsx(Ls,{onClick:t,className:z(Zg({variant:"primary",size:"small",disabled:!1,fullWidth:!1,rounded:!1,pill:!1,inline:!1}),{"!bg-max hover:!bg-max":e==="max"}),children:n}),Bre=()=>{const{$t:e}=Q(),t=On();jl();const{hasAccessToProFeatures:n,isMax:r}=Mt(),s=f.useCallback(()=>{t({origin:Ke.PREMIUM_SOURCE_TOOLTIP})},[t]),a=Hre({hasAccessToProFeatures:n,hasAccessToMaxFeatures:r});if(!a)return null;const o=n&&!r,i=o?"max":"pro",c=z("text-pretty",{"text-max":o,"text-super":!o});return l.jsxs(l.Fragment,{children:[l.jsx("hr",{className:"border-subtle bg-subtle my-2"}),l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx(B,{variant:"tinyRegular",className:c,children:e(a.title)}),l.jsx(Ure,{variant:i,onClick:s,children:e(a.action)})]})]})};function Hre({hasAccessToProFeatures:e,hasAccessToMaxFeatures:t}){return e?t?null:{title:V({defaultMessage:"Get more queries with Max",id:"0iyoM20VTJ"}),action:V({defaultMessage:"Try Perplexity Max",id:"oorH6wdruv"})}:{title:V({defaultMessage:"Get more queries with Pro",id:"BZEuCK3Abs"}),action:V({defaultMessage:"Try Perplexity Pro",id:"qXQPclCIaf"})}}const Vre=A.memo(function({source:t,enabled:n,onToggle:r,menuItemType:s="switch"}){const{openOverlayId:a,setOpenOverlayId:o}=Gf(),{getSourceLabel:i,getSourceIcon:c}=Gs(),u=i(t),d=c(t),{getSourceLimit:m}=Kf(),p=f.useRef(null),h=f.useId(),g=f.useCallback(()=>{p.current&&clearTimeout(p.current),o(h)},[h,o]),y=f.useCallback(()=>{p.current=setTimeout(()=>{o(v=>v===h?null:v)},300)},[h,o]),b=f.useMemo(()=>{const{remaining:v}=m(t);return v===0},[m,t]),x=s==="checkbox"?Qe.CheckboxItem:Qe.SwitchItem,_=f.useMemo(()=>l.jsx("div",{onMouseEnter:g,onMouseLeave:y,children:l.jsx(x,{leadingAccessory:d,checked:n,onCheckedChange:r,disabled:b,children:u})}),[b,n,g,y,d,u,r,x]);return l.jsx(fa,{interaction:"hover",appearance:"dark",triggerElement:_,side:"right",open:a===h,onOpenChange:jr,children:l.jsx("div",{onMouseEnter:g,onMouseLeave:y,children:l.jsx(UI,{source:t})})})}),Gre=(e,t)=>{if(za(e))return M0[e].description(t)},s4=f.memo(function({source:t,enabled:n,onToggle:r,menuItemType:s="switch"}){const a=Q(),{getSourceLabel:o,getSourceIcon:i}=Gs(),c=o(t),u=i(t),d=Gre(t,a),m=s==="checkbox"?Qe.CheckboxItem:Qe.SwitchItem,p=l.jsx(m,{leadingAccessory:u,checked:n,onCheckedChange:r,children:c});return d?l.jsx(wn,{content:d,side:"right",children:p}):p}),zre=A.memo(function({source:t,enabled:n,onToggle:r,menuItemType:s="switch"}){const{isMax:a}=Mt(),o=f.useCallback(i=>{i.stopPropagation()},[]);return l.jsx("div",{onClick:o,className:z({"max-super-override":a}),children:l.jsx(qre,{source:t,enabled:n,onToggle:r,menuItemType:s})})}),qre=({source:e,enabled:t,onToggle:n,menuItemType:r="switch"})=>hi(e)?l.jsx(Vre,{source:e,enabled:t,onToggle:n,menuItemType:r}):za(e)?l.jsx(s4,{source:e,enabled:t,onToggle:n,menuItemType:r}):yi(e)?l.jsx(xre,{source:e,enabled:t,onToggle:n,menuItemType:r}):la(e)?l.jsx(pre,{source:e,enabled:t,onToggle:n,menuItemType:r}):l.jsx(s4,{source:e,enabled:t,onToggle:n,menuItemType:r}),$re=A.memo(function({source:t,onSourceToggled:n,isSourceEnabled:r,menuItemType:s="switch"}){const a=f.useCallback(o=>n(t,o),[n,t]);return l.jsx(zre,{source:t,enabled:r(t),onToggle:a,menuItemType:s},t)}),a4=A.memo(function({sources:t,isSourceEnabled:n,onSourceToggled:r,menuItemType:s="switch"}){return t.map(a=>l.jsx($re,{source:a,onSourceToggled:r,isSourceEnabled:n,menuItemType:s},a))}),Wre=f.memo(function(){const t=l.jsx(_n,{icon:D("arrow-up-right"),size:"small"});return l.jsx(Qe.LinkItem,{trailingAccessory:t,href:"/account/connectors",children:"Manage Connectors"})}),Kre=f.memo(function(){const t=On(),{$t:n}=Q(),r=wt(),{openVisitorLoginUpsell:s}=ws({enabled:!r}),a=f.useCallback(()=>{if(!r){const o=new URL(window.location.href);o.searchParams.set("upsell","sources"),s({title:n({defaultMessage:"Sign in to connect more sources",id:"2nkj+bbNku"}),description:n({defaultMessage:"Access more sources to enhance your searches with Perplexity",id:"TXk0EQA72B"}),origin:Ke.SOURCES_VIEW_MORE,overrideRedirectUrl:o.toString()});return}t({pitchMessage:{title:n({defaultMessage:"Upgrade to connect more sources",id:"fT8uzTJSdX"}),description:n({defaultMessage:"With Perplexity Pro, connect more sources to enhance your searches",id:"tWT1NCuTCh"})},origin:Ke.SOURCES_VIEW_MORE})},[n,r,s,t]);return l.jsx(Qe.Item,{onSelect:a,children:l.jsx(be,{defaultMessage:"Upgrade to connect more sources",id:"fT8uzTJSdX"})})}),Yre=({sources:e,omit:t=_e})=>{const n="use-enabled-sources",{isConnected:r}=no({reason:n}),s=f.useMemo(()=>{const a=new Set;return e.forEach(o=>{if(!t.includes(o)){if(!yi(o)||hi(o)){a.add(o);return}r(o)&&a.add(o)}}),Array.from(a)},[e,t,r]);return f.useMemo(()=>({sources:s}),[s])},Qre=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"connectors-direct-api-search",defaultValue:e,extraAttributes:t,subjectType:"user_nextauth_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},Xre="BYPASS",Zre=()=>{const e=jl(),{variation:t}=Qre(!1,{connectionType:Xre}),n=f.useMemo(()=>({web:!0,scholar:!0,social:!0,org:e,my_files:t&&e}),[e,t]),r=f.useCallback(s=>n[s],[n]);return f.useMemo(()=>({isAllowed:r}),[r])},Jre=["apple_healthkit"];function W2(e){return Jre.includes(e)}const ese=(e,{getSourceLabel:t})=>e.sort((n,r)=>{const s=t(n),a=t(r);return s.localeCompare(a)}),tse=e=>e.sort((t,n)=>{const r=za(t),s=za(n);return r&&!s?-1:!r&&s?1:0}),nse=e=>e.sort((t,n)=>t==="web"&&n!=="web"?-1:t!=="web"&&n==="web"?1:0),rse=["space","sports","my_files","apple_healthkit","github_delegate_bot","google_docs"];function K2(e){return rse.includes(e)}const sse=[ese,tse,nse],Ai=({isConnectorAllowed:e,isConnectorConnected:t,omittedSources:n=_e,omitCometMcpSources:r=!1})=>{const{cometMcpSources:s}=Su(),a=DI({cometMcpSources:s}),{isAllowed:o}=Zre(),i=f.useCallback(m=>{const p=Eu(m);return Object.keys(s).includes(p)},[s]),c=f.useCallback(m=>K2(m)||n.includes(m)?!1:za(m)?o(m):hi(m)||yi(m)?e(m):la(m)?r?!1:i(m):W2(m)?!0:(pi.error(`[useSources] Unknown source type: ${m}`),!1),[e,i,o,n,r]),u=f.useCallback(m=>K2(m)||n.includes(m)?!1:za(m)?o(m):hi(m)?e(m):yi(m)?t(m):la(m)?r?!1:i(m):W2(m)?!0:(pi.error(`[useSources] Unknown source type: ${m}`),!1),[e,t,i,o,n,r]),d=f.useMemo(()=>{const m=Object.keys(s).map(h=>yD(h)).filter(la).filter(c),p=Object.keys(Qo).filter(Ga).filter(c);return sse.reduce((h,g)=>g(h,{getSourceLabel:a}),[...p,...m])},[c,s,a]);return f.useMemo(()=>({sources:d,isSourceAllowed:c,isSourceConnected:u}),[d,c,u])},ase="pplx_source_activity",BI=25,I0=()=>{const[e,t]=vs(ase,[]),n=f.useCallback(r=>{t(s=>{const a=s.filter(o=>o.sourceType!==r);return[{sourceType:r,lastUsedAt:Date.now()},...a].slice(0,BI)})},[t]);return f.useMemo(()=>({activity:e,trackSourceActivity:n}),[e,n])},ose={crunchbase:["web"]},ise={web:["crunchbase"]},wS=f.memo(function({sources:t,onChange:n,suggestedSources:r=_e,omittedSources:s=_e,omitCometMcpSources:a=!1,menuItemType:o="switch"}){const i="sources-menu-content",{hasAccessToProFeatures:c}=Mt(),{isAllowed:u,isConnected:d}=no({reason:i}),{sources:m}=Ai({omitCometMcpSources:a,isConnectorAllowed:u,isConnectorConnected:d,omittedSources:s}),{trackSourceActivity:p}=I0(),{sources:h}=Yre({sources:m,omit:r}),g=f.useMemo(()=>[...r,...h],[r,h]),y=f.useMemo(()=>m.filter(C=>!g.includes(C)).slice(0,5),[m,g]),b=f.useCallback(C=>t.includes(C),[t]),x=f.useCallback(C=>{p(C);const w=new Set([...t,C]);ose[C]?.forEach(S=>{w.add(S)}),n(Array.from(w))},[t,n,p]),_=f.useCallback(C=>{const w=new Set(t);w.delete(C),ise[C]?.forEach(S=>{w.delete(S)}),n(Array.from(w))},[t,n]),v=f.useCallback((C,w)=>{b(C)!==w&&(w?x(C):_(C))},[b,x,_]);return l.jsxs(l.Fragment,{children:[!c&&l.jsxs(l.Fragment,{children:[l.jsx(Kre,{}),l.jsx(Qe.Separator,{})]}),l.jsx(a4,{sources:g,isSourceEnabled:b,onSourceToggled:v,menuItemType:o}),l.jsx(Qe.Separator,{}),l.jsx(a4,{sources:y,isSourceEnabled:b,onSourceToggled:v,menuItemType:o}),c&&l.jsx(Wre,{})]})}),lse=["cbinsights_mcp_cashmere","gcal","google_drive"],j0=({sources:e,defaultSuggestions:t=lse,count:n=BI})=>{const{activity:r}=I0(),[s,a]=f.useState(r),o=f.useMemo(()=>{const c=new Set(["web"]);return s.sort((u,d)=>d.lastUsedAt-u.lastUsedAt).map(u=>u.sourceType).filter(Ga).forEach(u=>c.add(u)),t.forEach(u=>c.add(u)),Array.from(c).filter(u=>e.includes(u)).slice(0,n)},[s,n,e,t]),i=f.useCallback(()=>{a(r)},[r]);return f.useMemo(()=>({suggested:o,refresh:i}),[o,i])},cse=5;function CYe(e){return!!(e&&e.length===1&&e[0]==="web")}const use=[];f.memo(function({isOpen:t,onToggle:n,sources:r,onSourcesChange:s,disabled:a=!1,omittedSources:o=use,omitCometMcpSources:i=!1}){const c="ask-input-sources-menu",[u,d]=f.useState(!1),m=t??u,p=n??d,{getSourceLabel:h}=Gs(),{locale:g}=Q(),y=Zg({pill:!0,variant:"tonal",size:"small"}),{isAllowed:b,isConnected:x}=no({reason:c}),{sources:_}=Ai({omitCometMcpSources:i,isConnectorAllowed:b,isConnectorConnected:x,omittedSources:o}),{suggested:v,refresh:C}=j0({sources:_}),w=f.useCallback(E=>{p(E),E&&C()},[p,C]),S=f.useMemo(()=>{const E=r.filter(k=>k!=="web"),T=l.jsx(Ls,{className:y,disabled:a,children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(II,{sources:E.slice(0,cse),size:"small"}),l.jsx(dse,{sources:E})]})});if(a&&E.length>1){const k=E.map(N=>h(N)),M=new Intl.ListFormat(g,{style:"long",type:"conjunction"}).format(k);return l.jsx(wn,{content:M,children:l.jsx("div",{children:T})})}return T},[y,r,a,h,g]);return l.jsx(Qe,{isOpen:m,onToggle:w,minWidthPx:200,triggerElement:S,children:l.jsx(wS,{sources:r,onChange:s,suggestedSources:v,omittedSources:o,omitCometMcpSources:i,menuItemType:"checkbox"})})});const dse=({sources:e})=>{const{getSourceLabel:t}=Gs();if(e.length===1){const n=e[0],r=t(n);return l.jsx("span",{children:r})}return l.jsxs(l.Fragment,{children:[l.jsx(be,{defaultMessage:"{count, plural, one {Source} other {Sources}}",id:"qfwGBlSMK5",values:{count:e.length}}),l.jsx("span",{className:"text-quieter",children:e.length})]})};function P0({defaultSource:e,reason:t}){const{sources:n,setSources:r}=En(),s=nn(),{fileRepoInfo:a}=Fw({reason:t}),{isLoading:o}=Hs({reason:t}),{publishIpcMessage:i,subscribeToIpcMessage:c}=h0(),{isAllowed:u,isConnected:d}=no({reason:t}),{sources:m}=Ai({isConnectorAllowed:u,isConnectorConnected:d}),p=a.file_repository_type==="COLLECTION",h=p?`space-${a.owner_id}`:"home",g=fu(),y=Array.isArray(g?.slug)?g.slug[0]:g?.slug,{collection:b,isLoading:x}=jR({collectionSlug:y,reason:t}),_=x?void 0:b?.enable_web_by_default,v=f.useRef(Math.random().toString(36).substring(7)),C=f.useCallback(M=>{let N=[];return n?.includes(M)?(N=n.filter(P=>P!==M),M==="web"&&n.includes("crunchbase")&&(N=n.filter(P=>P!=="crunchbase"&&P!=="web"))):(N=[...n||[]],M==="crunchbase"&&!N.includes("web")&&N.push("web"),N.push(M)),p&&Lx(N,h),r(N),i(Zl,{type:Zl,sources:N,windowId:v.current}),N},[p,h,r,n,i]),w=f.useCallback(M=>{n?.includes(M)||C(M)},[n,C]),S=f.useCallback(M=>{n?.includes(M)&&C(M)},[n,C]),E=f.useCallback(M=>n?.includes(M)??!1,[n]),T=f.useCallback(M=>{const N=[...M];N.includes("crunchbase")&&!N.includes("web")&&N.push("web"),p&&Lx(N,h),r(N),i(Zl,{type:Zl,sources:N,windowId:v.current})},[p,h,r,i]);f.useEffect(()=>c(Zl,M=>{M.type===Zl&&M.windowId!==v.current&&r(M.sources)}),[c,r,n]);const k=f.useMemo(()=>{if(x)return new Set([]);if(p)return _?new Set(["web"]):new Set([]);if(e)return new Set([e]);const N=(s?.get("sources")??"web").split(",").map(P=>P.trim()).filter(Ga);return new Set(N||["web"])},[p,x,_,s,e]);return f.useEffect(()=>{if(o)return;let M=p?qY(h)||[...k]:[...k];if(p&&_&&!M.includes("web")?M.push("web"):p&&!_&&M.includes("web")&&(M=M.filter(P=>P!=="web")),JSON.stringify(n||[])!==JSON.stringify(M)){const P=M.filter(O=>m.includes(O));p&&Lx(P,h),r(P)}},[o,p,_]),f.useMemo(()=>({DEFAULT_SOURCES:k,sources:n,isSpace:p,isSpaceEnableWebByDefault:_,toggleSource:C,setSources:r,addSource:w,removeSource:S,hasSource:E,overwriteSources:T}),[k,n,p,_,T,C,r,w,S,E])}const fse=[];function HI({useThreadSources:e,reason:t="use-global-available-sources"}){const{sources:n,setSources:r}=P0({reason:t}),{cometMcpSources:s,cometMcpDisabledServers:a,setCometMcpSources:o}=Su(),{firstResult:i}=Ht(),c=i?.sources?.sources??fse,u=f.useMemo(()=>e?c.filter(Ga):n,[e,c,n]),d=f.useMemo(()=>{const g=Object.keys(s).filter(y=>!a?.has(y)).map(y=>yD(y));return[...u,...g]},[u,s,a]),m=f.useCallback(g=>{const y=g.filter(la),b=g.filter(Ga);o(y.map(x=>Eu(x))),r(b)},[r,o]),p=f.useCallback(g=>{d.includes(g)||m([...d,g])},[d,m]),h=f.useCallback(g=>{d.includes(g)&&m(d.filter(y=>y!==g))},[d,m]);return{sources:d,setSources:m,addSource:p,removeSource:h}}function mse(e){const{isFollowUp:t}=e,{forceEnableBrowserAgent:n}=Fr(),{setForceEnableBrowserAgent:r}=Fs(),s=f.useCallback(()=>{r(!1)},[r]);return f.useMemo(()=>!n||t?{showBrowseForMeTag:!1}:{showBrowseForMeTag:!0,onRemove:s},[n,t,s])}f.memo(function({exhaustedSearchMode:t,onClearExhaustedMode:n}){const{$t:r}=Q(),[s,a]=f.useState(!1),o=On(),i=Ia(t),c=Yn[t].description,u=f.useCallback(()=>a(!0),[]),d=f.useCallback(()=>a(!1),[]),m=f.useCallback(()=>{o({origin:Ke.SEARCH_MODE_EXHAUSTED_POPOVER,highlightTier:"max",pitchMessage:{title:r({defaultMessage:"You've reached your limit",id:"YaZombxoEl"})}})},[o,r]),p=s?D("x"):D("alert-triangle"),h=l.jsxs("div",{className:"gap-sm p-xs flex flex-col",children:[l.jsx(B,{variant:"smallBold",children:r({defaultMessage:"You've reached your limit",id:"YaZombxoEl"})}),l.jsx(B,{variant:"tiny",color:"light",children:l.jsx(be,{...c})}),l.jsx(at,{variant:"primary",size:"small",onClick:m,children:r({defaultMessage:"Upgrade for more access",id:"MRMwxnSO/+"})})]});return l.jsx(fa,{interaction:"hover",side:"top",maxWidthPx:240,triggerElement:l.jsx("div",{onMouseEnter:u,onMouseLeave:d,className:"inline-flex",children:l.jsx("div",{className:s?"":"opacity-50",children:l.jsx(at,{variant:"tonal",size:"small",pill:!0,leadingIcon:p,onClick:n,children:l.jsx(be,{...i})})})}),children:h})});const pse=f.memo(function(){const{$t:t}=Q();return l.jsx(Qe.Item,{disabled:!0,leadingAccessory:D("paperclip"),onSelect:jr,subtitle:t({defaultMessage:"Disabled by your organization",id:"cBE0Jgy5fu"}),children:l.jsx(be,{defaultMessage:"Add files or images",id:"VA0iuuympq"})})}),VI=Bt("ConnectorFilePickerContext",null),hse=()=>{const e=f.useContext(VI);if(!e)throw new Error("useConnectorFilePickerContext must be used within ConnectorFilePickerProvider");return e},gse=(e,t)=>e.parentReference.sharepointIds?.siteId&&t==="sharepoint"?JSON.stringify({item_id:e.id,drive_id:e.parentReference.driveId,site_id:e.parentReference.sharepointIds.siteId}):e.id,GI=(e,t)=>{const n=Fl(e.name);return n?{id:gse(e,t),name:e.name,sizeBytes:e.size,mimeType:mS[n]}:null},zI=e=>{const t=Fl(e.name);return t?{id:e.id,name:e.name,sizeBytes:e.bytes,mimeType:mS[t]}:null},qI=e=>({id:e.id,name:e.name,sizeBytes:e.size,mimeType:mS[e.extension]});var Fd;(function(e){e.TIMEOUT="TIMEOUT",e.AUTH="AUTH",e.POPUP_BLOCKED="POPUP_BLOCKED"})(Fd||(Fd={}));class yse extends Error{code;constructor(t,n){super(n),this.code=t,this.name="MicrosoftPickerError"}}const o4=(e,t)=>new yse(e,t),SS=[".txt",".pdf",".docx",".pptx",".xlsx",".md",".csv"],ES=[".txt",".pdf",".jpg",".jpeg",".png",".docx",".pptx",".xlsx",".md",".csv"],kS=[".mp3",".wav",".aiff",".ogg",".flac",".mp4",".mpeg",".mov",".avi",".flv",".mpg",".webm",".wmv",".3gp"],i4=27,xse=2e4;let Kx=!1,co=null;const $I=()=>{const e=f.useRef(null),t=f.useRef(null),n=f.useRef(null);let r="";typeof window<"u"&&(window.location.hostname==="localhost"?r=`${window.location.protocol}//${window.location.hostname}:${window.location.port}/account/connectors`:r=`${window.location.protocol}//${window.location.hostname}/account/connectors`);const s=f.useCallback(u=>!!u&&u.length===36&&u.split("-").length===5,[]),a=f.useCallback((u,d,m,p,h)=>{if(!d&&u==="sharepoint"&&m){const g=m.match(/^https?:\/\/([^.]+)\.sharepoint\.com/i);if(g)return g[1]}if(!d&&u==="onedrive"&&s(h)&&p){const g=p.match(/@([^.]+)\./);if(g)return g[1]+"-my"}return d?u==="sharepoint"?d:d+"-my":null},[s]),o=f.useCallback(async(u,d)=>{d.success=!1;let m=null;const p=a(u.connector,u.tenantName,u.webUrl,u.loginHint,u.accountIdentifier);d.tenant=p,co||(co=await(await W(()=>import("./index-C8ZFoyX1.js"),__vite__mapDeps([57,3]))).PublicClientApplication.createPublicClientApplication({auth:{authority:p?"https://login.microsoftonline.com/common":"https://login.microsoftonline.com/consumers",clientId:u.clientId,redirectUri:r},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!0}}));const h=p?[`https://${p}.sharepoint.com/.default`]:["OneDrive.ReadWrite"];d.scopes=h;const g={scopes:h,login_hint:u.loginHint,prompt:"select_account"};let y=null,b=co.getActiveAccount();if(b||(b=co.getAllAccounts().find(_=>_.username===u.loginHint)??null),d.hasActiveAccount=!!b?.username,b)try{co.setActiveAccount(b),y=(await co.acquireTokenSilent(g)).accessToken}catch(x){d.silentAcquisitionError=x instanceof Error?x.toString():x}if(!y&&!Kx)try{Kx=!0;const x=await co.loginPopup(g);co.setActiveAccount(x.account),y=(await co.acquireTokenSilent(g)).accessToken}catch(x){d.interactiveAcquisitionError=x instanceof Error?x.toString():x,x?.errorCode==="popup_window_error"&&(d.interactiveAcquisitionErrorCode="popup_window_error",m=Fd.POPUP_BLOCKED)}finally{Kx=!1}else y||(d.interactiveAuthenticationSkipped=!0);if(y)return d.success=!0,d.accessTokenLength=y.length,y;throw o4(m??Fd.AUTH,"Access token not acquired")},[r,a]),i=f.useCallback(u=>{const d=a(u.connector,u.tenantName,u.webUrl,u.loginHint,u.accountIdentifier);let m=u.mode==="source"?SS:ES;m=u.isAudioVideoFilesEnabled?m.concat(kS):m;const p=u.connector==="sharepoint"?{recent:!0,oneDrive:!1,sharedLibraries:!0}:{recent:!0,oneDrive:!0,sharedLibraries:!1},h={sdk:"8.0",messaging:{origin:r,channelId:i4},authentication:{},entry:u.connector==="sharepoint"?{sharePoint:{}}:{oneDrive:{}},typesAndSources:{mode:u.mode==="attachment"?"files":"all",filters:m,pivots:p},selection:{mode:"multiple"}},g=new URLSearchParams({filePicker:JSON.stringify(h)});return u.webUrl?`${u.webUrl}/_layouts/15/FilePicker.aspx?${g}`:d?`https://${d}.sharepoint.com/_layouts/15/FilePicker.aspx?${g}`:`https://onedrive.live.com/picker?${g}`},[r,a]),c=f.useCallback(async u=>{const d=C=>{window.removeEventListener("message",g),t.current?.removeEventListener("message",h),t.current?.close(),e.current?.close(),C?u.onError?.(C):u.onCancel?.()},m=(C,w)=>(n.current||(n.current=(async()=>{try{return await o(C,w)}finally{n.current=null}})()),n.current),p=async(C,w)=>n.current?await n.current:await new Promise((S,E)=>{const T=setTimeout(()=>{E(o4(Fd.TIMEOUT,"Request timed out"))},xse);m(C,w).then(k=>{clearTimeout(T),S(k)}).catch(k=>{clearTimeout(T),E(k)})}),h=async C=>{const w={};switch(C.data.type){case"command":t.current?.postMessage({type:"acknowledge",id:C.data.id});const S=C.data.data;switch(S.command){case"authenticate":try{const E=await p(u,w);t.current?.postMessage({type:"result",id:C.data.id,data:{result:"token",token:E}})}catch(E){w.errorStep="authenticateCommand",w.error=E instanceof Error?E.toString():E,d(E)}finally{u.log?.(u.connectionType??u.connector.toUpperCase(),w)}break;case"pick":t.current?.postMessage({type:"result",id:C.data.id,data:{result:"success"}}),u.onPicked?.(S.items),d();break;case"close":d();break;default:d();break}break}},g=async C=>{if(C.source&&C.source===e.current){const w=C.data;w.type==="initialize"&&w.channelId===i4&&(t.current=C.ports[0],t.current.addEventListener("message",h),t.current.start(),t.current.postMessage({type:"activate"}))}};let y;const b={};try{y=await m(u,b)}catch(C){b.errorStep="initialization",b.error=C instanceof Error?C.toString():C,d(C);return}finally{u.log?.(u.connectionType??u.connector.toUpperCase(),b)}const x=document.getElementById("microsoft-file-picker");if(!x){d();return}if(e.current=x.contentWindow,!e?.current){d();return}const _=e.current.document.createElement("form");_.setAttribute("action",i(u)),_.setAttribute("method","POST"),e.current.document.body.append(_);const v=e.current.document.createElement("input");v.setAttribute("type","hidden"),v.setAttribute("name","access_token"),v.setAttribute("value",y),_.appendChild(v),e.current.document.body.appendChild(_),_.submit(),window.addEventListener("message",g)},[o,i]);return f.useMemo(()=>({openPicker:c,toPickerDocument:GI}),[c])},l4="box-file-picker",bse="0";let cp=null,c4=!1;const _se=()=>cp||(cp=new Promise((e,t)=>{const n=document.createElement("link");n.rel="stylesheet",n.href="https://cdn01.boxcdn.net/platform/elements/17.1.0/en-US/picker.css",n.onload=()=>{OC({id:"box-picker-script",src:"https://cdn01.boxcdn.net/platform/elements/17.1.0/en-US/picker.js"}).then(()=>{if(!c4){const r=document.createElement("style");r.textContent=`
                  .be .be-header input[type="search"] {
                      background: white;
                  }

                  .btn-content {
                      display: flex;
                      justify-content: center;
                      align-items: center;
                  }
              `,document.head.appendChild(r),c4=!0,e()}},t)},document.head.appendChild(n)}),cp),WI=({mode:e,isAudioVideoFilesEnabled:t,onPicked:n,onCancel:r,onError:s})=>{const a=f.useRef(null),o=f.useCallback(async({apiKey:c,pickerType:u="file"})=>{try{if(await _se(),!document.getElementById(l4)){s?.("Attempted to open picker when container isn't ready");return}let m=e==="source"?SS:ES;m=t?m.concat(kS):m;const p=[...m,".gdocs",".gsheets",".gslides"];a.current&&(a.current.removeListener("choose",n),a.current.removeListener("cancel",r),a.current.hide(),a.current=null);let h;u==="folder"?h=new window.Box.FolderPicker:h=new window.Box.FilePicker,a.current=h,h.addListener("choose",n),h.addListener("cancel",r),h.show(bse,c,{container:`#${l4}`,logoUrl:n0,extensions:p.join(","),canUpload:!1,canSetShareAccess:!1,canCreateNewFolder:!1,chooseButtonLabel:"Select",cancelButtonLabel:"Cancel"})}catch(d){s?.(d);return}},[s,e,r,n,t]),i=f.useCallback(()=>{a.current&&(a.current.removeListener("choose",n),a.current.removeListener("cancel",r),a.current.hide(),a.current=null)},[n,r]);return f.useMemo(()=>({openPicker:o,cleanupPicker:i}),[o,i])};function u4(){const e=document.getElementById("dropboxjs");e&&document.body.removeChild(e)}const KI=()=>{const[e,t]=f.useState(null),n=f.useCallback(async s=>{e!==s&&(u4(),t(null),await OC({id:"dropboxjs",src:"https://www.dropbox.com/static/api/2/dropins.js",attrs:{"data-app-key":s}}),t(s))},[e]),r=f.useCallback(async s=>{await n(s.clientId);let a=s.mode==="source"?SS:ES;a=s.isAudioVideoFilesEnabled?a.concat(kS):a,window.Dropbox.choose({success:s.onPicked,error:o=>s.onError?.(o),multiselect:!0,extensions:a,folderselect:s.mode==="source"})},[n]);return f.useEffect(()=>()=>{u4()},[]),f.useMemo(()=>({openPicker:r}),[r])};function vse(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e&&e.addEventListener&&e.addEventListener.apply(e,t)}function Cse(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e&&e.removeEventListener&&e.removeEventListener.apply(e,t)}var wse=typeof window<"u";function Y2(e){if(e){if(e.tagName==="BODY")return e;if(e.tagName==="IFRAME"){var t=e.contentDocument;return t?t.body:null}else if(!e.offsetParent)return null}else return null;return Y2(e.offsetParent)}function d4(e){var t=e||window.event;return t.touches.length>1?!0:(t.preventDefault&&t.preventDefault(),!1)}var f4=wse&&window.navigator&&window.navigator.platform&&/iP(ad|hone|od)/.test(window.navigator.platform),Jl=new Map,m4=typeof document=="object"?document:void 0,up=!1;const Sse=m4?function(t,n){t===void 0&&(t=!0);var r=f.useRef(m4.body);n=n||r;var s=function(o){var i=Jl.get(o);i?Jl.set(o,{counter:i.counter+1,initialOverflow:i.initialOverflow}):(Jl.set(o,{counter:1,initialOverflow:o.style.overflow}),f4?up||(vse(document,"touchmove",d4,{passive:!1}),up=!0):o.style.overflow="hidden")},a=function(o){var i=Jl.get(o);i&&(i.counter===1?(Jl.delete(o),f4?(o.ontouchmove=null,up&&(Cse(document,"touchmove",d4),up=!1)):o.style.overflow=i.initialOverflow):Jl.set(o,{counter:i.counter-1,initialOverflow:i.initialOverflow}))};f.useEffect(function(){var o=Y2(n.current);o&&(t?s(o):a(o))},[t,n.current]),f.useEffect(function(){var o=Y2(n.current);if(o)return function(){a(o)}},[])}:function(t,n){},p4="google-drive-picker-gapi-script",h4="google-identity-services-script",Ese=$g(async function(){if(!document.getElementById(h4))return new Promise((t,n)=>{const r=document.createElement("script");r.src="https://accounts.google.com/gsi/client",r.id=h4,r.onload=()=>t(),r.onerror=n,document.body.appendChild(r)})}),kse=$g(async function(){if(!document.getElementById(p4))return new Promise((t,n)=>{const r=document.createElement("script");r.src="https://apis.google.com/js/api.js",r.id=p4,r.onload=()=>{window.gapi.load("picker",{callback:t,onerror:n})},r.onerror=n,document.body.appendChild(r)})}),Mse=["https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/drive.readonly","https://www.googleapis.com/auth/drive.metadata.readonly"].join(" "),Tse=["application/vnd.google-apps.file","application/vnd.google-apps.folder","application/vnd.google-apps.document","application/vnd.google-apps.presentation","application/vnd.google-apps.spreadsheet","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain","application/pdf","text/csv","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/markdown"],Ase=["text/plain","application/pdf","text/csv","text/markdown","image/png","image/jpeg","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.google-apps.document","application/vnd.google-apps.presentation","application/vnd.google-apps.spreadsheet"],Nse=["audio/mpeg","audio/wav","audio/aiff","audio/ogg","audio/flac","audio/mp3","video/mp4","video/mpeg","video/mov","video/avi","video/x-flv","video/mpg","video/webm","video/wmv","video/3gpp","video/quicktime"],YI=({isAudioVideoFilesEnabled:e,onError:t})=>{const[n,r]=f.useState(!1),{openToast:s}=cn(),{$t:a}=Q();Sse(n);const o=f.useCallback((c,u)=>{const d=window.google?.picker,m=p=>{p.action===d.Action.PICKED?u.onPicked&&u.onPicked(p.docs??_e):(p.action===d.Action.CANCEL||p.action===d.Action.ERROR)&&(p.action===d.Action.CANCEL&&u.onCancel&&u.onCancel(),r(!1))};if(d)try{const p=new d.DocsView().setIncludeFolders(!0).setSelectFolderEnabled(!0).setMode(d.DocsViewMode.LIST),h=new d.ViewGroup(p);let g=u.mode==="source"?Tse:Ase;g=e?g.concat(Nse):g,new d.PickerBuilder().setSize(1051,650).addViewGroup(h).setSelectableMimeTypes(g.join(",")).enableFeature(d.Feature.MULTISELECT_ENABLED).setOAuthToken(c).setCallback(m).build().setVisible(!0),r(!0)}catch{t?.()}},[e,t]),i=f.useCallback(async c=>{try{await Promise.all([kse(),Ese()])}catch{t?.();return}window.google.accounts.oauth2.initTokenClient({client_id:c.clientId,login_hint:c.loginHint,scope:Mse,prompt:"none",callback:d=>{if(d.error!==void 0)throw new Error(d.error);if(!d.access_token){s({message:a({defaultMessage:"Failed to open Google Drive file picker. If this problem persists, please try reconnecting your Google Drive account.",id:"UK5gaMQa5o"}),variant:"error",timeout:5}),Z.warn("[Google Drive Picker] No access token received."),t?.();return}try{o(d.access_token,c)}catch(m){console.log(m)}}}).requestAccessToken()},[o,t,a,s]);return f.useMemo(()=>({openPicker:i}),[i])},Rse=({connectorId:e,onFilesSelected:t})=>{const n="sources-menu-attach-file-connector",{openPicker:r}=Dse({onSelectFiles:t,reason:n}),{openPicker:s}=g4({connectorName:"onedrive",onSelectFiles:t,reason:n}),{openPicker:a}=g4({connectorName:"sharepoint",onSelectFiles:t,reason:n}),{openPicker:o}=Ise({onSelectFiles:t,reason:n}),{openPicker:i}=jse({onSelectFiles:t,reason:n}),c=f.useCallback(()=>{switch(e){case"google_drive":r();break;case"onedrive":s();break;case"sharepoint":a();break;case"dropbox":o();break;case"box":i();break;default:throw new Error(`Connector ${e} not implemented`)}},[e,r,s,a,o,i]);return f.useMemo(()=>({openFilePicker:c}),[c])},Dse=({onSelectFiles:e,reason:t})=>{const{connectorsMap:n}=Do({reason:t,skipConnectorPickerCredentials:!1}),r=n?.google_drive,{openPicker:s}=YI({isAudioVideoFilesEnabled:!0}),a=f.useCallback(()=>{s({clientId:r?.picker_credentials?.client_id??"",loginHint:r?.connection_display_name??"",mode:"attachment",onPicked:o=>{e({type:"google_drive",files:o})}})},[r,s,e]);return f.useMemo(()=>({openPicker:a}),[a])},g4=({connectorName:e,onSelectFiles:t,reason:n})=>{const{connectorsMap:r}=Do({reason:n,skipConnectorPickerCredentials:!1}),s=r?.[e],{openMicrosoftPicker:a,closeMicrosoftPicker:o}=hse(),i=f.useCallback(()=>{const c={connector:e,mode:"attachment",clientId:s?.picker_credentials?.client_id??"",tenantName:s?.picker_credentials?.tenant_name??"",loginHint:s?.connection_display_name??"",accountIdentifier:s?.picker_credentials?.account_identifier,isAudioVideoFilesEnabled:!0,onPicked:u=>{const d=u.map(m=>GI(m,e)).filter(m=>m!==null);t({type:e,files:d}),o()},onError:u=>{o()},onCancel:()=>{o()}};a(c)},[e,s,t,a,o]);return f.useMemo(()=>({openPicker:i}),[i])},Ise=({onSelectFiles:e,reason:t})=>{const{connectorsMap:n}=Do({reason:t,skipConnectorPickerCredentials:!1}),r=n?.dropbox,{openPicker:s}=KI(),a=f.useCallback(()=>{s({clientId:r?.picker_credentials?.client_id??"",mode:"attachment",isAudioVideoFilesEnabled:!0,onPicked:o=>{const i=o.map(c=>zI(c)).filter(c=>c!==null);e({type:"dropbox",files:i})}})},[r,s,e]);return f.useMemo(()=>({openPicker:a}),[a])},jse=({onSelectFiles:e,reason:t})=>{const{connectorsMap:n}=Do({reason:t,skipConnectorPickerCredentials:!1}),r=n?.box,{openPicker:s,cleanupPicker:a}=WI({mode:"attachment",isAudioVideoFilesEnabled:!0,onPicked:i=>{const c=i.map(u=>qI(u));e({type:"box",files:c}),a()},onCancel:()=>{a()}}),o=f.useCallback(()=>{s({apiKey:r?.picker_credentials?.api_key??""})},[r,s]);return f.useMemo(()=>({openPicker:o}),[o])};function Pse({url:e,openInNewTab:t}){if(t){window.open(e,"_blank");return}oa(e,"Enabling connector")}const Ose={box:"box",dropbox:"dropbox",gcal:"gcal",google_docs:"google_docs",google_drive:"google_drive",linear:"linear",onedrive:"onedrive",outlook:"outlook",sharepoint:"sharepoint",zoom:"zoom"},Lse=e=>Fse(e.name),Fse=e=>Object.keys(Ose).includes(e),MS=async({name:e,referrer:t,referrerId:n,redirectPath:r,redirectOrigin:s,unauthedRedirectPath:a,autoClose:o,reason:i})=>{try{const{data:c,error:u,response:d}=await ve.GET(`/rest/connectors/${e}/connect`,i,{timeoutMs:Ct(),numRetries:1,reason:i,params:{query:{referrer:t,referrer_id:n,redirect_path:r,redirect_origin:s,unauthed_redirect_path:a,auto_close:o}}});if(u)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to initiate OAuth flow",cause:u,status:d.status??0});return c.redirect_url??null}catch(c){return Z.error("Error fetching factset OAuth redirect URL:",c),null}},y4=async({connectorName:e,reason:t,autoDeleteEmailAssistant:n=!1,connectionUUID:r})=>{const s=`disconnectConnector:${e}`;try{const{data:a,error:o,response:i}=await ve.GET("/rest/connectors/{connector_id}/disconnect",t,{timeoutMs:Ct({productionMs:500}),numRetries:1,reason:t,params:{path:{connector_id:e},query:{auto_delete_email_assistant:n,connection_uuid:r}}});if(o)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to disconnect connector",cause:o,status:i.status??0});return a}catch(a){return Z.log(`Error in ${s}:`,a),null}},Use=async({connectionUUID:e,reason:t})=>{const{data:n,error:r,response:s}=await ve.POST("/rest/connections/{uuid}/update",t,{params:{path:{uuid:e}},body:{disconnect:!0}});if(r)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to disconnect file connector",cause:r,status:s.status??0});return n},Bse=async({connectionUUID:e,reason:t})=>{const{data:n,error:r,response:s}=await ve.POST("/rest/connections/{uuid}/delete",t,{params:{path:{uuid:e}}});if(r)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to disconnect file connector and delete files",cause:r,status:s.status??0});return n},Hse=async({selections:e,fileRepoInfo:t,reason:n})=>{const{error:r,data:s,response:a}=await ve.POST("/rest/connectors/sharepoint/files",n,{body:{file_ids:[],drive_ids:[],site_id:null,selections:e,file_repository_info:t}});if(r)throw new Ue("API_CLIENTS_ERROR",{cause:r,status:a.status??0});return s},Vse=async({selections:e,fileRepoInfo:t,reason:n})=>{const{error:r,data:s,response:a}=await ve.POST("/rest/connectors/box/files",n,{body:{file_ids:[],folder_ids:[],selections:e,file_repository_info:t}});if(r)throw new Ue("API_CLIENTS_ERROR",{cause:r,status:a.status??0});return s},Gse=async({connectorName:e,selections:t,fileRepoInfo:n,reason:r})=>{const{error:s,data:a,response:o}=await ve.POST(`/rest/connectors/${e}/files`,r,{body:{file_ids:[],drive_ids:[],selections:t,file_repository_info:n}});if(s)throw new Ue("API_CLIENTS_ERROR",{cause:s,status:o.status??0});return a},wYe=async({connectorName:e,selections:t,fileRepoInfo:n,reason:r})=>e==="sharepoint"?Hse({selections:t,fileRepoInfo:n,reason:r}):e==="box"?Vse({selections:t,fileRepoInfo:n,reason:r}):Gse({connectorName:e,selections:t,fileRepoInfo:n,reason:r}),zse=async({reason:e})=>{const{data:t,error:n,response:r}=await ve.POST("/rest/connectors/box/picker",e);if(n)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to refresh box picker credentials",cause:n,status:r.status??0});return t},TS=({reason:e})=>{const t=nn(),n=t?.get("referrer"),r=t?.get("referrerId"),{$t:s}=Q(),{openToast:a}=cn(),o=f.useCallback(async({connectorName:i,redirectPath:c,customReferrer:u,customReferrerId:d,redirectOrigin:m,unauthedRedirectPath:p,openInNewTab:h=!1})=>{const g=await MS({name:i,referrer:u??n??void 0,referrerId:d??r??void 0,redirectPath:c??void 0,redirectOrigin:m,unauthedRedirectPath:p??void 0,reason:e});if(!g){a({message:s({defaultMessage:"Unable to start connection.",id:"SPIzcd/Xa2"}),variant:"error",timeout:3});return}Pse({url:g,openInNewTab:h})},[e,n,r,s,a]);return f.useMemo(()=>({handleConnect:o}),[o])},qse=A.memo(function({connectorId:t,connected:n,onFilesSelected:r,gateUploadFile:s}){const a="sources-menu-attach-file-connector",{getSourceLabel:o,getSourceIcon:i}=Gs(),{handleConnect:c}=TS({reason:a}),u=sr(),d=f.useCallback(b=>{switch(b.type){case"google_drive":r(b.files,"google_drive");break;case"onedrive":r(b.files,"onedrive");break;case"sharepoint":r(b.files,"sharepoint");break;case"dropbox":r(b.files,"dropbox");break;case"box":r(b.files,"box");break;default:St(b)}},[r]),{openFilePicker:m}=Rse({connectorId:t,onFilesSelected:d}),p=f.useCallback(()=>{const b=()=>{if(!n){c({connectorName:t,redirectPath:u||void 0,unauthedRedirectPath:u||void 0});return}m()};s()||b()},[n,t,c,u,m,s]),h=o(t),g=i(t),y=n?void 0:l.jsx(_n,{icon:D("arrow-up-right"),size:"small"});return l.jsx(Qe.Item,{onSelect:p,leadingAccessory:g,trailingAccessory:y,children:h})});function $se(e){return e!=null}const Wse=f.memo(function({onFilesSelected:t,gateUploadFile:n,isOpen:r,onToggle:s,submenuMaxWidth:a}){const[o,i]=f.useState(!1),c=r??o,u=s??i,{connectorsMap:d}=Do({reason:"sources-menu"}),m=f.useMemo(()=>tR.map(p=>d[p]).filter($se).filter(Lse),[d]);return m.length===0?null:l.jsx(Qe.Submenu,{isOpen:c,onToggle:u,maxWidthPx:a,triggerElement:l.jsx(Qe.SubmenuItem,{leadingAccessory:D("cloud"),children:l.jsx(be,{defaultMessage:"Add files from cloud",id:"w9HNOsxeaM"})}),children:m.map(p=>l.jsx(qse,{connectorId:p.name,connected:p.connected,onFilesSelected:t,gateUploadFile:n},p.name))})}),QI=Bt("AskInputPlusMenuFileInputContext",null);function XI(){const e=f.useContext(QI);if(!e)throw new Error("useAskInputPlusMenuFileInput must be used within AskInputPlusMenuFileInputProvider");return e}const Kse=A.memo(function({children:t,onFilesSelected:n}){const r=f.useRef(null),s=f.useCallback(()=>{r.current?.click()},[]),a=f.useCallback(i=>{const c=i.target.files;c&&c.length>0&&n?.(Array.from(c),"local"),r.current&&(r.current.value="")},[n]),o=f.useMemo(()=>({open:s}),[s]);return l.jsxs(QI.Provider,{value:o,children:[l.jsx("input",{ref:r,type:"file",multiple:!0,accept:$N,style:{display:"none"},onChange:a}),t]})}),Yse=A.memo(function({gateUploadFile:t,tooltipMaxWidth:n}){const{$t:r}=Q(),{open:s}=XI(),{device:{isMacOS:a}}=jn(),o=f.useCallback(()=>{t()||s()},[t,s]),i=l.jsx("span",{className:"text-quiet text-xs",children:a?"U":"Ctrl+U"});return l.jsx(wn,{content:r({defaultMessage:"Files attached to threads are retained for 7 days",id:"hTclTOMwb7"}),side:"right",maxWidthPx:n,children:l.jsx("div",{children:l.jsx(Qe.Item,{onSelect:o,leadingAccessory:D("paperclip"),trailingAccessory:i,children:l.jsx(be,{defaultMessage:"Upload files or images",id:"qxCnwQTq/g"})})})})}),Qse=f.memo(function({gateUploadFile:t,disabledByOrganization:n,onFilesSelected:r,tooltipMaxWidth:s,submenuMaxWidth:a}){return n?l.jsx(pse,{}):l.jsxs(l.Fragment,{children:[l.jsx(Yse,{gateUploadFile:t,tooltipMaxWidth:s}),l.jsx(Wse,{onFilesSelected:r,gateUploadFile:t,submenuMaxWidth:a})]})}),Xse=f.memo(function({browseForMe:t,onChangeBrowseForMe:n,isBrowseForMeDisabledByOrg:r,tooltipMaxWidth:s}){const{$t:a}=Q(),o=f.useCallback(()=>{n(!t)},[t,n]);return l.jsx(wn,{content:a(r?{defaultMessage:"Disabled by your organization",id:"cBE0Jgy5fu"}:{defaultMessage:"Let Comet Assistant navigate and interact with websites",id:"Htf0TtbEpJ"}),side:"right",maxWidthPx:s,children:l.jsx("span",{children:l.jsx(Qe.Item,{leadingAccessory:D("click"),onSelect:o,disabled:r,children:a({defaultMessage:"Control browser",id:"4SgYV+4mxC"})})})})}),Zse=f.memo(function({onCaptureScreenshot:t,isScreenshotDisabledByOrg:n,tooltipMaxWidth:r}){const{$t:s}=Q();return l.jsx(wn,{content:s({defaultMessage:"Disabled by your organization",id:"cBE0Jgy5fu"}),side:"right",disabled:!n,maxWidthPx:r,children:l.jsx("span",{children:l.jsx(Qe.Item,{leadingAccessory:D("capture"),onSelect:t,disabled:n,children:s({defaultMessage:"Screenshot",id:"9a+SKtXKhe"})})})})}),ZI=225,Jse=f.memo(function({sources:t,onSourcesChange:n,omittedSources:r,omitCometMcpSources:s,submenuMaxWidth:a}){const o="ask-input-plus-menu-sources",{isAllowed:i,isConnected:c}=no({reason:o}),{sources:u}=Ai({omitCometMcpSources:s,isConnectorAllowed:i,isConnectorConnected:c,omittedSources:r}),{suggested:d,refresh:m}=j0({sources:u}),[p,h]=f.useState(!1),g=f.useCallback(b=>{h(b),b&&m()},[h,m]),y=f.useMemo(()=>l.jsx(wS,{sources:t,onChange:n,suggestedSources:d,omittedSources:r,omitCometMcpSources:s,menuItemType:"checkbox"}),[t,n,d,r,s]);return l.jsx(Qe.Submenu,{isOpen:p,onToggle:g,maxHeightPx:310,triggerElement:l.jsx(Qe.SubmenuItem,{leadingAccessory:D("plug"),children:l.jsx(be,{defaultMessage:"Connectors and sources",id:"Jl3u//EbvE"})}),minWidthPx:ZI,maxWidthPx:a,children:y})}),eae=A.memo(function({gateUploadFile:t}){const{open:n}=XI(),{device:{isMacOS:r}}=jn();return f.useEffect(()=>{function s(a){!(r?a.metaKey:a.ctrlKey)||a.key!=="u"||(a.preventDefault(),t()||n())}return document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s)}},[r,t,n]),null}),tae=Pe(async()=>{const{MicrosoftFilePickerModal:e}=await W(async()=>{const{MicrosoftFilePickerModal:t}=await import("./MicrosoftFilePickerModal-DttNydhV.js");return{MicrosoftFilePickerModal:t}},__vite__mapDeps([58,2,3,5,1,6,7,8,9,59,12,35,15,13,14,16,17]));return{default:e}},{loading:()=>l.jsx(Il,{})}),nae=A.memo(function({children:t}){const[n,r]=f.useState({isOpen:!1,options:null}),{openPicker:s}=$I();f.useEffect(()=>{if(n.isOpen&&n.options&&!(n.options.connector==="sharepoint"&&!n.options.webUrl)){const u=setTimeout(()=>{s(n.options)},50);return()=>clearTimeout(u)}},[n.isOpen,n.options,s]);const a=f.useCallback(()=>{r({isOpen:!1,options:null})},[]),o=f.useCallback(u=>{if(n.options){const d={...n.options,webUrl:u};r({isOpen:!0,options:d})}},[n.options]),i=f.useCallback(u=>{r({isOpen:!0,options:u})},[]),c=f.useMemo(()=>({openMicrosoftPicker:i,closeMicrosoftPicker:a,isPickerOpen:n.isOpen}),[i,a,n.isOpen]);return l.jsxs(VI.Provider,{value:c,children:[t,n.isOpen&&l.jsx(tae,{isOpen:n.isOpen,options:n.options,onClose:a,onSelectSite:o})]})}),AS=()=>{const{base:e}=hn(),t=sr();return t===(e||"/")||t?.startsWith("/welcome")||t?.startsWith("/finance")},rae=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"tmp-deep-research-badge",defaultValue:e,extraAttributes:t,subjectType:"visitor_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])};function sae(){const{isDisabledByOrg:e}=Mu();return f.useCallback(t=>{switch(t){case K.BROWSER_AGENT:return e;default:return!1}},[e])}function NS(){const{isEnabled:e}=Mu(),{variation:t}=wI(!1);return f.useCallback(n=>{switch(n){case K.BROWSER_AGENT:return e;case K.ASI:return t;default:return!0}},[e,t])}const JI=f.memo(function({searchMode:t,onSearchModeSelect:n,omittedSearchModes:r=_e,tooltipMaxWidth:s}){const a=NS(),o=Object.values(K).filter(m=>r.includes(m)||m!==K.BROWSER_AGENT?!1:a(m)),i=On(),{gateSearchModeSelection:c}=jo({openPaywallUpsell:i}),{getPreferredSearchModelForSearchMode:u}=k0(),d=m=>{if(!Ww(m)){Z.error(`Invalid search mode selected: ${m}`);return}const p=u(m);c(p)||n(m)};return l.jsx(Qe.RadioGroup,{value:t,onValueChange:d,children:o.map(m=>l.jsx(aae,{searchMode:m,tooltipMaxWidth:s},m))})}),aae=({searchMode:e,tooltipMaxWidth:t})=>{const{$t:n}=Q(),s=sae()(e),{subscriptionStatus:a,subscriptionTier:o}=Mt(),{session:i}=je(),{variation:c}=rae(!1,{subscription_status:a??"none",subscription_tier:o??"none",payment_tier:i?.user?.payment_tier??"free"}),u=gi(e),d=Ia(e),m=n(Yn[e].description),p=Xw(e),h=p?n(p):void 0,g=s?n({defaultMessage:"Disabled by your organization",id:"cBE0Jgy5fu"}):void 0,b=e===K.RESEARCH&&c,x=e===K.AGENTIC_RESEARCH,_=b?n({defaultMessage:"Upgraded AI models and sandbox",id:"PHbYDSpMzF"}):void 0,v=g||_||h;return l.jsx(wn,{content:m,side:"right",maxWidthPx:t,children:l.jsx("div",{children:l.jsx(Qe.RadioItem,{value:e,leadingAccessory:l.jsx(_n,{icon:u,size:"small"}),subtitle:v,disabled:s,children:l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(be,{...d}),b&&l.jsx(TN,{text:"new",variant:"maxBorder"}),x&&l.jsx(xi,{variant:"max",size:"md-large"})]})})})})},oae=f.memo(function(t){const{isOpen:n,onToggle:r}=t,[s,a]=f.useState(!1),o=f.useMemo(()=>l.jsx(iae,{}),[]),i=n??s,c=r??a,u=192,d=196;return l.jsx(nae,{children:l.jsxs(Kse,{onFilesSelected:t.onFilesSelected,children:[t.showAttachments&&l.jsx(eae,{gateUploadFile:t.gateUploadFile}),l.jsxs(Qe,{isOpen:i,onToggle:c,minWidthPx:220,maxHeightPx:400,triggerElement:o,children:[t.showAttachments&&l.jsx(Qse,{disabledByOrganization:t.disabledByOrganization,onFilesSelected:t.onFilesSelected,gateUploadFile:t.gateUploadFile,onCloseErrorToast:t.onCloseErrorToast,tooltipMaxWidth:u,submenuMaxWidth:d}),t.showScreenshot&&l.jsx(Zse,{onCaptureScreenshot:t.onCaptureScreenshot,isScreenshotDisabledByOrg:t.isScreenshotDisabledByOrg,tooltipMaxWidth:u}),t.showSources&&l.jsx(Jse,{sources:t.sources,onSourcesChange:t.onSourcesChange,submenuMaxWidth:d}),l.jsx(Qe.Separator,{}),t.showBrowseForMe&&l.jsx(Xse,{browseForMe:t.browseForMe,onChangeBrowseForMe:t.onChangeBrowseForMe,isBrowseForMeDisabledByOrg:t.isBrowseForMeDisabledByOrg,tooltipMaxWidth:u}),t.showSearchMode&&l.jsx(lae,{searchMode:t.searchMode,onSearchModeSelect:t.onSearchModeSelect,omittedSearchModes:t.omittedSearchModes,tooltipMaxWidth:u})]}),t.showAttachments&&l.jsxs(l.Fragment,{children:[l.jsx(fl,{isVisible:!!t.fileUploadErrorMessage,variant:"error",message:t.fileUploadErrorMessage??"",handleClose:t.onCloseErrorToast,timeout:null}),l.jsx(fl,{isVisible:!!t.fileUploadWarningMessage&&!t.fileUploadErrorMessage,variant:"warning",message:t.fileUploadWarningMessage??"",timeout:4})]})]})})}),iae=e=>{const{$t:t}=Q(),n=AS(),r=wt(),s=v$(g=>g.modals.size>0),[a,o,i]=vs("pplx_should_show_ask_input_plus_menu_info_popover",!0),[c,u]=f.useState(a&&n&&r&&!s),[d,m]=f.useState(!1);f.useEffect(()=>{const g=setTimeout(()=>{m(!0)},2e3);return()=>clearTimeout(g)},[]);const p=f.useCallback(()=>{u(!1),o(!1)},[u,o]);f.useEffect(()=>{function g(){!i()&&c&&p()}return document.addEventListener("visibilitychange",g),()=>{document.removeEventListener("visibilitychange",g)}},[i,c,p]);const h=f.useCallback(g=>{g||p()},[p]);return l.jsx(wn,{content:t({defaultMessage:"Research, Labs, and Sources have moved",id:"ROi1SCxUc2"}),offsetPx:4,open:c&&d,onOpenChange:h,side:"right",shouldShowArrow:!0,children:l.jsx(at,{rounded:!0,icon:D("plus"),"aria-label":t({defaultMessage:"Add files or tools",id:"b0HJDfD104"}),size:"small",variant:"secondary",...e})})},lae=({searchMode:e,onSearchModeSelect:t,omittedSearchModes:n=_e,tooltipMaxWidth:r})=>{const s=f.useMemo(()=>[K.SEARCH,...n],[n]);return l.jsx(JI,{searchMode:e,onSearchModeSelect:t,omittedSearchModes:s,tooltipMaxWidth:r})},cae=f.memo(function({searchMode:t,onClearSearchMode:n,disabled:r=!1,disabledTooltip:s}){const[a,o]=f.useState(!1),i=gi(t),c=Ia(t),u=f.useCallback(()=>o(!0),[]),d=f.useCallback(()=>o(!1),[]),m=a&&!r?D("x"):i,p=l.jsx("div",{onMouseEnter:u,onMouseLeave:d,className:"inline-flex",children:l.jsx(at,{variant:"tonal",size:"small",rounded:!0,icon:m,onClick:n,"aria-label":c.defaultMessage,disabled:r})});return s?l.jsx(wn,{content:s,side:"bottom",children:p}):p}),uae=f.memo(function({onRemove:t}){const{$t:n}=Q(),[r,s]=f.useState(!1),a=f.useMemo(()=>({onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1)}),[]);return l.jsx(at,{variant:"tonal",size:"small",pill:!0,leadingIcon:r?D("x"):D("click"),onClick:t,__dangerousHtmlProps:a,children:n({defaultMessage:"Control browser",id:"4SgYV+4mxC"})})});var RS=nm(),Et=e=>tm(e,RS),DS=nm();Et.write=e=>tm(e,DS);var O0=nm();Et.onStart=e=>tm(e,O0);var IS=nm();Et.onFrame=e=>tm(e,IS);var jS=nm();Et.onFinish=e=>tm(e,jS);var Tc=[];Et.setTimeout=(e,t)=>{const n=Et.now()+t,r=()=>{const a=Tc.findIndex(o=>o.cancel==r);~a&&Tc.splice(a,1),Jo-=~a?1:0},s={time:n,handler:e,cancel:r};return Tc.splice(ej(n),0,s),Jo+=1,tj(),s};var ej=e=>~(~Tc.findIndex(t=>t.time>e)||~Tc.length);Et.cancel=e=>{O0.delete(e),IS.delete(e),jS.delete(e),RS.delete(e),DS.delete(e)};Et.sync=e=>{Q2=!0,Et.batchedUpdates(e),Q2=!1};Et.throttle=e=>{let t;function n(){try{e(...t)}finally{t=null}}function r(...s){t=s,Et.onStart(n)}return r.handler=e,r.cancel=()=>{O0.delete(n),t=null},r};var PS=typeof window<"u"?window.requestAnimationFrame:(()=>{});Et.use=e=>PS=e;Et.now=typeof performance<"u"?()=>performance.now():Date.now;Et.batchedUpdates=e=>e();Et.catch=console.error;Et.frameLoop="always";Et.advance=()=>{Et.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):rj()};var Zo=-1,Jo=0,Q2=!1;function tm(e,t){Q2?(t.delete(e),e(0)):(t.add(e),tj())}function tj(){Zo<0&&(Zo=0,Et.frameLoop!=="demand"&&PS(nj))}function dae(){Zo=-1}function nj(){~Zo&&(PS(nj),Et.batchedUpdates(rj))}function rj(){const e=Zo;Zo=Et.now();const t=ej(Zo);if(t&&(sj(Tc.splice(0,t),n=>n.handler()),Jo-=t),!Jo){dae();return}O0.flush(),RS.flush(e?Math.min(64,Zo-e):16.667),IS.flush(),DS.flush(),jS.flush()}function nm(){let e=new Set,t=e;return{add(n){Jo+=t==e&&!e.has(n)?1:0,e.add(n)},delete(n){return Jo-=t==e&&e.has(n)?1:0,e.delete(n)},flush(n){t.size&&(e=new Set,Jo-=t.size,sj(t,r=>r(n)&&e.add(r)),Jo+=e.size,t=e)}}}function sj(e,t){e.forEach(n=>{try{t(n)}catch(r){Et.catch(r)}})}var fae=Object.defineProperty,mae=(e,t)=>{for(var n in t)fae(e,n,{get:t[n],enumerable:!0})},Us={};mae(Us,{assign:()=>hae,colors:()=>oi,createStringInterpolator:()=>LS,skipAnimation:()=>oj,to:()=>aj,willAdvance:()=>FS});function X2(){}var pae=(e,t,n)=>Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0}),Re={arr:Array.isArray,obj:e=>!!e&&e.constructor.name==="Object",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",und:e=>e===void 0};function mo(e,t){if(Re.arr(e)){if(!Re.arr(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return e===t}var _t=(e,t)=>e.forEach(t);function qa(e,t,n){if(Re.arr(e)){for(let r=0;r<e.length;r++)t.call(n,e[r],`${r}`);return}for(const r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r)}var Or=e=>Re.und(e)?[]:Re.arr(e)?e:[e];function Ud(e,t){if(e.size){const n=Array.from(e);e.clear(),_t(n,t)}}var Nd=(e,...t)=>Ud(e,n=>n(...t)),OS=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),LS,aj,oi=null,oj=!1,FS=X2,hae=e=>{e.to&&(aj=e.to),e.now&&(Et.now=e.now),e.colors!==void 0&&(oi=e.colors),e.skipAnimation!=null&&(oj=e.skipAnimation),e.createStringInterpolator&&(LS=e.createStringInterpolator),e.requestAnimationFrame&&Et.use(e.requestAnimationFrame),e.batchedUpdates&&(Et.batchedUpdates=e.batchedUpdates),e.willAdvance&&(FS=e.willAdvance),e.frameLoop&&(Et.frameLoop=e.frameLoop)},Bd=new Set,Rs=[],Yx=[],Wh=0,L0={get idle(){return!Bd.size&&!Rs.length},start(e){Wh>e.priority?(Bd.add(e),Et.onStart(gae)):(ij(e),Et(Z2))},advance:Z2,sort(e){if(Wh)Et.onFrame(()=>L0.sort(e));else{const t=Rs.indexOf(e);~t&&(Rs.splice(t,1),lj(e))}},clear(){Rs=[],Bd.clear()}};function gae(){Bd.forEach(ij),Bd.clear(),Et(Z2)}function ij(e){Rs.includes(e)||lj(e)}function lj(e){Rs.splice(yae(Rs,t=>t.priority>e.priority),0,e)}function Z2(e){const t=Yx;for(let n=0;n<Rs.length;n++){const r=Rs[n];Wh=r.priority,r.idle||(FS(r),r.advance(e),r.idle||t.push(r))}return Wh=0,Yx=Rs,Yx.length=0,Rs=t,Rs.length>0}function yae(e,t){const n=e.findIndex(t);return n<0?e.length:n}var xae={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},ia="[-+]?\\d*\\.?\\d+",Kh=ia+"%";function F0(...e){return"\\(\\s*("+e.join(")\\s*,\\s*(")+")\\s*\\)"}var bae=new RegExp("rgb"+F0(ia,ia,ia)),_ae=new RegExp("rgba"+F0(ia,ia,ia,ia)),vae=new RegExp("hsl"+F0(ia,Kh,Kh)),Cae=new RegExp("hsla"+F0(ia,Kh,Kh,ia)),wae=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Sae=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Eae=/^#([0-9a-fA-F]{6})$/,kae=/^#([0-9a-fA-F]{8})$/;function Mae(e){let t;return typeof e=="number"?e>>>0===e&&e>=0&&e<=4294967295?e:null:(t=Eae.exec(e))?parseInt(t[1]+"ff",16)>>>0:oi&&oi[e]!==void 0?oi[e]:(t=bae.exec(e))?(ec(t[1])<<24|ec(t[2])<<16|ec(t[3])<<8|255)>>>0:(t=_ae.exec(e))?(ec(t[1])<<24|ec(t[2])<<16|ec(t[3])<<8|_4(t[4]))>>>0:(t=wae.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+"ff",16)>>>0:(t=kae.exec(e))?parseInt(t[1],16)>>>0:(t=Sae.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+t[4]+t[4],16)>>>0:(t=vae.exec(e))?(x4(b4(t[1]),dp(t[2]),dp(t[3]))|255)>>>0:(t=Cae.exec(e))?(x4(b4(t[1]),dp(t[2]),dp(t[3]))|_4(t[4]))>>>0:null}function Qx(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function x4(e,t,n){const r=n<.5?n*(1+t):n+t-n*t,s=2*n-r,a=Qx(s,r,e+1/3),o=Qx(s,r,e),i=Qx(s,r,e-1/3);return Math.round(a*255)<<24|Math.round(o*255)<<16|Math.round(i*255)<<8}function ec(e){const t=parseInt(e,10);return t<0?0:t>255?255:t}function b4(e){return(parseFloat(e)%360+360)%360/360}function _4(e){const t=parseFloat(e);return t<0?0:t>1?255:Math.round(t*255)}function dp(e){const t=parseFloat(e);return t<0?0:t>100?1:t/100}function v4(e){let t=Mae(e);if(t===null)return e;t=t||0;const n=(t&4278190080)>>>24,r=(t&16711680)>>>16,s=(t&65280)>>>8,a=(t&255)/255;return`rgba(${n}, ${r}, ${s}, ${a})`}var zc=(e,t,n)=>{if(Re.fun(e))return e;if(Re.arr(e))return zc({range:e,output:t,extrapolate:n});if(Re.str(e.output[0]))return LS(e);const r=e,s=r.output,a=r.range||[0,1],o=r.extrapolateLeft||r.extrapolate||"extend",i=r.extrapolateRight||r.extrapolate||"extend",c=r.easing||(u=>u);return u=>{const d=Aae(u,a);return Tae(u,a[d],a[d+1],s[d],s[d+1],c,o,i,r.map)}};function Tae(e,t,n,r,s,a,o,i,c){let u=c?c(e):e;if(u<t){if(o==="identity")return u;o==="clamp"&&(u=t)}if(u>n){if(i==="identity")return u;i==="clamp"&&(u=n)}return r===s?r:t===n?e<=t?r:s:(t===-1/0?u=-u:n===1/0?u=u-t:u=(u-t)/(n-t),u=a(u),r===-1/0?u=-u:s===1/0?u=u+r:u=u*(s-r)+r,u)}function Aae(e,t){for(var n=1;n<t.length-1&&!(t[n]>=e);++n);return n-1}var cj={linear:e=>e},ff=Symbol.for("FluidValue.get"),qc=Symbol.for("FluidValue.observers"),Ts=e=>!!(e&&e[ff]),Wr=e=>e&&e[ff]?e[ff]():e,C4=e=>e[qc]||null;function Nae(e,t){e.eventObserved?e.eventObserved(t):e(t)}function mf(e,t){const n=e[qc];n&&n.forEach(r=>{Nae(r,t)})}var uj=class{constructor(e){if(!e&&!(e=this.get))throw Error("Unknown getter");Rae(this,e)}},Rae=(e,t)=>dj(e,ff,t);function Au(e,t){if(e[ff]){let n=e[qc];n||dj(e,qc,n=new Set),n.has(t)||(n.add(t),e.observerAdded&&e.observerAdded(n.size,t))}return t}function pf(e,t){const n=e[qc];if(n&&n.has(t)){const r=n.size-1;r?n.delete(t):e[qc]=null,e.observerRemoved&&e.observerRemoved(r,t)}}var dj=(e,t,n)=>Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0}),mh=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Dae=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,w4=new RegExp(`(${mh.source})(%|[a-z]+)`,"i"),Iae=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,U0=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,fj=e=>{const[t,n]=jae(e);if(!t||OS())return e;const r=window.getComputedStyle(document.documentElement).getPropertyValue(t);if(r)return r.trim();if(n&&n.startsWith("--")){const s=window.getComputedStyle(document.documentElement).getPropertyValue(n);return s||e}else{if(n&&U0.test(n))return fj(n);if(n)return n}return e},jae=e=>{const t=U0.exec(e);if(!t)return[,];const[,n,r]=t;return[n,r]},Xx,Pae=(e,t,n,r,s)=>`rgba(${Math.round(t)}, ${Math.round(n)}, ${Math.round(r)}, ${s})`,mj=e=>{Xx||(Xx=oi?new RegExp(`(${Object.keys(oi).join("|")})(?!\\w)`,"g"):/^\b$/);const t=e.output.map(a=>Wr(a).replace(U0,fj).replace(Dae,v4).replace(Xx,v4)),n=t.map(a=>a.match(mh).map(Number)),s=n[0].map((a,o)=>n.map(i=>{if(!(o in i))throw Error('The arity of each "output" value must be equal');return i[o]})).map(a=>zc({...e,output:a}));return a=>{const o=!w4.test(t[0])&&t.find(c=>w4.test(c))?.replace(mh,"");let i=0;return t[0].replace(mh,()=>`${s[i++](a)}${o||""}`).replace(Iae,Pae)}},US="react-spring: ",pj=e=>{const t=e;let n=!1;if(typeof t!="function")throw new TypeError(`${US}once requires a function parameter`);return(...r)=>{n||(t(...r),n=!0)}},Oae=pj(console.warn);function Lae(){Oae(`${US}The "interpolate" function is deprecated in v9 (use "to" instead)`)}var Fae=pj(console.warn);function Uae(){Fae(`${US}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function B0(e){return Re.str(e)&&(e[0]=="#"||/\d/.test(e)||!OS()&&U0.test(e)||e in(oi||{}))}var ei=OS()?f.useEffect:f.useLayoutEffect,Bae=()=>{const e=f.useRef(!1);return ei(()=>(e.current=!0,()=>{e.current=!1}),[]),e};function BS(){const e=f.useState()[1],t=Bae();return()=>{t.current&&e(Math.random())}}var HS=e=>f.useEffect(e,Hae),Hae=[];function J2(e){const t=f.useRef(void 0);return f.useEffect(()=>{t.current=e}),t.current}var hf=Symbol.for("Animated:node"),Vae=e=>!!e&&e[hf]===e,Na=e=>e&&e[hf],VS=(e,t)=>pae(e,hf,t),H0=e=>e&&e[hf]&&e[hf].getPayload(),hj=class{constructor(){VS(this,this)}getPayload(){return this.payload||[]}},V0=class gj extends hj{constructor(t){super(),this._value=t,this.done=!0,this.durationProgress=0,Re.num(this._value)&&(this.lastPosition=this._value)}static create(t){return new gj(t)}getPayload(){return[this]}getValue(){return this._value}setValue(t,n){return Re.num(t)&&(this.lastPosition=t,n&&(t=Math.round(t/n)*n,this.done&&(this.lastPosition=t))),this._value===t?!1:(this._value=t,!0)}reset(){const{done:t}=this;this.done=!1,Re.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,t&&(this.lastVelocity=null),this.v0=null)}},Yh=class yj extends V0{constructor(t){super(0),this._string=null,this._toString=zc({output:[t,t]})}static create(t){return new yj(t)}getValue(){const t=this._string;return t??(this._string=this._toString(this._value))}setValue(t){if(Re.str(t)){if(t==this._string)return!1;this._string=t,this._value=1}else if(super.setValue(t))this._string=null;else return!1;return!0}reset(t){t&&(this._toString=zc({output:[this.getValue(),t]})),this._value=0,super.reset()}},Qh={dependencies:null},G0=class extends hj{constructor(e){super(),this.source=e,this.setValue(e)}getValue(e){const t={};return qa(this.source,(n,r)=>{Vae(n)?t[r]=n.getValue(e):Ts(n)?t[r]=Wr(n):e||(t[r]=n)}),t}setValue(e){this.source=e,this.payload=this._makePayload(e)}reset(){this.payload&&_t(this.payload,e=>e.reset())}_makePayload(e){if(e){const t=new Set;return qa(e,this._addToPayload,t),Array.from(t)}}_addToPayload(e){Qh.dependencies&&Ts(e)&&Qh.dependencies.add(e);const t=H0(e);t&&_t(t,n=>this.add(n))}},Gae=class xj extends G0{constructor(t){super(t)}static create(t){return new xj(t)}getValue(){return this.source.map(t=>t.getValue())}setValue(t){const n=this.getPayload();return t.length==n.length?n.map((r,s)=>r.setValue(t[s])).some(Boolean):(super.setValue(t.map(zae)),!0)}};function zae(e){return(B0(e)?Yh:V0).create(e)}function e_(e){const t=Na(e);return t?t.constructor:Re.arr(e)?Gae:B0(e)?Yh:V0}var S4=(e,t)=>{const n=!Re.fun(e)||e.prototype&&e.prototype.isReactComponent;return f.forwardRef((r,s)=>{const a=f.useRef(null),o=n&&f.useCallback(g=>{a.current=Wae(s,g)},[s]),[i,c]=$ae(r,t),u=BS(),d=()=>{const g=a.current;if(n&&!g)return;(g?t.applyAnimatedValues(g,i.getValue(!0)):!1)===!1&&u()},m=new qae(d,c),p=f.useRef(void 0);ei(()=>(p.current=m,_t(c,g=>Au(g,m)),()=>{p.current&&(_t(p.current.deps,g=>pf(g,p.current)),Et.cancel(p.current.update))})),f.useEffect(d,[]),HS(()=>()=>{const g=p.current;_t(g.deps,y=>pf(y,g))});const h=t.getComponentProps(i.getValue());return f.createElement(e,{...h,ref:o})})},qae=class{constructor(e,t){this.update=e,this.deps=t}eventObserved(e){e.type=="change"&&Et.write(this.update)}};function $ae(e,t){const n=new Set;return Qh.dependencies=n,e.style&&(e={...e,style:t.createAnimatedStyle(e.style)}),e=new G0(e),Qh.dependencies=null,[e,n]}function Wae(e,t){return e&&(Re.fun(e)?e(t):e.current=t),t}var E4=Symbol.for("AnimatedComponent"),Kae=(e,{applyAnimatedValues:t=()=>!1,createAnimatedStyle:n=s=>new G0(s),getComponentProps:r=s=>s}={})=>{const s={applyAnimatedValues:t,createAnimatedStyle:n,getComponentProps:r},a=o=>{const i=k4(o)||"Anonymous";return Re.str(o)?o=a[o]||(a[o]=S4(o,s)):o=o[E4]||(o[E4]=S4(o,s)),o.displayName=`Animated(${i})`,o};return qa(e,(o,i)=>{Re.arr(e)&&(i=k4(o)),a[i]=a(o)}),{animated:a}},k4=e=>Re.str(e)?e:e&&Re.str(e.displayName)?e.displayName:Re.fun(e)&&e.name||null;function Kr(e,...t){return Re.fun(e)?e(...t):e}var Hd=(e,t)=>e===!0||!!(t&&e&&(Re.fun(e)?e(t):Or(e).includes(t))),bj=(e,t)=>Re.obj(e)?t&&e[t]:e,_j=(e,t)=>e.default===!0?e[t]:e.default?e.default[t]:void 0,Yae=e=>e,z0=(e,t=Yae)=>{let n=Qae;e.default&&e.default!==!0&&(e=e.default,n=Object.keys(e));const r={};for(const s of n){const a=t(e[s],s);Re.und(a)||(r[s]=a)}return r},Qae=["config","onProps","onStart","onChange","onPause","onResume","onRest"],Xae={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function Zae(e){const t={};let n=0;if(qa(e,(r,s)=>{Xae[s]||(t[s]=r,n++)}),n)return t}function q0(e){const t=Zae(e);if(t){const n={to:t};return qa(e,(r,s)=>s in t||(n[s]=r)),n}return{...e}}function gf(e){return e=Wr(e),Re.arr(e)?e.map(gf):B0(e)?Us.createStringInterpolator({range:[0,1],output:[e,e]})(1):e}function vj(e){for(const t in e)return!0;return!1}function t_(e){return Re.fun(e)||Re.arr(e)&&Re.obj(e[0])}function n_(e,t){e.ref?.delete(e),t?.delete(e)}function Cj(e,t){t&&e.ref!==t&&(e.ref?.delete(e),t.add(e),e.ref=t)}var wj={default:{tension:170,friction:26}},r_={...wj.default,mass:1,damping:1,easing:cj.linear,clamp:!1},Jae=class{constructor(){this.velocity=0,Object.assign(this,r_)}};function eoe(e,t,n){n&&(n={...n},M4(n,t),t={...n,...t}),M4(e,t),Object.assign(e,t);for(const o in r_)e[o]==null&&(e[o]=r_[o]);let{frequency:r,damping:s}=e;const{mass:a}=e;return Re.und(r)||(r<.01&&(r=.01),s<0&&(s=0),e.tension=Math.pow(2*Math.PI/r,2)*a,e.friction=4*Math.PI*s*a/r),e}function M4(e,t){if(!Re.und(t.decay))e.duration=void 0;else{const n=!Re.und(t.tension)||!Re.und(t.friction);(n||!Re.und(t.frequency)||!Re.und(t.damping)||!Re.und(t.mass))&&(e.duration=void 0,e.decay=void 0),n&&(e.frequency=void 0)}}var T4=[],toe=class{constructor(){this.changed=!1,this.values=T4,this.toValues=null,this.fromValues=T4,this.config=new Jae,this.immediate=!1}};function Sj(e,{key:t,props:n,defaultProps:r,state:s,actions:a}){return new Promise((o,i)=>{let c,u,d=Hd(n.cancel??r?.cancel,t);if(d)h();else{Re.und(n.pause)||(s.paused=Hd(n.pause,t));let g=r?.pause;g!==!0&&(g=s.paused||Hd(g,t)),c=Kr(n.delay||0,t),g?(s.resumeQueue.add(p),a.pause()):(a.resume(),p())}function m(){s.resumeQueue.add(p),s.timeouts.delete(u),u.cancel(),c=u.time-Et.now()}function p(){c>0&&!Us.skipAnimation?(s.delayed=!0,u=Et.setTimeout(h,c),s.pauseQueue.add(m),s.timeouts.add(u)):h()}function h(){s.delayed&&(s.delayed=!1),s.pauseQueue.delete(m),s.timeouts.delete(u),e<=(s.cancelId||0)&&(d=!0);try{a.start({...n,callId:e,cancel:d},o)}catch(g){i(g)}}})}var GS=(e,t)=>t.length==1?t[0]:t.some(n=>n.cancelled)?Ac(e.get()):t.every(n=>n.noop)?Ej(e.get()):ta(e.get(),t.every(n=>n.finished)),Ej=e=>({value:e,noop:!0,finished:!0,cancelled:!1}),ta=(e,t,n=!1)=>({value:e,finished:t,cancelled:n}),Ac=e=>({value:e,cancelled:!0,finished:!1});function kj(e,t,n,r){const{callId:s,parentId:a,onRest:o}=t,{asyncTo:i,promise:c}=n;return!a&&e===i&&!t.reset?c:n.promise=(async()=>{n.asyncId=s,n.asyncTo=e;const u=z0(t,(b,x)=>x==="onRest"?void 0:b);let d,m;const p=new Promise((b,x)=>(d=b,m=x)),h=b=>{const x=s<=(n.cancelId||0)&&Ac(r)||s!==n.asyncId&&ta(r,!1);if(x)throw b.result=x,m(b),b},g=(b,x)=>{const _=new s_,v=new A4;return(async()=>{if(Us.skipAnimation)throw yf(n),v.result=ta(r,!1),m(v),v;h(_);const C=Re.obj(b)?{...b}:{...x,to:b};C.parentId=s,qa(u,(S,E)=>{Re.und(C[E])&&(C[E]=S)});const w=await r.start(C);return h(_),n.paused&&await new Promise(S=>{n.resumeQueue.add(S)}),w})()};let y;if(Us.skipAnimation)return yf(n),ta(r,!1);try{let b;Re.arr(e)?b=(async x=>{for(const _ of x)await g(_)})(e):b=Promise.resolve(e(g,r.stop.bind(r))),await Promise.all([b.then(d),p]),y=ta(r.get(),!0,!1)}catch(b){if(b instanceof s_)y=b.result;else if(b instanceof A4)y=b.result;else throw b}finally{s==n.asyncId&&(n.asyncId=a,n.asyncTo=a?i:void 0,n.promise=a?c:void 0)}return Re.fun(o)&&Et.batchedUpdates(()=>{o(y,r,r.item)}),y})()}function yf(e,t){Ud(e.timeouts,n=>n.cancel()),e.pauseQueue.clear(),e.resumeQueue.clear(),e.asyncId=e.asyncTo=e.promise=void 0,t&&(e.cancelId=t)}var s_=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},A4=class extends Error{constructor(){super("SkipAnimationSignal")}},a_=e=>e instanceof $0,noe=1,$0=class extends uj{constructor(){super(...arguments),this.id=noe++,this._priority=0}get priority(){return this._priority}set priority(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}get(){const e=Na(this);return e&&e.getValue()}to(...e){return Us.to(this,e)}interpolate(...e){return Lae(),Us.to(this,e)}toJSON(){return this.get()}observerAdded(e){e==1&&this._attach()}observerRemoved(e){e==0&&this._detach()}_attach(){}_detach(){}_onChange(e,t=!1){mf(this,{type:"change",parent:this,value:e,idle:t})}_onPriorityChange(e){this.idle||L0.sort(this),mf(this,{type:"priority",parent:this,priority:e})}},pl=Symbol.for("SpringPhase"),Mj=1,o_=2,i_=4,Zx=e=>(e[pl]&Mj)>0,zo=e=>(e[pl]&o_)>0,rd=e=>(e[pl]&i_)>0,N4=(e,t)=>t?e[pl]|=o_|Mj:e[pl]&=~o_,R4=(e,t)=>t?e[pl]|=i_:e[pl]&=~i_,Tj=class extends $0{constructor(e,t){if(super(),this.animation=new toe,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!Re.und(e)||!Re.und(t)){const n=Re.obj(e)?{...e}:{...t,from:e};Re.und(n.default)&&(n.default=!0),this.start(n)}}get idle(){return!(zo(this)||this._state.asyncTo)||rd(this)}get goal(){return Wr(this.animation.to)}get velocity(){const e=Na(this);return e instanceof V0?e.lastVelocity||0:e.getPayload().map(t=>t.lastVelocity||0)}get hasAnimated(){return Zx(this)}get isAnimating(){return zo(this)}get isPaused(){return rd(this)}get isDelayed(){return this._state.delayed}advance(e){let t=!0,n=!1;const r=this.animation;let{toValues:s}=r;const{config:a}=r,o=H0(r.to);!o&&Ts(r.to)&&(s=Or(Wr(r.to))),r.values.forEach((u,d)=>{if(u.done)return;const m=u.constructor==Yh?1:o?o[d].lastPosition:s[d];let p=r.immediate,h=m;if(!p){if(h=u.lastPosition,a.tension<=0){u.done=!0;return}let g=u.elapsedTime+=e;const y=r.fromValues[d],b=u.v0!=null?u.v0:u.v0=Re.arr(a.velocity)?a.velocity[d]:a.velocity;let x;const _=a.precision||(y==m?.005:Math.min(1,Math.abs(m-y)*.001));if(Re.und(a.duration))if(a.decay){const v=a.decay===!0?.998:a.decay,C=Math.exp(-(1-v)*g);h=y+b/(1-v)*(1-C),p=Math.abs(u.lastPosition-h)<=_,x=b*C}else{x=u.lastVelocity==null?b:u.lastVelocity;const v=a.restVelocity||_/10,C=a.clamp?0:a.bounce,w=!Re.und(C),S=y==m?u.v0>0:y<m;let E,T=!1;const k=1,M=Math.ceil(e/k);for(let N=0;N<M&&(E=Math.abs(x)>v,!(!E&&(p=Math.abs(m-h)<=_,p)));++N){w&&(T=h==m||h>m==S,T&&(x=-x*C,h=m));const P=-a.tension*1e-6*(h-m),O=-a.friction*.001*x,L=(P+O)/a.mass;x=x+L*k,h=h+x*k}}else{let v=1;a.duration>0&&(this._memoizedDuration!==a.duration&&(this._memoizedDuration=a.duration,u.durationProgress>0&&(u.elapsedTime=a.duration*u.durationProgress,g=u.elapsedTime+=e)),v=(a.progress||0)+g/this._memoizedDuration,v=v>1?1:v<0?0:v,u.durationProgress=v),h=y+a.easing(v)*(m-y),x=(h-u.lastPosition)/e,p=v==1}u.lastVelocity=x,Number.isNaN(h)&&(console.warn("Got NaN while animating:",this),p=!0)}o&&!o[d].done&&(p=!1),p?u.done=!0:t=!1,u.setValue(h,a.round)&&(n=!0)});const i=Na(this),c=i.getValue();if(t){const u=Wr(r.to);(c!==u||n)&&!a.decay?(i.setValue(u),this._onChange(u)):n&&a.decay&&this._onChange(c),this._stop()}else n&&this._onChange(c)}set(e){return Et.batchedUpdates(()=>{this._stop(),this._focus(e),this._set(e)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(zo(this)){const{to:e,config:t}=this.animation;Et.batchedUpdates(()=>{this._onStart(),t.decay||this._set(e,!1),this._stop()})}return this}update(e){return(this.queue||(this.queue=[])).push(e),this}start(e,t){let n;return Re.und(e)?(n=this.queue||[],this.queue=[]):n=[Re.obj(e)?e:{...t,to:e}],Promise.all(n.map(r=>this._update(r))).then(r=>GS(this,r))}stop(e){const{to:t}=this.animation;return this._focus(this.get()),yf(this._state,e&&this._lastCallId),Et.batchedUpdates(()=>this._stop(t,e)),this}reset(){this._update({reset:!0})}eventObserved(e){e.type=="change"?this._start():e.type=="priority"&&(this.priority=e.priority+1)}_prepareNode(e){const t=this.key||"";let{to:n,from:r}=e;n=Re.obj(n)?n[t]:n,(n==null||t_(n))&&(n=void 0),r=Re.obj(r)?r[t]:r,r==null&&(r=void 0);const s={to:n,from:r};return Zx(this)||(e.reverse&&([n,r]=[r,n]),r=Wr(r),Re.und(r)?Na(this)||this._set(n):this._set(r)),s}_update({...e},t){const{key:n,defaultProps:r}=this;e.default&&Object.assign(r,z0(e,(o,i)=>/^on/.test(i)?bj(o,n):o)),I4(this,e,"onProps"),ad(this,"onProps",e,this);const s=this._prepareNode(e);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const a=this._state;return Sj(++this._lastCallId,{key:n,props:e,defaultProps:r,state:a,actions:{pause:()=>{rd(this)||(R4(this,!0),Nd(a.pauseQueue),ad(this,"onPause",ta(this,sd(this,this.animation.to)),this))},resume:()=>{rd(this)&&(R4(this,!1),zo(this)&&this._resume(),Nd(a.resumeQueue),ad(this,"onResume",ta(this,sd(this,this.animation.to)),this))},start:this._merge.bind(this,s)}}).then(o=>{if(e.loop&&o.finished&&!(t&&o.noop)){const i=Aj(e);if(i)return this._update(i,!0)}return o})}_merge(e,t,n){if(t.cancel)return this.stop(!0),n(Ac(this));const r=!Re.und(e.to),s=!Re.und(e.from);if(r||s)if(t.callId>this._lastToId)this._lastToId=t.callId;else return n(Ac(this));const{key:a,defaultProps:o,animation:i}=this,{to:c,from:u}=i;let{to:d=c,from:m=u}=e;s&&!r&&(!t.default||Re.und(d))&&(d=m),t.reverse&&([d,m]=[m,d]);const p=!mo(m,u);p&&(i.from=m),m=Wr(m);const h=!mo(d,c);h&&this._focus(d);const g=t_(t.to),{config:y}=i,{decay:b,velocity:x}=y;(r||s)&&(y.velocity=0),t.config&&!g&&eoe(y,Kr(t.config,a),t.config!==o.config?Kr(o.config,a):void 0);let _=Na(this);if(!_||Re.und(d))return n(ta(this,!0));const v=Re.und(t.reset)?s&&!t.default:!Re.und(m)&&Hd(t.reset,a),C=v?m:this.get(),w=gf(d),S=Re.num(w)||Re.arr(w)||B0(w),E=!g&&(!S||Hd(o.immediate||t.immediate,a));if(h){const N=e_(d);if(N!==_.constructor)if(E)_=this._set(w);else throw Error(`Cannot animate between ${_.constructor.name} and ${N.name}, as the "to" prop suggests`)}const T=_.constructor;let k=Ts(d),M=!1;if(!k){const N=v||!Zx(this)&&p;(h||N)&&(M=mo(gf(C),w),k=!M),(!mo(i.immediate,E)&&!E||!mo(y.decay,b)||!mo(y.velocity,x))&&(k=!0)}if(M&&zo(this)&&(i.changed&&!v?k=!0:k||this._stop(c)),!g&&((k||Ts(c))&&(i.values=_.getPayload(),i.toValues=Ts(d)?null:T==Yh?[1]:Or(w)),i.immediate!=E&&(i.immediate=E,!E&&!v&&this._set(c)),k)){const{onRest:N}=i;_t(soe,O=>I4(this,t,O));const P=ta(this,sd(this,c));Nd(this._pendingCalls,P),this._pendingCalls.add(n),i.changed&&Et.batchedUpdates(()=>{i.changed=!v,N?.(P,this),v?Kr(o.onRest,P):i.onStart?.(P,this)})}v&&this._set(C),g?n(kj(t.to,t,this._state,this)):k?this._start():zo(this)&&!h?this._pendingCalls.add(n):n(Ej(C))}_focus(e){const t=this.animation;e!==t.to&&(C4(this)&&this._detach(),t.to=e,C4(this)&&this._attach())}_attach(){let e=0;const{to:t}=this.animation;Ts(t)&&(Au(t,this),a_(t)&&(e=t.priority+1)),this.priority=e}_detach(){const{to:e}=this.animation;Ts(e)&&pf(e,this)}_set(e,t=!0){const n=Wr(e);if(!Re.und(n)){const r=Na(this);if(!r||!mo(n,r.getValue())){const s=e_(n);!r||r.constructor!=s?VS(this,s.create(n)):r.setValue(n),r&&Et.batchedUpdates(()=>{this._onChange(n,t)})}}return Na(this)}_onStart(){const e=this.animation;e.changed||(e.changed=!0,ad(this,"onStart",ta(this,sd(this,e.to)),this))}_onChange(e,t){t||(this._onStart(),Kr(this.animation.onChange,e,this)),Kr(this.defaultProps.onChange,e,this),super._onChange(e,t)}_start(){const e=this.animation;Na(this).reset(Wr(e.to)),e.immediate||(e.fromValues=e.values.map(t=>t.lastPosition)),zo(this)||(N4(this,!0),rd(this)||this._resume())}_resume(){Us.skipAnimation?this.finish():L0.start(this)}_stop(e,t){if(zo(this)){N4(this,!1);const n=this.animation;_t(n.values,s=>{s.done=!0}),n.toValues&&(n.onChange=n.onPause=n.onResume=void 0),mf(this,{type:"idle",parent:this});const r=t?Ac(this.get()):ta(this.get(),sd(this,e??n.to));Nd(this._pendingCalls,r),n.changed&&(n.changed=!1,ad(this,"onRest",r,this))}}};function sd(e,t){const n=gf(t),r=gf(e.get());return mo(r,n)}function Aj(e,t=e.loop,n=e.to){const r=Kr(t);if(r){const s=r!==!0&&q0(r),a=(s||e).reverse,o=!s||s.reset;return xf({...e,loop:t,default:!1,pause:void 0,to:!a||t_(n)?n:void 0,from:o?e.from:void 0,reset:o,...s})}}function xf(e){const{to:t,from:n}=e=q0(e),r=new Set;return Re.obj(t)&&D4(t,r),Re.obj(n)&&D4(n,r),e.keys=r.size?Array.from(r):null,e}function roe(e){const t=xf(e);return Re.und(t.default)&&(t.default=z0(t)),t}function D4(e,t){qa(e,(n,r)=>n!=null&&t.add(r))}var soe=["onStart","onRest","onChange","onPause","onResume"];function I4(e,t,n){e.animation[n]=t[n]!==_j(t,n)?bj(t[n],e.key):void 0}function ad(e,t,...n){e.animation[t]?.(...n),e.defaultProps[t]?.(...n)}var aoe=["onStart","onChange","onRest"],ooe=1,zS=class{constructor(e,t){this.id=ooe++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),t&&(this._flush=t),e&&this.start({default:!0,...e})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(e=>e.idle&&!e.isDelayed&&!e.isPaused)}get item(){return this._item}set item(e){this._item=e}get(){const e={};return this.each((t,n)=>e[n]=t.get()),e}set(e){for(const t in e){const n=e[t];Re.und(n)||this.springs[t].set(n)}}update(e){return e&&this.queue.push(xf(e)),this}start(e){let{queue:t}=this;return e?t=Or(e).map(xf):this.queue=[],this._flush?this._flush(this,t):(jj(this,t),l_(this,t))}stop(e,t){if(e!==!!e&&(t=e),t){const n=this.springs;_t(Or(t),r=>n[r].stop(!!e))}else yf(this._state,this._lastAsyncId),this.each(n=>n.stop(!!e));return this}pause(e){if(Re.und(e))this.start({pause:!0});else{const t=this.springs;_t(Or(e),n=>t[n].pause())}return this}resume(e){if(Re.und(e))this.start({pause:!1});else{const t=this.springs;_t(Or(e),n=>t[n].resume())}return this}each(e){qa(this.springs,e)}_onFrame(){const{onStart:e,onChange:t,onRest:n}=this._events,r=this._active.size>0,s=this._changed.size>0;(r&&!this._started||s&&!this._started)&&(this._started=!0,Ud(e,([i,c])=>{c.value=this.get(),i(c,this,this._item)}));const a=!r&&this._started,o=s||a&&n.size?this.get():null;s&&t.size&&Ud(t,([i,c])=>{c.value=o,i(c,this,this._item)}),a&&(this._started=!1,Ud(n,([i,c])=>{c.value=o,i(c,this,this._item)}))}eventObserved(e){if(e.type=="change")this._changed.add(e.parent),e.idle||this._active.add(e.parent);else if(e.type=="idle")this._active.delete(e.parent);else return;Et.onFrame(this._onFrame)}};function l_(e,t){return Promise.all(t.map(n=>Nj(e,n))).then(n=>GS(e,n))}async function Nj(e,t,n){const{keys:r,to:s,from:a,loop:o,onRest:i,onResolve:c}=t,u=Re.obj(t.default)&&t.default;o&&(t.loop=!1),s===!1&&(t.to=null),a===!1&&(t.from=null);const d=Re.arr(s)||Re.fun(s)?s:void 0;d?(t.to=void 0,t.onRest=void 0,u&&(u.onRest=void 0)):_t(aoe,y=>{const b=t[y];if(Re.fun(b)){const x=e._events[y];t[y]=({finished:_,cancelled:v})=>{const C=x.get(b);C?(_||(C.finished=!1),v&&(C.cancelled=!0)):x.set(b,{value:null,finished:_||!1,cancelled:v||!1})},u&&(u[y]=t[y])}});const m=e._state;t.pause===!m.paused?(m.paused=t.pause,Nd(t.pause?m.pauseQueue:m.resumeQueue)):m.paused&&(t.pause=!0);const p=(r||Object.keys(e.springs)).map(y=>e.springs[y].start(t)),h=t.cancel===!0||_j(t,"cancel")===!0;(d||h&&m.asyncId)&&p.push(Sj(++e._lastAsyncId,{props:t,state:m,actions:{pause:X2,resume:X2,start(y,b){h?(yf(m,e._lastAsyncId),b(Ac(e))):(y.onRest=i,b(kj(d,y,m,e)))}}})),m.paused&&await new Promise(y=>{m.resumeQueue.add(y)});const g=GS(e,await Promise.all(p));if(o&&g.finished&&!(n&&g.noop)){const y=Aj(t,o,s);if(y)return jj(e,[y]),Nj(e,y,!0)}return c&&Et.batchedUpdates(()=>c(g,e,e.item)),g}function c_(e,t){const n={...e.springs};return t&&_t(Or(t),r=>{Re.und(r.keys)&&(r=xf(r)),Re.obj(r.to)||(r={...r,to:void 0}),Ij(n,r,s=>Dj(s))}),Rj(e,n),n}function Rj(e,t){qa(t,(n,r)=>{e.springs[r]||(e.springs[r]=n,Au(n,e))})}function Dj(e,t){const n=new Tj;return n.key=e,t&&Au(n,t),n}function Ij(e,t,n){t.keys&&_t(t.keys,r=>{(e[r]||(e[r]=n(r)))._prepareNode(t)})}function jj(e,t){_t(t,n=>{Ij(e.springs,n,r=>Dj(r,e))})}var qS=f.createContext({pause:!1,immediate:!1}),$S=()=>{const e=[],t=function(r){Uae();const s=[];return _t(e,(a,o)=>{if(Re.und(r))s.push(a.start());else{const i=n(r,a,o);i&&s.push(a.start(i))}}),s};t.current=e,t.add=function(r){e.includes(r)||e.push(r)},t.delete=function(r){const s=e.indexOf(r);~s&&e.splice(s,1)},t.pause=function(){return _t(e,r=>r.pause(...arguments)),this},t.resume=function(){return _t(e,r=>r.resume(...arguments)),this},t.set=function(r){_t(e,(s,a)=>{const o=Re.fun(r)?r(a,s):r;o&&s.set(o)})},t.start=function(r){const s=[];return _t(e,(a,o)=>{if(Re.und(r))s.push(a.start());else{const i=this._getProps(r,a,o);i&&s.push(a.start(i))}}),s},t.stop=function(){return _t(e,r=>r.stop(...arguments)),this},t.update=function(r){return _t(e,(s,a)=>s.update(this._getProps(r,s,a))),this};const n=function(r,s,a){return Re.fun(r)?r(a,s):r};return t._getProps=n,t};function Pj(e,t,n){const r=Re.fun(t)&&t;r&&!n&&(n=[]);const s=f.useMemo(()=>r||arguments.length==3?$S():void 0,[]),a=f.useRef(0),o=BS(),i=f.useMemo(()=>({ctrls:[],queue:[],flush(x,_){const v=c_(x,_);return a.current>0&&!i.queue.length&&!Object.keys(v).some(w=>!x.springs[w])?l_(x,_):new Promise(w=>{Rj(x,v),i.queue.push(()=>{w(l_(x,_))}),o()})}}),[]),c=f.useRef([...i.ctrls]),u=f.useRef([]),d=J2(e)||0;f.useMemo(()=>{_t(c.current.slice(e,d),x=>{n_(x,s),x.stop(!0)}),c.current.length=e,m(d,e)},[e]),f.useMemo(()=>{m(0,Math.min(d,e))},n);function m(x,_){for(let v=x;v<_;v++){const C=c.current[v]||(c.current[v]=new zS(null,i.flush)),w=r?r(v,C):t[v];w&&(u.current[v]=roe(w))}}const p=c.current.map((x,_)=>c_(x,u.current[_])),h=f.useContext(qS),g=J2(h),y=h!==g&&vj(h);ei(()=>{a.current++,i.ctrls=c.current;const{queue:x}=i;x.length&&(i.queue=[],_t(x,_=>_())),_t(c.current,(_,v)=>{s?.add(_),y&&_.start({default:h});const C=u.current[v];C&&(Cj(_,C.ref),_.ref?_.queue.push(C):_.start(C))})}),HS(()=>()=>{_t(i.ctrls,x=>x.stop(!0))});const b=p.map(x=>({...x}));return s?[b,s]:b}function WS(e,t){const n=Re.fun(e),[[r],s]=Pj(1,n?e:[e],n?t||[]:t);return n||arguments.length==2?[r,s]:r}function rm(e,t,n){const r=Re.fun(t)&&t,{reset:s,sort:a,trail:o=0,expires:i=!0,exitBeforeEnter:c=!1,onDestroyed:u,ref:d,config:m}=r?r():t,p=f.useMemo(()=>r||arguments.length==3?$S():void 0,[]),h=Or(e),g=[],y=f.useRef(null),b=s?null:y.current;ei(()=>{y.current=g}),HS(()=>(_t(g,L=>{p?.add(L.ctrl),L.ctrl.ref=p}),()=>{_t(y.current,L=>{L.expired&&clearTimeout(L.expirationId),n_(L.ctrl,p),L.ctrl.stop(!0)})}));const x=loe(h,r?r():t,b),_=s&&y.current||[];ei(()=>_t(_,({ctrl:L,item:H,key:R})=>{n_(L,p),Kr(u,H,R)}));const v=[];if(b&&_t(b,(L,H)=>{L.expired?(clearTimeout(L.expirationId),_.push(L)):(H=v[H]=x.indexOf(L.key),~H&&(g[H]=L))}),_t(h,(L,H)=>{g[H]||(g[H]={key:x[H],item:L,phase:"mount",ctrl:new zS},g[H].ctrl.item=L)}),v.length){let L=-1;const{leave:H}=r?r():t;_t(v,(R,I)=>{const F=b[I];~R?(L=g.indexOf(F),g[L]={...F,item:h[R]}):H&&g.splice(++L,0,F)})}Re.fun(a)&&g.sort((L,H)=>a(L.item,H.item));let C=-o;const w=BS(),S=z0(t),E=new Map,T=f.useRef(new Map),k=f.useRef(!1);_t(g,(L,H)=>{const R=L.key,I=L.phase,F=r?r():t;let G,j;const $=Kr(F.delay||0,R);if(I=="mount")G=F.enter,j="enter";else{const J=x.indexOf(R)<0;if(I!="leave")if(J)G=F.leave,j="leave";else if(G=F.update)j="update";else return;else if(!J)G=F.enter,j="enter";else return}if(G=Kr(G,L.item,H),G=Re.obj(G)?q0(G):{to:G},!G.config){const J=m||S.config;G.config=Kr(J,L.item,H,j)}C+=o;const q={...S,delay:$+C,ref:d,immediate:F.immediate,reset:!1,...G};if(j=="enter"&&Re.und(q.from)){const J=r?r():t,ne=Re.und(J.initial)||b?J.from:J.initial;q.from=Kr(ne,L.item,H)}const{onResolve:U}=q;q.onResolve=J=>{Kr(U,J);const ne=y.current,ae=ne.find(de=>de.key===R);if(ae&&!(J.cancelled&&ae.phase!="update")&&ae.ctrl.idle){const de=ne.every(oe=>oe.ctrl.idle);if(ae.phase=="leave"){const oe=Kr(i,ae.item);if(oe!==!1){const le=oe===!0?0:oe;if(ae.expired=!0,!de&&le>0){le<=2147483647&&(ae.expirationId=setTimeout(w,le));return}}}de&&ne.some(oe=>oe.expired)&&(T.current.delete(ae),c&&(k.current=!0),w())}};const X=c_(L.ctrl,q);j==="leave"&&c?T.current.set(L,{phase:j,springs:X,payload:q}):E.set(L,{phase:j,springs:X,payload:q})});const M=f.useContext(qS),N=J2(M),P=M!==N&&vj(M);ei(()=>{P&&_t(g,L=>{L.ctrl.start({default:M})})},[M]),_t(E,(L,H)=>{if(T.current.size){const R=g.findIndex(I=>I.key===H.key);g.splice(R,1)}}),ei(()=>{_t(T.current.size?T.current:E,({phase:L,payload:H},R)=>{const{ctrl:I}=R;R.phase=L,p?.add(I),P&&L=="enter"&&I.start({default:M}),H&&(Cj(I,H.ref),(I.ref||p)&&!k.current?I.update(H):(I.start(H),k.current&&(k.current=!1)))})},s?void 0:n);const O=L=>f.createElement(f.Fragment,null,g.map((H,R)=>{const{springs:I}=E.get(H)||H.ctrl,F=L({...I},H.item,H,R),G=Re.str(H.key)||Re.num(H.key)?H.key:H.ctrl.id,j=f.version<"19.0.0",$=F?.props??{},q=j?F?.ref:$?.ref;return F&&F.type?f.createElement(F.type,{...$,key:G,ref:q}):F}));return p?[O,p]:O}var ioe=1;function loe(e,{key:t,keys:n=t},r){if(n===null){const s=new Set;return e.map(a=>{const o=r&&r.find(i=>i.item===a&&i.phase!=="leave"&&!s.has(i));return o?(s.add(o),o.key):ioe++})}return Re.und(n)?e:Re.fun(n)?e.map(n):Or(n)}var KS=class extends $0{constructor(e,t){super(),this.source=e,this.idle=!0,this._active=new Set,this.calc=zc(...t);const n=this._get(),r=e_(n);VS(this,r.create(n))}advance(e){const t=this._get(),n=this.get();mo(t,n)||(Na(this).setValue(t),this._onChange(t,this.idle)),!this.idle&&j4(this._active)&&Jx(this)}_get(){const e=Re.arr(this.source)?this.source.map(Wr):Or(Wr(this.source));return this.calc(...e)}_start(){this.idle&&!j4(this._active)&&(this.idle=!1,_t(H0(this),e=>{e.done=!1}),Us.skipAnimation?(Et.batchedUpdates(()=>this.advance()),Jx(this)):L0.start(this))}_attach(){let e=1;_t(Or(this.source),t=>{Ts(t)&&Au(t,this),a_(t)&&(t.idle||this._active.add(t),e=Math.max(e,t.priority+1))}),this.priority=e,this._start()}_detach(){_t(Or(this.source),e=>{Ts(e)&&pf(e,this)}),this._active.clear(),Jx(this)}eventObserved(e){e.type=="change"?e.idle?this.advance():(this._active.add(e.parent),this._start()):e.type=="idle"?this._active.delete(e.parent):e.type=="priority"&&(this.priority=Or(this.source).reduce((t,n)=>Math.max(t,(a_(n)?n.priority:0)+1),0))}};function coe(e){return e.idle!==!1}function j4(e){return!e.size||Array.from(e).every(coe)}function Jx(e){e.idle||(e.idle=!0,_t(H0(e),t=>{t.done=!0}),mf(e,{type:"idle",parent:e}))}var Oj=(e,...t)=>new KS(e,t);Us.assign({createStringInterpolator:mj,to:(e,t)=>new KS(e,t)});var Lj=/^--/;function uoe(e,t){return t==null||typeof t=="boolean"||t===""?"":typeof t=="number"&&t!==0&&!Lj.test(e)&&!(Vd.hasOwnProperty(e)&&Vd[e])?t+"px":(""+t).trim()}var P4={};function doe(e,t){if(!e.nodeType||!e.setAttribute)return!1;const n=e.nodeName==="filter"||e.parentNode&&e.parentNode.nodeName==="filter",{className:r,style:s,children:a,scrollTop:o,scrollLeft:i,viewBox:c,...u}=t,d=Object.values(u),m=Object.keys(u).map(p=>n||e.hasAttribute(p)?p:P4[p]||(P4[p]=p.replace(/([A-Z])/g,h=>"-"+h.toLowerCase())));a!==void 0&&(e.textContent=a);for(const p in s)if(s.hasOwnProperty(p)){const h=uoe(p,s[p]);Lj.test(p)?e.style.setProperty(p,h):e.style[p]=h}m.forEach((p,h)=>{e.setAttribute(p,d[h])}),r!==void 0&&(e.className=r),o!==void 0&&(e.scrollTop=o),i!==void 0&&(e.scrollLeft=i),c!==void 0&&e.setAttribute("viewBox",c)}var Vd={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},foe=(e,t)=>e+t.charAt(0).toUpperCase()+t.substring(1),moe=["Webkit","Ms","Moz","O"];Vd=Object.keys(Vd).reduce((e,t)=>(moe.forEach(n=>e[foe(n,t)]=e[t]),e),Vd);var poe=/^(matrix|translate|scale|rotate|skew)/,hoe=/^(translate)/,goe=/^(rotate|skew)/,e1=(e,t)=>Re.num(e)&&e!==0?e+t:e,ph=(e,t)=>Re.arr(e)?e.every(n=>ph(n,t)):Re.num(e)?e===t:parseFloat(e)===t,yoe=class extends G0{constructor({x:e,y:t,z:n,...r}){const s=[],a=[];(e||t||n)&&(s.push([e||0,t||0,n||0]),a.push(o=>[`translate3d(${o.map(i=>e1(i,"px")).join(",")})`,ph(o,0)])),qa(r,(o,i)=>{if(i==="transform")s.push([o||""]),a.push(c=>[c,c===""]);else if(poe.test(i)){if(delete r[i],Re.und(o))return;const c=hoe.test(i)?"px":goe.test(i)?"deg":"";s.push(Or(o)),a.push(i==="rotate3d"?([u,d,m,p])=>[`rotate3d(${u},${d},${m},${e1(p,c)})`,ph(p,0)]:u=>[`${i}(${u.map(d=>e1(d,c)).join(",")})`,ph(u,i.startsWith("scale")?1:0)])}}),s.length&&(r.transform=new xoe(s,a)),super(r)}},xoe=class extends uj{constructor(e,t){super(),this.inputs=e,this.transforms=t,this._value=null}get(){return this._value||(this._value=this._get())}_get(){let e="",t=!0;return _t(this.inputs,(n,r)=>{const s=Wr(n[0]),[a,o]=this.transforms[r](Re.arr(s)?s:n.map(Wr));e+=" "+a,t=t&&o}),t?"none":e}observerAdded(e){e==1&&_t(this.inputs,t=>_t(t,n=>Ts(n)&&Au(n,this)))}observerRemoved(e){e==0&&_t(this.inputs,t=>_t(t,n=>Ts(n)&&pf(n,this)))}eventObserved(e){e.type=="change"&&(this._value=null),mf(this,e)}},boe=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"];Us.assign({batchedUpdates:jC.unstable_batchedUpdates,createStringInterpolator:mj,colors:xae});var _oe=Kae(boe,{applyAnimatedValues:doe,createAnimatedStyle:e=>new yoe(e),getComponentProps:({scrollTop:e,scrollLeft:t,...n})=>n}),Jr=_oe.animated;const YS=Object.freeze(Object.defineProperty({__proto__:null,BailSignal:s_,Controller:zS,FrameValue:$0,Globals:Us,Interpolation:KS,SpringContext:qS,SpringRef:$S,SpringValue:Tj,a:Jr,animated:Jr,config:wj,createInterpolator:zc,easings:cj,inferTo:q0,to:Oj,useIsomorphicLayoutEffect:ei,useSpring:WS,useSprings:Pj,useTransition:rm},Symbol.toStringTag,{value:"Module"})),voe=f.memo(function({searchMode:t,onClick:n,disabled:r}){const{$t:s}=Q(),a=f.useCallback(()=>{n(t)},[n,t]),o=gi(t),i=Ia(t);return l.jsx("span",{className:"relative [&_button]:!border-dashed",children:l.jsx(at,{variant:"secondary",size:"small",pill:!0,onClick:a,leadingIcon:o,trailingIcon:D("plus"),disabled:r,children:s(i)})})}),W0=3;function QS(e){return e.trim().toLowerCase().split(/\s+/).slice(-5).join(" ")}const Coe=(e,t,n)=>{const{value:r,loading:s}=Nl({flag:"search-mode-suggestion-keywords",defaultValue:e,extraAttributes:t,subjectType:"visitor_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},woe={},Soe=()=>{const{variation:e}=Coe(woe),t=f.useMemo(()=>{const n=new Map;return Object.entries(e).forEach(([r,s])=>{Ww(r)&&s.forEach(a=>{const o=n.get(a)||[];o.push(r),n.set(a,o)})}),n},[e]);return f.useMemo(()=>({keywords:t}),[t])},Eoe=({query:e,maxSuggestions:t=W0,omittedSearchModes:n=_e})=>{const{keywords:r}=Soe(),s=QS(e),a=f.useMemo(()=>{const o=new Set;for(const[i,c]of r){if(o.size>=t)break;if(s.includes(i.toLowerCase()))for(const u of c){if(o.size>=t)break;u!==K.SEARCH&&(n.includes(u)||o.add(u))}}return Array.from(o)},[r,s,t,n]);return f.useMemo(()=>({suggestions:a}),[a])};f.memo(function({query:t,omittedSearchModes:n=_e,onSelectSearchMode:r}){const{suggestions:s}=Eoe({query:t,omittedSearchModes:n}),a=On(),{gateSearchModeSelection:o}=jo({openPaywallUpsell:a}),{getPreferredSearchModelForSearchMode:i}=k0(),c=f.useCallback(d=>{const m=i(d);o(m)||r(d)},[o,i,r]);return rm(s,{keys:d=>d,from:{opacity:0},enter:{opacity:1},leave:{opacity:0},config:$w})((d,m)=>l.jsx(Jr.div,{style:d,children:l.jsx(voe,{searchMode:m,onClick:c})}))});const Fj=f.memo(function({source:t,onClick:n,disabled:r}){const{getSourceLabel:s,getSourceIcon:a}=Gs(),o=f.useCallback(()=>{n(t)},[n,t]),i=a(t),c=f.useMemo(()=>FN(i)?i:void 0,[i]);return l.jsx("span",{className:"relative [&_button]:!border-dashed",children:l.jsx(at,{variant:"secondary",size:"small",pill:!0,onClick:o,leadingIcon:c,trailingIcon:D("plus"),disabled:r,children:s(t)})})}),koe=f.memo(function({source:t,onClick:n}){const{getSourceLimit:r}=Kf(),s=f.useMemo(()=>{const{remaining:i}=r(t);return i<=0},[r,t]),a=f.useCallback(()=>{n(t)},[n,t]),o=f.useMemo(()=>l.jsx("div",{children:l.jsx(Fj,{source:t,onClick:a,disabled:s})}),[a,t,s]);return l.jsx(fa,{appearance:"dark",interaction:"hover",triggerElement:o,children:l.jsx(UI,{source:t})})}),Moe=f.memo(function({source:t,onClick:n}){const{trackSourceActivity:r}=I0(),s=f.useCallback(()=>{r(t),n(t)},[n,t,r]);return hi(t)?l.jsx(koe,{source:t,onClick:s}):l.jsx(Fj,{source:t,onClick:s})}),Toe=(e,t,n)=>{const{value:r,loading:s}=Nl({flag:"source-suggestion-keywords",defaultValue:e,extraAttributes:t,subjectType:"visitor_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])};function Uj(e){return Ga(e)||la(e)}const Aoe={},Noe=()=>{const{variation:e}=Toe(Aoe),t=f.useMemo(()=>{const n=new Map;return Object.entries(e).forEach(([r,s])=>{Uj(r)&&s.forEach(a=>{const o=n.get(a)||[];o.push(r),n.set(a,o)})}),n},[e]);return f.useMemo(()=>({keywords:t}),[t])},Roe=({query:e,maxSuggestions:t=W0,omittedSources:n=_e,omitCometMcpSources:r=!1})=>{const s="ask-input-plus-menu-sources",{keywords:a}=Noe(),{isAllowed:o,isConnected:i}=no({reason:s}),{sources:c,isSourceConnected:u}=Ai({omitCometMcpSources:r,isConnectorAllowed:o,isConnectorConnected:i,omittedSources:n}),d=QS(e),m=f.useMemo(()=>{const p=new Set;for(const[h,g]of a){if(p.size>=t)break;if(d.includes(h.toLowerCase()))for(const y of g){if(p.size>=t)break;c.includes(y)&&u(y)&&p.add(y)}}return Array.from(p)},[a,d,t,c,u]);return f.useMemo(()=>({suggestions:m}),[m])},Doe=({query:e,maxSuggestions:t=W0,omittedSources:n=_e,omitCometMcpSources:r=!1})=>{const s="ask-input-plus-menu-sources",{getSourceLabel:a}=Gs(),{isAllowed:o,isConnected:i}=no({reason:s}),{sources:c,isSourceConnected:u}=Ai({omitCometMcpSources:r,isConnectorAllowed:o,isConnectorConnected:i,omittedSources:n}),d=QS(e),m=f.useMemo(()=>{const p=[];for(const h of c){if(!u(h))continue;const g=a(h).toLowerCase();if(d.includes(g)&&p.push(h),p.length>=t)break}return p},[d,c,a,t,u]);return f.useMemo(()=>({suggestions:m}),[m])};function Ioe({query:e,maxSuggestions:t=W0,omittedSources:n=_e,omitCometMcpSources:r=!1}){const{suggestions:s}=Doe({query:e,maxSuggestions:t,omittedSources:n,omitCometMcpSources:r}),{suggestions:a}=Roe({query:e,maxSuggestions:t,omittedSources:n,omitCometMcpSources:r}),o=f.useMemo(()=>{const i=new Set;return s.forEach(c=>{i.size<t&&i.add(c)}),a.forEach(c=>{i.size<t&&i.add(c)}),Array.from(i).slice(0,t)},[s,a,t]);return f.useMemo(()=>({suggestions:o}),[o])}f.memo(function({query:t,omittedSources:n=_e,omitCometMcpSources:r=!1,onSuggestSource:s}){const{suggestions:a}=Ioe({query:t,omittedSources:n,omitCometMcpSources:r});return rm(a,{keys:i=>i,from:{opacity:0},enter:{opacity:1},leave:{opacity:0},config:$w})((i,c)=>l.jsx(Jr.div,{style:i,children:l.jsx(Moe,{source:c,onClick:s})}))});const K0=A.memo(function({className:t,color:n}){return l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:n||"currentColor",viewBox:"0 0 66 24",className:t,children:[l.jsx("path",{d:"M33.569 17.032a1.919 1.919 0 0 1-.799-1.593c0-1.277.935-1.982 2.857-2.157l4.956-.473v.134c0 .784-.127 1.492-.378 2.105a3.958 3.958 0 0 1-1.012 1.456c-.834.753-1.993 1.15-3.354 1.15-.94 0-1.724-.215-2.27-.622Z"}),l.jsx("path",{clipRule:"evenodd",fillRule:"evenodd",d:"M60.756 1.398c1.886.991 3.382 2.457 4.443 4.353 1.03 1.813 1.55 3.918 1.55 6.257 0 2.339-.521 4.444-1.55 6.257a10.934 10.934 0 0 1-2.475 3.027l-7.77-9.445 5.845-7.145V3.92h-3.135l-.076.096-4.626 5.837h-.009l-4.626-5.837-.075-.096h-3.136v.782l5.847 7.146-5.847 7.145v.782h3.136l.075-.095 4.626-5.837h.01l7.214 9.087-.017.01c-1.293.703-1.948 1.06-3.755 1.06H.25V1.862C.25.834 1.085 0 2.113 0h52.932c2.063 0 3.985.482 5.711 1.398ZM27.842 19.773V9.272c0-1.69-.55-3.073-1.59-4.002-.954-.851-2.28-1.301-3.834-1.301-1.375 0-2.54.306-3.463.91-.62.407-1.137.946-1.572 1.642a.1.1 0 0 1-.175-.008 4.35 4.35 0 0 0-1.35-1.605c-.864-.624-1.97-.94-3.285-.94-2.436 0-3.62.89-4.327 1.824-.059.077-.181.038-.181-.06V4.32H5.063v15.452h3.09V10.71c0-1.377.358-2.442 1.064-3.166.65-.665 1.597-1.017 2.74-1.017.967 0 1.712.26 2.215.772.488.499.736 1.221.736 2.148v10.326h3.09V10.71c0-1.377.358-2.442 1.063-3.165.65-.666 1.597-1.018 2.74-1.018.967 0 1.712.26 2.215.773.489.498.736 1.221.736 2.148v10.325h3.09Zm15.8 0 .001-10.003c0-1.821-.64-3.32-1.85-4.334-1.146-.96-2.862-1.468-4.72-1.468-1.856 0-3.49.467-4.723 1.35-1.213.87-2.003 2.096-2.254 3.557-.057.331-.04.736-.04.736h3.008l.027-.22c.122-.963.521-1.708 1.185-2.213.669-.51 1.587-.768 2.738-.768s2.038.27 2.636.8c.619.55.933 1.391.933 2.502v.682l-5.356.507c-3.577.344-5.547 1.997-5.547 4.656 0 1.375.564 2.531 1.63 3.346 1.023.781 2.436 1.194 4.088 1.194 1.43 0 2.66-.304 3.656-.903a5.177 5.177 0 0 0 1.408-1.237c.059-.075.179-.033.179.063v1.753h3.002Z"})]})}),Bj=A.memo(function({className:t}){return l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 51 24",className:t,children:[l.jsx("path",{d:"M35.069 7.954c-1.723 1.74-1.706 6.368 0 8.121 1.597 1.799 5.273 1.817 6.855 0 .873-.922 1.315-2.417 1.315-4.075 0-1.66-.442-3.144-1.317-4.048-1.584-1.853-5.256-1.834-6.853.002Z"}),l.jsx("path",{fillRule:"evenodd",d:"m48.958 5.715-.009-.015a10.792 10.792 0 0 0-4.387-4.301l-.01-.006C42.81.47 40.861 0 38.761 0H1.905C.866 0 .002.84 0 1.88V24h3.818V4.359h3.245v1.284c0 .132.161.196.252.1 2.987-3.275 9.077-2.319 11.216 1.723.725 1.234 1.092 2.759 1.092 4.534.102 4.584-3.017 8.265-7.55 8.235-2.031 0-3.629-.79-4.757-1.978a.146.146 0 0 0-.253.1V24h31.7c2.1 0 4.045-.468 5.78-1.39l.011-.005a10.795 10.795 0 0 0 4.394-4.302l.009-.016C49.98 16.483 50.5 14.368 50.5 12s-.52-4.482-1.543-6.285ZM30.112 7.42a24.93 24.93 0 0 1-.86-.003c-1.338-.02-2.845-.041-3.676.819-.549.54-.827 1.468-.827 2.759v8.809h-3.243V4.359h3.243v1.284c0 .148.194.202.271.077.314-.506.65-.852 1.012-1.05.616-.353 1.462-.532 2.514-.532h1.566V7.42Zm8.399 12.814c-4.77.033-8.068-3.395-7.973-8.235 0-1.716.348-3.21 1.033-4.442 2.714-5.062 11.157-5.068 13.852-.002.704 1.234 1.06 2.729 1.06 4.444.08 4.807-3.207 8.268-7.972 8.235Z",clipRule:"evenodd"}),l.jsx("path",{d:"M16.378 12c0 1.657-.442 3.153-1.314 4.075-1.583 1.816-5.26 1.798-6.857 0-1.706-1.753-1.722-6.381 0-8.121 1.597-1.836 5.27-1.855 6.854-.003.875.904 1.317 2.39 1.317 4.049Z"})]})}),t1=A.memo(function({isMax:t,className:n}){return t?l.jsx("div",{style:{"--mode-color":"oklch(var(--max-color))"},children:l.jsx(K0,{className:`text-max ${n||""}`})}):l.jsx("div",{style:{"--mode-color":"oklch(var(--super-color))"},children:l.jsx(Bj,{className:`text-super ${n||""}`})})});function Gd(e){if(e.exactCount!==void 0&&e.exactCount>=0&&e.exactCount<=10)return e.exactCount}const joe=A.memo(function(t){const{isFollowUp:n,value:r,onChange:s,buttonSize:a="small",variant:o="primaryGhost"}=t,i=Tu(),{$t:c}=Q(),u=On(),d=Po({openPaywallUpsell:u}),m=ns(),p=E0(),h=yr(),g=f.useMemo(()=>r!==void 0?h(r):m,[r,m,h]),{isMax:y,hasAccessToProFeatures:b}=Mt(),x=wt(),{gpt4Limit:_,pplxAlphaLimit:v,pplxBetaLimit:C}=En(),{specialCapabilities:w}=gr(),{preferredSearchModels:S,setPreferredSearchModel:E}=Ol(),{isMobileStyle:T}=Gf(),k=S0(),{isEnabled:M,isDisabledByOrg:N}=Mu(),{isMaxUpsellEnabled:P}=gS(),[O,L]=f.useState(()=>{const $=S[K.SEARCH];return w.unlimitedProSearch?!0:$===te.DEFAULT?!1:x});O&&!_.available&&!w.unlimitedProSearch&&L(!1);const{gateSearchModeSelection:H}=jo({openPaywallUpsell:u}),R=f.useCallback(()=>{H(te.BETA,!0)},[H]),I=f.useCallback($=>H($?te.PRO:te.DEFAULT)?(L(!1),E(K.SEARCH,te.DEFAULT),!1):(L($),E(K.SEARCH,$?te.PRO:te.DEFAULT),$),[E,H]),F=f.useCallback($=>{let q;switch($){case K.SEARCH:{O?q=S[$]??p($):q=te.DEFAULT;break}case K.RESEARCH:case K.STUDIO:{P?q=S[$]??p($):q=p($);break}case K.BROWSER_AGENT:{q=p($);break}default:{q=te.DEFAULT;break}}if(!k(q)){H(q);return}s?s(q):d(q)},[P,O,s,S,d,k,H,p]),G=f.useMemo(()=>{const $=Gd(_),q=Gd(v),U=Gd(C);function X(ne,ae){const de=ae?.disabled??!1;return{active:g===ne,description:c(Yn[ne].description),icon:gi(ne),onClick(){de||F(ne)},text:c(Yn[ne].name),type:"default",...ae}}const J=[];return J.push(X(K.SEARCH,{customDescriptionNode:b?void 0:l.jsxs(l.Fragment,{children:[l.jsx(B,{className:"whitespace-pre-wrap",variant:"tinyRegular",color:"light",children:l.jsx(be,{...Yn[K.SEARCH].description})}),l.jsxs("div",{className:"gap-md flex flex-col",children:[l.jsx("hr",{className:"border-subtler bg-subtler -mr-5 mt-3"}),l.jsxs("div",{className:"gap-sm -mr-5 flex items-start justify-between",children:[l.jsxs("div",{className:"gap-xs flex flex-col",children:[l.jsxs("div",{className:"gap-sm flex items-center",children:[l.jsx("button",{onClick:()=>{H(w.unlimitedProSearch?te.PRO:te.SONAR)},type:"button",children:l.jsx(B,{className:"font-medium underline",color:"super",variant:"tiny",children:l.jsx(be,{defaultMessage:"Try Pro Search",id:"akAejIEhqZ"})})}),l.jsx(t1,{isMax:y,className:"h-2.5"})]}),l.jsx(B,{className:"italic",color:"super",variant:"tinyRegular",children:l.jsx(be,{defaultMessage:"Advanced search with 10x the sources",id:"MZLTMODV37"})}),x&&$!==void 0&&!y&&l.jsx(B,{className:"mt-1 font-light",color:"super",variant:"tinyRegular",children:l.jsx(be,{defaultMessage:"{limit, plural, one {# query remaining today} other {# queries remaining today}}",id:"ooxxk0PKGd",values:{limit:$}})})]}),l.jsx(Poe,{isProSearchEnabled:O,selectSearchModel:d,selectedSearchMode:g,setIsProSearchEnabled:I})]})]})]}),customTextNode:l.jsx(B,{variant:"smallBold",children:l.jsx(be,{...Yn[K.SEARCH].name})})})),J.push(X(K.RESEARCH,{customTextNode:l.jsxs("div",{className:"gap-sm mt-px flex items-center",children:[l.jsx(B,{variant:"smallBold",children:l.jsx(be,{...Yn[K.RESEARCH].name})}),l.jsx(t1,{isMax:y||i(K.RESEARCH),className:"h-2.5"})]}),customDescriptionNode:l.jsxs("div",{className:"gap-xs flex flex-col",children:[l.jsx(B,{className:"whitespace-pre-wrap",variant:"tinyRegular",color:"light",children:l.jsx(be,{...Yn[K.RESEARCH].description})}),x&&q!==void 0&&!y&&l.jsxs("div",{children:[l.jsx(B,{color:"super",variant:"tinyRegular",children:l.jsx(be,{defaultMessage:"{limit, plural, one {# query remaining today} other {# queries remaining today}}",id:"ooxxk0PKGd",values:{limit:q}})}),i(K.RESEARCH)&&l.jsx(st,{onClick:R,variant:"common",size:"small",fullWidth:!0,extraCSS:"mt-sm",text:c({defaultMessage:"Upgrade to Max",id:"z+PtTMgM3T"})})]})]})})),J.push(X(K.STUDIO,{customTextNode:l.jsxs("div",{className:"gap-sm mt-px flex items-center",children:[l.jsx(B,{variant:"smallBold",children:l.jsx(be,{...Yn[K.STUDIO].name})}),l.jsx(t1,{isMax:y||i(K.STUDIO),className:"h-2.5"})]}),customDescriptionNode:l.jsxs("div",{className:"gap-xs flex flex-col",children:[l.jsx(B,{className:"whitespace-pre-wrap",variant:"tinyRegular",color:"light",children:l.jsx(be,{...Yn[K.STUDIO].description})}),x&&U!==void 0&&!y&&l.jsxs("div",{children:[l.jsx(B,{color:"max",variant:"tinyRegular",children:l.jsx(be,{defaultMessage:"{limit, plural, one {# query remaining this month} other {# queries remaining this month}}",id:"wlPH+sOjjI",values:{limit:U}})}),i(K.STUDIO)&&l.jsx(st,{onClick:R,variant:"common",size:"small",fullWidth:!0,extraCSS:"mt-sm",text:c({defaultMessage:"Upgrade to Max",id:"z+PtTMgM3T"})})]})]})})),M&&J.push(X(K.BROWSER_AGENT,{disabled:N,...N&&{customDescriptionNode:l.jsxs("div",{className:"gap-xs flex flex-col",children:[l.jsx(B,{variant:"tinyRegular",color:"light",children:l.jsx(be,{...Yn[K.BROWSER_AGENT].description})}),l.jsx(B,{variant:"tinyRegular",color:"light",children:l.jsx(be,{defaultMessage:"Disabled by your organization",id:"cBE0Jgy5fu"})})]})}})),J},[b,y,x,_,O,d,g,I,v,i,R,c,C,F,H,w.unlimitedProSearch,M,N]),j=f.useMemo(()=>l.jsx(ye,{icon:D("chevron-down"),size:"xs",className:z("-mx-xs -mb-two opacity-50",{"-ml-sm":n})}),[n]);return l.jsx(bu,{isMobileStyle:T??!1,items:G,placement:"bottom-start",children:l.jsx(st,{icon:gi(g),size:a,text:n?l.jsx(l.Fragment,{children:""}):c(Yn[g].name),variant:o,trailingComponent:j})})}),Poe=A.memo(function({isProSearchEnabled:t,selectSearchModel:n,selectedSearchMode:r,setIsProSearchEnabled:s}){const{$t:a}=Q(),o=f.useCallback(c=>{s(c)&&r===K.SEARCH&&n(c?te.PRO:te.DEFAULT)},[n,r,s]),i=f.useMemo(()=>({onClick(c){c.stopPropagation()}}),[]);return l.jsx(AN,{checked:t,onCheckedChange:o,"aria-label":a({defaultMessage:"Enable Pro Search",id:"4oWk17uURl"}),...i})}),Hj={[K.SEARCH]:te.DEFAULT,[K.RESEARCH]:te.ALPHA,[K.STUDIO]:te.BETA,[K.STUDY]:te.DEFAULT,[K.AGENTIC_RESEARCH]:te.AGENTIC_RESEARCH,[K.BROWSER_AGENT]:te.BROWSER_AGENT,[K.ASI]:te.ASI},sm=A.memo(function(t){const{children:n,className:r,searchMode:s,...a}=t,o=On(),{gateSearchModeSelection:i}=jo({openPaywallUpsell:o});return l.jsx("button",{className:z("group",r),onClick:()=>{i(Hj[s],!0)},type:"button",...a,children:l.jsx(B,{className:"!text-[var(--mode-color)] underline decoration-transparent transition-[text-decoration-color] group-hover:decoration-[var(--mode-color)]",variant:"smallBold",children:n})})}),am=A.memo(function(t){const{badgeNode:n,color:r,enabledText:s,isEnabled:a,upgradeButton:o,isMaxUpsell:i=!1}=t;return l.jsxs("div",{className:"gap-sm flex items-center",style:{"--mode-color":r==="super"?"oklch(var(--super-color))":"oklch(var(--max-color))"},children:[n,a?l.jsxs("div",{className:"gap-xs flex items-center",children:[l.jsx(B,{className:"!text-[var(--mode-color)]",variant:"smallBold",children:s}),!i&&l.jsx(ut,{name:D("check"),className:"text-[var(--mode-color)]",size:18})]}):l.jsx(l.Fragment,{children:o})]})}),Ooe=A.memo(function(t){const{searchMode:n}=t,{$t:r}=Q(),s=wt(),{hasAccessToProFeatures:a}=Mt(),o=On(),{gateSearchModeSelection:i}=jo({openPaywallUpsell:o}),c=Tu(),{specialCapabilities:u}=gr(),d=f.useCallback(()=>{i(Hj[n],!0)},[i,n]);return c(n)?l.jsx(st,{onClick:d,variant:"maxGold",size:"small",fullWidth:!0,text:r({defaultMessage:"Upgrade to Max",id:"z+PtTMgM3T"})}):u.unlimitedProSearch||u.unlimitedResearch||s&&a||n===K.STUDY?null:l.jsx(st,{onClick:d,variant:"primary",size:"small",fullWidth:!0,testId:"upgrade-to-pro-button",text:s?l.jsx(be,{defaultMessage:"Upgrade to Pro",id:"5N04mo7WNC"}):l.jsx(be,{defaultMessage:"Sign in for access",id:"w6mjA9GP58"})})}),Nu=A.memo(function(t){const{footerNode:n,includeNewBadge:r,searchMode:s}=t,{$t:a}=Q(),o=Xw(s),i=o?a(o):void 0;return l.jsxs("div",{className:"p-md flex flex-col gap-4",children:[l.jsxs("div",{className:"gap-xs flex flex-col",children:[l.jsxs("div",{className:"relative",children:[l.jsx(B,{className:"text-box-trim-both",variant:"smallExtraBold",children:a(Yn[s].name)}),r&&l.jsx(Y,{className:"absolute -right-1 -top-1 rounded-md px-2 py-1",variant:"subtle",children:l.jsx(B,{variant:"tiny",children:l.jsx(be,{defaultMessage:"New",id:"bW7B87wFFp"})})})]}),i&&l.jsx(B,{variant:"tiny",color:"light",children:i}),l.jsx(B,{variant:"small",className:"text-pretty",children:a(Yn[s].description)})]}),l.jsx("hr",{className:"border-subtler bg-subtler"}),l.jsx("div",{className:"gap-xs flex flex-col",children:n}),l.jsx(Ooe,{searchMode:s})]})}),XS=A.memo(function({isMaxUpsell:t=!1}){const{isMax:n,isPro:r}=Mt();return n||t?l.jsx(K0,{className:"text-max h-3"}):r?l.jsx(Bj,{className:"text-super h-3"}):null}),ZS=({isMax:e,isPro:t,isMaxUpsell:n=!1})=>e||n?"max":"super",Loe=A.memo(function(t){const{isToggleActive:n,onToggleChange:r}=t,{$t:s}=Q(),a=wt(),{hasAccessToProFeatures:o,isMax:i,isPro:c}=Mt(),{gpt4Limit:u}=En(),{specialCapabilities:d,isGovernmentRequestOrigin:m}=gr(),p=(()=>{if(!a&&!d.unlimitedProSearch)return null;if(o||d.unlimitedProSearch)return m?l.jsx(be,{defaultMessage:"Unlimited access for government",id:"0JftsQv9MC"}):l.jsx(be,{defaultMessage:"Extended access for subscribers",id:"ATGyCTI4+V"});const _=Gd(u);return _!==void 0?l.jsx(be,{defaultMessage:"{limit, plural, one {# query remaining today} other {# queries remaining today}}",id:"ooxxk0PKGd",values:{limit:_}}):null})(),h=f.useMemo(()=>l.jsx(XS,{}),[]),g=f.useMemo(()=>({onClick(_){_.stopPropagation()}}),[]),y=f.useMemo(()=>l.jsx(sm,{searchMode:K.SEARCH,children:l.jsx(be,{defaultMessage:"Try Pro Search",id:"akAejIEhqZ"})}),[]),b=f.useMemo(()=>l.jsx(be,{defaultMessage:"Enabled",id:"V52jNnY+6M"}),[]),x=f.useMemo(()=>l.jsxs("div",{className:"flex",children:[l.jsxs("div",{className:"gap-xs flex w-full flex-col",children:[l.jsx(am,{badgeNode:h,color:ZS({isMax:i,isPro:c}),enabledText:b,isEnabled:o||d.unlimitedProSearch,upgradeButton:y}),l.jsx(B,{color:"default",variant:"small",className:"text-pretty",children:l.jsx(be,{defaultMessage:"Advanced search with 10x the sources; powered by top models",id:"IKFeqUH+w0"})}),p&&l.jsx(B,{color:"default",variant:"small",className:"mt-xs opacity-60",children:p})]}),!o&&!d.unlimitedProSearch&&r&&l.jsx(AN,{checked:n,onCheckedChange:r,"aria-label":s({defaultMessage:"Enable Pro Search",id:"4oWk17uURl"}),...g})]}),[h,i,c,b,o,d.unlimitedProSearch,y,p,r,n,s,g]);return l.jsx(Nu,{footerNode:x,searchMode:K.SEARCH})}),Foe=A.memo(function(){const t=wt(),{hasAccessToProFeatures:n,isMax:r,isPro:s}=Mt(),{gpt4Limit:a,pplxAlphaLimit:o}=En(),{specialCapabilities:i,isGovernmentRequestOrigin:c}=gr(),u=Tu(),d=u(K.RESEARCH),m=(()=>{if(!t&&!i.unlimitedResearch)return null;const b=a.exactCount!==void 0&&o.exactCount!==void 0?Math.min(a.exactCount,o.exactCount):void 0;if(b!==void 0&&b<0||u(K.RESEARCH))return null;if(i.unlimitedResearch&&c)return l.jsx(be,{defaultMessage:"Unlimited access for government",id:"0JftsQv9MC"});if(r)return l.jsx(be,{defaultMessage:"Extended access for subscribers",id:"ATGyCTI4+V"});const x=Gd(o);return x!==void 0?x===0?l.jsx(be,{defaultMessage:"Upgrade to get access",id:"eRbSgHbjUP"}):l.jsx(be,{defaultMessage:"{limit, plural, one {# query remaining this month} other {# queries remaining this month}}",id:"wlPH+sOjjI",values:{limit:x}}):l.jsx(be,{defaultMessage:"Extended access for subscribers",id:"ATGyCTI4+V"})})(),p=f.useMemo(()=>l.jsx(XS,{isMaxUpsell:d}),[d]),h=f.useMemo(()=>d?l.jsx(be,{defaultMessage:"Increased access with Max",id:"fWFqC/rIjD"}):l.jsx(be,{defaultMessage:"Enabled",id:"V52jNnY+6M"}),[d]),g=f.useMemo(()=>l.jsx(sm,{searchMode:K.RESEARCH,children:t?d?l.jsx(be,{defaultMessage:"Increased access with Max",id:"fWFqC/rIjD"}):l.jsx(be,{defaultMessage:"Extended access for subscribers",id:"ATGyCTI4+V"}):l.jsx(be,{defaultMessage:"Get more queries with Pro",id:"BZEuCK3Abs"})}),[t,d]),y=f.useMemo(()=>l.jsxs("div",{className:"gap-xs flex flex-col",children:[l.jsx(am,{badgeNode:p,color:ZS({isMax:r,isPro:s,isMaxUpsell:d}),enabledText:h,isEnabled:n||i.unlimitedResearch,upgradeButton:g,isMaxUpsell:d}),m&&l.jsx(B,{color:"default",variant:"small",className:"mt-xs opacity-60",children:m})]}),[p,h,n,r,s,d,m,g,i.unlimitedResearch]);return l.jsx(Nu,{footerNode:y,searchMode:K.RESEARCH})}),Uoe=A.memo(function(){const t=wt(),{hasAccessToProFeatures:n,isMax:r,isPro:s}=Mt(),{pplxBetaLimit:a}=En(),o=Tu(),i=o(K.STUDIO),c=t?n?!a.available||o(K.STUDIO)?null:r?l.jsx(be,{defaultMessage:"Extended access for subscribers",id:"ATGyCTI4+V"}):a.exactCount?l.jsx(be,{defaultMessage:"{limit, plural, one {# query remaining this month} other {# queries remaining this month}}",id:"wlPH+sOjjI",values:{limit:a.exactCount}}):null:l.jsx(be,{defaultMessage:"Upgrade to get access",id:"eRbSgHbjUP"}):null,u=f.useMemo(()=>l.jsx(XS,{isMaxUpsell:i}),[i]),d=f.useMemo(()=>i?l.jsx(be,{defaultMessage:"Increased access with Max",id:"fWFqC/rIjD"}):l.jsx(be,{defaultMessage:"Enabled",id:"V52jNnY+6M"}),[i]),m=f.useMemo(()=>l.jsx(sm,{searchMode:K.STUDIO,children:t?i?l.jsx(be,{defaultMessage:"Increased access with Max",id:"fWFqC/rIjD"}):l.jsx(be,{defaultMessage:"Access for subscribers only",id:"Ez3b/pzas/"}):l.jsx(be,{defaultMessage:"Get more queries with Pro",id:"BZEuCK3Abs"})}),[t,i]),p=f.useMemo(()=>l.jsxs("div",{className:"gap-xs flex flex-col",children:[l.jsx(am,{badgeNode:u,color:ZS({isMax:r,isPro:s,isMaxUpsell:i}),enabledText:d,isEnabled:n,upgradeButton:m,isMaxUpsell:i}),c&&l.jsx(B,{color:"default",variant:"small",className:"mt-xs opacity-60",children:c})]}),[u,d,n,r,s,i,c,m]);return l.jsx(Nu,{footerNode:p,searchMode:K.STUDIO})}),Boe=A.memo(function(){const t=A.useMemo(()=>l.jsx("div",{children:l.jsx(B,{color:"default",variant:"small",className:"text-pretty",children:l.jsx(be,{defaultMessage:"Interactive learning and study tools that guide you toward deeper understanding beyond quick answers. ",id:"ZRKKxSc+oV"})})}),[]);return l.jsx(Nu,{footerNode:t,searchMode:K.STUDY,includeNewBadge:!0})}),Hoe=A.memo(function(){const{isMax:t}=Mt(),{pplxAlphaLimit:n}=En(),{specialCapabilities:r,isGovernmentRequestOrigin:s}=gr(),a=n.exactCount!==void 0&&n.exactCount<=0,o=r.unlimitedResearch&&s?l.jsx(be,{defaultMessage:"Unlimited access for government",id:"0JftsQv9MC"}):t&&a?l.jsx(be,{defaultMessage:"Monthly limit reached",id:"+Loj2jcipA"}):null,i=f.useMemo(()=>l.jsx(K0,{className:"text-max h-3"}),[]),c=f.useMemo(()=>l.jsx(be,{defaultMessage:"Enabled",id:"V52jNnY+6M"}),[]),u=f.useMemo(()=>l.jsx(sm,{searchMode:K.AGENTIC_RESEARCH,children:l.jsx(be,{defaultMessage:"Upgrade to Max",id:"z+PtTMgM3T"})}),[]),d=f.useMemo(()=>l.jsxs("div",{className:"gap-xs flex flex-col",children:[l.jsx(am,{badgeNode:i,color:"max",enabledText:c,isEnabled:t&&!a,upgradeButton:u,isMaxUpsell:!1}),o&&l.jsx(B,{color:"default",variant:"small",className:"mt-xs opacity-60",children:o})]}),[i,c,t,a,o,u]);return l.jsx(Nu,{footerNode:d,searchMode:K.AGENTIC_RESEARCH})}),Voe=A.memo(function(){const{isMax:t}=Mt(),{pplxAlphaLimit:n}=En(),{specialCapabilities:r,isGovernmentRequestOrigin:s}=gr(),a=n.exactCount!==void 0&&n.exactCount<=0,o=r.unlimitedResearch&&s?l.jsx(be,{defaultMessage:"Unlimited access for government",id:"0JftsQv9MC"}):t&&a?l.jsx(be,{defaultMessage:"Monthly limit reached",id:"+Loj2jcipA"}):null,i=f.useMemo(()=>l.jsx(K0,{className:"text-max h-3"}),[]),c=f.useMemo(()=>l.jsx(be,{defaultMessage:"Enabled",id:"V52jNnY+6M"}),[]),u=f.useMemo(()=>l.jsx(sm,{searchMode:K.ASI,children:l.jsx(be,{defaultMessage:"Upgrade to Max",id:"z+PtTMgM3T"})}),[]),d=f.useMemo(()=>l.jsxs("div",{className:"gap-xs flex flex-col",children:[l.jsx(am,{badgeNode:i,color:"max",enabledText:c,isEnabled:t&&!a,upgradeButton:u,isMaxUpsell:!1}),o&&l.jsx(B,{color:"default",variant:"small",className:"mt-xs opacity-60",children:o})]}),[i,c,t,a,o,u]);return l.jsx(Nu,{footerNode:d,searchMode:K.ASI})}),Goe=(e,t)=>{const{value:n,loading:r}=Nl({flag:"model-outage-on-model-selector-ui",defaultValue:e,extraAttributes:t,subjectType:"visitor_id"});return f.useMemo(()=>({variation:n,loading:r}),[n,r])},Vj=({reason:e})=>{const{organization:t}=Hs({reason:e});return f.useMemo(()=>({disabledModelPreferences:t?.settings?.disabled_model_preferences??_e}),[t?.settings?.disabled_model_preferences])},qo=Me({reasoning:{defaultMessage:"Reasoning",id:"Aw3qRf7hyO"},max:{defaultMessage:"max",id:"+LmzMnWE+j"},new:{defaultMessage:"new",id:"qlTe+eC7Ec"},maxModelsReachedHint:{defaultMessage:"Deselect one to choose another",id:"U5m8ADOHh3"},minModelsRequiredHint:{defaultMessage:"Select at least 2 models",id:"+xl3KZAib0"},selectUpToMaxHint:{defaultMessage:"Select up to 3 models",id:"M/oFvZaWnA"}}),zoe=V({defaultMessage:"Temporary degraded performance",id:"Kc/pdbXoxJ"}),qoe=V({defaultMessage:"{modelName} is a text only model. Remove image attachments to use this model.",id:"8Z6XFIwTW6"}),$oe=e=>{const{label:t,subheading:n,nonReasoningModel:r,reasoningModel:s,selected:a,variant:o,badgeText:i,notice:c,onChange:u,tooltipText:d,disabled:m,providerIcon:p}=e,{$t:h}=Q(),g=f.useCallback(()=>{if(m)return;const E=r??s;if(!E){pi.error("ModelMenuItem: No model to select",{searchModel:r,reasoningModel:s});return}u(E)},[u,r,s,m]),y=f.useCallback(()=>{!s||!r||u(s===a?r:s)},[u,s,r,a]),b=!r,x=a===r||a===s,_=h({defaultMessage:"Model does not have a fast model and reasoning will be used",id:"yeyas85Pgq"}),v=b?_:void 0,C=h({defaultMessage:"{modelName} does not support images. Remove image attachments to use this model.",id:"SQsP6RyVGS"},{modelName:t}),w=m?C:d,S=o==="max"?l.jsx(xi,{variant:"max",size:"md-large"}):void 0;return l.jsxs(Y,{variant:x?"subtler":void 0,className:"rounded-lg",children:[l.jsx(NN,{text:t,description:n,role:"menuitem",active:x,activeColor:o,badge:o==="max"?void 0:i,badgeVariant:o==="max"?void 0:"superBorder",textTrailingElement:S,onClick:g,tooltipText:w,disabled:m,icon:p??void 0}),x&&c&&l.jsx(B,{className:"max-w-44 px-2 py-1 text-left",variant:"tinyRegular",color:"red",children:c}),x&&s&&l.jsx(RN,{selected:a===s,text:h({defaultMessage:"Thinking",id:"AHQWDTo4+e"}),role:"menuitem",active:a===s,activeColor:o,onClick:y,disabled:b,tooltipText:v,switchVariant:o})]})},Woe=e=>{const{label:t,subheading:n,nonReasoningModel:r,reasoningModel:s,compareModels:a,onCompareModelsChange:o,variant:i,notice:c,tooltipText:u,disabled:d,providerIcon:m,maxModelsReached:p,isMaxTier:h}=e,{$t:g}=Q(),y=a.find(O=>O===r||O===s),b=!!y,x=y===s,_=!!s,v=!!s&&!!r,C=f.useCallback(()=>{if(!d)if(b)o(a.filter(O=>O!==r&&O!==s));else{if(p)return;const O=s??r;O&&o([...a,O])}},[d,b,p,a,r,s,o]),w=f.useCallback(()=>{if(!s||!r||!b)return;const O=a.map(L=>L===s?r:L===r?s:L);o(O)},[a,s,r,o,b]),S=g({defaultMessage:"{modelName} does not support images. Remove image attachments to use this model.",id:"SQsP6RyVGS"},{modelName:t}),E=d?S:u,T=d||!b&&p,k=!r,M=g({defaultMessage:"Model does not have a fast model and reasoning will be used",id:"yeyas85Pgq"}),N=k?M:void 0,P=h?l.jsx(xi,{variant:"max",size:"md-large"}):void 0;return l.jsxs(Y,{variant:b?"subtler":void 0,className:"rounded-lg",children:[l.jsx(NN,{text:t,description:n,role:"menuitemcheckbox",active:b,activeColor:i,textTrailingElement:P,onClick:C,tooltipText:E,disabled:T,icon:m??void 0}),b&&c&&l.jsx(B,{className:"max-w-44 px-2 py-1 text-left",variant:"tinyRegular",color:"red",children:c}),b&&_&&l.jsx(RN,{selected:x,text:g({defaultMessage:"Thinking",id:"AHQWDTo4+e"}),role:"menuitem",active:x,activeColor:i,onClick:v?w:void 0,disabled:k,tooltipText:N,switchVariant:i})]})},Koe=[te.GPT_5_2_THINKING,te.CLAUDE_4_5_OPUS_THINKING,te.GEMINI_3_0_PRO],Yoe=[te.GPT_5_2_THINKING,te.CLAUDE_4_6_OPUS_THINKING,te.GEMINI_3_0_PRO],Gj=()=>{const{variation:e}=zR(!1);return e?Yoe:Koe},zj=({currentModel:e,onModelSelect:t,origin:n,disableTextOnlyModels:r=!1,compareModels:s=_e,onCompareModelsChange:a,openPaywallUpsell:o,searchMode:i=K.SEARCH})=>{const c="use-model-menu-items-with-reasoning",{$t:u}=Q(),{isMax:d,isPro:m,hasAccessToProFeatures:p}=Mt(),{disabledModelPreferences:h}=Vj({reason:c}),{isMaxUpsellEnabled:g}=gS(),{specialCapabilities:y}=gr(),b=wt(),{openVisitorLoginUpsell:x}=ws({enabled:!b}),_=f.useRef(null),{models:v,getModelConfig:C}=Wf(),{modelSpecificLimits:w}=En(),{variation:S}=Goe({}),E=i===K.AGENTIC_RESEARCH,T=y.maxModelSelection||g||d,k=f.useCallback(I=>{_.current=I,t(I)},[t]),M=f.useCallback(I=>I&&h.includes(I),[h]),N=f.useCallback(I=>df(I)||C(I)!==void 0,[C]),P=f.useMemo(()=>({type:"custom",text:u(dn[te.PRO].name),children:l.jsx(Md,{type:"default",size:"small",text:u(dn[te.PRO].name),tooltipText:u(dn[te.PRO].description),active:df(e),onClick:()=>{k(te.PRO)}})}),[e,k,u]),O=f.useMemo(()=>{const I=u({defaultMessage:"Upgrade for best models",id:"sy/65ilMNl"}),F=u({defaultMessage:"Get access to premium models by upgrading your subscription.",id:"20F8GxfYaR"});return{type:"custom",text:I,children:l.jsx(Md,{type:"default",size:"small",text:I,tooltipText:F,onClick:()=>{if(!b){const G=new URL(window.location.href);G.searchParams.set("upsell","models"),x({title:u({defaultMessage:"Sign in to choose a model",id:"BhbQUiYsTB"}),description:u({defaultMessage:"Access the latest AI models from Perplexity, OpenAI, Anthropic (Claude), Google Gemini and more",id:"DDVABeGeBG"}),origin:Ke.MODEL_SELECTOR,overrideRedirectUrl:G.toString()});return}o({pitchMessage:{title:u({defaultMessage:"Upgrade to choose a model",id:"BhzpKf2MS5"}),description:u({defaultMessage:"With Perplexity Pro, you get access to all the latest AI models in one subscription",id:"gqUZUJex7f"})},origin:n??Ke.MODEL_SELECTOR})}})}},[u,b,x,o,n]),L=p?P:O,H=i!==K.BROWSER_AGENT&&i!==K.AGENTIC_RESEARCH,R=f.useMemo(()=>{const I={type:"separator",show:!0},F=v.map(U=>U.nonReasoningModel??U.reasoningModel).filter(U=>U!=null),G=KR(i,F),$=v.filter(U=>{const X=U.nonReasoningModel??U.reasoningModel;return!(X&&!G.includes(X)||!T&&U.subscriptionTier===zn.MAX)}).map(U=>{const{nonReasoningModel:X,reasoningModel:J}=U;if(!X&&!J)return null;const ne=!!(X&&S[X]||J&&S[J]),ae=M(X)||M(J),de=ne?u(zoe):void 0,oe=r&&U.textOnlyModel===!0,le=oe?u(qoe,{modelName:u(U.label)}):u(U.description),se=()=>{if(ae)return u({defaultMessage:"Disabled by your organization",id:"cBE0Jgy5fu"});if(U.subheading)return u(U.subheading);if(m&&U.subscriptionTier===zn.MAX&&[U.nonReasoningModel,U.reasoningModel].filter(Oe=>Oe!==null).some(Oe=>(w?.[Oe]??0)>0))return u({defaultMessage:"Trial access with Pro plan",id:"52XybSYuLP"})},re=U.subscriptionTier===zn.MAX,he=re?"max":"super",ie=re?qo.max:U.hasNewTag?qo.new:void 0,ue=X??J,ce=ue?Qw(ue):null,me=ae||oe;return E&&a?{type:"custom",text:u(U.label),children:l.jsx(Woe,{label:u(U.label),subheading:se(),compareModels:s,onCompareModelsChange:a,nonReasoningModel:X,reasoningModel:J,notice:de,variant:he,tooltipText:le,disabled:me,providerIcon:ce,maxModelsReached:s.length>=B2,isMaxTier:re})}:{type:"custom",text:u(U.label),children:l.jsx($oe,{label:u(U.label),subheading:se(),selected:e,nonReasoningModel:X,reasoningModel:J,notice:de,variant:he,badgeText:ie?u(ie):void 0,onChange:k,tooltipText:le,disabled:me,providerIcon:ce})}}).filter(U=>U!==null);if(n===Ke.RETRY_BUTTON){const U={type:"custom",text:u(Ia(K.RESEARCH)),children:l.jsx(Md,{type:"default",size:"small",icon:D("telescope"),text:u(Ia(K.RESEARCH)),active:e===te.ALPHA,onClick:()=>k(te.ALPHA)})},X={type:"custom",text:u(Ia(K.STUDIO)),children:l.jsx(Md,{type:"default",size:"small",text:u(Ia(K.STUDIO)),icon:D("table-plus"),active:e===te.BETA,onClick:()=>k(te.BETA)})};return[U,X,...H?[I,L]:[],...$]}const q=[];if(H&&q.push(L),q.push(I),E){if(s.length<2){const U={type:"custom",text:u(qo.minModelsRequiredHint),children:l.jsx("div",{className:"px-3 py-2 text-xs text-quiet",children:u(qo.minModelsRequiredHint)})};q.push(U)}else if(s.length===2){const U={type:"custom",text:u(qo.selectUpToMaxHint),children:l.jsx("div",{className:"px-3 py-2 text-xs text-quiet",children:u(qo.selectUpToMaxHint)})};q.push(U)}else if(s.length>=B2){const U={type:"custom",text:u(qo.maxModelsReachedHint),children:l.jsx("div",{className:"px-3 py-2 text-xs text-quiet",children:u(qo.maxModelsReachedHint)})};q.push(U)}}return q.push(...$),q},[u,n,e,T,M,S,k,v,L,E,s,a,r,m,w,H,i]);return f.useMemo(()=>({menuItems:R,isSupportedModel:N}),[R,N])};var JS="Radio",[Qoe,qj]=pu(JS),[Xoe,Zoe]=Qoe(JS),$j=f.forwardRef((e,t)=>{const{__scopeRadio:n,name:r,checked:s=!1,required:a,disabled:o,value:i="on",onCheck:c,form:u,...d}=e,[m,p]=f.useState(null),h=gu(t,b=>p(b)),g=f.useRef(!1),y=m?u||!!m.closest("form"):!0;return l.jsxs(Xoe,{scope:n,checked:s,disabled:o,children:[l.jsx(Hn.button,{type:"button",role:"radio","aria-checked":s,"data-state":Qj(s),"data-disabled":o?"":void 0,disabled:o,value:i,...d,ref:h,onClick:qn(e.onClick,b=>{s||c?.(),y&&(g.current=b.isPropagationStopped(),g.current||b.stopPropagation())})}),y&&l.jsx(Yj,{control:m,bubbles:!g.current,name:r,value:i,checked:s,required:a,disabled:o,form:u,style:{transform:"translateX(-100%)"}})]})});$j.displayName=JS;var Wj="RadioIndicator",Kj=f.forwardRef((e,t)=>{const{__scopeRadio:n,forceMount:r,...s}=e,a=Zoe(Wj,n);return l.jsx(hu,{present:r||a.checked,children:l.jsx(Hn.span,{"data-state":Qj(a.checked),"data-disabled":a.disabled?"":void 0,...s,ref:t})})});Kj.displayName=Wj;var Joe="RadioBubbleInput",Yj=f.forwardRef(({__scopeRadio:e,control:t,checked:n,bubbles:r=!0,...s},a)=>{const o=f.useRef(null),i=gu(o,a),c=J$(n),u=C$(t);return f.useEffect(()=>{const d=o.current;if(!d)return;const m=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(m,"checked").set;if(c!==n&&h){const g=new Event("click",{bubbles:r});h.call(d,n),d.dispatchEvent(g)}},[c,n,r]),l.jsx(Hn.input,{type:"radio","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:i,style:{...s.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Yj.displayName=Joe;function Qj(e){return e?"checked":"unchecked"}var eie=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Y0="RadioGroup",[tie]=pu(Y0,[xu,qj]),Xj=xu(),Zj=qj(),[nie,rie]=tie(Y0),Jj=f.forwardRef((e,t)=>{const{__scopeRadioGroup:n,name:r,defaultValue:s,value:a,required:o=!1,disabled:i=!1,orientation:c,dir:u,loop:d=!0,onValueChange:m,...p}=e,h=Xj(n),g=qC(u),[y,b]=Ml({prop:a,defaultProp:s??null,onChange:m,caller:Y0});return l.jsx(nie,{scope:n,name:r,required:o,disabled:i,value:y,onValueChange:b,children:l.jsx(WC,{asChild:!0,...h,orientation:c,dir:g,loop:d,children:l.jsx(Hn.div,{role:"radiogroup","aria-required":o,"aria-orientation":c,"data-disabled":i?"":void 0,dir:g,...p,ref:t})})})});Jj.displayName=Y0;var eP="RadioGroupItem",tP=f.forwardRef((e,t)=>{const{__scopeRadioGroup:n,disabled:r,...s}=e,a=rie(eP,n),o=a.disabled||r,i=Xj(n),c=Zj(n),u=f.useRef(null),d=gu(t,u),m=a.value===s.value,p=f.useRef(!1);return f.useEffect(()=>{const h=y=>{eie.includes(y.key)&&(p.current=!0)},g=()=>p.current=!1;return document.addEventListener("keydown",h),document.addEventListener("keyup",g),()=>{document.removeEventListener("keydown",h),document.removeEventListener("keyup",g)}},[]),l.jsx($C,{asChild:!0,...i,focusable:!o,active:m,children:l.jsx($j,{disabled:o,required:a.required,checked:m,...c,...s,name:a.name,ref:d,onCheck:()=>a.onValueChange(s.value),onKeyDown:qn(h=>{h.key==="Enter"&&h.preventDefault()}),onFocus:qn(s.onFocus,()=>{p.current&&u.current?.click()})})})});tP.displayName=eP;var sie="RadioGroupIndicator",aie=f.forwardRef((e,t)=>{const{__scopeRadioGroup:n,...r}=e,s=Zj(n);return l.jsx(Kj,{...s,...r,ref:t})});aie.displayName=sie;const oie=e=>{const t=_s(e);if(!t)return 0;const n=parseInt(t);return isNaN(n)?1:n},O4=(e,t,n)=>{Ci(e,t.toString(),{expires:n??365})},nP=({cueKey:e,impressionsLimit:t,enabled:n,expiresInDays:r})=>{const[s,a]=f.useState(!1),[o,i]=f.useState(0);f.useEffect(()=>{if(!n){a(!1);return}const u=oie(e);i(u),u<t&&(a(!0),O4(e,u+1,r),i(u+1))},[e,t,n,r]);const c=f.useCallback(()=>{O4(e,t,r),i(t),a(!1)},[e,t,r]);return f.useMemo(()=>({shouldShow:s,currentCount:o,setReachedImpressions:c}),[s,o,c])},eE=A.memo(function({cueKey:t,title:n,children:r,enabled:s,impressionsLimit:a=1,side:o="bottom",align:i="center",sideOffset:c=4,visibilityMargins:u={topPx:0,rightPx:0,bottomPx:0,leftPx:0},visibilityThreshold:d=.5}){const[m,p]=f.useState(!1),{shouldShow:h}=nP({cueKey:t,impressionsLimit:a,enabled:s}),g=f.useMemo(()=>{const w=-(u.topPx??0),S=-(u.rightPx??0),E=-(u.bottomPx??0),T=-(u.leftPx??0);return`${w}px ${S}px ${E}px ${T}px`},[u]),{ref:y,isIntersecting:b,current:x}=aN({options:{threshold:d,rootMargin:g}}),v=s&&(h&&!m&&b),C=f.useCallback(()=>{p(!0)},[]);return n?l.jsx("div",{onClick:C,ref:y,children:l.jsx(wn,{content:n,side:o,align:i,open:v,onOpenChange:jr,offsetPx:c,shouldShowArrow:!0,delayDurationMs:0,portalTargetElement:x,children:r})}):r}),rP=A.memo(function(t){const{className:n="",layoutKey:r="",options:s,value:a,backgroundClassName:o="",radioGroupIndicatorClassName:i="",variant:c="default",areCuesEnabled:u=!1,...d}=t,[m,p]=f.useState(null),[h,g]=f.useState(!1),y=A.useRef(new Map),b=A.useRef(null),x=f.useCallback(E=>T=>{T?y.current.set(E,T):y.current.delete(E)},[]);f.useLayoutEffect(()=>{if(!a||!b.current)return;const E=y.current.get(a);if(!E)return;const T=b.current.getBoundingClientRect(),k=E.getBoundingClientRect(),M=k.left-T.left;p({transform:`translateX(${M}px)`,width:k.width}),h||requestAnimationFrame(()=>g(!0))},[a,s,h]);const _=(()=>{switch(c){case"subtle":return"";case"default":return"bg-white dark:bg-black dark:bg-gradient-to-b dark:from-super/20 dark:to-super/20";default:St(c)}})(),{$t:v}=Q(),C=f.useMemo(()=>({study:v({defaultMessage:"Help me learn",id:"buCzR6meM4"})}),[v]),w=f.useMemo(()=>s.map(E=>{const T=l.jsx(tP,{...E.elementProps,ref:x(E.value),"aria-label":E.label,disabled:E.disabled??void 0,className:"segmented-control group/segmented-control relative focus:outline-none",value:E.value,children:E.children}),k=C[E.value];return k?l.jsx(eE,{cueKey:`segmented-control-${E.value}`,enabled:u,side:"top",title:k,children:T},E.value):l.jsx(A.Fragment,{children:T},E.value)}),[s,C,u,x]),S=(()=>{switch(c){case"subtle":return"bg-subtle";case"default":return"bg-super/10 dark:bg-black/[0.18]";default:St(c)}})();return l.jsxs(Jj,{...d,className:z("group relative isolate flex h-fit",n),value:a,children:[l.jsx("div",{className:z("absolute inset-0",S,"dark:border dark:border-black/[0.04]","rounded-[10px]","transition-colors duration-300",o)}),l.jsx("div",{className:"p-two flex shrink-0",children:l.jsxs("div",{ref:b,className:"relative flex shrink-0 items-center",children:[m&&l.jsx("div",{className:z("pointer-events-none absolute inset-y-0 z-0",_,"border-super dark:border-super/30 border","rounded-lg","shadow-super/30 dark:shadow-super/5 shadow-[0_1px_3px_0]","dark:text-super",h&&"transition-all duration-100 ease-out",i),style:{transform:m.transform,width:m.width}}),w]})})]})}),sP=A.memo(function(t){const{className:n="",isActiveOption:r,icon:s,label:a,activeColor:o="text-super"}=t,i=z("transition-colors duration-300",{[o]:r,"text-quiet group-hover/segmented-control:text-foreground":!r});return l.jsxs("div",{className:z("relative z-10 flex h-8 min-w-9 items-center justify-center",{"py-xs gap-xs px-2.5":r||a},n),children:[s&&l.jsx(eW,{buttonSize:"small",icon:s,iconClassName:z(i),showClicked:!1}),a&&l.jsx("div",{className:z("px-two font-sans text-sm leading-[1.125rem]",i),children:a})]})}),iie=A.memo(function(t){const{isFollowUp:n,layoutKey:r,value:s,onChange:a,className:o,variant:i}=t,c=ns(),u=yr(),d=f.useMemo(()=>s!==void 0?u(s):c,[s,c,u]),{$t:m}=Q(),p=On(),h=Po({openPaywallUpsell:p}),g=sr(),{inputRef:y}=Fr(),{gpt4Limit:b,compareModels:x,setCompareModels:_}=En(),{specialCapabilities:v}=gr(),C=AS(),w=CD(),S=E0(),{preferredSearchModels:E,setPreferredSearchModel:T}=Ol(),k=Gj(),[M,N]=f.useState(K.SEARCH),[P,O]=f.useState(!1),L=f.useRef(null);f.useEffect(()=>()=>{L.current&&clearTimeout(L.current)},[]);const{gateSearchModeSelection:H}=jo({openPaywallUpsell:p}),[R,I]=f.useState(!1);f.useEffect(()=>{if(!b.available&&!v.unlimitedProSearch)I(!1);else if(v.unlimitedProSearch)I(!0);else if(b.available){const se=E[K.SEARCH];se&&se!==te.DEFAULT&&I(!0)}},[b.available,v.unlimitedProSearch,E]);const F=f.useCallback(se=>H(se?te.PRO:te.DEFAULT)?(I(!1),T(K.SEARCH,te.DEFAULT),!1):(I(se),T(K.SEARCH,se?te.PRO:te.DEFAULT),se),[T,H]),G=f.useCallback(se=>{switch(se){case K.SEARCH:return R?E[se]??S(se):te.DEFAULT;case K.RESEARCH:return E[se]??S(se);case K.STUDIO:return E[se]??S(se);case K.STUDY:return te.STUDY;case K.AGENTIC_RESEARCH:return E[se]??S(se);case K.BROWSER_AGENT:return E[se]??S(se);case K.ASI:return E[se]??S(se)}},[R,E,S]),j=S0(),$=NS(),q=j(te.STUDY),U=$(K.AGENTIC_RESEARCH),X=$(K.ASI),J=f.useCallback(se=>{const re=G(se);j(re)?(a?a(re):h(re),se===K.AGENTIC_RESEARCH&&x.length===0&&_([...k]),y.current?.focus(),O(!1)):H(re)},[j,x.length,k,H,G,y,a,h,_,O]),ne=f.useCallback(se=>{if(F(se),d===K.SEARCH){const re=se?te.PRO:te.DEFAULT;a?a(re):h(re)}},[a,h,d,F]),ae=f.useMemo(()=>{let se=WR;q||(se=se.filter(he=>he!==K.STUDY)),U||(se=se.filter(he=>he!==K.AGENTIC_RESEARCH)),se=se.filter(he=>he!==K.BROWSER_AGENT),X||(se=se.filter(he=>he!==K.ASI));function re(he){const{searchMode:ie}=he,ue=G(ie),ce=se.length<3&&!n;return{children:l.jsx("div",{children:l.jsx(sP,{label:ce?l.jsx(be,{...Yn[ie].name}):void 0,icon:gi(ie),isActiveOption:d===ie})}),elementProps:{"aria-label":m(Yn[ie].name),"aria-disabled":j(ue)===!1?!0:void 0,onPointerEnter(){L.current&&clearTimeout(L.current),N(ie),L.current=setTimeout(()=>{O(!0)},800)},onPointerLeave(){L.current&&(clearTimeout(L.current),L.current=null)},onClick(){L.current&&(clearTimeout(L.current),L.current=null),y.current?.focus(),O(!1)}},label:m(Yn[ie].name),value:ie}}return se.map(he=>re({searchMode:he}))},[G,n,m,d,j,y,q,U,X]);let de;switch(M){case K.SEARCH:{de=l.jsx(Loe,{isToggleActive:R,onToggleChange:ne});break}case K.RESEARCH:{de=l.jsx(Foe,{});break}case K.STUDIO:{de=l.jsx(Uoe,{});break}case K.STUDY:{de=l.jsx(Boe,{});break}case K.AGENTIC_RESEARCH:{de=l.jsx(Hoe,{});break}case K.ASI:{de=l.jsx(Voe,{});break}}const oe=f.useCallback(se=>{se.target.tagName===document.activeElement?.tagName&&(N(d),O(!0))},[d]),le=f.useMemo(()=>l.jsx(rP,{layoutKey:`segmented-search-mode-selector_${r??g}`,options:ae,onFocus:oe,onValueChange:J,value:d,className:o,variant:i,areCuesEnabled:C&&!w}),[r,g,ae,oe,J,d,o,i,C,w]);return l.jsx(fa,{interaction:"hover",open:P,onOpenChange:O,side:"bottom",maxWidthPx:288,triggerElement:le,children:de})}),aP="(pointer: coarse)";function L4(){return typeof window>"u"?!1:window.matchMedia(aP).matches}function lie(){const e=YC(),[t,n]=f.useState(()=>L4()||e);return f.useLayoutEffect(()=>{if(typeof window>"u")return;const r=window.matchMedia(aP);function s(){n(L4())}return r.addEventListener("change",s),s(),function(){r.removeEventListener("change",s)}},[]),t}const cie=A.memo(function({isFollowUp:t,layoutKey:n,value:r,onChange:s,className:a,buttonSize:o,variant:i="default"}){const c=lie(),{isMobileStyle:u}=Gf();if(c||u){const d=(()=>{switch(i){case"default":return"primaryGhost";case"subtle":return"common"}})();return l.jsx(joe,{isFollowUp:t,value:r,onChange:s,buttonSize:o,variant:d})}else return l.jsx(iie,{isFollowUp:t,layoutKey:n,value:r,onChange:s,className:a,variant:i})});A.memo(function({size:t,inverse:n,incognitoType:r=Bh.DEFAULT}){return l.jsx(Y,{variant:"background",className:z("w-lg text-foreground flex aspect-square shrink-0 items-center justify-center rounded-full border",{"!w-[24px]":t==="small","!w-[16px]":t==="tiny"},{"!bg-inverse !text-inverse border-0":n}),children:r===Bh.GOVERNMENT?l.jsx("svg",{width:t==="tiny"?"10":t==="small"?"12":"16",height:"auto",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{fill:"currentColor",d:"M2.75 12.5h2.5v-7h1.5v7h2.5v-7h1.5v7h2.5v-7h1.5v7H16V14H0v-1.5h1.25v-7h1.5zM16 3v1.5H0V3l8-3z"})}):l.jsx(ye,{icon:D("spy"),size:t==="tiny"?11:t==="small"?12:18})})});var Rr;(function(e){e[e.FOCUS=0]="FOCUS",e[e.SOURCES=1]="SOURCES",e[e.PRO_MODEL_PREFERENCE=2]="PRO_MODEL_PREFERENCE",e[e.ATTACHMENTS=3]="ATTACHMENTS",e[e.SEARCH_MODEL_SELECTOR=4]="SEARCH_MODEL_SELECTOR",e[e.UNIFIED_SOURCES=5]="UNIFIED_SOURCES",e[e.SIDECAR_ATTACHMENTS=6]="SIDECAR_ATTACHMENTS",e[e.SEARCH_MODEL_MENU=7]="SEARCH_MODEL_MENU",e[e.PLUS_MENU=8]="PLUS_MENU",e[e.SOURCES_MENU=9]="SOURCES_MENU"})(Rr||(Rr={}));const Dr={outerWrapper:{base:["bg-raised","w-full","outline-none","flex","items-center","border","rounded-2xl"],darkMode:"dark:bg-offset",transition:"duration-75 transition-all"},inputWrapper:{base:"overflow-hidden relative flex h-full w-full",expanded:["col-start-1","col-end-4","pb-3"],compact:["flex-grow","flex-shrink","p-sm","order-1"]},inputElement:["overflow-auto","max-h-[45vh]","lg:max-h-[40vh]","sm:max-h-[25vh]","outline-none","font-sans","resize-none","caret-super","selection:bg-super/30","selection:text-foreground","dark:selection:bg-super/10","dark:selection:text-super","text-foreground","bg-transparent","placeholder-quieter","placeholder:select-none","scrollbar-subtle"],attribution:{left:{base:["gap-sm","flex"],expanded:"col-start-1 row-start-2 -ml-two",compact:"order-0 ml-px"},right:{base:["flex","items-center","justify-self-end"],expanded:"col-start-3 row-start-2",compact:"order-2 mr-px"}},placeholder:{base:["absolute","inset-0","pointer-events-none","select-none","text-quieter"],compact:"p-sm"}},uie=({isActive:e})=>e?"border-subtle":"border-subtler",die=({hasShadow:e,hasQuote:t})=>e&&!t?"shadow-sm dark:shadow-md shadow-super/10 dark:shadow-black/10":"",Q0=Bt("InputContext",{state:{isExpanded:!0,isActive:!1,isComposing:!1},dispatch:()=>{}}),fie=A.memo(function({children:t}){const{state:n}=f.useContext(Q0),{isExpanded:r}=n;return t!==null?l.jsx("div",{className:z(...Dr.attribution.left.base,{[Dr.attribution.left.expanded]:r,[Dr.attribution.left.compact]:!r}),children:t}):null}),mie=({showFileUpload:e,handleFileInput:t,isFollowUp:n,fileUploadErrorMessage:r,fileUploadWarningMessage:s,setAttachmentErrorMessage:a})=>{const{screenshotToolEnabled:o}=Sn(),{activeMenu:i,inputRef:c}=Fr(),{onActiveMenuChange:u}=Fs(),{variation:d}=SI(!1),m=Pne({enabled:e,handleFileInput:t,fileUploadErrorMessage:r,fileUploadWarningMessage:s,setAttachmentErrorMessage:a}),p=Lne({enabled:o,handleFileInput:t}),h=One({enabled:!0,isFollowUp:n}),g=mse({isFollowUp:n}),{plusMenuSearchModeProps:y,searchModeMenuProps:b}=qne({enabled:!n,isFollowUp:n}),x=d&&b.showSearchModeMenu,_=d?{showBrowseForMe:!1,...y}:{...h,showSearchMode:!1},v=f.useCallback(C=>{C?u(Rr.PLUS_MENU):!C&&i===Rr.PLUS_MENU&&(u(null),c.current?.focus())},[i,u,c]);return l.jsxs(l.Fragment,{children:[l.jsx(oae,{isOpen:i===Rr.PLUS_MENU,onToggle:v,...m,...p,..._}),x&&l.jsx(cae,{...b}),!x&&g.showBrowseForMeTag&&l.jsx(uae,{onRemove:g.onRemove})]})},pie=({showIncognitoHint:e,showSearchModeSelector:t=!0,isFollowUp:n,layoutKey:r,showFileUpload:s=!1,handleFileInput:a,useThreadSources:o,fileUploadErrorMessage:i,fileUploadWarningMessage:c,setAttachmentErrorMessage:u})=>l.jsx(fie,{children:l.jsx("div",{className:"gap-xs flex items-center",children:l.jsx(mie,{showFileUpload:s,handleFileInput:a,isFollowUp:n,fileUploadErrorMessage:i,fileUploadWarningMessage:c,setAttachmentErrorMessage:u})})}),hie=A.memo(pie),gie=A.memo(function({children:t,isOpen:n,onOpen:r,onClose:s,connectorMenuItems:a}){const o=f.useCallback(i=>{i?r():s()},[r,s]);return a.length<=1?t:l.jsx(Qe,{triggerElement:t,isOpen:n,onToggle:o,children:tW(a)})}),oP="/account",yie=()=>oP,xie=({mode:e})=>{const t=sr(),n=fu(),r=f.useMemo(()=>t?.startsWith("/collections")||t?.startsWith("/spaces")?"space":t?.startsWith("/search")?"thread":t?.startsWith("/settings")?null:"ask",[t]),s=f.useMemo(()=>n===null?null:t?.startsWith("/collections")||t?.startsWith("/spaces")?n.slug?typeof n.slug=="string"?n.slug:n.slug[0]??null:null:t?.startsWith("/search")?t.split("/").pop()??null:t?.startsWith("/settings")?null:e??null,[t,n,e]),a=yie(),o=f.useMemo(()=>{const i=`${a}/connectors`,c=new URLSearchParams;if(r){const u=Array.isArray(s)?s[0]:s;c.append("referrer",r),u&&c.append("referrerId",u)}return i+"?"+c.toString()},[r,s,a]);return f.useMemo(()=>({referrer:r,referrerId:s,redirectPath:o}),[o,r,s])},bie=Pe(async()=>{const{MicrosoftFilePickerModal:e}=await W(async()=>{const{MicrosoftFilePickerModal:t}=await import("./MicrosoftFilePickerModal-DttNydhV.js");return{MicrosoftFilePickerModal:t}},__vite__mapDeps([58,2,3,5,1,6,7,8,9,59,12,35,15,13,14,16,17]));return{default:e}},{loading:()=>l.jsx(Il,{})}),_ie=Pe(async()=>{const{BoxFilePickerModal:e}=await W(async()=>{const{BoxFilePickerModal:t}=await import("./BoxFilePickerModal-2oMi1nLX.js");return{BoxFilePickerModal:t}},__vite__mapDeps([60,2,3,6,5,1,7,8,9,13,12,14,15,16,17]));return{default:e}},{loading:()=>l.jsx(Il,{})});A.memo(function({isOpen:t,fileType:n,tooltip:r,onOpen:s,onClose:a,onFilePickerOpen:o,onFilePickerClose:i,areFileAttachmentsAllowed:c,fileUploadErrorMessage:u,fileUploadWarningMessage:d,activeConnector:m=null,uploadedFiles:p=_e,handleStartUpload:h,handleFileInput:g,isBoxFilePickerOpen:y=!1,handleCloseBoxFilePicker:b,cleanupBoxFilePicker:x,microsoftFilePickerOptions:_=null,handleCloseMicrosoftFilePicker:v,handleSelectSharepointSite:C,isMicrosoftFilePickerOpen:w=!1,fileInputRef:S,isAudioVideoFilesEnabled:E=!1,setAttachmentErrorMessage:T}){const k="file-upload-button",{$t:M}=Q(),N=f.useRef(!1),[P,O]=vie(),L=YC(),H=wt(),R=f.useCallback(Te=>Te.preventDefault(),[]),{session:I}=je(),{trackEvent:F}=Ze(I),{referrer:G,referrerId:j}=xie({mode:"file"}),{connectorsMap:$}=Do({reason:k}),{enabledFileConnectors:q}=RR({reason:k}),{disabledFileConnectors:U}=DR({reason:k}),X=f.useMemo(()=>$?.onedrive?.connected||$?.sharepoint?.connected,[$?.onedrive?.connected,$?.sharepoint?.connected]),J=f.useCallback(()=>{switch(n){case"image":return M({defaultMessage:"images",id:"HVUWg4/ofn"});case"all":return M({defaultMessage:"files",id:"l17U7PEF+6"});default:return M({defaultMessage:"text or PDF files",id:"XFh9ob267W"})}},[M,n]),ne=f.useCallback(()=>{switch(n){case"image":return EK;case"all":return E?$N:kK;default:return E?TK:SK}},[n,E]),ae=f.useCallback(Te=>{Te?F("attempt connector file attachment",{connectorName:Te}):F("opened file selector",{}),h?.(Te)},[h,F]),{handleConnect:de}=TS({reason:k}),[oe,le]=f.useState(!1),se=f.useMemo(()=>{const Te={type:"default",text:M({defaultMessage:"Upload files",id:"2jjdVzJX0c"}),size:"small",icon:D("file-upload"),onMouseDown:R,onClick:()=>ae("local")},we=q.map(ke=>{const Fe=ke.name;return{type:"default",text:Xi(Fe)??"",avatar:l.jsx("img",{src:$2(Fe)??"",alt:Xi(Fe),width:20,height:20}),onMouseDown:R,onClick:()=>ae(Fe),show:tR.includes(ke.name)}});return U.length>0&&!L&&we.push({type:"nested",submenu:U.map(ke=>({type:"default",size:"small",text:Xi(ke.name),avatar:l.jsx("img",{src:$2(ke.name)??"",alt:Xi(ke.name),width:20,height:20}),rightElement:l.jsx("div",{className:"flex items-center justify-center",children:l.jsx(ye,{icon:D("arrow-up-right"),size:"sm"})}),onClick:()=>de({connectorName:ke.name,customReferrer:G??void 0,customReferrerId:j??void 0})})),isSubmenuOpen:oe,onSubmenuOpen:()=>le(!0),onSubmenuClose:()=>le(!1),text:M({defaultMessage:"Connect files",id:"geEGjFxpOA"}),icon:D("share"),onMouseDown:R}),[Te,...we]},[M,q,U,R,ae,oe,de,G,j,L]),re=f.useCallback(()=>{c&&(se.length<=1||p.length>0?ae(m??void 0):s?.())},[se,p,m,ae,s,c]),he=f.useCallback(()=>{a?.()},[a]),ie=f.useMemo(()=>{if(r)return r;let Te=`${M({defaultMessage:"Attach",id:"Ye0Clmvfec"})} ${J()}`;return H?c||(Te=M({defaultMessage:"File attachments are disabled by your organization",id:"HmmaBNCmcH"})):Te+=`. ${M({defaultMessage:"Sign in to attach files",id:"Ei6nUBg77Q"})}`,Te},[M,c,J,H,r]);f.useEffect(()=>{const Te=()=>{N.current&&(i?.(),N.current=!1)};return window.addEventListener("focus",Te),()=>window.removeEventListener("focus",Te)},[i]);const ue=f.useCallback(()=>v?.(),[v]),ce=f.useCallback(()=>b?.(),[b]),me=f.useCallback(Te=>C?.(Te),[C]),pe=f.useCallback(()=>x?.(),[x]),xe=f.useCallback(()=>{T?.("")},[T]),Oe=f.useCallback(Te=>{se.length<=1?re():Te.stopPropagation()},[se.length,re]);return l.jsxs("div",{className:"flex items-center",children:[l.jsx(gie,{connectorMenuItems:se,isOpen:t,onOpen:re,onClose:he,children:l.jsx(at,{variant:"text",size:"small",icon:D("paperclip"),disabled:!c,onClick:Oe,"aria-label":ie,tooltipOpen:P||t,tooltipOnOpenChange:O})}),l.jsx("input",{type:"file",multiple:!0,"data-testid":"file-upload-input",onClick:()=>{N.current=!0,o?.()},ref:S,onChange:Te=>{N.current=!1,g?.(Te.target.files?Array.from(Te.target.files):_e)},accept:ne(),style:{display:"none"}}),X&&w&&l.jsx(bie,{options:_,isOpen:w,onClose:ue,onSelectSite:me}),$?.box?.connected&&y&&l.jsx(_ie,{isOpen:y,onClose:ce,cleanupPicker:pe}),l.jsx(fl,{isVisible:!!u,variant:"error",message:u??"",handleClose:xe,timeout:null}),l.jsx(fl,{isVisible:!!d&&!u,variant:"warning",message:d??"",timeout:4})]})});function vie(){const{fileUploadUpsellTooltipOpen:e}=Fr(),{setFileUploadUpsellTooltipOpen:t}=Fs(),[n,r]=f.useState(!1);return f.useEffect(()=>{e&&r(!0)},[e]),f.useEffect(()=>{n&&t(!1)},[n,t]),f.useMemo(()=>[n,r],[n])}const X0=({reason:e})=>{const{$t:t}=Q(),{isSearchModelMenuRewriteEnabled:n}=Pl(),{getModelLabel:r,getModelDescription:s}=ki({reason:e,enabled:n}),a=f.useCallback(i=>{const c=dn[i]?.name;return c?t(c):""},[t]),o=f.useCallback(i=>{const c=dn[i]?.description;return c?t(c):""},[t]);return f.useMemo(()=>n?{getSearchModelLabel:r,getSearchModelDescription:s}:{getSearchModelLabel:a,getSearchModelDescription:o},[n,r,s,a,o])},uo=Me({chooseModel:{defaultMessage:"Choose a model",id:"fXlc3idTcy"},selectModel:{defaultMessage:"Model",id:"rhSI1/3g21"},modelCount:{defaultMessage:"{count, plural, one {# model} other {# models}}",id:"C0GpSROgO5"},comparingModels:{defaultMessage:"Comparing {modelNames}",id:"ONQRQvpuOG"}}),Cie=f.memo(function({isOpen:t,onOpen:n,onClose:r,selectedModel:s,onModelChange:a,restrictions:o,compareModels:i,onCompareModelsChange:c}){const u=Q(),{$t:d}=u,{isMax:m,hasAccessToProFeatures:p}=Mt(),{onActiveMenuChange:h}=Fs(),{activeMenu:g}=Fr(),y=ns(),{configuredModel:b}=En(),{getSearchModelLabel:x}=X0({reason:"search-model-selector"}),_=y===K.AGENTIC_RESEARCH,v=On(),C=Po({openPaywallUpsell:v}),{isMobileStyle:w}=Gf(),S=uh(y),E=Zf(),T=Gj();f.useEffect(()=>{_&&c&&(!i||i.length===0)&&c([...T])},[_,i,c,T]);const k=f.useCallback(J=>{C(J)},[C]),M=f.useCallback(()=>{h(Rr.SEARCH_MODEL_SELECTOR)},[h]),N=f.useCallback(()=>{h(null)},[h]),P=s??b,O=a??k,L=t??g===Rr.SEARCH_MODEL_SELECTOR,H=n??M,R=r??N,I=o&&o.allowTextOnlyModels===!1,{menuItems:F}=zj({currentModel:P,onModelSelect:O,disableTextOnlyModels:I,compareModels:i,onCompareModelsChange:c,openPaywallUpsell:v,searchMode:y}),G=f.useMemo(()=>df(P),[P]),j=f.useMemo(()=>({className:z("max-h-[40vh] min-w-64",{"max-super-override":m})}),[m]),$=f.useCallback(()=>l.jsx("span",{className:z("inline-flex",{"text-super":!G}),children:l.jsx(_n,{icon:D("cpu"),size:"small"})}),[G]),q=f.useMemo(()=>{if(_&&i&&i.length>0){if(i.length===1){const ne=x(i[0]??"");if(ne)return ne}return d(uo.modelCount,{count:i.length})}if(_)return d(uo.selectModel);const J=x(P);return y===K.BROWSER_AGENT?J||d(uo.selectModel):!p||G||!J?d(uo.selectModel):J},[p,G,P,d,_,i,y,x]),U=f.useMemo(()=>{if(!_||!i||i.length<2)return;const J=i.map(ae=>x(ae)).filter(ae=>!!ae);if(J.length<2)return;const ne=new Intl.ListFormat(u.locale,{style:"long",type:"conjunction"}).format(J);return d(uo.comparingModels,{modelNames:ne})},[_,i,d,u.locale,x]),X=f.useMemo(()=>{const J=E?l.jsx(at,{variant:"text",size:"small","aria-label":G?d(uo.chooseModel):q,trailingIcon:D("chevron-down"),pill:!0,children:q}):l.jsx(at,{variant:"text",size:"small",icon:$,"aria-label":G?d(uo.chooseModel):q,rounded:E});return U&&_?l.jsx(wn,{content:U,side:"top",children:J}):J},[d,$,E,G,q,U,_]);return l.jsx(da.Slide,{isVisible:S,children:l.jsx(bu,{placement:"bottom-end",boxProps:j,items:F,isMobileStyle:w??!1,isOpen:L,onOpen:H,onClose:R,wrapperClassName:"inline-flex",isMax:m,children:X})})}),wie=f.memo(function({enabled:t=!0,...n}){const r=f.useRef(n),s=f.useMemo(()=>t?(r.current=n,n):r.current,[t,n]);return l.jsx(Cie,{...s})}),Sie=A.memo(function({sources:t,tooltip:n,size:r="default",disabled:s=!1,...a}){const{$t:o}=Q(),i=Zg({variant:"text",disabled:s,size:r,iconOnly:t.length===1}),c=l.jsx(Ls,{"aria-label":o({defaultMessage:"Sources",id:"fhwTpAcBLC"}),className:i,disabled:s,...a,children:l.jsx(II,{sources:t,size:r})});return n?l.jsx(wn,{content:n,children:c}):c}),iP=f.memo(function({isOpen:t,sources:n,tooltip:r,size:s="default",disabled:a=!1,onChange:o,onOpen:i,onClose:c,triggerElement:u,omittedSources:d,omitCometMcpSources:m=!1}){const p="sources-menu",{isAllowed:h,isConnected:g}=no({reason:p}),{sources:y}=Ai({omitCometMcpSources:m,isConnectorAllowed:h,isConnectorConnected:g,omittedSources:d}),{suggested:b,refresh:x}=j0({sources:y}),_=f.useCallback(C=>{C?(x(),i?.()):c?.()},[i,c,x]),v=f.useMemo(()=>u??l.jsx(Sie,{sources:n,size:s,disabled:a,tooltip:r}),[u,n,s,a,r]);return l.jsx(Qe,{isOpen:t,onToggle:_,align:"end",minWidthPx:ZI,triggerElement:v,maxHeightPx:310,children:l.jsx(wS,{sources:n,onChange:o,suggestedSources:b,omittedSources:d,omitCometMcpSources:m})})}),F4=Me({disabled:{defaultMessage:"Start a new thread to change sources",id:"jKXi56aXv8"},enabled:{defaultMessage:"Set sources for search",id:"yAyuRoLEjt"}}),Eie=A.memo(function({disabled:t=!1,...n}){const{$t:r}=Q(),s=r(t?F4.disabled:F4.enabled);return l.jsx(iP,{disabled:t,tooltip:s,...n})}),kie=A.memo(function({isInitializing:t,startTranscription:n,error:r=null,disabled:s=!1,pill:a=!1}){const{$t:o}=Q(),[i,c]=f.useState(t),u=f.useCallback(()=>{c(!0),n?.()},[n]);return f.useEffect(()=>{r&&c(!1)},[r]),l.jsx("div",{className:"relative",children:l.jsx(at,{"aria-label":o({defaultMessage:"Dictation",id:"0eNg7Kdki1"}),icon:D("microphone"),isLoading:!r&&(t||i),variant:"text",onClick:u,disabled:s,size:dl.small,rounded:a})})}),Mie=A.memo(function({stopTranscription:t,pill:n=!1}){const{$t:r}=Q();return l.jsx("div",{className:"relative",children:l.jsx(at,{"aria-label":r({defaultMessage:"Stop dictation",id:"De+8liLWgX"}),icon:D("player-stop-filled"),variant:"tonal",onClick:t,disabled:!1,size:dl.small,rounded:n})})}),Tie=A.memo(function({onSubmit:t,isDisabled:n=!1,toolTip:r,pill:s=!1}){const{$t:a}=Q();return l.jsxs("div",{className:"relative ml-2",children:[l.jsx("div",{className:"bg-super/20 absolute inset-[10%] animate-[ping_1.5s_cubic-bezier(0,0,0.2,1)_infinite] rounded-lg"}),l.jsx(at,{"aria-label":r||a({defaultMessage:"Submit dictation",id:"gDpUQHAEOK"}),icon:D("check"),variant:"primary",onClick:t,disabled:n,size:dl.small,rounded:s})]})}),Aie=A.memo(function({onStopButtonClick:t,pill:n=!1}){const{$t:r}=Q();return l.jsx(da.Slide,{isVisible:!0,children:l.jsx(at,{"aria-label":r({defaultMessage:"Stop generating response",id:"wXXKXUJh1s"}),variant:"tonal",icon:D("player-stop-filled"),onClick:t,size:"small",rounded:n})})}),Z0=A.memo(function(){return l.jsx("div",{className:"bg-base fixed inset-0 z-[999] flex h-screen w-screen items-center justify-center opacity-50"})}),Nie=Pe(async()=>{const{LoginModal:e}=await W(async()=>{const{LoginModal:t}=await import("./LoginModal-D844be60.js");return{LoginModal:t}},__vite__mapDeps([48,2,3,5,1,6,7,8,9,10,11,12,13,49,14,15,16,17]));return{default:e}});Pe(async()=>{const{VoiceToVoiceModal:e}=await W(async()=>{const{VoiceToVoiceModal:t}=await import("./VoiceToVoiceModal-DrSEcaaa.js");return{VoiceToVoiceModal:t}},__vite__mapDeps([61,2,3,6,5,1,7,8,9,62,63,64,15,65,13,12,14,16,17]));return{default:e}},{loading:()=>l.jsx(Z0,{})});const Rie=A.memo(function({pill:t=!1}){const{openModal:n}=Kt(),{$t:r}=Q(),s=wt(),a=hn(),o=f.useCallback(()=>{s?s?a.push("/speak"):n(Nie,{origin:Ke.VOICE_TO_VOICE_BUTTON,pitchMessage:{title:"Sign in to unlock voice mode"}}):window.open(oN("/auth/signin"),"_blank")},[s,n,a]);return l.jsx("div",{className:"ml-2",children:l.jsx(at,{onClick:o,size:dl.small,icon:D("custom-perplexity-v2v"),variant:"primary",disabled:!1,"aria-label":r({defaultMessage:"Voice mode",id:"OnF9aqAuar"}),rounded:t})})}),Die=({uploadedFiles:e,selectedModel:t,onModelSwitch:n})=>{const{$t:r}=Q(),{hasAccessToProFeatures:s}=Mt(),{openToast:a}=cn(),{getModelConfig:o}=Wf(),i=f.useRef(null),c=Vs(),{getSearchModelLabel:u}=X0({reason:"useTextOnlyModelHandler"});f.useEffect(()=>{const d=e?.some(g=>Xr(g.file.name))??!1,p=o(t)?.textOnlyModel===!0;if(!d||!p){i.current=null;return}if(i.current===t)return;const h=r({defaultMessage:"{modelName} does not support images. Switched to the default best model.",id:"Dtdtsbnc5W"},{modelName:u(t)??r({defaultMessage:"Selected model",id:"O+3LDIMB/r"})});a({message:h,variant:"warning",timeout:null}),i.current=t,n(c)},[e,t,o,a,r,n,s,c,u])},Iie=f.memo(function({modelConfig:t}){const{isMax:n}=Mt(),{$t:r}=Q();if(t.has_new_tag){const s=l.jsx(TN,{text:r({defaultMessage:"new",id:"qlTe+eC7Ec"})});return t.subscription_tier==="max"?l.jsx("span",{className:"max-super-override",children:s}):s}return t.subscription_tier==="max"&&!n?l.jsx(xi,{variant:"max",size:"md-large"}):null}),jie=f.memo(function({checked:t,onCheckedChange:n,modelConfig:r,...s}){const{$t:a}=Q(),o=f.useMemo(()=>!r?.non_reasoning_model||!r?.reasoning_model,[r]);if(o){const i=a({defaultMessage:"{modelName} does not support reasoning",id:"WDQ/SkrhHE"},{modelName:r.label??"This model"}),c=a({defaultMessage:"{modelName} is a reasoning-only model",id:"VZp68/aGTi"},{modelName:r.label??"This model"}),u=t?c:i;return l.jsx(wn,{content:u,side:"left",children:l.jsx(U4,{checked:t,onCheckedChange:n,disabled:o})})}return l.jsx(U4,{checked:t,onCheckedChange:n,disabled:o,...s})}),U4=({checked:e,onCheckedChange:t,disabled:n,...r})=>l.jsx(Qe.SwitchItem,{checked:e,onCheckedChange:t,disabled:n,...r,children:l.jsx(be,{defaultMessage:"Thinking",id:"AHQWDTo4+e"})});function Pie({allowTextOnlyModels:e=!0}={}){return{allowTextOnlyModels:e}}const Oie=V({defaultMessage:"Disabled by your organization",id:"cBE0Jgy5fu"}),lP=f.memo(function({selection:t,modelConfig:n,onSelect:r,restrictions:s,disabledByOrganization:a=!1,...o}){const{$t:i}=Q(),{isMax:c}=Mt(),u=t.selected&&n.reasoning_model,d=n.non_reasoning_model??n.reasoning_model,m=f.useMemo(()=>{if(!d)return null;const _=Qw(d);return _?l.jsx(_n,{icon:_,size:"small"}):null},[d]),p=f.useCallback(_=>{const v=_?n.reasoning_model:n.non_reasoning_model;if(!v){Z.warn("[SearchModelMenuItem] No model to select for reasoning change",{modelConfig:n,reasoning:_});return}r(v)},[n,r]),{allowTextOnlyModels:h}=Pie(s),g=n.text_only_model&&!h,y=g||a,b=a?i(Oie):n.subheading??void 0;if(!d)return null;const x=l.jsxs("div",{className:z("rounded-lg",{"bg-subtle":t.selected}),children:[l.jsx(Qe.RadioItem,{value:d,subtitle:b,leadingAccessory:m,disabled:y,...o,children:l.jsxs("div",{className:"flex items-center gap-sm",children:[l.jsx("span",{className:z({"text-super":t.selected,"max-super-override":c}),children:n.label}),l.jsx(Iie,{modelConfig:n})]})}),u&&!a&&l.jsx(jie,{checked:t.reasoning,modelConfig:n,onCheckedChange:p})]});return g?l.jsx(wn,{content:i({defaultMessage:"{modelName} is a text only model. Images are not supported with this model.",id:"JVwzQmWM2T"},{modelName:n.label}),side:"left",children:l.jsx("div",{children:x})}):n.description?l.jsx(wn,{content:n.description,side:"left",children:l.jsx("div",{children:x})}):x});function cP(e,t){const n=e===t.non_reasoning_model||e===t.reasoning_model,r=e===t.reasoning_model;return{selected:n,reasoning:r}}const B4=Me({bestLabel:{defaultMessage:"Model",id:"rhSI1/3g21"},bestDescription:{defaultMessage:"Automatically selected best model",id:"K44CS/0jKm"}}),Lie=f.memo(function({selectedModel:t,onModelChange:n}){const{$t:r}=Q(),{hasAccessToProFeatures:s}=Mt(),a=wt(),{openVisitorLoginUpsell:o}=ws({enabled:!a}),i=On(),c=Vs(),u=f.useMemo(()=>l.jsx(Qe.Item,{onSelect:()=>{if(!a){const p=new URL(window.location.href);p.searchParams.set("upsell","models"),o({title:r({defaultMessage:"Sign in to choose a model",id:"BhbQUiYsTB"}),description:r({defaultMessage:"Access the latest AI models from Perplexity, OpenAI, Anthropic (Claude), Google Gemini and more",id:"DDVABeGeBG"}),origin:Ke.MODEL_SELECTOR,overrideRedirectUrl:p.toString()});return}i({pitchMessage:{title:r({defaultMessage:"Upgrade to choose a model",id:"BhzpKf2MS5"}),description:r({defaultMessage:"With Perplexity Pro, you get access to all the latest AI models in one subscription",id:"gqUZUJex7f"})},origin:Ke.MODEL_SELECTOR})},children:r({defaultMessage:"Upgrade for best models",id:"sy/65ilMNl"})}),[r,a,o,i]),d=f.useMemo(()=>({label:r(B4.bestLabel),non_reasoning_model:c,reasoning_model:null,description:r(B4.bestDescription),has_new_tag:!1,subscription_tier:null,text_only_model:!1}),[r,c]),m=f.useMemo(()=>l.jsx(lP,{selection:cP(t,d),modelConfig:d,onSelect:n}),[t,d,n]);return s?m:u}),Fie=f.memo(function({model:t,onModelChange:n,showSeparator:r=!1,searchModelGateCallback:s,restrictions:a}){const o="search-model-menu-items",{config:i}=ki({reason:o}),{disabledModelPreferences:c}=Vj({reason:o}),u=Yw(t),d=f.useMemo(()=>{const b=i.map(_=>_.non_reasoning_model??_.reasoning_model).filter(_=>_!=null),x=KR(u,b);return i.filter(_=>{const v=_.non_reasoning_model??_.reasoning_model;return v&&x.includes(v)})},[i,u]),m=On(),{gateSearchModelSelection:p}=jo({openPaywallUpsell:m}),h=f.useCallback(b=>!!(b&&c.includes(b)),[c]),g=f.useCallback(b=>{const x=h(b.non_reasoning_model),_=h(b.reasoning_model);return x||_},[h]),y=f.useCallback(b=>{(s?s(b):p(b))||n(b)},[p,n,s]);return l.jsxs(Qe.RadioGroup,{value:t,onValueChange:y,children:[l.jsx(Lie,{selectedModel:t,onModelChange:y}),r&&l.jsx(Qe.Separator,{}),d.map(b=>l.jsx(lP,{selection:cP(t,b),modelConfig:b,onSelect:y,restrictions:a,disabledByOrganization:g(b)},b.label))]})}),Uie=200,od=Me({chooseModel:{defaultMessage:"Choose model",id:"+mvQfVYQ1f"},selectModel:{defaultMessage:"Model",id:"rhSI1/3g21"},selectedModel:{defaultMessage:"Selected model",id:"O+3LDIMB/r"}}),Bie=f.memo(function({isOpen:t,onToggle:n,model:r,onModelChange:s,restrictions:a}){const o="search-model-menu",[i,c]=f.useState(!1),{$t:u}=Q(),{getModelLabel:d}=ki({reason:o}),{hasAccessToProFeatures:m}=Mt(),p=df(r),h=Zf(),g=Yw(r),y=t??i,b=n??c,x=f.useCallback(()=>l.jsx("span",{className:z({"text-super":!p}),children:l.jsx(_n,{icon:D("cpu"),size:"small"})}),[p]),_=f.useMemo(()=>g===K.BROWSER_AGENT?d(r)??u(od.selectedModel):!m||p?u(od.selectModel):d(r)??u(od.selectedModel),[g,d,p,r,u,m]),v=f.useMemo(()=>h?l.jsx(at,{variant:"text",size:"small","aria-label":p?u(od.chooseModel):_,trailingIcon:D("chevron-down"),pill:!0,children:_}):l.jsx(at,{variant:"text",size:"small",icon:x,"aria-label":p?u(od.chooseModel):_}),[u,x,h,p,_]);return l.jsx(Qe,{isOpen:y,onToggle:b,minWidthPx:Uie,triggerElement:v,children:l.jsx(Fie,{model:r,onModelChange:s,restrictions:a,showSeparator:!0})})}),Hie=f.memo(function({enabled:t=!0,...n}){const r=f.useRef(n),s=f.useMemo(()=>t?(r.current=n,n):r.current,[t,n]);return l.jsx(Bie,{...s})}),Vie=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"enable-clarifying-questions",defaultValue:e,extraAttributes:t,subjectType:"user_nextauth_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])};function uP(){const{variation:e}=Vie(!1);return e}const H4=A.memo(function({isLoading:t,children:n}){const{state:r}=f.useContext(Q0),{isExpanded:s}=r;return l.jsxs("div",{className:z(...Dr.attribution.right.base,{[Dr.attribution.right.expanded]:s,[Dr.attribution.right.compact]:!s}),children:[t?l.jsx(B,{color:"light",className:"mr-3",children:l.jsx(ye,{icon:D("loader-2"),size:"xs",className:"animate-spin"})}):null,n]})}),V4=Pe(async()=>{const{VoiceToVoiceModal:e}=await W(async()=>{const{VoiceToVoiceModal:t}=await import("./VoiceToVoiceModal-DrSEcaaa.js");return{VoiceToVoiceModal:t}},__vite__mapDeps([61,2,3,6,5,1,7,8,9,62,63,64,15,65,13,12,14,16,17]));return{default:e}},{loading:()=>l.jsx(Z0,{})}),n1=({rounded:e,toolTip:t,icon:n,disabled:r,querySource:s,onSubmit:a})=>{const{$t:o}=Q();return l.jsx(at,{icon:n,"aria-label":t||o({defaultMessage:"Submit",id:"wSZR47Y5kj"}),variant:"primary",size:"small",disabled:r,rounded:e,onClick:r?void 0:()=>a({querySource:s})})},Gie=({value:e,json:t,isFollowUp:n,isDisabled:r,querySource:s,errorMessage:a,handleSubmit:o,fileUploadRef:i,showFileUpload:c,fileUploadTooltip:u,showStopButton:d,showModelSelector:m,onStopButtonClick:p,onFilePickerOpen:h,onFilePickerClose:g,showSources:y,useThreadSources:b,disableActionButtons:x,startTranscription:_,stopTranscription:v,isTranscribing:C,isTranscriptionInitializing:w,isTranscriptionAvailable:S,transcriptionError:E=null,fileUploadErrorMessage:T,fileUploadWarningMessage:k,activeConnector:M=null,uploadedFiles:N,handleStartUpload:P,handleFileInput:O,isBoxFilePickerOpen:L=!1,handleCloseBoxFilePicker:H,cleanupBoxFilePicker:R,microsoftFilePickerOptions:I=null,handleCloseMicrosoftFilePicker:F,handleSelectSharepointSite:G,isMicrosoftFilePickerOpen:j=!1,fileInputRef:$,hasQuery:q,isAudioVideoFilesEnabled:U=!1,setAttachmentErrorMessage:X,isCometHome:J,isMissionControl:ne})=>{const ae="ask-input-right-attributions",{isMobileStyle:de,isMobileUserAgent:oe}=Be(),{openModal:le}=Kt(),{organization:se}=Hs({reason:ae}),{$t:re}=Q(),he=uP(),{activeMenu:ie}=Fr(),{onActiveMenuChange:ue}=Fs(),{device:{isWindowsApp:ce}}=jn(),me=nn(),{isSearchModelMenuRewriteEnabled:pe}=Pl(),xe=ns(),Oe=Zf(),Te=yr(),{shouldShowModelSelector:we}=Mu(),ke=f.useRef(e),Fe=f.useRef(t);ke.current=e,Fe.current=t;const ot=f.useCallback(({querySource:dt})=>{o({query:ke.current,json:Fe.current,querySource:dt})},[o]),ge=Ow(dt=>dt.results.find(en=>Yt.isStatusPending(en))),Ce=Te(ge?.display_model)==K.RESEARCH||Te(ge?.display_model)==K.STUDIO;f.useEffect(()=>{if(!ce)return;const dt=new URLSearchParams(window.location.search);dt.get("voice-mode")?(zh({"voice-mode":void 0}),_?.()):dt.get("v2v")&&(zh({v2v:void 0}),le(V4,{}))},[me,ce,_,le]),f.useEffect(()=>{const dt=()=>{S&&(C?v?.():_?.())},en=()=>{le(V4,{})};return document.addEventListener("toggleVoiceToVoice",en),document.addEventListener("toggleDictation",dt),()=>{document.removeEventListener("toggleDictation",dt),document.removeEventListener("toggleVoiceToVoice",en)}},[C,S,_,v,le]);const Ae=!ne&&!n&&!J&&(!oe&&!de||!0),He=D("arrow-up"),rt=d&&he&&Ce,Ft=()=>!rt||!s?null:l.jsx("div",{className:z("ml-3",r&&"pointer-events-none opacity-50"),children:l.jsx(n1,{toolTip:a||re({defaultMessage:"Anything else to consider?",id:"DDAw7Ictpp"}),icon:He,querySource:s,disabled:!1,onSubmit:ot,rounded:Oe})}),Qt=()=>{const dt=Oe;if(x)return l.jsx("div",{className:"ml-2",children:l.jsx(n1,{disabled:!0,icon:He,querySource:s??"home",onSubmit:jr,rounded:dt})});const en=s&&l.jsx("div",{className:"ml-2",children:l.jsx(n1,{toolTip:a||"",icon:He,disabled:r,querySource:s,onSubmit:ot,rounded:dt})},"submit-button"),jt=[];if(S&&(C?(jt.push(l.jsx(Mie,{stopTranscription:v,pill:dt},"dictation-stop-button")),s&&jt.push(l.jsx(Tie,{onSubmit:Ut,pill:dt},"dictation-submit-button"))):jt.push(l.jsx(kie,{isInitializing:w,startTranscription:_,error:E,disabled:d,pill:dt},"dictation-button"))),d)jt.push(l.jsx(Aie,{onStopButtonClick:p,pill:dt},"stop-button"));else if(Ae){const Gt=(N?.length||q)&&s&&!C;Gt?jt.push(en):!C&&!Gt&&jt.push(l.jsx(Rie,{pill:dt},"voice-to-voice-button"))}else C||jt.push(en);return S||Ae?jt:en},Ye=f.useCallback(()=>ue(null),[ue]);f.useCallback(()=>ue(Rr.ATTACHMENTS),[ue]);const We=f.useCallback(()=>ue(Rr.UNIFIED_SOURCES),[ue]),it=f.useCallback(dt=>{if(dt){ue(Rr.SEARCH_MODEL_MENU);return}!dt&&ie===Rr.SEARCH_MODEL_MENU&&Ye()},[ie,ue,Ye]),{sources:Ee,setSources:et}=HI({useThreadSources:b,reason:ae}),xt=f.useMemo(()=>{if(!y)return!1;const dt=Ee.every(en=>en==="web");return n&&dt?!1:y},[y,n,Ee]),Ut=f.useCallback(()=>{v?.(),q&&o({query:ke.current,json:Fe.current,querySource:s})},[v,q,o,s]),{configuredModel:Tt,compareModels:gn,setCompareModels:ir}=En(),br=On(),lt=Po({openPaywallUpsell:br}),mt=f.useCallback(dt=>{lt(dt)},[lt]),At=!!me?.get("openSearchModelSelector");Die({uploadedFiles:N,selectedModel:Tt,onModelSwitch:mt});const Vt=f.useMemo(()=>({allowTextOnlyModels:!(N?.some(en=>Xr(en.file.name))??!1)}),[N]);return f.useEffect(()=>{if(!At)return;const dt=pe?Rr.SEARCH_MODEL_MENU:Rr.SEARCH_MODEL_SELECTOR;ue(dt)},[At,pe,ue]),C?l.jsxs(H4,{children:[s&&Qt(),Ft()]}):l.jsxs(H4,{children:[xt&&!Oe&&l.jsx(Eie,{isOpen:ie===Rr.UNIFIED_SOURCES,size:"small",sources:Ee,onChange:et,onOpen:We,onClose:Ye,disabled:b}),m&&(pe?l.jsx(da.Slide,{isVisible:xe===K.BROWSER_AGENT?we:uh(xe),children:l.jsx(Hie,{enabled:xe===K.BROWSER_AGENT?we:uh(xe),isOpen:ie===Rr.SEARCH_MODEL_MENU,onToggle:it,model:Tt,onModelChange:mt,restrictions:Vt})}):l.jsx(wie,{enabled:xe===K.BROWSER_AGENT?we:uh(xe),selectedModel:Tt,onModelChange:mt,restrictions:Vt,compareModels:gn,onCompareModelsChange:ir})),c&&!Oe&&!1,s&&Qt(),Ft()]})},zie=A.memo(Gie),qie=60,$ie=2e3,Wie=6,Kie=4,zd=(e,t)=>e?Kie:Wie,Yie=e=>!(e.length===0||e.includes(`
`)),Qie=e=>e.map(t=>({query:t.text,image:t.image_url,url:t.url,title:t.title,description:t.description,focus:t.focus})),Xie=e=>e.sort((t,n)=>t.url?-1:n.url?1:t.image?-1:n.image?1:0),u_=(e,t,n)=>{let r=e;r=e.filter(o=>!o.url);const s=Z9(r,"query");if(n){const o=s.findIndex(i=>i.query===n);if(~o){const i=s[o];s.splice(o,1),s.unshift(i)}}const a=Xie(s);return[a,a.slice(0,zd(t))]},dP=(e,t,n)=>{const r=n?e.replace(/\s+/g,"").toLocaleLowerCase():e,s=t.query;let a=0,o=0;for(;a<r.length&&o<s.length;)r[a]===s[o]?.toLocaleLowerCase()&&a++,o++;return[a===r.length,o]},Zie=(e,t)=>{const n=e.replace(/\s+/g,""),r=[];let s="",a="",o=0,i=0;for(;o<n.length&&i<t.length;)n[o]?.toLocaleLowerCase()===t[i]?.toLocaleLowerCase()?(a&&(r.push(["",a]),a=""),s+=t[i],o++,i++):(s&&(r.push([s,""]),s=""),a+=t[i],i++);return s&&r.push([s,""]),a&&r.push(["",a]),i<t.length&&r.push(["",t.slice(i)]),r},Jie={calendar:D("calendar"),"report-search":D("report-search"),browser:D("browser"),mail:D("mail"),"shopping-bag":D("shopping-bag"),message:D("message"),"user-heart":D("user-heart"),play:D("player-play"),globe:D("globe"),music:D("music"),book:D("book"),plane:D("plane"),plus:D("plus")},ele=e=>e?.includes("perplexity.ai")??!1,tle=e=>e?.includes("perplexity.ai/finance")??!1,fP=e=>e==="https://www.perplexity.ai/finance",nle=A.memo(function({query:t,completion:n,inputsAndCompletions:r,description:s,highlightPrefix:a,url:o,title:i,shouldShowTitle:c}){const u=tle(o),d=fP(o),m=s||(c&&i?i:t),{$t:p}=Q(),h=u?n?.toUpperCase():n;return d?l.jsx(B,{variant:"small",inline:!0,children:p({defaultMessage:"{perplexity} Finance",id:"LnL5Kdg1cp"},{perplexity:"Perplexity"})},"perplexity-finance"):l.jsxs(l.Fragment,{children:[!s&&r?.length&&a?r.map(([g,y],b)=>g?l.jsx(B,{color:"light",variant:"small",className:"inline",as:"div",children:g},`${b}-${g}`):l.jsx(B,{className:"inline whitespace-pre visRefresh2026Fonts:font-bold",variant:"small",as:"div",children:y},`${b}-${y}`)):l.jsx(B,{inline:!0,color:"light",variant:"small",children:m}),n&&!s&&a&&!r?.length&&l.jsx(B,{className:"whitespace-pre visRefresh2026Fonts:font-bold",inline:!0,variant:"small",children:h}),n&&!s&&!a&&l.jsx(B,{color:"light",inline:!0,variant:"small",children:h})]})}),rle=A.memo(function({onClick:t,query:n,completion:r,inputsAndCompletions:s,url:a,suggestionIndex:o,keyboardFocusedIndex:i,setKeyboardFocusedIndex:c,leftIcon:u,rightIcon:d,className:m,description:p,title:h,shouldShowTitle:g,highlightPrefix:y=!0,category:b,QueryContentComponent:x=nle,metadata:_,actionHandler:v}){const{isMobileUserAgent:C}=Be(),w="group-hover:opacity-100 group-data-[focused=self]:opacity-100",S="opacity-0 group-data-[focused=other]:opacity-0",E=f.useCallback(()=>{c?.(-1)},[c]);return f.useCallback(k=>g&&h&&n?l.jsx(wn,{content:n,side:"right",children:k}):k,[g,h,n])(l.jsx("div",{"data-focused":i===void 0||i===-1?"none":i===o?"self":"other","data-testid":`auto-suggestion-${(o??0)+1}`,className:z("group flex cursor-pointer flex-row items-start rounded-lg p-[8px]",m),onPointerDown:()=>{v?v():t(r?n+r:n)},onPointerLeave:E,children:l.jsxs("div",{className:"flex gap-sm w-full min-w-0 flex-row items-start whitespace-pre leading-tight",children:[l.jsx(B,{className:"h-[1lh] flex items-center -mr-2",color:"light",variant:"small",children:u}),l.jsx(B,{variant:"small",className:z(C?"truncate":"line-clamp-2 text-wrap"),children:a?l.jsx(Dt,{href:a,target:"_blank",rel:"noopener",children:l.jsx(x,{query:n,url:a,completion:r,inputsAndCompletions:s,description:p,category:b,highlightPrefix:y,metadata:_,title:h,shouldShowTitle:g})}):l.jsx(x,{query:n,url:a,completion:r,inputsAndCompletions:s,description:p,category:b,highlightPrefix:y,metadata:_,title:h,shouldShowTitle:g})}),d&&l.jsx(B,{variant:"smallBold",color:"super",inline:!0,className:z("ml-auto inline-flex h-[1lh] items-center",w,{[S]:!a}),children:d})]})}))}),d_={ticker:{order:0,showHeader:!1,highlightPrefix:!1},suggestion:{order:1,showHeader:!1,highlightPrefix:!0},news:{displayName:"Latest News",order:2,showHeader:!0,highlightPrefix:!1},related_question:{displayName:"Related Questions",order:3,showHeader:!0,highlightPrefix:!1},shortcuts:{displayName:"Shortcuts",order:4,showHeader:!0,highlightPrefix:!0}},sle=e=>{const t={};return e.forEach(n=>{const r=n.category||"suggestion";t[r]||(t[r]=[]),t[r].push(n)}),t},ale=e=>Object.keys(e).sort((t,n)=>{const r=d_[t]?.order??Number.MAX_SAFE_INTEGER,s=d_[n]?.order??Number.MAX_SAFE_INTEGER;return r-s}),G4=e=>{const{metadata:t}=e;return!!t&&t.type==="price"&&!!t.price_info&&typeof t.price_info.currentPrice=="number"&&!!t.price_info.change&&!!t.price_info.changePercentage},ole=e=>[...e].sort((t,n)=>{const r=G4(t),s=G4(n);return r&&!s?-1:!r&&s?1:0}),ile=A.memo(function(t){const{text:n,show:r,className:s}=t;return r?l.jsxs(l.Fragment,{children:[l.jsx(Y,{className:z("my-sm sm:mx-sm border-b first:hidden",s)}),n&&l.jsx(Y,{variant:"transparent",className:"sm:mx-sm mt-xs mb-sm pr-sm",children:l.jsx(B,{className:"w-max",variant:"tinyMono",color:"light",children:n})})]}):null}),lle=A.memo(function({category:t,suggestions:n,categoryConfig:r,value:s,focusedIndex:a,setFocusedIndex:o,handleSubmit:i,indexOffset:c,LeftIconComponent:u,RightIconComponent:d,QueryContentComponent:m,onFillButtonClick:p,titleClassName:h}){const g=f.useMemo(()=>t==="ticker"?ole(n):n,[t,n]);return n.length?l.jsxs(l.Fragment,{children:[l.jsx(ile,{show:r.showHeader,text:r.displayName,className:h}),g.map((y,b)=>l.jsx(cle,{suggestion:y,index:b,category:t,categoryConfig:r,value:s,focusedIndex:a,setFocusedIndex:o,handleSubmit:i,indexOffset:c,LeftIconComponent:u,RightIconComponent:d,onFillButtonClick:p,QueryContentComponent:m,highlightPrefix:r.highlightPrefix??!0},`${t}-${y.identifier||y.query_uuid||y.input+y.completion}`))]}):null}),cle=A.memo(function({suggestion:{input:t,completion:n,query_uuid:r,image:s,imageDark:a,url:o="",description:i,identifier:c="",category:u,title:d="",subscribed:m=!1,metadata:p,submission_query:h,inputs_and_completions:g,icon_name:y,shouldShowTitle:b,actionHandler:x,isPersonalized:_},index:v,LeftIconComponent:C,QueryContentComponent:w,RightIconComponent:S,highlightPrefix:E,focusedIndex:T,handleSubmit:k,indexOffset:M,onFillButtonClick:N,setFocusedIndex:P,value:O}){const L=f.useCallback(F=>k({query:F,query_uuid:r,url:o,identifier:c,category:u,description:i,image:s,imageDark:a,title:d,subscribed:m,submission_query:h,isPersonalized:_},v+M),[u,i,k,c,s,a,v,M,r,h,m,d,o,_]),H=f.useCallback(()=>{N(t+n,o)},[n,t,N,o]),R=f.useMemo(()=>l.jsx(C,{image:s,imageDark:a,alt:t+O,url:o,category:u,iconName:y,value:O}),[C,u,y,s,a,t,o,O]),I=f.useMemo(()=>l.jsx(S,{onClick:H,url:o,isSelected:m,metadata:p,category:u}),[S,H,o,m,p,u]);return l.jsx(rle,{onClick:L,query:t,completion:n,inputsAndCompletions:g,url:o,suggestionIndex:v+M,keyboardFocusedIndex:T,setKeyboardFocusedIndex:P,description:i,title:d,shouldShowTitle:b,highlightPrefix:E,className:z("hover:bg-subtler","data-[focused=self]:bg-subtler","dark:data-[focused=self]:bg-subtler","hover:data-[focused=other]:bg-raised","dark:hover:data-[focused=other]:bg-subtler"),category:u,QueryContentComponent:w,metadata:p,leftIcon:R,rightIcon:I,actionHandler:x})}),ule=A.memo(function({image:t,alt:n,url:r,iconName:s,value:a,category:o}){const i=a.length===0,[c,u]=f.useState(!1),{sidecarSourceTab:{url:d}}=Sn(),m=ns(),p=f.useMemo(()=>{if(d&&i)return Oh(d);if(t)return t;if(r)return LC(r)},[t,r,d,i]),h=s?Jie[s]:null,g=i?YX(m):D("search");return o==="shortcuts"&&!s?l.jsx(ye,{icon:D("slash"),size:"sm",className:"mt-two mr-2 w-5 shrink-0"}):fP(r)?l.jsx("div",{className:"mr-2 flex size-5 shrink-0 items-center justify-center",children:l.jsx(ye,{icon:D("custom-perplexity-chart"),size:"sm",className:"text-foreground"})}):p&&!c?l.jsx("div",{className:"relative mr-2 size-5 shrink-0 overflow-hidden rounded-sm",children:l.jsx("img",{src:p,alt:n??"suggestion",className:"object-cover",sizes:"24px",onError:()=>u(!0)})}):l.jsx("div",{className:"flex shrink-0 items-center mr-2 w-5",children:l.jsx(ye,{icon:c&&r?D("world"):h??g,size:"sm"})})}),dle=A.memo(function({onClick:t,url:n,category:r}){return r==="shortcuts"?null:ele(n)?l.jsx("div",{className:"flex h-full items-center",children:l.jsx(ye,{icon:D("chevron-right"),size:"sm",className:"text-quiet"})}):l.jsx("button",{className:"appearance-none inline-flex items-center justify-center",onPointerDown:a=>{a.stopPropagation(),a.preventDefault(),t(a)},type:"button",children:l.jsx(ye,{icon:n?D("world-share"):D("arrow-down-left"),size:"sm"})})}),mP=A.memo(function({isOpen:t,suggestedQueries:n,focusedIndex:r,setFocusedIndex:s,handlePasteQuery:a,handleSubmit:o,dropdownClassName:i,dropdownType:c="query",components:u,value:d,children:m,popoverClassName:p,categoryTitleClassName:h,userInputQuery:g,portalTarget:y,placement:b="bottom",allowNonSequentialMatch:x=!1,renderSettingsRow:_,scrollableShards:v,floatingStrategy:C,shouldEnableStacking:w=!1}){const{session:S}=je(),{trackEvent:E}=Ze(S),{RightIconComponent:T=dle,LeftIconComponent:k=ule,QueryContentComponent:M}=u??{},N=f.useMemo(()=>n.map(({query:J,query_uuid:ne,image:ae,imageDark:de,url:oe,title:le,description:se="",identifier:re="",category:he,subscribed:ie=!1,metadata:ue,submission_query:ce,icon:me,shouldShowTitle:pe,actionHandler:xe,isPersonalized:Oe,focus:Te},we,ke)=>{if(c==="select")return{input:J,completion:"",query_uuid:ne,title:le,image:ae,imageDark:de,url:oe,description:se,identifier:re,category:he,subscribed:ie,submission_query:ce,icon_name:me,shouldShowTitle:pe,actionHandler:xe,isPersonalized:Oe};const Fe=g?r===-1?d:g:d;return Fe.length>0&&J.startsWith(Fe)?{input:Fe,completion:J.slice(Fe.length),query_uuid:ne,title:le,image:ae,imageDark:de,url:oe,category:he,metadata:ue,...(he==="ticker"||he==="news"||Te==="finance"||Te==="sports")&&{description:se},submission_query:ce,icon_name:me,shouldShowTitle:pe,actionHandler:xe,isPersonalized:Oe}:x&&!se&&Fe.length>0&&Fe.length<=J.length&&ke[we]&&dP(Fe,ke[we],!0)[0]?{input:"",completion:J,inputs_and_completions:Zie(Fe,J),query_uuid:ne,title:le,image:ae,url:oe,category:he,metadata:ue,...(he==="ticker"||he==="news"||Te==="finance"||Te==="sports")&&{description:se},submission_query:ce,icon_name:me,shouldShowTitle:pe,actionHandler:xe,isPersonalized:Oe}:{input:J,completion:"",query_uuid:ne,title:le,image:ae,imageDark:de,url:oe,category:he,metadata:ue,...(he==="ticker"||he==="news"||Te==="finance"||Te==="sports")&&{description:se},submission_query:ce,icon_name:me,shouldShowTitle:pe,actionHandler:xe,isPersonalized:Oe}}),[n,d,c,g,r,x]),P=f.useMemo(()=>sle(N),[N]),O=f.useMemo(()=>ale(P),[P]),L=f.useCallback((J,ne)=>{if(ne){window.open(ne,"_blank");return}E("auto suggestion filled",{}),a(J)},[a,E]),H=_?.(),R=n.length>0,I=z("!block w-full",b==="bottom"?"mt-[-5px]":"mb-[-5px]",p),F=b==="bottom"?"rounded-b-2xl":"rounded-t-2xl",G=f.useRef(null),j=t&&n.length>0,$=f.useMemo(()=>({portalTarget:y??void 0,removeScroll:!0,shards:v}),[y,v]),q=f.useMemo(()=>l.jsxs("div",{className:z(fle({hasSuggestions:R,placement:b}),i),children:[b==="top"&&H,j&&l.jsx("div",{ref:G,className:"flex flex-col items-stretch","data-testid":"autosuggestion-container",children:O.map((J,ne)=>{const ae=P[J],de=d_[J]||{order:999,showHeader:!1};let oe=0;for(let le=0;le<ne;le++){const se=O[le]??"";oe+=P[se]?.length||0}return ae?.length?l.jsx(lle,{category:J,suggestions:ae||[],categoryConfig:de,value:d,focusedIndex:r,setFocusedIndex:s,handleSubmit:o,indexOffset:oe,LeftIconComponent:k,RightIconComponent:T,QueryContentComponent:M,onFillButtonClick:L,titleClassName:h},J):null})}),b==="bottom"&&H]}),[b,R,i,H,j,O,P,d,r,s,o,k,T,M,L,h]),U=f.useMemo(()=>C?{strategy:C}:void 0,[C]),X=f.useMemo(()=>w?{className:"flex z-[1]"}:void 0,[w]);return l.jsx(DN,{isOpen:t,matchTargetWidth:!0,disableAnimation:!0,placement:b,childrenClassName:"grow block",contentClassName:I,borderRadius:F,avoidCollisions:!1,disableShadow:!0,overlayProps:$,content:q,floatingElementProps:X,...U&&{customFloatingUIOptions:U},children:m})});function fle({hasSuggestions:e,placement:t}){return z("bg-raised p-3","border-x border-x-subtle",e&&'relative before:absolute before:inset-x-0 before:border-subtlest before:content-[""]',t==="bottom"?z("rounded-b-2xl border-b border-b-subtle",e&&"before:top-0 before:border-t",e&&"shadow-super/10 shadow-md dark:shadow-lg dark:shadow-black/10"):z("rounded-t-2xl border-t border-t-subtle",e&&"before:bottom-0 before:border-b"))}const mle=A.memo(function({text:t}){return l.jsx(B,{variant:"tiny",children:l.jsx("span",{className:"text-caution",children:t})})}),tE=A.memo(function({label:t,labelVariant:n="smallBold",subtitle:r,errorText:s,isOptional:a=!1,withMargin:o=!0,optionalLabel:i="optional",testId:c}){return t||s||r?l.jsxs("div",{className:z({"mb-sm":o}),"data-test-id":c,children:[l.jsxs("div",{className:"flex items-center justify-between",children:[(t||r)&&l.jsx("label",{htmlFor:t,children:l.jsx("div",{className:"gap-y-xs flex flex-col",children:t&&l.jsxs("div",{className:"gap-x-xs flex",children:[l.jsx(B,{variant:n,className:"select-none",children:t}),a&&l.jsx(B,{variant:"small",color:"light",children:`(${i})`})]})})}),s&&l.jsx(mle,{text:s})]}),r&&l.jsx(B,{variant:"small",color:"light",children:r})]}):null});class Zr{static isEnterKey(t){return t.code==="Enter"||t.key==="Enter"||t.keyCode===13}static isEnterKeyWithoutShift(t){return this.isEnterKey(t)&&!t.shiftKey}static isArrowDown(t){return t.key==="ArrowDown"}static isArrowUp(t){return t.key==="ArrowUp"}static isEscapeKey(t){return t.key==="Escape"}static isTabKey(t){return t.key==="Tab"}static isOnlySlashKey(t){return t.key==="/"&&!t.metaKey&&!t.ctrlKey&&!t.altKey}static isCtrlOrCmdJ(t){return(t.metaKey||t.ctrlKey)&&t.key==="j"}}const Xh=(e,t)=>{if(Zr.isEnterKeyWithoutShift(e)){if(t.isComposing||e.keyCode===229){e.preventDefault();return}if(t.isMobileUserAgent||t.allowEnterNewlines)return;e.preventDefault()}t.onKeyDown?.(e)},pP=e=>{e(!0)},hP=e=>{setTimeout(()=>{e(!1)},0)};var qd;(function(e){e.INLINE="inline",e.LABEL="label"})(qd||(qd={}));const ple=({onClear:e})=>l.jsx(pt,{icon:D("x"),pill:!0,onClick:e,size:dl.small}),hle=["email","tel"],xs=A.memo(function({type:t,className:n,wrapperClassName:r,value:s,name:a,maxLength:o,errorText:i,errorPlacement:c=qd.INLINE,disabled:u=!1,required:d=!1,autoFocus:m=!1,placeholder:p="",rightItems:h=_e,onChange:g,onClear:y,onBlur:b,onFocus:x,onPaste:_,onKeyDown:v,isLoading:C,inlineEditBlock:w,label:S,subtitle:E,isOptional:T,isMobileUserAgent:k,labelMargin:M=!0,testId:N,variant:P,disable1pass:O,ClearIcon:L=ple,enterKeyHint:H,size:R,ref:I,colorVariant:F="default",min:G,max:j,spellCheck:$,leadingAccessory:q}){const U=Mo(u),X=f.useRef(null),[J,ne]=f.useState(!1),[ae,de]=f.useState(!1),oe=f.useRef(J);oe.current=J;const le=!!q||t==="search";f.useEffect(()=>{!k&&m&&X.current?.focus()},[k,X,m]),f.useEffect(()=>{U!==u&&!u&&!k&&m&&setTimeout(()=>{X.current?.focus()},200)});const se=f.useMemo(()=>z({"border-r mr-sm pr-xs border-subtler":h.length!=0}),[h.length]),re=f.useMemo(()=>{const ke=(()=>{switch(F){case"default":return"bg-base dark:bg-subtler";case"subtle":return"bg-subtle";default:St(F)}})(),Fe=z("w-full outline-none focus:outline-none focus:ring-subtler font-sans flex items-center","text-foreground caret-super selection:bg-super/50 dark:selection:bg-super/10 dark:selection:text-super",ke,"border border-subtler  focus:ring-1 placeholder-quieter","duration-200 transition-all","rounded-lg",{"ring-subtler ring-1":J},n),ot=z({"py-xs px-sm text-xs placeholder:text-xs":R==="xs","py-sm px-sm text-sm placeholder:text-sm":R==="sm","py-lg px-xl text-lg placeholder:text-base":R==="lg","pl-[36px]":le,"!font-mono md:text-base":P==="monospace","!text-3xl !placeholder:text-3xl !font-medium":P==="page-title","py-sm md:text-sm px-md placeholder:text-sm":!R&&!P}),ge=z({"pr-xs":h.length===0&&R==="xs","pr-sm":h.length===0&&R==="sm","pr-md":h.length===0&&!R,"pr-lg":h.length===0&&R==="lg","pr-[49px] md:pr-[59px]":h.length===1,"pr-[128px] md:pr-[138px]":h.length===2});return z(Fe,ot,ge)},[J,n,R,P,h.length,F,le]),he=!!i,ie=!he&&!!o&&!!s&&s.length>o,ue=f.useMemo(()=>le?l.jsx("div",{className:"absolute left-3 flex items-center",children:l.jsx(B,{color:"light",className:"inline-flex",children:l.jsx(ye,{icon:D(q??"search"),size:"sm"})})}):null,[q,le]),ce=f.useMemo(()=>{const ke=c===qd.INLINE&&he;return l.jsxs("div",{className:"right-sm gap-sm absolute flex items-center rounded-full",children:[C?l.jsx(B,{color:"light",className:"mr-xs",children:l.jsx(To,{})}):null,ke&&l.jsx(Y,{className:"mr-sm",children:l.jsx(B,{color:"red",variant:"tiny",children:i})}),ie&&l.jsx(Y,{className:"mr-sm",children:o&&s&&l.jsx(B,{color:"red",variant:"tiny",children:o-s.length})}),y&&l.jsx("div",{className:se,children:l.jsx(L,{onClear:y,inputValue:s})}),h.map((Fe,ot)=>l.jsx(st,{...Fe.buttonProps,size:Fe.buttonProps.size,disabled:Fe.buttonProps.disabled||he||ie,pill:!0},ot))]})},[c,he,C,i,ie,o,s,y,se,L,h]),me=f.useCallback(()=>{if(X.current){const ke=X.current.value.length;X.current.focus();try{X.current.setSelectionRange(ke,ke)}catch{}}},[]),pe=f.useCallback(ke=>{x?.(ke.nativeEvent),ne(!0)},[x]),xe=f.useCallback(ke=>{b?.(ke.nativeEvent),ne(!1)},[b]);f.useImperativeHandle(I,()=>{const ke=X.current;return ke.focusAtEnd=me,ke.isFocused=()=>oe.current,ke.inLine=()=>!0,ke.append=Fe=>{X.current&&(X.current.value+=Fe)},ke.scrollToEnd=()=>{X.current&&(X.current.scrollTop=X.current.scrollHeight)},ke.trim=()=>{X.current&&(X.current.value=X.current.value.trim())},ke.element=()=>X.current,ke},[me]),f.useEffect(()=>{m&&!k&&me()},[m,me,k]);const Oe=f.useCallback(ke=>{g?.(ke.target.value)},[g]),Te=f.useCallback(ke=>{Xh(ke.nativeEvent,{isMobileUserAgent:k,isComposing:ae,onKeyDown:v})},[v,k,ae]),we=c===qd.LABEL?i:void 0;return l.jsxs("div",{className:r,children:[l.jsx(tE,{label:S,subtitle:E,isOptional:T,errorText:we,withMargin:M}),l.jsx("div",{className:"rounded-full",children:l.jsxs("div",{className:"relative flex items-center",children:[l.jsx("input",{type:t,ref:X,autoFocus:m,placeholder:p,disabled:u,value:s,required:d,name:a??S,onChange:Oe,onKeyDown:Te,onCompositionStart:()=>pP(de),onCompositionEnd:()=>hP(de),onBlur:xe,onFocus:pe,onPaste:_,className:re,autoComplete:hle.includes(t??"")?t:"off","data-test-id":N,"data-1p-ignore":O,enterKeyHint:H,min:G,max:j,spellCheck:$,maxLength:o}),ue,ce]})}),w&&l.jsx("div",{className:"mt-sm flex justify-end",children:w})]})}),hh="external-update",gP="focus",gle="blur",yle=new Set([hh,gP,gle]);function xle(e,t){switch(t.type){case"SET_EXPANDED":return{...e,isExpanded:t.payload};case"SET_ACTIVE":return{...e,isActive:t.payload};case"SET_COMPOSING":return{...e,isComposing:t.payload};default:return e}}const ble=(e,t,n,r,s)=>{f.useEffect(()=>{const a=n?15:40;e&&e.length>a||e?.includes(`
`)?s(!0):r!==(t==="expanded")&&s(t==="expanded")},[e,t,n,r,s])},_le=Pe(async()=>{const{HistoryPlugin:e}=await W(async()=>{const{HistoryPlugin:t}=await import("./lexical-BJvXVOX6.js").then(n=>n.aY);return{HistoryPlugin:t}},__vite__mapDeps([6,2,3,5,1,7,8,9]));return{default:e}}),vle=Pe(async()=>{const{OnChangePlugin:e}=await W(async()=>{const{OnChangePlugin:t}=await import("./lexical-BJvXVOX6.js").then(n=>n.aZ);return{OnChangePlugin:t}},__vite__mapDeps([6,2,3,5,1,7,8,9]));return{default:e}}),Cle=Pe(async()=>{const{EditorRefPlugin:e}=await W(async()=>{const{EditorRefPlugin:t}=await import("./lexical-BJvXVOX6.js").then(n=>n.a_);return{EditorRefPlugin:t}},__vite__mapDeps([6,2,3,5,1,7,8,9]));return{default:e}}),wle=Pe(async()=>{const{default:e}=await W(async()=>{const{default:t}=await import("./lexical-BJvXVOX6.js").then(n=>n.a$);return{default:t}},__vite__mapDeps([6,2,3,5,1,7,8,9]));return{default:e}}),Sle=Pe(async()=>{const{default:e}=await W(async()=>{const{default:t}=await import("./lexical-BJvXVOX6.js").then(n=>n.b0);return{default:t}},__vite__mapDeps([6,2,3,5,1,7,8,9]));return{default:e}}),Ele=Pe(async()=>{const{default:e}=await W(async()=>{const{default:t}=await import("./lexical-BJvXVOX6.js").then(n=>n.b1);return{default:t}},__vite__mapDeps([6,2,3,5,1,7,8,9]));return{default:e}}),kle=Pe(async()=>{const{LinkMarkdownShortcutPlugin:e}=await W(async()=>{const{LinkMarkdownShortcutPlugin:t}=await import("./lexical-BJvXVOX6.js").then(n=>n.b2);return{LinkMarkdownShortcutPlugin:t}},__vite__mapDeps([6,2,3,5,1,7,8,9]));return{default:e}}),yP=({autoFocus:e=!1,placeholder:t="",placeholderClassName:n,disableInput:r=!1,value:s,initialLayout:a="expanded",json:o,minRows:i,onChange:c,onClick:u,onBlur:d,onFocus:m,onKeyDown:p,onPaste:h,isMobileStyle:g,isMobileUserAgent:y,testId:b,id:x,mentionTypeaheadOptions:_=_e,onMentionMenuOpen:v,onMentionMenuClose:C,onTriggerTypeahead:w,variant:S,ref:E})=>{const T=f.useId(),k=f.useRef(null),[M,N]=f.useState(null),{state:P,dispatch:O}=f.useContext(Q0),{isActive:L,isComposing:H,isExpanded:R}=P,I=f.useRef(H),F=f.useRef(L),G=f.useRef(""),j=f.useRef(null),$=f.useRef(e),q=f.useRef(null),U=f.useRef(c),X=f.useRef(u),J=f.useRef(d),ne=f.useRef(m),ae=f.useRef(p),de=f.useRef(h);U.current=c,X.current=u,J.current=d,ne.current=m,ae.current=p,de.current=h,I.current=H,F.current=L,$.current=e;const oe=Mo(r),le=f.useMemo(()=>z(Dr.inputWrapper.base,{[Dr.inputWrapper.expanded.join(" ")]:R,[Dr.inputWrapper.compact.join(" ")]:!R}),[R]),se=f.useMemo(()=>z(...Dr.inputElement,"size-full"),[]),re=f.useMemo(()=>z(...Dr.placeholder.base,{[Dr.placeholder.compact]:!R},n),[R,n]),he=f.useCallback(Ee=>O({type:"SET_EXPANDED",payload:Ee}),[O]),ie=f.useCallback(Ee=>O({type:"SET_ACTIVE",payload:Ee}),[O]),ue=f.useCallback(Ee=>O({type:"SET_COMPOSING",payload:Ee}),[O]),ce=f.useCallback(Ee=>{Z.error(Ee)},[]),me=f.useCallback(Ee=>{ne.current?.(Ee),ie(!0)},[ie]),pe=f.useCallback(Ee=>{J.current?.(Ee)!==!1&&ie(!1)},[ie]),xe=f.useCallback(Ee=>{de.current?.(Ee)},[]),Oe=f.useCallback(Ee=>{X.current?.(Ee)},[]),Te=f.useCallback((Ee,et,xt)=>{const Ut=[...xt];let Tt;Ut.length>0&&Ut.every(gn=>yle.has(gn))||(Tt===void 0&&(Tt=Zu(Ee.toJSON())),G.current=Tt??"",j.current=Ee.toJSON(),U.current?.(G.current,j.current))},[]),we=f.useCallback(()=>ue(!0),[ue]),ke=f.useCallback(()=>ue(!1),[ue]),Fe=f.useCallback(Ee=>{Xh(Ee,{isMobileUserAgent:y,isComposing:I.current,onKeyDown:ae.current})},[y]),ot=f.useCallback(()=>M?.update(()=>{Mx(gP),Xl().selectEnd()}),[M]),ge=f.useCallback(Ee=>M?.update(()=>{const et=Xl(),xt=et.getLastChild();if(Ju(xt)){const Ut=q5(Ee);xt.append(Ut),et.selectEnd()}}),[M]),Ce=f.useCallback(()=>M?.update(()=>{const et=Xl().getLastChild();if(Ju(et)){const xt=et.getFirstChild();if(ed(xt)){const Tt=xt.getTextContent(),gn=Tt.trimStart();Tt.length-Tt.trimStart().length&&xt.spliceText(0,Tt.length,gn,!0)}const Ut=et.getLastChild();if(ed(Ut)){const Tt=Ut.getTextContent(),gn=Tt.trimEnd();Tt.length-gn.length&&Ut.spliceText(0,Tt.length,gn,!0)}}}),[M]),Ae=f.useCallback(Ee=>M?M.getEditorState().read(()=>{const et=va();if(!Ca(et))return!0;if(!et.isCollapsed())return!1;const xt=window.getSelection();if(!xt||xt.rangeCount===0)return!0;const Ut=xt.getRangeAt(0);let Tt=Ut.getBoundingClientRect();if(Tt.width===0&&Tt.height===0){const br=document.createTextNode("");Ut.insertNode(br),Tt=Ut.getBoundingClientRect(),br.remove()}const gn=M.getElementByKey(Xl().getFirstChild()?.getKey()??"")?.getBoundingClientRect();if(!gn)return!0;const ir=4;return Ee==="first"?Math.abs(Tt.top-gn.top)<=ir:Math.abs(Tt.bottom-gn.bottom)<=ir}):!0,[M]),He=f.useCallback(()=>{v?.()},[v]),rt=f.useCallback(()=>{C?.()},[C]),Ft=f.useCallback(Ee=>{M||Oe(Ee.nativeEvent)},[M,Oe]);f.useImperativeHandle(E,()=>({append:ge,trim:Ce,focusAtEnd:ot,isFocused:()=>F.current,inLine:Ae,focus:()=>M?.focus(),blur:()=>M?.blur(),scrollIntoView:Ee=>M?.getRootElement()?.scrollIntoView(Ee),scrollToEnd:()=>M?.getRootElement()?.scrollIntoView({block:"end",behavior:"auto"}),element:()=>k?.current,get scrollHeight(){return M?.getRootElement()?.scrollHeight??0},get value(){return Zu(M?.getEditorState()?.toJSON())},set value(Ee){throw new Error("setValue is not supported in Lexical")},get json(){return M?.getEditorState().toJSON()}}),[ge,ot,Ce,M,Ae]),ble(s,a,g,R,he),f.useEffect(()=>{!y&&M&&e&&(requestAnimationFrame(ot),ie(!0))},[y,e,ie,M,ot]),f.useEffect(()=>{oe!==r&&!r&&!y&&e&&setTimeout(()=>ot(),200)}),f.useEffect(()=>M?.registerRootListener((Ee,et)=>{Ee&&(Ee.addEventListener("focus",me),Ee.addEventListener("blur",pe),Ee.addEventListener("compositionstart",we),Ee.addEventListener("compositionend",ke),Ee.addEventListener("keydown",Fe),Ee.addEventListener("paste",xe),Ee.addEventListener("click",Oe)),et&&(et.removeEventListener("focus",me),et.removeEventListener("blur",pe),et.removeEventListener("compositionstart",we),et.removeEventListener("compositionend",ke),et.removeEventListener("keydown",Fe),et.removeEventListener("paste",xe),et.removeEventListener("click",Oe))}),[pe,Oe,ke,me,Fe,xe,we,M]),f.useLayoutEffect(()=>{M&&M.setEditable(!r)},[r,M]),f.useLayoutEffect(()=>{M&&(s&&o&&!Ff(o,j.current)?Promise.resolve().then(()=>{M.setEditorState(M.parseEditorState(o),{tag:hh}),$.current&&ot(),j.current=M.getEditorState().toJSON(),G.current=Zu(j.current)}):s&&G.current!==s?(M.update(()=>{Mx(hh);const Ee=Xl();Ee.clear(),$5?W5(s):Ee.append(q5(s)),$.current&&Ee.selectEnd()},{discrete:!0}),j.current=M.getEditorState().toJSON(),G.current=Zu(j.current)):!s&&G.current!==s&&(M.update(()=>{Mx(hh);const Ee=Xl();Ee.clear(),$.current?Ee.selectEnd():M.getRootElement()!==document.activeElement&&K5(null)},{discrete:!0}),j.current=M.getEditorState().toJSON(),G.current=Zu(j.current)))},[s,o,M,ot]),f.useEffect(()=>{const Ee=M?.registerCommand(Tx,lt=>{const mt=va();if(Ca(mt)&&mt.isCollapsed()){const At=mt.anchor,Vt=At.getNode(),dt=jt=>{let Gt=jt,fe=Gt.getParent();for(;fe&&!Ju(fe)&&!nk(fe);)Gt=fe,fe=Gt.getParent();return Gt},en=jt=>!jt||!td(jt)||!jt.isIsolated()?!1:(jt.remove(),!0);if(Ju(Vt)){const Gt=mt.getNodes()[0];if(lt){if(Gt){if(Gt.getNextSibling()===null&&en(Gt))return!0;const fe=Gt.getPreviousSibling();if(en(fe))return!0}}else if(en(Gt))return!0}else if(Vt){const jt=dt(Vt);if(lt){if(At.offset===0){const fe=jt.getPreviousSibling();if(en(fe))return!0}}else{const Gt=ed(Vt)?Vt.getTextContentSize():0;if(At.offset===Gt){const De=jt.getNextSibling();if(en(De))return!0}}}}return Ca(mt)?(mt.deleteCharacter(lt),!0):Ax(mt)?(mt.deleteNodes(),!0):!1},lo),et=M?.registerCommand(nW,lt=>{const mt=va();return Ca(mt)?(mt.deleteWord(lt),!0):!1},lo),xt=M?.registerCommand(rW,lt=>{const mt=va();return Ca(mt)?(mt.deleteLine(lt),!0):!1},lo),Ut=M?.registerCommand(sW,()=>{const lt=va();return Ca(lt)?(lt.removeText(),!0):!1},lo),Tt=M?.registerCommand(aW,lt=>{const mt=va();if(typeof lt=="string")mt!==null&&mt.insertText(lt);else{if(mt===null)return!1;const At=lt.dataTransfer;if(At!==null)Y5(At,mt,M);else if(Ca(mt)){const Vt=lt.data;return Vt&&mt.insertText(Vt),!0}}return!0},lo),gn=M?.registerCommand(oW,lt=>{if("clipboardData"in lt){const At=lt.clipboardData?.getData("text/plain");if(At&&At.length>Qi)return lt.preventDefault(),!0}const mt=va();return Ca(mt)?(lt.preventDefault(),M.update(()=>{const At=va(),Vt=Q5(lt,InputEvent)||Q5(lt,KeyboardEvent)?null:"clipboardData"in lt?lt.clipboardData:null;if(Vt&&At){const{types:dt}=Vt;if(dt.includes("text/html")||dt.includes("application/x-lexical-editor")||Vt.files.length>0||!$5)Y5(Vt,At,M);else{const en=At.clone(),jt=X5();W5(Vt.getData("text/plain"),jt);const Gt=[];jt.getChildren().forEach(fe=>{Ju(fe)?(Gt.length&&Gt.push(Z5()),fe.getChildren().forEach(De=>{(ed(De)||td(De)||J5(De)||ek(De))&&Gt.push(De)})):Gt.push(fe)}),K5(en),iW(M,Gt,en)}}},{tag:lW}),!0):!1},lo),ir=M?.registerCommand(cW,lt=>{const mt=tk(lt.target);if(td(mt))return!1;const At=va();if(Ca(At)){const{anchor:Vt}=At,dt=Vt.getNode();if(At.isCollapsed()&&Vt.offset===0&&!nk(dt)&&uW(dt).getIndent()>0)return lt.preventDefault(),M.dispatchCommand(dW,void 0);if(fW&&navigator.language==="ko-KR")return!1}else if(!Ax(At))return!1;return lt.preventDefault(),M.dispatchCommand(Tx,!0)},lo),br=M?.registerCommand(mW,lt=>{const mt=tk(lt.target);if(td(mt))return!1;const At=va();return Ca(At)||Ax(At)?(lt.preventDefault(),M.dispatchCommand(Tx,!1)):!1},lo);return M?.registerNodeTransform(pW,lt=>{lt.getFormat()!==0&&lt.setFormat(0)}),M?.registerNodeTransform(hW,lt=>{if(lt.getChildrenSize()>1){const mt=lt.getChildren(),At=X5();mt.forEach(Vt=>{gW(Vt)&&(At.getChildren().length&&At.append(Z5()),Vt.getChildren().forEach(dt=>{(ed(dt)||td(dt)||J5(dt)||ek(dt))&&At.append(dt)}))}),lt.clear().append(At).selectEnd()}}),M?.registerNodeTransform(yW,lt=>{const mt=lt.getParent();mt instanceof xW&&(lt.getChildren().forEach(Vt=>{mt.append(Vt)}),lt.remove())}),()=>{Ee?.(),et?.(),xt?.(),Ut?.(),Tt?.(),gn?.(),ir?.(),br?.()}},[M,xe]),f.useEffect(()=>{const Ee=M?.registerCommand(bW,et=>!et||q.current&&!q.current.canSubmit()?!1:(Xh(et,{isMobileUserAgent:y,isComposing:I.current,onKeyDown:ae.current}),et.defaultPrevented),lo);return()=>{Ee?.()}},[M,rt,y]);const Qt=f.useMemo(()=>({namespace:T,onError:ce,nodes:S==="pplxtext"?_W:_e,theme:{link:"text-super hover:underline",text:{strikethrough:"line-through"}},editable:!r}),[T,ce,r,S]),Ye=f.useMemo(()=>({minHeight:`${(i??1)*1.5}em`}),[i]),We=f.useMemo(()=>l.jsx("div",{className:re,children:t}),[t,re]),it=f.useMemo(()=>l.jsx(vW,{className:se,"aria-placeholder":t,placeholder:We,"data-test-id":b,id:x}),[x,t,We,se,b]);return f.useMemo(()=>l.jsx("div",{className:le,children:l.jsx("div",{className:"w-full",style:Ye,ref:k,onClick:Ft,children:l.jsxs(CW,{initialConfig:Qt,children:[l.jsx(wW,{contentEditable:it,ErrorBoundary:ar}),l.jsx(_le,{}),l.jsx(vle,{onChange:Te,ignoreSelectionChange:!0}),l.jsx(Cle,{editorRef:N}),S==="pplxtext"&&l.jsxs(l.Fragment,{children:[l.jsx(wle,{ref:q,onClose:rt,onOpen:He,options:_,onTrigger:w}),l.jsx(Sle,{}),l.jsx(Ele,{}),l.jsx(SW,{}),l.jsx(kle,{})]})]})})}),[le,Ye,Ft,Qt,it,Te,rt,He,_,w,S])},Mle=e=>l.jsx(yP,{...e,variant:"plaintext"}),xP=e=>l.jsx(yP,{...e,variant:"pplxtext"}),Tle=A.memo(function({quote:t,onClear:n}){return t?l.jsx("div",{className:"py-sm bg-subtler dark:bg-base animate-slideDownAndFadeIn z-[49] mx-3 rounded-lg px-3",children:l.jsxs("div",{className:"gap-sm flex items-start",children:[l.jsx(B,{color:"light",className:"mt-px flex items-center pt-1",variant:"tinyRegular",children:l.jsx(ye,{icon:D("quote-filled"),size:"xs",className:"rotate-180"})}),l.jsx(B,{lineClamp:3,className:"py-xs flex-1 overflow-hidden text-ellipsis",variant:"tinyRegular",color:"light",children:t}),l.jsx("div",{className:"shrink-0",children:l.jsx(pt,{icon:D("x"),onClick:n,size:"tiny",pill:!0,toolTip:"Clear quote"})})]})}):null});function z4(e){return!!(e.closest("button")||e.closest("a")||e.closest('[role="link"]')||e.closest('[role="button"]')||e.closest('[role="menuitem"]')||e.closest('[role="menuitemcheckbox"]'))}const bP=A.memo(function({initialLayout:t="expanded",wrapperClass:n,size:r,hasShadow:s,isMobileUserAgent:a,quote:o,setQuote:i,attachmentsList:c,inputWarnings:u,children:d,inputRef:m,ref:p}){const[h,g]=f.useReducer(xle,{isExpanded:t==="expanded",isActive:!1,isComposing:!1}),{isActive:y,isExpanded:b}=h,x=f.useMemo(()=>{const w=uie({isActive:y}),S=die({hasShadow:s,hasQuote:!!o});return z(...Dr.outerWrapper.base,Dr.outerWrapper.darkMode,Dr.outerWrapper.transition,n,w,S,{"px-0 pt-3 pb-3":r==="large"&&b,"py-sm px-0":r==="large"&&!b})},[y,n,s,o,r,b]),_=f.useCallback(w=>{if(a)return;const S=w.target;z4(S)||m?.current?.focus()},[m,a]),v=f.useCallback(w=>{if(a)return;const S=w.target;if(z4(S))return;const E=m?.current?.element();E&&S!==E&&!E.contains(S)&&w.preventDefault()},[m,a]),C=f.useCallback(()=>i?.(null),[i]);return l.jsx(Q0.Provider,{value:{state:h,dispatch:g},children:l.jsx("div",{className:"relative rounded-2xl",ref:p,onClick:_,onMouseDownCapture:v,children:l.jsxs("div",{className:z(x,"gap-y-md grid items-center"),children:[(u||o||c)&&l.jsxs("div",{className:z({"pt-xs":!b},"gap-y-sm grid items-center"),children:[u,o&&l.jsx(Tle,{quote:o,onClear:C}),c]}),l.jsx("div",{className:z({"px-3":r==="large"&&!b,"px-3.5":r==="large"&&b,flex:!b,"grid-rows-1fr-auto grid grid-cols-3":b}),children:d})]})})})}),Ale=A.memo(function({value:t,suggestDropdownProps:n,ResizeableInputWrapperProps:r,ResizeableInputProps:s,leftAttributionComponents:a,rightAttributionComponents:o,syncUncontrolledOnce:i}){const c=s.onChange,u=s.ref,d=f.useRef(null),m=f.useRef(t);m.current=t;const p=f.useRef(null),h=f.useRef(!1),g=f.useCallback(y=>{d.current=y,u instanceof Function?u(y):u&&(u.current=y)},[u]);return f.useEffect(()=>{const y=d.current?.value;y&&y!==m.current&&(!i||!h.current)&&c?.(y),i&&(h.current=!0)},[c,i]),mu("ask-input"),l.jsx(mP,{...n,floatingStrategy:"absolute",shouldEnableStacking:!0,portalTarget:p.current??void 0,value:t,children:l.jsxs(bP,{...r,ref:p,children:[l.jsx(xP,{...s,ref:g}),a,o]})})});class Nle{static isAnyInputElementFocused(){const t=document.activeElement;return!!(t&&(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.getAttribute("contenteditable")==="true"||t.getAttribute("role")==="textbox"))}}function Rle({value:e,json:t,isDisabled:n,handleSubmit:r,handleSuggestDropdownNavigation:s,querySource:a,focusInput:o,isInputActive:i}){const{isMobileUserAgent:c}=Be(),u=f.useRef(e),d=f.useRef(t);u.current=e,d.current=t;const m=f.useCallback(b=>n&&Zr.isEnterKeyWithoutShift(b)?(b.preventDefault(),!0):!1,[n]),p=f.useCallback(b=>b.isComposing?(b.preventDefault(),!0):!1,[]),h=f.useCallback(b=>{Zr.isEnterKeyWithoutShift(b)&&!c&&(b.preventDefault(),r({query:u.current,json:d.current,querySource:a}))},[r,a,c]),g=f.useCallback(b=>{const x=Zr.isCtrlOrCmdJ(b),_=Zr.isOnlySlashKey(b);if(x||_){if(i||Nle.isAnyInputElementFocused())return;b.preventDefault(),o()}},[o,i]);return f.useEffect(()=>(document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}),[g]),f.useCallback(b=>{m(b)||p(b)||s(b)||h(b)},[m,p,s,h])}const Dle=(e,t)=>{const{value:n,loading:r}=Lt({flag:"clear-ask-input-suggestions-when-disabled",defaultValue:e,extraAttributes:t,subjectType:"visitor_id"});return f.useMemo(()=>({variation:n,loading:r}),[n,r])};function Ile({handleSubmit:e,inputQuery:t}){const{session:n}=je(),{trackEvent:r}=Ze(n),s=f.useRef(t);s.current=t;const a=ns(),{sidecarSourceTab:{url:o}}=Sn();return f.useCallback((c,u)=>{const d=wo();if(r("auto suggestion accepted",{mode:"dropdown-complete",query:s.current,completion:c.query,completion_uuid:c.query_uuid,completion_position:u,url:c.url,isNavigational:!!c.url,frontendContextUUID:d,searchMode:a,isPersonalized:c.isPersonalized,sourceDomain:ys(o)}),c.isPersonalized&&fetch("/rest/autosuggest/track-query-clicked",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:c.query,search_mode:a})}).catch(()=>{}),c.url){window.open(c.url,"_self");return}e({query:c.submission_query??c.query,promptSource:"autosuggest",querySource:"autosuggest",newFrontendContextUUID:d})},[e,a,r,o])}function jle({inputQuery:e}){const{session:t}=je(),{trackEventBatch:n}=Ze(t),r=f.useRef(e);r.current=e;const s=ns(),{sidecarSourceTab:{url:a}}=Sn();return f.useCallback(i=>{if(r.current.length!==0)return;const c=i.map((u,d)=>({name:"auto suggestion blank state viewed",data:{mode:"dropdown-complete",query:r.current,completion:u.query,completion_uuid:u.query_uuid,completion_position:d,url:u.url,isNavigational:!!u.url,searchMode:s,sourceDomain:ys(a)}}));n(c)},[s,n,a])}const _P=e=>Se.makeQueryKey("/rest/tasks/{task_id}",e),gh=e=>Se.makeQueryKey("/rest/tasks/"),Ple=e=>e!==void 0?Se.makeQueryKey("/rest/spaces/{space_uuid}/tasks",e):Se.makeQueryKey("/rest/spaces/{space_uuid}/tasks"),Ole=()=>Se.makeQueryKey("/rest/tasks/shortcuts/mentions"),SYe=e=>Se.makeQueryKey("/rest/tasks/shortcuts/copy/{shortcut_id}",e),vP=Ct({productionMs:3e3}),EYe=Ct({productionMs:5e3}),Lle=async({reason:e,headers:t})=>{const{data:n,error:r,response:s}=await ve.GET("/rest/tasks/shortcuts/mentions",e,{params:{query:{order_by:"created_at"}},timeoutMs:vP,numRetries:wi,headers:t});if(r)throw Z.error("Failed to get shortcut typeahead options",r),new Ue("API_CLIENTS_ERROR",{cause:r,status:s.status??0});return n},CP=({reason:e,...t})=>{const n=wt();return gt({queryKey:Ole(),queryFn:async()=>{const{tasks:r}=await Lle({reason:e});return r},...t,enabled:n&&(t.enabled??!0)})},Fle=async({sources:e,attachments:t,searchMode:n,sourceTabUrl:r,entropyRenderingPlace:s,reason:a})=>{try{if(t&&t.length>0)return _e;if(e.length===0)return _e;const{data:o,error:i,response:c}=await ve.POST("/rest/autosuggest/list-autosuggest",a,{body:{query:"",sources:e,attachments:t,search_mode:n,source_tab_url:r,entropy_rendering_place:s}});if(i)throw new Ue("API_CLIENTS_ERROR",{cause:i,status:c.status??0});return o.results??_e}catch(o){return Z.error(o),_e}},Ule=async({query:e,reason:t,country:n})=>{try{const{data:r,error:s,response:a}=await ve.GET("/rest/autosuggest/finance/list-autosuggest",t,{params:{query:{query:e,country:n}},timeoutMs:0});if(s)throw new Ue("API_CLIENTS_ERROR",{cause:s,status:a.status??0});return r.results??_e}catch(r){return Z.error(r),[]}},Ble=(e,t)=>{const{value:n,loading:r}=Lt({flag:"sidecar-personalized-query-suggestions",defaultValue:e,extraAttributes:t,subjectType:"visitor_id"});return f.useMemo(()=>({variation:n,loading:r}),[n,r])},nE="sidecar-personalized-queries-cache",f_=1e3*60*10,Hle="sidecar";function Vle(e){try{let n=new URL(e).hostname.toLowerCase();return n.startsWith("www.")&&(n=n.slice(4)),n}catch{return""}}function Gle(){try{const e=yt.getItem(nE);if(e)return JSON.parse(e)}catch{}return null}function zle(e){yt.setItem(nE,JSON.stringify(e))}async function qle(e,t,n){if(e!==null&&e.nonce!==null&&e.timestamp>n-f_&&e.domain_suggestions.length>0)return{nonce:e.nonce,domain_suggestions:e.domain_suggestions};const{data:r,error:s}=await ve.POST("/rest/browser/personalization/sidecar-recommended-queries",Hle,{body:{last_refresh_timestamp_ms:e?.timestamp??0,nonce:e?.nonce??"",history_items:t},timeoutMs:3e4});return s?(Z.error("Failed to fetch sidecar personalized queries:",s),{domain_suggestions:[],nonce:""}):r?.domain_suggestions===null||!r?.domain_suggestions?{domain_suggestions:e?.domain_suggestions??[],nonce:e?.nonce??""}:r}function $le(e,t){const n=e.find(r=>r.domain===t);return n?n.suggestions.map(r=>({query:r.query})):[]}const Wle=14,Kle=1500,Yle=(e,t)=>{const{session:n}=je(),r=Xt(!1),s=Vle(e),{variation:a,loading:o}=Ble(!1,{userEmail:n?.user?.email??""}),i=Gle(),{data:c}=gt({queryKey:Se.makeQueryKey("sidecar-personalized-queries",t,a,o),queryFn:async()=>{if(!r||!e||!t)return[];if(!a)return o||yt.removeItem(nE),[];const u=Date.now();if(i&&i.domain_suggestions.length>0&&u-i.timestamp<f_)return i.domain_suggestions;try{const m=((await r.SearchBrowser({queries:[],sources:["HISTORY"],key:"sidecar-personalized-suggestions-history",request_id:"sidecar-personalized-suggestions",start_time:Wle*24*60*60*1e3,history_max_results:Kle,open_tabs_max_results:0,closed_tabs_max_results:0})).history_results??[]).map(g=>({url:g.url,title:g.title,last_accessed:g.last_accessed,visit_count:g.visit_count})),p=await qle(i,m,u),h={nonce:p.nonce,timestamp:u,domain_suggestions:p.domain_suggestions};return h.domain_suggestions.length>0&&zle(h),p.domain_suggestions}catch(d){return Z.error(d),i?.domain_suggestions??[]}},placeholderData:()=>t?i?.domain_suggestions??[]:[],refetchInterval:f_,enabled:t});return $le(c??[],s)},Qle=({sources:e,attachments:t,searchMode:n,focus:r,isCometHome:s,reason:a,enabled:o})=>{const{sidecarSourceTab:{url:i}}=Sn(),u=nl().erp,{isMobileUserAgent:d}=Be(),m=Xt(),{isIncognito:p}=f0({reason:a}),{data:h}=CP({reason:a}),g=Yle(i||"",u==="sidecar"),y=f.useMemo(()=>s&&n===K.SEARCH?Se.makeEphemeralQueryKey("comet-blank-state-suggest",p,n,!0,h):r==="finance"?Se.makeEphemeralQueryKey("finance-blank-state-suggest",p):Se.makeEphemeralQueryKey("blank-state-suggest",p,e,t,n,u==="sidecar"?i:""),[e,t,n,r,s,p,i,u,h]);return gt({queryKey:y,enabled:o,placeholderData:Ja,queryFn:async()=>{if(r==="finance")return(await Ule({query:"",reason:a,country:"US"})).map((C,w)=>({query:C.query||`suggestion-${w}`,title:C.title??void 0,image:C.image??void 0,description:C.description??void 0,category:C.category??void 0,query_uuid:C.query_uuid??void 0,url:C.url??void 0,metadata:C.metadata??void 0}));const[b,x]=await Promise.all([Fle({sources:e,attachments:t,searchMode:n,sourceTabUrl:u==="sidecar"?i:"",entropyRenderingPlace:u,reason:a}),u==="sidecar"?$$({entropyBrowser:m,url:i}):Promise.resolve([])]);return[...g.map(_=>({..._,isPersonalized:!0})),...x,...b].slice(0,zd(d))}})},Xle=e=>{const{setSuggestions:t,setBlankStateSuggestions:n}=Fs(),{sidecarSourceTab:{url:r,secondaryTab:s}}=Sn(),o=nl().erp,i=f.useRef(void 0),c=f.useRef(e.selectedSearchMode),u=f.useRef(!1),d=r?ys(r):void 0,m=f.useMemo(()=>{if(e.suggestionsDisabled)return!0;const h=o==="sidecar";return h&&d&&d===i.current||h&&s},[e.suggestionsDisabled,o,d,s]);!m&&i.current!==d&&(i.current=d);const{data:p}=Qle({...e,searchMode:e.selectedSearchMode,enabled:!m});return f.useEffect(()=>{m?n(_e,e.selectedSearchMode):p&&n(p,e.selectedSearchMode)},[e.selectedSearchMode,n,m,p]),f.useEffect(()=>{(e.query?.length??0)>0||p&&(o==="sidecar"||u.current||c.current!==e.selectedSearchMode)&&(t(p),u.current=!0)},[e.query,e.selectedSearchMode,p,t,o]),null};function wP({userInputQuery:e,userInputJson:t,suggestionsDisabled:n,suggestions:r,focusedIndex:s,setFocusedIndex:a,onChange:o,handleSuggestionSubmission:i,placement:c="bottom",inputRef:u}){const d=f.useRef(e),m=f.useRef(t),p=f.useRef(r),h=f.useRef(s);d.current=e,m.current=t,p.current=r,h.current=s,r.forEach(v=>v);const g=f.useCallback((v,C)=>{if(C>0){const w=(h.current+1)%C,S=p.current[w];if(S?.query){const E=S.query;o(E)}return v.preventDefault(),w}return null},[o]),y=f.useCallback(v=>{let C=h.current-1;if(C<0)C=-1,h.current===0&&(v.preventDefault(),o(d.current,m.current));else{v.preventDefault();const w=p.current[C];if(w?.query){const S=w.query;o(S)}}return C},[o]),b=f.useCallback((v,C)=>{if(C>0){const w=h.current<=0?C-1:(h.current-1)%C,S=p.current[w];if(S?.query){const E=S.query;o(E)}return v.preventDefault(),w}return null},[o]),x=f.useCallback((v,C)=>{let w=h.current+1;if(w>=C||w===0)w=-1,h.current===C-1&&(v.preventDefault(),o(d.current,m.current));else{v.preventDefault();const S=p.current[w];if(S?.query){const E=S.query;o(E)}}return w},[o]);return f.useCallback(v=>{if(n)return!1;const C=Zr.isArrowDown(v),w=Zr.isArrowUp(v);if(C){if(c==="bottom"&&h.current===-1&&!u.current?.inLine("last"))return!1;const S=c==="bottom"?g(v,p.current.length):x(v,p.current.length);if(S!==null)return a(S),!0}else if(w){if(c==="top"&&h.current===-1&&!u.current?.inLine("first"))return!1;const S=c==="bottom"?y(v):b(v,p.current.length);if(S!==null)return a(S),!0}else if(Zr.isEnterKeyWithoutShift(v)&&h.current>=0&&h.current<p.current.length){const S=p.current[h.current];if(S)return i(S,h.current),!0}return!1},[n,c,u,g,x,a,y,b,i])}const Zle=e=>e==="travel"||e==="shopping"||e==="academic"||e==="patents"||e==="sports"||e==="language-learning",Jle=({autosuggestionsEnabled:e=!0,inputQuery:t,inputJson:n,isInputActive:r,onChange:s,handleSuggestionSubmission:a,handleSuggestionView:o,querySource:i,hasThreadContent:c,isMentionMenuOpened:u,placement:d="bottom",inputRef:m})=>{const[p,h]=f.useState(-1),[g,y]=f.useState(t),[b,x]=f.useState(n),_=sr(),[v]=ml("isSuggestionsDisabled",!1),C=AS(),w=VZ(_),S=zZ(_),{activeMenu:E,suggestions:T}=Fr(),{setSuggestions:k,setShowSuggestDropdown:M}=Fs(),N=f.useMemo(()=>v||!e||!C&&!w&&!S&&!Zle(i)&&!1||i!=="finance"&&t.length>qie&&!T.some(({query:O})=>O===t)||c,[v,e,C,w,S,i,t,c,T]),P=wP({userInputQuery:g,userInputJson:b,suggestionsDisabled:N,suggestions:T,focusedIndex:p,setFocusedIndex:h,onChange:s,handleSuggestionSubmission:a,placement:d,inputRef:m});return f.useEffect(()=>{p===-1&&(y(t),x(n))},[t,p,n]),f.useEffect(()=>{N&&(k(_e),h(-1))},[N,k,h]),f.useEffect(()=>{const O=!N&&r&&!E&&T.length>0&&!u;M(O),O&&o(T)},[N,r,E,T,u,M,o]),f.useMemo(()=>({focusedIndex:p,setFocusedIndex:h,suggestionsDisabled:N,userInputQuery:g,handleSuggestDropdownNavigation:P,placement:d}),[p,P,N,g,d])};function ece({value:e,json:t,querySource:n,disableSubmission:r=!1,disableInput:s=!1,autofocus:a=!0,isUploadingFile:o=!1,onChange:i,onFocus:c,onBlur:u,handleSubmit:d,handleUpdateAutosuggestions:m,autosuggestionsEnabled:p=!0,errorMessage:h,sources:g,attachments:y,selectedSearchMode:b,isInputActive:x,setIsInputActive:_,updateOnFocus:v=!1,inFlight:C=!1,resultsLength:w=0,quote:S,isMentionMenuOpened:E,isCometHome:T=!1,reason:k,placement:M="bottom"}){const{activeMenu:N,inputRef:P}=Fr(),O=NJ(),{setShouldTriggerFocus:L}=p0(),{blankStateSuggestions:H}=Fr(),{setSuggestions:R}=Fs(),{onActiveMenuChange:I}=Fs(),{device:{isAndroid:F}}=jn(),{compareModels:G}=En(),j=f.useMemo(()=>!!S||e.trim().length>0||!!y&&y.length>0,[S,e,y]),$=b===K.AGENTIC_RESEARCH&&G.length<2,q=r||s||!!h||o||!j||$,U=f.useCallback(me=>{const{mentions:pe}=GD(t?.root);d({...me,mentions:pe.length>0?pe:void 0})},[t,d]),X=Ile({handleSubmit:U,inputQuery:e}),J=jle({inputQuery:e}),{focusedIndex:ne,setFocusedIndex:ae,suggestionsDisabled:de,userInputQuery:oe,handleSuggestDropdownNavigation:le}=Jle({autosuggestionsEnabled:p,inputQuery:e,inputJson:t,isInputActive:x&&p,onChange:i,handleSuggestionView:J,handleSuggestionSubmission:X,querySource:n,hasThreadContent:C||w>0,isMentionMenuOpened:E,placement:M,inputRef:P});Xle({sources:g,attachments:y,selectedSearchMode:b,suggestionsDisabled:de,focus:n==="finance"?"finance":void 0,query:e,isCometHome:T,reason:k});const se=f.useCallback(()=>{P.current?.focus(),_(!0)},[P,_]),re=f.useCallback(me=>{c?.(me),_(!0),I(null),v&&m(P.current?.value??""),F&&setTimeout(()=>{P.current?.scrollIntoView({behavior:"smooth",block:"center"})},300)},[c,I,m,_,v,P,F]);f.useEffect(()=>{O&&a&&(se(),L(!1))},[O,se,L,a]);const he=f.useCallback(()=>(u?.(),_(!1),ae(-1),!0),[u,ae,_]),{variation:ie}=Dle(!1),ue=f.useCallback((me,pe)=>{if(i(me,pe),de){ie&&R([]);return}me.trim().length===0&&H[b]?(R(H[b]),m(me)):Yie(me)&&m(me)},[i,de,m,H,R,b,ie]),ce=Rle({value:e,json:t,isDisabled:q,handleSubmit:U,handleSuggestDropdownNavigation:le,querySource:n,focusInput:se,isInputActive:x});return f.useEffect(()=>{N!==null?P.current?.blur():a&&se()},[N,P,se,a]),f.useMemo(()=>({isDisabled:q,focusedIndex:ne,setFocusedIndex:ae,userInputQuery:oe,handleSuggestionSubmission:X,handleFocus:re,handleBlur:he,handleChange:ue,handleKeyDown:ce,focusInput:se,hasQuery:j}),[se,ne,he,ue,re,ce,X,j,q,ae,oe])}const tce=({fileUploadRef:e,fileHandlingRef:t,showFileUpload:n,attachments:r,setAttachments:s,handleChange:a,setIsUploadingFile:o,focusInput:i,onFileAttachComplete:c})=>{const{inputRef:u}=Fr(),d=nS(),[m,p]=f.useState(null),h=f.useCallback(v=>{const C=r===void 0?"paste.txt":`paste-${r.length+1}.txt`,w=new File([v],C,{type:"text/plain"}),S=new DataTransfer;S.items.add(w),p({content:v,fileName:C}),e.current?.uploadFiles(S.files)},[r,e]),g=f.useCallback(()=>{p(null)},[]);f.useImperativeHandle(t,()=>({clearAutoCreatedTextFile:g}),[g]);const y=f.useCallback(v=>{const C=v.clipboardData;if(C&&C.items.length>0){const w=new DataTransfer;for(const S of C.items){if(S.kind==="file"){v.preventDefault();const E=S.getAsFile();E&&w.items.add(E)}if(S.type==="text/plain"){const E=v.clipboardData.getData("Text");E.length>Qi&&(v.preventDefault(),h(E))}}e.current?.uploadFiles(w.files)}requestAnimationFrame(()=>{u.current&&(u.current.trim(),a(u.current.value,u.current.json))})},[e,a,u,h]),b=f.useCallback(v=>{a(v),u.current?.focus()},[a,u]),x=f.useCallback(v=>{o(!1),v.length>0?(s(v),i(),c?.(v)):s(void 0)},[o,s,i,c]),_=f.useCallback(async v=>{const C=new DataTransfer;for(const w of v){if(w.kind==="file"){const S=w.webkitGetAsEntry();if(!S)continue;if(TI(S)){const E=w.getAsFile();E&&C.items.add(E)}else if(AI(S)){const E=await Zne(S);for(const T of E)C.items.add(T)}}if(w.type==="text/plain"&&w.getAsString(S=>{S.length>Qi?h(S):u.current&&(u.current.append(S),a(u.current.value,u.current.json))}),C.items.length>d)break}e.current?.uploadFiles(C.files)},[e,u,a,d,h]);return f.useEffect(()=>{n||(s(void 0),p(null))},[n,s]),f.useMemo(()=>({handlePaste:y,handlePasteQuery:b,handleCompleteFileUpload:x,handleFileSelect:_,autoCreatedTextFile:m,dismissNotification:g,setAutoCreatedTextFile:p}),[x,_,y,b,m,g])},nce="transparent 135deg, oklch(var(--default-color)) 180deg, transparent 225deg",SP=A.memo(function({children:t,borderRadius:n,borderGradientStops:r=nce,defaultColor:s="var(--super-color)"}){const[a,o]=f.useState(1),i=f.useCallback(d=>{d!==null&&o(d.clientWidth/d.clientHeight)},[]),c=f.useMemo(()=>({"--default-color":s,"--button-border-gradient-stops":r,"--button-aspect-ratio":a,"--button-aspect-ratio-multiplier":.65,transform:"translateY(-50%) scaleX(calc(var(--button-aspect-ratio) * var(--button-aspect-ratio-multiplier))"}),[a,r,s]),u=f.useMemo(()=>({animation:"spin 5s linear infinite"}),[]);return l.jsxs("div",{className:z("relative overflow-hidden p-px","[&:has(.content-wrapper>button)]:active:scale-[0.97] duration-150 ease-outExpo"),ref:i,style:{borderRadius:n},children:[l.jsx("div",{className:z("content-wrapper bg-base relative z-[1]","[&>button]:-my-px","[&>button]:active:scale-100"),style:{borderRadius:n-1},children:t}),l.jsx("div",{style:c,className:"absolute inset-0 top-1/2 flex size-full items-center justify-center p-px will-change-transform",children:l.jsx("div",{style:u,className:"absolute aspect-square min-h-full w-full origin-center bg-[conic-gradient(var(--button-border-gradient-stops))] blur"})})]})});function rce({reason:e}){const t=It();return on({mutationFn:()=>zse({reason:e}),onSuccess:()=>{t.invalidateQueries({queryKey:wu()})}})}function sce({reason:e}){return on({mutationFn:async({connectionType:t,content:n})=>{await uX({connectionType:t,content:n,reason:e})}})}const ace=Pe(async()=>{const{SharepointSiteModal:e}=await W(async()=>{const{SharepointSiteModal:t}=await import("./SharepointSiteModal-DYOamkU6.js");return{SharepointSiteModal:t}},__vite__mapDeps([66,2,3,5,1,6,7,8,9,59,12,35,15,13,14,16,17]));return{default:e}}),oce=({reason:e,mode:t})=>{const n=Q(),[r,s]=f.useState(!1),[a,o]=f.useState(null),{openToast:i}=cn(),{openModal:c}=Kt(),{openPicker:u,toPickerDocument:d}=$I(),{mutateAsync:m}=sce({reason:e}),p=f.useCallback(x=>{x.connector==="sharepoint"&&t==="attachment"?c(ace,{onSelectSite:_=>{x&&(s(!0),o({...x,webUrl:_}),u({...x,webUrl:_}))}}):(s(!0),o(x),x.connector==="onedrive"&&u(x))},[t,c,u]),h=f.useCallback(()=>{s(!1),o(null)},[s,o]),g=f.useCallback(x=>{Z.error("A Microsoft file picker error occured:",x),h();const _=x;let v;switch(_?.code){case"POPUP_BLOCKED":v=n.formatMessage({defaultMessage:"We couldn't open the {formattedName} sign-in window. Please allow pop-ups for this site in your browser and try again.",id:"IjzaY+voOq"},{formattedName:rp});break;case"TIMEOUT":v=n.formatMessage({defaultMessage:"{formattedName} is taking longer than usual. This may be a network issue. Please try again.",id:"CEncF+/g5h"},{formattedName:rp});break;case"AUTH":v=n.formatMessage({defaultMessage:"We couldn't sign in to {formattedName}. Please check your Microsoft account access and try again.",id:"aHs4QljX82"},{formattedName:rp});break;default:v=n.formatMessage({defaultMessage:"{formattedName} had an unexpected error. Please try again in a few moments.",id:"ApZ6o/tZ3n"},{formattedName:rp})}i({message:v,variant:"error",timeout:5})},[h,i,n]),y=f.useCallback((x,_)=>{m({connectionType:x,content:_})},[m]),b=f.useCallback(x=>{a&&(o({...a,webUrl:x}),u({...a,webUrl:x}))},[a,u]);return f.useMemo(()=>({onOpen:p,onClose:h,onError:g,onSelectSite:b,toPickerDocument:d,log:y,isOpen:r,options:a}),[r,y,h,g,p,b,a,d])},J0=({reason:e})=>{const t=It(),{mutateAsync:n}=on({mutationKey:ap(),mutationFn:async o=>(await fX({request:{url:o.url,thread_id:o.thread_id},reason:e})).file_url,onSuccess:(o,i,c)=>{t.setQueryData(ap(i.url),o),i.callback?.(o,!1)},onError:(o,i,c)=>{i.callback?.("",!1)},retry:!1}),r=f.useCallback(o=>{const i=t.getQueryData(ap(o));return typeof i=="string"?i:null},[t]),s=f.useCallback(async o=>{o.callback?.("",!0);const i=r(o.url);if(i)return o.callback?.(i,!1),i;const c=await n(o);return o.callback?.(c,!1),c},[r,n]),a=f.useCallback(async(o,i)=>{const c=URL.createObjectURL(i);t.setQueryData(ap(o),c)},[t]);return f.useMemo(()=>({getCachedImageDownloadUrl:r,getImageDownloadUrl:s,cacheImageDownloadUrl:a}),[a,r,s])};function ice(){const{value:e}=Nl({flag:"attachment-token-estimation-params",defaultValue:{max_total_tokens:5e5,type_bytes_per_token:{text:4,image:500},type_subtype_bytes_per_token:{"application/pdf":200,"application/msword":500,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":500,"application/vnd.openxmlformats-officedocument.presentationml.presentation":500},default_bytes_per_token:100},subjectType:"user_nextauth_id"});return e}function lce(e){return e.every(t=>t instanceof File)}const cce=({fileInputRef:e,isSignedIn:t,uploadRateLimit:n,maxFilesUpload:r,attachmentTokenEstimationParams:s,forwardedRef:a,existingAttachments:o,onFilePickerOpen:i,onStart:c,onComplete:u,openLoginModal:d,openPricingModal:m,openVisitorLoginUpsell:p,openMicrosoftPicker:h,closeMicrosoftPicker:g,errorMicrosoftPicker:y,toPickerDocument:b,setUploadRateLimit:x,isFollowUp:_,isClearAttachmentsEnabled:v=!1,forceImage:C,refreshBoxCredentials:w,logMicrosoft:S,asyncAttachmentsEnabled:E=!1,setUploadsReady:T,getImageUrl:k,isAudioVideoFilesEnabled:M=!1,reason:N,maxAttachmentFileSizeMB:P=xK,specialCapabilities:O={unlimitedProSearch:!1,maxModelSelection:!1,unlimitedResearch:!1,fileUpload:!1},onRemoveFile:L,getUserSettingsQueryKey:H,getUserSettings:R})=>{const{$t:I,locale:F}=Q(),{openToast:G}=cn(),[j,$]=f.useState(null),[q,U]=f.useState(null),[X,J]=f.useState(!1),[ne,ae]=f.useState([]),de=f.useCallback(fe=>{ae(De=>De.filter(Ve=>Ve.id!==fe))},[]),[oe,le]=f.useState(ne&&ne.length>0?"success":"idle"),[se,re]=f.useState(null),he=`${P}MB`,ie=f.useCallback(async(fe,De,Ve)=>{if(!Xr(fe))return null;const ct=Ve?{type:Ve}:void 0,tt=iN(fe)?fe:await k?.(fe)??fe;if(!tt)return new File([],De,ct);try{const Tn=await(await fetch(tt)).blob();return new File([Tn],De,ct)}catch{return new File([],De,ct)}},[k]);f.useEffect(()=>{v?ae([]):(async()=>{const De=await Promise.all((o??_e).map(async Ve=>{const ct=R2(Ve.split("/").pop()||"file"),tt=Ex(Ve);let bt=new File([],ct,{type:tt}),Tn;if(Xr(bt)){const Vn=await ie(Ve,ct,tt);bt=Vn??bt,Tn=Vn?URL.createObjectURL(Vn):void 0}return{id:crypto.randomUUID(),file:bt,nextURL:Ve,status:"success",thumbnailSource:Tn}}));ae(De)})()},[v,o,ie]),f.useEffect(()=>{if(!T)return;if(!E||!ne.length){T(!0);return}const fe=Ve=>Ve.status==="parsing"||Ve.status==="success"||Ve.status==="failed",De=ne.every(fe);T(De)},[ne,E,T]),f.useImperativeHandle(a,()=>({uploadFiles:fe=>He(Array.from(fe)),clearFiles:ue}));const ue=f.useCallback(()=>{ae([]),le("idle"),u?.([]),e.current?.value&&(e.current.value=""),re(null)},[e,u]),ce=f.useCallback((fe,De)=>{ae(Ve=>{let ct=Ve;return fe?ct=Ve.filter(tt=>tt.nextURL!==fe):De&&(ct=Ve.filter(tt=>!tt.nextURL?.includes(De))),ct.length===0&&le("idle"),u?.(ct.filter(tt=>!!tt.nextURL).map(tt=>({url:tt.nextURL??"",file:tt.file,resizedFile:tt.resizedFile}))??[]),L?.(fe,De),ct}),e.current?.value&&(e.current.value="")},[e,u,L]),me=f.useCallback(()=>{ae([]),le("idle"),e.current?.value&&(e.current.value=""),re(null)},[e]),pe=f.useCallback(fe=>{U(null),$(fe??I(wa[xc.generic_upload_error])),ne?.length&&le("success")},[I,ne?.length]),xe=f.useCallback(()=>{if(!d)return;const fe=I({defaultMessage:"Sign in to upload files and photos",id:"gEOi1eLJ7C"}),De=I({defaultMessage:"Analyze files and photos for free",id:"nu4bK5/Y5T"});p?p({title:fe,description:De,origin:Ke.FILE_UPLOAD,sheetModalVariant:_?"bottom-sheet-gradient":"full-sheet"}):d({origin:Ke.FILE_UPLOAD,pitchMessage:{title:fe,description:De}})},[I,_,d,p]),Oe=f.useCallback(()=>{if(!m)return;const fe=I({defaultMessage:"Upgrade for additional document analysis",id:"Al7GL1NbHp"});m({pitchMessage:{title:fe},origin:Ke.FILE_UPLOAD})},[I,m]),Te=f.useCallback(async(fe,De)=>{let Ve;E?Ve=await lQ({request:{file_uuids:[fe]},reason:N}):Ve={file_uuid:fe,success:!0,error_code:null,token_limit_exceeded:!1};const ct=Ve.success?"success":"failed";ct==="failed"?(pe(I(wa[Ve.error_code??z2.parsing_error],{filename:De})),ae(tt=>tt.filter(bt=>bt.file_uuid!==fe))):(Ve.token_limit_exceeded&&(J(!0),U(I(wa.token_limit_exceeded,{filename:De}))),ae(tt=>[...(tt??[]).map(bt=>bt.file_uuid===fe?{...bt,status:ct}:bt)]))},[pe,E,I,N]),we=f.useCallback(fe=>fe instanceof File&&uk.includes(fe.type)||!(fe instanceof File)&&fe.mimeType&&uk.includes(fe.mimeType)?I(wa[xc.unsupported_type]):fe instanceof File&&fe.size>P*ck||!(fe instanceof File)&&fe.sizeBytes&&fe.sizeBytes>P*ck?I(wa[xc.too_large],{max:he}):fe instanceof File&&fe.size<lk||!(fe instanceof File)&&fe.sizeBytes&&fe.sizeBytes<lk?I(wa.too_small):fe.name?null:I(wa.no_name),[I,he,P]),ke=f.useCallback(async(fe,De,Ve,ct,tt,bt)=>{if(!fe.ok){pe(),Z.warn(`[localAttachmentUpload] upload failed for ${bt}, response=${fe}`);return}let Tn=null;try{const An=await fe.json();if(An?.moderation?.[0]?.status==="rejected"){pe(I(wa.failed_moderation)),Z.warn(`[localAttachmentUpload] upload failed moderation for ${bt}, response=${fe}`);return}Tn=U5(An?.eager?.[0]?.secure_url??An?.secure_url)}catch{Tn=`${Ve}${ct}`.replace("${filename}",`${De.name}`)}if(!Tn){pe();return}const Vn=Pd(Tn)?"success":"parsing";ae(An=>An.map(zt=>zt.id===tt?{...zt,nextURL:Tn,file_uuid:bt,status:Vn}:zt)),le("success"),re("local"),bt&&Vn=="parsing"&&await Te(bt,De.name)},[pe,I,Te]),Fe=f.useCallback(async(fe,De,Ve)=>{if(!fe?.success){pe();return}if(fe.rate_limited){Oe(),de(Ve);return}if(!fe.filename||!fe.url){pe();return}const ct=fe.url&&Pd(fe.url)?U5(fe.url):R2(fe.url),tt=Ex(ct);console.log(fe.url,fe.filename,tt);const bt=await ie(fe.url,fe.filename,tt),Tn=Pd(fe.url)?"success":"parsing";ae(Vn=>Vn.map(An=>An.id===Ve?{...An,file:bt??An.file,nextURL:ct,file_uuid:fe.file_uuid??void 0,status:Tn,thumbnailSource:bt?URL.createObjectURL(bt):void 0}:An)),le("success"),re(De),fe.file_uuid&&Tn=="parsing"&&await Te(fe.file_uuid,fe.filename)},[ie,pe,Oe,Te,de]),ot=f.useCallback(async(fe,De)=>{const Ve=()=>ae(tt=>tt.filter(bt=>bt.id!==De.id));if(fe?.error){fe.error==="attachments_disabled_by_organization"?pe(I(wa[xc.attachments_disabled_by_organization])):pe(),Ve();return}if(fe?.rate_limited){Oe(),Ve(),de(De.id);return}if(!fe||!fe.fields||!fe.s3_bucket_url){pe(),Ve();return}JD(De)&&ae(tt=>tt.map(bt=>bt.id===De.id?{...bt,thumbnailSource:URL.createObjectURL(De.file)}:bt));const ct=new FormData;Object.entries(fe.fields).forEach(([tt,bt])=>{ct.append(tt,bt)}),ct.append("file",De.file);try{const tt=await fetch(fe.s3_bucket_url,{method:"POST",body:ct});await ke(tt,De.file,fe.s3_bucket_url,fe.fields.key,De.id,fe.file_uuid??void 0)}catch(tt){Z.warn(`[localAttachmentUpload] upload failed for ${fe.file_uuid} with error=${tt}`),pe(),Ve()}},[pe,I,ke,Oe,de]),ge=f.useCallback(fe=>{const De=fe.filter(ct=>ct.status==="success").reduce((ct,tt)=>{const bt=tt.file.type,Tn=bt.split("/")[0],Vn=s?.type_subtype_bytes_per_token?.[bt],An=s?.type_bytes_per_token?.[Tn],zt=s?.default_bytes_per_token,wr=Vn??An??zt,Wn=tt.file.size,_a=wr?Wn/wr:0;return ct+_a},0),Ve=s?.max_total_tokens;return Ve&&De>Ve},[s]);f.useEffect(()=>{if(!ne.length||X)return;ne.every(De=>De.status==="success"||De.status==="failed")&&ge(ne)&&U(I({defaultMessage:"Performance may be degraded for larger files.",id:"xwKpaJzWgU"}))},[ne,ge,I,X]);const Ce=f.useCallback(async fe=>{const{fileList:De,fileSource:Ve,setUploadRateLimit:ct}=fe,tt=[],bt=De.map(async zt=>{const wr=we(zt);if(wr)return{file:zt,error:wr};let Wn=zt;if(Xr(zt))try{Wn=await Yq(zt)}catch{Z.warn(`Unable to resize image file: ${zt.name}`)}return{file:Wn,error:null}}),Tn=await Promise.all(bt);for(const zt of Tn){if(zt.error){pe(zt.error);continue}const wr=crypto.randomUUID(),Wn={id:wr,file:zt.file,status:"uploading"};tt.push({uuid:wr,file:zt.file,uploadedFile:Wn}),ae(_a=>[..._a??[],Wn])}if(tt.length===0)return;const Vn=await oQ({filesWithUuids:tt.map(({uuid:zt,file:wr})=>({uuid:zt,file:wr})),fileSource:Ve,forceImage:C,reason:N});let An=0;Vn?await Promise.all(tt.map(async({uuid:zt,uploadedFile:wr})=>{const Wn=Vn[zt];Wn&&(await ot(Wn,wr),An++)})):(tt.forEach(({uploadedFile:zt})=>{de(zt.id)}),pe(I({defaultMessage:"Failed to get upload URLs. Please try again.",id:"JaG6Y+rSl4"}))),n&&n>0&&ct&&ct(An)},[we,pe,C,N,ot,n,de,I]),Ae=f.useCallback((fe,De,Ve)=>{lce(fe)?Ce({fileList:fe,fileSource:Ve,setUploadRateLimit:x}):De&&fe.forEach(ct=>{const tt=we(ct);if(tt)pe(tt);else{const bt=Ex(ct.name??""),Tn=new File([""],ct.name??"",{type:bt}),Vn={id:ct.id,file:Tn,status:"uploading"};ae(An=>[...An??[],Vn]),iQ({remote_file_id:ct.id,connection_type:De.toUpperCase(),reason:N}).then(An=>{Fe(An,De,Vn.id)})}})},[we,pe,Fe,Ce,N,x]),He=f.useCallback((fe,De,Ve)=>{if(!(!fe||fe.length===0)){if(Ve!==W$){if(!t&&!O.fileUpload){xe();return}if(n&&n<=0){Oe();return}if(fe.length+(ne?.length??0)>r){$(I(wa.over_file_count,{maxNumFiles:r}));return}}c?.(),le("loading"),Ae(fe,De,Ve)}},[t,n,ne,r,Ae,c,xe,Oe,I,O.fileUpload]),rt=f.useCallback(async(fe,De,Ve)=>{try{const tt=await(await fetch(fe)).blob(),bt=Ve||tt.type||"application/octet-stream";return new File([tt],De,{type:bt})}catch{return new File([],De,Ve?{type:Ve}:void 0)}},[]),Ft=f.useCallback(async(fe,De,Ve)=>{const tt=(Ve?Ve.startsWith("image/"):Xr(fe))?await ie(fe,De,Ve):await rt(fe,De,Ve);tt&&He([tt],"local")},[rt,ie,He]),Qt=gt({queryKey:H({skipConnectorPickerCredentials:!1}),queryFn:()=>R({reason:N,headers:F?{"accept-language":F}:{},skipConnectorPickerCredentials:!1}),enabled:!1}),Ye=f.useCallback(async fe=>{const ct=(await(async()=>{if(Qt.status==="success")return Qt.data;const{data:tt}=await Qt.refetch();return tt})())?.connectors.connectors.find(tt=>tt.name===fe);return ct||(Z.error(`Connector ${fe} not found in user settings`),null)},[Qt]),{openPicker:We}=YI({isAudioVideoFilesEnabled:M}),it=f.useCallback(async fe=>{const De=await Ye("google_drive");if(!De){G({variant:"error",message:I({defaultMessage:"Failed to open Google Drive file picker",id:"Ja2aztZ3b+"}),timeout:5e3});return}We({...fe,clientId:De.picker_credentials?.client_id??"",loginHint:De.connection_display_name??""})},[Ye,We,G,I]),[Ee,et]=f.useState(!1),xt=f.useCallback(()=>et(!1),[]),Ut=f.useCallback(fe=>{const De=fe.map(Ve=>qI(Ve));He(De,"box"),xt()},[He,xt]),{openPicker:Tt,cleanupPicker:gn}=WI({mode:"attachment",isAudioVideoFilesEnabled:M,onPicked:Ut,onCancel:xt}),ir=f.useCallback(async(fe={})=>{const De=await Ye("box");if(!De){G({variant:"error",message:I({defaultMessage:"Failed to open Box file picker",id:"+Yt3OYcUhg"}),timeout:5e3});return}const Ve=De.picker_credentials?.expires_at;if(Ve&&w){const ct=new Date(Ve);if(isNaN(ct.getTime())){et(!0);return}if(ct<new Date){const bt=await w();Tt({...fe,apiKey:bt?.api_key??""});return}}Tt({...fe,apiKey:De.picker_credentials?.api_key??""})},[Ye,Tt,w,G,I]),br=f.useCallback(async()=>{et(!0)},[]);f.useEffect(()=>{Ee&&ir()},[Ee,ir]);const lt=f.useCallback((fe,De)=>{if(!b||De!=="onedrive"&&De!=="sharepoint")return;const Ve=fe.map(ct=>b(ct,De)).filter(ct=>ct!==null);He(Ve,De),g?.()},[b,He,g]),{openPicker:mt}=KI(),At=f.useCallback(async fe=>{const De=await Ye("dropbox");if(!De){G({variant:"error",message:I({defaultMessage:"Failed to open Dropbox file picker",id:"1xye5E73zP"}),timeout:5e3});return}mt({...fe,clientId:De.picker_credentials?.client_id??""})},[Ye,mt,G,I]),Vt=f.useCallback(fe=>{const De=fe.map(Ve=>zI(Ve)).filter(Ve=>Ve!==null);He(De,"dropbox")},[He]),dt=f.useCallback(()=>pe(I({defaultMessage:"Unable to retrieve files from connector.",id:"4seKuUP1Wo"})),[pe,I]),en=f.useCallback(async(fe,De)=>{if(!h)return;const Ve=await Ye(fe);if(!Ve){const ct=I(fe==="onedrive"?{defaultMessage:"Failed to open OneDrive file picker",id:"L7gmeOx2re"}:{defaultMessage:"Failed to open SharePoint file picker",id:"/2WBhsPWAQ"});G({variant:"error",message:ct,timeout:5e3});return}h({...De,connector:fe,clientId:Ve.picker_credentials?.client_id??"",tenantName:Ve.picker_credentials?.tenant_name??"",loginHint:Ve.connection_display_name??"",accountIdentifier:Ve.picker_credentials?.account_identifier})},[Ye,h,G,I]),jt=f.useCallback((fe,De)=>{fe=="google_drive"?it({mode:"attachment",onPicked:Ve=>He(Ve,fe)}):fe==="onedrive"||fe==="sharepoint"?en(fe,{webUrl:De,mode:"attachment",isAudioVideoFilesEnabled:M,onPicked:Ve=>lt(Ve,fe),onError:y,onCancel:g,log:S}):fe==="dropbox"?At({mode:"attachment",isAudioVideoFilesEnabled:M,onPicked:Vt,onError:dt}):fe=="box"&&br()},[it,He,en,lt,g,y,At,Vt,dt,br,S,M]),Gt=f.useCallback(fe=>{if(!t&&!O.fileUpload){xe();return}if(n&&n<=0){Oe();return}!fe||fe==="local"?(e.current?.click(),i?.()):jt(fe)},[t,n,e,xe,Oe,jt,i,O.fileUpload]);return f.useEffect(()=>{let fe=null;return q&&(fe=setTimeout(()=>{U(null)},yK)),()=>{fe&&clearTimeout(fe)}},[q]),f.useEffect(()=>{ne&&u?.(ne.filter(fe=>!!fe.nextURL).map(fe=>({url:fe.nextURL??"",file:fe.file,resizedFile:fe.resizedFile})))},[ne,u]),f.useMemo(()=>({errorMessage:j,warningMessage:q,uploadedFiles:ne,uploadSource:se,status:oe,fileInputRef:e,handleClearFiles:ue,handleRemoveFile:ce,handleStartUpload:Gt,handleFileInput:He,attachFromUrl:Ft,removeAllFiles:me,handleOpenLoginModal:xe,handleOpenPricingModal:Oe,isBoxOpen:Ee,onCloseBox:xt,cleanupBoxPicker:gn,setErrorMessage:$}),[j,q,ne,se,oe,e,ue,ce,Gt,He,Ft,me,xe,Oe,Ee,xt,gn])},uce=Pe(async()=>{const{LoginModal:e}=await W(async()=>{const{LoginModal:t}=await import("./LoginModal-D844be60.js");return{LoginModal:t}},__vite__mapDeps([48,2,3,5,1,6,7,8,9,10,11,12,13,49,14,15,16,17]));return{default:e}}),dce=({fileUploadRef:e,isAudioVideoFilesEnabled:t,isClearAttachmentsEnabled:n,isFollowUp:r,lastResult:s,onStartFileUpload:a,onCompleteFileUpload:o,setUploadsReady:i,reason:c,specialCapabilities:u,askInputRef:d,onRemoveFile:m})=>{const p=f.useRef(null),{inputRef:h}=Fr(),{openModal:g}=Kt(),y=nS(),b=ice(),{value:x}=Lt({flag:"async-attachment-processing",defaultValue:!1,subjectType:"user_nextauth_id"}),_=wt(),{openVisitorLoginUpsell:v}=ws({enabled:!_}),C=On(),{connectorLimits:w}=ga({reason:c}),{uploadRateLimit:S,setUploadRateLimit:E}=En(),{hasActiveSubscription:T}=Mt(),k=S??(T?_K:bK),M=f.useCallback(ae=>g(uce,{...ae}),[g]),N=f.useCallback(ae=>{C(ae)},[C]),{onOpen:P,onClose:O,onError:L,toPickerDocument:H,options:R,onSelectSite:I,isOpen:F,log:G}=oce({reason:c,mode:"attachment"}),{mutateAsync:j}=rce({reason:c}),{getCachedImageDownloadUrl:$,getImageDownloadUrl:q}=J0({reason:c}),U=f.useCallback(async ae=>s?.backend_uuid?await q({url:ae,thread_id:s.backend_uuid}):$(ae),[$,q,s?.backend_uuid]),X=cce({fileInputRef:p,isSignedIn:_,uploadRateLimit:k,maxFilesUpload:y,attachmentTokenEstimationParams:b,forwardedRef:e,onStart:a,onComplete:o,openLoginModal:M,openPricingModal:N,openVisitorLoginUpsell:v,openMicrosoftPicker:P,closeMicrosoftPicker:O,errorMicrosoftPicker:L,toPickerDocument:H,setUploadRateLimit:E,isFollowUp:r,isClearAttachmentsEnabled:n,refreshBoxCredentials:j,logMicrosoft:G,asyncAttachmentsEnabled:x,setUploadsReady:i,getImageUrl:U,isAudioVideoFilesEnabled:t,reason:c,maxAttachmentFileSizeMB:w?.max_attachment_file_size_mb,specialCapabilities:u,onRemoveFile:m,getUserSettingsQueryKey:wu,getUserSettings:NR}),{attachFromUrl:J,removeAllFiles:ne}=X;return f.useImperativeHandle(d??null,()=>({addMediaFile:async(ae,de,oe)=>{await J(ae,de,oe)},focusInput:()=>{h.current?.focus()},blurInput:()=>{h.current?.blur()},removeAttachments:()=>{ne()}}),[J,h,ne]),f.useMemo(()=>({...X,fileInputRef:p,microsoftFilePickerOptions:R,handleSelectSharepointSite:I,isMicrosoftFilePickerOpen:F,onCloseMicrosoft:O,addMediaFile:J,removeAllFiles:ne}),[X,I,F,R,O,J,ne])},fce=({setInput:e})=>{const t=nn();f.useEffect(()=>{if(!t)return;const n=t.get("p_q");n&&e(n)},[t,e])};function mce(){return Intl.DateTimeFormat().resolvedOptions().timeZone}async function pce({body:e,reason:t}){try{const{data:n,error:r,response:s}=await ve.POST("/rest/realtime/v1/transcription-session",t,{timeoutMs:Ct({productionMs:5e3}),numRetries:1,body:e,headers:{"content-type":"application/json"}});return r?{status:s.status,error:`Failed to get GA realtime transcription session: ${s.statusText}`}:{data:n,status:s.status,error:null}}catch(n){return Z.error("Failed to get GA realtime transcription session",n),{data:null,status:500,error:`Failed to get GA realtime transcription session: ${n}`}}}async function hce({body:e,reason:t,requestId:n}){const{data:r,error:s,response:a}=await ve.POST("/rest/realtime/search-youtube",t,{timeoutMs:Ct({productionMs:5e3}),numRetries:1,body:e,headers:{"content-type":"application/json",...n?{[Fn]:n}:{}}});if(s)throw Z.error("Failed to search video",s),new Ue("API_CLIENTS_ERROR",{message:"Failed to search video",cause:s,status:a.status??0});return r}async function EP({body:e,reason:t,requestId:n}){const{data:r,error:s,response:a}=await ve.POST("/rest/realtime/query-video",t,{timeoutMs:Ct({productionMs:3e4}),numRetries:1,body:e,headers:{"content-type":"application/json",...n?{[Fn]:n}:{}}});if(s)throw Z.error("Failed to query video",s),new Ue("API_CLIENTS_ERROR",{message:"Failed to query video",cause:s,status:a.status??0});return r}async function gce({body:e,reason:t,requestId:n}){const{data:r,error:s,response:a}=await ve.POST("/rest/realtime/search-web",t,{timeoutMs:Ct({productionMs:5e3}),numRetries:1,body:e,headers:{"content-type":"application/json",...n?{[Fn]:n}:{}}});if(s)throw Z.error("Failed to search web",s),new Ue("API_CLIENTS_ERROR",{message:"Failed to search web",cause:s,status:a.status??0});return r}async function yce({entry:e,analyticsParams:t,reason:n,requestId:r}){const{data:s,error:a,response:o}=await ve.POST("/rest/realtime/create-entry",n,{timeoutMs:Ct({productionMs:5e3}),numRetries:1,body:{...e,analytics_params:{...t,timezone:mce()}},headers:{"content-type":"application/json",...r?{[Fn]:r}:{}}});if(a)throw Z.error("Failed to create entry",a),new Ue("API_CLIENTS_ERROR",{message:"Failed to create entry",cause:a,status:o.status??0});return s}async function xce({body:e,reason:t,requestId:n}){try{const{data:r,error:s,response:a}=await ve.POST("/rest/realtime/v2/session",t,{timeoutMs:Ct({productionMs:1e4,clientSideMs:1e4}),numRetries:2,body:e,headers:{"content-type":"application/json",...n?{[Fn]:n}:{}}});return s?{status:a.status,data:void 0,error:a.statusText||"Failed to create realtime session v2"}:{status:a.status,data:r,error:void 0}}catch(r){return Z.error("Failed to create realtime session v2",r),{status:500,data:void 0,error:`Failed to create realtime session v2: ${r}`}}}async function kYe({body:e,reason:t}){try{const{data:n,error:r,response:s}=await ve.POST("/rest/realtime/v2/language-learning/session",t,{timeoutMs:Ct({productionMs:1e4,clientSideMs:1e4}),numRetries:1,body:e,headers:{"content-type":"application/json"}});return r?{status:s.status,data:void 0,error:s.statusText||"Failed to create language learning session v2"}:{status:s.status,data:n,error:void 0}}catch(n){return Z.error("Failed to create language learning session v2",n),{status:500,data:void 0,error:`Failed to create language learning session v2: ${n}`}}}async function bce({body:e,reason:t,requestId:n}){try{const{data:r,error:s,response:a}=await ve.POST("/rest/realtime/v1/livekit/connection",t,{timeoutMs:Ct({productionMs:1e4,clientSideMs:1e4}),numRetries:2,body:e,headers:{"content-type":"application/json",...n?{[Fn]:n}:{}}});return s?{status:a.status,data:void 0,error:a.statusText||"Failed to create LiveKit connection"}:{status:a.status,data:r,error:void 0}}catch(r){return Z.error("Failed to create LiveKit connection",r),{status:500,data:void 0,error:`Failed to create LiveKit connection: ${r}`}}}const ft="web.frontend.realtime.voice",ey="oai-realtime-v2v-tool-call",kP=4096,MP=.7,_ce=1500,vce=30,Cce=50,MYe=3e3;var go;(function(e){e.BrowserGetUrlContent="get_full_page_content",e.CloseBrowserTabs="close_browser_tabs",e.GroupOpenBrowserTabs="group_open_browser_tabs",e.OpenNewBrowserTab="open_page",e.SearchBrowser="search_browser",e.UngroupOpenBrowserTabs="ungroup_open_browser_tabs"})(go||(go={}));var Zh;(function(e){e.ActiveTabs="active_tabs",e.BrowsingHistory="browsing_history"})(Zh||(Zh={}));var q4;(function(e){e.MobileWeb="mobile_web",e.Web="web",e.macOS="macos",e.iOS="ios",e.Android="android",e.Windows="windows"})(q4||(q4={}));const wce=3e3,Sce=3,TP=5;function Ece(e){const t=e.toLowerCase();return t.includes("airpod")||t.includes("headphone")||t.includes("earbud")||t.includes("headset")?"near_field":t.includes("built-in")||t.includes("internal")||t.includes("macbook")||t.includes("laptop")||t.includes("usb")||t.includes("conference")||t.includes("desk")||t.includes("array")||t.includes("camera")?"far_field":null}const kce=e=>e.isWindowsApp?JC:eo()?EN():e.isIOS?CK:e.isAndroid?wK:e.isMobile?Qq:Xq,Mce=()=>{const{device:{isWindowsApp:e,isIOS:t,isAndroid:n,isMobile:r}}=jn();return kce({isWindowsApp:e,isIOS:t,isAndroid:n,isMobile:r})},Tce=({callbacks:e,config:t,reason:n})=>{const[r,s]=f.useState(!1),[a,o]=f.useState(""),[i,c]=f.useState(!1),[u,d]=f.useState(null),[m,p]=f.useState(()=>{const le=yt.getItem(Px);return le?le==="true":null}),{session:h}=je(),{trackEvent:g}=Ze(h),y=Mce(),b=t.silenceThreshold??30,x=t.silenceDuration??5e3,_=f.useRef(null),v=f.useRef(null),C=f.useRef(""),w=f.useRef(null),S=f.useRef(!1),E=f.useRef(null),T=f.useRef(null),k=f.useRef(null),M=f.useRef(null),N=f.useRef(null),P=f.useRef(new Map),O=f.useRef(null),L=f.useRef(null),H=f.useRef(null),R=f.useRef([]),I=f.useRef(null),F=f.useCallback(async()=>{try{return(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(se=>se.stop()),p(!0),yt.setItem(Px,"true"),!0}catch(le){return d(`Microphone permission denied. ${le}`),p(!1),yt.setItem(Px,"false"),!1}},[]),G=f.useRef(!1),j=f.useCallback(()=>{w.current&&(w.current.getTracks().forEach(le=>le.stop()),w.current=null)},[]),$=f.useCallback(()=>{if(S.current=!1,k.current&&(clearTimeout(k.current),k.current=null),E.current&&(E.current.close(),E.current=null,T.current=null),_.current&&r&&_.current.stop(),I.current&&(clearInterval(I.current),I.current=null),H.current&&(H.current.port.onmessage=null,H.current.disconnect(),H.current=null),v.current&&v.current.stop(),j(),C.current="",o(""),P.current.clear(),s(!1),N.current&&(N.current.close(),N.current=null),M.current){const le=Date.now()-M.current;g("stop transcription",{durationMs:le})}M.current=null,e?.onStop?.()},[e,j,g,r]),q=f.useCallback(le=>{if(!le||!S.current)return;const se=le.frequencyBinCount,re=new Uint8Array(se);le.getByteFrequencyData(re),re.reduce((ie,ue)=>ie+ue)/se<b?k.current||(k.current=setTimeout(()=>{S.current&&e?.onSilence?.()},x)):k.current&&(clearTimeout(k.current),k.current=null),S.current&&requestAnimationFrame(()=>q(le))},[e,b,x]),U=f.useCallback(()=>Array.from(P.current.values()).map(se=>se.finalTranscript||se.partialTranscript||"").join(" ").trim(),[P]),X=f.useCallback(le=>{const{type:se,item_id:re}=le;if(!re)return;P.current.has(re)||P.current.set(re,{itemId:re,partialTranscript:"",finalTranscript:""});const he=P.current.get(re),ie=L.current||"";switch(se){case"conversation.item.input_audio_transcription.delta":{const{delta:ue}=le;ie==="whisper-1"?he.partialTranscript=ue:he.partialTranscript+=ue;break}case"conversation.item.input_audio_transcription.completed":{const{transcript:ue}=le;typeof ue=="string"&&(he.finalTranscript=ue);break}case"input_audio_buffer.committed":{le.previous_item_id&&(he.previousItemId=le.previous_item_id);break}}P.current.set(re,he),o(U())},[U]),J=f.useCallback(async()=>{const le=await pce({body:{source:y,timezone:PN,turn_detection_threshold:MP,response_language:"en"},reason:n});if(!le.data?.client_secret)throw Z.error("No ephemeral key from server"),new Error("Unable to start OAI session");O.current=le.data.session_id,L.current=le.data.model_name;const re=["realtime",`openai-insecure-api-key.${le.data.client_secret}`],he=new WebSocket("wss://api.openai.com/v1/realtime?intent=transcription",re);N.current=he,he.onopen=()=>Z.info("OpenAI WS connected (base64 PCM approach)"),he.onerror=ie=>{Z.error("OAI WS error:",ie),d("OpenAI WS error")},he.onclose=ie=>{Z.info("OAI WS closed:",ie.code)},he.onmessage=ie=>{try{const ue=JSON.parse(ie.data);X(ue)}catch(ue){Z.error("Invalid OAI WS message:",ie.data,ue)}}},[X,y,n]),ne=f.useCallback(le=>{let se=0;for(const ie of le)se+=ie.length;const re=new Int16Array(se);let he=0;for(const ie of le)re.set(ie,he),he+=ie.length;return re},[]),ae=f.useCallback(le=>{const se=le.buffer;let re="";const he=new Uint8Array(se);for(const ie of he)re+=String.fromCharCode(ie);return btoa(re)},[]),de=f.useCallback(async le=>{const se=new AudioContext;E.current=se,await se.audioWorklet.addModule("/audio-worklet.js");const re=new AudioWorkletNode(se,"pcm-worklet-processor");H.current=re,re.port.onmessage=ie=>{if(!S.current)return;const ue=ie.data;R.current.push(ue)},I.current||(I.current=setInterval(()=>{if(!S.current||!N.current||N.current.readyState!==WebSocket.OPEN||R.current.length===0)return;const ie=ne(R.current);R.current=[];const ue=ae(ie),ce={event_id:`evt-${Date.now()}`,type:"input_audio_buffer.append",audio:ue};N.current.send(JSON.stringify(ce))},500));const he=se.createMediaStreamSource(le);he.connect(re),re.connect(se.destination),T.current=se.createAnalyser(),T.current.fftSize=256,he.connect(T.current),requestAnimationFrame(()=>q(T.current))},[q,ne,ae]),oe=f.useCallback(async()=>{if(d(null),M.current=Date.now(),g("start transcription"),S.current=!0,(m===null||m===!1)&&(c(!0),!await F())){c(!1),d("Microphone permission is required for voice input"),e?.onStop?.(),S.current=!1;return}try{await J();const le=await navigator.mediaDevices.getUserMedia({audio:!0}).catch(async se=>{if(p(!1),!await F())throw se;return navigator.mediaDevices.getUserMedia({audio:!0})});w.current=le,await de(le),G.current&&v.current&&(C.current="",o(""),v.current.start(),v.current.onspeechend=()=>$()),s(!0),c(!1),e?.onStart?.()}catch(le){d(`Failed to start recording. ${le}`),S.current=!1}},[e,m,F,g,$,J,de]);return f.useMemo(()=>({isTranscribing:r,isInitializing:i,transcription:a,error:u,startTranscription:oe,stopTranscription:$}),[u,i,r,oe,$,a])},Ace=1e4,Jh="autosuggest",Nce="AUTOSUGGEST_MESSAGE_MALFORMED",Rce="AUTOSUGGEST_MESSAGE_PARSE_ERROR",Dce="AUTOSUGGEST_WS_CONNECTION_ERROR",Ice="AUTOSUGGEST_WS_SEND_QUERY_ERROR",jce=()=>{const{device:{isMobile:e}}=jn(),t=It();return f.useCallback(n=>{const r=t.getQueryData(Se.makeEphemeralQueryKey(Jh)),s=t.getQueryData(Se.makeEphemeralQueryKey(Jh,n));if(s?.length&&s.length===zd(e))return s;if(r){const a=n.replace(/\s+/g,"").toLocaleLowerCase(),o=[];for(const d of r){if(e&&d.url||d.focus)continue;const[m,p]=dP(a,d);if(m&&(o.push([p,d]),o.length===zd(e)))break}const i=o.sort(([d],[m])=>d-m).map(([d,m])=>m),[c,u]=u_(i,e,n);if(s?.length){const d=[...s];for(const m of c)if(!d.find(p=>p.query===m.query)&&(d.push(m),d.length===zd(e)))break;return u_(d,e,n)[1]}return u}return _e},[e,t])},Pce=()=>{const{suggestions:e}=Fr(),{setSuggestions:t}=Fs(),n=f.useRef(e);n.current=e;const r=It(),s=jce(),a=f.useRef(!1),{device:{isMobile:o}}=jn(),i=f.useRef(null),c=f.useRef(null),u=f.useRef([]),d=f.useRef({lastMessageID:0});f.useLayoutEffect(()=>()=>{a.current=!1},[]);const m=f.useCallback((y,b=!1)=>{const x=s(y);!b&&!x.length||(n.current.length!==x.length||vq(n.current,x,"query").length!==x.length)&&(n.current=x,t(x))},[s,t]),p=f.useCallback(y=>{try{const b=new WebSocket("wss://suggest.perplexity.ai/suggest/ws");b.onopen=()=>{y?.()},b.onmessage=x=>{let _;try{if(_=JSON.parse(x.data),_.length<4){Z.error(Nce,_);return}}catch(N){Z.error(Rce,N);return}const[v,C,w,S]=_,E=parseInt(w),T=Qie(S),[k,M]=u_(T,o);if(r.setQueryData(Se.makeEphemeralQueryKey(Jh),(N=_e)=>k.length?Z9([...k,...N],"query").sort((P,O)=>P.query.localeCompare(O.query)):N),r.setQueryData(Se.makeEphemeralQueryKey(Jh,v),M),E===d.current.lastMessageID&&a.current&&m(v,!0),d.current[E]){const N=performance.now()-(d.current[E]??0);u.current.push(N)}},i.current=b}catch(b){Z.error(Dce,b)}},[o,m,r]),h=f.useCallback(()=>{c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{i.current&&(i.current.close(),i.current=null)},Ace)},[]);f.useEffect(()=>(p(),h(),()=>{i.current&&i.current.close(),c.current&&clearTimeout(c.current)}),[p,h]);const g=f.useCallback((y,b=!0)=>{if(a.current=!!y.trim(),!a.current)return;m(y);const x=[WebSocket.OPEN,WebSocket.CONNECTING];if(!i.current||!x.includes(i.current.readyState)){b&&p(()=>{g(y,!1)});return}else h();const _=d.current.lastMessageID+1,v=_.toString();d.current.lastMessageID=_;try{const C=JSON.stringify({q:y,uuid:v,full_completion:!0});if(i.current.readyState===WebSocket.CONNECTING)return;i.current.send(C),d.current[_]=performance.now()}catch(C){Z.error(Ice,C)}},[p,h,m]);return f.useEffect(()=>{const y=setInterval(()=>{u.current.length!==0&&(DY({latencies:u.current,isMobile:o}),u.current=[])},$ie);return()=>clearInterval(y)},[o]),f.useMemo(()=>({handleUpdateAutosuggestions:g}),[g])};function Oce(){const{value:e}=Lt({flag:"clear-attachment-on-submission",subjectType:"user_nextauth_id",defaultValue:!1});return e}const Lce=({entropyBrowser:e,isSidecar:t,focusInput:n})=>{f.useEffect(()=>{if(!e||!t)return;const r=()=>{document.visibilityState==="visible"&&n()},s=e.subscribeQuickActionButtonFired(()=>{n()}),a=e.subscribeSourceTabChanged(()=>{n()});return document.addEventListener("visibilitychange",r),()=>{s(),a(),document.removeEventListener("visibilitychange",r)}},[e,n,t])},Fce=A.memo(function(t){const{children:n,condition:r,Wrapper:s,...a}=t;return r?l.jsx(s,{...a,children:n}):n});let id=0;function Uce(e,t,n=!1){const[r,s]=f.useState(!1),[a,o]=f.useState(!1),i=f.useCallback(g=>{g.preventDefault()},[]),c=f.useCallback(g=>{g?.dataTransfer?.types.includes("Files")&&(g.preventDefault(),s(!0),id++)},[]),u=f.useCallback(g=>{g.preventDefault(),id=Math.max(0,id-1),id===0&&s(!1)},[]),d=f.useCallback(g=>{g.preventDefault(),s(!1),o(!1),id=0,!t&&n&&g.dataTransfer?.items.length&&e(g.dataTransfer.items)},[t,e,n]),m=f.useCallback(g=>{g?.dataTransfer?.types.includes("Files")&&(g.preventDefault(),o(!0))},[]),p=f.useCallback(g=>{g.preventDefault(),o(!1)},[]),h=f.useCallback(g=>{g.preventDefault(),s(!1),o(!1),!t&&!n&&g?.dataTransfer?.items.length>0&&e(g.dataTransfer.items)},[t,e,n]);return f.useEffect(()=>(document.addEventListener("dragover",i),document.addEventListener("dragenter",c),document.addEventListener("dragleave",u),document.addEventListener("drop",d),()=>{document.removeEventListener("dragover",i),document.removeEventListener("dragenter",c),document.removeEventListener("dragleave",u),document.removeEventListener("drop",d)}),[i,c,u,d]),f.useMemo(()=>({isDraggingFile:r,isFileOver:a,rootProps:{onDragOver:m,onDragLeave:p,onDrop:h}}),[p,m,h,r,a])}const Bce=A.memo(function({onDrop:t,disabled:n=!1,children:r,dropZoneClassName:s,dropLabel:a,dropIcon:o=D("arrow-bar-to-down"),allowDropAnywhere:i=!1,hideContent:c=!1,...u}){const{$t:d}=Q(),{isDraggingFile:m,isFileOver:p,rootProps:h}=Uce(t,n,i),g=a??d(i?{defaultMessage:"Dropped files appear here.",id:"9WR4elgZix"}:{defaultMessage:"Drop your files here.",id:"llIM82nPs+"});return l.jsxs("div",{className:"relative",...h,...u,children:[m&&n?l.jsx(Y,{className:z("border-subtler bg-subtler absolute inset-0 z-20 flex items-center justify-center rounded-2xl border-2 border-dashed",{"!border-caution":p},s?.(m,p)),children:l.jsxs(B,{color:"red",children:[l.jsx(ye,{icon:o,className:"mr-2"}),"Drop zone disabled"]})}):m?l.jsxs(l.Fragment,{children:[l.jsx(Y,{variant:"background",className:"absolute inset-0 z-20 rounded-2xl opacity-80"}),l.jsx(Y,{className:z("gap-x-sm animate-in fade-in border-subtler absolute inset-0 z-20 flex items-center justify-center rounded-2xl border-2 border-dashed transition-all duration-200",{"!border-super":p},s?.(m,p)),children:!c&&l.jsxs(B,{color:"super",children:[l.jsx(ye,{icon:o,className:"mr-2"}),g]})})]}):null,r]})}),Hce=Pe(async()=>{const{PremiumSourceLimitWarning:e}=await W(async()=>{const{PremiumSourceLimitWarning:t}=await import("./PremiumSourceLimitWarning-CdpRAkkh.js");return{PremiumSourceLimitWarning:t}},__vite__mapDeps([67,2,3,5,1,6,7,8,9,13,12,14,15,16,17]));return{default:e}}),Vce=({value:e,json:t,querySource:n,placeholder:r,placeholderClassName:s,disableSubmission:a=!1,disableInput:o=!1,initialLayout:i="expanded",minRows:c=1,isFollowUp:u=!1,showSources:d=!1,useThreadSources:m=!1,showModelSelector:p=!0,showSearchModeSelector:h=!0,showFileUpload:g=!1,disableActionButtons:y=!1,showIncognitoHint:b,hasShadow:x=!1,autofocus:_=!0,fileUploadTooltip:v,className:C,headerComponent:w,showStopButton:S=!1,forceHideSuggestions:E=!1,disablePremiumSourceLimitWarning:T=!1,onChange:k,onFocus:M,onBlur:N,onClick:P,onSubmit:O,onStopButtonClick:L=jr,onFilePickerOpen:H,onFilePickerClose:R,autosuggestionsEnabled:I=!0,dropdownPlacement:F="bottom",dropdownClassName:G,mentionTypeaheadOptions:j,isCometHome:$=!1,syncUncontrolledOnce:q=!1,onTriggerTypeahead:U,layoutKey:X,isMissionControl:J,ref:ne,onRemoveFile:ae,onFileAttachComplete:de,renderAttachments:oe=!0})=>{const le=`ask-input-inner-${n}`,se=f.useRef(!1),[re,he]=f.useState(!1),[ie,ue]=f.useState(_),{suggestions:ce,blankStateSuggestions:me,showSuggestDropdown:pe,browserAgentAllowOnceFromToggle:xe,forceEnableBrowserAgent:Oe}=Fr(),{setSuggestions:Te}=Fs(),{isMobileStyle:we,isMobileUserAgent:ke}=Be(),{inputRef:Fe}=Fr(),[ot,ge]=f.useState(!0),Ce=f.useRef(null),Ae=wt(),{isMax:He}=Mt(),{quote:rt,setQuote:Ft}=ya(),Qt=Oce(),Ye=ns(),{sources:We}=En(),{specialCapabilities:it}=gr(),{lastResult:Ee,inFlight:et,resultsLength:xt}=Ht(),Ut=Xt(),Tt=Q(),gn=f.useRef(null),ir=f.useRef(null),[br,lt]=f.useState(!1),mt=f.useCallback(()=>lt(!0),[]),At=f.useCallback(()=>lt(!1),[]),{cacheImageDownloadUrl:Vt}=J0({reason:le}),[dt,en]=f.useState(void 0),jt=f.useMemo(()=>dt?.map(yn=>yn.url),[dt]),Gt=f.useMemo(()=>{if(e.length>Qi)return Tt.formatMessage({defaultMessage:"Query is { numCharacters } characters too long",id:"yw04s2k4La"},{numCharacters:e.length-Qi})},[e,Tt]),{handleUpdateAutosuggestions:fe}=Pce(),De=f.useCallback(yn=>{if(!(se.current||!ot)){if(fe(""),se.current=!0,!yn.query&&jt&&jt.length>0){const Hr=El(jt[0]);yn.query=Hr!=="File"?Hr:"File Attached"}Gt?se.current=!1:(setTimeout(()=>se.current=!1,iS),O?.({query:yn.query,json:yn.json,attachments:jt,promptSource:yn.promptSource,querySource:yn.querySource,mentions:yn.mentions,browserAgentAllowOnceFromToggle:xe,forceEnableBrowserAgent:Oe}),dt?.forEach(Hr=>{Hr.file&&Hr.file.size>0&&Xr(Hr.url)&&Vt(Hr.url,Hr.resizedFile??Hr.file)}),(Qt||J)&&gn.current?.clearFiles(),ir.current?.clearAutoCreatedTextFile())}},[jt,dt,xe,Oe,Vt,Gt,fe,Qt,J,O,ot]);f.useEffect(()=>Ut.subscribeForceSubmitQuery(yn=>{De(yn)}),[Ut,De]);const{isDisabled:Ve,focusedIndex:ct,setFocusedIndex:tt,userInputQuery:bt,handleSuggestionSubmission:Tn,handleFocus:Vn,handleBlur:An,handleChange:zt,handleKeyDown:wr,focusInput:Wn,hasQuery:_a}=ece({value:e,json:t,querySource:n,disableSubmission:a,disableInput:o,autofocus:_,isUploadingFile:re,onChange:k,onFocus:M,onBlur:N,handleSubmit:De,handleUpdateAutosuggestions:fe,autosuggestionsEnabled:I,errorMessage:Gt,sources:We,attachments:jt,selectedSearchMode:Ye,setIsInputActive:ue,isInputActive:ie,inFlight:et,resultsLength:xt,quote:rt,isMentionMenuOpened:br,isCometHome:$,reason:le,placement:F});fce({setInput:zt}),Lce({entropyBrowser:Ut,focusInput:Wn,isSidecar:!0}),f.useEffect(()=>{Fe.current?.focus()},[Fe]),f.useEffect(()=>{rt&&Wn()},[rt,Wn]);const{openToast:Uo}=cn(),qu=f.useMemo(()=>({onStart:()=>{Wn()},onStop:()=>{Wn()},onSilence:()=>{Uo({message:"No audio detected. Make sure your microphone is connected and unmuted",variant:"error",timeout:4})}}),[Wn,Uo]),{startTranscription:$u,stopTranscription:Wl,error:Pi,isTranscribing:as,isInitializing:oo,transcription:Bo}=Tce({callbacks:qu,config:IK,reason:le});f.useEffect(()=>{Pi&&Uo({message:`Audio Error: ${Pi}`,variant:"error",timeout:4})},[Pi,Uo]);const io=f.useRef("");f.useEffect(()=>{if(!as){io.current="";return}if(Bo&&Bo!==io.current){const yn=Bo.startsWith(io.current)?Bo.slice(io.current.length):Bo;if(yn){const Hr=io.current.length==0?` ${yn}`:yn;io.current.length==0&&Fe.current?.trim(),Fe.current?.append(Hr),zt(Fe.current?.value??"",Fe.current?.json)}io.current=Bo}},[Bo,as,zt,Fe]);const Oi=!0,qm=f.useCallback(()=>he(!0),[]),{handlePaste:$m,handlePasteQuery:Wm,handleCompleteFileUpload:Wu,handleFileSelect:Km,autoCreatedTextFile:Ho,dismissNotification:Ku,setAutoCreatedTextFile:Vo}=tce({fileUploadRef:gn,fileHandlingRef:ir,showFileUpload:g,attachments:jt,setAttachments:en,handleChange:zt,setIsUploadingFile:he,focusInput:Wn,onFileAttachComplete:de}),{fileInputRef:Ym,errorMessage:Kl,warningMessage:Yl,uploadSource:wx,uploadedFiles:Ys,handleRemoveFile:Ql,handleStartUpload:Qm,handleFileInput:Li,isBoxOpen:Nn,onCloseBox:Xm,cleanupBoxPicker:Zm,microsoftFilePickerOptions:Yu,isMicrosoftFilePickerOpen:Jm,handleSelectSharepointSite:Qu,onCloseMicrosoft:M5,setErrorMessage:ep}=dce({fileUploadRef:gn,isAudioVideoFilesEnabled:Oi,isClearAttachmentsEnabled:J||Qt,isFollowUp:u,lastResult:Ee,onStartFileUpload:qm,onCompleteFileUpload:Wu,setUploadsReady:ge,reason:le,specialCapabilities:it,askInputRef:ne,onRemoveFile:ae}),T5=f.useCallback(()=>{if(Ho){if(Fe.current?.append(Ho.content),zt(Fe.current?.value??"",Fe.current?.json),jt){const yn=jt.find(Hr=>Hr.includes(Ho.fileName));yn&&Ql(yn)}Vo(null)}},[Ho,Fe,zt,jt,Ql,Vo]),Sx=f.useRef(e);Sx.current=e;const tp=pe&&!E&&!as;f.useEffect(()=>{tp&&Sx.current.length===0&&me[Ye]&&Te(me[Ye])},[me,Te,Ye,tp]);const A5=f.useCallback(yn=>{ue(!0),Sx.current.length===0&&me[Ye]&&Te(me[Ye]),P?.(yn)},[ue,Te,me,Ye,P]),N5=f.useCallback(yn=>{Fe.current=yn},[Fe]),mq=f.useMemo(()=>({isOpen:tp,suggestedQueries:ce,focusedIndex:ct,setFocusedIndex:tt,handlePasteQuery:Wm,handleSubmit:Tn,userInputQuery:bt,placement:F,dropdownClassName:G,allowNonSequentialMatch:ce!==me[Ye],scrollableShards:Ys.length>0?[Ce]:[]}),[me,G,F,ct,Wm,Tn,Ye,tt,ce,Ys.length,bt,tp]),{isIncognito:R5}=f0({reason:le}),pq=f.useMemo(()=>{const yn=pe&&!E&&!as;return{initialLayout:i,wrapperClass:z({"transition-none p-lg":pe,"border-dashed border-subtle":R5,"border-b-none rounded-b-none":yn&&F==="bottom","border-t-none rounded-t-none rounded-b-2xl":yn&&F==="top","bg-base":rt}),size:"large",hasShadow:x,isMobileUserAgent:ke,showStopButton:S,quote:rt??void 0,inputWarnings:Ho&&l.jsxs(Y,{variant:"subtler",className:"mx-sm mb-xs px-sm py-xs dark:bg-base flex items-center justify-between rounded-lg",children:[l.jsx("div",{className:"gap-x-sm flex items-center",children:l.jsxs(B,{variant:"tiny",color:"light",children:["Text is"," ",Math.max(1,Math.round((Ho.content.length-Qi)/Qi*100)),"% over the limit and is attached as a file."," ",l.jsx(pt,{variant:"super",size:"tiny",onClick:T5,text:"Paste as text"})]})}),l.jsx(pt,{icon:D("x"),size:"tiny",onClick:Ku,variant:"common",pill:!0,noPadding:!0})]}),attachmentsList:Ys.length>0&&oe&&l.jsx(Vte,{uploadedFiles:Ys,onRemoveFile:Ql,ref:Ce}),setQuote:Ft,inputRef:Fe}},[Ho,Ku,F,E,Ql,x,i,Fe,as,T5,rt,Ft,S,pe,Ys,oe,ke,R5]),hq=f.useMemo(()=>({ref:N5,id:"ask-input",value:e,json:t,initialLayout:i,minRows:c,placeholder:as?Tt.formatMessage({defaultMessage:"Listening",id:"GdiyKL+89A"}):r,placeholderClassName:s,disableInput:o,autoFocus:_,onClick:A5,onChange:zt,onKeyDown:wr,onBlur:An,onFocus:Vn,onPaste:$m,onMentionMenuOpen:mt,onMentionMenuClose:At,isMobileStyle:we,isMobileUserAgent:ke,mentionTypeaheadOptions:j,onTriggerTypeahead:U}),[_,o,An,zt,A5,Vn,wr,$m,i,we,ke,t,j,c,At,mt,U,r,s,N5,e,as,Tt]),gq=f.useMemo(()=>l.jsx(zie,{value:e,json:t,showSources:d,useThreadSources:m,isFollowUp:u,isDisabled:Ve||!ot,querySource:n,errorMessage:Gt,handleSubmit:De,fileUploadRef:gn,showFileUpload:g,showModelSelector:p,disableActionButtons:y,fileUploadTooltip:v,showStopButton:S,onStopButtonClick:L,onFilePickerOpen:H,onFilePickerClose:R,startTranscription:$u,stopTranscription:Wl,isTranscribing:as,isTranscriptionInitializing:oo,isTranscriptionAvailable:!0,transcriptionError:Pi,fileUploadErrorMessage:Kl,fileUploadWarningMessage:Yl,activeConnector:wx,uploadedFiles:Ys,handleStartUpload:Qm,handleFileInput:Li,isBoxFilePickerOpen:Nn,handleCloseBoxFilePicker:Xm,cleanupBoxFilePicker:Zm,microsoftFilePickerOptions:Yu,handleCloseMicrosoftFilePicker:M5,handleSelectSharepointSite:Qu,isMicrosoftFilePickerOpen:Jm,fileInputRef:Ym,hasQuery:_a,isAudioVideoFilesEnabled:Oi,setAttachmentErrorMessage:ep,isCometHome:$,isMissionControl:J}),[wx,Zm,y,Gt,Ym,Kl,v,Yl,Xm,Li,Qu,Qm,De,_a,Oi,Nn,Ve,u,oo,Jm,as,t,Yu,M5,R,H,L,n,ep,g,p,d,m,S,$u,Wl,Ys,ot,e,$,J,Pi]),yq=f.useMemo(()=>l.jsx(hie,{showIncognitoHint:b,showSearchModeSelector:h,isFollowUp:u,layoutKey:X,showFileUpload:g,handleFileInput:Li,useThreadSources:m,fileUploadErrorMessage:Kl,fileUploadWarningMessage:Yl,setAttachmentErrorMessage:ep}),[Li,u,X,g,b,h,m,Kl,Yl,ep]),D5=l.jsx(Ale,{value:e,suggestDropdownProps:mq,ResizeableInputWrapperProps:pq,ResizeableInputProps:hq,syncUncontrolledOnce:q,leftAttributionComponents:yq,rightAttributionComponents:gq}),xq=l.jsx("div",{className:"bg-base rounded-2xl",children:l.jsxs(Y,{variant:"subtler",className:z(C,"relative rounded-2xl",{"max-super-override":He}),children:[w,l.jsx("div",{className:as?"-m-px":"",children:as?l.jsx(SP,{borderRadius:17,borderGradientStops:"transparent 135deg, oklch(var(--super-color)) 180deg, transparent 225deg",children:D5}):D5})]})});return l.jsx(Fce,{condition:Ae&&g,Wrapper:Bce,onDrop:Km,allowDropAnywhere:!0,children:l.jsxs(l.Fragment,{children:[!T&&l.jsx(Hce,{isFollowUp:u}),xq]})})},Gce=A.memo(Vce),zce=({shortcut:e,defaultSearchModel:t})=>({id:e.task_id,title:e.task_name,prompt:e.prompt,searchModel:e.model_preference??t,sources:jw(e.sources),preconfigured:e.preconfigured}),qce=["web"];function TYe({prompt:e="",defaultSearchModel:t}){return{title:"",prompt:e,searchModel:t,sources:qce,preconfigured:!1}}const AP=Pe(async()=>{const{ShortcutModal:e}=await W(async()=>{const{ShortcutModal:t}=await import("./ShortcutModal-zDWxcyzt.js");return{ShortcutModal:t}},__vite__mapDeps([68,2,3,12,1,9,5,7,8,6,69,15,13,14,16,17]));return{default:e}});function $ce({reason:e,enabled:t=!0}){const{$t:n}=Q(),[r,s]=f.useState(!1),{openModal:a}=Kt(),o=wt(),i=t,c=On(),u=Po({openPaywallUpsell:c}),{overwriteSources:d}=P0({reason:e}),m=Vs(),{data:p,isStale:h,refetch:g}=CP({reason:e,enabled:i&&r,staleTime:600*1e3}),y=f.useCallback(()=>{r?h&&g():s(!0)},[r,h,g]),b=f.useCallback(()=>{a(AP,{source:"typeahead_create"})},[a]),x=f.useCallback((v,C)=>{u(v),d(C)},[u,d]),_=f.useMemo(()=>{const C=(p??[]).map(w=>({uuid:w.task_id,variant:"shortcut",label:`/${w.task_name}`,queryText:w.prompt,className:"group/shortcut-typeahead-option",action:()=>x(w.model_preference,w.sources),convertToNode:!0,rightElement:({focused:S})=>l.jsx(Wce,{shortcut:w,focused:S,defaultSearchModel:m})}));return i&&o&&C.push({uuid:"create-a-shortcut",variant:"shortcut",label:n({defaultMessage:"+ Create a shortcut",id:"P9a8R5IRCb"}),action:b,convertToNode:!1,isAlwaysVisible:!0}),C},[p,i,o,x,n,b,m]);return f.useMemo(()=>({isShortcutTasksEnabled:i,shortcutsTypeaheadOptions:_,onTrigger:y}),[i,_,y])}function Wce({shortcut:e,focused:t,defaultSearchModel:n}){const{openModal:r}=Kt(),s=f.useCallback(a=>{a.preventDefault(),a.stopPropagation(),r(AP,{source:"typeahead_edit",shortcut:zce({shortcut:e,defaultSearchModel:n})})},[r,e,n]);return l.jsx("div",{className:z("h-5 transition-opacity",t&&"opacity-100",!t&&"opacity-0"),children:l.jsx(pt,{icon:D("edit"),size:"tiny",variant:"common",noPadding:!0,onMouseDown:s})})}const Kce=5e3,Yce=3e3,Qce=(e,t=!0)=>{const n=t&&mn()&&!!ul()?.is_personal_search_enabled,{sidecarSourceTab:{url:r}}=Sn(),s=Zq(r,Yce),a=f.useMemo(()=>["get_tabs_for_sidecar",s],[s]),{data:o=_e}=gt({queryKey:a,queryFn:async()=>(await e.fetchOpenedTabs()).map(c=>{const u=Oh(c.url);return{uuid:String(c.tabId),variant:"tab",label:c.title,url:c.url,icon:u?{type:"image",url:u}:void 0}}),staleTime:Kce,enabled:n});return f.useMemo(()=>({tabs:o,tabAttachmentsEnabled:n}),[n,o])},Xce=({enabled:e,openPaywallUpsell:t})=>{const{$t:n}=Q(),r=Po({openPaywallUpsell:t}),s=E0(),a=yr(),{configuredModel:o}=En(),i=NS(),{gateSearchModeSelection:c}=jo({openPaywallUpsell:t}),u=f.useMemo(()=>{if(!e)return[];const d=a(o);return WR.filter(p=>!(p===d||!i(p))).map(p=>{const h=Ia(p),g=Xw(p),y=gi(p);return{uuid:p,variant:"search-mode",label:n(h),subtitle:g?n(g):void 0,icon:{type:"icon",icon:y},action:()=>{const b=s(p);c(b)||r(b)},convertToNode:!1}})},[e,n,r,s,a,o,i,c]);return{isAtMentionSearchModesEnabled:e,mentionSearchModesOptions:u}},NP=()=>Se.makeQueryKey("/rest/spaces","list","all"),rE=()=>Se.makeQueryKey("/rest/spaces/mentions"),Zce=async({reason:e})=>{const{data:t,error:n,response:r}=await ve.GET("/rest/spaces/mentions",e,{timeoutMs:Ct()});if(n)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to list at mention spaces",cause:n,status:r.status??0});return t};function Jce({reason:e,isLazy:t=!0,enabled:n=!0}){const[r,s]=f.useState(()=>!t),{data:a,isStale:o,refetch:i}=gt({queryKey:rE(),queryFn:()=>Zce({reason:e}),enabled:n&&r,staleTime:600*1e3}),c=f.useCallback(()=>{r?o&&i():s(!0)},[r,o,i]),u=f.useMemo(()=>(a?.spaces??[]).map(m=>({uuid:m.uuid,variant:"space",label:m.title,icon:eue(m)})),[a]);return f.useMemo(()=>({isAtMentionSpacesEnabled:n,mentionSpacesOptions:u,onTrigger:c}),[n,u,c])}function eue(e){if(e.emoji){const t=_S(e.emoji);if(t)return{type:"emoji",char:t}}return{type:"icon",icon:D("layout-grid")}}const tue=({reason:e})=>{const{isAllowed:t,isConnected:n}=no({reason:e}),{sources:r,isSourceAllowed:s}=Ai({isConnectorAllowed:t,isConnectorConnected:n}),a=f.useMemo(()=>r.filter(o=>hi(o)||za(o)||la(o)?!0:K2(o)?!1:yi(o)?n(o):!!W2(o)),[r,n]);return f.useMemo(()=>({sources:a,isSourceAllowed:s}),[a,s])},nue=V({defaultMessage:"Monthly query limit reached",id:"ooSshLDNri"});function rue({isLazy:e=!0,enabled:t=!0,onMentionSource:n}){const{$t:r}=Q(),[s,a]=f.useState(()=>!e),{getSourceLabel:o}=Gs(),{cometMcpSources:i}=Su(),{getSourceLimited:c}=Kf(),{sources:u}=tue({reason:"use-at-mention-sources"}),{trackSourceActivity:d}=I0(),{suggested:m=_e,refresh:p}=j0({sources:u}),h=f.useCallback(_=>{n?.(_),d(_)},[n,d]),g=f.useCallback(_=>{const v=c(_);return{uuid:_,variant:"source",label:o(_),icon:RP(_),action:()=>h(_),disabled:v,subtitle:v?r(nue):void 0,convertToNode:!0}},[o,h,c,r]),y=f.useCallback(_=>({uuid:_,variant:"source",label:o(_),icon:sue({sourceType:_,cometMcpSources:i}),action:()=>h(_),convertToNode:!0}),[o,i,h]),b=f.useMemo(()=>{const _=new Set([...m,...u]);return Array.from(_).map(v=>hi(v)?g(v):y(v))},[g,y,m,u]),x=f.useCallback(()=>{s||a(!0),p()},[s,p]);return f.useMemo(()=>({isAtMentionSourcesEnabled:t,mentionSourcesOptions:b,onTrigger:x}),[t,b,x])}function sue({sourceType:e,cometMcpSources:t}){if(za(e))return aue(e);if(yi(e))return RP(e);if(la(e)){const n=Eu(e),r=t[n];return r?oue(r):void 0}}function aue(e){return{type:"icon",icon:M0[e].icon}}function RP(e){const t=Jf(e);if(t)return{type:"image",url:t}}function oue(e){if(e.iconUrl)return{type:"image",url:e.iconUrl}}const iue=({reason:e,isLazy:t=!0,variants:n,collectionName:r})=>{const[s,a]=f.useState(""),o=Xt(),i=n===void 0||n.includes("tab"),c=n===void 0||n.includes("space"),u=n===void 0||n.includes("shortcut"),d=n===void 0||n.includes("sources"),m=n===void 0||n.includes("search-mode"),{tabs:p,tabAttachmentsEnabled:h}=Qce(o,i),{isAtMentionSpacesEnabled:g,mentionSpacesOptions:y,onTrigger:b}=Jce({reason:e,isLazy:t,enabled:c}),{isShortcutTasksEnabled:x,shortcutsTypeaheadOptions:_,onTrigger:v}=$ce({reason:e,enabled:u}),C=On(),{isAtMentionSearchModesEnabled:w,mentionSearchModesOptions:S}=Xce({enabled:m,openPaywallUpsell:C}),{addSource:E,removeSource:T}=HI({useThreadSources:!1,reason:e}),k=vD(),M=f.useRef([]);f.useEffect(()=>{const F=qee(k?.root);M.current.filter($=>!F.includes($)).filter(Uj).forEach($=>{T($)}),M.current=F},[k,T]);const N=f.useCallback(F=>E(F),[E]),{isAtMentionSourcesEnabled:P,mentionSourcesOptions:O,onTrigger:L}=rue({isLazy:t,enabled:d,onMentionSource:N}),H=f.useMemo(()=>[...h&&s==="@"?p:[],...g&&s==="@"?y:[],...P&&s==="@"?O:[],...w&&s==="/"?S:[],...x&&s==="/"?_:[]],[w,S,h,s,p,g,y,x,_,P,O]),R=f.useCallback(F=>{a(F),F==="@"?(b(),L()):F==="/"&&v()},[v,b,L]),I=lue({isAtMentionSourcesEnabled:P,isShortcutTasksEnabled:x,isAtMentionCometTabsEnabled:h,collectionName:r});return f.useMemo(()=>({mentionTypeaheadOptions:H,inputPlaceholder:I,onTriggerTypeahead:R}),[H,I,R])},lue=({isAtMentionSourcesEnabled:e,isShortcutTasksEnabled:t,isAtMentionCometTabsEnabled:n,collectionName:r})=>{const{$t:s}=Q();return f.useMemo(()=>{try{if(typeof document>"u")return""}catch{return}const a=n||e,o=t;return r?a&&o?s({defaultMessage:"Ask anything about { collectionName }. Type @ for sources and / for shortcuts.",id:"O5pBAHq55y"},{collectionName:r}):a?s({defaultMessage:"Ask anything about { collectionName }. Type @ for sources.",id:"/Irv5dQlqt"},{collectionName:r}):o?s({defaultMessage:"Ask anything about { collectionName }. Type / for shortcuts.",id:"1uFeAjMFYC"},{collectionName:r}):s({defaultMessage:"Ask anything about { collectionName }.",id:"3ZcezoTfiM"},{collectionName:r}):s(a&&o?{defaultMessage:"Ask anything. Type @ for sources and / for shortcuts.",id:"20VHW0rjbO"}:a?{defaultMessage:"Ask anything. Type @ for sources.",id:"12Vhg7cB6+"}:o?{defaultMessage:"Ask anything. Type / for shortcuts.",id:"h47ZleZwvf"}:Yn[K.SEARCH].askInputPlaceholder)},[s,n,e,t,r])},DP="comet.sidecar-input-state";function cue(){try{const e=Za.getItem(DP);if(!e)return{};const t=JSON.parse(e);return t&&typeof t=="object"?t:{}}catch{return{}}}function $4(e){Za.setItem(DP,JSON.stringify(e))}function uue({cometState:e,onSubmit:t}){const{tabId:n,secondaryTab:r}=e.sidecarSourceTab,s=nn(),a=f.useMemo(()=>js(n,r?.tabId),[n,r?.tabId]),o=f.useRef(cue()),[i,c]=f.useState(o.current[a]?.rawQuery??""),[u,d]=f.useState(o.current[a]?.rawQueryJson??void 0);f.useEffect(()=>{const g=o.current[a]??{},y=g.rawQuery??"",b=g.rawQueryJson??void 0;c(x=>x===y?x:y),d(x=>x===b?x:b)},[a]);const m=f.useCallback((g,y)=>{const b=o.current[a]??{};c(g),d(y);const x={...b,rawQuery:g,rawQueryJson:y??null},_={...o.current,[a]:x};o.current=_,$4(_)},[a]),p=f.useCallback(()=>{const g={...o.current};delete g[a],o.current=g,$4(g),c(""),d(void 0)},[a]),h=f.useCallback(g=>{const y=s.get("source"),b=GC(y)?y:"user";p(),t?.({...g,promptSource:g.promptSource||b})},[p,t,s]);return f.useMemo(()=>({persistedValue:i,persistedJson:u,persist:m,onSubmit:h}),[u,m,i,h])}const due={"my.apps.factset.com":"www.factset.com"},bf=A.memo(function({domain:t,overrideIconUrl:n,size:r=16,hideBorder:s=!1,className:a,...o}){const i=due[t]||t,c=LC(i,128),u=f.useMemo(()=>n||c,[n,c]),[d,m]=f.useState(!0);f.useEffect(()=>{m(!0)},[u]);const p=f.useMemo(()=>({width:r,height:r}),[r]),h=f.useMemo(()=>({width:r*.7,height:r*.7}),[r]);return l.jsxs("div",{style:{width:r,height:r},className:z("relative shrink-0 overflow-hidden rounded-full",a),...o,children:[d?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:z("rounded-inherit absolute inset-0",!s&&"bg-white")}),l.jsx("img",{className:"relative block",src:u,alt:`${t} favicon`,width:r,height:r,onLoad:g=>{const y=g.target,b=n!==void 0||y.naturalWidth!==16||y.naturalHeight!==16;m(b||t!==i)},onError:()=>{m(!1)},style:{width:r,height:r}})]}):l.jsx(Y,{variant:"subtle",style:p,className:"inline-flex items-center justify-center",children:l.jsx(ye,{icon:D("world"),className:"text-quietest relative block",style:h})}),!s&&l.jsx("div",{className:"rounded-inherit absolute inset-0 border border-[black]/10 dark:border-transparent"})]})}),fue=({url:e,title:t,secondaryUrl:n,secondaryTitle:r,userSelection:s})=>l.jsxs(Y,{className:z("ml-one gap-sm relative flex flex-1 flex-col",t?"p-sm":void 0),children:[t&&l.jsxs("div",{className:"gap-md flex items-center",children:[l.jsxs("div",{className:"gap-sm flex flex-1 items-center",children:[l.jsx("div",{className:"shrink-0",children:l.jsx(bf,{size:20,domain:Ph(e),hideBorder:!0,className:"rounded-md border-none bg-none",overrideIconUrl:Oh(e)})}),t&&l.jsx(B,{lineClamp:1,variant:"tiny",color:"light",children:t})]}),n&&l.jsxs("div",{className:"gap-sm flex flex-1 items-center",children:[l.jsx("div",{className:"shrink-0",children:l.jsx(bf,{size:20,domain:Ph(n),hideBorder:!0,className:"rounded-md border-none bg-none",overrideIconUrl:Oh(n)})}),r&&l.jsx(B,{lineClamp:1,variant:"tiny",color:"light",children:r})]})]}),l.jsx(Wt,{children:s?.text&&l.jsx(ze.div,{className:"ml-[28px]",initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:8},transition:{duration:.2,ease:"easeOut"},children:l.jsxs(B,{variant:"tiny",color:"light",lineClamp:2,className:"italic",children:['"',s.text,'"']})})})]}),mue=Pe(async()=>{const{SearchInputNote:e}=await W(async()=>{const{SearchInputNote:t}=await import("./SearchInputNote-0woq8JZT.js");return{SearchInputNote:t}},__vite__mapDeps([70,2,3,5,1,6,7,8,9]));return{default:e}}),W4={readAccess:V({defaultMessage:"Your organization restricts Comet from reading content on this domain.",id:"W4u94wDpqj"}),browserControl:V({defaultMessage:"Your organization restricts Comet from controlling the browser on this domain.",id:"gAS0LSVII5"})};function pue({isNonAgenticActionsDisabled:e,isAgenticActionsDisabled:t,$t:n}){return e?n(W4.readAccess):t?n(W4.browserControl):null}const IP=A.memo(function(t){const{value:n,json:r,onChange:s,onSubmit:a,...o}=t,i="sidecar-ask-input",c=Xt(),{shouldShowModelSelector:u}=Mu(),d=Sn(),{persistedValue:m,persistedJson:p,persist:h,onSubmit:g}=uue({cometState:d,onSubmit:a}),{mentionTypeaheadOptions:y,onTriggerTypeahead:b}=iue({reason:i,isLazy:!0});f.useEffect(()=>c.subscribeToCometQuery((L,{source:H})=>{g({query:L,forceFork:!0,promptSource:GC(H)?H:"user"})}),[c,g]);const x=Xt();f.useEffect(()=>{function L(H){H.key==="Escape"&&x.deactivateScreenshotTool()}return window.addEventListener("keydown",L),()=>{window.removeEventListener("keydown",L)}},[x]);const{sidecarSourceTab:{url:_,title:v,secondaryTab:C}}=d,w=d.actions.getUserSelection(),S=f.useCallback((L,H)=>{h(L,H),s(L,H)},[h,s]),{isAgenticActionsDisabled:E,isNonAgenticActionsDisabled:T}=fS(),k=ns(),M=On(),N=Po({openPaywallUpsell:M});f.useEffect(()=>{E&&k===K.BROWSER_AGENT&&N(te.PRO)},[E,k,N]);const{$t:P}=Q(),O=pue({isNonAgenticActionsDisabled:T,isAgenticActionsDisabled:E,$t:P});return l.jsxs("div",{className:"bg-base rounded-2xl",children:[l.jsx(Gce,{disablePremiumSourceLimitWarning:!0,value:m,json:p,onChange:S,onSubmit:g,headerComponent:_?l.jsx(fue,{url:_,title:v,userSelection:w,secondaryUrl:C?.url,secondaryTitle:C?.title}):void 0,forceHideSuggestions:!!w,autofocus:!0,showModelSelector:u,showFileUpload:!0,hasShadow:!0,showIncognitoHint:!0,showSources:!1,dropdownPlacement:"top",syncUncontrolledOnce:!0,mentionTypeaheadOptions:y,onTriggerTypeahead:b,initialLayout:"expanded",minRows:1,className:"shadow-[0_36px_16px_36px_oklch(var(--background-base-color))] dark:shadow-[0_4px_12px_rgba(0,0,0,0.12),0_32px_16px_36px_oklch(var(--dark-background-base-color))]",...o}),O&&l.jsx("div",{className:"relative mt-sm -mb-sm",children:l.jsx(mue,{variant:"info",text:O,link:"https://www.perplexity.ai/help-center/en/articles/13531931-my-organization-has-restricted-comet"})})]})}),hue="chrome://settings/assistant",gue=A.memo(function({onLearnMore:t}){const{$t:n}=Q();return l.jsx(B,{color:"light",variant:"tinyRegular",className:"text-balance",textCenter:!0,children:n({defaultMessage:"Comet Assistant uses the current page and relevant browser history to provide answers to your questions. <link>Learn more</link>",id:"+FQWtBvxT2"},{link:r=>l.jsx(B,{as:"button",color:"light",variant:"tinyRegular",onClick:t,className:"hover:text-super cursor-pointer underline",inline:!0,children:r})})})}),yue=A.memo(function({isVisible:t=!0,showPrivacyEducation:n=!1}){const{$t:r}=Q(),s=Xt(!1),a=()=>{s?.openNewTab(hue)};return l.jsxs("div",{className:"gap-md px-lg pb-xl fixed inset-0 z-10 flex flex-col items-center justify-center",children:[l.jsx(ye,{icon:D("custom-brand-comet-display"),size:64,className:z("text-quietest opacity-0 transition-opacity",{"!opacity-100":t})}),l.jsxs("div",{className:"gap-2xs flex flex-col items-center",children:[l.jsx(B,{variant:"section-title",color:"light",children:r({defaultMessage:"Assistant",id:"CxJqEDZI3a",description:"Assistant"})}),n&&l.jsx(gue,{onLearnMore:a})]})]})}),jP="pplx.sidecar_privacy_education_hidden_after_query",xue=A.memo(function(){const[t,n,r]=Kee({csrRedirect:!0}),[,s]=vs(jP,!1),a=f.useCallback(o=>{s(!0),r.onSubmit(o)},[r,s]);return l.jsx("div",{className:"relative",children:l.jsx(IP,{...r,onSubmit:a,value:t,json:n,querySource:"home"})})}),PP=A.memo(function(){const{variation:t}=Xee(!1),[n]=vs(jP,!1),r=t&&!n;return l.jsx(dS,{disableNewThread:!0,disableOpenInTab:!0,children:l.jsxs("div",{className:"px-md isolate mx-auto size-full min-w-[420px] sm:max-w-screen-md",children:[l.jsx(yue,{showPrivacyEducation:r}),l.jsx("div",{className:"relative flex h-full flex-col",children:l.jsx(x0,{children:l.jsx(Y,{className:"mt-md pointer-events-none static z-10 w-full grow flex-col items-center justify-center",children:l.jsx("div",{className:"bottom-md pointer-events-auto absolute w-full",children:l.jsx(xue,{})})})})})]})})});function K4(e,t){let n;return(...r)=>{window.clearTimeout(n),n=window.setTimeout(()=>e(...r),t)}}function Ni({debounce:e,scroll:t,polyfill:n,offsetSize:r}={debounce:0,scroll:!1,offsetSize:!1}){const s=n||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[a,o]=f.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),i=f.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:a,orientationHandler:null}),c=e?typeof e=="number"?e:e.scroll:null,u=e?typeof e=="number"?e:e.resize:null,d=f.useRef(!1);f.useEffect(()=>(d.current=!0,()=>void(d.current=!1)));const[m,p,h]=f.useMemo(()=>{const x=()=>{if(!i.current.element)return;const{left:_,top:v,width:C,height:w,bottom:S,right:E,x:T,y:k}=i.current.element.getBoundingClientRect(),M={left:_,top:v,width:C,height:w,bottom:S,right:E,x:T,y:k};i.current.element instanceof HTMLElement&&r&&(M.height=i.current.element.offsetHeight,M.width=i.current.element.offsetWidth),Object.freeze(M),d.current&&!Cue(i.current.lastBounds,M)&&o(i.current.lastBounds=M)};return[x,u?K4(x,u):x,c?K4(x,c):x]},[o,r,c,u]);function g(){i.current.scrollContainers&&(i.current.scrollContainers.forEach(x=>x.removeEventListener("scroll",h,!0)),i.current.scrollContainers=null),i.current.resizeObserver&&(i.current.resizeObserver.disconnect(),i.current.resizeObserver=null),i.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",i.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",i.current.orientationHandler))}function y(){i.current.element&&(i.current.resizeObserver=new s(h),i.current.resizeObserver.observe(i.current.element),t&&i.current.scrollContainers&&i.current.scrollContainers.forEach(x=>x.addEventListener("scroll",h,{capture:!0,passive:!0})),i.current.orientationHandler=()=>{h()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",i.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",i.current.orientationHandler))}const b=x=>{!x||x===i.current.element||(g(),i.current.element=x,i.current.scrollContainers=OP(x),y())};return _ue(h,!!t),bue(p),f.useEffect(()=>{g(),y()},[t,h,p]),f.useEffect(()=>g,[]),[b,a,m]}function bue(e){f.useEffect(()=>{const t=e;return window.addEventListener("resize",t),()=>void window.removeEventListener("resize",t)},[e])}function _ue(e,t){f.useEffect(()=>{if(t){const n=e;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[e,t])}function OP(e){const t=[];if(!e||e===document.body)return t;const{overflow:n,overflowX:r,overflowY:s}=window.getComputedStyle(e);return[n,r,s].some(a=>a==="auto"||a==="scroll")&&t.push(e),[...t,...OP(e.parentElement)]}const vue=["x","y","top","bottom","left","right","width","height"],Cue=(e,t)=>vue.every(n=>e[n]===t[n]),LP=()=>KY()==="firefox"?!0:typeof window>"u"?!1:new URL(window.location.href).searchParams.get("pc")==="firefox",Y4="partnerships",FP=()=>YY()===Y4?!0:typeof window>"u"?!1:new URL(window.location.href).searchParams.get("utm_source")===Y4,wue=Pe(async()=>{const{InstallGateModal:e}=await W(async()=>{const{InstallGateModal:t}=await import("./InstallGateModal-DA6CfkbM.js");return{InstallGateModal:t}},__vite__mapDeps([71,2,3,5,1,6,7,8,9,46,15,49,13,12,14,16,17]));return{default:e}}),UP=()=>{const{openModal:e}=Kt(),{isMobileUserAgent:t}=Be(),n=Si(),r=LP(),s=FP(),{device:{isSamsungBrowser:a}}=jn(),o=f.useCallback(({origin:i,sheetModalVariant:c,closeCallback:u})=>{!t||n||r||s||a||e(wue,{origin:i,sheetModalVariant:c,onClose:u})},[r,n,t,s,a,e]);return f.useMemo(()=>({openInstallUpsell:o}),[o])},Sue=()=>{const e=wt(),{isMobileUserAgent:t}=Be(),{firstResult:n}=Ht(),r=n?.author_username,{openInstallUpsell:s}=UP(),[a,o]=ml("shareGateImpressions",0),i=f.useRef(!1),c=nn(),u=c?.get("installGate"),d=c?.get("q");f.useEffect(()=>{i.current||e||t&&(!r&&!d||lN()||cN()||uN()||u==="true"&&(a>=WN||(s({origin:Ke.SHARED_THREAD_INSTALL_GATE,sheetModalVariant:"inset-centered-sheet"}),o(a+1),i.current=!0)))},[o,r,t,d,u,e,s,a])},Eue=()=>{const{device:{isMetaBrowser:e,isIOS:t,isAndroid:n}}=jn();return f.useCallback(()=>{if(!e||typeof window>"u")return;const s=window.location.href;let a;t?a=s.replace(/^https?:\/\//,"x-safari-https://"):n&&(a=`intent://${s.replace(/^https?:\/\//,"")}#Intent;scheme=https;package=com.android.chrome;end`),a&&oa(a,"Redirecting to native browser")},[e,t,n])};function sE(e){return e===document.documentElement}function m_(e){return sE(e)?window.scrollY:e.scrollTop}function BP(e){return sE(e)?window.innerHeight:e.clientHeight}function HP(e){return e.scrollHeight}function Q4(e,t,n="smooth"){sE(e)?window.scrollTo({top:t,behavior:n}):e.scrollTo({top:t,behavior:n})}function p_(e){const t=HP(e),n=BP(e),r=m_(e);return Math.abs(t-n-r)<=1}const kue=(e,t)=>e?"full-sheet-blurred":t==="delayed"?"bottom-sheet-gradient":"centered-sheet",Mue=()=>{const{$t:e}=Q(),t=wt(),{isMobileUserAgent:n}=Be(),{firstResult:r}=Ht(),s=r?.author_username,{openVisitorLoginUpsell:a}=ws({enabled:!0}),[o,i]=ml("shareGateImpressions",0),c=f.useRef(!1),u=nn(),{scrollContainerRef:d}=xa(),[m,p]=f.useState(!1),h=Eue(),g=u?.get("visitorGate"),y=u?.get("q");f.useEffect(()=>{const b=d.current;if(b)return b.addEventListener("scroll",()=>{p(p_(b))}),()=>{b.removeEventListener("scroll",()=>{p(p_(b))})}},[d]),f.useEffect(()=>{c.current||t||!s&&!y||cN()||uN()||o>=WN||g==="false"||g==="delayed"&&!m||!g&&!(!n&&!y)||(h(),a({origin:Ke.SHARED_THREAD_LOGIN_GATE,description:"",title:e({defaultMessage:"Instant answers at your fingertips",id:"NFjQpck2Ql"}),sheetModalVariant:kue(n,g),overrideMobileVariant:!0}),i(o+1),c.current=!0)},[n,t,a,e,o,i,m,g,u,s,h,y])},Tue=({platform:e,miniInstaller:t}={})=>{e=e??"mac_arm64";const n={channel:"stable",platform:e};(t??e.includes("win"))&&(n.mini="1");const s=new URLSearchParams(n),a=new URL("https://www.perplexity.ai/rest/browser/download");return a.search=s.toString(),a},Aue="COMET_USER",Nue=async e=>{try{const{error:t,response:n}=await ve.POST("/rest/homepage-widgets/upsell/add-to-cohort","add user to cohort",{body:{cohort:e},timeoutMs:Ct()});if(t)throw new Ue("API_CLIENTS_ERROR",{cause:t,status:n.status??0});return n.ok}catch(t){return Z.error("Error adding user to cohort",{error:t,cohort:e}),!1}},Rue=async()=>Nue(Aue),Due=Pe(async()=>{const{CometDownloadInstructionsModal:e}=await W(async()=>{const{CometDownloadInstructionsModal:t}=await import("./CometDownloadInstructionsModal-B8VLx4dz.js");return{CometDownloadInstructionsModal:t}},__vite__mapDeps([72,2,3,5,1,6,7,8,9,49,13,12,14,15,16,17]));return{default:e}}),Iue=({isUnsupportedDevice:e,isWindows:t})=>{const{session:n}=je(),{trackEvent:r}=Ze(n),{sendCometDownloadedEventSingular:s,sendCometDownloadButtonClickedEventSingular:a}=oR(),{openToast:o}=cn(),{openModal:i}=Kt(),{$t:c}=Q(),u=f.useCallback(async(h,g)=>{o({message:c({defaultMessage:"Comet is downloading",id:"hCO9dUOI91"}),description:c({defaultMessage:"Check your browser's downloads to open the Comet installer.",id:"hRzUheg7aj"}),iconOverride:D("download"),variant:"success",timeout:5}),!h&&g&&i(Due,{requestedPlatform:g})},[o,c,i]),d=f.useCallback(async(h,{upsellName:g,partnerCode:y,preventDownloadInstructionsModal:b})=>{u(b,h),Jq(),r("click download comet",{requestedPlatform:h,upsellName:g,installPartner:y}),s(),setTimeout(()=>oa(Tue({platform:h}).href,"Comet download"),250)},[r,s,u]),m=f.useCallback(async({upsellName:h,partnerCode:g,preventDownloadInstructionsModal:y})=>{if(!e)return await Rue(),t?d("win_x64",{upsellName:h,partnerCode:g,preventDownloadInstructionsModal:y}):d("mac_arm64",{upsellName:h,partnerCode:g,preventDownloadInstructionsModal:y})},[d,t,e]),p=f.useCallback(({upsellName:h,partnerCode:g})=>{a("download-comet"),m({upsellName:h,partnerCode:g})},[a,m]);return{handleDownload:m,handleDownloadClick:p}},jue=`__merge-ah-script__${crypto.randomUUID()}`;async function Pue(){return OC({id:jue,src:"https://ah-cdn.merge.dev/initialize.js"})}function Oue(e){const t=f.useCallback(async()=>{const r=e?.linkToken;if(!r)throw new Error("Link token is required");await Pue(),await new Promise(s=>{window.AgentHandlerLink.initialize({...e,linkToken:r,enable_telemetry:!1,onReady:()=>s()})})},[e]);return f.useCallback(async()=>{await t(),window.AgentHandlerLink&&window.AgentHandlerLink.openLink(e)},[e,t])}const AYe="/account/connectors",Lue={GCAL_CONNECT:"gcal_connect",CONNECTOR_COMPLETE:"connector_complete"},Fue={UPSELL_CONNECTOR:"upsell-connector-channel"},Uue=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"thread-upsell-payment-modal",defaultValue:e,extraAttributes:t,subjectType:"user_nextauth_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},Bue=(e,t,n)=>{const{value:r,loading:s}=VC({flag:"web-hard-login-gate",defaultValue:e,extraAttributes:t,subjectType:"visitor_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},aE=({visitorDailyQueryCount:e})=>{const t=wt(),n=pR(),{isMobileUserAgent:r}=Be(),{device:{isSamsungBrowser:s}}=jn(),{specialCapabilities:a}=gr(),{variation:o,loading:i}=Bue("control",void 0,[{condition:()=>n,result:"control"},{condition:()=>t,result:"control"},{condition:()=>r,result:"control"},{condition:()=>s,result:"control"},{condition:()=>a.unlimitedProSearch,result:"control"},{condition:()=>e===void 0||e<=2,result:"control"}]);return f.useMemo(()=>({variation:o,loading:i}),[o,i])},VP="writable-spaces",GP="recentCollections",Hue=e=>{const{accessLevel:t,enableWebByDefault:n,...r}=e;return{...r,access:t,enable_web_by_default:n}},zP=async({params:e,reason:t})=>{const n=Hue(e);e.template_id&&(n.template_id=e.template_id);const{data:r,error:s,response:a}=await ve.POST("/rest/collections/create_collection",t,{body:n,timeoutMs:Ct()});if(s||!r)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to create collection",cause:s,status:a.status??0});return r},Vue=({reason:e})=>{const t=It();return on({mutationFn:async({title:n,description:r,emoji:s,instructions:a,accessLevel:o,template_id:i,callback:c})=>{const u=await zP({params:{title:n,description:r,emoji:s,instructions:a,accessLevel:o,template_id:i},reason:e});return c(u),{collection:u}},onMutate:async({...n})=>{t.setQueryData(lr(),r=>{r=r||{pages:[],pageParams:[]};const s=r.pages[0]||[],a={...s.length>0?s[0]:{},...n,uuid:yc,thread_count:0};return{...r,pages:[[a,...s]]}})},onSuccess:async()=>{t.refetchQueries({queryKey:lr()}),t.invalidateQueries({queryKey:Se.makeQueryKey(GP)}),t.invalidateQueries({queryKey:rE()}),t.invalidateQueries({queryKey:NP()}),t.invalidateQueries({queryKey:Se.makeQueryKey(VP)})}})},Gue=e=>Se.makeQueryKey("/rest/article/{article_uuid_or_slug}",{uuid:e}),oE=e=>Se.makeQueryKey("articleResults",{frontend_context_uuid:e}),X4=e=>Se.makeQueryKey("article-slug",e),zue=(e,t)=>e.getQueryData(["results"])?.find(r=>r.frontend_context_uuid===t)?.collection_info,que=(e,t)=>e.getQueryData(oE(t))?.find(r=>r.frontend_context_uuid===t)?.collection_info,$ue=(e,t,n)=>{e.setQueryData(oE(t),r=>r&&r.map(n))},Wue=()=>{const{searchTerm:e}=KD(),t=It(),n=sr(),r=Lw(),s=m0({search_term:e??""}),a=wJ({search_term:e??""}),o=n?.startsWith("/page")||n?.startsWith("/discover"),i=o?"articleResults":"results",c=o?a:s,u=o?Gue:SJ,d=o?que:zue,m=f.useCallback((h,g,y)=>{r(b=>b&&b.map(y))},[r]);return{queryClient:t,searchTerm:e,listItemsKey:c,resultsStore:i,fetchByUUIDKey:u,getCachedCollectionInfo:d,updateResultsCache:o?$ue:m,mutateResults:r}},Kue=e=>e?.toLowerCase(),yh=e=>Kue(e.status)==="pending",Yue=e=>e.find(t=>yh(t)&&t.backend_uuid),Que=e=>!!(e&&ko(e)&&"blocks"in e[0]),Xue=async({slugOrUUID:e,headers:t,reason:n})=>{const{data:r,error:s,response:a}=await ve.GET("/rest/article/{article_uuid_or_slug}",n,{params:{path:{article_uuid_or_slug:e}},headers:t,timeoutMs:Ct({productionMs:3e3}),numRetries:1});if(s)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to get article",cause:s,status:a.status??0});if(r.status!=="success")throw new Ue("API_CLIENTS_ERROR",{message:"Failed to get article - not successful",cause:r,status:a.status??0});return r.entries},Z4=e=>e[0]?.article_info?{title:e[0].article_info.title||"",summary:e[0].article_info.summary||"",suggested_sections:e[0].article_info.suggested_sections||[],audience:e[0].article_info.audience||"anyone",read_time:e[0].article_info.read_time,emphasize_sources:e[0].article_info.emphasize_sources??!1,num_sections:e.length}:null,Zue={isBlocksApi:!1,article:[],heroSection:void 0,isLoading:!1,isPublished:!1,isOrgInternal:!1,inFlight:!1,inFlightLatest:!1,currentlyStreamingSection:void 0,socialStats:{forkCount:0,likeCount:0,viewCount:0,userLikes:!1},threadMetadata:{rwToken:void 0,contextUUID:void 0,frontendContextUUID:void 0,title:void 0,first_query:void 0,focus:void 0,author_id:void 0,author_username:void 0,author_image:void 0,parent_info:void 0,mode:void 0,personalized:!1,collection:void 0,thread_access:0,thread_url_slug:void 0,updated_datetime:void 0,expiry_time:void 0,privacy_state:"NONE"},articleMetadata:{title:"",summary:"",suggested_sections:[],audience:"anyone",read_time:0,emphasize_sources:!1,num_sections:0},articleMedia:[],articleWebResults:[],relatedPages:[],articleLocalState:{isEditModeEnabled:!1,setEditModeEnabled:()=>{},isCreating:!1,setIsCreating:()=>{},isTitleVisible:!0,setTitleVisible:()=>{},clickedImage:null,setClickedImage:()=>{},clickedImageIndex:0,isRewritingSection:!1,setRewritingSection:()=>{}},refetch:()=>{}},qP=Bt("ArticleResultsContext",Zue);A.memo(function({relatedPages:t=_e,children:n,slug:r}){const s="article-results-provider",[a,o]=f.useState(!1),[i,c]=f.useState(!1),[u,d]=f.useState(null),[m,p]=f.useState(!0),[h,g]=f.useState(!1),{isEnterprise:y}=Hs({reason:s}),b=It(),_=nn()?.get("newFrontendContextUUID"),[v,C]=f.useState(b.getQueryData(X4(r||"")));f.useEffect(()=>{if(_){C(_);return}const U=b.getQueryData(X4(r||""));C(U)},[_,b,r]);const{data:w,isLoading:S}=gt({enabled:!!r&&r!=="new",queryKey:oE(v||""),queryFn:()=>Xue({slugOrUUID:r,reason:s}),refetchOnMount:!0,placeholderData:Ja}),E=Que(w),T=f.useMemo(()=>{if(!w||E)return;const U=w[w.length-1];return{inFlight:w.some(yh),inFlightLatest:U&&yh(U)}},[w,E]),k=T?.inFlight??!1,M=T?.inFlightLatest??!1,N=f.useMemo(()=>{if(!(!w||E))return Yue(w)},[w,E]),P=f.useMemo(()=>{if(!w||w.length===0)return null;const U=w[0];if(yh(U))return null;const X=U.social_info;return X?O2(X):O2()},[w]),O=f.useMemo(()=>!w||w.length===0?Ux():Ux(w[0]),[w]),L=f.useMemo(()=>w?Z4(w):null,[w]),H=f.useMemo(()=>{const U=[];return w?.forEach(X=>{if(X.article_info.layout==="media-only"){const ne=(X.article_info.user_selected_media_items??[])?.filter(ae=>ae.medium==="image");U.push(...ne)}else{const J=X?.media_items??[],ne=X?.featured_images??[];X.article_info.layout!=="text"&&(ko(ne)&&ne[0].medium==="image"?U.push(ne[0]):ko(J)&&J[0].medium==="image"&&U.push(J[0]))}}),U},[w]),R=f.useMemo(()=>{if(!u)return 0;const U=H.findIndex(X=>X?.image===u?.image);return U>-1?U:0},[u,H]),I=f.useMemo(()=>{const U=new Map;return!w||w.length===0?[]:(w?.forEach(X=>{const J=Yt.parseAskTextField(X);J?.web_results&&J.web_results.forEach(ne=>{U.has(ne.url)?U.get(ne.url).count+=1:U.set(ne.url,{...ne,count:1})})}),Array.from(U.values()).sort((X,J)=>J.count-X.count).map(X=>({...X,count:void 0})))},[w]),F={isEditModeEnabled:a,setEditModeEnabled:o,isTitleVisible:m,setTitleVisible:p,isCreating:i,setIsCreating:c,clickedImage:u,setClickedImage:d,clickedImageIndex:R,isRewritingSection:h,setRewritingSection:g},G=O??Ux(),j=y&&!!G.collection&&G.thread_access===Yr.COLLECTION_READ,$=!!y&&G.thread_access===Yr.ORG_READ,q=j||$||G.thread_access===Yr.PUBLIC_READ;return l.jsx(qP.Provider,{value:{isBlocksApi:E,article:w??[],isLoading:S,heroSection:w?.[0],lastSection:w?.[w.length-1],socialStats:P,isPublished:q,isOrgInternal:$,inFlight:k,inFlightLatest:M,currentlyStreamingSection:N,threadMetadata:G,articleMetadata:L??Z4([]),articleLocalState:F,articleMedia:H,articleWebResults:I,relatedPages:t},children:n})});const Jue=()=>{const e=f.useContext(qP);if(!e)throw new Error("useArticleResults must be used within ArticleResultsContext");return e},ede=({reason:e})=>{const{isEnterprise:t}=Hs({reason:e}),{threadMetadata:n}=Jue(),r=Mi(),s=Lw();return f.useCallback(o=>{const i=!r&&!n?.rwToken;!t||i||s(c=>{if(c)return c.map(u=>{let d=!1,m=Yr.PRIVATE_READ;return o==="add"?(d=jX.includes(u.thread_access??null),m=Yt.isArticleMode(u)?Yr.PRIVATE_READ:Yr.COLLECTION_READ):(d=u.thread_access!==Yr.COLLECTION_READ,m=Yr.PRIVATE_READ),{...u,thread_access:d?u.thread_access:m}})})},[r,n?.rwToken,t,s])},tde=async({params:e,reason:t})=>{try{const{data:n,error:r,response:s}=await ve.POST("/rest/collections/upsert_thread_collection",t,{body:e});if(r)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to upsert thread collection",cause:r,status:s.status??0});return n}catch{return}},nde=({reason:e})=>{const{queryClient:t,listItemsKey:n,fetchByUUIDKey:r,getCachedCollectionInfo:s,updateResultsCache:a}=Wue(),o=ede({reason:e});return on({mutationFn:async({entryUUID:i,title:c,description:u,emoji:d,instructions:m,accessLevel:p,callback:h,frontendContextUUID:g})=>{const y=await zP({params:{title:c,description:u,emoji:d,instructions:m,accessLevel:p},reason:e});return await tde({params:{new_collection_uuid:y.uuid,entry_uuid:i,return_collection:!1,return_thread:!1},reason:e}),h(y),o("add"),{title:c,description:u,emoji:d,instructions:m,accessLevel:p,newCollection:y}},onMutate:async({entryUUID:i,frontendContextUUID:c,...u})=>{await t.cancelQueries({queryKey:n}),await t.cancelQueries({queryKey:lr()});const d=t.getQueryData(n),m=t.getQueryData(lr());t.setQueryData(lr(),h=>{h=h||{pages:[],pageParams:[]};const g=(h&&h.pages&&h.pages[0])??[],b={...g?.length>0?g[0]:[],...u,uuid:yc,thread_count:1};return{...h,pages:[[b,...g]]}}),t.setQueryData(n,h=>{h=h||{pages:[],pageParams:[]};const g=h.pages.map(y=>y.map(b=>b.uuid===i?{...b,collection:{...b.collection,description:u.description,uuid:yc,title:u.title,emoji:u.emoji}}:b));return{...h,pages:g}}),t.setQueryData(r(i),h=>{const g=h?.collection_info??{};return{...h,collection_info:{...g,uuid:yc,description:u.description,title:u.title,emoji:u.emoji}}});let p=null;return c&&(p=s(t,c)??null,a(t,c,h=>h.frontend_context_uuid===c?{...h,collection_info:{...h.collection_info,uuid:yc,title:u.title,emoji:u.emoji},bookmark_state:"BOOKMARKED"}:h)),{previousThreads:d,previousCollections:m,previousCollectionInfo:p}},onSettled:(i,c,u,d)=>{c?(t.setQueryData(n,d.previousThreads),t.setQueryData(lr(),d.previousCollections),u.frontendContextUUID&&a(t,u.frontendContextUUID,m=>m.frontend_context_uuid===u.frontendContextUUID?{...m,collection_info:d?.previousCollectionInfo??null,bookmark_state:d?.previousCollectionInfo?"BOOKMARKED":"NOT_BOOKMARKED"}:m)):(t.invalidateQueries({queryKey:n}),t.invalidateQueries({queryKey:lr()}),t.invalidateQueries({queryKey:Se.makeQueryKey(GP)}),t.invalidateQueries({queryKey:rE()}),t.invalidateQueries({queryKey:NP()}),u.frontendContextUUID&&a(t,u.frontendContextUUID,m=>m.frontend_context_uuid===u.frontendContextUUID?{...m,collection_info:{...m.collection_info,uuid:i?.newCollection?.uuid,title:i?.newCollection?.title,emoji:i?.newCollection?.emoji,slug:i?.newCollection?.slug},bookmark_state:"BOOKMARKED"}:m))}})},rde=()=>{const{$t:e}=Q(),t=hn(),{mutate:n}=Vue({reason:"create-new-space"}),{mutate:r}=nde({reason:"create-new-space"}),s=f.useCallback(()=>{const o=e({defaultMessage:"New Space",id:"t5xj3BH/Ni"});n({title:o,description:"",emoji:"",instructions:"",accessLevel:dk,enableWebByDefault:!0,callback:i=>{t.push(`/spaces/${i.slug}`)}})},[n,e,t]),a=f.useCallback((o,i)=>{const c=e({defaultMessage:"New Space",id:"t5xj3BH/Ni"});r({title:c,description:"",emoji:"",instructions:"",accessLevel:dk,enableWebByDefault:!0,entryUUID:o,frontendContextUUID:i,callback:u=>{t.push(`/spaces/${u.slug}`)}})},[r,e,t]);return f.useMemo(()=>({handleCreateNewSpace:s,handleCreateNewSpaceForThread:a}),[s,a])},sde=()=>Se.makeQueryKey("/rest/email_assistant/config"),ade=e=>e?Se.makeQueryKey("/rest/email_assistant/scope-status",e):Se.makeQueryKey("/rest/email_assistant/scope-status");function ode({reason:e}){const t=It(),n=wu();return on({mutationKey:["publishArticleMutation"],mutationFn:async({connectorName:r,connectionUUID:s,deleteFiles:a,autoDeleteEmailAssistant:o})=>o?await y4({connectorName:r,reason:e,autoDeleteEmailAssistant:o,connectionUUID:s}):s&&!a?await Use({connectionUUID:s,reason:e}):s&&a?await Bse({connectionUUID:s,reason:e}):await y4({connectorName:r,reason:e,autoDeleteEmailAssistant:o}),onSettled:async(r,s,a)=>{await t.refetchQueries({queryKey:n}),a.autoDeleteEmailAssistant&&(await t.invalidateQueries({queryKey:sde()}),await t.invalidateQueries({queryKey:ade()}))},onMutate:async({connectorName:r,connectionUUID:s})=>{t.setQueryData(n,a=>{if(!a)return a;const o=a.connectors.connectors.map(i=>i.name===r&&(!s||i.connection_uuid===s)?{...i,connected:!1}:i);return{...a,connectors:{connectors:o}}})}})}function ide(e){switch(e){case"SIGN_UP_OR_LOGIN":return()=>W(()=>import("./handleSignUpOrLogin-rPpqwdWZ.js"),[]).then(t=>t.handleSignUpOrLogin);case"PRO_UPGRADE":return()=>W(()=>import("./handleProUpgrade-BzRmY-Kb.js"),__vite__mapDeps([73,3,13,1,2,5,7,8,12,9,6])).then(t=>t.handleProUpgrade);case"SUBSCRIPTION_PROMO":return()=>W(()=>import("./handleSubscriptionPromo-CdEEQWrR.js"),__vite__mapDeps([74,3,1,2])).then(t=>t.handleSubscriptionPromo);case"OPEN_SHEERID_MODAL":return()=>W(()=>import("./handleOpenSheerIdModal-Cm59Hzah.js"),__vite__mapDeps([75,3,6,2,5,1,7,8,9])).then(t=>t.handleOpenSheerIdModal);case"SKIP_BROWSER_AGENT":return()=>W(()=>import("./handleSkipBrowserAgent-hWsQ-4j7.js"),__vite__mapDeps([76,1,2,3,7,8,13,5,12,9,6,14,15,16,17])).then(t=>t.handleSkipBrowserAgent);case"ALLOW_BROWSER_AGENT_ONCE":return()=>W(()=>import("./handleAllowBrowserAgentOnce-C2R7EOw7.js"),__vite__mapDeps([77,1,2,3,7,8,13,5,12,9,6,14,15,16,17])).then(t=>t.handleAllowBrowserAgentOnce);case"ALWAYS_ALLOW_BROWSER_AGENT":return()=>W(()=>import("./handleAlwaysAllowBrowserAgent-Dd8yjd0N.js"),__vite__mapDeps([78,1,2,3,7,8,13,5,12,9,6,14,15,16,17])).then(t=>t.handleAlwaysAllowBrowserAgent);case"CONTINUE_GENERATION":return()=>W(()=>import("./handleContinueGeneration-exAr5NNb.js"),__vite__mapDeps([79,1,2,3,7,8,13,5,12,9,6,14,15,16,17])).then(t=>t.handleContinueGeneration);case"NO_CANVAS_GENERATION":return()=>W(()=>import("./handleNoCanvasGeneration-Bc7PhS-h.js"),__vite__mapDeps([80,1,2,3,7,8,13,5,12,9,6,14,15,16,17])).then(t=>t.handleNoCanvasGeneration);case"CONNECTOR":return()=>W(()=>import("./handleConnector-BSiqlsHl.js"),__vite__mapDeps([81,1,2,3,7,8,13,5,12,9,6,14,15,16,17])).then(t=>t.handleConnector);case"MERGE_AUTH_CONNECTOR":return()=>W(()=>import("./handleMergeAuthConnector-DVdVAkvM.js"),[]).then(t=>t.handleMergeAuthConnector);case"VIRTUAL_TRY_ON_ONBOARDING_MODAL":return()=>W(()=>import("./handleVirtualTryOnOnboardingModal-C308psHV.js"),__vite__mapDeps([82,3,83,12,2,1,9,5,7,8])).then(t=>t.handleVirtualTryOnOnboardingModal);case"COMET_DOWNLOAD":return()=>W(()=>import("./handleCometDownload-ExQiBgGI.js"),[]).then(t=>t.handleCometDownload);case"COMET_DOWNLOAD_1MO_PRO_INCENTIVE":return()=>W(()=>import("./handleCometDownload1moProIncentive-CDtmcmKh.js"),__vite__mapDeps([84,1,2,3])).then(t=>t.handleCometDownload1moProIncentive);case"SET_DEFAULT_BROWSER":return()=>W(()=>import("./handleSetDefaultBrowser-LdfImRuf.js"),[]).then(t=>t.handleSetDefaultBrowser);case"THREAD_TO_SPACE":return()=>W(()=>import("./handleThreadToSpace-Byg6gUWi.js"),[]).then(t=>t.handleThreadToSpace);case"REWRITE_ANSWER":return()=>W(()=>import("./handleRewriteAnswer-DJYG4ncE.js"),__vite__mapDeps([85,1,2,3,7,8,13,5,12,9,6,14,15,16,17])).then(t=>t.handleRewriteAnswer);case"PERMALINK":return()=>W(()=>import("./handlePermalink-DofSHsTF.js"),__vite__mapDeps([86,9,2,3,1,5,7,8])).then(t=>t.handlePermalink);case"SHORTCUT_MODAL":return()=>W(()=>import("./handleShortcutModal-Bho8zyV_.js"),__vite__mapDeps([87,3,1,2])).then(t=>t.handleShortcutModal);case"TOGGLE_SOURCES":return()=>W(()=>import("./handleToggleSources-NP36f6I8.js"),__vite__mapDeps([88,2,3,1,7,8,13,5,12,9,6,14,15,16,17])).then(t=>t.handleToggleSources);case"FULLSCREEN_MODAL":return()=>W(()=>import("./handleFullscreenModal-DcZOR8Sx.js"),__vite__mapDeps([89,3,1,2])).then(t=>t.handleFullscreenModal);case"SHARE_LOCATION":return()=>W(()=>import("./handleShareLocation-D7MX9y4y.js"),[]).then(t=>t.handleShareLocation);case"TRY_FINANCE_AGENT":return()=>W(()=>import("./handleTryFinanceAgent-DVjRbwOp.js"),__vite__mapDeps([90,1,2,3,7,8,13,5,12,9,6,14,15,16,17])).then(t=>t.handleTryFinanceAgent);default:return}}async function lde(e){if(!e.upsellInformation.cta)return!1;const t=ide(e.upsellInformation.cta);return t?(await(await t())(e),!0):!1}const $P=async({uuid:e,success:t,reason:n})=>{try{const{data:r,error:s,response:a}=await ve.POST("/rest/sse/perplexity_connector_auth_response",n,{body:{result:{tool_uuid:e,success:t}},backOffTime:100,numRetries:1,headers:{"Content-Type":"application/json"}});if(r?.status!=="success")throw new Ue("API_CLIENTS_ERROR",{message:"Failed to post perplexity connector auth response",cause:s,status:a.status??0});return!0}catch(r){return Z.error("Failed to post perplexity connector auth response",r),!1}},WP=async e=>{try{const{error:t}=await ve.POST("/rest/homepage-widgets/upsell/interacted","homepage upsell interaction tracking",{body:{upsell_name:e.upsellName,upsell_instance_identifier:e.upsellInstanceIdentifier||null,interaction_type:e.interactionType||null},timeoutMs:Ct(),numRetries:1});t&&Z.error("Failed to mark upsell as interacted",{upsellName:e.upsellName,upsellInstanceIdentifier:e.upsellInstanceIdentifier,interactionType:e.interactionType,error:t})}catch(t){Z.error("Error marking upsell as interacted",{upsellName:e.upsellName,upsellInstanceIdentifier:e.upsellInstanceIdentifier,interactionType:e.interactionType,error:t})}},h_=async e=>{try{const{data:t,error:n,response:r}=await ve.POST("/rest/sse/blocking_event_response","send blocking event response",{body:{response:e},timeoutMs:Ct()});if(n)throw new Ue("API_CLIENTS_ERROR",{cause:n,status:r.status??0});return t?.status==="completed"}catch(t){return Z.error("Error sending blocking event response",{error:t,response:e}),!1}},cde=(e,t)=>{const{value:n,loading:r}=Lt({flag:"maybe-student-domains-regex",defaultValue:e,extraAttributes:t,subjectType:"visitor_id"});return f.useMemo(()=>({variation:n,loading:r}),[n,r])},ude=()=>Se.makeQueryKey("/rest/academic/check-edu-institution"),dde=async({reason:e,headers:t})=>{try{const{data:n}=await ve.GET("/rest/academic/check-edu-institution",e,{timeoutMs:hs.HIGH,headers:t});return n}catch(n){return Z.error("Failed to check institution",n),null}},fde=({reason:e})=>gt({queryKey:ude(),queryFn:()=>dde({reason:e})}),KP=({reason:e})=>{const{isStudent:t}=Zw({reason:e}),{variation:n,loading:r}=cde(!1),{data:s,isLoading:a}=fde({reason:e});return f.useMemo(()=>a||r?{isLoading:!0,signals:{isVerifiedStudent:null,isPossibleStudentByEmail:null,isPossibleStudentByIP:null}}:{isLoading:!1,signals:{isVerifiedStudent:!!t,isPossibleStudentByEmail:!!n,isPossibleStudentByIP:!!s?.institution}},[a,r,n,t,s?.institution])},mde=(e,t,n)=>{const{value:r,loading:s}=Nl({flag:"web-student-price-discount-json",defaultValue:e,extraAttributes:t,subjectType:"user_nextauth_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},J4={monthly:5,yearly:50,yearlyPerMonth:5,hasDiscount:!0},pde=({reason:e})=>{const{signals:t,isLoading:n}=KP({reason:e}),r=f.useMemo(()=>{const a=t.isVerifiedStudent||t.isPossibleStudentByEmail||t.isPossibleStudentByIP;return[{condition:()=>n||!a,result:J4}]},[n,t]),{variation:s}=mde(J4,void 0,r);return{monthly:s.monthly,yearly:s.yearly,yearlyPerMonth:s.yearlyPerMonth,hasDiscount:s.hasDiscount}},hde={currentStep:null,currentIndex:0,steps:[],handleNext:()=>null,handleBack:()=>null,handleComplete:()=>null,insertStep:()=>null,insertStepAndNavigate:()=>null,experimentVariationsMeta:{},setCurrentIndex:()=>null},YP=Bt("MultiStepContext",hde),NYe=({steps:e,experimentVariationsMeta:t,handleFinish:n,initialIndex:r=0,children:s})=>{const[a,o]=f.useState(r),[i,c]=f.useState(e),[u,d]=f.useState(null),[m,p]=f.useState(t),{session:h}=je(),{trackEventTyped:g}=Ze(h);f.useEffect(()=>{c(e)},[e]),f.useEffect(()=>{p(t)},[t]),f.useEffect(()=>{i[a]!==void 0&&g("step visited",{step:i[a],experimentVariationsMeta:m})},[a,m,i,g]),f.useEffect(()=>{if(u!==null){if(o(u),d(null),i[a]===void 0||i[u]===void 0)return;g("step transition",{sourceStep:i[a],destinationStep:i[u],isFinish:!1,experimentVariationsMeta:m})}},[a,m,u,i,g]);const y=f.useCallback((w,S)=>{c(E=>{const T=[...E];return T.splice(S,0,w),T})},[]),b=f.useCallback((w,S)=>{y(w,S),d(S)},[y]),x=f.useCallback(()=>{if(i.length)if(a===i.length-1){if(n?.(),i[a]===void 0)return;g("step transition",{sourceStep:i[a],isFinish:!0,experimentVariationsMeta:m})}else{if(o(a+1),i[a]===void 0||i[a+1]===void 0)return;g("step transition",{sourceStep:i[a],destinationStep:i[a+1],isFinish:!1,experimentVariationsMeta:m})}},[a,i,g,m,n]),_=f.useCallback(()=>{!i.length||a===0||i[a]===void 0||i[a-1]===void 0||(o(a-1),g("step transition",{sourceStep:i[a],destinationStep:i[a-1],isFinish:!1,experimentVariationsMeta:m}))},[a,i,g,m]),v=f.useCallback(()=>{n?.(),i[a]!==void 0&&g("step transition",{sourceStep:i[a],isFinish:!0,experimentVariationsMeta:m})},[a,i,g,m,n]),C=f.useMemo(()=>i[a],[a,i]);return l.jsx(YP.Provider,{value:{currentStep:C,insertStep:y,insertStepAndNavigate:b,handleNext:x,handleBack:_,handleComplete:v,currentIndex:a,steps:i,setCurrentIndex:o,experimentVariationsMeta:m},children:s})};function gde(){const e=f.useContext(YP);if(!e)throw new Error("useMultiStep must be used within MultiStepContext");return e}const yde=({searchParams:e,cleanRedirect:t})=>{if(!e)return null;const r=e.get("redirect");let s=null;try{s=r&&new URL(r).searchParams.get(tw)}catch{return null}return s?s===Ke.GROW_COMET_STUDENTS_COUNTRY?Ke.GROW_COMET_STUDENTS_COUNTRY:s===Ke.GROW_COMET_STUDENTS?Ke.GROW_COMET_STUDENTS:null:null},xde=()=>{const e=nn();return f.useMemo(()=>{const t=e?.get(tw),n=!!yde({searchParams:e,cleanRedirect:!1}),r=t===Ke.STUDENT_LANDING_PAGE,s=t===Ke.GROW_COMET_STUDENTS_COUNTRY;return{loginSource:t,isFromStudentCometGrowth:n,isFromStudentCometGrowthCountry:s,isFromStudentLanding:r,isFromStudentFlow:n||r||s}},[e])},bde=Pe(async()=>W(()=>import("./SheerIDModal-CqLi5A1L.js"),__vite__mapDeps([91,2,3,5,1,6,7,8,9,54,13,12,14,15,16,17])).then(e=>({default:e.SheerIDModal}))),_de=(e,t)=>t.isFromStudentCometGrowthCountry?Ke.GROW_COMET_STUDENTS_COUNTRY:t.isFromStudentCometGrowth?Ke.GROW_COMET_STUDENTS:t.isFromStudentLanding?Ke.STUDENT_LANDING_PAGE:e,vde=({origin:e,customCallbacks:t,fromPaywall:n,openVisitorLoginUpsell:r,openPaywallUpsell:s,handleClickPersonal:a})=>{const{$t:o}=Q(),i=It(),c=wt(),{session:u}=je(),{trackEvent:d}=Ze(u),{handleComplete:m}=gde(),{openModal:p}=Kt(),h=xde(),y=nn()?.get("redirect"),{hasActiveSubscription:b}=Mt(),{signals:x,isLoading:_}=KP({reason:"combined_paywall"}),{hasDiscount:v}=pde({reason:"student_paywall"}),C=f.useCallback(T=>{if(T){if(h.isFromStudentCometGrowth){m();return}if(n&&!b){a({billingPeriod:"yearly",subscriptionTier:"pro",origin:e});return}setTimeout(async()=>{await i.refetchQueries({queryKey:QR}),s({origin:Ke.STUDENT_VERIFICATION_PAYWALL,pitchMessage:{title:o(v?{defaultMessage:"You're now eligible for Pro at a discount",id:"/wR28SVR4V"}:{defaultMessage:"You're now eligible for student Pro features",id:"KeOlFnzuir"})}})},150)}},[n,a,m,s,i,o,h.isFromStudentCometGrowth,b,e,v]),w=f.useCallback(T=>{d("sheerid form redirect",{verificationLocationSource:_de(e,h),verificationRoleType:T}),p(bde,{type:T,onVerificationSuccess:t?.onSuccess??C,onClose:t?.onClose})},[C,e,d,h,p,t]),S=f.useCallback(T=>{if(!c){r({title:o({defaultMessage:"Sign in to unlock Education Pro",id:"UNeU1Y4Zdu"}),origin:h.loginSource??e,disallowedMethods:["apple"],overrideRedirectUrl:y??void 0});return}w(T)},[c,w,r,o,h.loginSource,e,y]),E=h.isFromStudentFlow||!!x.isVerifiedStudent||!!x.isPossibleStudentByEmail||!!x.isPossibleStudentByIP;return{isLoading:!!_,isVerifiedStudent:!!x.isVerifiedStudent,handleStudentTierClick:S,handleVerificationSuccess:C,shouldDefaultToStudent:E,signals:x}};class QP extends Error{constructor(){super("Failed to open popup window")}}function Cde(e){const{url:t,name:n,options:r="width=600,height=700,popup=1",pollIntervalMs:s=500}=e;return new Promise((a,o)=>{const i=window.open(t,n,r);if(!i){o(new QP);return}const c=setInterval(()=>{i.closed&&(clearInterval(c),a())},s)})}const wde={logged_out_image_generation:Ke.IMAGE_GENERATION_IN_THREAD,logged_out_video_generation:Ke.VIDEO_GENERATION_IN_THREAD,subscription_upgrade_video_generation:Ke.VIDEO_GENERATION_IN_THREAD,auto_upgrade_to_pro:Ke.AUTO_UPGRADE_TO_PRO,pro_feature_limit_queries:Ke.PRO_FEATURE_LIMIT_BANNER,pro_feature_limit_files:Ke.PRO_FEATURE_LIMIT_BANNER,login_for_comet_agent_queries:Ke.LOGIN_FOR_COMET_AGENT_QUERIES_IN_THREAD,comet_agent_queries_rate_limited:Ke.COMET_AGENT_QUERIES_RATE_LIMITED_IN_THREAD,pro_upgrade:Ke.PRO_UPGRADE_IN_SIDE_HOMEPAGE,max_feature_limit_labs_queries:Ke.PRO_FEATURE_LIMIT_BANNER,enterprise_max_side:Ke.ENTERPRISE_MAX_UPSELL,logged_out_canvas_generation:Ke.CANVAS_GENERATION_IN_THREAD,free_user_canvas_generation:Ke.CANVAS_GENERATION_IN_THREAD,pro_user_canvas_generation:Ke.CANVAS_GENERATION_IN_THREAD,wait_for_browser_agent_confirmation:Ke.BROWSER_AGENT_CONFIRMATION_IN_THREAD,free_user_post_rewrite_upgrade:Ke.FREE_USER_REWRITE_ANSWER_IN_THREAD,pro_user_post_rewrite_upgrade:Ke.PRO_USER_REWRITE_ANSWER_IN_THREAD,finance_agent_upgrade:Ke.FINANCE_AGENT_UPSELL,advanced_models_quota_low:Ke.ADVANCED_MODELS_QUOTA_LOW,gmail_gcal_connector:Ke.CONNECTORS_UPSELL,homepage_badge:Ke.HOME_PRO_UPGRADE_TOP_BADGE,input_banner_pro_feature_limit:Ke.PRO_FEATURE_LIMIT_BANNER,enterprise:Ke.ENTERPRISE_MAX_UPSELL,subscription_promotion_pro_upgrade:Ke.SUBSCRIPTION_PROMO_DESCRIPTION,free_user_research_limit:Ke.FREE_USER_RESEARCH_LIMIT},rl=({upsellInformation:e,inFlight:t,options:n={}})=>{const r="upsell",s=wt(),{openVisitorLoginUpsell:a}=ws({enabled:!s}),{customHandlers:o}=n,{session:i}=je(),{trackEvent:c}=Ze(i),{lastResult:u}=Ht(),{openModal:d}=Kt(),m=It();eo();const p="?handle_upsell=true",{submitQuery:h}=ya(),{setConfiguredModel:g}=En(),y=Xt(),b=On(),{handleClickPersonal:x}=vI({reason:"subscription-promo-description"}),{handleVerificationSuccess:_}=vde({origin:Ke.STUDENT_VERIFICATION_UPSELL,openVisitorLoginUpsell:a,openPaywallUpsell:b,handleClickPersonal:x}),v="sidecar_thread",{subscriptionTier:C}=Mt(),{device:{isWindowsOS:w,isMacOS:S}}=jn(),E=hn(),{handleConnect:T}=TS({reason:r}),{mutateAsync:k}=ode({reason:r}),{handleCreateNewSpaceForThread:M}=rde(),{connectors:N}=ga({reason:r}),{overwriteSources:P,sources:O}=P0({reason:r}),{handleDownloadClick:L}=Iue({isWindows:w,isUnsupportedDevice:!S&&!w}),{openToast:H}=cn(),{$t:R}=Q(),{data:I}=pD({reason:r}),F=I?.visitor_queries_past_day,{variation:G}=aE({visitorDailyQueryCount:F}),{variation:j}=Uue(!1),$=f.useCallback(()=>{H({message:R({defaultMessage:"Location shared successfully.",id:"WWIuk7kxh5"}),variant:"success",timeout:3}),n?.hideUpsell?.()},[H,R,n]),q=f.useCallback(ie=>{H({message:ie,variant:"error",timeout:3})},[H]),{requestLocation:U}=tS({origin:"upsell_location_banner",onPermissionSuccess:$,onPermissionError:q}),X=e?.cta_information?.merge_auth_token,J=ie=>{if(ie)try{return JSON.parse(ie)}catch{return ie}},ne=f.useCallback(()=>{const ie=e?.cta_information?.merge_auth_callback_uuid;ie&&$P({uuid:ie,success:!0,reason:"Account successfully connected"}),E.push(window.location.pathname+p)},[E,e,p]),ae=f.useCallback(()=>{const ie=e?.backend_uuid||u?.backend_uuid;h_({uuid:ie,event_type:"CONNECTOR_AUTH",connector_auth_action:!0})},[e,u?.backend_uuid]),de=Oue({linkToken:J(X),onSuccess:()=>{if(e?.cta==="MERGE_AUTH_CONNECTOR")return ne();if(e?.cta==="ALLOW_CONNECTOR_AUTH")return ae()}}),oe=f.useCallback(async ie=>{const ue=ie.cta_information?.connector_auth_url,ce=ie.backend_uuid||u?.backend_uuid;if(!ue){Z.error("[ALLOW_CONNECTOR_AUTH] Connector auth URL is not defined",{upsellInformation:ie});return}if(!ce){Z.error("[ALLOW_CONNECTOR_AUTH] Backend UUID is not defined",{upsellInformation:ie});return}try{await Cde({url:ue,name:"_blank",options:""}),await h_({uuid:ce,event_type:"CONNECTOR_AUTH",connector_auth_action:!0}),n?.hideUpsell?.()}catch(me){me instanceof QP&&H({message:R({defaultMessage:"Failed to open popup window",id:"qLj32oAyS7"}),variant:"error",timeout:null}),Z.error("[ALLOW_CONNECTOR_AUTH] Connector auth failed",{upsellInformation:ie,error:me})}},[u?.backend_uuid,n,R,H]),le=f.useCallback(async ie=>{if(!ie.cta_information?.merge_auth_token){Z.error("[ALLOW_CONNECTOR_AUTH] Merge auth token is not defined",{upsellInformation:ie}),H({message:R({defaultMessage:"Failed to start authentication",id:"VykWDR53do"}),variant:"error",timeout:null});return}de()},[H,R,de]),se=f.useCallback(async ie=>ie.cta_information?.merge_auth_token?le(ie):oe(ie),[le,oe]);f.useEffect(()=>{const ie=new BroadcastChannel(Fue.UPSELL_CONNECTOR);return ie.onmessage=ue=>{ue.data.type===Lue.CONNECTOR_COMPLETE&&(window.focus(),oa(window.location.pathname+p,"Connector complete"))},()=>{ie.close()}},[p]);const re=f.useCallback(()=>{if(!e||!e.upsell_type||!e.name)return;const ie={upsellType:e.upsell_type,upsellName:e.name,upsellUuid:e.upsell_uuid,eventMetadata:e.event_metadata,cometSurface:v,subscriptionTier:C};switch(e.app_location){case"MODAL":c("upsell modal opened",{...ie,entryUUID:u?.backend_uuid});break;case"IN_THREAD":case"IN_THREAD_BOTTOM":case"IN_THREAD_INPUT":c("thread upsell banner clicked",{...ie,entryUUID:u?.backend_uuid,cta:e.cta});break;case"SIDEBAR":case"SIDE_CARD":c("side upsell clicked",{...ie});break;case"BANNER":c("banner upsell clicked",{...ie});break;case"COMET_NTP_BANNER":c("ntp banner upsell clicked",{...ie});break}const ue=e.app_location==="MODAL"?"upsell viewed":"upsell clicked";c(ue,{...ie,upsellLocation:e.app_location??"UPSELL_APP_LOCATION_UNSPECIFIED",entryUUID:u?.backend_uuid,cta:e.cta})},[u,c,e,v,C]);return f.useCallback(async()=>{if(!e)return;const ie=e.cta==="SHORTCUT_MODAL"?e.cta_information?.recommended_shortcut?.name:void 0;WP({upsellName:e.name,upsellInstanceIdentifier:ie,interactionType:"click"}),re();const ue=wde[e.name]??Ke.UNSPECIFIED_GENERALIZED_UPSELL,ce={upsellInformation:e,lastResult:u,origin:ue,retryQueryParam:p,inFlight:t,queryClient:m,router:{push:E.push},openModal:d,openToast:H,$t:R,trackEvent:c,cometAdapter:y,connectors:N?.connectors,handleConnect:T,handleDisconnect:k,sources:O,overwriteSources:P,hideUpsell:n?.hideUpsell,isThreadUpsellPaymentModalEnabled:j,openVisitorLoginUpsell:a,openPaywallUpsell:b,handleClickPersonal:x,handleVerificationSuccess:_,handleCreateNewSpaceForThread:M,submitQuery:h,setConfiguredModel:g,handleCometDownloadClick:L,openMergeLink:de,requestLocation:U,hardLoginGateVariation:G};if(e.cta!=null){const me=o?.[e.cta];if(me){await me(ce);return}if(await lde(ce))return}if(e.cta==="ALLOW_CONNECTOR_AUTH"){se(e);return}Z.warn("Unhandled upsell CTA",{cta:e.cta})},[e,re,u,p,t,m,E.push,d,H,R,c,y,N?.connectors,T,k,O,P,n?.hideUpsell,j,a,b,x,_,M,h,g,L,de,U,o,se,G])},ro=()=>{const[e,t]=A.useState(!1);return A.useEffect(()=>{t(!0)},[]),e},Sde=()=>{const e=f.useRef(!1),{results:t,lastResult:n}=Ht(),r=ro(),s=wt(),{openVisitorLoginUpsell:a}=ws({enabled:!s}),o=rl({upsellInformation:n?.upsell_information});f.useEffect(()=>{e.current||r&&t.length>=1&&n&&n.upsell_information?.app_location==="MODAL"&&o().then(()=>{e.current=!0})},[r,s,a,t.length,n,o])},iE=f.createContext({fullWidth:!1,size:"default",currentValue:void 0,registerTabRef:()=>{},unregisterTabRef:()=>{},updateIndicatorRef:{current:()=>{}}});function ty(){return f.useContext(iE)}const Ede=f.memo(function({listRef:t}){const n=ty(),r=f.useRef(null),s=f.useRef(null),[a,o]=f.useState(!1),[i,c]=f.useState({leftPx:0,widthPx:0,opacity:0}),u=f.useCallback(()=>{const d=t.current;if(!d)return;const m=d.querySelector('[data-state="active"]');if(!m)return;const p=d.getBoundingClientRect(),h=m.getBoundingClientRect(),g=h.left-p.left,y=h.width;return c({leftPx:g,widthPx:y,opacity:1}),a||requestAnimationFrame(()=>{o(!0)}),m!==r.current&&s.current&&(r.current&&s.current.unobserve(r.current),s.current.observe(m),r.current=m),m},[t,a]);return f.useEffect(()=>{n.updateIndicatorRef.current=u},[n,u]),f.useEffect(()=>{s.current=new ResizeObserver(()=>{requestAnimationFrame(()=>{u()})});const d=u();return d&&(s.current.observe(d),r.current=d),()=>{s.current?.disconnect(),s.current=null,r.current=null}},[u,t]),l.jsx("span",{className:z("absolute bottom-0 h-two bg-inverse pointer-events-none",{"transition-[transform,width,opacity] duration-300 ease-in-out":a}),style:{transform:`translateX(${i.leftPx}px)`,width:`${i.widthPx}px`,opacity:i.opacity},"aria-hidden":"true"})}),kde=Rl("flex flex-row flex-nowrap",{variants:{showBottomBorder:{false:"",true:"border-b border-subtler"},fullWidth:{false:"",true:"gap-0"},size:{default:"h-[54px]",compact:"h-[44px]"}},compoundVariants:[{fullWidth:!1,size:"default",class:"gap-5"},{fullWidth:!1,size:"compact",class:"gap-4"}],defaultVariants:{showBottomBorder:!1,fullWidth:!1,size:"default"}});function Mde({children:e,"aria-label":t,showBottomBorder:n=!1,fullWidth:r=!1,size:s="default",...a}){const o=Tl(a),i=ty(),c=f.useRef(null),u=f.useMemo(()=>({...i,fullWidth:r,size:s}),[i,r,s]);return l.jsx(iE.Provider,{value:u,children:l.jsxs(tee,{ref:c,"aria-label":t,className:z(kde({showBottomBorder:n,fullWidth:r,size:s}),"relative"),...o,children:[e,l.jsx(Ede,{listRef:c})]})})}function Tde({value:e,children:t,...n}){const r=Tl(n),{currentValue:s,animation:a="none"}=ty(),o=s===e,i=a!=="none",c=l.jsx(ree,{value:e,className:"focus:outline-none",forceMount:i||void 0,...r,children:t});switch(a){case"fade":return l.jsx(da.Fade,{isVisible:o,className:"col-start-1 row-start-2",children:c});case"none":return c;default:St(a)}}const Ade=Rl(z("reset interactable","font-sans font-medium select-none","transition-colors duration-300","relative","flex gap-1.5 items-center","text-sm text-foreground"),{variants:{isIconOnly:{false:z("data-[state=inactive]:opacity-80","data-[state=active]:opacity-100"),true:z("data-[state=inactive]:opacity-80","data-[state=active]:opacity-100")},disabled:{false:"cursor-pointer",true:"cursor-not-allowed opacity-70"},fullWidth:{false:"",true:"flex-1 justify-center"},size:{default:"py-3.5",compact:"py-2"}},compoundVariants:[{isIconOnly:!1,disabled:!1,class:"data-[state=inactive]:hover:opacity-100"},{isIconOnly:!0,class:"px-3"}],defaultVariants:{isIconOnly:!1,disabled:!1,fullWidth:!1,size:"default"}});function Nde(e){const{value:t,disabled:n=!1,...r}=e,s=Tl(r),{fullWidth:a,size:o,registerTabRef:i,unregisterTabRef:c}=ty(),u=f.useRef(null),d="icon"in e,m=d?e.icon:e.leadingIcon,p=d?void 0:e.children,h=d?e["aria-label"]:void 0;f.useLayoutEffect(()=>(i(t,u),()=>c(t)),[t,i,c]);const g=l.jsxs(nee,{ref:u,value:t,disabled:n,"aria-label":d?h:void 0,className:z("group",Ade({isIconOnly:d,disabled:n,fullWidth:a,size:o})),...s,children:[m&&l.jsx(_n,{icon:m,size:"medium"}),p]});return d&&h?l.jsx(wn,{content:h,side:"bottom",disabled:n,children:l.jsx("span",{className:z("inline-flex",a&&"flex-1"),children:g})}):g}function Rde(e){const{children:t,onValueChange:n,animation:r="none",...s}=e,a=Tl(s),o="value"in e?{value:e.value}:{defaultValue:e.defaultValue},[i,c]=f.useState(o.defaultValue),u=f.useRef(new Map),d=f.useRef(()=>{}),m=f.useCallback((g,y)=>{u.current.set(g,y)},[]),p=f.useCallback(g=>{u.current.delete(g)},[]),h=f.useCallback(g=>{c(g),n?.(g),requestAnimationFrame(()=>{d.current()})},[n]);return f.useEffect(()=>{e.value!==void 0&&requestAnimationFrame(()=>{d.current()})},[e.value]),l.jsx(iE.Provider,{value:{currentValue:o.value??i,registerTabRef:m,unregisterTabRef:p,updateIndicatorRef:d,animation:r},children:l.jsx(ID,{...o,orientation:"horizontal",onValueChange:h,className:r==="none"?"contents":"grid w-full min-w-0 grid-cols-[minmax(0,1fr)]",...a,children:t})})}const $d=Object.assign(Rde,{List:Mde,Tab:Nde,Panel:Tde}),Er={default:"d",shopping:"s",jobs:"j",hotels:"h",places:"p",images:"i",videos:"v",sources:"r",assets:"a",apps:"c",search:"se",chat:"ch",news:"n"},Dde=e=>{if(e)return Object.entries(Er).find(([t,n])=>n===e)?.[0]},Ide=()=>{const e=nn();return f.useCallback(()=>{const n=new URLSearchParams(e?.toString()).get("sm");return Dde(n)},[e])},jde=()=>{const e=nn(),t=sr(),n=hn();return f.useCallback(r=>{const s=new URLSearchParams(e?.toString());s.set("sm",Er[r]),n.replace(`${t}?${s.toString()}`)},[t,n,e])},Pde=({items:e,inFlight:t,inFlightLatest:n,rwToken:r,contentHasMounted:s,hasHeader:a=!0})=>{const{scrollContainerRef:o}=xa(),i=ro(),c=f.useMemo(()=>{if(typeof window>"u")return 0;let v;return a?v=getComputedStyle(document.documentElement).getPropertyValue("--header-height"):v="0",parseInt(v,10)},[a]),u=f.useRef(!0),d=f.useMemo(()=>!r&&e.every(v=>!Yt.isStatusPending(v)),[e,r]),m=f.useMemo(()=>e.some(v=>Yt.isStatusPending(v)),[e]),p=f.useRef({}),h=f.useRef({}),g=f.useRef(!1);f.useEffect(()=>()=>{p.current={},h.current={}},[]);const y=f.useCallback((v,{smooth:C=!0,anchor:w=!1}={smooth:!0,anchor:!1})=>{const S=typeof v=="number"?p.current?.[v]?.current:h.current?.[v]?.current;if(S&&o?.current){const E=o.current,T=Wg(()=>{g.current=!1,E.removeEventListener("scroll",T)},100,{leading:!1,trailing:!0});if(E.addEventListener("scroll",T),g.current=!0,w){const P=S.getBoundingClientRect().top,O=m_(E),L=P+O-c,H=HP(E),R=BP(E);if(L+R>H){const I=H-R-.1;requestAnimationFrame(()=>{Q4(E,I,C?"smooth":"auto")});return}}const k=S.getBoundingClientRect().top,M=m_(E),N=k+M-c;requestAnimationFrame(()=>{Q4(E,N,C?"smooth":"auto")})}},[o,c]),b=f.useCallback(()=>{y(e.length-1)},[y,e.length]);f.useEffect(()=>{const v={...p.current},C={};e.forEach((S,E)=>{const T=E,k=S.backend_uuid;if(k)if(!v[T]||!v[T].current){const M=A.createRef();v[T]=M,C[k]=M}else C[k]=v[T]});const w=e.length;Object.keys(v).forEach(S=>{Number(S)>=w&&delete v[Number(S)]}),h.current=C,p.current=v},[e.length,m]);const x=e.at(-1)?.query_source==="edit";f.useEffect(()=>{if(e.length<=1||!i||!s)return;const v=window.location.hash;if(v&&!t&&u.current){try{const C=v.slice(1),w=C.length>3;(w?h.current?.[C]?.current:p.current?.[Number(C)]?.current)&&(y(w?C:Number(C),{smooth:!1}),u.current=!1)}catch(C){Z.error(C)}return}n&&!x&&requestAnimationFrame(()=>{y(e.length-1,{anchor:!0})})},[t,n,d,e.length,i,y,s,x]);const _=p.current;return f.useMemo(()=>({refs:_,isScrollingRef:g,scrollToLatestItem:b,scrollToListItem:y,headerOffsetPx:c}),[_,b,y,c])},XP=Bt("ScrollToEntityContext",{refs:{},isScrollingRef:{current:!1},scrollToListItem:()=>{},setContentHasMounted:()=>{},scrollToLatestItem:()=>{},contentHasMounted:!1,headerOffsetPx:0}),Ode=A.memo(function({children:t}){const n=Mi(),{results:r=_e,inFlight:s,inFlightLatest:a}=Ht(),[o,i]=f.useState(!1),c=f.useMemo(()=>d0(r).map(y=>y.length?y[0]:void 0).filter(y=>y!==void 0),[r]),{refs:u,isScrollingRef:d,scrollToListItem:m,scrollToLatestItem:p,headerOffsetPx:h}=Pde({items:c,inFlight:s,inFlightLatest:a,rwToken:n,contentHasMounted:o,hasHeader:!1});return l.jsx(XP.Provider,{value:{scrollToListItem:m,scrollToLatestItem:p,refs:u,isScrollingRef:d,setContentHasMounted:i,contentHasMounted:o,headerOffsetPx:h},children:t})}),lE=()=>{const e=f.useContext(XP);if(!e)throw new Error("useScrollToEntity must be used within ScrollToEntityContext");return e},cE=Bt("SearchPageContext",{activeEntryIdx:0,pinnedEntryIdx:-1,viewTitle:null,setViewTitle:()=>{},activeThreadTab:"default",setActiveThreadTab:()=>{},handleTabScrollBehavior:()=>{}}),Oo=()=>{const e=f.useContext(cE);if(!e)throw new Error("useSearchPage must be used within an SearchPageProvider");return e},Lde=A.memo(function({children:t}){const n=Ide(),r=jde(),s=n()??"default",[a,o]=f.useState(s),i=f.useRef(void 0);f.useEffect(()=>{const w=n()??"default";o(w)},[n]);const c=f.useCallback(w=>{o(w),r(w)},[r]),[u,d]=f.useState(0),[m,p]=f.useState(-1),[h,g]=f.useState(null),{refs:y}=lE(),b=hn(),{scrollContainerRef:x}=xa(),_=f.useCallback(w=>{if(x.current){if(a==="default"){const S=x.current.scrollTop;i.current=S}if(w==="default"){const S=i.current;S!==void 0&&requestAnimationFrame(()=>{x.current&&(x.current.scrollTop=S)})}else x.current.scrollTop=0}},[x,a]),v=f.useCallback(()=>{if(Object.keys(y).length===0||!x.current)return;const w=x.current.clientHeight,S=x.current.scrollTop;if(S===0){d(0),p(-1);return}const E=S+w/2;let T=u,k=-1,M=1/0;Object.entries(y).forEach(([N,P])=>{if(P.current){const O=P.current.getBoundingClientRect(),L=O.top+S+O.height/2,H=Math.abs(L-E);O.top<-100&&O.bottom>100&&(k=parseInt(N)),H<M&&(M=H,T=parseInt(N))}}),d(T),p(k)},[y,d,x,u,p]);f.useEffect(()=>{if(!x?.current)return;const w=x.current,S=PC(v,50,{leading:!1,trailing:!0});return w.addEventListener("scroll",S),v(),()=>{w.removeEventListener("scroll",S),S.cancel()}},[v,x]),f.useEffect(()=>{g(null)},[b]);const C=f.useCallback(w=>{const S=w;_(S),c(S)},[_,c]);return l.jsx(cE.Provider,{value:{activeEntryIdx:u,pinnedEntryIdx:m,viewTitle:h,setViewTitle:g,activeThreadTab:a,setActiveThreadTab:c,handleTabScrollBehavior:_},children:l.jsx($d,{value:a,onValueChange:C,children:t})})});function Fde({entropyBrowser:e,isSidecar:t,scrollContainerRef:n}){const r=sr(),s=f.useCallback(a=>{n.current&&n.current.scrollTo({top:n.current.scrollHeight,behavior:a})},[n]);f.useEffect(()=>{if(!(!e||!t))return e.subscribeQuickActionButtonFired(()=>{s("smooth")})},[e,t,s]),f.useEffect(()=>{setTimeout(s,0,"instant")},[r,t,s])}const Ude=({reason:e})=>{const{DEFAULT_SOURCES:t}=P0({reason:e}),{setSources:n}=En(),r=ro(),{session:s}=je(),{trackEvent:a}=Ze(s),{lossAversionStatus:o,setLossAversionStatus:i,unsetLossAversion:c}=bR(),u=wt(),{results:d,lastResult:m,firstResult:p}=Ht(),h=p?.author_id,g=p?.author_username,y=p?.context_uuid,b=p?.query_source,x=p?.sources?.sources,_=Mi(),v=nn(),C=f.useRef(!1),{pinnedEntryIdx:w,setViewTitle:S}=Oo(),{formatMessage:E}=Q(),{openVisitorLoginUpsell:T}=ws({enabled:!u}),{scrollContainerRef:k}=xa(),M=Xt();return Mue(),Sue(),Sde(),Fde({scrollContainerRef:k,isSidecar:!0,entropyBrowser:M}),f.useEffect(()=>{const N=Yt.isSourceListType(x)?x:[...t];n(N)},[]),f.useEffect(()=>{if(!C.current&&r&&d.length>=1&&m&&Yt.isStatusCompleted(m)&&h&&g){const N=v?.get("utm_source")??void 0;a("thread viewed",{authorId:h,authorUsername:g,isThreadCreator:!!_,contextUUID:y,viewSource:N}),y&&hte({contextUUID:y,reason:e}),b==="perplexity_tasks"&&a("task thread viewed",{contextUUID:y}),C.current=!0}},[a,r,h,g,y,m,d.length,v,_,u,T,E,e,b]),f.useEffect(()=>{o!=="cooldown"&&(!u&&!o&&_?i("allowed"):_||c())},[u,o,_,i,c]),f.useEffect(()=>{S(w===-1?null:EW(d[w]?.query_str)??"")},[w,S,d]),f.useEffect(()=>()=>{o==="allowed"&&c()},[]),null},Bde=e=>{try{return JSON.parse(e)}catch{return null}},Hde=A.memo(function({title:t,description:n,className:r="",role:s,retryFn:a,...o}){const{$t:i}=Q(),c=i({defaultMessage:"Please try again later.",id:"EjH+J3uOTD"}),u=f.useMemo(()=>Bde(n??""),[n]);return u&&(console.warn("Tried to pass a JSON error description"),console.warn(u)),l.jsxs("div",{className:`gap-md bg-caution py-sm px-md mt-4 flex items-center rounded-lg text-left font-sans text-white ${r}`,role:"alert",...o,children:[l.jsx(ye,{icon:D("alert-circle")}),l.jsxs("div",{className:"flex grow flex-col",children:[l.jsx("p",{className:"font-medium",children:t||i({defaultMessage:"Sorry, something went wrong",id:"E2YPKR25ob"})}),l.jsx("p",{children:u?c:n})]}),a&&l.jsx(pt,{noXPadding:!0,text:i({defaultMessage:"Try again",id:"FazwRldA7z"}),onClick:a,textClassName:"text-white"})]})}),om=A.memo(function({fullWidth:t,retryFn:n,className:r,errorCode:s}){const{$t:a}=Q(),o=f.useCallback(()=>{Jg("error retry")},[]),i=(()=>{switch(s){case"FETCHER_SSE_OFFLINE_ERROR":case"FETCHER_SSE_NO_STATUS_CODE_ERROR":return a({defaultMessage:"Unstable internet, check your connection",id:"vbFcV2WAsH"});default:return a({defaultMessage:"Sorry, something went wrong",id:"E2YPKR25ob"})}})();return l.jsx("div",{className:z("max-w-threadContentWidth mx-auto",{"w-full":t},r),children:l.jsx(Hde,{className:z("mx-md md:mx-0",{"bg-super":s==="FETCHER_SSE_OFFLINE_ERROR"}),title:i,retryFn:n??o})})}),Sa=f.memo(function({children:t,id:n}){const r=f.useMemo(()=>()=>l.jsx("div",{className:"isolate mx-auto max-w-threadContentWidth",children:l.jsx(om,{})}),[]);return l.jsx(ar,{fallback:r,code:"SOMETHING_WENT_WRONG_ERROR",children:l.jsx($d.Panel,{value:n,children:t})})}),Tr=({children:e,className:t,as:n="div",active:r=!0,speed:s="normal",hoverOnly:a=!1,variant:o="default",iterations:i})=>{const[c,u]=f.useState(!1),d=a?c:r;return A.createElement(n,{style:{animationDuration:s==="normal"?"1200ms":"1800ms",animationIterationCount:i},className:z({shimmer:d&&o==="default","animate-gradient bg-clip-text text-transparent shimmer-super":d&&o==="super"},t),onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1)},e)},Vde=f.memo(function(){return l.jsxs(Tr,{className:"gap-md flex flex-col",children:[l.jsx(r1,{}),l.jsx(r1,{}),l.jsx(r1,{})]})}),r1=f.memo(function(){return l.jsxs("div",{className:"gap-sm flex items-center",children:[l.jsx(Y,{variant:"subtler",className:"size-32 shrink-0 rounded-md"}),l.jsxs("div",{className:"gap-sm flex w-full flex-col",children:[l.jsx(Y,{variant:"subtler",className:"h-4 w-full rounded-full"}),l.jsx(Y,{variant:"subtler",className:"h-4 w-2/3 rounded-full"})]})]})}),ZP=({genericErrorMessage:e})=>{const{$t:t}=Q(),{openToast:n}=cn();return f.useCallback(r=>{r instanceof Hw?n({message:t({defaultMessage:"Downloads are disabled for files in this organization.",id:"NfM+Ayxvc6"}),variant:"error",timeout:8}):r instanceof Vw?n({message:t({defaultMessage:"PDF downloads are restricted",id:"aJYvzl3Lq5"}),variant:"error",timeout:8}):r instanceof Gw?n({message:t({defaultMessage:"This file belongs to a different organization",id:"lo7Bg402Jd"}),variant:"error",timeout:8}):n({message:e,variant:"error",timeout:3})},[n,t,e])},uE=({reason:e,onSuccess:t})=>{const{$t:n}=Q(),{openToast:r}=cn(),s=ZP({genericErrorMessage:n({defaultMessage:"Failed to download file",id:"RIWlU8NdpC"})});return on({mutationFn:async({file_url:a})=>(await BR({request:{file_url:a,view_mode:!1},reason:e})).file_url,onSuccess:(a,{tab_id:o})=>{t?t(a,o):window.open(a,"_blank"),r({message:n({defaultMessage:"Downloading file...",id:"/vA9NyIeJh"}),variant:"success",timeout:3})},onError:s})},JP=Pe(async()=>{const{LightboxImage:e}=await W(async()=>{const{LightboxImage:t}=await import("./LightboxImage-ChKrknSo.js");return{LightboxImage:t}},__vite__mapDeps([47,2,3,6,5,1,7,8,9,13,12,14,15,16,17]));return{default:e}}),Gde=A.memo(function({attachments:t,backend_uuid:n,fileSourceMap:r}){return l.jsx("div",{className:"gap-sm relative flex flex-wrap flex-row-reverse",children:l.jsx("div",{className:"min-w-0 max-w-[200px]",children:t.length>1?l.jsx(qde,{attachments:t,backend_uuid:n,fileSourceMap:r}):t[0]?l.jsx(zde,{attachmentUrl:t[0],backend_uuid:n,fileSource:r.get(t[0])}):null})})}),eO=e=>{const{openFile:t}=f.useContext(Tw),{getImageDownloadUrl:n}=J0({reason:"attachments-row"}),{$t:r}=Q(),s=ZP({genericErrorMessage:r({defaultMessage:"Failed to open file",id:"VJjxNdFaqb"})});return f.useCallback(async(a,o)=>{if(!Qg(a))return!1;try{const i=await n({url:a,thread_id:e});return t({name:El(a),url:i,fileSource:o,entryUUID:e}),!0}catch(i){return s(i),!1}},[t,e,n,s])},zde=A.memo(function({attachmentUrl:t,backend_uuid:n,fileSource:r}){const s=Xr(t),[a,o]=f.useState(!1),{mutate:i}=uE({reason:"attachments-row"}),c=eO(n),u=f.useCallback(()=>{Qg(t)&&i({file_url:t})},[t,i]),d=f.useCallback(()=>{s?o(!0):tI()?c(t,r):u()},[s,t,r,c,u]),m=f.useCallback(()=>{o(!1)},[]),p=f.useMemo(()=>El(t),[t]),h=f.useMemo(()=>({src:t}),[t]),g=f.useMemo(()=>({url:t}),[t]);return l.jsxs(l.Fragment,{children:[l.jsx(tO,{title:p,icon:s?l.jsx(Wde,{attachmentUrl:t}):l.jsx($de,{attachmentUrl:t}),onClick:d,className:z({"!border-cursor":s})}),s&&l.jsx(JP,{onClose:m,isOpen:a,imgProps:h,origin:g,width:100,height:100,alt:p})]})}),tO=({title:e,icon:t,className:n,hasChevron:r,ref:s,...a})=>l.jsxs(Ls,{...a,ref:s,className:z("flex w-full cursor-pointer items-center transition-colors","p-xs gap-[6px] rounded-xl pr-[6px] rounded-tr-none","border-subtlest border bg-background hover:bg-subtler",n),children:[t,l.jsx("div",{className:"flex min-w-0 flex-1 flex-col",children:l.jsx(B,{variant:"tinyRegular",color:"light",lineClamp:1,className:"leading-tight",children:e})}),r&&l.jsx(ye,{icon:D("chevron-down"),className:"text-quieter mr-px",size:"sm"})]}),qde=({attachments:e,backend_uuid:t,fileSourceMap:n})=>{const{$t:r}=Q(),[s,a]=f.useState(void 0),{mutate:o}=uE({reason:"attachments-row"}),i=eO(t),c=f.useCallback(y=>{Qg(y)&&o({file_url:y})},[o]),u=f.useCallback(async y=>{const b=n.get(y);Xr(y)?a(y):tI()?i(y,b):c(y)},[n,i,c]),d=f.useMemo(()=>l.jsx(Kde,{}),[]),m=f.useMemo(()=>l.jsx(tO,{title:r({defaultMessage:"{count, plural, one {# attachment} other {# attachments}}",id:"RYwHHLwZK9"},{count:e.length}),icon:d,className:"!border-cursor",hasChevron:!0}),[r,e.length,d]),p=f.useCallback(()=>{a(void 0)},[]),h=f.useMemo(()=>({src:s}),[s]),g=f.useMemo(()=>({url:s}),[s]);return l.jsxs(l.Fragment,{children:[l.jsx(Qe,{align:"end",triggerElement:m,children:e.map(y=>l.jsx(Qe.Item,{leadingAccessory:nO(y).icon,onSelect:()=>u(y),children:El(y)},y))}),s&&l.jsx(JP,{onClose:p,imgProps:h,origin:g,width:100,height:100,isOpen:!0})]})},eM={txt:{icon:D("file-text"),text:"Text file"},pdf:{icon:D("pdf"),text:"PDF file"},jpeg:{icon:D("photo"),text:"Image file"},jpg:{icon:D("photo"),text:"Image file"},doc:{icon:D("file-word"),text:"Word document"},docx:{icon:D("file-word"),text:"Word document"},rtf:{icon:D("file-text"),text:"Text file"},pptx:{icon:D("file-type-ppt"),text:"PowerPoint file"},xlsx:{icon:D("file-excel"),text:"Excel file"},md:{icon:D("file-text"),text:"Markdown file"},png:{icon:D("photo"),text:"Image file"},csv:{icon:D("file-type-csv"),text:"CSV file"},mov:{icon:D("video"),text:"Video file"},mp4:{icon:D("video"),text:"Video file"},unknown:{icon:D("file"),text:"Unknown"}},nO=e=>{const t=Fl(e);return eM[t]??eM.unknown},$de=({attachmentUrl:e})=>{const{icon:t}=nO(e);return l.jsx(dE,{children:l.jsx(ye,{icon:t,className:"text-quiet",size:"xs"})})},Wde=({attachmentUrl:e})=>{const[t,n]=f.useState(void 0);return l.jsxs(dE,{children:[l.jsx("img",{src:e,alt:"Attachment",className:z("aspect-square h-full object-cover",{hidden:t===!1,"opacity-0":t===void 0}),onLoad:()=>n(!0),onError:()=>n(!1),loading:"lazy",decoding:"async"}),t===!1&&l.jsx(ye,{icon:D("photo"),className:"text-quiet",size:"xs"})]})},Kde=()=>l.jsx(dE,{children:l.jsx(ye,{icon:D("paperclip"),className:"text-quiet",size:"xs"})}),dE=({children:e})=>l.jsx(Y,{variant:"subtle",className:"flex size-6 shrink-0 items-center justify-center overflow-hidden rounded-lg",children:e}),fc=async({request:e,reason:t})=>{const{data:n,error:r,response:s}=await ve.POST("/rest/deeper-research/download-asset",t,{body:e,timeoutMs:2e3,numRetries:1});if(r)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to download file",cause:r,status:s.status??0});return n.file_url},Yde=async({request:e,reason:t})=>{const{data:n,error:r,response:s}=await ve.POST("/rest/deeper-research/export-all-assets",t,{body:e,timeoutMs:6e4,numRetries:1,parseAs:"blob"});if(r)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to export all assets",cause:r,status:s.status??0});return n},rO=({reason:e})=>{const{$t:t}=Q(),{openToast:n}=cn(),r=f.useCallback(async o=>{try{const i=await fc({request:o,reason:e}),c=document.createElement("a");c.href=i,c.download=o.filename,document.body.appendChild(c),c.click(),document.body.removeChild(c),n({message:t({defaultMessage:"Downloading file...",id:"/vA9NyIeJh"}),variant:"success",timeout:3})}catch(i){Z.error("Failed to download S3 asset",{error:i,request:o,errorMessage:i instanceof Error?i.message:"Unknown error"}),n({message:t({defaultMessage:"Failed to download file",id:"RIWlU8NdpC"}),variant:"error",timeout:3})}},[e,t,n]),s=f.useCallback(async(o,i="media",c=document.body)=>{try{const u=await fetch(o,{mode:"cors",cache:"no-cache"});if(!u.ok)throw new Error(`HTTP error! status: ${u.status}`);const d=await u.blob(),m=URL.createObjectURL(d),p=document.createElement("a");p.href=m,p.download=i,c.appendChild(p),p.click(),c.removeChild(p),URL.revokeObjectURL(m);const h=i.toLowerCase().includes(".mp4")||i.toLowerCase().includes(".mov")||i.toLowerCase().includes(".avi")||d.type.startsWith("video/"),g=t(h?{defaultMessage:"Video downloaded",id:"WHvofOjBQO"}:{defaultMessage:"Image downloaded",id:"nS5vxnEXaW"});n({message:g,variant:"success",timeout:3})}catch(u){const d=i.toLowerCase().includes(".mp4")||i.toLowerCase().includes(".mov")||i.toLowerCase().includes(".avi");Z.error("Failed to download media asset",{error:u,mediaUrl:o,errorMessage:u instanceof Error?u.message:"Unknown error",errorType:u instanceof TypeError&&u.message.includes("Failed to fetch")?"CORS":"Unknown"});const m=t(d?{defaultMessage:"Failed to download video",id:"g8uGrbPLMV"}:{defaultMessage:"Failed to download image",id:"YPAbL/7UuZ"});n({message:m,variant:"error",timeout:3})}},[t,n]),a=f.useCallback(async(o,i="image.jpg",c=document.body)=>s(o,i,c),[s]);return f.useMemo(()=>({downloadS3Asset:r,downloadImageAsset:a,downloadMediaAsset:s}),[a,r,s])},fE=()=>{const{session:e}=je(),t=eo(),{firstResult:n}=Ht(),r=n?.backend_uuid,s=n?.context_uuid,{device:{isWindowsApp:a}}=jn(),o=f.useCallback((i,c)=>{const u=Ad(a);si({name:i,data:{entryUUID:r,threadUUID:s,...c,isPerplexityBrowser:t},source:u,user:{id:e?.user?.id,subscription_status:e?.user?.subscription_status}})},[r,s,t,a,e?.user?.id,e?.user?.subscription_status]);return f.useMemo(()=>({trackEvent:o}),[o])},Qde={pendingClarifications:[],addClarification:()=>{},clearClarifications:()=>{},pendingSuggestions:[],addPendingSuggestion:()=>{},removePendingSuggestion:()=>{},clearPendingSuggestions:()=>{}},sO=Bt("DeepResearchContext",Qde),Xde=({children:e})=>{const[t,n]=f.useState([]),[r,s]=f.useState([]),a=f.useCallback(m=>{n(p=>p.concat([m]))},[]),o=f.useCallback(()=>{n([])},[]),i=f.useCallback(m=>{s(p=>p.concat([m]))},[]),c=f.useCallback(m=>{s(p=>p.filter(h=>h.UUID!==m))},[]),u=f.useCallback(()=>{s([])},[]),d={pendingClarifications:t,clearClarifications:o,addClarification:a,pendingSuggestions:r,addPendingSuggestion:i,removePendingSuggestion:c,clearPendingSuggestions:u};return l.jsx(sO.Provider,{value:d,children:e})},ny=()=>{const e=f.useContext(sO);if(!e)throw new Error("useDeepResearchState must be used within DeepResearchContext");return e};var Ea={},tM;function Zde(){if(tM)return Ea;tM=1;var e=Ea&&Ea.__values||function(s){var a=typeof Symbol=="function"&&s[Symbol.iterator],o=0;return a?a.call(s):{next:function(){return s&&o>=s.length&&(s=void 0),{value:s&&s[o++],done:!s}}}},t=Ea&&Ea.__read||function(s,a){var o=typeof Symbol=="function"&&s[Symbol.iterator];if(!o)return s;var i=o.call(s),c,u=[],d;try{for(;(a===void 0||a-- >0)&&!(c=i.next()).done;)u.push(c.value)}catch(m){d={error:m}}finally{try{c&&!c.done&&(o=i.return)&&o.call(i)}finally{if(d)throw d.error}}return u};Object.defineProperty(Ea,"__esModule",{value:!0}),Ea.selectState=function(s){return s};function n(){var s,a,o;function i(c){var u=0,d;function m(h){var g,y;s||(s={state:h,version:1}),s.state!==h&&(s.state=h,s.version+=1);var b=s.version,x;if(d){if(b===d.stateVersion)return d.value;var _=!1;try{for(var v=e(d.dependencies.entries()),C=v.next();!C.done;C=v.next()){var w=t(C.value,2),S=w[0],E=w[1];if(S(h)!==E){_=!0,x=S;break}}}catch(N){g={error:N}}finally{try{C&&!C.done&&(y=v.return)&&y.call(v)}finally{if(g)throw g.error}}if(!_)return d.value}u+=1;var T=new Map,k=Object.assign(function(N){if(T.has(N))return T.get(N);var P=N(h);return T.set(N,P),P},{reason:x}),M=o?o(function(){return c(k)},p,h,x):c(k);if(T.size===0)throw new Error("[rereselect] Selector malfunction: The selection logic must select some data by calling `query(selector)` at least once.");return d={stateVersion:b,dependencies:T,value:M},M}var p=Object.assign(function(g){return a?a(function(){return m(g)},p,g):m(g)},{selectionLogic:c,recomputations:function(){return u},resetRecomputations:function(){return u=0},introspect:function(){return d}});return p}return{makeSelector:i,setInvocationWrapper:function(c){a=c},setComputationWrapper:function(c){o=c}}}Ea.createSelectionContext=n;var r=n();return Ea.makeSelector=r.makeSelector,Ea}var $e=Zde();const aO=_e,Jde=(e,t)=>{if(!e)return;const n=e.filter(r=>r.plan_block&&r.intended_usage=="plan").map(r=>r.plan_block);if(n&&n.length>0){const r=[];let s=!1;for(const a of n){for(const o of a?.goals??[])if(o.description)if(r.length==0||r[r.length-1]?.final)r.push({...o});else{const i=r[r.length-1];i&&i.description&&(i.description+=o.description,i.final=o.final)}a?.final&&(s=!0)}if(r.length>0)return{goals:r,final:s,channel_uuid:"",comprehensive_mode:!1}}return t},efe=e=>e.blocks??_e;function oO(e){if(!e.step_type)return null;const t=e.initial_query_content??e.attachment_content??e.terminate_content??e.search_web_content??e.web_results_content??e.code_content??e.table_status_content??e.entropy_request_content??e.thought_content??e.browser_search_content??e.browser_open_tab_content??e.browser_open_tab_results_content??e.url_navigate_content??e.browser_get_site_content_content??e.user_clarification_content??e.browser_get_history_summary_content??e.browser_get_open_tab_content_content??e.read_calendar_content??e.read_calendar_response_content??e.read_email_content??e.read_email_response_content??e.update_calendar_content??e.update_calendar_response_content??e.generate_image_content??e.generate_image_results_content??e.generate_video_content??e.generate_video_results_content??e.search_tabs_content??e.search_tabs_results_content??e.create_app_results_content??e.browser_close_tabs_content??e.browser_close_tabs_results_content??e.browser_group_tabs_content??e.browser_group_tabs_results_content??e.create_chart_content??e.get_url_content_content??e.create_client_app_content??e.get_user_info_content??e.get_user_info_response_content??e.get_free_busy_content??e.get_free_busy_response_content??e.send_email_content??e.send_email_response_content??e.browser_ungroup_content??e.browser_search_tab_groups_content??e.browser_search_tab_groups_result_content??e.search_browser_content??e.search_browser_results_content??e.clarifying_questions_content??e.clarifying_questions_output_content??e.email_calendar_agent_content??e.email_calendar_agent_response_content??e.mcp_tool_input_content??e.mcp_tool_output_content??e.research_clarifying_questions_content??e.create_tasks_content??e.create_tasks_response_content??e.flights_search_content??e.flights_booking_content??e.flights_search_response_content??e.flights_booking_response_content??e.flights_agent_content??e.canvas_agent_content??e.comet_agent_tool_input_content??e.comet_agent_tool_output_content??e.connector_direct_search_content??e.connector_direct_search_output_content??e.council_research_content??e.research_answer_content??{};return{step_type:e.step_type,uuid:e.uuid??"",content:t,assets:e.assets}}const tfe=e=>{if(!e)return[];const t=e.filter(s=>s.plan_block&&s.intended_usage=="pro_search_steps").map(s=>s.plan_block),n={};for(let s=0;s<t.length;s++)n[t[s]?.steps?.[0]?.uuid??""]=s;return t.filter((s,a)=>n[s.steps?.[0]?.uuid??""]===a).map(s=>(s.steps??[]).map(a=>oO(a)).filter(a=>a!==null)).flat()},nfe=e=>e?e.filter(t=>t.reasoning_plan_block&&t.intended_usage==="reasoning_plan").map(t=>t.reasoning_plan_block):[],rfe=e=>{let t=!1;if(e&&e.length>0){const n=new Map;for(const a of e){if(a.goals){for(const o of a.goals)if(o.id)if(n.has(o.id)){const i=n.get(o.id);i.description&&o.description&&(i.description+=o.description),n.set(o.id,i)}else n.set(o.id,{...o})}t=a.progress==="DONE"}const r=Array.from(n.values()),s=e.flatMap(a=>a.web_results??_e);return{goals:r,web_results:s,final:t}}};function sfe(e){const t={},n=[];return e?.forEach(r=>{if(r.widget_block){const s=t[r.intended_usage]??n.length;t[r.intended_usage]=s,n[s]=DQ(n[s],r.widget_block)}}),n}function afe(e){return(e?.filter(t=>t.media_block).flatMap(t=>t.media_block?.media_items??[])??[]).filter(t=>t!=null&&!t.sponsored_uuid)}function ofe(e){return(e?.filter(t=>t.media_block).flatMap(t=>t.media_block?.generated_media_items??[])??[]).filter(t=>t!=null)}function ife(e=_e){return e.reduce((t,n)=>{if(n.is_code_interpreter&&n.is_image)t.codeInterpreterImages.push(n);else{const r=n.meta_data?.source==="quartr"?{...n,snippet:""}:n;t.webResultsStandard.push(r)}return t},{webResultsStandard:[],codeInterpreterImages:[]})}function lfe(e){return(e?.flatMap(t=>t.inline_entity_block?.knowledge_card_block?t.inline_entity_block.knowledge_card_block.knowledge_cards??[]:t.knowledge_card_block?t.knowledge_card_block.knowledge_cards??[]:[])??[]).filter(t=>t!=null)}function cfe(e){return e??_e}function ufe(e){for(const t of e)if(t.inline_claims_block?.claims)return t.inline_claims_block.claims;return _e}function dfe(e){return(e?.filter(t=>t.citation_block).flatMap(t=>t.citation_block?.citations??[])??_e).filter(t=>t!=null)}function ffe(e){const t=e?.find(r=>r?.widget_block?.finance_widget_block&&r.intended_usage==="finance_widget")?.widget_block?.finance_widget_block;return t===void 0?void 0:{object:"FinanceWidget",data:(t.data_json??[]).map(r=>JSON.parse(r)),data_v2:(t?.data_json_v2??[]).map(r=>JSON.parse(r))}}function mfe(e){const t=e?.map(s=>s.widget_block)?.find(s=>s?.widget_type==="sports");if(!t?.sports_widget_block?.data)return;const r=t.sports_widget_block.data;switch(r.object){case"SportsEventsWidget":return r;case"SportsIndvScheduleWidget":return r;case"SportsStandingsWidget":return r;case"SportsIndvEventsWidget":return r;default:return}}function pfe(e){if(!e)return;const t=e?.find(r=>r.widget_block?.price_comparison_widget_block);if(!t||!t.widget_block?.price_comparison_widget_block)return;const n=t.widget_block.price_comparison_widget_block;if(!(!n.id||!n.product_name||!n.product_url||!n.product_image_url||!n.products))return{object:"PriceComparisonWidget",...n,id:n.id,product_name:n.product_name,product_url:n.product_url,product_image_url:n.product_image_url,products:n.products}}function hfe(e){if(!e)return;const t=e?.find(n=>n.widget_block?.search_result_widget_block?.metadata?.object==="WeatherWidget");if(!(!t||!t.widget_block?.search_result_widget_block))return t.widget_block.search_result_widget_block.metadata}function gfe(e){if(!e)return;const t=e?.find(n=>n.widget_block?.search_result_widget_block?.metadata?.object==="TimeWidget");if(!(!t||!t.widget_block?.search_result_widget_block))return t.widget_block.search_result_widget_block.metadata}function yfe(e){if(!e)return;const t=e?.find(r=>r.widget_block?.search_result_widget_block?.metadata?.object==="TimerWidget");return!t||!t.widget_block?.search_result_widget_block?void 0:t.widget_block.search_result_widget_block.metadata}function xfe(e){if(!e)return;const t=e?.find(n=>n.widget_block?.search_result_widget_block?.metadata?.object==="CalculatorWidget");if(!(!t||!t.widget_block?.search_result_widget_block))return t.widget_block.search_result_widget_block.metadata}function bfe(e,t){return e&&e.length>0?e.map(n=>({name:n.widget_type||"",url:"",snippet:"",timestamp:"",meta_data:{object:n.widget_type||"unknown",...n},is_attachment:!1,is_image:!1,is_code_interpreter:!1,is_knowledge_card:!1,is_navigational:!1,is_widget:!0,sitelinks:[],inline_entity_id:""})):t||[]}function _fe(e){return e.filter(t=>aO.includes(t?.meta_data?.object??""))}function vfe(e){return e.filter(t=>!aO.includes(t?.meta_data?.object??""))}function Cfe(e){const t=e?.find(n=>n.widget_block?.search_result_widget_block?.metadata?.object==="TaskWidget");if(!(!t||!t.widget_block?.search_result_widget_block))return t.widget_block.search_result_widget_block.metadata}function wfe(e){if(!e)return;const t=e?.map(n=>n.widget_block)?.find(n=>n?.widget_type==="flight_status");if(t?.flight_status_widget_block?.data)return t.flight_status_widget_block}function Sfe(e){if(!e)return;const t=e?.map(n=>n.widget_block)?.find(n=>n?.widget_type==="news");if(t?.news_widget_block?.web_results)return{object:"NewsWidget",web_results:t.news_widget_block.web_results}}function Efe(e){if(!e)return;const t=e?.find(r=>r.widget_block?.search_result_widget_block?.metadata?.object==="CurrencyExchangeWidget");return!t||!t.widget_block?.search_result_widget_block?void 0:t.widget_block.search_result_widget_block.metadata}function kfe(e){const t=e?.find(s=>s.widget_block?.prediction_market_widget_block&&s.intended_usage==="prediction_market_widget");if(!t||!t.widget_block?.prediction_market_widget_block)return;const n=t.widget_block.prediction_market_widget_block;return n===void 0||!n?.data_json?void 0:{object:"PredictionMarketWidget",data:JSON.parse(n.data_json)}}function Mfe(e){if(!e)return;const t=e?.find(n=>n.widget_block?.search_result_widget_block?.metadata?.object==="GenericFallbackWidget");if(!(!t||!t.widget_block?.search_result_widget_block))return t.widget_block.search_result_widget_block.metadata}function Tfe(e){if(!e?.length)return[];const t=[];return e.forEach(n=>{n.intended_usage==="pro_search_steps"&&n.plan_block?.steps&&n.plan_block.steps.forEach(r=>{r.clarifying_questions_output_content?.clarification&&t.push(r.clarifying_questions_output_content.clarification)})}),t}function Afe(e){return e?e.find(n=>n.intended_usage==="refinement_filters")?.refinement_filters_block:void 0}function Nfe(e){return e?e.find(n=>n.inline_entity_block?.maps_preview_block&&n.intended_usage==="answer_maps_preview")?.inline_entity_block?.maps_preview_block:void 0}function Rfe(e){return e?e.find(n=>n.workflow_block)?.workflow_block:void 0}function Dfe(e){if(e)return e.find(t=>t.widget_block?.widget_type==="generic_onboarding")?.widget_block?.generic_onboarding_widget_block}function Ife(e){return e.blocks?.some(t=>t.intended_usage==="ask_text")??!1}function jfe(e,t,n=[]){return!!(t==="turbo"||n.length>0&&n[n.length-1]?.step_type==="FINAL"||e?.some(s=>s.markdown_block||s.entity_list_block||TR(s.entity_group_block)||AR(s.inline_entity_block)))}const ry=e=>{let t;if("meta_data"in e?t=e.meta_data:t=Va(e).with({place_widget_block:$i.nonNullable},n=>({...n.place_widget_block,object:"PlaceWidget"})).with({shopping_widget_block:$i.nonNullable},n=>({...n.shopping_widget_block,progress:"DONE",object:"ShopifyWidget"})).with({price_comparison_widget_block:$i.nonNullable},n=>({...n.price_comparison_widget_block,object:"PriceComparisonWidget"})).with({generic_onboarding_widget_block:$i.nonNullable},n=>({...n.generic_onboarding_widget_block,object:"GenericOnboardingWidget"})).with({search_result_widget_block:$i.nonNullable},n=>{const s=n.search_result_widget_block.metadata||{},a=s.object;if(a==="WeatherWidget")return{...s,progress:"DONE",object:"WeatherWidget"};if(a==="TimeWidget")return{...s,progress:"DONE",object:"TimeWidget"};if(a==="CalculatorWidget")return{...s,progress:"DONE",object:"CalculatorWidget"};if(a==="TaskWidget")return{...s,progress:"DONE",object:"TaskWidget"};if(a==="TimerWidget")return{...s,progress:"DONE",object:"TimerWidget"};if(a==="CurrencyExchangeWidget")return{...s,progress:"DONE",object:"CurrencyExchangeWidget"};if(a==="GenericFallbackWidget")return{...s,progress:"DONE",object:"GenericFallbackWidget"};if(a==="PredictionMarketWidget")return{...s,progress:"DONE",object:"PredictionMarketWidget"}}).otherwise(()=>{}),!!t)return t},Pfe=(e,t)=>e.concat(t).reduce((r,s)=>{const a=ry(s);if(!a)return r;const o=a.object;return(o==="ShopifyWidget"||o==="PlaceWidget")&&(r[o]||(r[o]=[]),r[o].push(s)),r},{}),$n=e=>e.result,rn=$e.makeSelector(e=>efe(e($n))),iO=$e.makeSelector(e=>{const t=e(rn),n={};return t.forEach(r=>{r.intended_usage&&(n[r.intended_usage]=r)}),n}),Ofe=$e.makeSelector(e=>e($n).mode),Lfe=$e.makeSelector(e=>e($n).display_model),Ffe=$e.makeSelector(e=>e($n).search_implementation_mode),mE=$e.makeSelector(e=>Yt.isStatusFailed(e($n))),lO=$e.makeSelector(e=>Yt.isStatusPending(e($n))),Ufe=$e.makeSelector(e=>Yt.isStatusBlocked(e($n))),Bfe=$e.makeSelector(e=>e($n).moderation_block??void 0),Hfe=$e.makeSelector(e=>e($n).plan),cO=$e.makeSelector(e=>e($n).widget_data??_e),sy=$e.makeSelector(e=>Yt.parseAskTextField(e($n))??void 0),uO=$e.makeSelector(e=>Yt.isStatusPending(e($n))),Vfe=$e.makeSelector(e=>Ife(e($n))),dO=$e.makeSelector(e=>e($n).expect_search_results),pE=$e.makeSelector(e=>{const t=e(sy),n=Yt.isStatusCompleted(e($n));return t?Yt.hasAnswer(t,n):!1}),fO=$e.makeSelector(e=>e(gO).length>0),$c=$e.makeSelector(e=>tfe(e(rn))),Gfe=$e.makeSelector(e=>{const t=e($c),n=e(iO);return t.reduce((r,s)=>{if(s.step_type!=="COUNCIL_RESEARCH"||!s.content?.model_summaries)return r;const a=s.content.model_summaries.reduce((o,i)=>{const c=i.plan_block_usage;if(!c)return o;const u=n[c];return o+(u?.plan_block?.steps?.length??0)},0);return r+a},0)}),mO=$e.makeSelector(e=>Jde(e(rn),e(Hfe))),zfe=$e.makeSelector(e=>nfe(e(rn))),g_=$e.makeSelector(e=>rfe(e(zfe))),pO=$e.makeSelector(e=>{const t=e($n).search_mode;return VX(t)}),qfe=$e.makeSelector(e=>{const t=e(pO),n=e($n),r=Yt.parseStructuredAnswerBlocks(n);return r!==null&&r.some(s=>s.intended_usage==="answer_generated_image"||s.intended_usage==="answer_generated_video")&&!r.some(s=>!!s.markdown_block?.answer||!!s.markdown_block?.chunks)&&t===K.SEARCH}),hO=$e.makeSelector(e=>sfe(e(rn))),gO=$e.makeSelector(e=>ife(e(sy)?.web_results).webResultsStandard),yO=$e.makeSelector(e=>hfe(e(rn))),xO=$e.makeSelector(e=>gfe(e(rn))),bO=$e.makeSelector(e=>yfe(e(rn))),_O=$e.makeSelector(e=>Efe(e(rn))),vO=$e.makeSelector(e=>kfe(e(rn))),CO=$e.makeSelector(e=>Mfe(e(rn))),wO=$e.makeSelector(e=>xfe(e(rn))),SO=$e.makeSelector(e=>wfe(e(rn))),hE=$e.makeSelector(e=>Sfe(e(rn))),gE=$e.makeSelector(e=>bfe(e(hO),e(cO))),$fe=$e.makeSelector(e=>jfe(e(rn),e(Lfe),e($c))),Wfe=$e.makeSelector(e=>e(sy)?.answer==="Answer skipped."||e(rn).some(t=>t.markdown_block?.answer==="Answer skipped.")),Kfe=$e.makeSelector(e=>e(Ofe)==="COPILOT"||e($c)!=null&&e($c).length>0),Yfe=$e.makeSelector(e=>e(mE)?_e:afe(e(rn))),Qfe=$e.makeSelector(e=>e(mE)?_e:ofe(e(rn))),Xfe=$e.makeSelector(e=>e($n).attachment_processing_progress??_e),Zfe=$e.makeSelector(e=>!!e(Xfe).length),EO=$e.makeSelector(e=>e($n).search_focus==="writing"),kO=$e.makeSelector(e=>{const t=e(uO),n=e(dO),r=e(EO);return!!t&&n!=="false"&&!r}),Jfe=$e.makeSelector(e=>{const t=e(fO),n=e(kO);return t||n}),eme=$e.makeSelector(e=>!e(pE)),tme=$e.makeSelector(e=>{const t=e(lO),n=e(pE);return t&&!n}),nme=$e.makeSelector(e=>{const t=e(mO),n=e(g_),r=t?.goals&&t.goals.length>0||n?.goals&&n.goals.length>0,a=e($c).some(o=>o.step_type==="SEARCH_RESULTS");return r||a}),rme=$e.makeSelector(e=>lfe(e(rn))),sme=$e.makeSelector(e=>cfe(e($n).related_query_items)),ame=$e.makeSelector(e=>ufe(e(rn))),ome=$e.makeSelector(e=>dfe(e(rn))),MO=$e.makeSelector(e=>ffe(e(rn))),TO=$e.makeSelector(e=>mfe(e(rn))),AO=$e.makeSelector(e=>pfe(e(rn))),ime=$e.makeSelector(e=>_fe(e(gE))),lme=$e.makeSelector(e=>vfe(e(gE))),cme=$e.makeSelector(e=>Pfe(e(gE),e(hO))),ume=$e.makeSelector(e=>[...e(gO)]),dme=$e.makeSelector(e=>Cfe(e(rn))),NO=$e.makeSelector(e=>!!e(hE)?.web_results?.length),RO=$e.makeSelector(e=>{const t=e(TO),n=e(MO),r=e(yO),s=e(xO),a=e(wO),o=e(SO),i=e(bO),c=e(_O),u=e(vO),d=e(AO),m=e(CO),p=e(hE);return!!(t||n||r||s||a||o||i||c||u||d||m||p)}),fme=$e.makeSelector(e=>{const t=e(RO),n=e(NO);return!t||n}),mme=$e.makeSelector(e=>Tfe(e(rn))),pme=$e.makeSelector(e=>Afe(e(rn))),hme=$e.makeSelector(e=>Nfe(e(rn))),DO=$e.makeSelector(e=>e($n).classifier_results),gme=$e.makeSelector(e=>{const t=e(DO);return t!==void 0&&Object.keys(t).length>0}),yme=$e.makeSelector(e=>{const t=e(DO);return t?.skip_search||t?.mhe_predictions?.skip_search||!1}),xme=$e.makeSelector(e=>Rfe(e(rn))),bme=$e.makeSelector(e=>Dfe(e(rn))),IO=e=>{const{idx:t,result:n,inFlight:r,isLastResult:s,isFirstResult:a,scrollToListItem:o,submitQuery:i,pendingClarifications:c=_e}=e,u=mme(e),d=n.backend_uuid?c.filter(h=>h.entryUUID===n.backend_uuid).map(h=>h.content):[],m=Array.from(new Set([...u,...d])),p=pme(e);return{idx:t,result:n,inFlight:r,isLastResult:s,isFirstResult:a,scrollToListItem:o,submitQuery:i,isPending:lO(e),isBlocked:Ufe(e),isFinalStep:$fe(e),isFailed:mE(e),isProReasoningMode:!!g_(e),widgetData:cO(e),response:sy(e),isEntryInFlight:uO(e),hasLLMToken:Vfe(e),isAnswerSkipped:Wfe(e),expectWebResults:dO(e),steps:$c(e),researchPlan:mO(e),reasoningPlan:g_(e),searchMode:pO(e),searchImplementationMode:Ffe(e),hasMediaOnlyLayout:qfe(e),hasAnswer:pE(e),hasWebResults:fO(e),weatherWidgetData:yO(e),timeWidgetData:xO(e),timerWidgetData:bO(e),calculatorWidgetData:wO(e),currencyExchangeWidgetData:_O(e),predictionMarketWidgetData:vO(e),flightStatusWidgetData:SO(e),genericFallbackWidgetData:CO(e),isCopilot:Kfe(e),mediaItems:Yfe(e),generatedMediaItems:Qfe(e),hasPendingFiles:Zfe(e),isAgentWorkflowInFlight:eme(e),knowledgeCards:rme(e),relatedQueryItems:sme(e),webResultCitations:ome(e),inlineClaims:ame(e),financeWidgetData:MO(e),newsWidgetData:hE(e),sportsWidgetData:TO(e),priceComparisonWidgetData:AO(e),highPriorityWidgets:ime(e),lowPriorityWidgets:lme(e),groupedEntityWidgets:cme(e),webResults:ume(e),taskWidgetData:dme(e),hasFastWidget:RO(e),hasNewsWidget:NO(e),shouldShowMediaPreview:fme(e),userClarifications:m,refinementFiltersData:p,selectedFilterIds:p?.selected_filter_ids??[],focusIsWriting:EO(e),expectSearchResults:kO(e),hasSources:Jfe(e),blocksByIntendedUsage:iO(e),mapsPreviewData:hme(e),moderationBlock:Bfe(e),hasClassifierResults:gme(e),isChatQuery:yme(e),hasAnyAgentSteps:nme(e),isProcessingQuery:tme(e),councilStepCount:Gfe(e),workflowStepsData:xme(e),onboardingWidgetData:bme(e)}},_me=e=>vi()((n,r)=>({isStatusUpdaterOpen:!1,wasStatusUpdaterManuallyOpened:!1,selectedRefinementQuery:null,skippedSources:new Set([]),...IO(e),actions:{setSelectedRefinementQuery:s=>n({selectedRefinementQuery:s}),setSelectedFilterIds:s=>n({selectedFilterIds:s}),addSkippedSource:s=>{const a=r().skippedSources,o=new Set(a);o.add(s),n({skippedSources:o})},removeSkippedSource:s=>{const a=r().skippedSources,o=new Set(a);o.delete(s),n({skippedSources:o})}}})),{Context:vme,useTrackedState:Cme}=dN("ThreadEntryContext"),jO=A.memo(function({idx:t,children:n,result:r,inFlight:s,isLastResult:a,isFirstResult:o,scrollToListItem:i,submitQuery:c}){const u=f.useRef(s),{trackEvent:d}=fE(),{pendingClarifications:m}=ny(),[p]=f.useState(()=>_me({idx:t,result:r,inFlight:s,isLastResult:a,isFirstResult:o,scrollToListItem:i,submitQuery:c,pendingClarifications:m})),g=p(y=>y.isFinalStep);return f.useEffect(()=>{const y=()=>{const _=setTimeout(()=>{d("engaged",{})},1e4);return()=>{clearTimeout(_)}},b=o&&a,x=u.current&&!s;if(b&&x&&g)return y();u.current=s},[s,g,a,o,d]),f.useEffect(()=>{p.setState(IO({idx:t,result:r,inFlight:s,isLastResult:a,isFirstResult:o,scrollToListItem:i,submitQuery:c,pendingClarifications:m}))},[t,r,s,a,o,i,c,m,p]),l.jsx(vme.Provider,{value:p,children:n})}),Pt=Cme;function im(){const{result:{frontend_uuid:e,frontend_context_uuid:t}}=Pt(),n=XC(),r=n(e??"")??n(t);return f.useCallback((s,a)=>r?.addTiming(s,a),[r])}function yE(){const{result:{frontend_uuid:e,frontend_context_uuid:t}}=Pt(),n=XC(),r=n(e??"")??n(t);return f.useCallback((s,a)=>r?.addTimingOnce(s,a),[r])}function wme(e,t,n){const r=new Blob([n],{type:"text/plain"});PO(e,t,r)}function PO(e,t,n){const r=document.createElement("a"),s=URL.createObjectURL(n);r.href=s,r.download=t,e.appendChild(r),r.click(),URL.revokeObjectURL(s),e.removeChild(r)}function Sme(e){return!!(e?.asset_type==="SLIDES"&&e.app?.url&&e.app.name)}function RYe(e){return e?.asset_type?["GENERATED_IMAGE","CHART","CODE_FILE","CODE_ASSET"].includes(e.asset_type):!1}function Eme(e){return e?.asset_type?["CHART","GENERATED_IMAGE","GENERATED_VIDEO","PDF_FILE"].includes(e.asset_type):!1}function DYe({reason:e,entryUUID:t}){const[n,r]=f.useState(!1),s=f.useCallback(async a=>{r(!0);try{const o=await Yde({request:{entry_uuid:t},reason:e});PO(a||document.body,"exported-assets.zip",o)}finally{r(!1)}},[t,e]);return f.useMemo(()=>({exportAllAssets:s,isExporting:n}),[s,n])}function IYe({asset:e,reason:t,answerMode:n,context:r,entryUUID:s}){const{downloadS3Asset:a,downloadImageAsset:o,downloadMediaAsset:i}=rO({reason:t}),{session:c}=je(),{trackEvent:u}=Ze(c),d=f.useCallback(async m=>{if(e){if(r==="canvas"&&e.asset_type!=null?u("canvas content downloaded",{entryUUID:s,assetUUID:e.uuid??"",downloadType:"download",contentType:e.asset_type}):n&&e.asset_type!=null&&u("generated asset downloaded",{answerMode:n,entryUUID:s,reason:t,assetType:e.asset_type}),e.asset_type==="GENERATED_IMAGE")e.generated_image?.url&&await o(e.generated_image.url,"generated-image.png",m||document.body);else if(e.asset_type==="GENERATED_VIDEO")e.generated_video?.url&&await i(e.generated_video.url,"generated-video.mp4",m||document.body);else if(e.download_info)for(const p of e.download_info)p.url?await a({url:p.url,filename:p.filename!=null?p.filename:"download"}):p.text_content&&wme(m||document.body,p.filename!=null?p.filename:"download",p.text_content)}},[e,r,n,u,s,t,o,i,a]);return f.useMemo(()=>({downloadAsset:d}),[d])}var Wi;(function(e){e[e.UNCOPIED=0]="UNCOPIED",e[e.COPYING=1]="COPYING",e[e.FAILED=2]="FAILED",e[e.SUCCEEDED=3]="SUCCEEDED"})(Wi||(Wi={}));var Ki;(function(e){e[e.UNLINKED=0]="UNLINKED",e[e.LINKING=1]="LINKING",e[e.FAILED=2]="FAILED",e[e.SUCCEEDED=3]="SUCCEEDED"})(Ki||(Ki={}));function jYe({asset:e,reason:t}){const[n,r]=f.useState(Wi.UNCOPIED),{$t:s}=Q(),{openToast:a}=cn(),o=f.useCallback(async()=>{if(e){r(Wi.COPYING);try{await kme({asset:e,reason:t}),a({message:s({defaultMessage:"Copied to the clipboard!",id:"WWy0tPuRW8"}),variant:"success",timeout:3}),r(Wi.SUCCEEDED)}catch{a({message:s({defaultMessage:"Failed to copy the asset",id:"HHPhgIZj9h"}),variant:"error",timeout:3}),r(Wi.FAILED)}setTimeout(()=>r(Wi.UNCOPIED),2e3)}},[s,a,r,e,t]);return f.useMemo(()=>({copyStatus:n,copyAsset:o}),[n,o])}function PYe({asset:e}){const[t,n]=f.useState(Ki.UNLINKED),{$t:r}=Q(),{openToast:s}=cn(),a=f.useCallback(async()=>{if(!(!e||!Eme(e))){n(Ki.LINKING);try{let o;if(e.asset_type==="CHART"&&e.chart?.url)o=e.chart.url;else if(e.asset_type==="GENERATED_IMAGE"&&e.generated_image?.url)o=e.generated_image.url;else if(e.asset_type==="GENERATED_VIDEO"&&e.generated_video?.url)o=e.generated_video.url;else if(e.asset_type==="PDF_FILE"&&e.pdf_file?.url)o=e.pdf_file.url;else throw new Error("Asset is not linkable or URL not found");await navigator.clipboard.writeText(o),s({message:r({defaultMessage:"Link copied to clipboard!",id:"PsDXPeXpVG"}),variant:"success",timeout:3}),n(Ki.SUCCEEDED)}catch{s({message:r({defaultMessage:"Failed to copy link",id:"ruCwQMVFzJ"}),variant:"error",timeout:3}),n(Ki.FAILED)}setTimeout(()=>n(Ki.UNLINKED),2e3)}},[e,r,s]);return f.useMemo(()=>({linkStatus:t,linkAsset:a}),[t,a])}async function kme({asset:e,reason:t}){let n;if(e.asset_type=="CODE_ASSET")n={"text/plain":e.code?.script??""};else if(e.asset_type=="CHART"&&e.chart?.url){const s=await fc({request:{url:e.chart.url,filename:"chart.png"},reason:t});n={"image/png":await(await fetch(s)).blob()}}else if(e.asset_type=="CODE_FILE"&&e.code_file?.url){const s=await fc({request:{url:e.code_file.url,filename:e.code_file.name!=null?e.code_file.name:"code-file"},reason:t});n={"text/plain":await(await fetch(s)).text()}}else if(e.asset_type=="GENERATED_IMAGE"&&e.generated_image?.url){const s=e.generated_image.url;n={"image/png":await(await fetch(s)).blob()}}else if(e.asset_type=="GENERATED_VIDEO"&&e.generated_video?.url){const s=e.generated_video.url;n={"video/mp4":await(await fetch(s,{mode:"cors",cache:"no-cache"})).blob()}}else if(e.asset_type=="PDF_FILE"&&e.pdf_file?.url){const s=await fc({request:{url:e.pdf_file.url,filename:e.pdf_file.name!=null?e.pdf_file.name:"document.pdf"},reason:t});n={"application/pdf":await(await fetch(s)).blob()}}else if(e.asset_type=="DOCX_FILE"&&e.docx_file?.url){const s=await fc({request:{url:e.docx_file.url,filename:e.docx_file.name!=null?e.docx_file.name:"document.docx"},reason:t});n={"application/vnd.openxmlformats-officedocument.wordprocessingml.document":await(await fetch(s)).blob()}}else if(e.asset_type=="XLSX_FILE"&&e.xlsx_file?.url){const s=await fc({request:{url:e.xlsx_file.url,filename:e.xlsx_file.name!=null?e.xlsx_file.name:"spreadsheet.xlsx"},reason:t});n={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":await(await fetch(s)).blob()}}if(!n)throw new Error("Failed to find anything to copy");const r=new ClipboardItem(n);await navigator.clipboard.write([r])}function Mme(e){if(!(!e||!e.asset_type))switch(e.asset_type){case"CHART":return e.chart?.url;case"GENERATED_IMAGE":return e.generated_image?.url;case"GENERATED_VIDEO":return e.generated_video?.url;case"PDF_FILE":return e.pdf_file?.url;case"CODE_FILE":return e.code_file?.url;case"DOCX_FILE":return e.docx_file?.url;case"DOC_FILE":return e.doc_file?.url;case"RESEARCH_REPORT":return e.research_report?.url;case"XLSX_FILE":return e.xlsx_file?.url;case"APP":return e.app?.app_url;case"SLIDES":return e.app?.app_url;case"CODE_ASSET":return;case"QUIZ":return e.quiz?.url;case"FLASHCARDS":return e.flashcards?.url;default:e$(e.asset_type);return}}const OO=({asset:e})=>{const{openCanvas:t,closeCanvas:n,doCanvasAction:r,canvasState:s,isCanvasOpen:a}=Dl(),{title:o}=kw(e),{result:{context_uuid:i,backend_uuid:c}}=Pt(),{session:u}=je(),{trackEvent:d}=Ze(u),m=f.useCallback(()=>{if(e){const p=Mme(e);p&&window.open(p,"_blank");return}},[e,t,n,r,o,c,a,s?.assetUuid,d,i]);return f.useMemo(()=>m,[m])},Tme=e=>e?e.filter(t=>t.image_mode_block).flatMap(t=>t.image_mode_block.media_items??_e):_e,Ame=e=>e?e.filter(t=>t.video_mode_block).flatMap(t=>t.video_mode_block.media_items??_e):_e,Nme=e=>e?e.filter(t=>t.shopping_mode_block).flatMap(t=>t.shopping_mode_block.shopping_widgets??_e):_e,Rme=e=>e?e.filter(t=>t.jobs_mode_block).flatMap(t=>t.jobs_mode_block.jobs_blocks??_e):_e,Dme=e=>e?e.filter(t=>t.maps_mode_block).flatMap(t=>t.maps_mode_block.places??_e):_e,Ime=e=>e?e.flatMap(t=>t.widget_block?.news_widget_block??_e):_e,jme=e=>{const t=(e??_e).filter(o=>o.sources_mode_block).flatMap(o=>o.sources_mode_block),n=t.at(-1),r=new Set,s=[];for(const o of t)for(const i of o.web_results??[]){const c=i.url??"";r.has(c)||(s.push(i),r.add(c))}const a=n?.result_count??0;return{count:Math.max(s.length,a),progress:n?.progress,results:s,rows:n?.rows}},xE=(e,{orderedByPriority:t=!1}={})=>{if(!e)return _e;const n=e.filter(r=>r.plan_block?.steps).flatMap(r=>r.plan_block.steps).flatMap(r=>r.assets??_e);return t?[...n].sort((r,s)=>r.is_primary_asset===s.is_primary_asset?0:r.is_primary_asset?-1:1):n},Pme=(e,t)=>{if(e){for(const n of e)if(n.plan_block?.steps){for(const r of n.plan_block.steps)if(r.assets){const s=r.assets.find(a=>a.uuid===t);if(s)return s}}}},Ome=()=>{const e=nn(),{results:t}=Ht(),n=f.useRef(!1),r=t?.[0],s=r?.blocks?xE(r.blocks,{orderedByPriority:!0})[0]:void 0,a=OO({asset:s});f.useEffect(()=>{n.current||!s||!(e.get("canvas")==="true")||(n.current=!0,a())},[e,s,a])};function Lme(){const e=S0(),t=On(),n=Po({openPaywallUpsell:t}),{results:r}=Ht(),s=f.useRef(!1),a=f.useMemo(()=>r.some(o=>o.display_model===te.STUDY),[r]);f.useEffect(()=>{const o=e(te.STUDY);a&&o&&!s.current&&(s.current=!0,n(te.STUDY))},[e,n,a])}const LO=({onClick:e,label:t,disabled:n})=>{const{$t:r}=Q();return l.jsxs("div",{className:"flex items-center gap-sm w-full",children:[l.jsx(at,{disabled:n,variant:"text",size:"small",onClick:e,inline:!0,children:t??r({defaultMessage:"See more",id:"yoLwRWw99S"})}),l.jsx("hr",{className:"border-subtlest w-full"})]})},Fme=(e,t,n)=>{const r=e?.sitelinks??_e;return t===0&&r.length>0},FO=({trackEvent:e,entryUUID:t,frontendContextUUID:n,contextUUID:r})=>f.useCallback((s,a)=>{e(s,{entryUUID:t,frontendContextUUID:n,contextUUID:r,...a})},[t,n,r,e]);function UO(e){const t=f.useMemo(()=>em({url:e.url,meta_data:e.meta_data}),[e]),{$t:n,formatDate:r}=Q(),s=e.meta_data,a=s?.connection_type,o=e.url??"",i=o&&Xr(o)||o&&t$(o)||a!=null&&a!==$r.WILEY,c=e.is_memory||e.is_conversation_history,u=e.is_client_context||c&&e.is_scrubbed,d=f.useMemo(()=>{if(t)return n(t.label);if(i)switch(e.file_metadata?.file_repository_type){case"COLLECTION":return n({defaultMessage:"Space Context",id:"wGTk8CFt1g"});case"USER":return n({defaultMessage:"My Files",id:"AjhJXSvkRs"});case"ORG":return n({defaultMessage:"Org Files",id:"DaFSYzpM1Q"});default:return n({defaultMessage:"Attachment",id:"eLCAEP8LHj"})}return c&&!u?e.is_memory?n({defaultMessage:"Memory",id:"dVx3yznM2C"}):n({defaultMessage:"History",id:"djJp6cHQ6H"}):s?.domain_name??(o?ys(o).replace(/\.[^.]*$/,""):"")},[i,c,u,e,n,t,s?.domain_name,o]),m=f.useMemo(()=>i?e.file_metadata?.file_repository_type==="COLLECTION"?n({defaultMessage:"File",id:"gyrIElu9qY"}):a?Ume(a):n({defaultMessage:"Local upload",id:"fscjAJoLwa"}):c&&!u?r(e.timestamp):u?n({defaultMessage:"Personal Search",id:"6U/eopyq3k"}):o,[i,c,u,e,a,r,n,o]),p=f.useMemo(()=>{if(o&&Xr(o))return;if(typeof s?.image_url=="string")return s.image_url;const b=s?.images?.[0];if(typeof b=="string")return b;if(typeof b=="object"&&typeof b?.src=="string")return b.src},[o,s]),h=s?.generated_file_description??s?.description??e.snippet,g=f.useMemo(()=>{if(t?.visual.kind==="icon")return t.visual.icon;if(e.is_memory)return D("bubble-text");if(e.is_conversation_history)return D("list-search");if(e.is_attachment)return D("paperclip")},[t,e.is_memory,e.is_conversation_history,e.is_attachment]),y=f.useMemo(()=>{if(t?.visual.kind==="avatar")return t.visual.url},[t]);return f.useMemo(()=>({url:o,domain:d,path:m,title:e.name??"",snippet:h??"",image:p,icon:g,faviconOverride:y}),[d,e.name,h,p,m,g,y,o])}function Ume(e){switch(e){case"GOOGLE_DRIVE":return"Google Drive";case"ONEDRIVE":return"OneDrive";case"SHAREPOINT":return"SharePoint";case"DROPBOX":return"Dropbox";case"BOX":return"Box";case"NOTION_MCP":return"Notion";case"LINEAR":case"LINEAR_ALT":return"Linear";case"SLACK":return"Slack";case"SLACK_DIRECT":return"Slack (deprecated)";case"GITHUB_MCP_DIRECT":return"GitHub";case"ASANA_MCP_DIRECT":return"Asana";case"ASANA_MCP_MERGE":return"Asana";case"ATLASSIAN_MCP_DIRECT":return"Atlassian";case"JIRA_MCP_MERGE":return"Jira";case"CONFLUENCE_MCP_MERGE":return"Confluence";case"MICROSOFT_TEAMS_MCP_MERGE":return"Microsoft Teams";case"ZOOM":return"Zoom";default:return""}}const ay=A.memo(function({src:t,domain:n,icon:r,size:s=16,hideBorder:a=!1}){const[o,i]=f.useState(!0),c=t||LC(n,128),u=r?s*.3:void 0;return f.useEffect(()=>{i(!0)},[c]),l.jsxs("div",{className:z("relative shrink-0 overflow-hidden flex items-center justify-center",r?void 0:"rounded-full"),style:{width:s,height:s,borderRadius:u},children:[o&&!r?l.jsx("img",{className:"relative block",src:c,alt:`${n} favicon`,width:s,height:s,onLoad:d=>{const m=d.target,p=m.naturalWidth!==16||m.naturalHeight!==16;i(p)},onError:()=>i(!1),style:{width:s,height:s}}):l.jsx(ye,{icon:r||D("world"),className:r?"text-quieter":"text-quietest",size:Math.round(s*.7)}),!a&&l.jsx("div",{className:z("absolute inset-0 ring-1 ring-inset ring-[black]/10 dark:ring-transparent",r?void 0:"rounded-full"),style:{borderRadius:u}})]})}),Bme=A.memo(function({url:t,domain:n,path:r,title:s,snippet:a,sitelinks:o,image:i,icon:c,faviconOverride:u,badge:d,variant:m="default",onClick:p,onSubLinkClick:h,newTab:g=!1}){const y=f.useMemo(()=>Ph(t),[t]),b=f.useMemo(()=>R2(fN(t)),[t]),x=m==="slim",_=!!i&&!x;return l.jsx(Dt,{className:z("gap-sm flex select-none rounded-xl font-sans gap-2",m==="primary"?"bg-subtler p-4 hover:bg-subtle":"-m-2 p-2 hover:bg-subtler",{"pb-sm":o?.length}),href:t,target:g?"_blank":"_self",onClick:p,rel:"noopener",children:l.jsxs("div",{className:z("flex text-sm gap-2.5 flex-1 min-w-0",{"justify-between":_}),children:[x&&l.jsx("div",{style:{transform:"translateY(2px)"},children:l.jsx(ay,{size:16,domain:y,icon:c,src:u})}),l.jsxs("div",{className:"gap-sm flex flex-col flex-1 min-w-0",children:[!x&&l.jsx(Hme,{path:r||b,name:n,image:y,variant:m,icon:c,faviconOverride:u,badge:d}),l.jsx(Vme,{title:s,snippet:a,variant:m,domain:x?n:void 0,badge:x?d:void 0}),o&&o.length>0&&l.jsx(Gme,{variant:m,links:o,onClick:h,newTab:g})]}),_&&l.jsx(zme,{image:i,alt:`${s} image`})]})},t)}),Hme=({image:e,name:t,path:n,icon:r,faviconOverride:s,variant:a="default",badge:o})=>{const i=a==="slim";return l.jsxs("div",{className:z("flex items-center",i?"gap-2.5":"gap-3"),children:[e&&l.jsx(ay,{size:i?16:28,domain:e,icon:r,src:s}),l.jsxs("div",{className:"flex flex-1 items-center justify-between gap-2",children:[l.jsxs("div",{className:"flex flex-col text-foreground gap-0.5",children:[t&&l.jsx("span",{className:"line-clamp-1 text-sm",children:t}),n&&l.jsx("span",{className:"line-clamp-1 text-xs",children:n})]}),o]})]})},Vme=({title:e,snippet:t,domain:n,badge:r,variant:s="default"})=>{const a=s==="slim";return l.jsxs("div",{className:"flex flex-col text-sm min-w-0",children:[(n||r)&&l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n&&l.jsx("span",{className:"text-quiet text-xs line-clamp-1",children:n}),r]}),l.jsx("span",{className:z("font-medium",a?"text-foreground line-clamp-2":"text-super line-clamp-1"),children:e}),l.jsx("span",{className:z("text-quiet wrap-anywhere",a?"line-clamp-4":"line-clamp-2"),children:t})]})},Gme=({variant:e,links:t,onClick:n,newTab:r=!1})=>l.jsx("div",{className:"text-sm text-quiet",children:e==="primary"?l.jsx("div",{className:"flex flex-col divide-y divide-subtler",children:t.map(s=>l.jsxs(Dt,{className:"py-3 hover:text-foreground flex items-center justify-between",href:s.url,onClick:()=>n?.(s.url),rel:"noopener",target:r?"_blank":void 0,children:[s.title,l.jsx(ye,{icon:D("chevron-right")})]},s.url))}):l.jsx("div",{className:"gap-sm flex items-center flex-wrap",children:t.map((s,a)=>l.jsxs(A.Fragment,{children:[l.jsx(Dt,{className:"items-stretch hover:underline",href:s.url,onClick:()=>n?.(s.url),rel:"noopener",target:r?"_blank":void 0,children:s.title}),a!==t.length-1&&l.jsx("span",{className:"text-inherit",children:"|"})]},s.url))})}),zme=({image:e,alt:t})=>{const[n,r]=f.useState(!0);return l.jsxs("div",{className:z("relative aspect-square size-20 shrink-0 rounded-xl overflow-hidden",{hidden:n}),children:[l.jsx("img",{src:e,alt:t,className:"object-cover object-center size-full",onLoad:()=>r(!1)}),l.jsx("div",{className:"absolute inset-0 rounded-xl ring-1 ring-inset ring-[black]/10 dark:ring-transparent"})]})},qme=({children:e})=>l.jsx("div",{className:"flex flex-col gap-6 w-full",children:e}),$me=({result:e,...t})=>{const n=UO(e);return l.jsx(lm,{...n,...t})},Wme=({result:e})=>{const{url:t,domain:n,icon:r}=UO(e);return l.jsx(Dt,{href:t,children:l.jsxs("span",{className:"flex items-center gap-xs shrink-0 rounded-full bg-offset px-sm py-xs whitespace-nowrap hover:bg-offset-more",children:[l.jsx(ay,{domain:n,size:14,icon:r,hideBorder:!0}),l.jsx("span",{className:"font-sans text-xs text-quiet",children:e.name})]})})},lm=Object.assign(Bme,{List:qme,WebResult:$me,Chip:Wme}),Kme=A.memo(function({navigationResult:t,trackImpression:n,trackClick:r,variant:s="default",showSiteLinks:a=!1}){const{url:o,title:i,snippet:c,sitelinks:u,site_name:d}=t;f.useEffect(()=>n(t),[n,t]);const m=f.useCallback(()=>r(t,"primaryLink"),[t,r]),p=f.useCallback(h=>r({...t,url:h},"subLink"),[t,r]);return l.jsx(lm,{variant:s,url:o,domain:d??i,title:i,snippet:c,sitelinks:a||s==="primary"?u:void 0,onClick:m,onSubLinkClick:p})});class Yme extends Date{constructor(t){const n=t?new Date(t):new Date,r=Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds());super(r)}getTimezoneOffset(){return 0}}class BO{static isRecentlyTrending(t,n=432e5){const r=t.meta_data;return r?.client!=="trending"?!1:new Date().getTime()-new Yme(r?.published_date).getTime()<n}static normalizeUrl(t){return t.replace(/\/$/,"")}static dedupWebResults(t,n,r=!1){if(!t)return[];if(r)return t.filter(a=>a.is_attachment);if(!n)return t;const s=new Set(n.map(a=>this.normalizeUrl(a.url)));return t.filter(a=>!a.url||!s.has(this.normalizeUrl(a.url)))}}const nM=2,Qme=f.memo(function({navResults:t,queryStr:n,querySource:r,backendUUID:s,frontendUUID:a,contextUUID:o,webResults:i,isEntryInFlight:c,onMount:u,shouldRenderPrimaryCard:d=!0,renderPosition:m}){const{isMobileStyle:p}=Be(),h=p?d:!1,{session:g}=je(),{trackEvent:y}=Ze(g),b=FO({trackEvent:y,entryUUID:s,frontendContextUUID:a,contextUUID:o});f.useEffect(()=>{u?.()},[u]);const x=f.useCallback((_,v)=>{b(_,v);const C=r==="default_search",w=v.is_comet_navigation;!(_==="click citation")||!C||!w||Jt("web.frontend.omnisearch_nav_results_clicked")},[b,r]);return l.jsx(Zme,{navResults:t,queryStr:n,backendUUID:s,frontendUUID:a,webResults:i,isEntryInFlight:c,trackCitationClickEvent:x,isPrimaryCardEnabled:h,renderPosition:m})}),Xme=7,Zme=f.memo(function({navResults:t,queryStr:n,backendUUID:r,frontendUUID:s,webResults:a,isEntryInFlight:o,trackCitationClickEvent:i,isPrimaryCardEnabled:c,renderPosition:u}){const{session:d}=je(),{trackEvent:m}=Ze(d),{isMobileStyle:p}=Be(),{setActiveThreadTab:h}=Oo(),{$t:g}=Q(),[y,b]=f.useState("none"),x=f.useMemo(()=>BO.dedupWebResults(a,t,!1),[a,t]),_=f.useMemo(()=>x.slice(0,Xme).map((N,P)=>{const O=N.meta_data,L=N.url??"";return{url:L,title:N.name??"",snippet:N.snippet||"",domain:L?new URL(L).hostname:void 0,position:t.length+P,source:"default_search",site_name:O?.domain_name||O?.citation_domain_name||ys(L),is_comet_navigation:!1,navigation_source:Td.WEB_RESULTS}}),[x,t]),v=f.useMemo(()=>y==="none"?"collapsed":!o&&_.length>0?"expanded":"loading",[y,o,_.length]),C=f.useMemo(()=>v==="collapsed"?t:[...t,..._],[t,_,v]),w=C.length>t.length,S=f.useMemo(()=>{const N=t.length>=nM,P=_.length<x.length;return o?N:x.length===0?!1:w?P:t.length>=nM},[o,w,_.length,x.length,t.length]),E=f.useCallback(()=>{if(w){m("clicked navigation results see all"),h("sources");return}if(m("clicked navigation results see more"),o){b("clicked");return}if(_.length===0){h("sources");return}b("clicked")},[w,m,h,o,_.length]),T=v==="loading"&&!w,k=Jme({entryUUID:r??"",queryString:n,frontendUUID:s??"",trackEvent:i}),M=f.useCallback((N,P)=>{m("click citation",{source:"navigationalCard",render_position:u,navigationalLinkType:P,citation_url:N.url,is_comet_navigation:N.is_comet_navigation??!1,frontendContextUUID:s??""})},[m,s,u]);return l.jsxs(lm.List,{children:[C.map((N,P)=>l.jsx(Kme,{variant:c&&Fme(N,P)?"primary":"default",navigationResult:N,trackImpression:k,trackClick:M},N.url)),l.jsxs("div",{className:"flex flex-col items-start gap-sm",children:[S&&l.jsx(LO,{onClick:E,disabled:T,label:g(w?{defaultMessage:"See all links",id:"YDWVbhXaX3"}:{defaultMessage:"See more links",id:"A+4zhUZpLQ"})}),!S&&l.jsx("div",{className:"bg-subtle h-px w-full"})]})]})}),Fi={lastEntryUUID:null,loggedUrls:new Set,seenEntries:new Set};function Jme({entryUUID:e,queryString:t,frontendUUID:n,trackEvent:r}){return f.useCallback(s=>{const{url:a,title:o,sitelinks:i,position:c,source:u,client_request_timestamp:d,unstable_server_request_timestamp:m,is_cached:p,is_comet_navigation:h,navigation_source:g}=s;if(!e||!a)return;const y=Fi.seenEntries.has(e);Fi.lastEntryUUID!==e&&(Fi.lastEntryUUID=e,Fi.loggedUrls.clear()),Fi.loggedUrls.has(a)||(Fi.loggedUrls.add(a),Fi.seenEntries.add(e),r("navigational source viewed",{query:t,url:a,title:o,position:c,source:u,is_comet_navigation:h,frontendUUID:n,...typeof d=="number"&&!y&&{renderTimeMs:performance.now()-d},...typeof m=="number"&&!y&&{unstableRenderTimeMs:performance.now()-m},subLinks:i,isCached:p,navigation_source:g}))},[e,t,n,r])}const HO=e=>{if(e){if(e.app)return e.app.final;if(e.xlsx_file)return e.xlsx_file.final;if(e.doc_file)return e.doc_file.final;if(e.research_report)return e.research_report.final}},VO=e=>e.xlsxAsset?.name||e.researchReportAsset?.name||e.pdfAsset?.name||e.docxAsset?.name||e.docFileAsset?.name||e.codeFileAsset?.name||e.app?.name||null,rM=(e,t)=>{const n=kI(t),r=VO(e);return q2(r&&n?`${r}.${n}`:t)},GO=e=>f.useMemo(()=>{if(!e)return{app:null,pdfAsset:null,docxAsset:null,docFileAsset:null,codeFileAsset:null,chartAsset:null,xlsxAsset:null,quizAsset:null,researchReportAsset:null,pdfFileData:null,assetType:null,assetUuid:null};const t=e.pdf_file||null,n=t&&t.url?{url:t.url,name:t.name||"Document"}:null;let r=e.app;return r&&(r={...r,transforms:r.transforms||[]}),{app:r||null,pdfAsset:t,docxAsset:e.docx_file||null,docFileAsset:e.doc_file||null,codeFileAsset:e.code_file||null,chartAsset:e.chart||null,xlsxAsset:e.xlsx_file||null,quizAsset:e.quiz||null,researchReportAsset:e.research_report||null,pdfFileData:n,assetType:e.asset_type??null,assetUuid:e.uuid??null}},[e]);function s1(e,t){let n=e;for(const r of t)r.old_str&&r.new_str!==void 0&&(n=n.replaceAll(r.old_str,r.new_str));return n}function zO(e){return!!((e?.asset_type==="APP"||e?.asset_type==="SLIDES")&&e?.app?.transforms&&e.app.transforms.length>0||e?.asset_type==="XLSX_FILE"&&e?.xlsx_file?.transforms&&e.xlsx_file.transforms.length>0||e?.asset_type==="DOC_FILE"&&e?.doc_file?.transforms&&e.doc_file.transforms.length>0)}function cm(e){return!e?.version_info?.parent_artifact_id||!zO(e)?!1:HO(e)===!1}function epe(e,t){if(e?.version_info?.artifact_id)return t.find(n=>n.version_info?.parent_artifact_id===e.version_info?.artifact_id&&cm(n))}function tpe(e,t){const n=f.useMemo(()=>epe(e,t),[e,t]);return f.useMemo(()=>{let r=!1;e?.app?r=!e.app.final:e?.xlsx_file?r=!e.xlsx_file.final:e?.doc_file&&(r=!e.doc_file.final);const s={streamingChild:void 0,hasStreamingChild:!1,transformedContent:"",transforms:[],isStreaming:r,hasTransforms:!1};if(n?.app?.transforms&&e?.app?.source_content){const a=s1(e.app.source_content,n.app.transforms);return{streamingChild:n,hasStreamingChild:!0,transformedContent:a,transforms:n.app.transforms,isStreaming:!n.app.final,hasTransforms:!0}}if(n?.xlsx_file?.transforms&&e?.xlsx_file?.source_content){const a=s1(e.xlsx_file.source_content,n.xlsx_file.transforms);return{streamingChild:n,hasStreamingChild:!0,transformedContent:a,transforms:n.xlsx_file.transforms,isStreaming:!n.xlsx_file.final,hasTransforms:!0}}if(n?.doc_file?.transforms&&e?.doc_file?.source_content){const a=s1(e.doc_file.source_content,n.doc_file.transforms);return{streamingChild:n,hasStreamingChild:!0,transformedContent:a,transforms:n.doc_file.transforms,isStreaming:!n.doc_file.final,hasTransforms:!0}}return s},[n,e])}function qO(e,t){if(!cm(e))return;const n=e?.version_info?.parent_artifact_id;return t.find(r=>r.version_info?.artifact_id===n)}const $O=(e,t)=>!e.assetType||!t||!e.assetUuid?null:`/apps/${t}?asset=${e.assetUuid}`,npe=(e,t)=>$O(e,t)!==null,WO=e=>e.app!==null,KO=e=>e.docxAsset===null&&e.pdfFileData!==null,YO=e=>e.docxAsset!==null,QO=e=>e.docFileAsset!==null,XO=e=>e.researchReportAsset!==null,ZO=e=>e.xlsxAsset!==null,JO=e=>e.codeFileAsset!==null,eL=e=>e.chartAsset!==null;function um(e){return t=>t?e(t):!1}const tL=um(e=>e.asset_type==="GENERATED_IMAGE"&&e.generated_image!==null),nL=um(e=>e.asset_type==="GENERATED_VIDEO"&&e.generated_video!==null),rL=um(e=>e.asset_type==="CODE_ASSET"&&e.code!==null),sL=um(e=>e.asset_type==="QUIZ"&&e.quiz!==null),aL=um(e=>e.asset_type==="FLASHCARDS"&&e.flashcards!==null),sM="exported-slides.pptx",oL=300,rpe=100,spe="section.slide",iL=.75,ape=96,lL=1920,cL=1080,ope=.85;function ipe(){return new Map}function lpe(e){return/(repeating-)?(linear|radial|conic)-gradient\(/.test(e)}function cpe(e){const t=e.match(/#([0-9A-Fa-f]{6}|[0-9A-Fa-f]{3})/);if(t)return t[0];const n=e.match(/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/);return n?`rgb(${n[1]}, ${n[2]}, ${n[3]})`:null}function upe(e,t,n,r){const s=t.match(/linear-gradient\(([^,]+),/);let a=180;if(s?.[1]){const m=s[1].trim();m.includes("deg")?a=parseFloat(m):m==="to top"?a=0:m==="to right"?a=90:m==="to bottom"?a=180:m==="to left"?a=270:m==="to top right"?a=45:m==="to bottom right"?a=135:m==="to bottom left"?a=225:m==="to top left"&&(a=315)}const o=(a-90)*Math.PI/180,i=n/2-Math.cos(o)*n/2,c=r/2-Math.sin(o)*r/2,u=n/2+Math.cos(o)*n/2,d=r/2+Math.sin(o)*r/2;return e.createLinearGradient(i,c,u,d)}function dpe(e,t,n){return e.createRadialGradient(t/2,n/2,0,t/2,n/2,Math.max(t,n)/2)}function fpe(e,t,n,r){const s=t.match(/conic-gradient\(from\s+([\d.]+)deg/),i=((s?.[1]?parseFloat(s[1]):0)-90)*Math.PI/180;return e.createConicGradient(i,n/2,r/2)}function mpe(e,t=lL,n=cL,r){const s=`${e}:${t}x${n}`;if(r){const a=r.get(s);if(a)return a}try{const a=document.createElement("canvas");a.width=t,a.height=n;const o=a.getContext("2d");if(!o||e.includes("repeating-"))return null;const i=e.includes("linear-gradient"),c=e.includes("radial-gradient"),u=e.includes("conic-gradient");if(!i&&!c&&!u)return null;let d;i?d=upe(o,e,t,n):c?d=dpe(o,t,n):d=fpe(o,e,t,n);const m=/(rgba?\([^)]+\)|#[0-9A-Fa-f]{3,6})\s+([\d.]+)(deg|%)/g,p=Array.from(e.matchAll(m));if(p.length===0)return null;p.forEach(g=>{const y=g[1],b=g[2],x=g[3];if(!y||!b||!x)return;let _;x==="%"?_=parseFloat(b)/100:_=parseFloat(b)/360,d.addColorStop(Math.max(0,Math.min(1,_)),y)}),o.fillStyle=d,o.fillRect(0,0,t,n);const h=a.toDataURL("image/jpeg",ope);return r&&r.set(s,h),h}catch{return null}}const bE=`
/* ========== CSS Variables ========== */
:root {
  /* Typography */
  --font-family-display: Arial, sans-serif;
  --font-weight-display: 600;
  --font-family-content: Arial, sans-serif;
  --font-weight-content: 400;
  --font-size-content: 16px;
  --line-height-content: 1.4;

  /* Colors - Surface */
  --color-surface: #ffffff;
  --color-surface-foreground: #1d1d1d;

  /* Colors - Primary */
  --color-primary: #1791e8;
  --color-primary-light: #3ba1ec;
  --color-primary-dark: #1581d4;
  --color-primary-foreground: #fafafa;

  /* Colors - Secondary */
  --color-secondary: #f5f5f5;
  --color-secondary-foreground: #171717;

  /* Colors - Utility */
  --color-muted: #f5f5f5;
  --color-muted-foreground: #737373;
  --color-accent: #f5f5f5;
  --color-accent-foreground: #171717;
  --color-border: #c8c8c8;

  /* Spacing & Layout */
  --spacing: 0.25rem;
  --gap: calc(var(--spacing) * 4);
  --radius: 0.4rem;
  --radius-pill: 999em;
}

/* ========== Base Reset ========== */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

/* ========== Slide Container ========== */
section.slide {
  width: 960px !important;
  height: 540px !important;
  overflow: hidden;
  font-family: var(--font-family-content);
  font-weight: var(--font-weight-content);
  font-size: var(--font-size-content);
  line-height: var(--line-height-content);
  color: var(--color-surface-foreground);
  background: var(--color-surface);
  display: flex;
  margin: 0;
  padding: 0;
  position: relative;
}

/* Body for single slide mode */
body {
  width: 960px;
  height: 540px;
  overflow: hidden;
  font-family: var(--font-family-content);
  font-weight: var(--font-weight-content);
  font-size: var(--font-size-content);
  line-height: var(--line-height-content);
  color: var(--color-surface-foreground);
  background: var(--color-surface);
  display: flex;
  margin: 0;
  padding: 0;
}

/* ========== Typography ========== */
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-family-display);
  font-weight: var(--font-weight-display);
  line-height: 1.2;
  margin: 0;
}

h1 { font-size: 3rem; }
h2 { font-size: 2.25rem; }
h3 { font-size: 1.875rem; }
h4 { font-size: 1.5rem; }
h5 { font-size: 1.25rem; }
h6 { font-size: 1.125rem; }

p { margin: 0; }

ul, ol {
  margin: 0;
  padding-left: 1.5em;
}

li {
  margin: 0.25em 0;
}

/* ========== Layout System ========== */

/* Container Classes */
.row {
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: stretch;
}

.col {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: center;
}

/* Flex Item Behavior */
.fill-width {
  flex: 1;
  align-self: stretch;
}

.fill-height {
  flex: 1;
  align-self: stretch;
}

.row .fill-width {
  flex: 1;
}

.col .fill-height {
  flex: 1;
}

.items-fill-width > * {
  flex: 1;
  align-self: stretch;
}

.items-fill-height > * {
  flex: 1;
  align-self: stretch;
}

.fit {
  flex: none;
  align-self: auto;
}

.fit-width {
  flex: none;
}

.fit-height {
  flex: none;
}

/* ========== Alignment ========== */

/* Container alignment */
.center {
  align-items: center;
  justify-content: center;
}

.start {
  align-items: flex-start;
  justify-content: flex-start;
}

.end {
  align-items: flex-end;
  justify-content: flex-end;
}

.stretch {
  align-items: stretch;
  justify-content: stretch;
}

.between {
  justify-content: space-between;
}

.around {
  justify-content: space-around;
}

.evenly {
  justify-content: space-evenly;
}

/* Self alignment */
.self-center {
  align-self: center;
}

.self-start {
  align-self: flex-start;
}

.self-end {
  align-self: flex-end;
}

.self-stretch {
  align-self: stretch;
}

/* ========== Spacing ========== */

/* Padding */
.p-0 { padding: 0; }
.p-2 { padding: calc(var(--spacing) * 2); }
.p-4 { padding: calc(var(--spacing) * 4); }
.p-6 { padding: calc(var(--spacing) * 6); }
.p-8 { padding: calc(var(--spacing) * 8); }
.p-12 { padding: calc(var(--spacing) * 12); }
.p-16 { padding: calc(var(--spacing) * 16); }
.p-24 { padding: calc(var(--spacing) * 24); }
.p-32 { padding: calc(var(--spacing) * 32); }

/* Gap */
.gap-0 { gap: 0; }
.gap-xs { gap: calc(var(--spacing) * 2); }
.gap-sm { gap: calc(var(--spacing) * 4); }
.gap-md { gap: calc(var(--spacing) * 8); }
.gap-lg { gap: calc(var(--spacing) * 16); }
.gap-xl { gap: calc(var(--spacing) * 24); }
.gap-2xl { gap: calc(var(--spacing) * 32); }

/* ========== Colors ========== */

/* Background colors */
.bg-primary {
  background-color: var(--color-primary);
  color: var(--color-primary-foreground);
}

.bg-secondary {
  background-color: var(--color-secondary);
  color: var(--color-secondary-foreground);
}

.bg-muted {
  background-color: var(--color-muted);
  color: var(--color-muted-foreground);
}

.bg-accent {
  background-color: var(--color-accent);
  color: var(--color-accent-foreground);
}

/* Text colors */
.text-primary {
  color: var(--color-primary);
}

.text-muted {
  color: var(--color-muted-foreground);
}

/* ========== Utilities ========== */

.rounded {
  border-radius: var(--radius);
}

.rounded-lg {
  border-radius: calc(var(--radius) * 2);
}

.rounded-full {
  border-radius: var(--radius-pill);
}

.shadow {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.shadow-lg {
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
}

.border {
  border: 1px solid var(--color-border);
}

/* Text alignment */
.text-left { text-align: left; }
.text-center { text-align: center; }
.text-right { text-align: right; }
.text-justify { text-align: justify; }

/* Font sizes */
.text-xs { font-size: 0.75rem; }
.text-sm { font-size: 0.875rem; }
.text-base { font-size: 1rem; }
.text-lg { font-size: 1.125rem; }
.text-xl { font-size: 1.25rem; }
.text-2xl { font-size: 1.5rem; }
.text-3xl { font-size: 1.875rem; }
.text-4xl { font-size: 2.25rem; }
.text-5xl { font-size: 3rem; }

/* Font weights */
.font-normal { font-weight: 400; }
.font-medium { font-weight: 500; }
.font-semibold { font-weight: 600; }
.font-bold { font-weight: 700; }

/* Display */
.hidden { display: none; }
.block { display: block; }
.inline { display: inline; }
.inline-block { display: inline-block; }
.flex { display: flex; }
`,an=e=>e/ape,ii=e=>parseFloat(e)*iL,es=e=>{if(!e||e==="transparent"||e==="rgba(0, 0, 0, 0)")return"FFFFFF";const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);if(!t){const n=e.match(/#([0-9A-Fa-f]{6}|[0-9A-Fa-f]{3})/);if(n&&n[1]){const r=n[1];return r.length===3?r.split("").map(s=>s+s).join("").toUpperCase():r.toUpperCase()}return"000000"}return t.slice(1,4).map(n=>parseInt(n).toString(16).padStart(2,"0")).join("").toUpperCase()},uL=e=>{if(!e)return null;const t=e.match(/rgba\((\d+),\s*(\d+),\s*(\d+),\s*([\d.]+)\)/);if(!t||!t[4])return null;const n=parseFloat(t[4]);return Math.round((1-n)*100)},ppe=(e,t,n)=>{const r=(e.ownerDocument.defaultView||window).getComputedStyle(e),s=r.backgroundImage;let a=r.backgroundColor;if((a==="rgba(0, 0, 0, 0)"||a==="transparent")&&e.className.includes("bg-")){const o=e.className.match(/bg-(\w+)/);if(o){const i=o[0],c=t.querySelectorAll("style");let u="";c.forEach(d=>{const m=d.textContent||"",p=Array.from(m.matchAll(/--color-(\w+):\s*([^;]+);/g)),h={};for(const b of p)h[`--color-${b[1]}`]=b[2]?.trim()||"";const g=new RegExp(`\\.${i}\\s*{[^}]*background-color:\\s*([^;]+);`,"s"),y=m.match(g);if(y){let b=y[1]?.trim()||"";if(b.startsWith("var(")){const x=b.match(/var\((--[^)]+)\)/)?.[1];x&&h[x]&&(b=h[x])}if(b.startsWith("#")){let x=b.substring(1);x.length===3&&(x=x.split("").map(w=>w+w).join(""));const _=parseInt(x.substring(0,2),16),v=parseInt(x.substring(2,4),16),C=parseInt(x.substring(4,6),16);u=`rgb(${_}, ${v}, ${C})`}else u=b}}),u&&(a=u)}}if(s&&s!=="none")if(lpe(s)){const o=e.getBoundingClientRect(),i=Math.round(o.width)||lL,c=Math.round(o.height)||cL,u=mpe(s,i,c,n);if(u)return{gradient:u};{const d=cpe(s);d&&(a=d)}}else{const o=s.match(/url\(["']?([^"')]+)["']?\)/);if(o&&o[1])return{path:o[1]}}return{color:es(a)}},li=e=>(e.ownerDocument.defaultView||window).getComputedStyle(e),hpe=e=>((e||"Arial").split(",")[0]||"Arial").replace(/['"]/g,"").trim(),gpe=e=>e==="bold"||parseInt(e||"400")>=600,ype=e=>e==="italic",y_=e=>{const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);return!t||!t[1]||!t[2]||!t[3]?null:{r:parseInt(t[1]),g:parseInt(t[2]),b:parseInt(t[3]),a:t[4]?parseFloat(t[4]):1}},xpe=(e,t)=>{const n=y_(e),r=y_(t);if(!n||!r)return null;const s=Math.round(n.r*n.a+r.r*(1-n.a)),a=Math.round(n.g*n.a+r.g*(1-n.a)),o=Math.round(n.b*n.a+r.b*(1-n.a));return es(`rgb(${s}, ${a}, ${o})`)},x_=e=>!!e&&e!=="rgba(0, 0, 0, 0)"&&e!=="transparent",bpe=(e,t)=>{for(const n of e){const r=n.backgroundColor;if(x_(r)){const s=y_(r);return s&&s.a<1?xpe(r,t)??void 0:es(r)}}},_pe=e=>{if(e.borderBottomWidth&&parseFloat(e.borderBottomWidth)>0){const t={type:"none"},n={pt:parseFloat(e.borderBottomWidth),color:es(e.borderBottomColor)};return[t,t,n,t]}},vpe=e=>{if(!e||e==="none"||e.match(/inset/))return null;const n=e.match(/rgba?\([^)]+\)/),r=e.match(/([-\d.]+)(px|pt)/g);if(!r||r.length<2)return null;const s=parseFloat(r[0]),a=parseFloat(r[1]||"0"),o=r.length>2?parseFloat(r[2]||"0"):0;let i=0;(s!==0||a!==0)&&(i=Math.atan2(a,s)*(180/Math.PI),i<0&&(i+=360));const c=Math.sqrt(s*s+a*a)*iL;let u=.5;if(n){const d=n[0].match(/[\d.]+\)$/);d&&(u=parseFloat(d[0].replace(")","")))}return{type:"outer",angle:Math.round(i),blur:o*.75,color:n?es(n[0]):"000000",offset:c,opacity:u}},b_=(e,t={})=>{const n=[];let r=!1;e.childNodes.forEach(a=>{const o=a.nodeType===Node.TEXT_NODE||a.tagName==="BR";if(o){const i=a.tagName==="BR"?`
`:(a.nodeValue||a.textContent||"").replace(/\s+/g," "),c=n[n.length-1];r&&c&&c.text?c.text+=i:n.push({text:i,options:{...t}})}else if(a.nodeType===Node.ELEMENT_NODE&&a.textContent?.trim()){const i=a,c={...t},u=(i.ownerDocument.defaultView||window).getComputedStyle(i);if(["SPAN","B","STRONG","I","EM","U"].includes(i.tagName)){if((u.fontWeight==="bold"||parseInt(u.fontWeight)>=600)&&(c.bold=!0),u.fontStyle==="italic"&&(c.italic=!0),u?.textDecoration?.includes("underline")&&(c.underline={style:"sng"}),u.color&&u.color!=="rgb(0, 0, 0)"){c.color=es(u.color);const m=uL(u.color);m!==null&&(c.transparency=m)}u?.fontSize&&(c.fontSize=ii(u.fontSize)),b_(i,c).forEach(m=>n.push(m))}}r=o});const s=n?.[0];if(s&&s.text){s.text=s.text.replace(/^\s+/,"");const a=n?.[n.length-1];a&&a.text&&(a.text=a.text.replace(/\s+$/,""))}return n.filter(a=>a.text&&a.text.length>0)},Cpe=e=>{if(e.display==="flex"){const t=e.alignItems;if(t==="center")return"middle";if(t==="flex-end")return"bottom"}else{const t=e.verticalAlign;if(t==="middle")return"middle";if(t==="bottom")return"bottom"}return"top"},wpe=e=>{const t=e.textAlign,n=e.direction;return t==="left"||t==="right"||t==="center"||t==="justify"?t:t==="start"?n==="rtl"?"right":"left":t==="end"?n==="rtl"?"left":"right":"center"},Spe=e=>{const t=e.whiteSpace;return!(t==="nowrap"||t==="pre")},Epe=e=>{const t=e.overflow,n=e.textOverflow;return t==="hidden"&&n==="ellipsis"?"none":"shrink"},kpe=e=>{const t=parseFloat(e.paddingLeft)||0,n=parseFloat(e.paddingRight)||0,r=parseFloat(e.paddingTop)||0,s=parseFloat(e.paddingBottom)||0,a=Math.max(t,n,r,s);return ii(a.toString())},Mpe=e=>({fontSize:ii(e.fontSize),fontFace:((e.fontFamily||"Arial").split(",")[0]||"Arial").replace(/['"]/g,"").trim(),color:es(e.color),bold:e?.fontWeight==="bold"||parseInt(e?.fontWeight||"400")>=600,italic:e?.fontStyle==="italic",align:wpe(e),valign:Cpe(e),wrap:Spe(e),margin:kpe(e),fit:Epe(e)}),Tpe=e=>{const t=[];return e.querySelectorAll(".placeholder").forEach(n=>{const r=n.getBoundingClientRect(),s=e.getBoundingClientRect();t.push({id:n.id||`placeholder-${t.length}`,x:an(r.left-s.left),y:an(r.top-s.top),w:an(r.width),h:an(r.height)})}),t},Ape=(e,t)=>{const n=[],r=e.getBoundingClientRect();return e.querySelectorAll("IMG").forEach(s=>{if(t.has(s))return;const a=s,o=s.getBoundingClientRect();o.width>0&&o.height>0&&(n.push({type:"image",src:a.src,position:{x:an(o.left-r.left),y:an(o.top-r.top),w:an(o.width),h:an(o.height)}}),t.add(s))}),n},Npe=(e,t)=>{const n=[],r=e.getBoundingClientRect();return e.querySelectorAll("DIV, SPAN").forEach(s=>{if(t.has(s))return;const a=(s.ownerDocument.defaultView||window).getComputedStyle(s),o=a.backgroundColor&&a.backgroundColor!=="rgba(0, 0, 0, 0)",i=parseFloat(a.borderWidth)>0;if(o||i){const c=s.getBoundingClientRect();if(c.width>0&&c.height>0){const u=a.boxShadow?vpe(a.boxShadow):null,d=parseFloat(a.borderRadius)||0;let m="",p=!1,h;Array.from(s.children).length>0||(m=s.textContent?.trim()||"",p=m.length>0,p&&(h=Mpe(a))),n.push({type:"shape",text:m,position:{x:an(c.left-r.left),y:an(c.top-r.top),w:an(c.width),h:an(c.height)},style:h,shape:{fill:o?es(a.backgroundColor):null,transparency:o&&a.backgroundColor?uL(a.backgroundColor):null,line:i?{color:es(a.borderColor),width:ii(a.borderWidth)}:null,rectRadius:d>0?d/10:0,shadow:u}}),p&&t.add(s)}}}),n},Rpe=e=>{if(!e.textContent?.trim())return!1;const n=e.parentElement;return!(n&&["P","H1","H2","H3","H4","H5","H6","LI","SPAN"].includes(n.tagName))},Dpe=e=>{if(!e.textContent?.trim())return!1;let n=!1;if(e.childNodes.forEach(a=>{a.nodeType===Node.TEXT_NODE&&a.textContent?.trim()&&(n=!0)}),!n)return!1;const r=e.parentElement;return!(r&&["P","H1","H2","H3","H4","H5","H6","LI","SPAN"].includes(r.tagName)||e.querySelectorAll("P, H1, H2, H3, H4, H5, H6, UL, OL, DIV, SPAN").length>0)},Ipe=(e,t)=>{const n=[],r=e.getBoundingClientRect();return e.querySelectorAll("P, H1, H2, H3, H4, H5, H6, UL, OL, SPAN, DIV").forEach(s=>{if(t.has(s)||s.tagName==="SPAN"&&!Rpe(s)||s.tagName==="DIV"&&!Dpe(s))return;const a=(s.ownerDocument.defaultView||window).getComputedStyle(s),o=s.getBoundingClientRect();if(o.width>0&&o.height>0){const i=ii(a.fontSize),c=parseFloat(a.lineHeight)||i*1.2;if(s.tagName==="UL"||s.tagName==="OL"){const u=Array.from(s.querySelectorAll("li")),d=[];u.forEach((m,p)=>{const h=p===u.length-1,g=b_(m);if(g.length>0){const y=g[0];if(!y)return;if(y.text&&(y.text=y.text.replace(/^[\-*]\s*/,"")),y.options||(y.options={}),y.options.bullet=!0,!h){const b=g[g.length-1];if(!b)return;b.options||(b.options={}),b.options.breakLine=!0}d.push(...g)}t.add(m)}),d.length>0&&(n.push({type:"list",items:d,position:{x:an(o.left-r.left),y:an(o.top-r.top),w:an(o.width),h:an(o.height)},style:{fontSize:i,fontFace:((a.fontFamily||"Arial").split(",")[0]||"Arial").replace(/['"]/g,"").trim(),color:es(a.color),align:a.textAlign,lineSpacing:ii(c.toString()),margin:0}}),t.add(s))}else{const u=b_(s),d=u.length===1?u[0]?.text:u,m=o.height<=c*1.5;let p=an(o.left-r.left),h=an(o.width);if(m){const g=o.width*.02,y=a.textAlign;y==="center"?(p=an(o.left-r.left-g/2),h=an(o.width+g)):(y==="right"&&(p=an(o.left-r.left-g)),h=an(o.width+g))}n.push({type:s.tagName.toLowerCase(),text:d,position:{x:p,y:an(o.top-r.top),w:h,h:an(o.height)},style:{fontSize:i,fontFace:((a.fontFamily||"Arial").split(",")[0]||"Arial").replace(/['"]/g,"").trim(),color:es(a.color),bold:a?.fontWeight==="bold"||parseInt(a?.fontWeight||"400")>=600,italic:a?.fontStyle==="italic",underline:a?.textDecoration?.includes("underline")?{style:"sng"}:void 0,align:a.textAlign,lineSpacing:ii(c.toString()),margin:0}}),t.add(s)}}}),n},jpe=e=>{const t=[];if(Array.from(e.children).length>0&&e.childNodes.forEach(r=>{if(r.nodeType===Node.TEXT_NODE){const s=r.textContent?.trim();if(s){const a=li(e);t.push({text:s,options:{color:es(a.color)}})}}else if(r.nodeType===Node.ELEMENT_NODE){const s=r,a=s.textContent?.trim();if(a){const o=li(s);t.push({text:a,options:{color:es(o.color)}})}}}),t.length===0){const r=e.textContent?.trim();if(r){const s=li(e);t.push({text:r,options:{color:es(s.color)}})}}return t},a1=(e,t,n)=>{const r=[];return e.forEach(s=>{const a=[],o=li(s);s.querySelectorAll("th, td").forEach(i=>{const c=i;a.push(Ppe(c,o,t,n))}),a.length>0&&r.push(a)}),r},Ppe=(e,t,n,r)=>{const s=li(e),o={text:jpe(e),options:{fontSize:ii(s.fontSize),fontFace:hpe(s.fontFamily),bold:gpe(s.fontWeight),italic:ype(s.fontStyle),align:s.textAlign||"left",valign:"middle"}},i=bpe([s,t,n].filter(u=>u!==null),r);i&&o.options&&(o.options.fill={color:i});const c=_pe(s);return c&&o.options&&(o.options.border=c),o},Ope=(e,t)=>{const n=[],r=e.getBoundingClientRect(),s=li(e),a=x_(s.backgroundColor)?s.backgroundColor:"rgb(255, 255, 255)";return e.querySelectorAll("TABLE").forEach(o=>{if(t.has(o))return;const i=o,c=o.getBoundingClientRect();if(c.width>0&&c.height>0){const u=[],d=i.parentElement,m=d?li(d):null,p=m&&x_(m.backgroundColor)?m.backgroundColor:a,h=i.querySelectorAll("thead tr"),g=i.querySelector("thead"),y=g?li(g):null;u.push(...a1(h,y,p));const b=i.querySelectorAll("tbody tr");if(u.push(...a1(b,null,p)),u.length===0){const x=i.querySelectorAll(":scope > tr");u.push(...a1(x,null,p))}u.length>0&&(n.push({type:"table",rows:u,position:{x:an(c.left-r.left),y:an(c.top-r.top),w:an(c.width),h:an(c.height)}}),t.add(o),i.querySelectorAll("*").forEach(x=>t.add(x)))}}),n};function aM(e,t,n){const r=[],s=new Set,a=ppe(e,t,n),o=Tpe(e);o.forEach(p=>{const h=e.querySelector(`#${p.id}`);h&&s.add(h)});const i=Npe(e,s),c=Ape(e,s),u=Ope(e,s),d=Ipe(e,s),m=[...i,...c,...u,...d];return{background:a,elements:m,placeholders:o,errors:r}}function oM(e,t,n){"gradient"in e.background?t.addImage({data:e.background.gradient,x:0,y:0,w:"100%",h:"100%"}):t.background=e.background;for(const r of e.elements)switch(r.type){case"table":{r.rows&&r.rows.length>0&&t.addTable(r.rows,{x:r.position.x,y:r.position.y,w:r.position.w,h:r.position.h,autoPage:!1,border:{type:"none"}});break}case"image":{t.addImage({path:r.src,x:r.position.x,y:r.position.y,w:r.position.w,h:r.position.h});break}case"shape":{const s={x:r.position.x,y:r.position.y,w:r.position.w,h:r.position.h};r.shape&&r.shape.rectRadius>0?(s.shape=n.ShapeType.roundRect,s.rectRadius=r.shape.rectRadius):s.shape=n.ShapeType.rect,r.shape?.fill&&(s.fill={color:r.shape.fill},r.shape.transparency!=null&&(s.fill.transparency=r.shape.transparency)),r.shape?.line&&(s.line=r.shape.line),r.shape?.shadow&&(s.shadow=r.shape.shadow),r.style&&(r.style.fontSize&&(s.fontSize=r.style.fontSize),r.style.fontFace&&(s.fontFace=r.style.fontFace),r.style.color&&(s.color=r.style.color),r.style.bold&&(s.bold=r.style.bold),r.style.italic&&(s.italic=r.style.italic),r.style.align&&(s.align=r.style.align),r.style.valign&&(s.valign=r.style.valign)),s.wrap=r.style?.wrap??!1,s.fit=r.style?.fit??"shrink",s.margin=r.style?.margin??0,t.addText(r.text||"",s);break}case"list":{const s={x:r.position.x,y:r.position.y,w:r.position.w,h:r.position.h,fontSize:r.style?.fontSize,fontFace:r.style?.fontFace,color:r.style?.color,align:r.style?.align,valign:"top",lineSpacing:r.style?.lineSpacing,margin:r.style?.margin};t.addText(r.items??"",s);break}case"p":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":{const s={x:r.position.x,y:r.position.y,w:r.position.w,h:r.position.h,fontSize:r.style?.fontSize,fontFace:r.style?.fontFace,color:r.style?.color,bold:r.style?.bold,italic:r.style?.italic,underline:r.style?.underline,valign:"top",align:r.style?.align,lineSpacing:r.style?.lineSpacing,inset:0};t.addText(r.text??"",s);break}default:{const s={x:r.position.x,y:r.position.y,w:r.position.w,h:r.position.h,fontSize:r.style?.fontSize,fontFace:r.style?.fontFace,color:r.style?.color,bold:r.style?.bold,italic:r.style?.italic,underline:r.style?.underline,valign:"top",align:r.style?.align,lineSpacing:r.style?.lineSpacing,inset:0};t.addText(r.text??"",s)}}}async function eg(e,t,n,r=!1,s){r&&t.querySelectorAll("img").forEach(o=>o.remove());const a=t.querySelectorAll(spe);if(a.length>0)for(let o=0;o<a.length;o++){const i=a[o];let c=aM(i,t,s);r&&(c={...c,elements:c.elements.filter(d=>d.type!=="image")});const u=e.addSlide();oM(c,u,e)}else{const o=n.createElement("section");o.className="slide",o.innerHTML=t.innerHTML,t.innerHTML="",t.appendChild(o);const i=n.createElement("style");i.textContent=bE,t.insertBefore(i,t.firstChild),await new Promise(d=>setTimeout(d,rpe));let c=aM(o,t,s);r&&(c={...c,elements:c.elements.filter(d=>d.type!=="image")});const u=e.addSlide();oM(c,u,e)}}async function Lpe(e,t="exported-slides.pptx"){const n=document.createElement("iframe");n.style.cssText=`
    position: fixed !important;
    left: -10000px !important;
    top: -10000px !important;
    width: 1920px !important;
    height: 1080px !important;
    border: none !important;
    visibility: hidden !important;
    pointer-events: none !important;
    opacity: 0 !important;
    display: block !important;
  `,n.setAttribute("aria-hidden","true"),document.body.appendChild(n);const r=ipe();try{const s=n.contentDocument||n.contentWindow?.document;if(!s)throw new Error("Failed to access iframe document");s.body||(s.write("<!DOCTYPE html><html><head></head><body></body></html>"),s.close());const a=s.createElement("div");if(a.style.cssText=`
    width: 1920px;
    height: 1080px;
  `,s.body.appendChild(a),a.innerHTML=e,!a.querySelector("style")){const i=s.createElement("style");i.textContent=bE,a.insertBefore(i,a.firstChild)}await new Promise(i=>setTimeout(i,oL));let o=new(await W(async()=>{const{default:i}=await import("./pptxgen.es-CkA_NdID.js");return{default:i}},__vite__mapDeps([92,3]))).default;o.layout="LAYOUT_16x9",o.author="Perplexity",o.title="Converted Presentation",o.company="Perplexity AI";try{await eg(o,a,s,!1,r),await o.writeFile({fileName:t||sM})}catch(i){Z.warn("PPTX export failed with images, retrying without images",{error:i}),o=new(await W(async()=>{const{default:c}=await import("./pptxgen.es-CkA_NdID.js");return{default:c}},__vite__mapDeps([92,3]))).default,o.layout="LAYOUT_16x9",o.author="Perplexity",o.title="Converted Presentation",o.company="Perplexity AI",await eg(o,a,s,!0,r),await o.writeFile({fileName:t||sM})}}finally{document.body.removeChild(n),r.clear()}}async function Fpe(e,t="slides.pptx"){try{await Lpe(e,t)}catch(n){throw Z.error("Failed to export slides to PPTX",{error:n}),new Error("Failed to export slides to PowerPoint format")}}async function Upe(e){const t=document.createElement("iframe");t.style.cssText=`
    position: fixed !important;
    left: -10000px !important;
    top: -10000px !important;
    width: 1920px !important;
    height: 1080px !important;
    border: none !important;
    visibility: hidden !important;
    pointer-events: none !important;
    opacity: 0 !important;
    display: block !important;
  `,t.setAttribute("aria-hidden","true"),document.body.appendChild(t);try{const n=t.contentDocument||t.contentWindow?.document;if(!n)throw new Error("Failed to access iframe document");n.body||(n.write("<!DOCTYPE html><html><head></head><body></body></html>"),n.close());const r=n.createElement("div");if(r.style.cssText=`
      width: 1920px;
      height: 1080px;
    `,n.body.appendChild(r),r.innerHTML=e,!r.querySelector("style")){const a=n.createElement("style");a.textContent=bE,r.insertBefore(a,r.firstChild)}await new Promise(a=>setTimeout(a,oL));let s=new(await W(async()=>{const{default:a}=await import("./pptxgen.es-CkA_NdID.js");return{default:a}},__vite__mapDeps([92,3]))).default;s.layout="LAYOUT_16x9",s.author="Perplexity",s.title="Converted Presentation",s.company="Perplexity AI";try{return await eg(s,r,n,!1),await s.write({outputType:"blob"})}catch{return s=new(await W(async()=>{const{default:i}=await import("./pptxgen.es-CkA_NdID.js");return{default:i}},__vite__mapDeps([92,3]))).default,s.layout="LAYOUT_16x9",s.author="Perplexity",s.title="Converted Presentation",s.company="Perplexity AI",await eg(s,r,n,!0),await s.write({outputType:"blob"})}}finally{t.parentNode&&document.body.removeChild(t)}}function Bpe(e){return new Promise((t,n)=>{const r=new FileReader;r.onloadend=()=>{if(typeof r.result=="string"){const s=r.result.split(",")[1];s?t(s):n(new Error("Failed to extract base64 from data URL"))}else n(new Error("Failed to convert blob to base64"))},r.onerror=n,r.readAsDataURL(e)})}async function iM({htmlContent:e,filename:t,saveFile:n}){const r=await Upe(e);if(!r)throw new Error("Failed to generate PPTX file");const s=await Bpe(r),a=t.endsWith(".pptx")?t:`${t}.pptx`;return{webViewLink:(await n({fileName:a,fileContentB64:s,mimeType:"application/vnd.openxmlformats-officedocument.presentationml.presentation",connectionType:"GOOGLE_DRIVE"})).web_view_link}}const Hpe={xlsx:D("file-type-xls"),csv:D("file-type-csv"),pdf:D("file-type-pdf"),docx:D("file-type-doc"),pptx:D("file-type-ppt")},Vpe={xlsx:"XLSX",csv:"CSV",pdf:"PDF",docx:"DOCX",pptx:"PPTX",md:"Markdown",png:"Image",jpg:"Image",jpeg:"Image"};function Gpe(e){return e?Hpe[e.toLowerCase()]??D("download"):D("download")}function zpe(e,t){if(!t)return lM(e);const n=t.toLowerCase();return Vpe[n]??lM(e)}function lM(e){return e==="SLIDES"||e==="APP"?"HTML":"File"}const qpe=({reason:e})=>{const{$t:t}=Q(),{openToast:n}=cn(),r=f.useCallback(async s=>{try{const a=await MS({name:s,reason:e,autoClose:!0});if(!a)return n({message:t({defaultMessage:"Unable to start authentication.",id:"7sb7u3pWWr"}),variant:"error",timeout:3}),!1;const o=600,i=700,c=window.screenX+(window.outerWidth-o)/2,u=window.screenY+(window.outerHeight-i)/2,d=window.open(a,"oauth-popup",`width=${o},height=${i},left=${c},top=${u},popup=yes,noopener=no`);return d?new Promise(m=>{const p=setInterval(()=>{d.closed&&(clearInterval(p),Z.info("OAuth popup closed",{connectorName:s,reason:e}),m(!0))},500);setTimeout(()=>{clearInterval(p),d.closed||(d.close(),Z.warn("OAuth popup timeout",{connectorName:s,reason:e}),m(!1))},300*1e3)}):(n({message:t({defaultMessage:"Please allow popups to connect your account.",id:"gMeARpuir7"}),variant:"error",timeout:3}),!1)}catch(a){return Z.error("Failed to start OAuth flow",{error:a,connectorName:s,reason:e}),n({message:t({defaultMessage:"Failed to connect account. Please try again.",id:"l9HkZMlKDR"}),variant:"error",timeout:3}),!1}},[e,t,n]);return f.useMemo(()=>({startOAuthFlow:r}),[r])},$pe=({reason:e})=>{const[t,n]=f.useState(!1),r=f.useCallback(async s=>{n(!0);try{const{data:a,error:o}=await ve.POST("/rest/connectors/save-file",e,{body:{file_name:s.fileName,s3_url:s.s3Url,file_content_b64:s.fileContentB64,mime_type:s.mimeType,connection_type:s.connectionType,parent_remote_id:s.parentRemoteId},timeoutMs:Ct()});if(o){Z.error("Failed to save file to connector",{error:o,request:s,errorMessage:o instanceof Error?o.message:"Unknown error"});const i=o.detail;return{success:!1,errorCode:i?.error_code,errorMessage:i?.error_message||"Failed to save file"}}return a?{success:a.success,webViewLink:a.web_view_link??void 0,errorCode:a.error_code??void 0,errorMessage:a.error_message??void 0}:{success:!1,errorMessage:"No response from server"}}catch(a){return Z.error("Unexpected error saving file to connector",{err:a,request:s,errorMessage:a instanceof Error?a.message:"Unknown error"}),{success:!1,errorMessage:a instanceof Error?a.message:"Unknown error"}}finally{n(!1)}},[e]);return f.useMemo(()=>({saveFile:r,isLoading:t}),[r,t])};function Wpe({asset:e,assetResult:t}){const n=GO(e),r=[],{session:s}=je(),{trackEvent:a}=Ze(s),{$t:o}=Q(),{openToast:i}=cn(),[c,u]=f.useState(!1),d=wt(),{downloadS3Asset:m}=rO({reason:"canvas-pdf-download"}),{saveFile:p}=$pe({reason:"canvas-export-to-drive"}),{startOAuthFlow:h}=qpe({reason:"canvas-export-to-drive"}),g=f.useCallback(async x=>{if(!c){u(!0);try{const _=rM(n,x.filename!=null?x.filename:"download");let v=await p({fileName:_,s3Url:x.url??"",connectionType:"GOOGLE_DRIVE"});if(v.errorCode==="MISSING_SCOPE"||v.errorCode==="ACCOUNT_NOT_CONNECTED"||v.errorCode==="AUTH_ERROR")if(await h("google_drive"))v=await p({fileName:_,s3Url:x.url??"",connectionType:"GOOGLE_DRIVE"});else return;if(v.success&&v.webViewLink)t&&e&&e.asset_type!=null&&a("canvas content downloaded",{entryUUID:t.backend_uuid,contentType:e.asset_type,assetUUID:e.uuid??"",downloadType:"export"}),i({message:o({defaultMessage:"File exported to Google Drive",id:"FDX8mJLmJm"}),variant:"success",timeout:3}),window.open(v.webViewLink,"_blank");else{let C=o({defaultMessage:"Failed to export file",id:"5/D0jskfku"});v.errorCode==="FILE_TOO_LARGE"?C=o({defaultMessage:"File exceeds 20MB limit for export",id:"UZ4y2AORv5"}):v.errorMessage&&(C=v.errorMessage),i({message:C,variant:"error",timeout:3}),Z.error("Failed to export file to Drive",{errorCode:v.errorCode,errorMessage:v.errorMessage,fileName:x.filename})}}catch(_){Z.error("Unexpected error during export",{error:_,info:x}),i({message:o({defaultMessage:"Failed to export file",id:"5/D0jskfku"}),variant:"error",timeout:3})}finally{u(!1)}}},[n,c,p,h,t,e,a,o,i]),y=f.useCallback(async(x,_)=>{if(!c){u(!0);try{const v=await iM({htmlContent:x,filename:_,saveFile:async C=>{const w=await p({...C});if(!w.success)throw new Error(`Export failed: ${w.errorCode??"unknown error"}${w.errorMessage?` - ${w.errorMessage}`:""}`);return{web_view_link:w.webViewLink??""}}});t&&e&&e.asset_type!=null&&a("canvas content downloaded",{entryUUID:t.backend_uuid,contentType:e.asset_type,assetUUID:e.uuid??"",downloadType:"export"}),i({message:o({defaultMessage:"Slides exported to Google Drive",id:"efsXWg4g3j"}),variant:"success",timeout:3}),window.open(v.webViewLink,"_blank")}catch(v){if(v instanceof Error&&(v.message.includes("MISSING_SCOPE")||v.message.includes("ACCOUNT_NOT_CONNECTED")||v.message.includes("AUTH_ERROR")))if(await h("google_drive"))try{const w=await iM({htmlContent:x,filename:_,saveFile:async S=>{const E=await p({...S});if(!E.success)throw new Error(`Export failed: ${E.errorCode??"unknown error"}${E.errorMessage?` - ${E.errorMessage}`:""}`);return{web_view_link:E.webViewLink??""}}});t&&e&&e.asset_type!=null&&a("canvas content downloaded",{entryUUID:t.backend_uuid,contentType:e.asset_type,assetUUID:e.uuid??"",downloadType:"export"}),i({message:o({defaultMessage:"Slides exported to Google Drive",id:"efsXWg4g3j"}),variant:"success",timeout:3}),window.open(w.webViewLink,"_blank");return}catch(w){Z.error("Failed to export slides after OAuth",{error:w})}else return;i({message:v instanceof Error&&v.message?v.message:o({defaultMessage:"Failed to export slides",id:"W62bIrXvad"}),variant:"error",timeout:3}),Z.error("Failed to export slides to Drive",{error:v})}finally{u(!1)}}},[c,p,h,t,e,a,o,i]);if(Sme(e)&&WO(n)&&n.app.source_content){const x=VO(n)||"slides",_=q2(`${x}.pptx`);r.push({type:"default",downloadType:"trigger",text:o({defaultMessage:"Download as PPTX",id:"MbQGjmBtrT"}),icon:D("file-type-ppt"),category:"download",onClick:async()=>{t&&e&&e.asset_type!=null&&a("canvas content downloaded",{entryUUID:t.backend_uuid,contentType:e.asset_type,assetUUID:e.uuid??"",downloadType:"download"});try{await Fpe(n.app?.source_content??"",_)}catch{}}}),d&&r.push({type:"default",downloadType:"trigger",text:o({defaultMessage:"Export PPTX to GDrive",id:"vxG0vz9KXW"}),icon:D("brand-google-drive"),category:"export",onClick:()=>{y(n.app?.source_content??"",x)}})}return e?.download_info&&e.download_info.length>0&&e.download_info.forEach(x=>{if(!x.url||!Kg(x.url))return;const _=kI(x.filename),v=Gpe(_),C=e.asset_type!=null?zpe(e.asset_type,_):"File",w=rM(n,x.filename!=null?x.filename:"download");r.push({type:"default",downloadType:"trigger",text:o({defaultMessage:"Download as {fileType}",id:"PJh4v0uaV6"},{fileType:C}),icon:v,category:"download",onClick:()=>{t&&e&&e.asset_type!=null&&a("canvas content downloaded",{entryUUID:t.backend_uuid,contentType:e.asset_type,assetUUID:e.uuid??"",downloadType:"download"}),m({url:x.url??"",filename:w})}}),x.is_exportable&&d&&r.push({type:"default",downloadType:"trigger",text:o({defaultMessage:"Export {fileType} to GDrive",id:"IHrc/RdUMs"},{fileType:C}),icon:D("brand-google-drive"),category:"export",onClick:()=>{g(x)}})}),r}function Kpe(e,t,n){return e?n.hasStreamingChild&&n.transformedContent?{final:n.transformedContent,url:t.app?.url??null,name:t.app?.name??null,isFinal:n.streamingChild?.app?.final??!1,isStreaming:n.isStreamingChildActive}:WO(t)?{final:t.app.source_content??null,url:t.app.url??null,name:t.app.name??null,isFinal:t.app.final??!1,isStreaming:!t.app.final}:ZO(t)?n.hasStreamingChild&&n.transformedContent?{final:n.transformedContent,url:t.xlsxAsset.url??null,name:t.xlsxAsset.name??null,isFinal:n.streamingChild?.xlsx_file?.final??!1,isStreaming:n.isStreamingChildActive}:{final:t.xlsxAsset.source_content??null,url:t.xlsxAsset.url??null,name:t.xlsxAsset.name??null,isFinal:t.xlsxAsset.final??!1,isStreaming:!t.xlsxAsset.final}:KO(t)?{final:t.pdfFileData?.url??null,url:t.pdfFileData?.url??null,name:t.pdfFileData?.name??null,isFinal:!0,isStreaming:!1}:YO(t)?{final:t.docxAsset.url??null,url:t.docxAsset.url??null,name:t.docxAsset.name??null,isFinal:!0,isStreaming:!1}:QO(t)?n.hasStreamingChild&&n.transformedContent?{final:n.transformedContent,url:t.docFileAsset.url??null,name:t.docFileAsset.name??null,isFinal:n.streamingChild?.doc_file?.final??!1,isStreaming:n.isStreamingChildActive}:{final:t.docFileAsset.source_content??null,url:t.docFileAsset.url??null,name:t.docFileAsset.name??null,isFinal:t.docFileAsset.final??!1,isStreaming:!t.docFileAsset.final}:XO(t)?n.hasStreamingChild&&n.transformedContent?{final:n.transformedContent,url:t.researchReportAsset.url??null,name:t.researchReportAsset.name??null,isFinal:n.streamingChild?.research_report?.final??!1,isStreaming:n.isStreamingChildActive}:{final:t.researchReportAsset.source_content??null,url:t.researchReportAsset.url??null,name:t.researchReportAsset.name??null,isFinal:t.researchReportAsset.final??!1,isStreaming:!t.researchReportAsset.final}:eL(t)?{final:t.chartAsset.url??null,url:t.chartAsset.url??null,name:null,isFinal:!0,isStreaming:!1}:JO(t)?{final:null,url:null,name:t.codeFileAsset.filename??null,isFinal:!0,isStreaming:!1}:rL(e)?{final:e.code.script??null,url:null,name:null,isFinal:!0,isStreaming:!1}:tL(e)?{final:e.generated_image.url??null,url:e.generated_image.url??null,name:null,isFinal:!0,isStreaming:!1}:nL(e)?{final:e.generated_video.url??null,url:e.generated_video.url??null,name:null,isFinal:!0,isStreaming:!1}:sL(e)?{final:null,url:null,name:e.quiz.title??null,isFinal:!0,isStreaming:!1}:aL(e)?{final:null,url:null,name:e.flashcards.title??null,isFinal:!0,isStreaming:!1}:{final:null,url:null,name:null,isFinal:!0,isStreaming:!1}:{final:null,url:null,name:null,isFinal:!0,isStreaming:!1}}function Ype(e,t){if(e?.asset_type==="APP"||e?.asset_type==="SLIDES"){const n=e.app?.final===!0,r=!!e.app?.source_content,s=n,a=r,o=[];s&&o.push(un.Preview),a&&o.push(un.Source);let i=null;return t.isStreamingUpdate||t.hasStreamingChild&&!t.streamingChild?.app?.final?i=un.Source:n||t.streamingChild?.app?.final?i=un.Preview:!n&&r&&(i=un.Source),{supportsPreviewTab:s,supportsCodeTab:a,availableTabs:o,defaultTab:i}}if(e?.asset_type==="XLSX_FILE"){const n=e.xlsx_file?.final===!0,r=!!e.xlsx_file?.source_content,s=n,a=r,o=[];s&&o.push(un.Preview),a&&o.push(un.Source);let i=null;return t.isStreamingUpdate||t.hasStreamingChild&&!t.streamingChild?.xlsx_file?.final?i=un.Source:n||t.streamingChild?.xlsx_file?.final?i=un.Preview:!n&&r&&(i=un.Source),{supportsPreviewTab:s,supportsCodeTab:a,availableTabs:o,defaultTab:i}}if(e?.asset_type==="DOC_FILE"){const n=e.doc_file?.final===!0,r=!!e.doc_file?.source_content,s=n,a=r,o=[];s&&o.push(un.Preview),a&&o.push(un.Source);let i=null;return t.isStreamingUpdate||t.hasStreamingChild&&!t.streamingChild?.doc_file?.final?i=un.Source:n||t.streamingChild?.doc_file?.final?i=un.Preview:!n&&r&&(i=un.Source),{supportsPreviewTab:s,supportsCodeTab:a,availableTabs:o,defaultTab:i}}if(e?.asset_type==="RESEARCH_REPORT"){const n=e.research_report?.final===!0,r=!!e.research_report?.source_content,s=n,a=r,o=[];s&&o.push(un.Preview),a&&o.push(un.Source);let i=null;return t.isStreamingUpdate||t.hasStreamingChild&&!t.streamingChild?.research_report?.final?i=un.Source:n||t.streamingChild?.research_report?.final?i=un.Preview:!n&&r&&(i=un.Source),{supportsPreviewTab:s,supportsCodeTab:a,availableTabs:o,defaultTab:i}}return{supportsPreviewTab:!1,supportsCodeTab:!1,availableTabs:[],defaultTab:null}}function Qpe({asset:e,allAssets:t,assetResult:n,backendUuid:r}){const s=GO(e),a=tpe(e,t),o=f.useMemo(()=>({hasTransforms:zO(e),isStreamingUpdate:cm(e),streamingChild:a.streamingChild,transformedContent:a.transformedContent,parentAsset:void 0,hasStreamingChild:a.hasStreamingChild,isStreamingChildActive:a.isStreaming}),[e,a]),i=f.useMemo(()=>Kpe(e,s,o),[e,s,o]),c=f.useMemo(()=>Ype(e,o),[e,o]),u=Wpe({asset:e,assetResult:n}),d=f.useMemo(()=>{const p=r??n?.backend_uuid,h=npe(s,p),g=$O(s,p);return{supportsFullScreen:h,fullScreenUrl:g,supportsDownload:u.length>0,downloadableItems:u,supportsVersioning:!!e?.version_info}},[s,r,n,u,e]),m=f.useMemo(()=>({app:e?.asset_type==="APP",slides:e?.asset_type==="SLIDES",pdf:KO(s),docx:YO(s),docFile:QO(s),researchReport:XO(s),xlsx:ZO(s),codeFile:JO(s),chart:eL(s),code:rL(e),generatedImage:tL(e),generatedVideo:nL(e),quiz:sL(e),flashcards:aL(e)}),[e,s]);return{assetData:s,content:i,streaming:o,tabs:c,capabilities:d,is:m}}const dL=()=>{const{results:e}=Ht(),t=f.useMemo(()=>!e||e.length===0?[]:e.map(s=>({result:s,assets:xE(s?.blocks??_e,{orderedByPriority:!0})})),[e]),n=f.useMemo(()=>t.flatMap(({assets:s})=>s),[t]),r=n.length>0;return{resultAssets:t,allAssets:n,hasAssets:r}};function Xpe(e,t){const{allAssets:n}=dL(),r=f.useRef(null),s=f.useMemo(()=>cm(e)&&qO(e,n)||e,[e,n]),a=Qpe({asset:s,allAssets:n});f.useEffect(()=>{if(a.tabs.availableTabs.length===0)return;const o=a.tabs.defaultTab;o&&r.current!==o&&(t({type:"setTab",tab:o}),r.current=o)},[a.tabs,t])}function Zpe({asset:e,inFlight:t,contextUuid:n,backendUuid:r}){const{doCanvasAction:s}=Dl(),{session:a}=je(),{trackEvent:o}=Ze(a),{allAssets:i}=dL(),c=f.useRef(!1),u=f.useRef(void 0),d=f.useRef(void 0),{title:m}=kw(e);f.useEffect(()=>{if(!e||!t)return;const p=e.uuid,h=HO(e)===!0,y=!(d.current!==p)&&!u.current&&h;if(!c.current||y){let x=e;if(cm(e)){const _=qO(e,i);_&&(x=_)}s({type:"setAsset",assetUuid:x.uuid??"",title:m,backendUuid:r}),!c.current&&e.asset_type!=null&&o("canvas opened",{source:"auto",contextUUID:n,entryUUID:r,assetUUID:e.uuid??"",contentType:e.asset_type}),c.current=!0,d.current=p}u.current=h},[e,s,t,o,n,r,m,i]),f.useEffect(()=>{t||(c.current=!1,d.current=void 0,u.current=void 0)},[t])}function Jpe({data:e,inFlight:t}){const{openCanvas:n}=Dl();f.useEffect(()=>{t&&e.should_auto_open&&n()},[t,e.should_auto_open,n])}function ehe({data:e,inFlight:t}){const{doCanvasAction:n}=Dl(),r=f.useRef(void 0);f.useEffect(()=>{if(!t)return;const s={progress:e.progress,assetType:e.expected_asset_type};(r.current?.progress!==s.progress||r.current?.assetType!==s.assetType)&&(n({type:"setLoading",loading:e.progress==="IN_PROGRESS",assetType:e.expected_asset_type}),r.current=s)},[e.progress,e.expected_asset_type,n,t])}const the=({data:e})=>{const{inFlight:t,result:{blocks:n,context_uuid:r,backend_uuid:s}}=Pt(),a=Pme(n,e.asset?.uuid??""),{doCanvasAction:o}=Dl();return Jpe({data:e,inFlight:t}),ehe({data:e,inFlight:t}),Zpe({asset:a,inFlight:t,contextUuid:r,backendUuid:s}),Xpe(a,o),null},nhe=()=>{const{blocksByIntendedUsage:{canvas_mode:e}}=Pt();return e?.canvas_block};var o1,cM;function rhe(){if(cM)return o1;cM=1;var e=typeof Element<"u",t=typeof Map=="function",n=typeof Set=="function",r=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function s(a,o){if(a===o)return!0;if(a&&o&&typeof a=="object"&&typeof o=="object"){if(a.constructor!==o.constructor)return!1;var i,c,u;if(Array.isArray(a)){if(i=a.length,i!=o.length)return!1;for(c=i;c--!==0;)if(!s(a[c],o[c]))return!1;return!0}var d;if(t&&a instanceof Map&&o instanceof Map){if(a.size!==o.size)return!1;for(d=a.entries();!(c=d.next()).done;)if(!o.has(c.value[0]))return!1;for(d=a.entries();!(c=d.next()).done;)if(!s(c.value[1],o.get(c.value[0])))return!1;return!0}if(n&&a instanceof Set&&o instanceof Set){if(a.size!==o.size)return!1;for(d=a.entries();!(c=d.next()).done;)if(!o.has(c.value[0]))return!1;return!0}if(r&&ArrayBuffer.isView(a)&&ArrayBuffer.isView(o)){if(i=a.length,i!=o.length)return!1;for(c=i;c--!==0;)if(a[c]!==o[c])return!1;return!0}if(a.constructor===RegExp)return a.source===o.source&&a.flags===o.flags;if(a.valueOf!==Object.prototype.valueOf&&typeof a.valueOf=="function"&&typeof o.valueOf=="function")return a.valueOf()===o.valueOf();if(a.toString!==Object.prototype.toString&&typeof a.toString=="function"&&typeof o.toString=="function")return a.toString()===o.toString();if(u=Object.keys(a),i=u.length,i!==Object.keys(o).length)return!1;for(c=i;c--!==0;)if(!Object.prototype.hasOwnProperty.call(o,u[c]))return!1;if(e&&a instanceof Element)return!1;for(c=i;c--!==0;)if(!((u[c]==="_owner"||u[c]==="__v"||u[c]==="__o")&&a.$$typeof)&&!s(a[u[c]],o[u[c]]))return!1;return!0}return a!==a&&o!==o}return o1=function(o,i){try{return s(o,i)}catch(c){if((c.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw c}},o1}var she=rhe();const fL=ha(she),ahe=e=>{if(!e?.length)return[];if(!e.some(s=>s.step_type==="CONNECTOR_DIRECT_SEARCH_INPUT"||s.step_type==="CONNECTOR_DIRECT_SEARCH_OUTPUT"))return e;let n=-1;return e.reduce((s,a,o)=>{if(o<=n||a.step_type==="CONNECTOR_DIRECT_SEARCH_OUTPUT")return s;const i=e[o+1];return a.step_type==="CONNECTOR_DIRECT_SEARCH_INPUT"?i&&i.step_type==="CONNECTOR_DIRECT_SEARCH_OUTPUT"?(s.push({...a,input_content:a.content,output_content:i.content}),n=o+1,s):(s.push({...a,input_content:a.content}),s):(s.push({...a}),s)},[])},fp=(e,t)=>{if(typeof e=="object"&&e!==null&&t in e){const n=e[t];return typeof n=="string"?n:void 0}},ohe=(e,t)=>{if(e.step_type!=="MCP_TOOL_INPUT"||t.step_type!=="MCP_TOOL_OUTPUT")return!1;const n=fp(e.content,"goal_id"),r=fp(t.content,"goal_id");if(n&&r)return n===r;const s=fp(e.content,"tool_name"),a=fp(t.content,"tool_name");return!!(s&&a&&s===a)};function ihe(e){if(!e?.length)return[];if(!e.some(s=>s.step_type==="MCP_TOOL_INPUT"||s.step_type==="MCP_TOOL_OUTPUT"))return e;let n=-1;return e.reduce((s,a,o)=>{if(o<=n||a.step_type==="MCP_TOOL_OUTPUT")return s;const i=e[o+1];return a.step_type==="MCP_TOOL_INPUT"&&i&&ohe(a,i)?(s.push({...a,mcp_tool_output_content:i.content}),n=o+1,s):(s.push({...a}),s)},[])}const lhe=e=>{switch(e){case"Notion":return r0;case"Linear":return s0;case"GitHub":return o0;case"Asana":return i0;case"Atlassian":return l0;case"Slack":return a0;case"Wiley":return Vc;case"CB Insights":return T0;case"PitchBook":return A0;case"Statista":return N0;default:return null}},che=A.memo(function({asset:t}){const{isCanvasOpen:n,canvasState:r}=Dl(),s=f.useMemo(()=>n&&t.uuid===r?.assetUuid,[t.uuid,r?.assetUuid,n]),{title:a,description:o,Icon:i}=kw(t),c=OO({asset:t}),u=f.useCallback(async()=>{c()},[c]);return l.jsxs(Y,{onClick:u,role:"button",tabIndex:0,variant:KC.subtler,className:z("flex w-fit items-center rounded-lg p-1.5",s&&"ring-super !ring-1"),children:[l.jsx(Y,{variant:"super",className:"m-1 flex size-8 items-center justify-center rounded-md p-2",children:l.jsx(ye,{icon:i,size:"md",className:"text-inverse"})}),l.jsxs("div",{className:"flex flex-col gap-0.5 px-2",children:[l.jsx(B,{variant:"small",color:"default",className:"!text-[0.8125rem] font-medium",children:a}),l.jsx(B,{variant:"tinyRegular",color:"light",className:"!text-[0.6875rem] leading-none",children:o})]})]})},({asset:e,...t},{asset:n,...r})=>xn(t,r)&&Ff(e,n)),uM="/static/images/agent-favicons/gmail.svg",uhe="/static/images/data-connectors/microsoft/outlook-avatar.svg",La={click:{message:V({defaultMessage:"Clicking",id:"n43/KMHgLD"}),icon:D("click")},paused:{message:V({defaultMessage:"Paused",id:"C2iTEHtK//"}),icon:D("pointer-pause")},fill:{message:V({defaultMessage:"Filling out a form",id:"5i0X5DesMM"}),icon:D("forms")},search:{message:V({defaultMessage:"Searching",id:"IfE0if3ytt"}),icon:D("search")},search_images:{message:V({defaultMessage:"Searching for images",id:"NaBAkNUPuD"}),icon:D("search")},press_key:{message:V({defaultMessage:"Pressing key",id:"R6bmgzv6Xs"}),icon:D("keyboard")},key:{message:V({defaultMessage:"Pressing key",id:"R6bmgzv6Xs"}),icon:D("keyboard")},scroll_page:{message:V({defaultMessage:"Scrolling",id:"/UUUqdefcb"}),icon:D("square-rounded-arrow-down")},scroll:{message:V({defaultMessage:"Scrolling",id:"/UUUqdefcb"}),icon:D("square-rounded-arrow-down")},reasoning:{message:V({defaultMessage:"Reasoning",id:"Aw3qRf7hyO"}),icon:D("bubble-text")},considering_clarification:{message:V({defaultMessage:"Considering your clarification",id:"xvwGmM2LU3"}),icon:D("bubble-text")},working:{message:V({defaultMessage:"Working",id:"gAR0atqpRn"}),icon:D("access-point")},finished:{message:V({defaultMessage:"Done",id:"JXdbo8Vnlw"}),icon:D("check")},reading:{message:V({defaultMessage:"Reading",id:"MOK/yKIpYX"}),icon:D("file-text")},reading_browser:{message:V({defaultMessage:"Reviewing your tabs and browser history",id:"P+tFAY9IRT"}),icon:D("file-text")},getting_source:{message:V({defaultMessage:"Reading source",id:"Ou1PWB5wwu"}),icon:D("file-text")},getting_sources:{message:V({defaultMessage:"Reading sources",id:"fKpmtHm+hd"}),icon:D("file-text")},reviewing_source:{message:V({defaultMessage:"Reviewing source",id:"ymFEF2YHhs"}),icon:D("file-text")},reviewing_sources:{message:V({defaultMessage:"Reviewing sources",id:"/NZJDBzKok"}),icon:D("file-text")},reviewing_memory:{message:V({defaultMessage:"Reviewing memory",id:"piUVOodSmM"}),icon:D("file-text")},reviewing_memories:{message:V({defaultMessage:"Reviewing memories",id:"VgUfUXIIey"}),icon:D("file-text")},reviewing_conversation_history:{message:V({defaultMessage:"Reviewing past queries",id:"RfG7EQT3IO"}),icon:D("file-text")},reading_tabs:{message:V({defaultMessage:"Reviewing your tabs",id:"cE3TzCT3eK"}),icon:D("file-text")},building_app:{message:V({defaultMessage:"Building application",id:"qK6gEQyvil"}),icon:D("tools")},creating_chart:{message:V({defaultMessage:"Creating chart",id:"yc5YxtS5VS"}),icon:D("graph")},creating_pdf:{message:V({defaultMessage:"Creating PDF",id:"NcD2ia4Hrn"}),icon:D("file-type-pdf")},creating_docx:{message:V({defaultMessage:"Creating DOCX",id:"GIUtasyzkA"}),icon:D("file-type-docx")},creating_xlsx:{message:V({defaultMessage:"Creating XLSX",id:"ZyT2MB8/KD"}),icon:D("file-spreadsheet")},thinking:{message:V({defaultMessage:"Thinking",id:"AHQWDTo4+e"}),icon:D("bubble-text")},reading_history:{message:V({defaultMessage:"Reviewing your browser history",id:"7cZkJ7qeNW"}),icon:D("world-search")},searching_browser:{message:V({defaultMessage:"Searching your browser",id:"i91D1hXua6"}),icon:D("world-search")},searching_open_tabs:{message:V({defaultMessage:"Searching open tabs",id:"xHbSQOjdLq"}),icon:D("input-search")},opening_tab:{message:V({defaultMessage:"Opening tab",id:"ySnoI+lduZ"}),icon:D("browser-plus")},closing_tabs:{message:V({defaultMessage:"Closing your tabs",id:"2KnXtfjRKV"}),icon:D("browser-minus")},searching_gmail:{message:V({defaultMessage:"Searching your email",id:"X1ami4cm1T"}),icon:D("mail-search")},emailing:{message:V({defaultMessage:"Emailing",id:"QRygokyD+u"}),icon:D("mail-search")},searching_calendar:{message:V({defaultMessage:"Searching your calendar",id:"nH9G8cL0Ys"}),icon:D("calendar-search")},conclusion:{message:V({defaultMessage:"Wrapping up",id:"DN3hjkyzeT"}),icon:null},generating_images:{message:V({defaultMessage:"Generating",id:"NAZfqr2apb"}),icon:D("photo-bolt")},presenting_images:{message:V({defaultMessage:"Presenting",id:"BlxYo7+tmK"}),icon:D("slideshow")},grouping_tabs:{message:V({defaultMessage:"Grouping tabs",id:"Fg6l7eg2HV"}),icon:D("server-bolt")},ungrouping_tabs:{message:V({defaultMessage:"Ungrouping tab groups",id:"dbpFCBu2NQ"}),icon:D("server-off")},searching_tab_groups:{message:V({defaultMessage:"Searching tab groups",id:"V+4/ioYMPd"}),icon:D("search")},getting_freebusy:{message:V({defaultMessage:"Checking availability",id:"ZamRNp2QgI"}),icon:D("calendar-search")},getting_user_info:{message:V({defaultMessage:"Searching your contacts",id:"gPpZJKZdnL"}),icon:D("address-book")},found_contacts:{message:V({defaultMessage:"Found contacts",id:"2zmZgbYnmk"}),icon:D("address-book")},no_contacts_found:{message:V({defaultMessage:"No contacts found",id:"JhY7bAH15Y"}),icon:D("address-book")},selecting_contacts:{message:V({defaultMessage:"Selecting contacts",id:"OQhQc1Jomc"}),icon:D("address-book")},getting_contact_details:{message:V({defaultMessage:"Getting contact details",id:"p391mWkGfv"}),icon:D("address-book")},scheduling:{message:V({defaultMessage:"Scheduling",id:"5lQx5rgTEW"}),icon:D("calendar-plus")},scheduled:{message:V({defaultMessage:"Scheduled Task",id:"Nrj/ZHmudC"}),icon:D("calendar-plus")},reading_events:{message:V({defaultMessage:"Getting event details",id:"0QgD+ftRet"}),icon:D("calendar-search")},reading_emails:{message:V({defaultMessage:"Reviewing emails",id:"f/yAuwo+Vl"}),icon:D("mail-search")},OPEN_TAB:{message:V({defaultMessage:"Open tabs",id:"KO2pxljl8b"}),icon:D("browser-plus")},RECENTLY_CLOSED_TAB:{message:V({defaultMessage:"Recently closed tabs",id:"GrcBtKIzPh"}),icon:D("browser-minus")},BROWSER_HISTORY:{message:V({defaultMessage:"Browser history",id:"DtBSny6kw5"}),icon:D("world-search")},MCP_TOOL:{message:V({defaultMessage:"Connecting to {appName}",id:"w+iLkzBJV0"}),icon:D("tools")},CONNECTOR_DIRECT_SEARCH:{message:V({defaultMessage:"Searching {connectorName}",id:"cwPgqHkrr9"}),icon:D("search")},CONNECTOR_DIRECT_SEARCH_RESULTS:{message:V({defaultMessage:"Found {fileCount, plural, one {# file} other {# files}}",id:"WyPaTrRfsM"}),icon:D("file-text")},searching_flights:{message:V({defaultMessage:"Searching flights",id:"9+i0zI94jg"}),icon:D("search")},reviewing_booking_options:{message:V({defaultMessage:"Reviewing options",id:"hEF13crkAK"}),icon:D("search")},looking_for_booking_options:{message:V({defaultMessage:"Looking for booking options",id:"KIKXHtHJvz"}),icon:D("search")},redirecting_to_booking:{message:V({defaultMessage:"Redirecting to booking site",id:"y/a1lYMfGW"}),icon:D("search")},setting_up_price_alert_automation:{message:V({defaultMessage:"Setting up PriceAlertAutomation",id:"+7IqVk27BT"}),icon:D("graph")},read_page:{message:V({defaultMessage:"Reading page",id:"eEZaxWqt5u"}),icon:D("file-text")},get_page_text:{message:V({defaultMessage:"Getting page text",id:"rZqPh2Mfgi"}),icon:D("file-text")},tabs_context:{message:V({defaultMessage:"Getting tab context",id:"kcCvqWgrPU"}),icon:D("file-text")},tabs_create:{message:V({defaultMessage:"Creating tab",id:"NprxDW5RAN"}),icon:D("browser-plus")},form_input:{message:V({defaultMessage:"Filling form",id:"+gn8Qfhxa/"}),icon:D("forms")},find:{message:V({defaultMessage:"Finding elements",id:"PicRTL+DUk"}),icon:D("search")},find_elements:{message:V({defaultMessage:"Finding elements",id:"PicRTL+DUk"}),icon:D("search")},search_web:{message:V({defaultMessage:"Searching",id:"IfE0if3ytt"}),icon:D("search")},creating_todo_list:{message:V({defaultMessage:"Creating to-do list",id:"ZOeanuIrvQ"}),icon:D("checklist")},updating_todo_list:{message:V({defaultMessage:"Updating to-do list",id:"bb/FiiKtsc"}),icon:D("checklist")},running_sub_tasks:{message:V({defaultMessage:"Running sub-tasks",id:"H8wmfkHGA3"}),icon:D("server-bolt")},left_click:{message:V({defaultMessage:"Clicking",id:"n43/KMHgLD"}),icon:D("click")},right_click:{message:V({defaultMessage:"Right clicking",id:"YAxezKzj4p"}),icon:D("click")},double_click:{message:V({defaultMessage:"Double clicking",id:"anyjKtRL4p"}),icon:D("click")},triple_click:{message:V({defaultMessage:"Triple clicking",id:"aqH53Ke8R4"}),icon:D("click")},left_click_drag:{message:V({defaultMessage:"Dragging",id:"A/Bht8akH/"}),icon:D("click")},type:{message:V({defaultMessage:"Typing",id:"N2bqd9kL1X"}),icon:D("keyboard")},screenshot:{message:V({defaultMessage:"Reading page",id:"eEZaxWqt5u"}),icon:D("file-text")},file_read:{message:V({defaultMessage:"Reading",id:"MOK/yKIpYX"}),icon:D("file-text")},file_write:{message:V({defaultMessage:"Editing",id:"pBQ5bdyqop"}),icon:D("file-text")},file_edit:{message:V({defaultMessage:"Editing",id:"pBQ5bdyqop"}),icon:D("file-text")}},dM={initial:{opacity:0,position:"absolute",width:"100%"},animate:{opacity:1,position:"relative",transition:{opacity:{duration:1.2}}},exit:{opacity:0,position:"absolute",width:"100%",transition:{opacity:{duration:1.2}}}},dhe=()=>{const{$t:e}=Q();return f.useMemo(()=>({success:e({defaultMessage:"Success",id:"xrKHS6mnOh"}),couldNotFinish:e({defaultMessage:"Could not finish",id:"Sz8oY2B0GK"}),allEmail:e({defaultMessage:"All Emails",id:"xe3SFk3aV+"}),allTabs:e({defaultMessage:"All tabs",id:"vYBCIf+wNz"}),failedClosedTabs:e({defaultMessage:"Could not close tabs",id:"hjoQ7gU34V"}),results:e({defaultMessage:"Results",id:"yaMHMBMsQ7"}),continue:e({defaultMessage:"Continue",id:"acrOozm08x"}),skip:e({defaultMessage:"Skip",id:"/4tOwTiCH6"}),foundInfo:e({defaultMessage:"Details retrieved",id:"YCMMMHEIKw"}),allTabGroups:e({defaultMessage:"All tab groups",id:"YL1jEopcqf"}),gmailNotAuthenticated:e({defaultMessage:"Gmail not connected",id:"Zj8MiXlulR"}),googleCalendarNotAuthenticated:e({defaultMessage:"Google Calendar not connected",id:"PH33AilmeW"}),matchesFound:t=>t===0?e({defaultMessage:"No matches found",id:"KeJh7yZCu8"}):e({defaultMessage:"{count, plural, one {One match found} other {# matches found}}",id:"ji6QO7fi7u"},{count:t}),emailsFound:t=>t===0?e({defaultMessage:"No emails found",id:"suW4stNi19"}):e({defaultMessage:"{count, plural, one {# email} other {# emails}}",id:"Rh0ulH+p+5"},{count:t}),eventsFound:t=>t===0?e({defaultMessage:"No events found",id:"GDgEmCHaVM"}):e({defaultMessage:"{count, plural, one {# event} other {# events}}",id:"HhJ8RP7qsx"},{count:t}),availableTimesFound:t=>t===0?e({defaultMessage:"No available times found",id:"2jnY2Ky2Nv"}):e({defaultMessage:"{count, plural, one {# available time} other {# available times}}",id:"5yH+BVFO1f"},{count:t}),selectedContacts:t=>e({defaultMessage:"Selected {count, plural, one {# contact} other {# contacts}}",id:"4kDAeuSFTs"},{count:t}),skippedContacts:e({defaultMessage:"Skipped selecting contacts",id:"IXqYGlHPpF"}),noAvailabilityFound:e({defaultMessage:"No availability",id:"x2vleFRn/L"}),waitingDuration:t=>e({defaultMessage:"Waiting {duration, plural, one {# second} other {# seconds}}",id:"dvQ9+vK8nv"},{duration:t}),navigatingToUrl:t=>e({defaultMessage:"Navigating to {url}",id:"bxHR4kdMT9"},{url:t}),navigatingBack:e({defaultMessage:"Navigating back",id:"zUX8pSOwju"}),navigatingForward:e({defaultMessage:"Navigating forward",id:"MDBs+Vj9xA"}),runningCommand:e({defaultMessage:"Running a command",id:"+B6q99cXCl"})}),[e])},fhe=["google_docs"],mhe={google_docs:"https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico"},mL=A.memo(function({connector:t}){const n=phe(t),[r,s]=f.useState(!1),[a,o]=f.useState(!1),i=f.useCallback(async()=>{s(!0);try{if(!n)return;const u=await MS({name:n,autoClose:!0,reason:"bcu-connector-auth"});u&&window.open(u,"_blank","width=600,height=700")}finally{s(!1)}},[n]),c=f.useCallback(async()=>{s(!0);try{if(!n)return;await ve.POST(`/rest/connectors/${n}/skip`,"connector-skip"),o(!0)}finally{s(!1)}},[n]);return!n||a?null:l.jsxs(Y,{className:"pb-sm mb-sm gap-md flex items-center justify-between",children:[l.jsxs("div",{className:"gap-sm flex items-center",children:[l.jsx(Y,{variant:"raised",className:"p-xs rounded-md border",children:l.jsx(to,{src:mhe[n],alt:"Google Docs",width:40,height:40})}),l.jsxs("div",{children:[l.jsx(B,{variant:"baseSemi",color:"super",children:l.jsx(be,{defaultMessage:"Connect Google Docs",id:"PPGjSqrYqi"})}),l.jsx(B,{variant:"small",children:l.jsx(be,{defaultMessage:"Allow access to read and edit your documents",id:"9oLd9k/Okq"})})]})]}),l.jsxs("div",{className:"gap-sm flex flex-col items-center",children:[l.jsx(at,{variant:"primary",size:"small",onClick:i,disabled:r,children:l.jsx(be,{defaultMessage:"Connect",id:"+vVZ/G11Zg"})}),l.jsx(at,{variant:"text",size:"small",onClick:c,disabled:r,children:l.jsx(be,{defaultMessage:"Don't ask again",id:"Kj5ZANg8hf"})})]})]})});mL.displayName="ConnectorAuthBanner";const phe=e=>hhe(e)?e:void 0,hhe=e=>fhe.includes(e);function ghe({scrollContainerRef:e,autoScroll:t=!1,children:n}){const[r,s]=f.useState(!1),[a,o]=f.useState(!1),i=f.useCallback(()=>{const c=e.current;if(!c)return;const u=Math.abs(c.scrollTop),d=Math.max(0,c.scrollHeight-c.clientHeight),m=d>0;t?(s(m&&u<d),o(m&&u>0)):(s(m&&u>0),o(m&&u<d))},[t,e]);return f.useEffect(()=>{i()},[i]),f.useEffect(()=>{const c=e.current;if(c)return c.addEventListener("scroll",i),()=>c.removeEventListener("scroll",i)},[i,e]),f.useEffect(()=>{i();const c=e.current;if(!c)return;const u=new MutationObserver(i);return u.observe(c,{childList:!0,subtree:!0,characterData:!0}),()=>u.disconnect()},[n,i,e]),f.useMemo(()=>({canScrollUp:r,canScrollDown:a}),[r,a])}const yhe=220,fM=24,mM=16,dm=A.memo(function({children:t,className:n,scrollContainerClassName:r,maxHeight:s=yhe,showTopGradient:a=!0,showBottomGradient:o=!0,autoScroll:i=!0,topGradientOffset:c=0}){const u=f.useRef(null),{canScrollUp:d,canScrollDown:m}=ghe({scrollContainerRef:u,autoScroll:i,children:t}),p=f.useMemo(()=>{if(c>0){const g=a&&d,y=o&&m;if(!g&&!y)return{};let b;if(g&&y){const x=c+fM,_=`calc(100% - ${mM}px)`;b=`linear-gradient(180deg, black 0, black ${c}px, transparent ${c}px, black ${x}px, black ${_}, transparent 100%)`}else if(g){const x=c+fM;b=`linear-gradient(180deg, black 0, black ${c}px, transparent ${c}px, black ${x}px, black 100%)`}else b=`linear-gradient(180deg, black 0, black calc(100% - ${mM}px), transparent 100%)`;return{maskImage:b}}return{}},[d,m,c,a,o]),h=f.useMemo(()=>{if(c>0)return"";const g=a&&d,y=o&&m;return g&&y?"mask-fade-v-6":g?"mask-fade-t-6":y?"mask-fade-b-4":""},[d,m,c,a,o]);return l.jsx(Y,{className:z("relative",n),children:l.jsx("div",{ref:u,className:z(i?"flex-col-reverse":"flex-col","scrollbar-subtle pb-sm relative flex overflow-y-auto pl-3 pr-1 [scrollbar-gutter:stable]",r,h),style:{maxHeight:s,...p},children:t})})});function tg(e){return JSON.stringify(e,null,2)}const xhe=({children:e,initial:t=!1,mode:n="wait",className:r,transition:s,supportZeroHeight:a=!0,...o})=>{const[i,{height:c}]=Ni(),u=ro(),d=a||c>0?c:"auto";return l.jsx(ze.div,{animate:{height:u?d:"auto"},className:r,transition:s,...o,children:l.jsx("div",{ref:i,children:l.jsx(Wt,{mode:n,initial:t,children:e})})})},rr=HN(.16,1,.3,1),bhe=({children:e,initial:t={opacity:0},animate:n={opacity:1},exit:r,transition:s,className:a,style:o,ref:i})=>l.jsx(ze.div,{initial:t,animate:n,exit:r??t,transition:s,ref:i,className:a,style:o,children:e}),ba=xhe,bs=bhe;var kn="-ms-",Wd="-moz-",tn="-webkit-",pL="comm",oy="rule",_E="decl",_he="@import",hL="@keyframes",vhe="@layer",gL=Math.abs,vE=String.fromCharCode,__=Object.assign;function Che(e,t){return ur(e,0)^45?(((t<<2^ur(e,0))<<2^ur(e,1))<<2^ur(e,2))<<2^ur(e,3):0}function yL(e){return e.trim()}function po(e,t){return(e=t.exec(e))?e[0]:e}function Rt(e,t,n){return e.replace(t,n)}function xh(e,t,n){return e.indexOf(t,n)}function ur(e,t){return e.charCodeAt(t)|0}function Wc(e,t,n){return e.slice(t,n)}function Ra(e){return e.length}function xL(e){return e.length}function Rd(e,t){return t.push(e),e}function whe(e,t){return e.map(t).join("")}function pM(e,t){return e.filter(function(n){return!po(n,t)})}var iy=1,Kc=1,bL=0,Bs=0,Qn=0,Ru="";function ly(e,t,n,r,s,a,o,i){return{value:e,root:t,parent:n,type:r,props:s,children:a,line:iy,column:Kc,length:o,return:"",siblings:i}}function Ko(e,t){return __(ly("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function tc(e){for(;e.root;)e=Ko(e.root,{children:[e]});Rd(e,e.siblings)}function She(){return Qn}function Ehe(){return Qn=Bs>0?ur(Ru,--Bs):0,Kc--,Qn===10&&(Kc=1,iy--),Qn}function ca(){return Qn=Bs<bL?ur(Ru,Bs++):0,Kc++,Qn===10&&(Kc=1,iy++),Qn}function sl(){return ur(Ru,Bs)}function bh(){return Bs}function cy(e,t){return Wc(Ru,e,t)}function v_(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function khe(e){return iy=Kc=1,bL=Ra(Ru=e),Bs=0,[]}function Mhe(e){return Ru="",e}function i1(e){return yL(cy(Bs-1,C_(e===91?e+2:e===40?e+1:e)))}function The(e){for(;(Qn=sl())&&Qn<33;)ca();return v_(e)>2||v_(Qn)>3?"":" "}function Ahe(e,t){for(;--t&&ca()&&!(Qn<48||Qn>102||Qn>57&&Qn<65||Qn>70&&Qn<97););return cy(e,bh()+(t<6&&sl()==32&&ca()==32))}function C_(e){for(;ca();)switch(Qn){case e:return Bs;case 34:case 39:e!==34&&e!==39&&C_(Qn);break;case 40:e===41&&C_(e);break;case 92:ca();break}return Bs}function Nhe(e,t){for(;ca()&&e+Qn!==57;)if(e+Qn===84&&sl()===47)break;return"/*"+cy(t,Bs-1)+"*"+vE(e===47?e:ca())}function Rhe(e){for(;!v_(sl());)ca();return cy(e,Bs)}function Dhe(e){return Mhe(_h("",null,null,null,[""],e=khe(e),0,[0],e))}function _h(e,t,n,r,s,a,o,i,c){for(var u=0,d=0,m=o,p=0,h=0,g=0,y=1,b=1,x=1,_=0,v="",C=s,w=a,S=r,E=v;b;)switch(g=_,_=ca()){case 40:if(g!=108&&ur(E,m-1)==58){xh(E+=Rt(i1(_),"&","&\f"),"&\f",gL(u?i[u-1]:0))!=-1&&(x=-1);break}case 34:case 39:case 91:E+=i1(_);break;case 9:case 10:case 13:case 32:E+=The(g);break;case 92:E+=Ahe(bh()-1,7);continue;case 47:switch(sl()){case 42:case 47:Rd(Ihe(Nhe(ca(),bh()),t,n,c),c);break;default:E+="/"}break;case 123*y:i[u++]=Ra(E)*x;case 125*y:case 59:case 0:switch(_){case 0:case 125:b=0;case 59+d:x==-1&&(E=Rt(E,/\f/g,"")),h>0&&Ra(E)-m&&Rd(h>32?gM(E+";",r,n,m-1,c):gM(Rt(E," ","")+";",r,n,m-2,c),c);break;case 59:E+=";";default:if(Rd(S=hM(E,t,n,u,d,s,i,v,C=[],w=[],m,a),a),_===123)if(d===0)_h(E,t,S,S,C,a,m,i,w);else switch(p===99&&ur(E,3)===110?100:p){case 100:case 108:case 109:case 115:_h(e,S,S,r&&Rd(hM(e,S,S,0,0,s,i,v,s,C=[],m,w),w),s,w,m,i,r?C:w);break;default:_h(E,S,S,S,[""],w,0,i,w)}}u=d=h=0,y=x=1,v=E="",m=o;break;case 58:m=1+Ra(E),h=g;default:if(y<1){if(_==123)--y;else if(_==125&&y++==0&&Ehe()==125)continue}switch(E+=vE(_),_*y){case 38:x=d>0?1:(E+="\f",-1);break;case 44:i[u++]=(Ra(E)-1)*x,x=1;break;case 64:sl()===45&&(E+=i1(ca())),p=sl(),d=m=Ra(v=E+=Rhe(bh())),_++;break;case 45:g===45&&Ra(E)==2&&(y=0)}}return a}function hM(e,t,n,r,s,a,o,i,c,u,d,m){for(var p=s-1,h=s===0?a:[""],g=xL(h),y=0,b=0,x=0;y<r;++y)for(var _=0,v=Wc(e,p+1,p=gL(b=o[y])),C=e;_<g;++_)(C=yL(b>0?h[_]+" "+v:Rt(v,/&\f/g,h[_])))&&(c[x++]=C);return ly(e,t,n,s===0?oy:i,c,u,d,m)}function Ihe(e,t,n,r){return ly(e,t,n,pL,vE(She()),Wc(e,2,-2),0,r)}function gM(e,t,n,r,s){return ly(e,t,n,_E,Wc(e,0,r),Wc(e,r+1,-1),r,s)}function _L(e,t,n){switch(Che(e,t)){case 5103:return tn+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return tn+e+e;case 4789:return Wd+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return tn+e+Wd+e+kn+e+e;case 5936:switch(ur(e,t+11)){case 114:return tn+e+kn+Rt(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return tn+e+kn+Rt(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return tn+e+kn+Rt(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return tn+e+kn+e+e;case 6165:return tn+e+kn+"flex-"+e+e;case 5187:return tn+e+Rt(e,/(\w+).+(:[^]+)/,tn+"box-$1$2"+kn+"flex-$1$2")+e;case 5443:return tn+e+kn+"flex-item-"+Rt(e,/flex-|-self/g,"")+(po(e,/flex-|baseline/)?"":kn+"grid-row-"+Rt(e,/flex-|-self/g,""))+e;case 4675:return tn+e+kn+"flex-line-pack"+Rt(e,/align-content|flex-|-self/g,"")+e;case 5548:return tn+e+kn+Rt(e,"shrink","negative")+e;case 5292:return tn+e+kn+Rt(e,"basis","preferred-size")+e;case 6060:return tn+"box-"+Rt(e,"-grow","")+tn+e+kn+Rt(e,"grow","positive")+e;case 4554:return tn+Rt(e,/([^-])(transform)/g,"$1"+tn+"$2")+e;case 6187:return Rt(Rt(Rt(e,/(zoom-|grab)/,tn+"$1"),/(image-set)/,tn+"$1"),e,"")+e;case 5495:case 3959:return Rt(e,/(image-set\([^]*)/,tn+"$1$`$1");case 4968:return Rt(Rt(e,/(.+:)(flex-)?(.*)/,tn+"box-pack:$3"+kn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+tn+e+e;case 4200:if(!po(e,/flex-|baseline/))return kn+"grid-column-align"+Wc(e,t)+e;break;case 2592:case 3360:return kn+Rt(e,"template-","")+e;case 4384:case 3616:return n&&n.some(function(r,s){return t=s,po(r.props,/grid-\w+-end/)})?~xh(e+(n=n[t].value),"span",0)?e:kn+Rt(e,"-start","")+e+kn+"grid-row-span:"+(~xh(n,"span",0)?po(n,/\d+/):+po(n,/\d+/)-+po(e,/\d+/))+";":kn+Rt(e,"-start","")+e;case 4896:case 4128:return n&&n.some(function(r){return po(r.props,/grid-\w+-start/)})?e:kn+Rt(Rt(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return Rt(e,/(.+)-inline(.+)/,tn+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ra(e)-1-t>6)switch(ur(e,t+1)){case 109:if(ur(e,t+4)!==45)break;case 102:return Rt(e,/(.+:)(.+)-([^]+)/,"$1"+tn+"$2-$3$1"+Wd+(ur(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~xh(e,"stretch",0)?_L(Rt(e,"stretch","fill-available"),t,n)+e:e}break;case 5152:case 5920:return Rt(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(r,s,a,o,i,c,u){return kn+s+":"+a+u+(o?kn+s+"-span:"+(i?c:+c-+a)+u:"")+e});case 4949:if(ur(e,t+6)===121)return Rt(e,":",":"+tn)+e;break;case 6444:switch(ur(e,ur(e,14)===45?18:11)){case 120:return Rt(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+tn+(ur(e,14)===45?"inline-":"")+"box$3$1"+tn+"$2$3$1"+kn+"$2box$3")+e;case 100:return Rt(e,":",":"+kn)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Rt(e,"scroll-","scroll-snap-")+e}return e}function ng(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function jhe(e,t,n,r){switch(e.type){case vhe:if(e.children.length)break;case _he:case _E:return e.return=e.return||e.value;case pL:return"";case hL:return e.return=e.value+"{"+ng(e.children,r)+"}";case oy:if(!Ra(e.value=e.props.join(",")))return""}return Ra(n=ng(e.children,r))?e.return=e.value+"{"+n+"}":""}function Phe(e){var t=xL(e);return function(n,r,s,a){for(var o="",i=0;i<t;i++)o+=e[i](n,r,s,a)||"";return o}}function Ohe(e){return function(t){t.root||(t=t.return)&&e(t)}}function Lhe(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case _E:e.return=_L(e.value,e.length,n);return;case hL:return ng([Ko(e,{value:Rt(e.value,"@","@"+tn)})],r);case oy:if(e.length)return whe(n=e.props,function(s){switch(po(s,r=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":tc(Ko(e,{props:[Rt(s,/:(read-\w+)/,":"+Wd+"$1")]})),tc(Ko(e,{props:[s]})),__(e,{props:pM(n,r)});break;case"::placeholder":tc(Ko(e,{props:[Rt(s,/:(plac\w+)/,":"+tn+"input-$1")]})),tc(Ko(e,{props:[Rt(s,/:(plac\w+)/,":"+Wd+"$1")]})),tc(Ko(e,{props:[Rt(s,/:(plac\w+)/,kn+"input-$1")]})),tc(Ko(e,{props:[s]})),__(e,{props:pM(n,r)});break}return""})}}var Fhe={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},ls={},Yc=typeof process<"u"&&ls!==void 0&&(ls.REACT_APP_SC_ATTR||ls.SC_ATTR)||"data-styled",vL="active",CL="data-styled-version",uy="6.1.15",CE=`/*!sc*/
`,rg=typeof window<"u"&&"HTMLElement"in window,Uhe=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&ls!==void 0&&ls.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&ls.REACT_APP_SC_DISABLE_SPEEDY!==""?ls.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&ls.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&ls!==void 0&&ls.SC_DISABLE_SPEEDY!==void 0&&ls.SC_DISABLE_SPEEDY!==""&&ls.SC_DISABLE_SPEEDY!=="false"&&ls.SC_DISABLE_SPEEDY),dy=Object.freeze([]),Qc=Object.freeze({});function wL(e,t,n){return n===void 0&&(n=Qc),e.theme!==n.theme&&e.theme||t||n.theme}var SL=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),Bhe=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,Hhe=/(^-|-$)/g;function yM(e){return e.replace(Bhe,"-").replace(Hhe,"")}var Vhe=/(a)(d)/gi,mp=52,xM=function(e){return String.fromCharCode(e+(e>25?39:97))};function w_(e){var t,n="";for(t=Math.abs(e);t>mp;t=t/mp|0)n=xM(t%mp)+n;return(xM(t%mp)+n).replace(Vhe,"$1-$2")}var l1,EL=5381,bc=function(e,t){for(var n=t.length;n;)e=33*e^t.charCodeAt(--n);return e},kL=function(e){return bc(EL,e)};function Ghe(e){return w_(kL(e)>>>0)}function ML(e){return e.displayName||e.name||"Component"}function c1(e){return typeof e=="string"&&!0}var TL=typeof Symbol=="function"&&Symbol.for,AL=TL?Symbol.for("react.memo"):60115,zhe=TL?Symbol.for("react.forward_ref"):60112,qhe={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},$he={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},NL={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Whe=((l1={})[zhe]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},l1[AL]=NL,l1);function bM(e){return("type"in(t=e)&&t.type.$$typeof)===AL?NL:"$$typeof"in e?Whe[e.$$typeof]:qhe;var t}var Khe=Object.defineProperty,Yhe=Object.getOwnPropertyNames,_M=Object.getOwnPropertySymbols,Qhe=Object.getOwnPropertyDescriptor,Xhe=Object.getPrototypeOf,vM=Object.prototype;function wE(e,t,n){if(typeof t!="string"){if(vM){var r=Xhe(t);r&&r!==vM&&wE(e,r,n)}var s=Yhe(t);_M&&(s=s.concat(_M(t)));for(var a=bM(e),o=bM(t),i=0;i<s.length;++i){var c=s[i];if(!(c in $he||n&&n[c]||o&&c in o||a&&c in a)){var u=Qhe(t,c);try{Khe(e,c,u)}catch{}}}}return e}function Xc(e){return typeof e=="function"}function SE(e){return typeof e=="object"&&"styledComponentId"in e}function Ji(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function CM(e,t){if(e.length===0)return"";for(var n=e[0],r=1;r<e.length;r++)n+=e[r];return n}function _f(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function S_(e,t,n){if(n===void 0&&(n=!1),!n&&!_f(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var r=0;r<t.length;r++)e[r]=S_(e[r],t[r]);else if(_f(t))for(var r in t)e[r]=S_(e[r],t[r]);return e}function EE(e,t){Object.defineProperty(e,"toString",{value:t})}function fm(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var Zhe=(function(){function e(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return e.prototype.indexOfGroup=function(t){for(var n=0,r=0;r<t;r++)n+=this.groupSizes[r];return n},e.prototype.insertRules=function(t,n){if(t>=this.groupSizes.length){for(var r=this.groupSizes,s=r.length,a=s;t>=a;)if((a<<=1)<0)throw fm(16,"".concat(t));this.groupSizes=new Uint32Array(a),this.groupSizes.set(r),this.length=a;for(var o=s;o<a;o++)this.groupSizes[o]=0}for(var i=this.indexOfGroup(t+1),c=(o=0,n.length);o<c;o++)this.tag.insertRule(i,n[o])&&(this.groupSizes[t]++,i++)},e.prototype.clearGroup=function(t){if(t<this.length){var n=this.groupSizes[t],r=this.indexOfGroup(t),s=r+n;this.groupSizes[t]=0;for(var a=r;a<s;a++)this.tag.deleteRule(r)}},e.prototype.getGroup=function(t){var n="";if(t>=this.length||this.groupSizes[t]===0)return n;for(var r=this.groupSizes[t],s=this.indexOfGroup(t),a=s+r,o=s;o<a;o++)n+="".concat(this.tag.getRule(o)).concat(CE);return n},e})(),vh=new Map,sg=new Map,Ch=1,pp=function(e){if(vh.has(e))return vh.get(e);for(;sg.has(Ch);)Ch++;var t=Ch++;return vh.set(e,t),sg.set(t,e),t},Jhe=function(e,t){Ch=t+1,vh.set(e,t),sg.set(t,e)},ege="style[".concat(Yc,"][").concat(CL,'="').concat(uy,'"]'),tge=new RegExp("^".concat(Yc,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),nge=function(e,t,n){for(var r,s=n.split(","),a=0,o=s.length;a<o;a++)(r=s[a])&&e.registerName(t,r)},rge=function(e,t){for(var n,r=((n=t.textContent)!==null&&n!==void 0?n:"").split(CE),s=[],a=0,o=r.length;a<o;a++){var i=r[a].trim();if(i){var c=i.match(tge);if(c){var u=0|parseInt(c[1],10),d=c[2];u!==0&&(Jhe(d,u),nge(e,d,c[3]),e.getTag().insertRules(u,s)),s.length=0}else s.push(i)}}},wM=function(e){for(var t=document.querySelectorAll(ege),n=0,r=t.length;n<r;n++){var s=t[n];s&&s.getAttribute(Yc)!==vL&&(rge(e,s),s.parentNode&&s.parentNode.removeChild(s))}};function sge(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var RL=function(e){var t=document.head,n=e||t,r=document.createElement("style"),s=(function(i){var c=Array.from(i.querySelectorAll("style[".concat(Yc,"]")));return c[c.length-1]})(n),a=s!==void 0?s.nextSibling:null;r.setAttribute(Yc,vL),r.setAttribute(CL,uy);var o=sge();return o&&r.setAttribute("nonce",o),n.insertBefore(r,a),r},age=(function(){function e(t){this.element=RL(t),this.element.appendChild(document.createTextNode("")),this.sheet=(function(n){if(n.sheet)return n.sheet;for(var r=document.styleSheets,s=0,a=r.length;s<a;s++){var o=r[s];if(o.ownerNode===n)return o}throw fm(17)})(this.element),this.length=0}return e.prototype.insertRule=function(t,n){try{return this.sheet.insertRule(n,t),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.prototype.getRule=function(t){var n=this.sheet.cssRules[t];return n&&n.cssText?n.cssText:""},e})(),oge=(function(){function e(t){this.element=RL(t),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(t,n){if(t<=this.length&&t>=0){var r=document.createTextNode(n);return this.element.insertBefore(r,this.nodes[t]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},e})(),ige=(function(){function e(t){this.rules=[],this.length=0}return e.prototype.insertRule=function(t,n){return t<=this.length&&(this.rules.splice(t,0,n),this.length++,!0)},e.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},e})(),SM=rg,lge={isServer:!rg,useCSSOMInjection:!Uhe},DL=(function(){function e(t,n,r){t===void 0&&(t=Qc),n===void 0&&(n={});var s=this;this.options=fs(fs({},lge),t),this.gs=n,this.names=new Map(r),this.server=!!t.isServer,!this.server&&rg&&SM&&(SM=!1,wM(this)),EE(this,function(){return(function(a){for(var o=a.getTag(),i=o.length,c="",u=function(m){var p=(function(x){return sg.get(x)})(m);if(p===void 0)return"continue";var h=a.names.get(p),g=o.getGroup(m);if(h===void 0||!h.size||g.length===0)return"continue";var y="".concat(Yc,".g").concat(m,'[id="').concat(p,'"]'),b="";h!==void 0&&h.forEach(function(x){x.length>0&&(b+="".concat(x,","))}),c+="".concat(g).concat(y,'{content:"').concat(b,'"}').concat(CE)},d=0;d<i;d++)u(d);return c})(s)})}return e.registerId=function(t){return pp(t)},e.prototype.rehydrate=function(){!this.server&&rg&&wM(this)},e.prototype.reconstructWithOptions=function(t,n){return n===void 0&&(n=!0),new e(fs(fs({},this.options),t),this.gs,n&&this.names||void 0)},e.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(t=(function(n){var r=n.useCSSOMInjection,s=n.target;return n.isServer?new ige(s):r?new age(s):new oge(s)})(this.options),new Zhe(t)));var t},e.prototype.hasNameForId=function(t,n){return this.names.has(t)&&this.names.get(t).has(n)},e.prototype.registerName=function(t,n){if(pp(t),this.names.has(t))this.names.get(t).add(n);else{var r=new Set;r.add(n),this.names.set(t,r)}},e.prototype.insertRules=function(t,n,r){this.registerName(t,n),this.getTag().insertRules(pp(t),r)},e.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.prototype.clearRules=function(t){this.getTag().clearGroup(pp(t)),this.clearNames(t)},e.prototype.clearTag=function(){this.tag=void 0},e})(),cge=/&/g,uge=/^\s*\/\/.*$/gm;function IL(e,t){return e.map(function(n){return n.type==="rule"&&(n.value="".concat(t," ").concat(n.value),n.value=n.value.replaceAll(",",",".concat(t," ")),n.props=n.props.map(function(r){return"".concat(t," ").concat(r)})),Array.isArray(n.children)&&n.type!=="@keyframes"&&(n.children=IL(n.children,t)),n})}function dge(e){var t,n,r,s=Qc,a=s.options,o=a===void 0?Qc:a,i=s.plugins,c=i===void 0?dy:i,u=function(p,h,g){return g.startsWith(n)&&g.endsWith(n)&&g.replaceAll(n,"").length>0?".".concat(t):p},d=c.slice();d.push(function(p){p.type===oy&&p.value.includes("&")&&(p.props[0]=p.props[0].replace(cge,n).replace(r,u))}),o.prefix&&d.push(Lhe),d.push(jhe);var m=function(p,h,g,y){h===void 0&&(h=""),g===void 0&&(g=""),y===void 0&&(y="&"),t=y,n=h,r=new RegExp("\\".concat(n,"\\b"),"g");var b=p.replace(uge,""),x=Dhe(g||h?"".concat(g," ").concat(h," { ").concat(b," }"):b);o.namespace&&(x=IL(x,o.namespace));var _=[];return ng(x,Phe(d.concat(Ohe(function(v){return _.push(v)})))),_};return m.hash=c.length?c.reduce(function(p,h){return h.name||fm(15),bc(p,h.name)},EL).toString():"",m}var fge=new DL,E_=dge(),jL=A.createContext({shouldForwardProp:void 0,styleSheet:fge,stylis:E_});jL.Consumer;A.createContext(void 0);function EM(){return f.useContext(jL)}var mge=(function(){function e(t,n){var r=this;this.inject=function(s,a){a===void 0&&(a=E_);var o=r.name+a.hash;s.hasNameForId(r.id,o)||s.insertRules(r.id,o,a(r.rules,o,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=n,EE(this,function(){throw fm(12,String(r.name))})}return e.prototype.getName=function(t){return t===void 0&&(t=E_),this.name+t.hash},e})(),pge=function(e){return e>="A"&&e<="Z"};function kM(e){for(var t="",n=0;n<e.length;n++){var r=e[n];if(n===1&&r==="-"&&e[0]==="-")return e;pge(r)?t+="-"+r.toLowerCase():t+=r}return t.startsWith("ms-")?"-"+t:t}var PL=function(e){return e==null||e===!1||e===""},OL=function(e){var t,n,r=[];for(var s in e){var a=e[s];e.hasOwnProperty(s)&&!PL(a)&&(Array.isArray(a)&&a.isCss||Xc(a)?r.push("".concat(kM(s),":"),a,";"):_f(a)?r.push.apply(r,jh(jh(["".concat(s," {")],OL(a),!1),["}"],!1)):r.push("".concat(kM(s),": ").concat((t=s,(n=a)==null||typeof n=="boolean"||n===""?"":typeof n!="number"||n===0||t in Fhe||t.startsWith("--")?String(n).trim():"".concat(n,"px")),";")))}return r};function al(e,t,n,r){if(PL(e))return[];if(SE(e))return[".".concat(e.styledComponentId)];if(Xc(e)){if(!Xc(a=e)||a.prototype&&a.prototype.isReactComponent||!t)return[e];var s=e(t);return al(s,t,n,r)}var a;return e instanceof mge?n?(e.inject(n,r),[e.getName(r)]):[e]:_f(e)?OL(e):Array.isArray(e)?Array.prototype.concat.apply(dy,e.map(function(o){return al(o,t,n,r)})):[e.toString()]}function hge(e){for(var t=0;t<e.length;t+=1){var n=e[t];if(Xc(n)&&!SE(n))return!1}return!0}var gge=kL(uy),yge=(function(){function e(t,n,r){this.rules=t,this.staticRulesId="",this.isStatic=(r===void 0||r.isStatic)&&hge(t),this.componentId=n,this.baseHash=bc(gge,n),this.baseStyle=r,DL.registerId(n)}return e.prototype.generateAndInjectStyles=function(t,n,r){var s=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,n,r):"";if(this.isStatic&&!r.hash)if(this.staticRulesId&&n.hasNameForId(this.componentId,this.staticRulesId))s=Ji(s,this.staticRulesId);else{var a=CM(al(this.rules,t,n,r)),o=w_(bc(this.baseHash,a)>>>0);if(!n.hasNameForId(this.componentId,o)){var i=r(a,".".concat(o),void 0,this.componentId);n.insertRules(this.componentId,o,i)}s=Ji(s,o),this.staticRulesId=o}else{for(var c=bc(this.baseHash,r.hash),u="",d=0;d<this.rules.length;d++){var m=this.rules[d];if(typeof m=="string")u+=m;else if(m){var p=CM(al(m,t,n,r));c=bc(c,p+d),u+=p}}if(u){var h=w_(c>>>0);n.hasNameForId(this.componentId,h)||n.insertRules(this.componentId,h,r(u,".".concat(h),void 0,this.componentId)),s=Ji(s,h)}}return s},e})(),kE=A.createContext(void 0);kE.Consumer;var u1={};function xge(e,t,n){var r=SE(e),s=e,a=!c1(e),o=t.attrs,i=o===void 0?dy:o,c=t.componentId,u=c===void 0?(function(C,w){var S=typeof C!="string"?"sc":yM(C);u1[S]=(u1[S]||0)+1;var E="".concat(S,"-").concat(Ghe(uy+S+u1[S]));return w?"".concat(w,"-").concat(E):E})(t.displayName,t.parentComponentId):c,d=t.displayName,m=d===void 0?(function(C){return c1(C)?"styled.".concat(C):"Styled(".concat(ML(C),")")})(e):d,p=t.displayName&&t.componentId?"".concat(yM(t.displayName),"-").concat(t.componentId):t.componentId||u,h=r&&s.attrs?s.attrs.concat(i).filter(Boolean):i,g=t.shouldForwardProp;if(r&&s.shouldForwardProp){var y=s.shouldForwardProp;if(t.shouldForwardProp){var b=t.shouldForwardProp;g=function(C,w){return y(C,w)&&b(C,w)}}else g=y}var x=new yge(n,p,r?s.componentStyle:void 0);function _(C,w){return(function(S,E,T){var k=S.attrs,M=S.componentStyle,N=S.defaultProps,P=S.foldedComponentIds,O=S.styledComponentId,L=S.target,H=A.useContext(kE),R=EM(),I=S.shouldForwardProp||R.shouldForwardProp,F=wL(E,H,N)||Qc,G=(function(J,ne,ae){for(var de,oe=fs(fs({},ne),{className:void 0,theme:ae}),le=0;le<J.length;le+=1){var se=Xc(de=J[le])?de(oe):de;for(var re in se)oe[re]=re==="className"?Ji(oe[re],se[re]):re==="style"?fs(fs({},oe[re]),se[re]):se[re]}return ne.className&&(oe.className=Ji(oe.className,ne.className)),oe})(k,E,F),j=G.as||L,$={};for(var q in G)G[q]===void 0||q[0]==="$"||q==="as"||q==="theme"&&G.theme===F||(q==="forwardedAs"?$.as=G.forwardedAs:I&&!I(q,j)||($[q]=G[q]));var U=(function(J,ne){var ae=EM(),de=J.generateAndInjectStyles(ne,ae.styleSheet,ae.stylis);return de})(M,G),X=Ji(P,O);return U&&(X+=" "+U),G.className&&(X+=" "+G.className),$[c1(j)&&!SL.has(j)?"class":"className"]=X,T&&($.ref=T),f.createElement(j,$)})(v,C,w)}_.displayName=m;var v=A.forwardRef(_);return v.attrs=h,v.componentStyle=x,v.displayName=m,v.shouldForwardProp=g,v.foldedComponentIds=r?Ji(s.foldedComponentIds,s.styledComponentId):"",v.styledComponentId=p,v.target=r?s.target:e,Object.defineProperty(v,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(C){this._foldedDefaultProps=r?(function(w){for(var S=[],E=1;E<arguments.length;E++)S[E-1]=arguments[E];for(var T=0,k=S;T<k.length;T++)S_(w,k[T],!0);return w})({},s.defaultProps,C):C}}),EE(v,function(){return".".concat(v.styledComponentId)}),a&&wE(v,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),v}function MM(e,t){for(var n=[e[0]],r=0,s=t.length;r<s;r+=1)n.push(t[r],e[r+1]);return n}var TM=function(e){return Object.assign(e,{isCss:!0})};function bge(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Xc(e)||_f(e))return TM(al(MM(dy,jh([e],t,!0))));var r=e;return t.length===0&&r.length===1&&typeof r[0]=="string"?al(r):TM(al(MM(r,t)))}function k_(e,t,n){if(n===void 0&&(n=Qc),!t)throw fm(1,t);var r=function(s){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];return e(t,n,bge.apply(void 0,jh([s],a,!1)))};return r.attrs=function(s){return k_(e,t,fs(fs({},n),{attrs:Array.prototype.concat(n.attrs,s).filter(Boolean)}))},r.withConfig=function(s){return k_(e,t,fs(fs({},n),s))},r}var LL=function(e){return k_(xge,e)},fy=LL;SL.forEach(function(e){fy[e]=LL(e)});function _ge(e){var t=A.forwardRef(function(n,r){var s=wL(n,A.useContext(kE),e.defaultProps);return A.createElement(e,fs({},n,{theme:s,ref:r}))});return t.displayName="WithTheme(".concat(ML(e),")"),wE(t,e)}function FL(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function vge(e,t){if(e==null)return{};var n,r,s=FL(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function M_(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Cge(e){if(Array.isArray(e))return M_(e)}function wge(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Sge(e,t){if(e){if(typeof e=="string")return M_(e,t);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M_(e,t):void 0}}function Ege(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T_(e){return Cge(e)||wge(e)||Sge(e)||Ege()}function $a(e){"@babel/helpers - typeof";return $a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$a(e)}function kge(e,t){if($a(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if($a(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UL(e){var t=kge(e,"string");return $a(t)=="symbol"?t:t+""}function ho(e,t,n){return(t=UL(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vf(){return vf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vf.apply(null,arguments)}function AM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function _c(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?AM(Object(n),!0).forEach(function(r){ho(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Mge(e){var t=e.length;if(t===0||t===1)return e;if(t===2)return[e[0],e[1],"".concat(e[0],".").concat(e[1]),"".concat(e[1],".").concat(e[0])];if(t===3)return[e[0],e[1],e[2],"".concat(e[0],".").concat(e[1]),"".concat(e[0],".").concat(e[2]),"".concat(e[1],".").concat(e[0]),"".concat(e[1],".").concat(e[2]),"".concat(e[2],".").concat(e[0]),"".concat(e[2],".").concat(e[1]),"".concat(e[0],".").concat(e[1],".").concat(e[2]),"".concat(e[0],".").concat(e[2],".").concat(e[1]),"".concat(e[1],".").concat(e[0],".").concat(e[2]),"".concat(e[1],".").concat(e[2],".").concat(e[0]),"".concat(e[2],".").concat(e[0],".").concat(e[1]),"".concat(e[2],".").concat(e[1],".").concat(e[0])];if(t>=4)return[e[0],e[1],e[2],e[3],"".concat(e[0],".").concat(e[1]),"".concat(e[0],".").concat(e[2]),"".concat(e[0],".").concat(e[3]),"".concat(e[1],".").concat(e[0]),"".concat(e[1],".").concat(e[2]),"".concat(e[1],".").concat(e[3]),"".concat(e[2],".").concat(e[0]),"".concat(e[2],".").concat(e[1]),"".concat(e[2],".").concat(e[3]),"".concat(e[3],".").concat(e[0]),"".concat(e[3],".").concat(e[1]),"".concat(e[3],".").concat(e[2]),"".concat(e[0],".").concat(e[1],".").concat(e[2]),"".concat(e[0],".").concat(e[1],".").concat(e[3]),"".concat(e[0],".").concat(e[2],".").concat(e[1]),"".concat(e[0],".").concat(e[2],".").concat(e[3]),"".concat(e[0],".").concat(e[3],".").concat(e[1]),"".concat(e[0],".").concat(e[3],".").concat(e[2]),"".concat(e[1],".").concat(e[0],".").concat(e[2]),"".concat(e[1],".").concat(e[0],".").concat(e[3]),"".concat(e[1],".").concat(e[2],".").concat(e[0]),"".concat(e[1],".").concat(e[2],".").concat(e[3]),"".concat(e[1],".").concat(e[3],".").concat(e[0]),"".concat(e[1],".").concat(e[3],".").concat(e[2]),"".concat(e[2],".").concat(e[0],".").concat(e[1]),"".concat(e[2],".").concat(e[0],".").concat(e[3]),"".concat(e[2],".").concat(e[1],".").concat(e[0]),"".concat(e[2],".").concat(e[1],".").concat(e[3]),"".concat(e[2],".").concat(e[3],".").concat(e[0]),"".concat(e[2],".").concat(e[3],".").concat(e[1]),"".concat(e[3],".").concat(e[0],".").concat(e[1]),"".concat(e[3],".").concat(e[0],".").concat(e[2]),"".concat(e[3],".").concat(e[1],".").concat(e[0]),"".concat(e[3],".").concat(e[1],".").concat(e[2]),"".concat(e[3],".").concat(e[2],".").concat(e[0]),"".concat(e[3],".").concat(e[2],".").concat(e[1]),"".concat(e[0],".").concat(e[1],".").concat(e[2],".").concat(e[3]),"".concat(e[0],".").concat(e[1],".").concat(e[3],".").concat(e[2]),"".concat(e[0],".").concat(e[2],".").concat(e[1],".").concat(e[3]),"".concat(e[0],".").concat(e[2],".").concat(e[3],".").concat(e[1]),"".concat(e[0],".").concat(e[3],".").concat(e[1],".").concat(e[2]),"".concat(e[0],".").concat(e[3],".").concat(e[2],".").concat(e[1]),"".concat(e[1],".").concat(e[0],".").concat(e[2],".").concat(e[3]),"".concat(e[1],".").concat(e[0],".").concat(e[3],".").concat(e[2]),"".concat(e[1],".").concat(e[2],".").concat(e[0],".").concat(e[3]),"".concat(e[1],".").concat(e[2],".").concat(e[3],".").concat(e[0]),"".concat(e[1],".").concat(e[3],".").concat(e[0],".").concat(e[2]),"".concat(e[1],".").concat(e[3],".").concat(e[2],".").concat(e[0]),"".concat(e[2],".").concat(e[0],".").concat(e[1],".").concat(e[3]),"".concat(e[2],".").concat(e[0],".").concat(e[3],".").concat(e[1]),"".concat(e[2],".").concat(e[1],".").concat(e[0],".").concat(e[3]),"".concat(e[2],".").concat(e[1],".").concat(e[3],".").concat(e[0]),"".concat(e[2],".").concat(e[3],".").concat(e[0],".").concat(e[1]),"".concat(e[2],".").concat(e[3],".").concat(e[1],".").concat(e[0]),"".concat(e[3],".").concat(e[0],".").concat(e[1],".").concat(e[2]),"".concat(e[3],".").concat(e[0],".").concat(e[2],".").concat(e[1]),"".concat(e[3],".").concat(e[1],".").concat(e[0],".").concat(e[2]),"".concat(e[3],".").concat(e[1],".").concat(e[2],".").concat(e[0]),"".concat(e[3],".").concat(e[2],".").concat(e[0],".").concat(e[1]),"".concat(e[3],".").concat(e[2],".").concat(e[1],".").concat(e[0])]}var d1={};function Tge(e){if(e.length===0||e.length===1)return e;var t=e.join(".");return d1[t]||(d1[t]=Mge(e)),d1[t]}function Age(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=e.filter(function(a){return a!=="token"}),s=Tge(r);return s.reduce(function(a,o){return _c(_c({},a),n[o])},t)}function NM(e){return e.join(" ")}function Nge(e,t){var n=0;return function(r){return n+=1,r.map(function(s,a){return BL({node:s,stylesheet:e,useInlineStyles:t,key:"code-segment-".concat(n,"-").concat(a)})})}}function BL(e){var t=e.node,n=e.stylesheet,r=e.style,s=r===void 0?{}:r,a=e.useInlineStyles,o=e.key,i=t.properties,c=t.type,u=t.tagName,d=t.value;if(c==="text")return d;if(u){var m=Nge(n,a),p;if(!a)p=_c(_c({},i),{},{className:NM(i.className)});else{var h=Object.keys(n).reduce(function(x,_){return _.split(".").forEach(function(v){x.includes(v)||x.push(v)}),x},[]),g=i.className&&i.className.includes("token")?["token"]:[],y=i.className&&g.concat(i.className.filter(function(x){return!h.includes(x)}));p=_c(_c({},i),{},{className:NM(y)||void 0,style:Age(i.className,Object.assign({},i.style,s),n)})}var b=m(t.children);return A.createElement(u,vf({key:o},p),b)}}const Rge=(function(e,t){var n=e.listLanguages();return n.indexOf(t)!==-1});var Dge=["language","children","style","customStyle","codeTagProps","useInlineStyles","showLineNumbers","showInlineLineNumbers","startingLineNumber","lineNumberContainerStyle","lineNumberStyle","wrapLines","wrapLongLines","lineProps","renderer","PreTag","CodeTag","code","astGenerator"];function RM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function ti(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?RM(Object(n),!0).forEach(function(r){ho(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Ige=/\n/g;function jge(e){return e.match(Ige)}function Pge(e){var t=e.lines,n=e.startingLineNumber,r=e.style;return t.map(function(s,a){var o=a+n;return A.createElement("span",{key:"line-".concat(a),className:"react-syntax-highlighter-line-number",style:typeof r=="function"?r(o):r},"".concat(o,`
`))})}function Oge(e){var t=e.codeString,n=e.codeStyle,r=e.containerStyle,s=r===void 0?{float:"left",paddingRight:"10px"}:r,a=e.numberStyle,o=a===void 0?{}:a,i=e.startingLineNumber;return A.createElement("code",{style:Object.assign({},n,s)},Pge({lines:t.replace(/\n$/,"").split(`
`),style:o,startingLineNumber:i}))}function Lge(e){return"".concat(e.toString().length,".25em")}function HL(e,t){return{type:"element",tagName:"span",properties:{key:"line-number--".concat(e),className:["comment","linenumber","react-syntax-highlighter-line-number"],style:t},children:[{type:"text",value:e}]}}function VL(e,t,n){var r={display:"inline-block",minWidth:Lge(n),paddingRight:"1em",textAlign:"right",userSelect:"none"},s=typeof e=="function"?e(t):e,a=ti(ti({},r),s);return a}function wh(e){var t=e.children,n=e.lineNumber,r=e.lineNumberStyle,s=e.largestLineNumber,a=e.showInlineLineNumbers,o=e.lineProps,i=o===void 0?{}:o,c=e.className,u=c===void 0?[]:c,d=e.showLineNumbers,m=e.wrapLongLines,p=e.wrapLines,h=p===void 0?!1:p,g=h?ti({},typeof i=="function"?i(n):i):{};if(g.className=g.className?[].concat(T_(g.className.trim().split(/\s+/)),T_(u)):u,n&&a){var y=VL(r,n,s);t.unshift(HL(n,y))}return m&d&&(g.style=ti({display:"flex"},g.style)),{type:"element",tagName:"span",properties:g,children:t}}function GL(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],r=0;r<e.length;r++){var s=e[r];if(s.type==="text")n.push(wh({children:[s],className:T_(new Set(t))}));else if(s.children){var a=t.concat(s.properties.className);GL(s.children,a).forEach(function(o){return n.push(o)})}}return n}function Fge(e,t,n,r,s,a,o,i,c){var u,d=GL(e.value),m=[],p=-1,h=0;function g(w,S){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return wh({children:w,lineNumber:S,lineNumberStyle:i,largestLineNumber:o,showInlineLineNumbers:s,lineProps:n,className:E,showLineNumbers:r,wrapLongLines:c,wrapLines:t})}function y(w,S){if(r&&S&&s){var E=VL(i,S,o);w.unshift(HL(S,E))}return w}function b(w,S){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return t||E.length>0?g(w,S,E):y(w,S)}for(var x=function(){var S=d[h],E=S.children[0].value,T=jge(E);if(T){var k=E.split(`
`);k.forEach(function(M,N){var P=r&&m.length+a,O={type:"text",value:"".concat(M,`
`)};if(N===0){var L=d.slice(p+1,h).concat(wh({children:[O],className:S.properties.className})),H=b(L,P);m.push(H)}else if(N===k.length-1){var R=d[h+1]&&d[h+1].children&&d[h+1].children[0],I={type:"text",value:"".concat(M)};if(R){var F=wh({children:[I],className:S.properties.className});d.splice(h+1,0,F)}else{var G=[I],j=b(G,P,S.properties.className);m.push(j)}}else{var $=[O],q=b($,P,S.properties.className);m.push(q)}}),p=h}h++};h<d.length;)x();if(p!==d.length-1){var _=d.slice(p+1,d.length);if(_&&_.length){var v=r&&m.length+a,C=b(_,v);m.push(C)}}return t?m:(u=[]).concat.apply(u,m)}function Uge(e){var t=e.rows,n=e.stylesheet,r=e.useInlineStyles;return t.map(function(s,a){return BL({node:s,stylesheet:n,useInlineStyles:r,key:"code-segement".concat(a)})})}function zL(e){return e&&typeof e.highlightAuto<"u"}function Bge(e){var t=e.astGenerator,n=e.language,r=e.code,s=e.defaultCodeValue;if(zL(t)){var a=Rge(t,n);return n==="text"?{value:s,language:"text"}:a?t.highlight(n,r):t.highlightAuto(r)}try{return n&&n!=="text"?{value:t.highlight(r,n)}:{value:s}}catch{return{value:s}}}function Hge(e,t){return function(r){var s=r.language,a=r.children,o=r.style,i=o===void 0?t:o,c=r.customStyle,u=c===void 0?{}:c,d=r.codeTagProps,m=d===void 0?{className:s?"language-".concat(s):void 0,style:ti(ti({},i['code[class*="language-"]']),i['code[class*="language-'.concat(s,'"]')])}:d,p=r.useInlineStyles,h=p===void 0?!0:p,g=r.showLineNumbers,y=g===void 0?!1:g,b=r.showInlineLineNumbers,x=b===void 0?!0:b,_=r.startingLineNumber,v=_===void 0?1:_,C=r.lineNumberContainerStyle,w=r.lineNumberStyle,S=w===void 0?{}:w,E=r.wrapLines,T=r.wrapLongLines,k=T===void 0?!1:T,M=r.lineProps,N=M===void 0?{}:M,P=r.renderer,O=r.PreTag,L=O===void 0?"pre":O,H=r.CodeTag,R=H===void 0?"code":H,I=r.code,F=I===void 0?(Array.isArray(a)?a[0]:a)||"":I,G=r.astGenerator,j=vge(r,Dge);G=G||e;var $=y?A.createElement(Oge,{containerStyle:C,codeStyle:m.style||{},numberStyle:S,startingLineNumber:v,codeString:F}):null,q=i.hljs||i['pre[class*="language-"]']||{backgroundColor:"#fff"},U=zL(G)?"hljs":"prismjs",X=h?Object.assign({},j,{style:Object.assign({},q,u)}):Object.assign({},j,{className:j.className?"".concat(U," ").concat(j.className):U,style:Object.assign({},u)});if(k?m.style=ti({whiteSpace:"pre-wrap"},m.style):m.style=ti({whiteSpace:"pre"},m.style),!G)return A.createElement(L,X,$,A.createElement(R,m,F));(E===void 0&&P||k)&&(E=!0),P=P||Uge;var J=[{type:"text",value:F}],ne=Bge({astGenerator:G,language:s,code:F,defaultCodeValue:J});ne.language===null&&(ne.value=J);var ae=ne.value.length;ae===1&&ne.value[0].type==="text"&&(ae=ne.value[0].value.split(`
`).length);var de=ae+v,oe=Fge(ne,E,N,y,x,v,de,S,k);return A.createElement(L,X,A.createElement(R,m,!x&&$,P({rows:oe,stylesheet:i,useInlineStyles:h})))}}function DM(e,t,n,r,s,a,o){try{var i=e[a](o),c=i.value}catch(u){return void n(u)}i.done?t(c):Promise.resolve(c).then(r,s)}function qL(e){return function(){var t=this,n=arguments;return new Promise(function(r,s){var a=e.apply(t,n);function o(c){DM(a,r,s,o,i,"next",c)}function i(c){DM(a,r,s,o,i,"throw",c)}o(void 0)})}}function Vge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,UL(r.key),r)}}function Gge(e,t,n){return t&&IM(e.prototype,t),n&&IM(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function zge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qge(e,t){if(t&&($a(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zge(e)}function ag(e){return ag=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ag(e)}function A_(e,t){return A_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},A_(e,t)}function $ge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A_(e,t)}function N_(){N_=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,s=Object.defineProperty||function(R,I,F){R[I]=F.value},a=typeof Symbol=="function"?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(R,I,F){return Object.defineProperty(R,I,{value:F,enumerable:!0,configurable:!0,writable:!0}),R[I]}try{u({},"")}catch{u=function(F,G,j){return F[G]=j}}function d(R,I,F,G){var j=I&&I.prototype instanceof x?I:x,$=Object.create(j.prototype),q=new L(G||[]);return s($,"_invoke",{value:M(R,F,q)}),$}function m(R,I,F){try{return{type:"normal",arg:R.call(I,F)}}catch(G){return{type:"throw",arg:G}}}t.wrap=d;var p="suspendedStart",h="suspendedYield",g="executing",y="completed",b={};function x(){}function _(){}function v(){}var C={};u(C,o,function(){return this});var w=Object.getPrototypeOf,S=w&&w(w(H([])));S&&S!==n&&r.call(S,o)&&(C=S);var E=v.prototype=x.prototype=Object.create(C);function T(R){["next","throw","return"].forEach(function(I){u(R,I,function(F){return this._invoke(I,F)})})}function k(R,I){function F(j,$,q,U){var X=m(R[j],R,$);if(X.type!=="throw"){var J=X.arg,ne=J.value;return ne&&$a(ne)=="object"&&r.call(ne,"__await")?I.resolve(ne.__await).then(function(ae){F("next",ae,q,U)},function(ae){F("throw",ae,q,U)}):I.resolve(ne).then(function(ae){J.value=ae,q(J)},function(ae){return F("throw",ae,q,U)})}U(X.arg)}var G;s(this,"_invoke",{value:function($,q){function U(){return new I(function(X,J){F($,q,X,J)})}return G=G?G.then(U,U):U()}})}function M(R,I,F){var G=p;return function(j,$){if(G===g)throw Error("Generator is already running");if(G===y){if(j==="throw")throw $;return{value:e,done:!0}}for(F.method=j,F.arg=$;;){var q=F.delegate;if(q){var U=N(q,F);if(U){if(U===b)continue;return U}}if(F.method==="next")F.sent=F._sent=F.arg;else if(F.method==="throw"){if(G===p)throw G=y,F.arg;F.dispatchException(F.arg)}else F.method==="return"&&F.abrupt("return",F.arg);G=g;var X=m(R,I,F);if(X.type==="normal"){if(G=F.done?y:h,X.arg===b)continue;return{value:X.arg,done:F.done}}X.type==="throw"&&(G=y,F.method="throw",F.arg=X.arg)}}}function N(R,I){var F=I.method,G=R.iterator[F];if(G===e)return I.delegate=null,F==="throw"&&R.iterator.return&&(I.method="return",I.arg=e,N(R,I),I.method==="throw")||F!=="return"&&(I.method="throw",I.arg=new TypeError("The iterator does not provide a '"+F+"' method")),b;var j=m(G,R.iterator,I.arg);if(j.type==="throw")return I.method="throw",I.arg=j.arg,I.delegate=null,b;var $=j.arg;return $?$.done?(I[R.resultName]=$.value,I.next=R.nextLoc,I.method!=="return"&&(I.method="next",I.arg=e),I.delegate=null,b):$:(I.method="throw",I.arg=new TypeError("iterator result is not an object"),I.delegate=null,b)}function P(R){var I={tryLoc:R[0]};1 in R&&(I.catchLoc=R[1]),2 in R&&(I.finallyLoc=R[2],I.afterLoc=R[3]),this.tryEntries.push(I)}function O(R){var I=R.completion||{};I.type="normal",delete I.arg,R.completion=I}function L(R){this.tryEntries=[{tryLoc:"root"}],R.forEach(P,this),this.reset(!0)}function H(R){if(R||R===""){var I=R[o];if(I)return I.call(R);if(typeof R.next=="function")return R;if(!isNaN(R.length)){var F=-1,G=function j(){for(;++F<R.length;)if(r.call(R,F))return j.value=R[F],j.done=!1,j;return j.value=e,j.done=!0,j};return G.next=G}}throw new TypeError($a(R)+" is not iterable")}return _.prototype=v,s(E,"constructor",{value:v,configurable:!0}),s(v,"constructor",{value:_,configurable:!0}),_.displayName=u(v,c,"GeneratorFunction"),t.isGeneratorFunction=function(R){var I=typeof R=="function"&&R.constructor;return!!I&&(I===_||(I.displayName||I.name)==="GeneratorFunction")},t.mark=function(R){return Object.setPrototypeOf?Object.setPrototypeOf(R,v):(R.__proto__=v,u(R,c,"GeneratorFunction")),R.prototype=Object.create(E),R},t.awrap=function(R){return{__await:R}},T(k.prototype),u(k.prototype,i,function(){return this}),t.AsyncIterator=k,t.async=function(R,I,F,G,j){j===void 0&&(j=Promise);var $=new k(d(R,I,F,G),j);return t.isGeneratorFunction(I)?$:$.next().then(function(q){return q.done?q.value:$.next()})},T(E),u(E,c,"Generator"),u(E,o,function(){return this}),u(E,"toString",function(){return"[object Generator]"}),t.keys=function(R){var I=Object(R),F=[];for(var G in I)F.push(G);return F.reverse(),function j(){for(;F.length;){var $=F.pop();if($ in I)return j.value=$,j.done=!1,j}return j.done=!0,j}},t.values=H,L.prototype={constructor:L,reset:function(I){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!I)for(var F in this)F.charAt(0)==="t"&&r.call(this,F)&&!isNaN(+F.slice(1))&&(this[F]=e)},stop:function(){this.done=!0;var I=this.tryEntries[0].completion;if(I.type==="throw")throw I.arg;return this.rval},dispatchException:function(I){if(this.done)throw I;var F=this;function G(J,ne){return q.type="throw",q.arg=I,F.next=J,ne&&(F.method="next",F.arg=e),!!ne}for(var j=this.tryEntries.length-1;j>=0;--j){var $=this.tryEntries[j],q=$.completion;if($.tryLoc==="root")return G("end");if($.tryLoc<=this.prev){var U=r.call($,"catchLoc"),X=r.call($,"finallyLoc");if(U&&X){if(this.prev<$.catchLoc)return G($.catchLoc,!0);if(this.prev<$.finallyLoc)return G($.finallyLoc)}else if(U){if(this.prev<$.catchLoc)return G($.catchLoc,!0)}else{if(!X)throw Error("try statement without catch or finally");if(this.prev<$.finallyLoc)return G($.finallyLoc)}}}},abrupt:function(I,F){for(var G=this.tryEntries.length-1;G>=0;--G){var j=this.tryEntries[G];if(j.tryLoc<=this.prev&&r.call(j,"finallyLoc")&&this.prev<j.finallyLoc){var $=j;break}}$&&(I==="break"||I==="continue")&&$.tryLoc<=F&&F<=$.finallyLoc&&($=null);var q=$?$.completion:{};return q.type=I,q.arg=F,$?(this.method="next",this.next=$.finallyLoc,b):this.complete(q)},complete:function(I,F){if(I.type==="throw")throw I.arg;return I.type==="break"||I.type==="continue"?this.next=I.arg:I.type==="return"?(this.rval=this.arg=I.arg,this.method="return",this.next="end"):I.type==="normal"&&F&&(this.next=F),b},finish:function(I){for(var F=this.tryEntries.length-1;F>=0;--F){var G=this.tryEntries[F];if(G.finallyLoc===I)return this.complete(G.completion,G.afterLoc),O(G),b}},catch:function(I){for(var F=this.tryEntries.length-1;F>=0;--F){var G=this.tryEntries[F];if(G.tryLoc===I){var j=G.completion;if(j.type==="throw"){var $=j.arg;O(G)}return $}}throw Error("illegal catch attempt")},delegateYield:function(I,F,G){return this.delegate={iterator:H(I),resultName:F,nextLoc:G},this.method==="next"&&(this.arg=e),b}},t}function Wge(e,t,n){return t=ag(t),qge(e,$L()?Reflect.construct(t,n||[],ag(e).constructor):t.apply(e,n))}function $L(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($L=function(){return!!e})()}const Kge=(function(e){var t,n=e.loader,r=e.isLanguageRegistered,s=e.registerLanguage,a=e.languageLoaders,o=e.noAsyncLoadingLanguages,i=(function(c){function u(){return Vge(this,u),Wge(this,u,arguments)}return $ge(u,c),Gge(u,[{key:"componentDidUpdate",value:function(){!u.isRegistered(this.props.language)&&a&&this.loadLanguage()}},{key:"componentDidMount",value:function(){var m=this;u.astGeneratorPromise||u.loadAstGenerator(),u.astGenerator||u.astGeneratorPromise.then(function(){m.forceUpdate()}),!u.isRegistered(this.props.language)&&a&&this.loadLanguage()}},{key:"loadLanguage",value:function(){var m=this,p=this.props.language;p!=="text"&&u.loadLanguage(p).then(function(){return m.forceUpdate()}).catch(function(){})}},{key:"normalizeLanguage",value:function(m){return u.isSupportedLanguage(m)?m:"text"}},{key:"render",value:function(){return A.createElement(u.highlightInstance,vf({},this.props,{language:this.normalizeLanguage(this.props.language),astGenerator:u.astGenerator}))}}],[{key:"preload",value:function(){return u.loadAstGenerator()}},{key:"loadLanguage",value:(function(){var d=qL(N_().mark(function p(h){var g;return N_().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(g=a[h],typeof g!="function"){b.next=5;break}return b.abrupt("return",g(u.registerLanguage));case 5:throw new Error("Language ".concat(h," not supported"));case 6:case"end":return b.stop()}},p)}));function m(p){return d.apply(this,arguments)}return m})()},{key:"isSupportedLanguage",value:function(m){return u.isRegistered(m)||typeof a[m]=="function"}},{key:"loadAstGenerator",value:function(){return u.astGeneratorPromise=n().then(function(m){u.astGenerator=m,s&&u.languages.forEach(function(p,h){return s(m,h,p)})}),u.astGeneratorPromise}}])})(A.PureComponent);return t=i,ho(i,"astGenerator",null),ho(i,"highlightInstance",Hge(null,{})),ho(i,"astGeneratorPromise",null),ho(i,"languages",new Map),ho(i,"supportedLanguages",e.supportedLanguages||Object.keys(a||{})),ho(i,"isRegistered",function(c){if(o)return!0;if(!s)throw new Error("Current syntax highlighter doesn't support registration of languages");return t.astGenerator?r(t.astGenerator,c):t.languages.has(c)}),ho(i,"registerLanguage",function(c,u){if(!s)throw new Error("Current syntax highlighter doesn't support registration of languages");if(t.astGenerator)return s(t.astGenerator,c,u);t.languages.set(c,u)}),i});function R_(){R_=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,s=Object.defineProperty||function(R,I,F){R[I]=F.value},a=typeof Symbol=="function"?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(R,I,F){return Object.defineProperty(R,I,{value:F,enumerable:!0,configurable:!0,writable:!0}),R[I]}try{u({},"")}catch{u=function(F,G,j){return F[G]=j}}function d(R,I,F,G){var j=I&&I.prototype instanceof x?I:x,$=Object.create(j.prototype),q=new L(G||[]);return s($,"_invoke",{value:M(R,F,q)}),$}function m(R,I,F){try{return{type:"normal",arg:R.call(I,F)}}catch(G){return{type:"throw",arg:G}}}t.wrap=d;var p="suspendedStart",h="suspendedYield",g="executing",y="completed",b={};function x(){}function _(){}function v(){}var C={};u(C,o,function(){return this});var w=Object.getPrototypeOf,S=w&&w(w(H([])));S&&S!==n&&r.call(S,o)&&(C=S);var E=v.prototype=x.prototype=Object.create(C);function T(R){["next","throw","return"].forEach(function(I){u(R,I,function(F){return this._invoke(I,F)})})}function k(R,I){function F(j,$,q,U){var X=m(R[j],R,$);if(X.type!=="throw"){var J=X.arg,ne=J.value;return ne&&$a(ne)=="object"&&r.call(ne,"__await")?I.resolve(ne.__await).then(function(ae){F("next",ae,q,U)},function(ae){F("throw",ae,q,U)}):I.resolve(ne).then(function(ae){J.value=ae,q(J)},function(ae){return F("throw",ae,q,U)})}U(X.arg)}var G;s(this,"_invoke",{value:function($,q){function U(){return new I(function(X,J){F($,q,X,J)})}return G=G?G.then(U,U):U()}})}function M(R,I,F){var G=p;return function(j,$){if(G===g)throw Error("Generator is already running");if(G===y){if(j==="throw")throw $;return{value:e,done:!0}}for(F.method=j,F.arg=$;;){var q=F.delegate;if(q){var U=N(q,F);if(U){if(U===b)continue;return U}}if(F.method==="next")F.sent=F._sent=F.arg;else if(F.method==="throw"){if(G===p)throw G=y,F.arg;F.dispatchException(F.arg)}else F.method==="return"&&F.abrupt("return",F.arg);G=g;var X=m(R,I,F);if(X.type==="normal"){if(G=F.done?y:h,X.arg===b)continue;return{value:X.arg,done:F.done}}X.type==="throw"&&(G=y,F.method="throw",F.arg=X.arg)}}}function N(R,I){var F=I.method,G=R.iterator[F];if(G===e)return I.delegate=null,F==="throw"&&R.iterator.return&&(I.method="return",I.arg=e,N(R,I),I.method==="throw")||F!=="return"&&(I.method="throw",I.arg=new TypeError("The iterator does not provide a '"+F+"' method")),b;var j=m(G,R.iterator,I.arg);if(j.type==="throw")return I.method="throw",I.arg=j.arg,I.delegate=null,b;var $=j.arg;return $?$.done?(I[R.resultName]=$.value,I.next=R.nextLoc,I.method!=="return"&&(I.method="next",I.arg=e),I.delegate=null,b):$:(I.method="throw",I.arg=new TypeError("iterator result is not an object"),I.delegate=null,b)}function P(R){var I={tryLoc:R[0]};1 in R&&(I.catchLoc=R[1]),2 in R&&(I.finallyLoc=R[2],I.afterLoc=R[3]),this.tryEntries.push(I)}function O(R){var I=R.completion||{};I.type="normal",delete I.arg,R.completion=I}function L(R){this.tryEntries=[{tryLoc:"root"}],R.forEach(P,this),this.reset(!0)}function H(R){if(R||R===""){var I=R[o];if(I)return I.call(R);if(typeof R.next=="function")return R;if(!isNaN(R.length)){var F=-1,G=function j(){for(;++F<R.length;)if(r.call(R,F))return j.value=R[F],j.done=!1,j;return j.value=e,j.done=!0,j};return G.next=G}}throw new TypeError($a(R)+" is not iterable")}return _.prototype=v,s(E,"constructor",{value:v,configurable:!0}),s(v,"constructor",{value:_,configurable:!0}),_.displayName=u(v,c,"GeneratorFunction"),t.isGeneratorFunction=function(R){var I=typeof R=="function"&&R.constructor;return!!I&&(I===_||(I.displayName||I.name)==="GeneratorFunction")},t.mark=function(R){return Object.setPrototypeOf?Object.setPrototypeOf(R,v):(R.__proto__=v,u(R,c,"GeneratorFunction")),R.prototype=Object.create(E),R},t.awrap=function(R){return{__await:R}},T(k.prototype),u(k.prototype,i,function(){return this}),t.AsyncIterator=k,t.async=function(R,I,F,G,j){j===void 0&&(j=Promise);var $=new k(d(R,I,F,G),j);return t.isGeneratorFunction(I)?$:$.next().then(function(q){return q.done?q.value:$.next()})},T(E),u(E,c,"Generator"),u(E,o,function(){return this}),u(E,"toString",function(){return"[object Generator]"}),t.keys=function(R){var I=Object(R),F=[];for(var G in I)F.push(G);return F.reverse(),function j(){for(;F.length;){var $=F.pop();if($ in I)return j.value=$,j.done=!1,j}return j.done=!0,j}},t.values=H,L.prototype={constructor:L,reset:function(I){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!I)for(var F in this)F.charAt(0)==="t"&&r.call(this,F)&&!isNaN(+F.slice(1))&&(this[F]=e)},stop:function(){this.done=!0;var I=this.tryEntries[0].completion;if(I.type==="throw")throw I.arg;return this.rval},dispatchException:function(I){if(this.done)throw I;var F=this;function G(J,ne){return q.type="throw",q.arg=I,F.next=J,ne&&(F.method="next",F.arg=e),!!ne}for(var j=this.tryEntries.length-1;j>=0;--j){var $=this.tryEntries[j],q=$.completion;if($.tryLoc==="root")return G("end");if($.tryLoc<=this.prev){var U=r.call($,"catchLoc"),X=r.call($,"finallyLoc");if(U&&X){if(this.prev<$.catchLoc)return G($.catchLoc,!0);if(this.prev<$.finallyLoc)return G($.finallyLoc)}else if(U){if(this.prev<$.catchLoc)return G($.catchLoc,!0)}else{if(!X)throw Error("try statement without catch or finally");if(this.prev<$.finallyLoc)return G($.finallyLoc)}}}},abrupt:function(I,F){for(var G=this.tryEntries.length-1;G>=0;--G){var j=this.tryEntries[G];if(j.tryLoc<=this.prev&&r.call(j,"finallyLoc")&&this.prev<j.finallyLoc){var $=j;break}}$&&(I==="break"||I==="continue")&&$.tryLoc<=F&&F<=$.finallyLoc&&($=null);var q=$?$.completion:{};return q.type=I,q.arg=F,$?(this.method="next",this.next=$.finallyLoc,b):this.complete(q)},complete:function(I,F){if(I.type==="throw")throw I.arg;return I.type==="break"||I.type==="continue"?this.next=I.arg:I.type==="return"?(this.rval=this.arg=I.arg,this.method="return",this.next="end"):I.type==="normal"&&F&&(this.next=F),b},finish:function(I){for(var F=this.tryEntries.length-1;F>=0;--F){var G=this.tryEntries[F];if(G.finallyLoc===I)return this.complete(G.completion,G.afterLoc),O(G),b}},catch:function(I){for(var F=this.tryEntries.length-1;F>=0;--F){var G=this.tryEntries[F];if(G.tryLoc===I){var j=G.completion;if(j.type==="throw"){var $=j.arg;O(G)}return $}}throw Error("illegal catch attempt")},delegateYield:function(I,F,G){return this.delegate={iterator:H(I),resultName:F,nextLoc:G},this.method==="next"&&(this.arg=e),b}},t}const ee=(function(e,t){return(function(){var n=qL(R_().mark(function r(s){var a;return R_().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t();case 2:a=i.sent,s(e,a.default||a);case 4:case"end":return i.stop()}},r)}));return function(r){return n.apply(this,arguments)}})()}),Yge={abap:ee("abap",function(){return W(()=>import("./abap-CV_jZxTX.js").then(e=>e.a),__vite__mapDeps([93,3]))}),abnf:ee("abnf",function(){return W(()=>import("./abnf-BNCUoIkk.js").then(e=>e.a),__vite__mapDeps([94,3]))}),actionscript:ee("actionscript",function(){return W(()=>import("./actionscript-DdUEzyyr.js").then(e=>e.a),__vite__mapDeps([95,3]))}),ada:ee("ada",function(){return W(()=>import("./ada-CTM-i5br.js").then(e=>e.a),__vite__mapDeps([96,3]))}),agda:ee("agda",function(){return W(()=>import("./agda-D_HlvG7B.js").then(e=>e.a),__vite__mapDeps([97,3]))}),al:ee("al",function(){return W(()=>import("./al-CcC_DmeJ.js").then(e=>e.a),__vite__mapDeps([98,3]))}),antlr4:ee("antlr4",function(){return W(()=>import("./antlr4-C2Vn_Adw.js").then(e=>e.a),__vite__mapDeps([99,3]))}),apacheconf:ee("apacheconf",function(){return W(()=>import("./apacheconf-9VSZeI3x.js").then(e=>e.a),__vite__mapDeps([100,3]))}),apex:ee("apex",function(){return W(()=>import("./apex-CUQS8Pv9.js").then(e=>e.a),__vite__mapDeps([101,3,102]))}),apl:ee("apl",function(){return W(()=>import("./apl-BiCRFlD6.js").then(e=>e.a),__vite__mapDeps([103,3]))}),applescript:ee("applescript",function(){return W(()=>import("./applescript-OsGDhAtr.js").then(e=>e.a),__vite__mapDeps([104,3]))}),aql:ee("aql",function(){return W(()=>import("./aql-K9UbBa_q.js").then(e=>e.a),__vite__mapDeps([105,3]))}),arduino:ee("arduino",function(){return W(()=>import("./arduino-knV3L13X.js").then(e=>e.a),__vite__mapDeps([106,3,107,108]))}),arff:ee("arff",function(){return W(()=>import("./arff-DXUc2Eem.js").then(e=>e.a),__vite__mapDeps([109,3]))}),asciidoc:ee("asciidoc",function(){return W(()=>import("./asciidoc-CJYHfSxT.js").then(e=>e.a),__vite__mapDeps([110,3]))}),asm6502:ee("asm6502",function(){return W(()=>import("./asm6502-Caqb35Na.js").then(e=>e.a),__vite__mapDeps([111,3]))}),asmatmel:ee("asmatmel",function(){return W(()=>import("./asmatmel-VSfemE38.js").then(e=>e.a),__vite__mapDeps([112,3]))}),aspnet:ee("aspnet",function(){return W(()=>import("./aspnet-PIXTPjK_.js").then(e=>e.a),__vite__mapDeps([113,3,114]))}),autohotkey:ee("autohotkey",function(){return W(()=>import("./autohotkey-Bd9dI61G.js").then(e=>e.a),__vite__mapDeps([115,3]))}),autoit:ee("autoit",function(){return W(()=>import("./autoit-BVeczYLs.js").then(e=>e.a),__vite__mapDeps([116,3]))}),avisynth:ee("avisynth",function(){return W(()=>import("./avisynth-BXrDhGWF.js").then(e=>e.a),__vite__mapDeps([117,3]))}),avroIdl:ee("avroIdl",function(){return W(()=>import("./avro-idl-BeGCdlLL.js").then(e=>e.a),__vite__mapDeps([118,3]))}),bash:ee("bash",function(){return W(()=>import("./bash-D9E8VlyO.js").then(e=>e.b),__vite__mapDeps([119,3,120]))}),basic:ee("basic",function(){return W(()=>import("./basic-C-qkbcWC.js").then(e=>e.b),__vite__mapDeps([121,3,122]))}),batch:ee("batch",function(){return W(()=>import("./batch-D4G4oL2k.js").then(e=>e.b),__vite__mapDeps([123,3]))}),bbcode:ee("bbcode",function(){return W(()=>import("./bbcode-Dr1_GsJW.js").then(e=>e.b),__vite__mapDeps([124,3]))}),bicep:ee("bicep",function(){return W(()=>import("./bicep-Ckzj3k4Z.js").then(e=>e.b),__vite__mapDeps([125,3]))}),birb:ee("birb",function(){return W(()=>import("./birb-BwnkZWxs.js").then(e=>e.b),__vite__mapDeps([126,3]))}),bison:ee("bison",function(){return W(()=>import("./bison-C2M86P-f.js").then(e=>e.b),__vite__mapDeps([127,3,108]))}),bnf:ee("bnf",function(){return W(()=>import("./bnf-CqwJKlBf.js").then(e=>e.b),__vite__mapDeps([128,3]))}),brainfuck:ee("brainfuck",function(){return W(()=>import("./brainfuck-Cx-H0WXM.js").then(e=>e.b),__vite__mapDeps([129,3]))}),brightscript:ee("brightscript",function(){return W(()=>import("./brightscript-Dkm0arzU.js").then(e=>e.b),__vite__mapDeps([130,3]))}),bro:ee("bro",function(){return W(()=>import("./bro-Zr6TMavl.js").then(e=>e.b),__vite__mapDeps([131,3]))}),bsl:ee("bsl",function(){return W(()=>import("./bsl-BzTcwED9.js").then(e=>e.b),__vite__mapDeps([132,3]))}),c:ee("c",function(){return W(()=>import("./c-WH3bxsh3.js").then(e=>e.c),__vite__mapDeps([133,3,108]))}),cfscript:ee("cfscript",function(){return W(()=>import("./cfscript-BKVF-A9i.js").then(e=>e.c),__vite__mapDeps([134,3]))}),chaiscript:ee("chaiscript",function(){return W(()=>import("./chaiscript-CNz1Wl1d.js").then(e=>e.c),__vite__mapDeps([135,3,107,108]))}),cil:ee("cil",function(){return W(()=>import("./cil-C5Je8XVP.js").then(e=>e.c),__vite__mapDeps([136,3]))}),clike:ee("clike",function(){return W(()=>import("./clike-bg8nIv-l.js").then(e=>e.c),__vite__mapDeps([137,3,138]))}),clojure:ee("clojure",function(){return W(()=>import("./clojure-2qo_QJyk.js").then(e=>e.c),__vite__mapDeps([139,3]))}),cmake:ee("cmake",function(){return W(()=>import("./cmake-BaC7L8Yb.js").then(e=>e.c),__vite__mapDeps([140,3]))}),cobol:ee("cobol",function(){return W(()=>import("./cobol-CR-Up98c.js").then(e=>e.c),__vite__mapDeps([141,3]))}),coffeescript:ee("coffeescript",function(){return W(()=>import("./coffeescript-CatKqQn0.js").then(e=>e.c),__vite__mapDeps([142,3]))}),concurnas:ee("concurnas",function(){return W(()=>import("./concurnas-BhxsU0iU.js").then(e=>e.c),__vite__mapDeps([143,3]))}),coq:ee("coq",function(){return W(()=>import("./coq-DDgTrepg.js").then(e=>e.c),__vite__mapDeps([144,3]))}),cpp:ee("cpp",function(){return W(()=>import("./cpp-uXx8-CtQ.js").then(e=>e.c),__vite__mapDeps([145,3,107,108]))}),crystal:ee("crystal",function(){return W(()=>import("./crystal-CLBDhWRh.js").then(e=>e.c),__vite__mapDeps([146,3,147]))}),csharp:ee("csharp",function(){return W(()=>import("./csharp-DK-q69Vy.js").then(e=>e.c),__vite__mapDeps([148,3,114]))}),cshtml:ee("cshtml",function(){return W(()=>import("./cshtml-BO2XSvP7.js").then(e=>e.c),__vite__mapDeps([149,3,114]))}),csp:ee("csp",function(){return W(()=>import("./csp-Br7inWip.js").then(e=>e.c),__vite__mapDeps([150,3]))}),cssExtras:ee("cssExtras",function(){return W(()=>import("./css-extras-CVdypllm.js").then(e=>e.c),__vite__mapDeps([151,3]))}),css:ee("css",function(){return W(()=>import("./css-CCv4Vvbj.js").then(e=>e.c),__vite__mapDeps([152,3,153]))}),csv:ee("csv",function(){return W(()=>import("./csv-DDvLlsBd.js").then(e=>e.c),__vite__mapDeps([154,3]))}),cypher:ee("cypher",function(){return W(()=>import("./cypher-A2WkqKYS.js").then(e=>e.c),__vite__mapDeps([155,3]))}),d:ee("d",function(){return W(()=>import("./d-BGbfCRwr.js").then(e=>e.d),__vite__mapDeps([156,3]))}),dart:ee("dart",function(){return W(()=>import("./dart-CEB81Eae.js").then(e=>e.d),__vite__mapDeps([157,3]))}),dataweave:ee("dataweave",function(){return W(()=>import("./dataweave-BPafolc3.js").then(e=>e.d),__vite__mapDeps([158,3]))}),dax:ee("dax",function(){return W(()=>import("./dax-DpZF3oAd.js").then(e=>e.d),__vite__mapDeps([159,3]))}),dhall:ee("dhall",function(){return W(()=>import("./dhall-BLY5QCMc.js").then(e=>e.d),__vite__mapDeps([160,3]))}),diff:ee("diff",function(){return W(()=>import("./diff-D3mz30LW.js").then(e=>e.d),__vite__mapDeps([161,3]))}),django:ee("django",function(){return W(()=>import("./django-BP9dodSq.js").then(e=>e.d),__vite__mapDeps([162,3,163]))}),dnsZoneFile:ee("dnsZoneFile",function(){return W(()=>import("./dns-zone-file-_gEcm3FV.js").then(e=>e.d),__vite__mapDeps([164,3]))}),docker:ee("docker",function(){return W(()=>import("./docker-CzkAZtAp.js").then(e=>e.d),__vite__mapDeps([165,3]))}),dot:ee("dot",function(){return W(()=>import("./dot-CbTX0-fD.js").then(e=>e.d),__vite__mapDeps([166,3]))}),ebnf:ee("ebnf",function(){return W(()=>import("./ebnf-kgD1jvUL.js").then(e=>e.e),__vite__mapDeps([167,3]))}),editorconfig:ee("editorconfig",function(){return W(()=>import("./editorconfig-Dw1XnYyJ.js").then(e=>e.e),__vite__mapDeps([168,3]))}),eiffel:ee("eiffel",function(){return W(()=>import("./eiffel-CIyXigIg.js").then(e=>e.e),__vite__mapDeps([169,3]))}),ejs:ee("ejs",function(){return W(()=>import("./ejs-kmWvBa-6.js").then(e=>e.e),__vite__mapDeps([170,3,163]))}),elixir:ee("elixir",function(){return W(()=>import("./elixir-oJr7Moz8.js").then(e=>e.e),__vite__mapDeps([171,3]))}),elm:ee("elm",function(){return W(()=>import("./elm-BExmsuAD.js").then(e=>e.e),__vite__mapDeps([172,3]))}),erb:ee("erb",function(){return W(()=>import("./erb-DewsE-eh.js").then(e=>e.e),__vite__mapDeps([173,3,147,163]))}),erlang:ee("erlang",function(){return W(()=>import("./erlang-Dl84d_GC.js").then(e=>e.e),__vite__mapDeps([174,3]))}),etlua:ee("etlua",function(){return W(()=>import("./etlua-BlFFdw1J.js").then(e=>e.e),__vite__mapDeps([175,3,176,163]))}),excelFormula:ee("excelFormula",function(){return W(()=>import("./excel-formula-CPfdXlSY.js").then(e=>e.e),__vite__mapDeps([177,3]))}),factor:ee("factor",function(){return W(()=>import("./factor-qtUheGqr.js").then(e=>e.f),__vite__mapDeps([178,3]))}),falselang:ee("falselang",function(){return W(()=>import("./false-AcwZMSiq.js").then(e=>e._),__vite__mapDeps([179,3]))}),firestoreSecurityRules:ee("firestoreSecurityRules",function(){return W(()=>import("./firestore-security-rules-CAXGufIy.js").then(e=>e.f),__vite__mapDeps([180,3]))}),flow:ee("flow",function(){return W(()=>import("./flow-CJflD3qb.js").then(e=>e.f),__vite__mapDeps([181,3]))}),fortran:ee("fortran",function(){return W(()=>import("./fortran-DmPpmt9u.js").then(e=>e.f),__vite__mapDeps([182,3]))}),fsharp:ee("fsharp",function(){return W(()=>import("./fsharp-BIYb3od7.js").then(e=>e.f),__vite__mapDeps([183,3]))}),ftl:ee("ftl",function(){return W(()=>import("./ftl-Bom-ReFh.js").then(e=>e.f),__vite__mapDeps([184,3,163]))}),gap:ee("gap",function(){return W(()=>import("./gap-B7m9c5lB.js").then(e=>e.g),__vite__mapDeps([185,3]))}),gcode:ee("gcode",function(){return W(()=>import("./gcode-kdC4es4O.js").then(e=>e.g),__vite__mapDeps([186,3]))}),gdscript:ee("gdscript",function(){return W(()=>import("./gdscript-B-svtcyR.js").then(e=>e.g),__vite__mapDeps([187,3]))}),gedcom:ee("gedcom",function(){return W(()=>import("./gedcom-BTUQAqsw.js").then(e=>e.g),__vite__mapDeps([188,3]))}),gherkin:ee("gherkin",function(){return W(()=>import("./gherkin-DDhx_uCX.js").then(e=>e.g),__vite__mapDeps([189,3]))}),git:ee("git",function(){return W(()=>import("./git-Fkz6o5kn.js").then(e=>e.g),__vite__mapDeps([190,3]))}),glsl:ee("glsl",function(){return W(()=>import("./glsl-CtvMG-8S.js").then(e=>e.g),__vite__mapDeps([191,3,108]))}),gml:ee("gml",function(){return W(()=>import("./gml-KLPn_axH.js").then(e=>e.g),__vite__mapDeps([192,3]))}),gn:ee("gn",function(){return W(()=>import("./gn-DhXMFt-Q.js").then(e=>e.g),__vite__mapDeps([193,3]))}),goModule:ee("goModule",function(){return W(()=>import("./go-module-CnQOt6kc.js").then(e=>e.g),__vite__mapDeps([194,3]))}),go:ee("go",function(){return W(()=>import("./go-CfpLUIjY.js").then(e=>e.g),__vite__mapDeps([195,3]))}),graphql:ee("graphql",function(){return W(()=>import("./graphql-gOFq8Hac.js").then(e=>e.g),__vite__mapDeps([196,3]))}),groovy:ee("groovy",function(){return W(()=>import("./groovy-BnRYVI6f.js").then(e=>e.g),__vite__mapDeps([197,3]))}),haml:ee("haml",function(){return W(()=>import("./haml-DO6fnXAU.js").then(e=>e.h),__vite__mapDeps([198,3,147]))}),handlebars:ee("handlebars",function(){return W(()=>import("./handlebars-Bvrg2NBv.js").then(e=>e.h),__vite__mapDeps([199,3,163]))}),haskell:ee("haskell",function(){return W(()=>import("./haskell-D45DX1u8.js").then(e=>e.h),__vite__mapDeps([200,3,201]))}),haxe:ee("haxe",function(){return W(()=>import("./haxe-Cz3QrPur.js").then(e=>e.h),__vite__mapDeps([202,3]))}),hcl:ee("hcl",function(){return W(()=>import("./hcl-Db2WVuK0.js").then(e=>e.h),__vite__mapDeps([203,3]))}),hlsl:ee("hlsl",function(){return W(()=>import("./hlsl-Cbarunv7.js").then(e=>e.h),__vite__mapDeps([204,3,108]))}),hoon:ee("hoon",function(){return W(()=>import("./hoon-BOzlMsoN.js").then(e=>e.h),__vite__mapDeps([205,3]))}),hpkp:ee("hpkp",function(){return W(()=>import("./hpkp-Z5YRa4oO.js").then(e=>e.h),__vite__mapDeps([206,3]))}),hsts:ee("hsts",function(){return W(()=>import("./hsts-DMP3JxNs.js").then(e=>e.h),__vite__mapDeps([207,3]))}),http:ee("http",function(){return W(()=>import("./http-CcBBDd2v.js").then(e=>e.h),__vite__mapDeps([208,3]))}),ichigojam:ee("ichigojam",function(){return W(()=>import("./ichigojam-D64jJrmw.js").then(e=>e.i),__vite__mapDeps([209,3]))}),icon:ee("icon",function(){return W(()=>import("./icon-BXMTiB0w.js").then(e=>e.i),__vite__mapDeps([210,3]))}),icuMessageFormat:ee("icuMessageFormat",function(){return W(()=>import("./icu-message-format-B0jFFGtY.js").then(e=>e.i),__vite__mapDeps([211,3]))}),idris:ee("idris",function(){return W(()=>import("./idris-DWqAIgN5.js").then(e=>e.i),__vite__mapDeps([212,3,201]))}),iecst:ee("iecst",function(){return W(()=>import("./iecst-Dk4U_4hp.js").then(e=>e.i),__vite__mapDeps([213,3]))}),ignore:ee("ignore",function(){return W(()=>import("./ignore-BjREke3F.js").then(e=>e.i),__vite__mapDeps([214,3]))}),inform7:ee("inform7",function(){return W(()=>import("./inform7-C7JfYvbO.js").then(e=>e.i),__vite__mapDeps([215,3]))}),ini:ee("ini",function(){return W(()=>import("./ini-DQrtzM4N.js").then(e=>e.i),__vite__mapDeps([216,3]))}),io:ee("io",function(){return W(()=>import("./io-CEhyiSAi.js").then(e=>e.i),__vite__mapDeps([217,3]))}),j:ee("j",function(){return W(()=>import("./j-sND6E-Fv.js").then(e=>e.j),__vite__mapDeps([218,3]))}),java:ee("java",function(){return W(()=>import("./java-AlF4DDxv.js").then(e=>e.j),__vite__mapDeps([219,3,220]))}),javadoc:ee("javadoc",function(){return W(()=>import("./javadoc-DCJd648D.js").then(e=>e.j),__vite__mapDeps([221,3,220,222]))}),javadoclike:ee("javadoclike",function(){return W(()=>import("./javadoclike-mkbO3bPU.js").then(e=>e.j),__vite__mapDeps([223,3,222]))}),javascript:ee("javascript",function(){return W(()=>import("./javascript-D8bdPg1W.js").then(e=>e.j),__vite__mapDeps([224,3,225]))}),javastacktrace:ee("javastacktrace",function(){return W(()=>import("./javastacktrace-BEiLvDTS.js").then(e=>e.j),__vite__mapDeps([226,3]))}),jexl:ee("jexl",function(){return W(()=>import("./jexl-Dq4zu3re.js").then(e=>e.j),__vite__mapDeps([227,3]))}),jolie:ee("jolie",function(){return W(()=>import("./jolie-DjhI3vQU.js").then(e=>e.j),__vite__mapDeps([228,3]))}),jq:ee("jq",function(){return W(()=>import("./jq-y0r6UCve.js").then(e=>e.j),__vite__mapDeps([229,3]))}),jsExtras:ee("jsExtras",function(){return W(()=>import("./js-extras-DdatupRI.js").then(e=>e.j),__vite__mapDeps([230,3]))}),jsTemplates:ee("jsTemplates",function(){return W(()=>import("./js-templates-APDQyqwU.js").then(e=>e.j),__vite__mapDeps([231,3]))}),jsdoc:ee("jsdoc",function(){return W(()=>import("./jsdoc-BMVln0UX.js").then(e=>e.j),__vite__mapDeps([232,3,222,233]))}),json:ee("json",function(){return W(()=>import("./json-C7Wvd00g.js").then(e=>e.j),__vite__mapDeps([234,3,235]))}),json5:ee("json5",function(){return W(()=>import("./json5-BQ5OVqFd.js").then(e=>e.j),__vite__mapDeps([236,3,235]))}),jsonp:ee("jsonp",function(){return W(()=>import("./jsonp-DfmK3tRq.js").then(e=>e.j),__vite__mapDeps([237,3,235]))}),jsstacktrace:ee("jsstacktrace",function(){return W(()=>import("./jsstacktrace-BBS1miGe.js").then(e=>e.j),__vite__mapDeps([238,3]))}),jsx:ee("jsx",function(){return W(()=>import("./jsx-BxB5tBSS.js").then(e=>e.j),__vite__mapDeps([239,3,240]))}),julia:ee("julia",function(){return W(()=>import("./julia-DCL-sAv1.js").then(e=>e.j),__vite__mapDeps([241,3]))}),keepalived:ee("keepalived",function(){return W(()=>import("./keepalived-BFp4U2_j.js").then(e=>e.k),__vite__mapDeps([242,3]))}),keyman:ee("keyman",function(){return W(()=>import("./keyman-4ZK3jXee.js").then(e=>e.k),__vite__mapDeps([243,3]))}),kotlin:ee("kotlin",function(){return W(()=>import("./kotlin-CidT3Rzf.js").then(e=>e.k),__vite__mapDeps([244,3]))}),kumir:ee("kumir",function(){return W(()=>import("./kumir-DbpomxFH.js").then(e=>e.k),__vite__mapDeps([245,3]))}),kusto:ee("kusto",function(){return W(()=>import("./kusto--6s5VHR2.js").then(e=>e.k),__vite__mapDeps([246,3]))}),latex:ee("latex",function(){return W(()=>import("./latex-BZQc13NX.js").then(e=>e.l),__vite__mapDeps([247,3]))}),latte:ee("latte",function(){return W(()=>import("./latte-z4KihdSk.js").then(e=>e.l),__vite__mapDeps([248,3,163,249]))}),less:ee("less",function(){return W(()=>import("./less-B1nWgZ8O.js").then(e=>e.l),__vite__mapDeps([250,3]))}),lilypond:ee("lilypond",function(){return W(()=>import("./lilypond-OOO7fNYk.js").then(e=>e.l),__vite__mapDeps([251,3,252]))}),liquid:ee("liquid",function(){return W(()=>import("./liquid-C8yOnRY0.js").then(e=>e.l),__vite__mapDeps([253,3,163]))}),lisp:ee("lisp",function(){return W(()=>import("./lisp-B3YmGbJF.js").then(e=>e.l),__vite__mapDeps([254,3]))}),livescript:ee("livescript",function(){return W(()=>import("./livescript-k3PXwrYF.js").then(e=>e.l),__vite__mapDeps([255,3]))}),llvm:ee("llvm",function(){return W(()=>import("./llvm-BayiUiwb.js").then(e=>e.l),__vite__mapDeps([256,3]))}),log:ee("log",function(){return W(()=>import("./log-D4oxAYRq.js").then(e=>e.l),__vite__mapDeps([257,3]))}),lolcode:ee("lolcode",function(){return W(()=>import("./lolcode-DfQcoIRB.js").then(e=>e.l),__vite__mapDeps([258,3]))}),lua:ee("lua",function(){return W(()=>import("./lua-BdyWVstu.js").then(e=>e.l),__vite__mapDeps([259,3,176]))}),magma:ee("magma",function(){return W(()=>import("./magma-BJgzmzVs.js").then(e=>e.m),__vite__mapDeps([260,3]))}),makefile:ee("makefile",function(){return W(()=>import("./makefile-BquElOXz.js").then(e=>e.m),__vite__mapDeps([261,3]))}),markdown:ee("markdown",function(){return W(()=>import("./markdown-BmtxS9dB.js").then(e=>e.m),__vite__mapDeps([262,3]))}),markupTemplating:ee("markupTemplating",function(){return W(()=>import("./markup-templating-MEHSfNjy.js").then(e=>e.m),__vite__mapDeps([263,3,163]))}),markup:ee("markup",function(){return W(()=>import("./markup-8ym62eBH.js").then(e=>e.m),__vite__mapDeps([264,3,265]))}),matlab:ee("matlab",function(){return W(()=>import("./matlab-BZznJhFy.js").then(e=>e.m),__vite__mapDeps([266,3]))}),maxscript:ee("maxscript",function(){return W(()=>import("./maxscript-BoGzeP8k.js").then(e=>e.m),__vite__mapDeps([267,3]))}),mel:ee("mel",function(){return W(()=>import("./mel-SamOtde0.js").then(e=>e.m),__vite__mapDeps([268,3]))}),mermaid:ee("mermaid",function(){return W(()=>import("./mermaid-Cq1MtmYJ.js").then(e=>e.m),__vite__mapDeps([269,3]))}),mizar:ee("mizar",function(){return W(()=>import("./mizar-BHYUy01O.js").then(e=>e.m),__vite__mapDeps([270,3]))}),mongodb:ee("mongodb",function(){return W(()=>import("./mongodb-BLKRbM_W.js").then(e=>e.m),__vite__mapDeps([271,3]))}),monkey:ee("monkey",function(){return W(()=>import("./monkey-DDmZoEhP.js").then(e=>e.m),__vite__mapDeps([272,3]))}),moonscript:ee("moonscript",function(){return W(()=>import("./moonscript-C868Mi3v.js").then(e=>e.m),__vite__mapDeps([273,3]))}),n1ql:ee("n1ql",function(){return W(()=>import("./n1ql-CULzL9-T.js").then(e=>e.n),__vite__mapDeps([274,3]))}),n4js:ee("n4js",function(){return W(()=>import("./n4js-Cncz5RGN.js").then(e=>e.n),__vite__mapDeps([275,3]))}),nand2tetrisHdl:ee("nand2tetrisHdl",function(){return W(()=>import("./nand2tetris-hdl-Dm8FfwIa.js").then(e=>e.n),__vite__mapDeps([276,3]))}),naniscript:ee("naniscript",function(){return W(()=>import("./naniscript-d_OiyB-B.js").then(e=>e.n),__vite__mapDeps([277,3]))}),nasm:ee("nasm",function(){return W(()=>import("./nasm-mcIS3oz5.js").then(e=>e.n),__vite__mapDeps([278,3]))}),neon:ee("neon",function(){return W(()=>import("./neon-KPyUR1lL.js").then(e=>e.n),__vite__mapDeps([279,3]))}),nevod:ee("nevod",function(){return W(()=>import("./nevod-DPSJqefp.js").then(e=>e.n),__vite__mapDeps([280,3]))}),nginx:ee("nginx",function(){return W(()=>import("./nginx-Bh_l73tE.js").then(e=>e.n),__vite__mapDeps([281,3]))}),nim:ee("nim",function(){return W(()=>import("./nim-B3zgzJyb.js").then(e=>e.n),__vite__mapDeps([282,3]))}),nix:ee("nix",function(){return W(()=>import("./nix-BtTqvbOI.js").then(e=>e.n),__vite__mapDeps([283,3]))}),nsis:ee("nsis",function(){return W(()=>import("./nsis-BrX2QPAG.js").then(e=>e.n),__vite__mapDeps([284,3]))}),objectivec:ee("objectivec",function(){return W(()=>import("./objectivec-Cp4zpXKb.js").then(e=>e.o),__vite__mapDeps([285,3,108]))}),ocaml:ee("ocaml",function(){return W(()=>import("./ocaml-BytkBRnR.js").then(e=>e.o),__vite__mapDeps([286,3]))}),opencl:ee("opencl",function(){return W(()=>import("./opencl-Bm65caux.js").then(e=>e.o),__vite__mapDeps([287,3,108]))}),openqasm:ee("openqasm",function(){return W(()=>import("./openqasm-BxubsiVs.js").then(e=>e.o),__vite__mapDeps([288,3]))}),oz:ee("oz",function(){return W(()=>import("./oz-DKdg3vYN.js").then(e=>e.o),__vite__mapDeps([289,3]))}),parigp:ee("parigp",function(){return W(()=>import("./parigp-Diy6_xFh.js").then(e=>e.p),__vite__mapDeps([290,3]))}),parser:ee("parser",function(){return W(()=>import("./parser-C6OhS-v2.js").then(e=>e.p),__vite__mapDeps([291,3]))}),pascal:ee("pascal",function(){return W(()=>import("./pascal-BqGKDRCT.js").then(e=>e.p),__vite__mapDeps([292,3]))}),pascaligo:ee("pascaligo",function(){return W(()=>import("./pascaligo-CmtW8IQx.js").then(e=>e.p),__vite__mapDeps([293,3]))}),pcaxis:ee("pcaxis",function(){return W(()=>import("./pcaxis-ClLKj7xJ.js").then(e=>e.p),__vite__mapDeps([294,3]))}),peoplecode:ee("peoplecode",function(){return W(()=>import("./peoplecode-IXrNW5jZ.js").then(e=>e.p),__vite__mapDeps([295,3]))}),perl:ee("perl",function(){return W(()=>import("./perl-Bx3Alua_.js").then(e=>e.p),__vite__mapDeps([296,3]))}),phpExtras:ee("phpExtras",function(){return W(()=>import("./php-extras-B6CicCBq.js").then(e=>e.p),__vite__mapDeps([297,3,249,163]))}),php:ee("php",function(){return W(()=>import("./php-z0EdG6WV.js").then(e=>e.p),__vite__mapDeps([298,3,249,163]))}),phpdoc:ee("phpdoc",function(){return W(()=>import("./phpdoc-DBJXm2Vv.js").then(e=>e.p),__vite__mapDeps([299,3,249,163,222]))}),plsql:ee("plsql",function(){return W(()=>import("./plsql-Si0y6O4D.js").then(e=>e.p),__vite__mapDeps([300,3,102]))}),powerquery:ee("powerquery",function(){return W(()=>import("./powerquery--sGMe_kf.js").then(e=>e.p),__vite__mapDeps([301,3]))}),powershell:ee("powershell",function(){return W(()=>import("./powershell-D_yLhDJY.js").then(e=>e.p),__vite__mapDeps([302,3]))}),processing:ee("processing",function(){return W(()=>import("./processing-CrQy10cW.js").then(e=>e.p),__vite__mapDeps([303,3]))}),prolog:ee("prolog",function(){return W(()=>import("./prolog-D2jFgB0n.js").then(e=>e.p),__vite__mapDeps([304,3]))}),promql:ee("promql",function(){return W(()=>import("./promql-CrZPKxvU.js").then(e=>e.p),__vite__mapDeps([305,3]))}),properties:ee("properties",function(){return W(()=>import("./properties-D6pZXLPx.js").then(e=>e.p),__vite__mapDeps([306,3]))}),protobuf:ee("protobuf",function(){return W(()=>import("./protobuf-ZXfFCGcu.js").then(e=>e.p),__vite__mapDeps([307,3]))}),psl:ee("psl",function(){return W(()=>import("./psl-C386MmW5.js").then(e=>e.p),__vite__mapDeps([308,3]))}),pug:ee("pug",function(){return W(()=>import("./pug-bZC2AKHn.js").then(e=>e.p),__vite__mapDeps([309,3]))}),puppet:ee("puppet",function(){return W(()=>import("./puppet-CqAggpEE.js").then(e=>e.p),__vite__mapDeps([310,3]))}),pure:ee("pure",function(){return W(()=>import("./pure-kS1_fNk2.js").then(e=>e.p),__vite__mapDeps([311,3]))}),purebasic:ee("purebasic",function(){return W(()=>import("./purebasic-BfcvRshi.js").then(e=>e.p),__vite__mapDeps([312,3]))}),purescript:ee("purescript",function(){return W(()=>import("./purescript-BfcMXDuj.js").then(e=>e.p),__vite__mapDeps([313,3,201]))}),python:ee("python",function(){return W(()=>import("./python-DSvE31xq.js").then(e=>e.p),__vite__mapDeps([314,3]))}),q:ee("q",function(){return W(()=>import("./q-DeDIpVbE.js").then(e=>e.q),__vite__mapDeps([315,3]))}),qml:ee("qml",function(){return W(()=>import("./qml-DFWwROYn.js").then(e=>e.q),__vite__mapDeps([316,3]))}),qore:ee("qore",function(){return W(()=>import("./qore-CP5ZUe60.js").then(e=>e.q),__vite__mapDeps([317,3]))}),qsharp:ee("qsharp",function(){return W(()=>import("./qsharp-B20Vmn28.js").then(e=>e.q),__vite__mapDeps([318,3]))}),r:ee("r",function(){return W(()=>import("./r-D15T8WxR.js").then(e=>e.r),__vite__mapDeps([319,3]))}),racket:ee("racket",function(){return W(()=>import("./racket-D10txZAJ.js").then(e=>e.r),__vite__mapDeps([320,3,252]))}),reason:ee("reason",function(){return W(()=>import("./reason-6ANFUMu6.js").then(e=>e.r),__vite__mapDeps([321,3]))}),regex:ee("regex",function(){return W(()=>import("./regex-5Q_CxBSL.js").then(e=>e.r),__vite__mapDeps([322,3]))}),rego:ee("rego",function(){return W(()=>import("./rego-C_py_8jh.js").then(e=>e.r),__vite__mapDeps([323,3]))}),renpy:ee("renpy",function(){return W(()=>import("./renpy-Jf0u-xhA.js").then(e=>e.r),__vite__mapDeps([324,3]))}),rest:ee("rest",function(){return W(()=>import("./rest-DR5n3nNA.js").then(e=>e.r),__vite__mapDeps([325,3]))}),rip:ee("rip",function(){return W(()=>import("./rip-CBz-xDhl.js").then(e=>e.r),__vite__mapDeps([326,3]))}),roboconf:ee("roboconf",function(){return W(()=>import("./roboconf-CP23M5ej.js").then(e=>e.r),__vite__mapDeps([327,3]))}),robotframework:ee("robotframework",function(){return W(()=>import("./robotframework-GtZKJarU.js").then(e=>e.r),__vite__mapDeps([328,3]))}),ruby:ee("ruby",function(){return W(()=>import("./ruby-CcBPo7Jy.js").then(e=>e.r),__vite__mapDeps([329,3,147]))}),rust:ee("rust",function(){return W(()=>import("./rust-C-Oi6wFX.js").then(e=>e.r),__vite__mapDeps([330,3]))}),sas:ee("sas",function(){return W(()=>import("./sas-BuvlhEUw.js").then(e=>e.s),__vite__mapDeps([331,3]))}),sass:ee("sass",function(){return W(()=>import("./sass-3cExDpeK.js").then(e=>e.s),__vite__mapDeps([332,3]))}),scala:ee("scala",function(){return W(()=>import("./scala-BhR1Bt8C.js").then(e=>e.s),__vite__mapDeps([333,3,220]))}),scheme:ee("scheme",function(){return W(()=>import("./scheme-Bi_suX5X.js").then(e=>e.s),__vite__mapDeps([334,3,252]))}),scss:ee("scss",function(){return W(()=>import("./scss-61yBGSQ7.js").then(e=>e.s),__vite__mapDeps([335,3]))}),shellSession:ee("shellSession",function(){return W(()=>import("./shell-session-BBGAi-UP.js").then(e=>e.s),__vite__mapDeps([336,3,120]))}),smali:ee("smali",function(){return W(()=>import("./smali-Yz_2llmC.js").then(e=>e.s),__vite__mapDeps([337,3]))}),smalltalk:ee("smalltalk",function(){return W(()=>import("./smalltalk-DTs1iMH7.js").then(e=>e.s),__vite__mapDeps([338,3]))}),smarty:ee("smarty",function(){return W(()=>import("./smarty-ClvO9UTI.js").then(e=>e.s),__vite__mapDeps([339,3,163]))}),sml:ee("sml",function(){return W(()=>import("./sml-CcDK_1J6.js").then(e=>e.s),__vite__mapDeps([340,3]))}),solidity:ee("solidity",function(){return W(()=>import("./solidity-BDCwOulF.js").then(e=>e.s),__vite__mapDeps([341,3]))}),solutionFile:ee("solutionFile",function(){return W(()=>import("./solution-file-BtnOKdXg.js").then(e=>e.s),__vite__mapDeps([342,3]))}),soy:ee("soy",function(){return W(()=>import("./soy---ubiTwB.js").then(e=>e.s),__vite__mapDeps([343,3,163]))}),sparql:ee("sparql",function(){return W(()=>import("./sparql-ZoExV8Jl.js").then(e=>e.s),__vite__mapDeps([344,3,345]))}),splunkSpl:ee("splunkSpl",function(){return W(()=>import("./splunk-spl-iRzlUe8w.js").then(e=>e.s),__vite__mapDeps([346,3]))}),sqf:ee("sqf",function(){return W(()=>import("./sqf-CJ2QA-ii.js").then(e=>e.s),__vite__mapDeps([347,3]))}),sql:ee("sql",function(){return W(()=>import("./sql-Sn6gvY4u.js").then(e=>e.s),__vite__mapDeps([348,3,102]))}),squirrel:ee("squirrel",function(){return W(()=>import("./squirrel-sSA_31vm.js").then(e=>e.s),__vite__mapDeps([349,3]))}),stan:ee("stan",function(){return W(()=>import("./stan-DxPzeVp4.js").then(e=>e.s),__vite__mapDeps([350,3]))}),stylus:ee("stylus",function(){return W(()=>import("./stylus-Y923euvO.js").then(e=>e.s),__vite__mapDeps([351,3]))}),swift:ee("swift",function(){return W(()=>import("./swift-Bb-oPOvD.js").then(e=>e.s),__vite__mapDeps([352,3]))}),systemd:ee("systemd",function(){return W(()=>import("./systemd-BCxsgci2.js").then(e=>e.s),__vite__mapDeps([353,3]))}),t4Cs:ee("t4Cs",function(){return W(()=>import("./t4-cs-DA7j0B_A.js").then(e=>e.t),__vite__mapDeps([354,3,355,114]))}),t4Templating:ee("t4Templating",function(){return W(()=>import("./t4-templating-BHHNbRso.js").then(e=>e.t),__vite__mapDeps([356,3,355]))}),t4Vb:ee("t4Vb",function(){return W(()=>import("./t4-vb---CsqfA0.js").then(e=>e.t),__vite__mapDeps([357,3,355,358,122]))}),tap:ee("tap",function(){return W(()=>import("./tap-hjaObkRg.js").then(e=>e.t),__vite__mapDeps([359,3,360]))}),tcl:ee("tcl",function(){return W(()=>import("./tcl-BGu_P4hh.js").then(e=>e.t),__vite__mapDeps([361,3]))}),textile:ee("textile",function(){return W(()=>import("./textile-yzL6lAdU.js").then(e=>e.t),__vite__mapDeps([362,3]))}),toml:ee("toml",function(){return W(()=>import("./toml-C_zmuUNJ.js").then(e=>e.t),__vite__mapDeps([363,3]))}),tremor:ee("tremor",function(){return W(()=>import("./tremor-B2P1CaNJ.js").then(e=>e.t),__vite__mapDeps([364,3]))}),tsx:ee("tsx",function(){return W(()=>import("./tsx-CrAqIHZR.js").then(e=>e.t),__vite__mapDeps([365,3,240,233]))}),tt2:ee("tt2",function(){return W(()=>import("./tt2-BIhy1o3M.js").then(e=>e.t),__vite__mapDeps([366,3,163]))}),turtle:ee("turtle",function(){return W(()=>import("./turtle-BpiUfkQV.js").then(e=>e.t),__vite__mapDeps([367,3,345]))}),twig:ee("twig",function(){return W(()=>import("./twig-Bj46vbhb.js").then(e=>e.t),__vite__mapDeps([368,3,163]))}),typescript:ee("typescript",function(){return W(()=>import("./typescript-CcuCeyZ9.js").then(e=>e.t),__vite__mapDeps([369,3,233]))}),typoscript:ee("typoscript",function(){return W(()=>import("./typoscript-XVddiCoS.js").then(e=>e.t),__vite__mapDeps([370,3]))}),unrealscript:ee("unrealscript",function(){return W(()=>import("./unrealscript-CTdn5ouP.js").then(e=>e.u),__vite__mapDeps([371,3]))}),uorazor:ee("uorazor",function(){return W(()=>import("./uorazor-XVi1cswe.js").then(e=>e.u),__vite__mapDeps([372,3]))}),uri:ee("uri",function(){return W(()=>import("./uri-kkDNgWls.js").then(e=>e.u),__vite__mapDeps([373,3]))}),v:ee("v",function(){return W(()=>import("./v-BdmvWAaf.js").then(e=>e.v),__vite__mapDeps([374,3]))}),vala:ee("vala",function(){return W(()=>import("./vala-DhMt_hFC.js").then(e=>e.v),__vite__mapDeps([375,3]))}),vbnet:ee("vbnet",function(){return W(()=>import("./vbnet-Bfsm6Ky5.js").then(e=>e.v),__vite__mapDeps([376,3,358,122]))}),velocity:ee("velocity",function(){return W(()=>import("./velocity-ZXeY-Xjt.js").then(e=>e.v),__vite__mapDeps([377,3]))}),verilog:ee("verilog",function(){return W(()=>import("./verilog-DMJx1jeI.js").then(e=>e.v),__vite__mapDeps([378,3]))}),vhdl:ee("vhdl",function(){return W(()=>import("./vhdl-HO1_F4N6.js").then(e=>e.v),__vite__mapDeps([379,3]))}),vim:ee("vim",function(){return W(()=>import("./vim-Bq6xuz33.js").then(e=>e.v),__vite__mapDeps([380,3]))}),visualBasic:ee("visualBasic",function(){return W(()=>import("./visual-basic-xUFbJrMu.js").then(e=>e.v),__vite__mapDeps([381,3]))}),warpscript:ee("warpscript",function(){return W(()=>import("./warpscript-CTI-0qmZ.js").then(e=>e.w),__vite__mapDeps([382,3]))}),wasm:ee("wasm",function(){return W(()=>import("./wasm-apYZgrxE.js").then(e=>e.w),__vite__mapDeps([383,3]))}),webIdl:ee("webIdl",function(){return W(()=>import("./web-idl-CvuW1Ax4.js").then(e=>e.w),__vite__mapDeps([384,3]))}),wiki:ee("wiki",function(){return W(()=>import("./wiki-CDqCKzvk.js").then(e=>e.w),__vite__mapDeps([385,3]))}),wolfram:ee("wolfram",function(){return W(()=>import("./wolfram-lt6nI2d0.js").then(e=>e.w),__vite__mapDeps([386,3]))}),wren:ee("wren",function(){return W(()=>import("./wren-C5o3abeY.js").then(e=>e.w),__vite__mapDeps([387,3]))}),xeora:ee("xeora",function(){return W(()=>import("./xeora-CWjUBVNJ.js").then(e=>e.x),__vite__mapDeps([388,3]))}),xmlDoc:ee("xmlDoc",function(){return W(()=>import("./xml-doc-CqNWXjka.js").then(e=>e.x),__vite__mapDeps([389,3]))}),xojo:ee("xojo",function(){return W(()=>import("./xojo-DKDCIMmn.js").then(e=>e.x),__vite__mapDeps([390,3]))}),xquery:ee("xquery",function(){return W(()=>import("./xquery-PrYwilw_.js").then(e=>e.x),__vite__mapDeps([391,3]))}),yaml:ee("yaml",function(){return W(()=>import("./yaml-MSoHumpO.js").then(e=>e.y),__vite__mapDeps([392,3,360]))}),yang:ee("yang",function(){return W(()=>import("./yang-DVR1haGh.js").then(e=>e.y),__vite__mapDeps([393,3]))}),zig:ee("zig",function(){return W(()=>import("./zig-Bc_at87R.js").then(e=>e.z),__vite__mapDeps([394,3]))})},Qge=Kge({loader:function(){return W(()=>import("./core-DmbpZ4qJ.js").then(t=>t.c),__vite__mapDeps([395,3,265,153,138,225])).then(function(t){return t.default||t})},isLanguageRegistered:function(t,n){return t.registered(n)},languageLoaders:Yge,registerLanguage:function(t,n,r){return t.register(r)}}),Xge="light";function Zge(e){return{mode:Xge,...e?.theme}}function qt(e){var t=e;return function(n){var r=Zge(n);let s=r.mode;return t[s]}}const Jge=e=>{const t={theme:e};return{lineNumberColor:qt({light:"#383a42",dark:"#abb2bf"})(t),lineNumberBgColor:qt({light:"#fafafa",dark:"#282c34"})(t),backgroundColor:qt({light:"#fafafa",dark:"#282c34"})(t),textColor:qt({light:"#383a42",dark:"#abb2bf"})(t),substringColor:qt({light:"#e45649",dark:"#e06c75"})(t),keywordColor:qt({light:"#a626a4",dark:"#c678dd"})(t),attributeColor:qt({light:"#50a14f",dark:"#98c379"})(t),selectorAttributeColor:qt({light:"#e45649",dark:"#e06c75"})(t),docTagColor:qt({light:"#a626a4",dark:"#c678dd"})(t),nameColor:qt({light:"#e45649",dark:"#e06c75"})(t),builtInColor:qt({light:"#c18401",dark:"#e6c07b"})(t),literalColor:qt({light:"#0184bb",dark:"#56b6c2"})(t),bulletColor:qt({light:"#4078f2",dark:"#61aeee"})(t),codeColor:qt({light:"#383a42",dark:"#abb2bf"})(t),additionColor:qt({light:"#50a14f",dark:"#98c379"})(t),regexpColor:qt({light:"#50a14f",dark:"#98c379"})(t),symbolColor:qt({light:"#4078f2",dark:"#61aeee"})(t),variableColor:qt({light:"#986801",dark:"#d19a66"})(t),templateVariableColor:qt({light:"#986801",dark:"#d19a66"})(t),linkColor:qt({light:"#4078f2",dark:"#61aeee"})(t),selectorClassColor:qt({light:"#986801",dark:"#d19a66"})(t),typeColor:qt({light:"#986801",dark:"#d19a66"})(t),stringColor:qt({light:"#50a14f",dark:"#98c379"})(t),selectorIdColor:qt({light:"#4078f2",dark:"#61aeee"})(t),quoteColor:qt({light:"#a0a1a7",dark:"#5c6370"})(t),templateTagColor:qt({light:"#383a42",dark:"#abb2bf"})(t),deletionColor:qt({light:"#e45649",dark:"#e06c75"})(t),titleColor:qt({light:"#4078f2",dark:"#61aeee"})(t),sectionColor:qt({light:"#e45649",dark:"#e06c75"})(t),commentColor:qt({light:"#a0a1a7",dark:"#5c6370"})(t),metaKeywordColor:qt({light:"#383a42",dark:"#abb2bf"})(t),metaColor:qt({light:"#4078f2",dark:"#61aeee"})(t),functionColor:qt({light:"#383a42",dark:"#abb2bf"})(t),numberColor:qt({light:"#986801",dark:"#d19a66"})(t)}},og="inherit",ME="inherit",e0e={fontSize:ME,fontFamily:og,lineHeight:20/12,padding:8},t0e=e=>({fontSize:ME,lineHeight:20/14,color:e.lineNumberColor,backgroundColor:e.lineNumberBgColor,flexShrink:0,padding:8,textAlign:"right",userSelect:"none"}),WL=e=>({key:{color:e.keywordColor,fontWeight:"bolder"},keyword:{color:e.keywordColor,fontWeight:"bolder"},"attr-name":{color:e.attributeColor},selector:{color:e.selectorTagColor},comment:{color:e.commentColor,fontFamily:og,fontStyle:"italic"},"block-comment":{color:e.commentColor,fontFamily:og,fontStyle:"italic"},"function-name":{color:e.sectionColor},"class-name":{color:e.sectionColor},doctype:{color:e.docTagColor},substr:{color:e.substringColor},namespace:{color:e.nameColor},builtin:{color:e.builtInColor},entity:{color:e.literalColor},bullet:{color:e.bulletColor},code:{color:e.codeColor},addition:{color:e.additionColor},regex:{color:e.regexpColor},symbol:{color:e.symbolColor},variable:{color:e.variableColor},url:{color:e.linkColor},"selector-attr":{color:e.selectorAttributeColor},"selector-pseudo":{color:e.selectorPseudoColor},type:{color:e.typeColor},string:{color:e.stringColor},quote:{color:e.quoteColor},tag:{color:e.templateTagColor},deletion:{color:e.deletionColor},title:{color:e.titleColor},section:{color:e.sectionColor},"meta-keyword":{color:e.metaKeywordColor},meta:{color:e.metaColor},italic:{fontStyle:"italic"},bold:{fontWeight:"bolder"},function:{color:e.functionColor},number:{color:e.numberColor}}),KL=e=>({fontSize:ME,fontFamily:og,background:e.backgroundColor,color:e.textColor,borderRadius:3,display:"flex",lineHeight:20/14,overflowX:"auto",whiteSpace:"pre"}),n0e=e=>({'pre[class*="language-"]':KL(e),...WL(e)}),r0e=e=>({'pre[class*="language-"]':{...KL(e),padding:"2px 4px",display:"inline",whiteSpace:"pre-wrap"},...WL(e)});function YL(e={mode:"light"}){const t={...Jge(e),...e};return{lineNumberContainerStyle:t0e(t),codeBlockStyle:n0e(t),inlineCodeStyle:r0e(t),codeContainerStyle:e0e}}const s0e=Object.freeze([{name:"PHP",alias:["php","php3","php4","php5"],value:"php"},{name:"Java",alias:["java"],value:"java"},{name:"CSharp",alias:["csharp","c#","cs"],value:"csharp"},{name:"Python",alias:["python","py"],value:"python"},{name:"JavaScript",alias:["javascript","js"],value:"javascript"},{name:"XML",alias:["xml"],value:"xml"},{name:"HTML",alias:["html","htm"],value:"markup"},{name:"C++",alias:["c++","cpp","clike"],value:"cpp"},{name:"Ruby",alias:["ruby","rb","duby"],value:"ruby"},{name:"Objective-C",alias:["objective-c","objectivec","obj-c","objc"],value:"objectivec"},{name:"C",alias:["c"],value:"cpp"},{name:"Swift",alias:["swift"],value:"swift"},{name:"TeX",alias:["tex","latex"],value:"tex"},{name:"Shell",alias:["shell","sh","ksh","zsh"],value:"bash"},{name:"Scala",alias:["scala"],value:"scala"},{name:"Go",alias:["go"],value:"go"},{name:"ActionScript",alias:["actionscript","actionscript3","as"],value:"actionscript"},{name:"ColdFusion",alias:["coldfusion"],value:"xml"},{name:"JavaFX",alias:["javafx","jfx"],value:"java"},{name:"VbNet",alias:["vbnet","vb.net"],value:"vbnet"},{name:"JSON",alias:["json"],value:"json"},{name:"MATLAB",alias:["matlab"],value:"matlab"},{name:"Groovy",alias:["groovy"],value:"groovy"},{name:"SQL",alias:["sql","postgresql","postgres","plpgsql","psql","postgresql-console","postgres-console","tsql","t-sql","mysql","sqlite"],value:"sql"},{name:"R",alias:["r"],value:"r"},{name:"Perl",alias:["perl","pl"],value:"perl"},{name:"Lua",alias:["lua"],value:"lua"},{name:"Delphi",alias:["delphi","pas","pascal","objectpascal"],value:"delphi"},{name:"XML",alias:["xml"],value:"xml"},{name:"TypeScript",alias:["typescript","ts","tsx"],value:"typescript"},{name:"CoffeeScript",alias:["coffeescript","coffee-script","coffee"],value:"coffeescript"},{name:"Haskell",alias:["haskell","hs"],value:"haskell"},{name:"Puppet",alias:["puppet"],value:"puppet"},{name:"Arduino",alias:["arduino"],value:"arduino"},{name:"Fortran",alias:["fortran"],value:"fortran"},{name:"Erlang",alias:["erlang","erl"],value:"erlang"},{name:"PowerShell",alias:["powershell","posh","ps1","psm1"],value:"powershell"},{name:"Haxe",alias:["haxe","hx","hxsl"],value:"haxe"},{name:"Elixir",alias:["elixir","ex","exs"],value:"elixir"},{name:"Verilog",alias:["verilog","v"],value:"verilog"},{name:"Rust",alias:["rust"],value:"rust"},{name:"VHDL",alias:["vhdl"],value:"vhdl"},{name:"Sass",alias:["sass"],value:"less"},{name:"OCaml",alias:["ocaml"],value:"ocaml"},{name:"Dart",alias:["dart"],value:"dart"},{name:"CSS",alias:["css"],value:"css"},{name:"reStructuredText",alias:["restructuredtext","rst","rest"],value:"rest"},{name:"ObjectPascal",alias:["objectpascal"],value:"delphi"},{name:"Kotlin",alias:["kotlin"],value:"kotlin"},{name:"D",alias:["d"],value:"d"},{name:"Octave",alias:["octave"],value:"matlab"},{name:"QML",alias:["qbs","qml"],value:"qml"},{name:"Prolog",alias:["prolog"],value:"prolog"},{name:"FoxPro",alias:["foxpro","vfp","clipper","xbase"],value:"vbnet"},{name:"Scheme",alias:["scheme","scm"],value:"scheme"},{name:"CUDA",alias:["cuda","cu"],value:"cpp"},{name:"Julia",alias:["julia","jl"],value:"julia"},{name:"Racket",alias:["racket","rkt"],value:"lisp"},{name:"Ada",alias:["ada","ada95","ada2005"],value:"ada"},{name:"Tcl",alias:["tcl"],value:"tcl"},{name:"Mathematica",alias:["mathematica","mma","nb"],value:"mathematica"},{name:"Autoit",alias:["autoit"],value:"autoit"},{name:"StandardML",alias:["standardmL","sml","standardml"],value:"sml"},{name:"Objective-J",alias:["objective-j","objectivej","obj-j","objj"],value:"objectivec"},{name:"Smalltalk",alias:["smalltalk","squeak","st"],value:"smalltalk"},{name:"Vala",alias:["vala","vapi"],value:"vala"},{name:"ABAP",alias:["abap"],value:"sql"},{name:"LiveScript",alias:["livescript","live-script"],value:"livescript"},{name:"XQuery",alias:["xquery","xqy","xq","xql","xqm"],value:"xquery"},{name:"PlainText",alias:["text","plaintext"],value:"text"},{name:"Yaml",alias:["yaml","yml"],value:"yaml"},{name:"GraphQL",alias:["graphql","gql"],value:"graphql"}]),a0e=e=>{if(!e)return"";const t=s0e.find(n=>n.name===e||n.alias.includes(e));return t?t.value:e||"text"};class QL extends f.PureComponent{constructor(){super(...arguments),this._isMounted=!1}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}getLineOpacity(t){if(!this.props.highlight)return 1;const n=this.props.highlight.split(",").map(r=>{if(r.indexOf("-")>0){const[s,a]=r.split("-").map(Number).sort();return Array(a+1).fill(void 0).map((o,i)=>i).slice(s,a+1)}return Number(r)}).reduce((r,s)=>r.concat(s),[]);return n.length===0||n.includes(t)?1:.3}render(){const{inlineCodeStyle:t}=YL(this.props.theme),r={language:a0e(this.props.language),PreTag:this.props.preTag,style:this.props.codeStyle||t,showLineNumbers:this.props.showLineNumbers,startingLineNumber:this.props.startingLineNumber,codeTagProps:this.props.codeTagProps,wrapLongLines:this.props.wrapLongLines};return A.createElement(Qge,Object.assign({},r,{wrapLines:!!this.props.highlight,customStyle:this.props.customStyle,lineProps:s=>({style:{opacity:this.getLineOpacity(s),...this.props.lineNumberContainerStyle}})}),this.props.text)}}QL.defaultProps={theme:{},showLineNumbers:!1,wrapLongLines:!1,startingLineNumber:1,lineNumberContainerStyle:{},codeTagProps:{},preTag:"span",highlight:"",customStyle:{}};const XL="text";let TE=class extends f.PureComponent{constructor(){super(...arguments),this._isMounted=!1,this.handleCopy=t=>{const n=t.nativeEvent.clipboardData;if(n){t.preventDefault();const r=window.getSelection();if(r===null)return;const s=r.toString(),a=`<!doctype html><html><head></head><body><pre>${s}</pre></body></html>`;n.clearData(),n.setData("text/html",a),n.setData("text/plain",s)}}}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}render(){var t,n,r,s;const{lineNumberContainerStyle:a,codeBlockStyle:o,codeContainerStyle:i}=YL(this.props.theme),c={language:this.props.language||XL,codeStyle:{...o,...(t=this.props)===null||t===void 0?void 0:t.codeBlockStyle},customStyle:(n=this.props)===null||n===void 0?void 0:n.customStyle,showLineNumbers:this.props.showLineNumbers,startingLineNumber:this.props.startingLineNumber,codeTagProps:{style:{...i,...(r=this.props)===null||r===void 0?void 0:r.codeContainerStyle}},lineNumberContainerStyle:{...a,...(s=this.props)===null||s===void 0?void 0:s.lineNumberContainerStyle},text:this.props.text.toString(),highlight:this.props.highlight,wrapLongLines:this.props.wrapLongLines};return A.createElement(QL,Object.assign({},c))}};TE.displayName="CodeBlock";TE.defaultProps={text:"",showLineNumbers:!0,wrapLongLines:!1,startingLineNumber:1,language:XL,theme:{},highlight:"",lineNumberContainerStyle:{},customStyle:{},codeBlockStyle:{}};var o0e=_ge(TE);fy.button`
  position: absolute;
  top: 0.5em;
  right: 0.75em;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  align-items: center;
  background: ${e=>e.theme.backgroundColor};
  margin-top: 0.15rem;
  border-radius: 0.25rem;
  max-height: 2rem;
  max-width: 2rem;
  padding: 0.25rem;
  &:hover {
    opacity: ${e=>e.copied?1:.5};
  }
  &:focus {
    outline: none;
    opacity: 1;
  }
  .icon {
    width: 1rem;
    height: 1rem;
  }
`;fy.div`
  position: relative;
  background: ${e=>e.theme.backgroundColor};
  border-radius: 0.25rem;
  padding: ${e=>e.codeBlock?"0.25rem 0.5rem 0.25rem 0.25rem":"0.25rem"};
`;fy.div`
    position: relative;
    width: ${({width:e})=>e||"auto"};
    max-width: 100%;
    padding: 8pt;
    padding-right: calc(2 * 16pt);
    color: ${({style:e})=>e.color};
    background-color: ${({style:e})=>e.bgColor};
    border: 1px solid ${({style:e})=>e.border};
    border-radius: 5px;
  pre {
    margin: 0;
    padding: 0;
    border: none;
    background-color: transparent;
    color: ${({style:e})=>e.color};
    font-size: 0.8125rem;
  }
  pre::before {
    content: '$ ';
    user-select: none;
  }
  pre :global(*) {
    margin: 0;
    padding: 0;
    font-size: inherit;
    color: inherit;
  }
  .copy {
    position: absolute;
    right: 0;
    top: -2px;
    transform: translateY(50%);
    background-color: ${({style:e})=>e.bgColor};
    display: inline-flex;
    justify-content: center;
    align-items: center;
    width: calc(2 * 16pt);
    color: inherit;
    transition: opacity 0.2s ease 0s;
    border-radius: 5px;
    cursor: pointer;
    user-select: none;
  }
  .copy:hover {
    opacity: 0.7;
  }
`;var i0e={lineNumberColor:"#c5c8c6",lineNumberBgColor:"#1d1f21",backgroundColor:"#1d1f21",textColor:"#c5c8c6",substringColor:"#c5c8c6",keywordColor:"#b294bb",attributeColor:"#f0c674",selectorAttributeColor:"#b294bb",docTagColor:"#c5c8c6",nameColor:"#cc6666",builtInColor:"#de935f",literalColor:"#de935f",bulletColor:"#b5bd68",codeColor:"#c5c8c6",additionColor:"#b5bd68",regexpColor:"#cc6666",symbolColor:"#b5bd68",variableColor:"#cc6666",templateVariableColor:"#cc6666",linkColor:"#de935f",selectorClassColor:"#cc6666",typeColor:"#de935f",stringColor:"#b5bd68",selectorIdColor:"#cc6666",quoteColor:"#969896",templateTagColor:"#c5c8c6",deletionColor:"#cc6666",titleColor:"#81a2be",sectionColor:"#81a2be",commentColor:"#969896",metaKeywordColor:"#c5c8c6",metaColor:"#de935f",functionColor:"#c5c8c6",numberColor:"#de935f"},l0e={lineNumberColor:"#4d4d4c",lineNumberBgColor:"white",backgroundColor:"white",textColor:"#4d4d4c",substringColor:"#4d4d4c",keywordColor:"#8959a8",attributeColor:"#eab700",selectorAttributeColor:"#8959a8",docTagColor:"#4d4d4c",nameColor:"#c82829",builtInColor:"#f5871f",literalColor:"#f5871f",bulletColor:"#718c00",codeColor:"#4d4d4c",additionColor:"#718c00",regexpColor:"#c82829",symbolColor:"#718c00",variableColor:"#c82829",templateVariableColor:"#c82829",linkColor:"#f5871f",selectorClassColor:"#c82829",typeColor:"#f5871f",stringColor:"#718c00",selectorIdColor:"#c82829",quoteColor:"#8e908c",templateTagColor:"#4d4d4c",deletionColor:"#c82829",titleColor:"#4271ae",sectionColor:"#4271ae",commentColor:"#8e908c",metaKeywordColor:"#4d4d4c",metaColor:"#f5871f",functionColor:"#4d4d4c",numberColor:"#f5871f"};const hl=A.memo(function(t){const{children:n,className:r,codeBlockProps:s,hideTools:a,trackEvent:o,translations:i,codeBlockStyles:c,...u}=t,{language:d="text",showLineNumbers:m,text:p,theme:h,wrapLongLines:g,...y}=s,{colorScheme:b}=Cs(),x=f.useMemo(()=>{let w;return h?w=h:(w=b==="dark"?i0e:l0e,w.backgroundColor="transparent",w.lineNumberBgColor="transparent"),w},[b,h]),_=z("codeWrapper text-light selection:text-super selection:bg-super/10 my-md relative flex flex-col rounded-lg font-mono text-sm font-normal visRefresh2026Fonts:font-medium",r),v=f.useCallback(()=>{navigator.clipboard.writeText(String(n)),o?.("click code block copy",{language:d??"text"})},[n,d,o]),C=f.useMemo(()=>({"--scrollbar-thumb":"oklch(var(--foreground-color) / 0.15)","--scrollbar-track":"transparent",scrollbarWidth:"thin",scrollbarColor:"var(--scrollbar-thumb) var(--scrollbar-track)",...c}),[c]);return l.jsxs("div",{className:_,...u,children:[l.jsx("div",{className:z("translate-y-xs -translate-x-xs bottom-xl mb-xl","flex h-0 items-start justify-end","sm:sticky sm:top-xs"),children:!a&&l.jsx(Y,{variant:"background",className:"overflow-hidden rounded-full",children:l.jsx(Y,{variant:"subtler",children:l.jsx(pt,{icon:D("copy"),size:"small",pill:!0,clickFeedback:!0,onClick:v,testId:"copy-code-button",ariaLabel:i?.copy,toolTip:i?.copy})})})}),l.jsxs("div",{className:"-mt-xl",children:[d&&!a&&l.jsx("div",{children:l.jsx("div",{"data-testid":"code-language-indicator",className:"text-quiet bg-subtle py-xs px-sm inline-block rounded-br rounded-tl-lg text-xs font-thin",children:d})}),l.jsx("div",{children:l.jsx(o0e,{as:void 0,forwardedAs:void 0,language:d,showLineNumbers:!1,text:String(n),theme:x,wrapLongLines:!0,customStyle:C,...y})})]})]})}),c0e=({step:e})=>{const{$t:t}=Q(),[n,r]=f.useState(!1),s=e.content,a=e.output_content,o=s.formatted_connection_type,i=Yne(s.connection_type)??void 0,c=f.useCallback(()=>{r(d=>!d)},[]),u=f.useMemo(()=>{if(a?.status==="success"){const d=a.files?.length||0;return d>0?t({id:"0Lk4DEgLnN",defaultMessage:"{count, plural, one {Found # file} other {Found # files}}"},{count:d}):t({id:"zreH4pXxYz",defaultMessage:"No files found"})}return a?.status==="timeout"?t({id:"8X7GfQbFUN",defaultMessage:"Search timed out"}):a?.status==="error"?t({id:"5dVh8D0hlq",defaultMessage:"Search failed"}):a?.status==="skipped"?null:t({id:"NNQzoiiDEK",defaultMessage:"Searching..."})},[t,a?.status,a?.files?.length]);return l.jsxs(Y,{className:"p-sm hover:bg-raised grid grid-cols-[max-content_1fr_max-content] gap-x-2 rounded-lg border pl-4",variant:n?"raised":void 0,children:[l.jsxs("div",{className:"col-span-full grid grid-cols-subgrid items-center cursor-pointer",onClick:c,children:[l.jsx(Jw,{serverName:o,iconUrl:i,size:"sm"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(B,{variant:"smallBold",children:o}),l.jsx(B,{variant:"tinyMono",className:"text-subtle",children:u})]}),l.jsx(at,{variant:"text",size:"small",rounded:!0,icon:n?D("chevron-down"):D("chevron-right"),"aria-label":n?"Collapse":"Expand"})]}),l.jsx("div",{className:"col-start-2 col-end-4 min-w-0",children:l.jsx(u0e,{isExpanded:n,inputContent:s,outputContent:a})})]})},u0e=({isExpanded:e,inputContent:t,outputContent:n})=>{const r=n&&n.status!=="skipped";return l.jsx(ba,{mode:"popLayout",initial:!1,transition:{duration:.2,ease:rr},children:e&&l.jsx(bs,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},transition:{duration:.15,ease:rr},children:l.jsx("div",{className:"mt-sm",children:l.jsx(dm,{maxHeight:400,autoScroll:!1,scrollContainerClassName:"scrollbar-subtle !pl-0",showTopGradient:!1,showBottomGradient:!1,children:l.jsxs("div",{className:"flex flex-col gap-2 pt-1",children:[l.jsxs(Y,{className:"rounded-lg",variant:"subtler",children:[l.jsx(B,{variant:"tiny",className:"p-md pb-0",children:l.jsx(be,{defaultMessage:"Request",id:"p1P+hQq6tY"})}),l.jsx(hl,{className:"p-sm !my-0 pt-0 text-xs",codeBlockProps:{language:"json"},hideTools:!0,children:tg({connection_type:t.connection_type,queries:t.queries,max_results:t.max_results})})]}),r&&l.jsxs(Y,{className:"rounded-lg",variant:"subtler",children:[l.jsx(B,{variant:"tiny",className:"p-md pb-0",children:l.jsx(be,{defaultMessage:"Response",id:"MgdnPiJHcj"})}),l.jsx(hl,{className:"p-sm !my-0 pt-0 text-xs",codeBlockProps:{language:"json"},hideTools:!0,children:tg({connection_type:n.connection_type,files:n.files,queries:n.queries,status:n.status})})]})]})})})})})};function ig(e){return e?e===te.BROWSER_AGENT||e===te.BROWSER_AGENT_SONNET||e===te.BROWSER_AGENT_OPUS:!1}const d0e=["turbo","pplx_pro"];function f0e(e){return d0e.includes(e)}function m0e({displayModel:e,userSelectedModel:t,getSearchModelLabel:n,intl:r,isMaxSubscriber:s,proactiveUpgradeReason:a}){const o=r.$t({defaultMessage:"Best",id:"PzlMqGwwkm"}),i=n(t)??o,c=n(e)??o;return a==="MULTI_STEP_ENHANCED"?r.$t({defaultMessage:"Prepared with advanced reasoning using {displayModelLabel}.",id:"3yOL2E9lJZ"},{displayModelLabel:c}):a==="DEEP_RESEARCH"?r.$t({defaultMessage:"Advanced Deep Research powered by {displayModelLabel}",id:"yfKHwXa8ej"},{displayModelLabel:c}):ig(e)||f0e(t)||c==="Best"||c==="Reasoning"?null:c!==i?s?r.$t({defaultMessage:"Prepared using {displayModelLabel} due to a temporary performance issue in {userSelectedModelLabel}",id:"ulbQoAtouG"},{displayModelLabel:c,userSelectedModelLabel:i}):r.$t({defaultMessage:"Prepared using {displayModelLabel} because {userSelectedModelLabel} was inapplicable or unavailable",id:"A/VIodQymS"},{displayModelLabel:c,userSelectedModelLabel:i}):r.$t({defaultMessage:"Prepared using {displayModelLabel}",id:"f0ivJqxcdo"},{displayModelLabel:c})}function p0e(e,t){return e.length===0?"":e.length===1?e[0]??"":new Intl.ListFormat(t,{style:"long",type:"conjunction"}).format(e)}function ZL(e,t,n){const r=t(e);if(r)return r;const s=dn[e];if(s?.name)return n.$t(s.name)}function h0e({displayModels:e,intl:t,getSearchModelLabel:n}){if(e.length===0)return null;const r=e.map(a=>ZL(a,n,t)).filter(a=>a!==void 0);if(r.length===0)return null;const s=p0e(r,t.locale);return t.$t({defaultMessage:"Prepared using {modelList}",id:"5CwxX5IOQa"},{modelList:s})}const g0e=e=>{const{hasChunks:t,progress:n}=e;return t?n!=="DONE"?"streaming":"complete":"none"},y0e=({modelSummary:e,isExpanded:t,onToggle:n,parentIsFinished:r,onFirstStreamingModel:s,StepRendererComponent:a})=>{const o=Q(),{$t:i}=o,{getModelLabel:c}=ki({reason:"CouncilResearchModelCard"}),{blocksByIntendedUsage:u,result:d}=Pt(),{dispatch:m}=vu(),p=e.status??"pending",h=e.model_id??"",g=Qw(h),y=ZL(h,c,o)??h,b=e.answer_block_usage??"",x=e.mock_thought,_=u[e.plan_block_usage??""]?.plan_block,v=u[b]?.markdown_block,C=_?.steps??[],w=C.length,S=g0e({hasChunks:(v?.chunks?.length??0)>0,progress:v?.progress}),E=f.useRef(!1);f.useEffect(()=>{S==="streaming"&&!E.current&&s&&(E.current=!0,s(h,y,b))},[S,h,y,b,s]);const T=k=>{k.stopPropagation(),m({action:"open",tabType:"council_response",councilResponse:{modelId:h,modelLabel:y,backendUuid:d.backend_uuid??"",answerBlockUsage:b}})};return l.jsxs("div",{className:"overflow-hidden rounded-xl border border-subtler",children:[l.jsxs("div",{className:"cursor-pointer p-3 transition-colors duration-150 hover:bg-offset-subtle sm:p-4",onClick:n,children:[l.jsxs("div",{className:"flex items-center justify-between gap-x-2",children:[l.jsxs("div",{className:"gap-x-xs flex min-w-0 flex-1 items-center sm:gap-x-sm",children:[l.jsxs("div",{className:"gap-x-xs flex shrink-0 items-center rounded-full border border-subtler bg-background px-2 py-1 sm:px-3 sm:py-1.5",children:[g&&l.jsx(ye,{icon:g,size:"xs",className:"text-quiet"}),l.jsx(B,{variant:"tiny",className:"font-medium",children:y})]}),w>0&&l.jsx(B,{variant:"tiny",color:"light",className:"shrink-0",children:i({id:"vAKAnIbJ4M",defaultMessage:"{count, plural, one {# step} other {# steps}}"},{count:w})})]}),l.jsxs("div",{className:"gap-x-xs flex shrink-0 items-center sm:gap-x-sm",children:[S==="streaming"&&l.jsx(at,{variant:"secondary",size:"tiny",pill:!0,onClick:T,children:l.jsxs("span",{className:"gap-x-xs flex items-center",children:[l.jsx(To,{size:10}),l.jsx("span",{className:"hidden sm:inline",children:i({id:"Hcr4DS0EQ/",defaultMessage:"Writing response..."})}),l.jsx("span",{className:"sm:hidden",children:i({id:"JcfcZ04yO1",defaultMessage:"Writing..."})})]})}),S==="complete"&&l.jsxs(at,{variant:"secondary",size:"tiny",pill:!0,onClick:T,children:[l.jsx("span",{className:"hidden sm:inline",children:i({id:"KKS98SjNce",defaultMessage:"View response"})}),l.jsx("span",{className:"sm:hidden",children:i({id:"FgydNeoT78",defaultMessage:"View"})})]}),l.jsx(ye,{icon:D(t?"chevron-down":"chevron-right"),size:"sm",className:"text-subtle"})]})]}),l.jsx("div",{className:"gap-x-xs mt-2 flex h-4 min-w-0 items-center",children:S==="complete"?l.jsxs(l.Fragment,{children:[l.jsx(ye,{icon:D("circle-check"),size:"xs",className:"shrink-0 text-quiet"}),l.jsx(B,{variant:"tinyRegular",color:"light",children:i({id:"95stPqCnfu",defaultMessage:"Completed"})})]}):l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"shrink-0",children:l.jsx(To,{size:12,color:"quiet"})}),l.jsx(B,{variant:"tinyRegular",color:"light",className:"min-w-0 truncate",children:x||i({id:"eD084+/kcH",defaultMessage:"Researching..."})})]})})]}),t&&l.jsx("div",{className:"px-3 pb-3 sm:px-4 sm:pb-4",children:C.length>0?l.jsx("div",{className:"gap-y-xs flex flex-col",children:C.map((k,M)=>{const N=oO(k);if(!N)return null;const P=M===C.length-1,O=p==="completed"||r||!P;return l.jsx(a,{step:N,isFinished:O,isNested:!0,showAllNestedSteps:!0,disableAnimations:!0},k.uuid??M)})}):l.jsx(B,{variant:"tinyRegular",color:"light",children:i({id:"IPiHjIy59N",defaultMessage:"No steps yet"})})})]})},x0e=({modelSummaries:e,isFinished:t,StepRendererComponent:n})=>{const{$t:r}=Q(),{blocksByIntendedUsage:s,result:a}=Pt(),{dispatch:o}=vu(),[i,c]=f.useState(new Set),u=f.useRef(!1),d=g=>{c(y=>{const b=new Set(y);return b.has(g)?b.delete(g):b.add(g),b})},p=e.length>0&&e.every(g=>{const y=g.answer_block_usage??"",b=s[y]?.markdown_block,x=(b?.chunks?.length??0)>0,_=b?.progress;return x&&_==="DONE"})&&!t,h=(g,y,b)=>{u.current||(u.current=!0,o({action:"open",tabType:"council_response",councilResponse:{modelId:g,modelLabel:y,backendUuid:a.backend_uuid??"",answerBlockUsage:b}}))};return!e||e.length===0?null:l.jsxs("div",{className:"gap-y-sm flex flex-col",children:[e.map(g=>{const y=g.model_id??"";return l.jsx(y0e,{modelSummary:g,isExpanded:i.has(y),onToggle:()=>d(y),parentIsFinished:t,onFirstStreamingModel:h,StepRendererComponent:n},y)}),p&&l.jsx("div",{className:"overflow-hidden rounded-xl border border-dashed border-subtle",children:l.jsx("div",{className:"px-3 pb-9 pt-3 sm:px-4 sm:pb-10 sm:pt-4",children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsx("div",{className:"gap-x-xs flex items-center sm:gap-x-sm",children:l.jsxs("div",{className:"gap-x-xs flex items-center rounded-full border border-subtler bg-background px-2 py-1 sm:px-3 sm:py-1.5",children:[l.jsx(To,{size:12,color:"quiet"}),l.jsxs(B,{variant:"tiny",className:"font-medium",children:[l.jsx("span",{className:"hidden sm:inline",children:r({id:"MuHT9ZAF0i",defaultMessage:"Synthesizing responses..."})}),l.jsx("span",{className:"sm:hidden",children:r({id:"SHszeGROev",defaultMessage:"Synthesizing..."})})]})]})})})})})]})},b0e=({tool_input_content:e})=>{const t=Xt(),n=e.tool_input?.subagent_tool_inputs?.subagents;return n?l.jsx(Y,{className:"gap-y-md flex flex-col",children:n.filter(r=>r.task_uuid).map((r,s)=>{const o=e.subagent_steps?.[r.task_uuid]?.steps;return o?l.jsxs("div",{className:"rounded-lg border p-4 transition-colors duration-150",onClick:async()=>{await t.moveThreadToSidecar({activeTaskUuid:r.task_uuid,isSubagent:!0,reason:"move-subagent-step"})},children:[r.description&&l.jsx(B,{className:"mb-3",children:r.description}),o[o.length-1]?.thought&&l.jsx(B,{color:"light",variant:"small",children:o[o.length-1]?.thought})]},s):null})}):null};var ol;(function(e){e.PENDING="pending",e.IN_PROGRESS="in_progress",e.COMPLETED="completed"})(ol||(ol={}));function _0e(e){switch(e){case ol.COMPLETED:return{icon:D("circle-check"),iconClassName:"text-quietest mb-0.5",textColor:"ultraLight",textClassName:"line-through"};case ol.IN_PROGRESS:return{icon:D("circle-arrow-right"),iconClassName:"text-quiet mb-0.5",textColor:"light",textClassName:void 0};case ol.PENDING:return{icon:D("circle"),iconClassName:"text-quiet mb-0.5",textColor:"light",textClassName:void 0};default:St(e)}}const v0e=({todos:e})=>l.jsx("div",{className:"bg-offset p-md rounded-xl",children:l.jsx("div",{className:"gap-xs flex flex-col",children:e.map((t,n)=>{const r=t.status??ol.PENDING,s=r===ol.IN_PROGRESS&&t.active_form?t.active_form:t.content??"",{icon:a,iconClassName:o,textColor:i,textClassName:c}=_0e(r);return l.jsxs("div",{className:"gap-sm flex items-center",children:[l.jsx(ye,{icon:a,size:"sm",className:o}),l.jsx(B,{variant:"small",color:i,className:c,children:s})]},`${s}-${n}`)})})}),jM=1e9;function C0e(e,t){const{event_entity:n,event_type:r,value_upper_bound:s,value_lower_bound:a}=e;let o="";return r==="STOCK_PRICE_TARGET"?a!=null?o=t.formatMessage({defaultMessage:"goes below ${value}",id:"RKgpKR3E99"},{value:a}):s!=null?o=t.formatMessage({defaultMessage:"goes above ${value}",id:"8eV5ClXcpi"},{value:s}):o=t.formatMessage({defaultMessage:"price target",id:"vnTdzDaohg"}):r==="STOCK_PRICE_MOVEMENT"?a!=null?o=t.formatMessage({defaultMessage:"drops {percent}%+",id:"Vl3IJiE9mt"},{percent:Math.abs(a)}):s!=null?o=t.formatMessage({defaultMessage:"rises {percent}%+",id:"EK4T00JAfI"},{percent:s}):o=t.formatMessage({defaultMessage:"price movement",id:"Pcu8sUjesQ"}):o=t.formatMessage({defaultMessage:"event triggers",id:"LpIhmla5ty"}),{kind:n,friendly:o,isRecurring:!1}}const As=`
`;function JL({baseInstructions:e,additionalInstructions:t}){let n=e+As;return t&&(n+=t),n}function PM({prompt:e,baseInstructions:t}){if(!e||!t)return"";const n=e.replace(/\\n/g,As),r=t.replace(/\\n/g,As),s=r+As;if(n.startsWith(s))return n.slice(s.length);if(n.startsWith(r)){const i=n.slice(r.length);if(i.startsWith(As))return i.slice(As.length);if(i.trim()==="")return""}return n.startsWith(r)?"":n}function w0e(e,t){let n=e;for(const[r,s]of Object.entries(t))n=n.replaceAll(r,s);return n}function OM({rawInstructions:e,symbol:t,quoteName:n="",eventValue:r,direction:s}){return w0e(e,{"\\\\n":`
`,"{symbol}":t,"{quoteName}":n,"{{event_value}}":r,"{{direction}}":s})}function S0e({prompt:e,symbol:t,quoteName:n=""}){if(!t||!e)return"";let r=e;r.startsWith('"')&&r.endsWith('"')&&(r=r.slice(1,-1));const s="Explain the factors driving the latest movement of {symbol}{quoteName}, including its recent {{direction}} to {{event_value}}. Contextualize this price movement within the last few weeks of price movement and investor narrative.",a="Explain the factors driving the latest movement of {symbol}{quoteName}, including its recent {{event_value}}% {{direction}}. Contextualize this price movement within the last few weeks of price movement and investor narrative.";let o=r;if(o.startsWith(s+As))o=o.slice((s+As).length);else if(o.startsWith(a+As))o=o.slice((a+As).length);else if(o===s||o===a)return"";if(o.includes(As)){const i=o.split(As);o=i[i.length-1]??o}return o}function E0e({selectedSymbol:e,symbol:t,quote:n,isLoading:r=!1,alertType:s,priceValue:a,percentValue:o,currencySymbol:i,$t:c}){const u=e??t,d=n?.name?` (${n.name})`:"",m=f.useMemo(()=>s==="price"?k0e({symbol:u,quoteName:d,priceValue:a,currencySymbol:i,$t:c}):M0e({symbol:u,quoteName:d,percentValue:o,$t:c}),[s,u,d,a,i,c,o]),p=f.useMemo(()=>!u||!n?"":s==="price"?my({symbol:u,quoteName:d}):py({symbol:u,quoteName:d}),[u,n,s,d]),h=!r&&n?.name;return f.useMemo(()=>({shouldShowDisplayInstructions:h,displayInstructions:m,baseInstructions:p,effectiveSymbol:u,quoteName:d}),[p,m,u,d,h])}function my({symbol:e,quoteName:t,$t:n}){return n?n({id:"0J1c9pn78+",defaultMessage:"Explain the factors driving the latest movement of {symbol}{quoteName}, including its recent '{{direction}}' to '{{event_value}}'. Contextualize this price movement within the last few weeks of price movement and investor narrative."},{symbol:e||"",quoteName:t||""}):`Explain the factors driving the latest movement of ${e}${t||""}, including its recent {{direction}} to {{event_value}}. Contextualize this price movement within the last few weeks of price movement and investor narrative.`}function py({symbol:e,quoteName:t,$t:n}){return n?n({id:"9XAm3nfaVB",defaultMessage:"Explain the factors driving the latest movement of {symbol}{quoteName}, including its recent '{{event_value}}%' '{{direction}}'. Contextualize this price movement within the last few weeks of price movement and investor narrative."},{symbol:e||"",quoteName:t||""}):`Explain the factors driving the latest movement of ${e}${t||""}, including its recent {{event_value}}% {{direction}}. Contextualize this price movement within the last few weeks of price movement and investor narrative.`}function k0e({symbol:e,quoteName:t,priceValue:n,currencySymbol:r,$t:s}){if(!e)return s({id:"39tYCstx5d",defaultMessage:"Explain the factors driving the latest movement of this asset, including its recent rise/fall. Contextualize this price movement within the last few weeks of price movement and investor narrative."});const a=n&&n!=="$"?s({defaultMessage:" to {currencySymbol}{priceValue}",id:"zSy/VeEpR9"},{priceValue:n,currencySymbol:r}):"",o=s({defaultMessage:"rise/fall",id:"+dqzTFX/gy"});return my({symbol:e,quoteName:t,$t:s}).replace(" to {{event_value}}",a).replace("{{direction}}",o)}function M0e({symbol:e,quoteName:t,percentValue:n,$t:r}){if(!e)return r({id:"pP0ylRs8IX",defaultMessage:"Explain the factors driving the latest movement of this asset, including its recent increase/decrease. Contextualize this price movement within the last few weeks of price movement and investor narrative."});const s=r({id:"QBY86oKDNP",defaultMessage:"increase/decrease"});return py({symbol:e,quoteName:t,$t:r}).replace(" {{event_value}}%",n?` ${parseFloat(n).toFixed(2)}%`:"").replace("{{direction}}",s)}const Zc=1e9,Jc=-1e9;function LM({symbol:e,alertType:t,priceValue:n,priceThreshold:r,percentValue:s,positiveSelected:a=!0,negativeSelected:o=!0,baseInstructions:i,additionalInstructions:c=""}){let u,d="";if(t==="price"){if(!n||!r)return null;const p=parseFloat(n.replace(/[^0-9.]/g,""));if(isNaN(p))return null;u={event_entity:e,event_group:"FINANCE",event_type:"STOCK_PRICE_TARGET",value_lower_bound:r==="below"?p:Jc,value_upper_bound:r==="above"?p:Zc},d=`Alert when ${e} is ${r} ${n}`}else if(t==="movement"){if(!s)return null;const p=parseFloat(s);if(isNaN(p))return null;a&&o?(u={event_entity:e,event_group:"FINANCE",event_type:"STOCK_PRICE_MOVEMENT",value_lower_bound:-p,value_upper_bound:p},d=`Alert when ${e} moves +${s}% or -${s}% in a day`):a?(u={event_entity:e,event_group:"FINANCE",event_type:"STOCK_PRICE_MOVEMENT",value_lower_bound:Jc,value_upper_bound:p},d=`Alert when ${e} moves +${s}% in a day`):o&&(u={event_entity:e,event_group:"FINANCE",event_type:"STOCK_PRICE_MOVEMENT",value_lower_bound:-p,value_upper_bound:Zc},d=`Alert when ${e} moves -${s}% in a day.`)}if(!u)return null;const m=JL({baseInstructions:i,additionalInstructions:c});return{task_name:d,prompt:m,event_subscription:u,model_preference:"turbo"}}const FM="usd";function hp(e){return e!=null&&e!==Zc&&e!==Jc&&e!==jM&&e!==-1&&Math.abs(e)!==jM}const T0e=async({entryUUID:e,sourceType:t,reason:n})=>{try{const{error:r,response:s}=await ve.POST("/rest/sources/skip",n,{body:{entry_uuid:e,source_type:t},timeoutMs:Ct({productionMs:5e3}),numRetries:1});if(r)throw new Ue("API_CLIENTS_ERROR",{cause:r,status:s.status??0})}catch(r){throw Z.error("Failed to skip source",r),r}},A0e=async(e,t,n)=>{const{data:r,error:s,response:a}=await ve.POST("/rest/sse/handle_tool_user_approval_response","mcp-tool-user-approval",{body:{result:{uuid:e,allow_tool_call:t,user_revision:n}}});if(s)throw s;return{data:r,error:s,response:a}},eF=()=>on({mutationFn:({uuid:e,allowToolCall:t,userRevision:n})=>A0e(e,t,n)}),UM=A.memo(function({entryUUID:t,sourceType:n,sourceName:r,userApprovalUuid:s,onSkipSourceClicked:a,isAutoDetected:o}){const[i,c]=f.useState(!1),{actions:u}=Pt(),{openToast:d}=cn(),{session:m}=je(),{trackEvent:p}=Ze(m),h=Q(),g=eF(),y=f.useCallback(async()=>{c(!0),a?.(),p("query source skipped",{entryUUID:t,sourceType:n,sourceName:r,isAutoDetected:o}),u.addSkippedSource(n);try{await T0e({entryUUID:t,sourceType:n,reason:"skip-source-button"}),s&&g.mutate({uuid:s,allowToolCall:"SKIP_SOURCE"})}catch{d({message:h.formatMessage({defaultMessage:"Failed to skip source",id:"73EQcPTvg9"}),variant:"error",timeout:null}),u.removeSkippedSource(n),c(!1)}},[t,n,r,o,u,d,h,s,g,a,p]);return l.jsx(B,{color:"light",variant:"small",className:"text-pretty",children:l.jsx("div",{className:"relative min-h-[20px] w-full",children:i?l.jsx(ze.div,{initial:"initial",animate:"animate",exit:"exit",variants:dM,children:l.jsx(Tr,{variant:"super",as:"div",className:"px-sm flex h-6 items-center",children:l.jsx(be,{defaultMessage:"Skipping",id:"6NU82XTPCI"})})},"skipping-message"):l.jsx(ze.div,{initial:"initial",animate:"animate",exit:"exit",variants:dM,children:l.jsx(st,{size:"tiny",onClick:y,variant:"common",icon:D("player-track-next"),extraCSS:"rounded-lg",text:l.jsx(be,{defaultMessage:"Skip {sourceName}",id:"B0WVL5L6bh",values:{sourceName:r}}),"data-testid":"skip-source-button"})},"skip-button")})})}),N0e=A.memo(function({mediaItems:t,className:n}){const r=t?.[t?.length-1],s=r?.media_item,a=s?.image||s?.thumbnail,o=f.useMemo(()=>({url:s?.url,name:s?.name}),[s?.name,s?.url]);return r?l.jsxs("div",{className:z("@xs:px-md @xs:pb-md px-sm pb-sm relative flex flex-col gap-1.5",n),children:[l.jsx(Wt,{mode:"wait",children:l.jsx(ze.div,{className:"after:ring-subtler @xs:w-20 md:@xs:w-60 relative overflow-hidden rounded after:pointer-events-none after:absolute after:inset-0 after:rounded-md after:ring-1 after:ring-inset after:ring-opacity-50 md:w-full dark:after:ring-0",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.1,ease:"easeOut"},children:l.jsx(to,{src:s?.thumbnail,lightboxSrc:a,alt:s?.name,origin:o,includeLightBoxModal:!0,rounded:!0,imageClassName:"object-cover w-full text-[0] dark:mix-blend-normal",containerClassName:"h-full w-full",maskClassName:"bg-subtler"})},s?.thumbnail)}),s?.url&&l.jsx("div",{children:l.jsx(Dt,{href:s?.url,target:"_blank",children:l.jsx(pt,{icon:D("arrow-up-right"),variant:"common",size:"tiny",text:"Open page",extraCSS:"group",iconClassName:"group-hover:text-super",textClassName:"group-hover:text-super font-normal",noPadding:!0})})})]}):null}),ci=(e,t,n)=>{const r=document.createElement(e),[s,a]=Array.isArray(t)?[void 0,t]:[t,n];return s&&Object.assign(r,s),a?.forEach(o=>r.appendChild(o)),r},R0e=(e,t)=>{var n;return t==="left"?e.offsetLeft:(((n=e.offsetParent instanceof HTMLElement?e.offsetParent:null)==null?void 0:n.offsetWidth)??0)-e.offsetWidth-e.offsetLeft},D0e=e=>e.offsetWidth>0&&e.offsetHeight>0,I0e=(e,t)=>{customElements.get(e)!==t&&customElements.define(e,t)};function j0e(e,t,{reverse:n=!1}={}){const r=e.length;for(let s=n?r-1:0;n?s>=0:s<r;n?s--:s++)t(e[s],s)}function P0e(e,t,n,r){const s=t.formatToParts(e);n&&s.unshift({type:"prefix",value:n}),r&&s.push({type:"suffix",value:r});const a=[],o=[],i=[],c=[],u={},d=y=>`${y}:${u[y]=(u[y]??-1)+1}`;let m="",p=!1,h=!1;for(const y of s){m+=y.value;const b=y.type==="minusSign"||y.type==="plusSign"?"sign":y.type;b==="integer"?(p=!0,o.push(...y.value.split("").map(x=>({type:b,value:parseInt(x)})))):b==="group"?o.push({type:b,value:y.value}):b==="decimal"?(h=!0,i.push({type:b,value:y.value,key:d(b)})):b==="fraction"?i.push(...y.value.split("").map(x=>({type:b,value:parseInt(x),key:d(b),pos:-1-u[b]}))):(p||h?c:a).push({type:b,value:y.value,key:d(b)})}const g=[];for(let y=o.length-1;y>=0;y--){const b=o[y];g.unshift(b.type==="integer"?{...b,key:d(b.type),pos:u[b.type]}:{...b,key:d(b.type)})}return{pre:a,integer:g,fraction:i,post:c,valueAsString:m,value:typeof e=="string"?parseFloat(e):e}}const O0e=String.raw,L0e=(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0})(),F0e=typeof CSS<"u"&&CSS.supports&&CSS.supports("line-height","mod(1,1)"),BM=typeof matchMedia<"u"?matchMedia("(prefers-reduced-motion: reduce)"):null,lg="--_number-flow-d-opacity",AE="--_number-flow-d-width",cg="--_number-flow-dx",NE="--_number-flow-d",U0e=(()=>{try{return CSS.registerProperty({name:lg,syntax:"<number>",inherits:!1,initialValue:"0"}),CSS.registerProperty({name:cg,syntax:"<length>",inherits:!0,initialValue:"0px"}),CSS.registerProperty({name:AE,syntax:"<number>",inherits:!1,initialValue:"0"}),CSS.registerProperty({name:NE,syntax:"<number>",inherits:!0,initialValue:"0"}),!0}catch{return!1}})(),B0e="var(--number-flow-char-height, 1em)",Yo="var(--number-flow-mask-height, 0.25em)",HM=`calc(${Yo} / 2)`,D_="var(--number-flow-mask-width, 0.5em)",Ui=`calc(${D_} / var(--scale-x))`,gp="#000 0, transparent 71%",VM=O0e`:host{display:inline-block;direction:ltr;white-space:nowrap;isolation:isolate;line-height:${B0e} !important}.number,.number__inner{display:inline-block;transform-origin:left top}:host([data-will-change]) :is(.number,.number__inner,.section,.digit,.digit__num,.symbol){will-change:transform}.number{--scale-x:calc(1 + var(${AE}) / var(--width));transform:translateX(var(${cg})) scaleX(var(--scale-x));margin:0 calc(-1 * ${D_});position:relative;-webkit-mask-image:linear-gradient(to right,transparent 0,#000 ${Ui},#000 calc(100% - ${Ui}),transparent ),linear-gradient(to bottom,transparent 0,#000 ${Yo},#000 calc(100% - ${Yo}),transparent 100% ),radial-gradient(at bottom right,${gp}),radial-gradient(at bottom left,${gp}),radial-gradient(at top left,${gp}),radial-gradient(at top right,${gp});-webkit-mask-size:100% calc(100% - ${Yo} * 2),calc(100% - ${Ui} * 2) 100%,${Ui} ${Yo},${Ui} ${Yo},${Ui} ${Yo},${Ui} ${Yo};-webkit-mask-position:center,center,top left,top right,bottom right,bottom left;-webkit-mask-repeat:no-repeat}.number__inner{padding:${HM} ${D_};transform:scaleX(calc(1 / var(--scale-x))) translateX(calc(-1 * var(${cg})))}:host > :not(.number){z-index:5}.section,.symbol{display:inline-block;position:relative;isolation:isolate}.section::after{content:'\200b';display:inline-block}.section--justify-left{transform-origin:center left}.section--justify-right{transform-origin:center right}.section > [inert],.symbol > [inert]{margin:0 !important;position:absolute !important;z-index:-1}.digit{display:inline-block;position:relative;--c:var(--current) + var(${NE})}.digit__num,.number .section::after{padding:${HM} 0}.digit__num{display:inline-block;--offset-raw:mod(var(--length) + var(--n) - mod(var(--c),var(--length)),var(--length));--offset:calc( var(--offset-raw) - var(--length) * round(down,var(--offset-raw) / (var(--length) / 2),1) );--y:clamp(-100%,var(--offset) * 100%,100%);transform:translateY(var(--y))}.digit__num[inert]{position:absolute;top:0;left:50%;transform:translateX(-50%) translateY(var(--y))}.digit:not(.is-spinning) .digit__num[inert]{display:none}.symbol__value{display:inline-block;mix-blend-mode:plus-lighter;white-space:pre}.section--justify-left .symbol > [inert]{left:0}.section--justify-right .symbol > [inert]{right:0}.animate-presence{opacity:calc(1 + var(${lg}))}`,H0e=HTMLElement,V0e=F0e&&L0e&&U0e;let yp,tF=class extends H0e{constructor(){super(),this.created=!1,this.batched=!1;const{animated:t,...n}=this.constructor.defaultProps;this._animated=this.computedAnimated=t,Object.assign(this,n)}get animated(){return this._animated}set animated(t){var n;this.animated!==t&&(this._animated=t,(n=this.shadowRoot)==null||n.getAnimations().forEach(r=>r.finish()))}set data(t){var n;if(t==null)return;const{pre:r,integer:s,fraction:a,post:o,value:i}=t;if(this.created){const c=this._data;this._data=t,this.computedTrend=typeof this.trend=="function"?this.trend(c.value,i):this.trend,this.computedAnimated=V0e&&this._animated&&(!this.respectMotionPreference||!(BM!=null&&BM.matches))&&D0e(this),(n=this.plugins)==null||n.forEach(u=>{var d;return(d=u.onUpdate)==null?void 0:d.call(u,t,c,this)}),this.batched||this.willUpdate(),this._pre.update(r),this._num.update({integer:s,fraction:a}),this._post.update(o),this.batched||this.didUpdate()}else{this._data=t,this.attachShadow({mode:"open"});try{this._internals??(this._internals=this.attachInternals()),this._internals.role="img"}catch{}if(typeof CSSStyleSheet<"u"&&this.shadowRoot.adoptedStyleSheets)yp||(yp=new CSSStyleSheet,yp.replaceSync(VM)),this.shadowRoot.adoptedStyleSheets=[yp];else{const c=document.createElement("style");c.textContent=VM,this.shadowRoot.appendChild(c)}this._pre=new zM(this,r,{justify:"right",part:"left"}),this.shadowRoot.appendChild(this._pre.el),this._num=new G0e(this,s,a),this.shadowRoot.appendChild(this._num.el),this._post=new zM(this,o,{justify:"left",part:"right"}),this.shadowRoot.appendChild(this._post.el),this.created=!0}try{this._internals.ariaLabel=t.valueAsString}catch{}}willUpdate(){this._pre.willUpdate(),this._num.willUpdate(),this._post.willUpdate()}didUpdate(){if(!this.computedAnimated)return;this._abortAnimationsFinish?this._abortAnimationsFinish.abort():this.dispatchEvent(new Event("animationsstart")),this._pre.didUpdate(),this._num.didUpdate(),this._post.didUpdate();const t=new AbortController;Promise.all(this.shadowRoot.getAnimations().map(n=>n.finished)).then(()=>{t.signal.aborted||(this.dispatchEvent(new Event("animationsfinish")),this._abortAnimationsFinish=void 0)}),this._abortAnimationsFinish=t}};tF.defaultProps={transformTiming:{duration:900,easing:"linear(0,.005,.019,.039,.066,.096,.129,.165,.202,.24,.278,.316,.354,.39,.426,.461,.494,.526,.557,.586,.614,.64,.665,.689,.711,.731,.751,.769,.786,.802,.817,.831,.844,.856,.867,.877,.887,.896,.904,.912,.919,.925,.931,.937,.942,.947,.951,.955,.959,.962,.965,.968,.971,.973,.976,.978,.98,.981,.983,.984,.986,.987,.988,.989,.99,.991,.992,.992,.993,.994,.994,.995,.995,.996,.996,.9963,.9967,.9969,.9972,.9975,.9977,.9979,.9981,.9982,.9984,.9985,.9987,.9988,.9989,1)"},spinTiming:void 0,opacityTiming:{duration:450,easing:"ease-out"},animated:!0,trend:(e,t)=>Math.sign(t-e),respectMotionPreference:!0,plugins:void 0,digits:void 0};class G0e{constructor(t,n,r,{className:s,...a}={}){this.flow=t,this._integer=new GM(t,n,{justify:"right",part:"integer"}),this._fraction=new GM(t,r,{justify:"left",part:"fraction"}),this._inner=ci("span",{className:"number__inner"},[this._integer.el,this._fraction.el]),this.el=ci("span",{...a,part:"number",className:`number ${s??""}`},[this._inner])}willUpdate(){this._prevWidth=this.el.offsetWidth,this._prevLeft=this.el.getBoundingClientRect().left,this._integer.willUpdate(),this._fraction.willUpdate()}update({integer:t,fraction:n}){this._integer.update(t),this._fraction.update(n)}didUpdate(){const t=this.el.getBoundingClientRect();this._integer.didUpdate(),this._fraction.didUpdate();const n=this._prevLeft-t.left,r=this.el.offsetWidth,s=this._prevWidth-r;this.el.style.setProperty("--width",String(r)),this.el.animate({[cg]:[`${n}px`,"0px"],[AE]:[s,0]},{...this.flow.transformTiming,composite:"accumulate"})}}let nF=class{constructor(t,n,{justify:r,className:s,...a},o){this.flow=t,this.children=new Map,this.onCharRemove=c=>()=>{this.children.delete(c)},this.justify=r;const i=n.map(c=>this.addChar(c).el);this.el=ci("span",{...a,className:`section section--justify-${r} ${s??""}`},o?o(i):i)}addChar(t,{startDigitsAtZero:n=!1,...r}={}){const s=t.type==="integer"||t.type==="fraction"?new sF(this,t.type,n?0:t.value,t.pos,{...r,onRemove:this.onCharRemove(t.key)}):new z0e(this,t.type,t.value,{...r,onRemove:this.onCharRemove(t.key)});return this.children.set(t.key,s),s}unpop(t){t.el.removeAttribute("inert"),t.el.style.top="",t.el.style[this.justify]=""}pop(t){t.forEach(n=>{n.el.style.top=`${n.el.offsetTop}px`,n.el.style[this.justify]=`${R0e(n.el,this.justify)}px`}),t.forEach(n=>{n.el.setAttribute("inert",""),n.present=!1})}addNewAndUpdateExisting(t){const n=new Map,r=new Map,s=this.justify==="left",a=s?"prepend":"append";if(j0e(t,o=>{let i;this.children.has(o.key)?(i=this.children.get(o.key),r.set(o,i),this.unpop(i),i.present=!0):(i=this.addChar(o,{startDigitsAtZero:!0,animateIn:!0}),n.set(o,i)),this.el[a](i.el)},{reverse:s}),this.flow.computedAnimated){const o=this.el.getBoundingClientRect();n.forEach(i=>{i.willUpdate(o)})}n.forEach((o,i)=>{o.update(i.value)}),r.forEach((o,i)=>{o.update(i.value)})}willUpdate(){const t=this.el.getBoundingClientRect();this._prevOffset=t[this.justify],this.children.forEach(n=>n.willUpdate(t))}didUpdate(){const t=this.el.getBoundingClientRect();this.children.forEach(s=>s.didUpdate(t));const n=t[this.justify],r=this._prevOffset-n;r&&this.children.size&&this.el.animate({transform:[`translateX(${r}px)`,"none"]},{...this.flow.transformTiming,composite:"accumulate"})}},GM=class extends nF{update(t){const n=new Map;this.children.forEach((r,s)=>{t.find(a=>a.key===s)||n.set(s,r),this.unpop(r)}),this.addNewAndUpdateExisting(t),n.forEach(r=>{r instanceof sF&&r.update(0)}),this.pop(n)}},zM=class extends nF{update(t){const n=new Map;this.children.forEach((r,s)=>{t.find(a=>a.key===s)||n.set(s,r)}),this.pop(n),this.addNewAndUpdateExisting(t)}};class I_{constructor(t,n,{onRemove:r,animateIn:s=!1}={}){this.flow=t,this.el=n,this._present=!0,this._remove=()=>{var a;this.el.remove(),(a=this._onRemove)==null||a.call(this)},this.el.classList.add("animate-presence"),this.flow.computedAnimated&&s&&this.el.animate({[lg]:[-.9999,0]},{...this.flow.opacityTiming,composite:"accumulate"}),this._onRemove=r}get present(){return this._present}set present(t){if(this._present!==t){if(this._present=t,t?this.el.removeAttribute("inert"):this.el.setAttribute("inert",""),!this.flow.computedAnimated){t||this._remove();return}this.el.style.setProperty("--_number-flow-d-opacity",t?"0":"-.999"),this.el.animate({[lg]:t?[-.9999,0]:[.999,0]},{...this.flow.opacityTiming,composite:"accumulate"}),t?this.flow.removeEventListener("animationsfinish",this._remove):this.flow.addEventListener("animationsfinish",this._remove,{once:!0})}}}let rF=class extends I_{constructor(t,n,r,s){super(t.flow,r,s),this.section=t,this.value=n,this.el=r}},sF=class extends rF{constructor(t,n,r,s,a){var o,i;const c=(((i=(o=t.flow.digits)==null?void 0:o[s])==null?void 0:i.max)??9)+1,u=Array.from({length:c}).map((m,p)=>{const h=ci("span",{className:"digit__num"},[document.createTextNode(String(p))]);return p!==r&&h.setAttribute("inert",""),h.style.setProperty("--n",String(p)),h}),d=ci("span",{part:`digit ${n}-digit`,className:"digit"},u);d.style.setProperty("--current",String(r)),d.style.setProperty("--length",String(c)),super(t,r,d,a),this.pos=s,this._onAnimationsFinish=()=>{this.el.classList.remove("is-spinning")},this._numbers=u,this.length=c}willUpdate(t){const n=this.el.getBoundingClientRect();this._prevValue=this.value;const r=n[this.section.justify]-t[this.section.justify],s=n.width/2;this._prevCenter=this.section.justify==="left"?r+s:r-s}update(t){this.el.style.setProperty("--current",String(t)),this._numbers.forEach((n,r)=>r===t?n.removeAttribute("inert"):n.setAttribute("inert","")),this.value=t}didUpdate(t){const n=this.el.getBoundingClientRect(),r=n[this.section.justify]-t[this.section.justify],s=n.width/2,a=this.section.justify==="left"?r+s:r-s,o=this._prevCenter-a;o&&this.el.animate({transform:[`translateX(${o}px)`,"none"]},{...this.flow.transformTiming,composite:"accumulate"});const i=this.getDelta();i&&(this.el.classList.add("is-spinning"),this.el.animate({[NE]:[-i,0]},{...this.flow.spinTiming??this.flow.transformTiming,composite:"accumulate"}),this.flow.addEventListener("animationsfinish",this._onAnimationsFinish,{once:!0}))}getDelta(){var t;if(this.flow.plugins)for(const s of this.flow.plugins){const a=(t=s.getDelta)==null?void 0:t.call(s,this.value,this._prevValue,this);if(a!=null)return a}const n=this.value-this._prevValue,r=this.flow.computedTrend||Math.sign(n);return r<0&&this.value>this._prevValue?this.value-this.length-this._prevValue:r>0&&this.value<this._prevValue?this.length-this._prevValue+this.value:n}};class z0e extends rF{constructor(t,n,r,s){const a=ci("span",{className:"symbol__value",textContent:r});super(t,r,ci("span",{part:`symbol ${n}`,className:"symbol"},[a]),s),this.type=n,this._children=new Map,this._onChildRemove=o=>()=>{this._children.delete(o)},this._children.set(r,new I_(this.flow,a,{onRemove:this._onChildRemove(r)}))}willUpdate(t){if(this.type==="decimal")return;const n=this.el.getBoundingClientRect();this._prevOffset=n[this.section.justify]-t[this.section.justify]}update(t){if(this.value!==t){const n=this._children.get(this.value);n&&(n.present=!1);const r=this._children.get(t);if(r)r.present=!0;else{const s=ci("span",{className:"symbol__value",textContent:t});this.el.appendChild(s),this._children.set(t,new I_(this.flow,s,{animateIn:!0,onRemove:this._onChildRemove(t)}))}}this.value=t}didUpdate(t){if(this.type==="decimal")return;const n=this.el.getBoundingClientRect()[this.section.justify]-t[this.section.justify],r=this._prevOffset-n;r&&this.el.animate({transform:[`translateX(${r}px)`,"none"]},{...this.flow.transformTiming,composite:"accumulate"})}}const q0e=parseInt(f.version.match(/^(\d+)\./)?.[1]),RE=q0e>=19,$0e=["data","digits"];class DE extends tF{attributeChangedCallback(t,n,r){this[t]=JSON.parse(r)}}DE.observedAttributes=RE?[]:$0e;I0e("number-flow-react",DE);const W0e={},qM=RE?e=>e:JSON.stringify;function $M(e){const{transformTiming:t,spinTiming:n,opacityTiming:r,animated:s,respectMotionPreference:a,trend:o,plugins:i,...c}=e;return[{transformTiming:t,spinTiming:n,opacityTiming:r,animated:s,respectMotionPreference:a,trend:o,plugins:i},c]}class K0e extends f.Component{updateProperties(t){if(!this.el)return;this.el.batched=!this.props.isolate;const[n]=$M(this.props);Object.entries(n).forEach(([r,s])=>{this.el[r]=s??DE.defaultProps[r]}),t?.onAnimationsStart&&this.el.removeEventListener("animationsstart",t.onAnimationsStart),this.props.onAnimationsStart&&this.el.addEventListener("animationsstart",this.props.onAnimationsStart),t?.onAnimationsFinish&&this.el.removeEventListener("animationsfinish",t.onAnimationsFinish),this.props.onAnimationsFinish&&this.el.addEventListener("animationsfinish",this.props.onAnimationsFinish)}componentDidMount(){this.updateProperties(),RE&&this.el&&(this.el.digits=this.props.digits,this.el.data=this.props.data)}getSnapshotBeforeUpdate(t){if(this.updateProperties(t),t.data!==this.props.data){if(this.props.group)return this.props.group.willUpdate(),()=>this.props.group?.didUpdate();if(!this.props.isolate)return this.el?.willUpdate(),()=>this.el?.didUpdate()}return null}componentDidUpdate(t,n,r){r?.()}handleRef(t){this.props.innerRef&&(this.props.innerRef.current=t),this.el=t}render(){const[t,{innerRef:n,className:r,data:s,willChange:a,isolate:o,group:i,digits:c,onAnimationsStart:u,onAnimationsFinish:d,...m}]=$M(this.props);return f.createElement("number-flow-react",{ref:this.handleRef,"data-will-change":a?"":void 0,class:r,...m,dangerouslySetInnerHTML:{__html:""},suppressHydrationWarning:!0,digits:qM(c),data:qM(s)})}constructor(t){super(t),this.handleRef=this.handleRef.bind(this)}}const Kd=f.forwardRef(function({value:t,locales:n,format:r,prefix:s,suffix:a,...o},i){f.useImperativeHandle(i,()=>c.current,[]);const c=f.useRef(),u=f.useContext(Y0e);u?.useRegister(c);const d=f.useMemo(()=>n?JSON.stringify(n):"",[n]),m=f.useMemo(()=>r?JSON.stringify(r):"",[r]),p=f.useMemo(()=>{const h=W0e[`${d}:${m}`]??=new Intl.NumberFormat(n,r);return P0e(t,h,s,a)},[t,d,m,s,a]);return f.createElement(K0e,{...o,group:u,data:p,innerRef:c})}),Y0e=f.createContext(void 0),Q0e=f.memo(function({count:t,className:n}){return l.jsx(Y,{className:z("flex select-none items-center pt-px text-center font-mono text-xs tabular-nums leading-none",n),as:"span",children:l.jsx(Kd,{value:t})})}),mm=A.memo(function({favicon:t,description:n,descriptionClassName:r,title:s,descriptionFooter:a,count:o,url:i,media:c,children:u,className:d,showMedia:m=!0,onClick:p,isMissionControlSummary:h,accessory:g}){const y=m&&c&&c.length>0;return l.jsxs(Y,{variant:"raised",className:z("@container group/step-card relative isolate flex flex-col gap-1.5 overflow-hidden rounded-xl border shadow-sm",d),onClick:p,children:[g&&l.jsx("div",{className:"absolute right-2 top-2",children:g}),(s||t)&&l.jsxs("div",{className:"@xs:px-md px-sm @xs:pt-3 @xs:gap-3 gap-sm flex min-w-0 items-center pt-2",children:[i&&t?l.jsx(Dt,{href:i,target:"_blank",rel:"noopener",className:"@xs:size-4 inline-flex size-3 shrink-0 items-center justify-center overflow-hidden rounded",children:t}):t,l.jsxs("div",{className:"@xs:text-sm flex min-w-0 flex-1 items-baseline text-xs",children:[s&&l.jsx("div",{className:"relative flex min-w-0 flex-1",children:l.jsx(B,{variant:"tiny",className:"@xs:text-sm min-w-0 flex-1 truncate",children:s})}),o&&l.jsxs("div",{className:"relative flex items-center",children:[l.jsx("span",{className:"px-xs ml-px leading-none opacity-35",children:""}),l.jsx(Q0e,{count:o,className:"opacity-65"})]})]})]}),l.jsxs("div",{className:"@xs:gap-sm @xs:flex-row flex flex-col gap-0",children:[l.jsxs("div",{className:"flex min-w-0 grow flex-col gap-1.5",children:[n&&l.jsx(l.Fragment,{children:h?l.jsx(X0e,{description:n}):l.jsx(B,{variant:"tinyRegular",className:z("px-md @xs:text-sm text-pretty",t?"@xs:ml-7 ml-4":void 0,r),children:n})}),a&&l.jsx("div",{className:"px-md @xs:ml-7 ml-4",children:a}),u]}),y&&l.jsx(N0e,{mediaItems:c})]})]})}),X0e=A.memo(function({description:t}){const[n,r]=f.useState(!1),{$t:s}=Q(),a=f.useCallback(o=>{o.stopPropagation(),r(!n)},[n]);return l.jsxs(B,{variant:"tinyRegular",className:z("px-md mb-sm @xs:text-sm @xs:ml-7 relative ml-4 line-clamp-2 text-pretty",n&&"line-clamp-none"),children:[l.jsxs("span",{className:z("relative",{"select-none":!n}),children:[t,n&&l.jsxs(B,{inline:!0,variant:"tinyRegular",color:"light",className:"hover:text-super inline-flex select-none items-center opacity-0 group-hover/step-card:opacity-100",onClick:a,children:["",s({id:"mFYgAXM/x4",defaultMessage:"Less"}),l.jsx(ye,{icon:D("chevron-up"),size:"xs"})]})]}),!n&&l.jsxs(l.Fragment,{children:[l.jsx(Y,{className:"absolute inset-0",variant:"raised",style:{maskImage:"linear-gradient(to bottom, transparent 0%, black 100%)"}}),l.jsxs(B,{variant:"tinyRegular",color:"light",className:"right-md hover:text-super bg-raised pl-xs absolute bottom-0 hidden translate-x-2 select-none items-center group-hover/step-card:inline-flex",onClick:a,children:[s({id:"I5NMJ8llIi",defaultMessage:"More"}),l.jsx(ye,{icon:D("chevron-down"),size:"xs"})]})]})]})});var Z0e=f.useLayoutEffect,J0e=function(t){var n=A.useRef(t);return Z0e(function(){n.current=t}),n},WM=function(t,n){if(typeof t=="function"){t(n);return}t.current=n},eye=function(t,n){var r=A.useRef();return A.useCallback(function(s){t.current=s,r.current&&WM(r.current,null),r.current=n,n&&WM(n,s)},[n])},KM={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},tye=function(t){Object.keys(KM).forEach(function(n){t.style.setProperty(n,KM[n],"important")})},YM=tye,Nr=null,QM=function(t,n){var r=t.scrollHeight;return n.sizingStyle.boxSizing==="border-box"?r+n.borderSize:r-n.paddingSize};function nye(e,t,n,r){n===void 0&&(n=1),r===void 0&&(r=1/0),Nr||(Nr=document.createElement("textarea"),Nr.setAttribute("tabindex","-1"),Nr.setAttribute("aria-hidden","true"),YM(Nr)),Nr.parentNode===null&&document.body.appendChild(Nr);var s=e.paddingSize,a=e.borderSize,o=e.sizingStyle,i=o.boxSizing;Object.keys(o).forEach(function(p){var h=p;Nr.style[h]=o[h]}),YM(Nr),Nr.value=t;var c=QM(Nr,e);Nr.value=t,c=QM(Nr,e),Nr.value="x";var u=Nr.scrollHeight-s,d=u*n;i==="border-box"&&(d=d+s+a),c=Math.max(d,c);var m=u*r;return i==="border-box"&&(m=m+s+a),c=Math.min(m,c),[c,u]}var XM=function(){},rye=function(t,n){return t.reduce(function(r,s){return r[s]=n[s],r},{})},sye=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],aye=!!document.documentElement.currentStyle,oye=function(t){var n=window.getComputedStyle(t);if(n===null)return null;var r=rye(sye,n),s=r.boxSizing;if(s==="")return null;aye&&s==="border-box"&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px");var a=parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),o=parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth);return{sizingStyle:r,paddingSize:a,borderSize:o}},iye=oye;function IE(e,t,n){var r=J0e(n);f.useLayoutEffect(function(){var s=function(o){return r.current(o)};if(e)return e.addEventListener(t,s),function(){return e.removeEventListener(t,s)}},[])}var lye=function(t,n){IE(document.body,"reset",function(r){t.current.form===r.target&&n(r)})},cye=function(t){IE(window,"resize",t)},uye=function(t){IE(document.fonts,"loadingdone",t)},dye=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],fye=function(t,n){var r=t.cacheMeasurements,s=t.maxRows,a=t.minRows,o=t.onChange,i=o===void 0?XM:o,c=t.onHeightChange,u=c===void 0?XM:c,d=FL(t,dye),m=d.value!==void 0,p=f.useRef(null),h=eye(p,n),g=f.useRef(0),y=f.useRef(),b=function(){var v=p.current,C=r&&y.current?y.current:iye(v);if(C){y.current=C;var w=nye(C,v.value||v.placeholder||"x",a,s),S=w[0],E=w[1];g.current!==S&&(g.current=S,v.style.setProperty("height",S+"px","important"),u(S,{rowHeight:E}))}},x=function(v){m||b(),i(v)};return f.useLayoutEffect(b),lye(p,function(){if(!m){var _=p.current,v=_.value;requestAnimationFrame(function(){v!==_.value&&b()})}}),cye(b),uye(b),f.createElement("textarea",vf({},d,{onChange:x,ref:h}))},mye=f.forwardRef(fye);const pye=({wrapperClassName:e,variant:t="default",size:n="default",errorText:r,className:s,value:a,maxLength:o,errorMessage:i,disabled:c=!1,hasShadow:u=!1,autoFocus:d=!1,placeholder:m="",rightItems:p=_e,onChange:h,onClear:g,onClick:y,onBlur:b,onFocus:x,onKeyDown:_,onPaste:v,isLoading:C,inlineEditBlock:w,label:S,subtitle:E,isOptional:T,minRows:k,isMobileUserAgent:M,allowEnterNewlines:N=!1,testId:P,textAreaClassname:O,ref:L})=>{const H=Mo(c),R=f.useRef(null),[I,F]=f.useState(!1),[G,j]=f.useState(!1),$=f.useRef(I);$.current=I,f.useEffect(()=>{!M&&d&&R.current?.focus()},[M,R,d]),f.useEffect(()=>{H!==c&&!c&&!M&&d&&setTimeout(()=>{R.current?.focus()},200)});const q=f.useMemo(()=>z({"border-r mr-sm pr-xs border-subtler":p.length!=0}),[p.length]),U=z("overflow-auto max-h-[50vh] outline-none w-full flex items-center","text-foreground font-sans resize-none","bg-transparent placeholder-quieter","caret-super selection:bg-super/50 dark:selection:bg-super/10 dark:selection:text-super",O),X=f.useMemo(()=>{const pe=(()=>{switch(t){case"subtle":return"bg-subtle";case"default":return"bg-base dark:bg-subtler";default:St(t)}})(),xe=z("w-full focus:ring-subtler flex items-center",pe,"border border-subtler  focus:ring-1 rounded-md","duration-200 transition-all",{"ring-subtler ring-1":I,"shadow-sm":u},s),Oe=z({"py-sm text-sm px-md":n==="default","text-base p-md pb-xl":n==="large"}),Te=z({"pr-md":p.length===0});return z(xe,Oe,Te)},[I,u,s,n,p.length,t]),J=i!==void 0,ne=!J&&!!o&&!!a&&a.length>o,ae=f.useMemo(()=>l.jsxs("div",{className:"right-sm gap-sm mb-xs pb-xs absolute bottom-0 flex items-center rounded-full",children:[C?l.jsx(B,{color:"light",children:l.jsx(ye,{icon:D("circle-half-2"),className:"aspect-square animate-spin"})}):null,J&&l.jsx(Y,{className:"mr-sm",children:l.jsx(B,{color:"red",variant:"tiny",children:i})}),ne&&l.jsx(Y,{className:"mr-sm",children:o&&a&&l.jsx(B,{color:"red",variant:"tiny",children:o-a.length})}),g!==void l.jsx("div",{className:q,children:l.jsx(pt,{icon:D("x"),pill:!0,onClick:g,size:dl.small})}),p.map((pe,xe)=>l.jsx(st,{...pe.buttonProps,size:dl.small,disabled:pe.buttonProps.disabled||J||ne,pill:!0},xe))]}),[i,C,o,g,p,a,q,J,ne]),de=f.useCallback(()=>{if(R.current){const pe=R.current.value.length;R.current.focus(),R.current.setSelectionRange(pe,pe)}},[]),oe=f.useCallback(pe=>{if(!R?.current)return!0;const xe=R.current,{selectionStart:Oe,selectionEnd:Te,value:we}=xe;if(Oe!==Te)return!1;const ke=document.createElement("div"),Fe=window.getComputedStyle(xe);ke.style.position="absolute",ke.style.visibility="hidden",ke.style.whiteSpace=Fe.whiteSpace,ke.style.wordWrap=Fe.wordWrap,ke.style.font=Fe.font,ke.style.padding=Fe.padding,ke.style.border=Fe.border,ke.style.width=xe.offsetWidth+"px",ke.style.lineHeight=Fe.lineHeight,document.body.appendChild(ke);try{const ot=parseInt(Fe.lineHeight)||24,ge=we.substring(0,Oe);ke.textContent=ge;const Ce=ke.offsetHeight;return pe==="first"?Ce<=ot:(ke.textContent=we,ke.offsetHeight-Ce<ot)}finally{document.body.removeChild(ke)}},[]),le=f.useCallback(pe=>{x?.(pe.nativeEvent),F(!0)},[x]),se=f.useCallback(pe=>{b?.(pe.nativeEvent),F(!1)},[b]),re=f.useCallback(pe=>{y?.(pe.nativeEvent)},[y]),he=f.useCallback(pe=>{h?.(pe.target.value)},[h]),ie=f.useCallback(pe=>{Xh(pe.nativeEvent,{isMobileUserAgent:M,isComposing:G,allowEnterNewlines:N,onKeyDown:_})},[_,G,M,N]),ue=f.useCallback(()=>pP(j),[j]),ce=f.useCallback(()=>hP(j),[j]),me=f.useCallback(pe=>{v?.(pe.nativeEvent)},[v]);return f.useImperativeHandle(L,()=>{const pe=R.current;return pe.focusAtEnd=de,pe.inLine=oe,pe.isFocused=()=>$.current,pe.append=xe=>{R.current&&(R.current.value+=xe)},pe.scrollToEnd=()=>{R.current&&(R.current.scrollTop=R.current.scrollHeight)},pe.trim=()=>{R.current&&(R.current.value=R.current.value.trim())},pe},[de,oe]),f.useEffect(()=>{d&&!M&&de()},[d,de,M]),l.jsxs("div",{"data-test-id":P,children:[l.jsx(tE,{label:S,subtitle:E,isOptional:T,errorText:r}),l.jsx("div",{className:z("rounded-3xl",e),children:l.jsxs("div",{className:"relative flex items-center",children:[l.jsx("div",{className:X,children:l.jsx(mye,{ref:R,autoFocus:d,placeholder:m,disabled:c,minRows:k,value:a,onClick:re,onChange:he,name:S,onKeyDown:ie,onBlur:se,onCompositionStart:ue,onCompositionEnd:ce,onFocus:le,onPaste:me,className:U,autoComplete:"off","data-testid":P})}),l.jsx("div",{className:"absolute bottom-0 m-px flex justify-between rounded-b-md px-[6px]",style:{width:"calc(100% - 2px)"},children:ae})]})}),w&&l.jsx("div",{className:"mt-sm flex justify-end",children:w})]})},Ul=A.memo(pye),hye=A.memo(function({form_items:t,taskUuid:n}){const r=t?.[0]?.text_area_item,s=r?.placeholder,a=r?.text,[o,i]=f.useState(s||""),c="agent-form",u=f.useCallback(async g=>{try{await ve.POST("/rest/browser/agent_confirmation",c,{body:{task_uuid:n,status:g,message:o},backOffTime:100,numRetries:2,headers:{"Content-Type":"application/json"}})}catch(y){Z.error("Error sending agent confirmation",y)}},[n,o,c]),{$t:d}=Q(),m=f.useCallback(g=>{Zr.isEnterKeyWithoutShift(g)&&u("accept")},[u]),p=f.useCallback(g=>{g.stopPropagation(),u("accept")},[u]),h=f.useCallback(g=>{g.stopPropagation(),u("reject")},[u]);return l.jsxs(Y,{className:"flex flex-col gap-3",children:[l.jsx(B,{color:"light",variant:"small",children:a}),l.jsx(Ul,{isMobileStyle:!1,isMobileUserAgent:!1,placeholder:s,value:o,onChange:i,onKeyDown:m}),l.jsxs("div",{className:"gap-sm py-sm flex items-center",children:[l.jsx(st,{size:"small",variant:"inverted",text:d({defaultMessage:"Continue",id:"acrOozm08x"}),type:"submit",disabled:!1,onClick:p}),l.jsx(pt,{size:"small",text:d({defaultMessage:"Skip",id:"/4tOwTiCH6"}),onClick:h})]})]})}),ea=A.memo(function(t){const{isFinished:n,className:r,showAnimation:s,isPaused:a,...o}=t,i=Q(),c=t.action&&La[t.action]?i.formatMessage(La[t.action].message):"",u=t.action?t.title?`${c}${t.title}`:c:t.title,d=t.action?La[t.action]?.icon:t.icon,m=n||a;return l.jsx(Wt,{mode:"popLayout",children:l.jsx(ze.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:s?0:.2,ease:"easeInOut"},className:z("gap-sm group flex cursor-pointer flex-col",r),children:l.jsxs(B,{variant:"tinyRegular",color:n?"light":"super",className:"flex items-center gap-1 py-1.5",children:[d&&l.jsx(ye,{icon:d,size:"2xs",className:"-mt-px opacity-80"}),l.jsx(Tr,{variant:"super",active:!m,as:"span",speed:"slow",children:u})]})},o.key)})}),gye=1e3,yye=A.memo(function({message:t,isFinished:n,isPaused:r,isPendingClarification:s}){const[a,o]=f.useState(!1),i=f.useRef(t.thought||""),[c,u]=f.useState("working"),d=Si(),{result:m,inFlight:p}=Pt(),h=m?.uuid;f.useEffect(()=>{if(n){o(!1);return}t.thought!==i.current&&(i.current=t.thought,o(!1));const b=setTimeout(()=>{!n&&!t.action&&o(!0)},gye);return()=>clearTimeout(b)},[t.thought,t.action,n]);const g=!t.action&&!t.thought&&t.url;return f.useEffect(()=>{let b="working";if(n?b="finished":r?b="paused":s?b="considering_clarification":g?b="reasoning":a&&!t.action?b="working":t.action&&t.action in La&&(b=t.action),u(b),d&&h&&p){const x=new CustomEvent("comet-agent-step-update",{detail:{stepAction:b,streamId:h}});document.dispatchEvent(x)}},[p,n,g,a,t.action,r,s,d,h]),!n&&(s||t.action||g||a&&!t.action)&&l.jsx(ea,{action:c,isFinished:n,isPaused:r,className:"pl-8"})});function xye({iconUrl:e,icon:t,iconOnly:n,iconClassName:r}){return!e&&!t?null:l.jsx("span",{className:z("inline-block -mt-px align-middle visRefresh2026Fonts:!mt-0 visRefresh2026Fonts:![vertical-align:unset]",r,{"mr-xs":!n}),children:e?l.jsx("img",{src:e,alt:"",className:"m-0 inline-block size-3 align-middle rounded-sm relative -top-px"}):l.jsx(ye,{icon:t,size:"2xs",className:"inline-block align-middle opacity-80 relative -top-px"})})}const Bl=A.memo(function({variant:t=KC.subtle,label:n,accessory:r,onClick:s,className:a,size:o="default",textColor:i="default",icon:c,iconUrl:u,iconClassName:d,iconOnly:m=!1,tooltip:p,truncate:h=!1,href:g,linkBehavior:y="none",trackEvent:b,forceExternalHandler:x,containerClassName:_,isAccented:v=!1,overflowCount:C}){const w=C&&C>0?l.jsxs("span",{className:"opacity-50",children:["+",C]}):null,S=r??w,E=f.useCallback(N=>{y==="external"&&g&&b&&b("click citation",{source:"inline",citation_url:g}),(y!=="external"||x)&&s?.(N)},[s,y,g,b,x]),T=l.jsxs(Y,{as:"span",variant:t,className:z("text-3xs rounded-badge group min-w-4 max-w-full cursor-pointer text-center align-middle font-mono tabular-nums font-normal transition-colors duration-150 visRefresh2026Fonts:inline-flex visRefresh2026Fonts:items-center",{"py-[0.1875rem] leading-snug":o==="default","py-[0.175rem] leading-none":o==="small","py-[0.125rem] leading-none":o==="extraSmall","px-[0.3rem]":!m,"inline-block px-[0.1875rem]":m},"[@media(hover:hover)]:hover:bg-subtler group-data-[state=open]/trigger:bg-subtler",v&&"ring-1 ring-inset ring-super/20",_),onClick:y==="external"?void 0:s,children:[l.jsx(xye,{iconUrl:u,icon:c,iconOnly:m,iconClassName:d}),l.jsx("span",{ref:N=>{if(N&&h){const P=N.scrollWidth>N.clientWidth;N.style.maskImage=P?"linear-gradient(to right, black 70%, transparent 100%)":""}},className:z("inline-block relative -mt-px align-middle visRefresh2026Fonts:!mt-0 visRefresh2026Fonts:![vertical-align:unset]",{"max-w-[25ch] overflow-hidden":h}),children:n}),!!S&&l.jsx("span",{className:"inline-block ml-xs mr-px inline-block -mt-px align-middle visRefresh2026Fonts:!mt-0 visRefresh2026Fonts:![vertical-align:unset]",children:S})]}),k=p?l.jsx(wn,{content:p,side:"top",children:T}):T,M=l.jsx(B,{as:"span",color:i,className:z("relative -mt-px max-w-full min-w-0 select-none whitespace-nowrap",{"-top-px":o==="default","-top-[3px] leading-none":o==="small","-top-two leading-none":o==="extraSmall"},a),children:k});return y==="external"&&g?l.jsx(Dt,{href:g,target:"_blank",rel:"noopener",className:"inline-flex max-w-full min-w-0",onClick:E,children:M}):M}),bye=A.memo(function({citationUrl:t}){const n=f.useCallback(()=>{window.open(t,"_blank","noopener,noreferrer")},[t]);return l.jsx(Bl,{icon:D("arrow-up-right"),iconClassName:"-ml-px",className:"animate-in fade-in duration-150",size:"extraSmall",textColor:"light",iconOnly:!0,tooltip:"Open page",onClick:n})}),_ye=A.memo(function({message:t,task:n}){const r=t.url||n.start_url,s=t.url?l.jsx(bye,{citationUrl:r}):null;return l.jsx(bs,{children:t.thought&&l.jsxs("div",{className:"pl-xs flex gap-3",children:[l.jsx(B,{color:"light",variant:"small",className:"size-4 py-1.5",children:s}),l.jsx(B,{color:"light",variant:"small",className:"py-1.5",children:t.thought})]})})}),vye=A.memo(function({task:t,isFinished:n,isPaused:r}){const s=t.agent_messages[t.agent_messages.length-1];return l.jsx(dm,{children:l.jsxs(ba,{mode:"sync",initial:!1,children:[t.agent_messages.length>0&&t.agent_messages.map((a,o)=>l.jsx(bs,{children:l.jsx(_ye,{message:a,task:t})},o)),l.jsx(bs,{children:l.jsx("div",{children:l.jsx(yye,{message:t.agent_messages.length>0?s:{action:"working",thought:"",url:"",answer:"",uuid:"",value:""},isFinished:n||t.clarification_status==="STOPPED_TASK",isPaused:r,isPendingClarification:t.clarification_status==="PENDING"})})})]})})}),Cye=A.memo(function({lastMessage:t,taskUuid:n}){return t.form?l.jsx("div",{className:"px-md py-sm ml-7",children:l.jsx(hye,{form_items:t.form.form_items,taskUuid:n})}):null}),ZM=A.memo(function({task:t,isFinished:n,index:r,isMissionControl:s}){const a=t.agent_messages[t.agent_messages.length-1],o=a?.form,i=t.uuid,{taskScreenshots:{[i]:[c]=_e},tasksState:{[i]:{is_paused:u=!1}={}},taskTabs:d}=Sn(),{$t:m}=Q(),p=Xt(),{result:h}=Pt(),g=f.useMemo(()=>d?.some(T=>T.taskUuid===i)??!1,[d,i]),y=f.useMemo(()=>c?[{media_item:{thumbnail:c,image:c,name:m({defaultMessage:"Screenshot",id:"9a+SKtXKhe"})},task_uuid:i,message_uuid:""}]:_e,[m,c,i]),b=f.useMemo(()=>l.jsx(bf,{domain:t.start_url}),[t.start_url]),x=f.useMemo(()=>t.agent_messages.filter(k=>k.screenshot).map(k=>({media_item:{thumbnail:k.screenshot,image:k.screenshot,name:m({defaultMessage:"Screenshot",id:"9a+SKtXKhe"})},task_uuid:t.uuid,message_uuid:""})),[m,t.uuid,t.agent_messages]),_=f.useMemo(()=>o?_e:t.media&&t.media.length?t.media:x.length?x:y,[o,x,y,t.media]),v=f.useCallback(async T=>{if(!(n&&s&&!g)){if(T.stopPropagation(),n)if(s){if(!g)return}else return;await p.makeTaskVisible(i)}},[p,i,n,s,g,h?.backend_uuid]),C=s&&n,w=t.clarification_status,S=T=>{switch(T){case"UPDATED_TASK":return m({defaultMessage:"Updated per your clarification",id:"UmUpwNXXy9"});case"STOPPED_TASK":return m({defaultMessage:"Stopped per your clarification",id:"Uura7/Ftc2"});default:return""}},E=w&&w!=="PENDING"?l.jsxs(B,{variant:"tinyRegular",className:"gap-xs py-xs text-super flex",children:[l.jsx(ye,{icon:D("info-circle"),size:"xs"}),l.jsx("span",{className:"text-pretty",children:S(w)})]}):null;return l.jsx(mm,{favicon:b,title:Vf(t.start_url),accessory:g&&C?l.jsx(ye,{icon:D("arrow-up-right"),size:"xs",className:"group-hover/step-card:text-super opacity-60 group-hover/step-card:opacity-100"}):void 0,media:_,description:t.task,descriptionFooter:E,showMedia:!o,onClick:v,className:z("border transition-colors duration-150 hover:!transition-none",g&&"hover:border-super/75 group/step-card cursor-pointer"),isMissionControlSummary:C,children:C?null:o&&a&&!n?l.jsx(Cye,{lastMessage:a,taskUuid:t.uuid}):l.jsx(vye,{task:t,isFinished:n,isPaused:u})},r)}),wye=A.memo(function({step:t,isFinished:n,isMissionControl:r}){return l.jsx(Sye,{tasks:t.content.tasks,isMissionControl:r,isFinished:n})}),Sye=({tasks:e,isMissionControl:t,isFinished:n})=>t&&n&&e.length>1?l.jsx("div",{className:"-mx-sm",children:l.jsx(zf,{orientation:"horizontal",viewportClassName:"px-sm",showScrollIndicator:!1,children:l.jsxs(Y,{className:"gap-sm flex flex-row",children:[e.map((s,a)=>l.jsx("div",{className:"w-3/4 shrink-0",children:l.jsx(ZM,{task:s,isFinished:n,index:a,isMissionControl:t})},a)),l.jsx("div",{className:"w-px shrink-0"})]})})}):l.jsx(Y,{className:"gap-y-md flex flex-col",children:e.map((s,a)=>l.jsx(ZM,{task:s,isFinished:n,index:a,isMissionControl:t},a))}),xp=.03,Eye=3,hy=A.memo(function({items:t,initialDisplayCount:n=Eye,stepDelay:r=xp,isFinished:s=!1,vertical:a=!1,truncate:o=!0}){const[i,c]=f.useState([]),[u,d]=f.useState(!1),m=f.useRef(null),p=f.useRef(!0),h=f.useRef(s),g=f.useRef(0);f.useEffect(()=>()=>{m.current&&clearTimeout(m.current)},[]),f.useEffect(()=>{const C=o?n:t.length;if(p.current)if(p.current=!1,t.length>0)if(s){const S=Math.min(C,t.length);c(t.slice(0,S)),g.current=S}else c([t[0]]),g.current=1;else c([]),g.current=0;if(u){c(t),g.current=t.length;return}if(s&&!h.current&&(m.current&&(clearTimeout(m.current),m.current=null),c(()=>{const S=Math.min(C,t.length),E=t.slice(0,S);return g.current=E.length,E})),h.current=s,m.current&&(clearTimeout(m.current),m.current=null),g.current>=C||g.current>=t.length)return;const w=()=>{let S=0;if(c(E=>E.length<t.length&&E.length<C?(S=E.length+1,g.current=S,[...E,t[E.length]]):(S=E.length,g.current=S,E)),S<t.length&&S<C){const E=s?xp:r;m.current=setTimeout(w,E*1e3)}};if(g.current>0){const S=s?xp:r;m.current=setTimeout(w,S*1e3)}else t.length>0&&(c([t[0]]),g.current=1)},[t,n,r,s,u,o]);const y={initial:{opacity:0,x:-3},animate:{opacity:1,x:0}},b=()=>{d(!0)},_=o&&(r!==xp?s&&i.length<t.length:i.length<t.length),v=f.useCallback(C=>{C.stopPropagation(),b()},[]);return l.jsxs("div",{className:`flex items-center ${a?"flex-col items-start gap-px":"gap-sm flex-wrap"}`,children:[i.map((C,w)=>l.jsx(ze.div,{className:a?"w-full":"inline-flex",variants:y,initial:"initial",animate:"animate",transition:{duration:.1,ease:lf},children:C},w)),_&&l.jsx(Y,{variant:"subtler",bgHover:"subtle",className:"py-xs cursor-pointer rounded-lg px-2.5",onClick:v,children:l.jsx(B,{variant:"tinyMono",className:"!text-[0.68rem]",children:l.jsx(be,{defaultMessage:"+{count} more",id:"/zFGgPmQSV",values:{count:t.length-i.length}})})})]})}),cr=A.memo(function({icon:t,text:n,favicon:r,className:s,iconClassName:a,url:o}){const i=l.jsx(Y,{variant:"subtler",className:z("py-xs inline-block rounded-lg px-2",{"hover:bg-super group cursor-pointer":o},s),children:l.jsxs(B,{variant:"tinyRegular",className:z("gap-x-xs flex items-center",{"group-hover:text-inverse dark:group-hover:text-inverse":o}),children:[r?l.jsx("img",{src:r,alt:n,className:"size-[14px]"}):t?l.jsx(ye,{icon:t,size:"xs",className:a}):null,l.jsx("p",{className:"px-two",children:n})]})});return o?l.jsx(Dt,{href:o,target:"_blank",rel:"noopener",children:i}):i}),Vr=A.memo(function({queries:t,icon:n=D("search"),stepDelay:r,isFinished:s,initialDisplayCount:a=12,enableQueryLinks:o=!1}){const i=t.map((c,u)=>l.jsx(cr,{icon:n,text:c,url:o?`/search/new?q=${encodeURIComponent(c)}`:void 0},u));return l.jsx("div",{className:"gap-sm flex flex-wrap",children:l.jsx(hy,{items:i,initialDisplayCount:a,stepDelay:r,isFinished:s})})}),kye=A.memo(function({operations:t}){const{$t:n,formatMessage:r}=Q(),s=f.useMemo(()=>{const i={created:0,updated:0,deleted:0,rejected:0};return t.forEach(c=>{switch(c.status?.toUpperCase()){case"CREATED":i.created++;break;case"UPDATED":i.updated++;break;case"DELETED":i.deleted++;break;case"REJECTED":i.rejected++;break}}),i},[t]),a=f.useMemo(()=>{const i=[];return s.created>0&&i.push({count:s.created,label:n({defaultMessage:"Created",id:"ORGv1Q6rL/"})}),s.updated>0&&i.push({count:s.updated,label:n({defaultMessage:"Updated",id:"xrk6zgu9jU"})}),s.deleted>0&&i.push({count:s.deleted,label:n({defaultMessage:"Deleted",id:"KQvWvDRI1B"})}),s.rejected>0&&i.push({count:s.rejected,label:n({defaultMessage:"Rejected",id:"5qaD7sDVxu"})}),i},[s,n]),o=f.useMemo(()=>a.length===0?[]:[a.map(i=>r({defaultMessage:"{count} {status}",id:"e6QlErEcyz"},{count:i.count,status:i.label})).join(", ")],[a,r]);return o.length===0?null:l.jsx(Vr,{icon:D("calendar"),queries:o})}),Mye=()=>l.jsxs(Y,{variant:KC.subtler,className:"p-sm gap-sm flex h-[52px] w-fit min-w-[200px] items-center rounded-lg",children:[l.jsx(Y,{variant:"subtler",className:"aspect-square h-full rounded-md"}),l.jsxs("div",{className:"gap-xs flex flex-col",children:[l.jsx(Y,{variant:"subtler",className:"h-1.5 w-24 rounded-full"}),l.jsx(Y,{variant:"subtler",className:"h-1.5 w-16 rounded-full"})]})]}),Tye=A.memo(function({assetTypes:t,assetTypeLabels:n,isFinished:r}){const{$t:s}=Q();if(t.length===0)return l.jsxs("div",{className:"my-sm gap-sm flex flex-col",children:[l.jsx(B,{variant:"tinyRegular",color:r?"light":"super",className:"flex items-center gap-1",children:l.jsx(Tr,{variant:"super",active:!r,as:"span",speed:"slow",children:s({defaultMessage:"Creating an asset",id:"/gKNbCoSJB"})})}),l.jsx(Mye,{})]});const a=t[t.length-1],o=a?n[a]||a.toLowerCase():s({defaultMessage:"an asset",id:"+rur3MSgJV"});return l.jsx(Wt,{mode:"wait",children:l.jsx(ze.div,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},transition:{duration:.25,ease:[.4,0,.2,1]},children:l.jsx(B,{variant:"tinyRegular",color:r?"light":"super",className:"flex items-center gap-1 py-1.5",children:l.jsx(Tr,{variant:"super",active:!r,as:"span",speed:"slow",children:s({defaultMessage:"Creating {assetLabel}",id:"irVMYqmEjR"},{assetLabel:o})})})},a)})}),Aye=A.memo(function({step:t}){const n=t.content.clarification;return n?l.jsx("div",{className:"gap-sm flex flex-row",children:l.jsx(cr,{icon:D("message-plus"),text:n})}):null}),Nye=A.memo(function({step:t,action:n}){const{$t:r}=Q(),[s,a]=f.useState(!1),{final:o,status:i,script:c,output:u,stdout:d}=t.content,m=!o,p=i==="generating"||i==="executing",h=f.useCallback(()=>{a(x=>!x)},[]),g=d&&u?d+`
`+u:d||u||"",y=f.useMemo(()=>({language:"python"}),[]),b=!!c;return l.jsxs("div",{children:[l.jsx(st,{onClick:h,text:n,icon:D("message-circle-code"),isLoading:m,size:"tiny",pill:!0,chevron:b,chevronIcon:s?D("chevron-up"):D("chevron-down")}),s&&b&&l.jsxs("div",{className:"mb-sm mt-sm space-y-sm",children:[l.jsx("div",{className:"scrollbar-subtle max-h-[400px] overflow-y-auto",children:l.jsx(hl,{className:"text-xs",codeBlockProps:y,children:c})}),!p&&l.jsxs("div",{children:[l.jsx(B,{variant:"tiny",color:"light",children:r(g?{defaultMessage:"Output",id:"fio5opLcOZ"}:{defaultMessage:"This code did not produce an output",id:"UgqMuAXFKs"})}),g&&l.jsx("div",{className:"scrollbar-subtle max-h-[400px] overflow-y-auto",children:l.jsx(hl,{className:"text-xs",codeBlockProps:y,children:g})})]})]})]})}),Rye=A.memo(function({screenshot_uuid:t,screenshots:n}){const{taskScreenshots:r}=Sn(),s=r[t??""],o=(s?.length?s:n)?.[0];return o?l.jsx(Dye,{src:o,alt:"Browser screenshot",includeLightBoxModal:!0,containerClassName:"relative -mt-1.5 max-w-60 w-full rounded-lg overflow-hidden after:pointer-events-none after:absolute after:inset-0 after:rounded-lg after:ring-1 after:ring-inset after:ring-subtlest hover:shadow hover:after:ring-subtler transition-all duration-100",imageClassName:"object-cover w-full text-[0] dark:mix-blend-normal",maskClassName:"bg-subtler"}):null}),Dye=({containerClassName:e,enableRetry:t,...n})=>{const r=f.useRef(1),[s,a]=f.useState(n.src),[o,i]=f.useState(!1),c=f.useCallback(()=>{const u=Iye(n.src);!u||r.current>4||(u.searchParams.set("attempt",String(r.current)),r.current+=1,setTimeout(()=>a(u.toString()),300))},[n.src,r]);return l.jsx(to,{containerClassName:z(e,{"opacity-0":!o}),alt:"Browser screenshot",...n,src:s,onFail:t?c:void 0,onLoad:()=>i(!0)},s)},Iye=e=>{if(e)try{return new URL(e)}catch{return}},jye=A.memo(function({step:t,action:n}){const{final:r,file_name:s,page_count:a,word_count:o}=t.content,i=!r;let c=n;return s&&r&&(c=s,a!=null?(c+=` (${a} pages`,o!=null&&(c+=`, ${o} words`),c+=")"):o!=null&&(c+=` (${o} words)`)),l.jsx(st,{text:n,icon:D("file-type-docx"),isLoading:i,size:"tiny",pill:!0,toolTip:c,tooltipLayout:"top"})}),Pye=A.memo(function({status:t}){const{$t:n}=Q();let r=D("circle-check-filled"),s=n({defaultMessage:"Done",id:"JXdbo8Vnlw"});switch(t){case"SENT":r=D("circle-check-filled"),s=n({defaultMessage:"Email sent",id:"as7ksh6tP3"});break;case"FORWARDED":r=D("mail-forward"),s=n({defaultMessage:"Email forwarded",id:"QUWo2L2sfE"});break;case"REJECTED":r=D("x"),s=n({defaultMessage:"Email rejected",id:"+469cQAaqI"});break;default:r=D("circle-check-filled"),s=n({defaultMessage:"Done",id:"JXdbo8Vnlw"});break}return l.jsx(cr,{icon:r,iconClassName:"text-super",text:s})}),aF=A.memo(function({domain:t,url:n,suffix:r,isAccented:s,source:a,mcpServerSource:o,citationIcon:i,...c}){if(!n&&!t)return null;const u=t||Vf(n).replace(/^[a-z]{1,2}\./i,""),d=r?`${u}.${r}`:u,m=!i&&o?Jf(o)??void 0:void 0;return l.jsx(Bl,{label:d,truncate:!0,icon:i,iconUrl:m,isAccented:s,...c})}),Oye=(e,t,n)=>Se.makeQueryKey("/rest/entry/{entry_uuid_or_slug}/citation-excerpts",{entryUUID:e,webResultUrls:t,citationAnswerText:n}),Lye=async({entryUUID:e,webResultUrls:t,citationAnswerText:n,reason:r})=>{const{data:s,error:a,response:o}=await ve.GET("/rest/entry/{entry_uuid_or_slug}/citation-excerpts",r,{params:{path:{entry_uuid_or_slug:e},query:{citation_text:n,web_result_urls:t}}});if(a)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to get citation excerpts",cause:a,status:o.status??0});return s},oF=({entryUUID:e,webResultUrls:t,citationAnswerText:n,enabled:r=!1})=>{const s=r&&t.length>0&&!!e&&!!n,{data:a,isLoading:o,error:i}=gt({queryKey:Oye(e??"",t,n??""),queryFn:()=>Lye({entryUUID:e,webResultUrls:t,citationAnswerText:n,reason:"fetch citation excerpts during hover"}),enabled:s,staleTime:60*1e3,gcTime:60*1e3});return{citationExcerptStates:f.useMemo(()=>{if(s){if(o)return t.map(u=>({loading:!0,citationExcerpt:{web_result_url:u,sentence:"",sentence_chunks:[],text_fragment_url:u}}));if(i){Z.error("Failed to get citation excerpts",i);return}if(a)return a.excerpts.map(u=>({loading:!1,citationExcerpt:u}))}},[s,o,i,a,t]),isLoading:o,error:i}},Fye=Pe(async()=>{const{CitationModal:e}=await W(async()=>{const{CitationModal:t}=await import("./CitationModal-CGYEHO-8.js");return{CitationModal:t}},__vite__mapDeps([396,2,3,1,6,5,7,8,9,13,12,14,15,16,17]));return{default:e}});A.memo(function({children:t,result:n,webResultCitation:r,timestampComponent:s,linkProps:a,onYouTubeClick:o,onAttachmentClick:i,onCitationClick:c,asChild:u=!1}){const{openModal:d}=Kt(),m=f.useCallback(h=>{h.preventDefault(),h.stopPropagation(),d(Fye,{result:n,webResultCitation:r,timestampComponent:s,linkProps:a,onYouTubeClick:o,onAttachmentClick:i,onCitationClick:c})},[d,n,r,s,a,o,i,c]),p=u?CN:"span";return l.jsx(p,{onClick:m,children:t})});const iF=A.memo(function({webResults:t}){return!f.useMemo(()=>(Array.isArray(t)?t:[t]).some(s=>Io(s)),[t])||Array.isArray(t)?null:l.jsxs("span",{className:"text-2xs text-foregroundLight",children:["Patent data by"," ",l.jsx(Dt,{href:"https://www.lens.org",target:"_blank",rel:"noopener",className:"hover:text-super",children:"Lens.org"})]})}),Uye=A.memo(function({variant:t="medium",searchType:n}){const r=n==="memory",a=z("flex items-center justify-between w-full",t==="small"?"mb-0":"mb-2");return l.jsxs("div",{className:a,children:[l.jsxs(B,{className:"flex items-center gap-2",variant:"tiny",color:"light",children:[l.jsx(ye,{icon:r?D("bubble-text"):D("list-search"),size:"sm"}),r?l.jsx(be,{defaultMessage:"Memory",id:"dVx3yznM2C"}):l.jsx(be,{defaultMessage:"History",id:"djJp6cHQ6H"})]}),l.jsx(B,{variant:"tiny",color:"ultraLight",children:l.jsx(ye,{icon:D("user-search"),size:"sm"})})]})}),Bye=A.memo(function({className:t}){return l.jsx("div",{className:t,children:l.jsxs(B,{variant:"micro",color:"light",className:"text-pretty",children:[l.jsx(be,{defaultMessage:"This answer uses premium data sources. You're receiving complimentary access through your Perplexity subscription.",id:"u+XPNB2p9O"})," ",l.jsx(Al,{href:"https://www.perplexity.ai/help-center/en/articles/12870803-premium-data-sources",target:"_blank",variant:"inline",muted:!0,children:l.jsx(be,{defaultMessage:"Learn more",id:"TdTXXf940t"})})]})})}),lF=e=>e.is_scrubbed??!1,Hye=e=>cF(e)?lF(e):!1,cF=e=>e.is_memory||e.is_conversation_history,jE=e=>{const t=e.is_client_context,n=Hye(e);return t||n};function Vye(e){return!Yf(e)&&!!e.url&&!kl(e.url)&&!Pd(e.url)&&!e.is_memory&&!ZD(e)}const f1="text-foreground text-left hover:text-super focus:text-super leading-snug transition-color line-clamp-2 cursor-pointer font-sans text-sm font-medium duration-quick",Gye=({loading:e,citationExcerpt:t})=>e?l.jsxs("div",{className:"flex min-w-[300px] flex-col gap-2",children:[l.jsx(Y,{variant:"subtler",className:"h-2 w-full rounded-full"}),l.jsx(Y,{variant:"subtler",className:"h-2 w-full rounded-full"}),l.jsx(Y,{variant:"subtler",className:"h-2 w-full rounded-full"}),l.jsx(Y,{variant:"subtler",className:"h-2 w-full rounded-full"})]}):t===void 0?null:l.jsx(B,{variant:"small",color:"light",lineClamp:8,className:"mt-two border-super border-l-4 pl-2 font-normal",children:t.sentence_chunks.map((n,r)=>l.jsx("span",{className:n.is_keyword?"font-extrabold":void 0,children:n.content},r))}),uF=A.memo(function({result:t,webResultCitation:n,timestampComponent:r,linkProps:s,onYouTubeClick:a,onAttachmentClick:o,isFile:i=t.is_attachment??!1,downloadable:c=!1,isYouTubeVideo:u=!!(t.url&&kl(t.url)),citationExcerptState:d}){const m=t?.is_conversation_history??!1,p=t?.is_memory??!1,h=m||p,g=jE(t),y=lF(t),b=t.meta_data,x=y||h&&!g?null:b?.generated_file_title??t.name,_=n?.cited_texts??[],v=b?.generated_file_description??t.snippet,C=b?.authors,w=D0(t),S=Io(t),E=typeof b?.citation_domain_name=="string"?b?.citation_domain_name:void 0,T=Vye(t),k=t.url||g,M=l.jsxs("div",{className:"gap-1 flex flex-col select-none",children:[h&&!g?l.jsx(Uye,{variant:"medium",searchType:p?"memory":"conversation-history"}):l.jsxs("div",{className:"gap-sm flex flex-col",children:[(k||r)&&l.jsxs("div",{className:"flex items-center justify-between",children:[k&&l.jsx(gl,{className:"text-right",variant:"tinyRegular",color:"light",url:t.url??"",isAttachment:i,source:E,connectionType:b?.connection_type,mcpServerSource:b?.mcp_server,isPatent:S}),r,l.jsx(FI,{result:t})]}),u?l.jsx("button",{className:f1,onClick:a,children:x}):c?l.jsx("button",{className:f1,onClick:o,children:x}):T?l.jsx("span",{className:f1,children:x}):l.jsx("span",{className:"text-foreground mb-xs line-clamp-2 text-left font-sans text-sm",children:x})]}),C?l.jsx(B,{lineClamp:3,variant:"small",children:C.join(", ")}):null,y?l.jsx(B,{variant:"small",color:"light",children:l.jsx(be,{defaultMessage:"This is a private source.",id:"jKReyt0qq8",description:"Text shown when a source is private and obfuscated"})}):null,x!==t.name&&!p&&!y?l.jsx(B,{variant:"small",color:"light",children:t.name}):null,_.length>0?l.jsx("ul",{children:_.map((N,P)=>l.jsx("li",{className:"border-b last:border-b-0",children:l.jsx(B,{variant:"small",className:"line-clamp-[20] italic",children:N})},P))}):d?.loading||d?.citationExcerpt!==void 0?l.jsx(Gye,{loading:d?.loading??!1,citationExcerpt:d?.citationExcerpt}):v&&l.jsx(B,{variant:"small",color:"light",lineClamp:4,className:"whitespace-pre-wrap",children:v}),g&&!y?l.jsxs(Y,{className:"gap-xs pt-sm mt-sm flex items-center border-t",children:[l.jsx(B,{variant:"tiny",color:"super",children:l.jsx(ye,{size:"sm",icon:D("user-scan")})}),l.jsx(B,{variant:"tiny",color:"super",children:l.jsx(be,{defaultMessage:"Personal Search",id:"7+aLCEyqS2",description:"title"})})]}):null]});return l.jsxs("div",{className:"flex w-full flex-col gap-sm",children:[T?l.jsx(Dt,{href:t.url??"",target:"_blank",rel:"noopener nofollow",...s,children:M}):M,w?l.jsx(Bye,{}):null,l.jsx(iF,{webResults:t})]})});function zye(e={}){const{scrollContainerRef:t,enabled:n=!0}=e,r=f.useCallback(s=>{if(!n)return;const a=t?.current;a&&a.scrollBy({top:s.deltaY,left:s.deltaX,behavior:"instant"})},[t,n]);return f.useMemo(()=>({onWheel:r}),[r])}function qye(e,t=300){const n=f.useRef(!1);return f.useEffect(()=>{if(!e){n.current=!0;const s=setTimeout(()=>{n.current=!1},t);return()=>clearTimeout(s)}},[e,t]),{shouldBlockOpen:f.useCallback(()=>n.current,[])}}const dF=A.memo(function({open:t,onOpenChange:n,triggerElement:r,children:s,scrollContainerRef:a,align:o="start"}){const{shouldBlockOpen:i}=qye(t),c=f.useCallback(d=>{i()&&d||n(d)},[n,i]),{onWheel:u}=zye({scrollContainerRef:a,enabled:!!a});return l.jsx(fa,{interaction:"hover",open:t,onOpenChange:c,openDelayMs:200,closeDelayMs:200,side:"bottom",align:o,triggerElement:r,maxWidthPx:384,onWheelContent:u,children:s})}),j_=A.memo(function({hideHoverCard:t=!1,children:n,linkProps:r,result:s,webResultCitation:a,timestampComponent:o,onOpened:i,scrollContainerRef:c,triggerClassName:u,citationAnswerText:d,entryUUID:m,citationExcerptsOnHoverEnabled:p,onCitationClick:h}){const{isMobileStyle:g}=Be(),[y,b]=f.useState(!1),x=Qf(s),_=s.url??"",{citationExcerptStates:v}=oF({entryUUID:m,webResultUrls:f.useMemo(()=>_?[_]:[],[_]),citationAnswerText:d,enabled:y&&!!p&&!0&&!!m&&!!d}),C=v?.[0],w=s.meta_data,S=s.is_attachment??!1,E=Yf(s),T=w?.generated_file_title??s.name,k=!!(s.url&&kl(s.url)),M=f.useRef(!1),N=f.useCallback(()=>{M.current=!1,b(!1)},[]),P=f.useCallback(F=>{!F&&M.current||(t?b(!1):(b(F),F&&i?.()))},[t,i]),O=f.useCallback(()=>{M.current=!0},[]),L=f.useCallback(()=>{M.current=!1},[]),H=f.useCallback(()=>{N()},[N]);f.useEffect(()=>{if(typeof window>"u")return;function F(){M.current=!1}return document.addEventListener("visibilitychange",F),()=>{document.removeEventListener("visibilitychange",F)}},[]);const R=f.useCallback(F=>{!h||x||(h({webResult:s,event:F}),N())},[h,s,x,N]),I=f.useMemo(()=>l.jsx("span",{className:z("inline-flex",u),"aria-label":T,onPointerEnter:O,onPointerLeave:L,onClick:H,children:n}),[n,T,u,O,L,H]);return l.jsx(dF,{open:y,onOpenChange:P,triggerElement:I,scrollContainerRef:c,children:l.jsx("div",{className:"w-[304px] p-xs",children:l.jsx(uF,{result:s,webResultCitation:a,timestampComponent:o,linkProps:{...r,onClick:R},onYouTubeClick:R,onAttachmentClick:R,isFile:S,downloadable:E,isYouTubeVideo:k,citationExcerptState:C})})})}),$ye=({webResults:e,citationGroup:t,onCitationClick:n,onClose:r})=>{const s=Q(),a=f.useMemo(()=>e.every(u=>u.is_conversation_history),[e]),o=f.useMemo(()=>e.some(u=>D0(u)),[e]),i=f.useMemo(()=>{if(a)return s.formatMessage(gy);switch(t.category){case"memory":return s.formatMessage({defaultMessage:"Memory",id:"dVx3yznM2C"});case"attachment":return s.formatMessage({defaultMessage:"Attachments",id:"Vlx13nOMtX"});case"youtube":return s.formatMessage({defaultMessage:"YouTube",id:"zuA3BgDC6u"});default:return s.formatMessage({defaultMessage:"{count, plural, one {# source} other {# sources}}",id:"WrpI57Uej/"},{count:t.totalCount??e?.length})}},[t.category,a,s,t.totalCount,e.length]),c=f.useCallback(u=>d=>{n&&n({webResult:u,event:d}),d&&(d.metaKey||d.ctrlKey||d.shiftKey||d.altKey)||r?.()},[n,r]);return f.useMemo(()=>({webResults:e,headerText:i,hasPremiumSource:o,handleCitationClick:c}),[e,i,o,c])};function Wye(e){const t=new Date;return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function Kye(e,t){return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function Yye(e){const t=new Date;return t.setDate(t.getDate()-1),e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function fF(e){const t=new Date;return t.setDate(t.getDate()+1),e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function mF(e,t,n={numeric:"auto",style:"long"},r=1e3*60*60*24){if(!t)return"";const s=new Date(t);if(isNaN(s.getTime()))return"";const a=s.getTime()-Date.now(),o=Math.abs(a);return o<=1e3?"":o<1e3*60?e.formatRelativeTime(Math.round(a/1e3),"second",n):o<1e3*60*60?e.formatRelativeTime(Math.round(a/(1e3*60)),"minute",n):o<r&&o<1e3*60*60*24?e.formatRelativeTime(Math.round(a/(1e3*60*60)),"hour",n):o<r&&o>=1e3*60*60*24?e.formatRelativeTime(Math.round(a/(1e3*60*60*24)),"day",n):e.formatDate(s,{month:"short",day:"numeric",year:"numeric"})}function GYe(e,t){try{const n=+t,r={hours:Math.floor(n/3600),minutes:Math.floor(n%3600/60),seconds:Math.floor(n%60)},s={hours:"h",minutes:"m",seconds:"s"};if("DurationFormat"in Intl)return new Intl.DurationFormat(e,{style:"narrow",valueStyle:"narrow"}).format(r);let a="";for(const[o,i]of Object.entries(r))i>0&&(a+=`${i}${s[o]} `);return a.trim()}catch{return""}}function Qye(){const e=new Date,t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${r}`}function zYe(e){return e?e<=Qye():!1}function pF(e){const t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=e%60;return t>0?`${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}:${String(r).padStart(2,"0")}`:`${String(n).padStart(2,"0")}:${String(r).padStart(2,"0")}`}function Xye(e,t){if(!t)return"";const n=t.endsWith("Z")?t:`${t}Z`;return mF(e,n)??""}const ug=A.memo(function(t){const{children:n,timestamp:r,timestampProps:s,includeIcon:a=!0}=t,o=Q(),i=Xye(o,r);return i?l.jsxs(Y,{className:"gap-x-xs flex",children:[a?l.jsx(B,{variant:"tiny",color:"super",children:l.jsx(ye,{icon:D("bolt"),size:"xs"})}):null,l.jsxs(B,{variant:"tinyRegular",color:"light",...s,children:[n&&l.jsxs(l.Fragment,{children:[n," "]}),i]})]}):null}),Zye=Pe(async()=>{const{GroupedCitationModal:e}=await W(async()=>{const{GroupedCitationModal:t}=await import("./GroupedCitationModal-DcJKqD2v.js");return{GroupedCitationModal:t}},__vite__mapDeps([397,2,3,5,1,6,7,8,9,13,12,14,15,16,17]));return{default:e}});A.memo(function({children:t,webResults:n,citationGroup:r,onCitationClick:s,asChild:a=!1}){const{openModal:o}=Kt(),i=f.useCallback(u=>{u.preventDefault(),u.stopPropagation(),o(Zye,{webResults:n,citationGroup:r,onCitationClick:s})},[o,n,r,s]),c=a?CN:"span";return l.jsx(c,{onClick:i,children:t})});const Jye={small:{container:12,icon:10},default:{container:14,icon:12}},exe=A.memo(function({source:t,variant:n,isClipped:r,idSmall:s,idDefault:a}){const o=Jye[n],i=f.useMemo(()=>r?{clipPath:`url(#${n==="small"?s:a})`}:void 0,[r,n,s,a]),c=f.useMemo(()=>({width:o.container,height:o.container,...i}),[o.container,i]),u={"-ml-[5px]":n==="default","-ml-xs":n==="small"};if(t.brandedVisual){const{brandedVisual:d}=t;return l.jsx("div",{className:z("relative z-0 inline-flex shrink-0 items-center justify-center rounded-full text-super",d.kind==="icon"?"bg-background ring-1 ring-inset ring-super":"bg-super",u),style:c,children:d.kind==="icon"?l.jsx(ye,{icon:d.icon,size:o.icon}):l.jsx("img",{src:d.url,alt:"",width:o.icon,height:o.icon,className:"rounded-full"})})}if(t.isAttachment){const d=eI(t.url);return l.jsx(Y,{variant:"subtler",className:z("relative z-0 inline-flex shrink-0 items-center justify-center rounded-full",u),style:c,children:l.jsx(B,{variant:"small",color:"light",children:l.jsx(ye,{icon:d,size:o.icon})})})}return l.jsx("div",{className:z("relative z-0 inline-flex shrink-0 overflow-hidden rounded-full",u),style:c,children:l.jsx(ay,{domain:ys(t.url),size:o.container})})}),PE=A.memo(function({sources:t,count:n,variant:r="default",className:s}){const a="clip-path-small",o="clip-path-default",i=Math.min(t.length,n),c=f.useMemo(()=>{if(t.length===0)return[];const u=[],d=new Set,m=new Set;for(const p of t){if(u.length>=i)break;if(p.isAttachment){const h=Fl(p.url);h&&!m.has(h)&&(u.push(p),m.add(h))}else{const h=ys(p.url);d.has(h)||(u.push(p),d.add(h))}}if(u.length<i){const p=i-u.length;u.push(...t.slice(0,p))}return u.slice(0,i)},[t,i]);return i===0?null:l.jsxs(l.Fragment,{children:[l.jsx("svg",{width:14,height:14,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"absolute opacity-0",children:l.jsx("defs",{children:l.jsx("clipPath",{id:o,children:l.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.0635 0.704214C9.13824 0.253115 8.09868 0 7 0C3.13401 0 0 3.13401 0 7C0 10.866 3.13401 14 7 14C8.09868 14 9.13824 13.7469 10.0635 13.2958C8.19825 11.8312 7 9.55552 7 7C7 4.44448 8.19825 2.16882 10.0635 0.704214Z",fill:"#D9D9D9"})})})}),l.jsx("svg",{width:12,height:12,viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"absolute opacity-0",children:l.jsx("defs",{children:l.jsx("clipPath",{id:a,children:l.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.57242 0.57787C7.7928 0.20734 6.92062 0 6 0C2.68629 0 0 2.68629 0 6C0 9.31371 2.68629 12 6 12C6.92062 12 7.7928 11.7927 8.57242 11.4221C7.00228 10.1385 6 8.18628 6 6C6 3.81372 7.00228 1.86154 8.57242 0.57787Z",fill:"#D9D9D9"})})})}),l.jsx("div",{className:z("gap-xs relative flex shrink-0 items-center",s),children:l.jsx("div",{className:"ml-xs flex",children:c.map((u,d)=>l.jsx(exe,{source:u,variant:r,isClipped:d!==i-1,idSmall:a,idDefault:o},d))})})]})}),txe=A.memo(function({webResults:t,citationGroup:n,onCitationClick:r,onClose:s,webResultCitation:a,timestampComponent:o,linkProps:i,citationExcerptStates:c,citationExcerptsOnHoverEnabled:u,activeResultIndex:d,onActiveResultIndexChange:m,trackEvent:p}){const{headerText:h,hasPremiumSource:g,handleCitationClick:y}=$ye({webResults:t,citationGroup:n,onCitationClick:r,onClose:s}),b=f.useCallback(()=>{p?.("grouped citation arrow clicked",{citationGroupIndex:d,citationExcerptsOnHoverEnabled:u,citationGroupUrls:t.map(T=>T.url),arrowType:"previous",citationAnswerText:n.citationAnswerText}),m(Math.max(0,d-1))},[d,t,u,n.citationAnswerText,p,m]),x=f.useCallback(()=>{p?.("grouped citation arrow clicked",{citationGroupIndex:d,citationExcerptsOnHoverEnabled:u,citationGroupUrls:t.map(T=>T.url),arrowType:"next",citationAnswerText:n.citationAnswerText}),m(Math.min(t.length-1,d+1))},[d,t,u,n.citationAnswerText,p,m]),{$t:_}=Q(),v=d<t.length-1,C=d>0,w=t[d],S=c?.find(T=>T.citationExcerpt?.web_result_url&&T.citationExcerpt?.web_result_url===w?.url),E=f.useMemo(()=>t.filter(T=>T.url).map(T=>{const k=T.meta_data,M=em({url:T.url,meta_data:k});return{url:T.url,isAttachment:T.is_attachment??!1,source:k?.citation_domain_name,brandedVisual:M?.visual}}),[t]);return l.jsxs("div",{className:"-m-sm w-[304px]",children:[l.jsxs(Y,{className:"flex items-center justify-between py-sm px-3 border-b select-none",children:[l.jsxs("div",{className:"flex items-center -ml-sm gap-xs",children:[l.jsx(at,{variant:"text",size:"tiny",onClick:b,icon:D("chevron-left"),"aria-label":_({defaultMessage:"Previous",id:"JJNc3cbYIJ"}),rounded:!0,disabled:!C}),l.jsx(B,{variant:"smallCaps",color:"light",children:`${d+1}/${t.length}`}),l.jsx(at,{variant:"text",size:"tiny",onClick:x,icon:D("chevron-right"),"aria-label":_({defaultMessage:"Next",id:"9+DdtuCqLw"}),rounded:!0,disabled:!v})]}),l.jsxs("div",{className:"gap-sm flex col-start-1 row-start-1 duration-normal",children:[l.jsx("div",{className:"pointer-events-none",children:l.jsx(PE,{sources:E,count:n.totalCount??E.length})}),l.jsx(B,{variant:"tinyRegular",color:"light",children:h})]}),l.jsx(iF,{webResults:t})]}),l.jsx("div",{className:z("scrollbar-subtle overflow-y-auto p-3",{"max-h-[280px]":g,"max-h-60":!g}),children:l.jsx("div",{className:"space-y-px",children:w&&l.jsx(nxe,{result:w,webResultCitation:a,timestampComponent:o,linkProps:i,onClick:y(w),citationExcerptState:S},w.url)})})]})}),nxe=A.memo(function({result:t,webResultCitation:n,timestampComponent:r,linkProps:s,onClick:a,citationExcerptState:o}){const i=!!(t.url&&kl(t.url)),c=t.is_attachment||!1,u=Yf(t);return l.jsx(uF,{result:t,webResultCitation:n,timestampComponent:r,linkProps:{...s,onClick:a},onYouTubeClick:a,onAttachmentClick:a,isFile:c,downloadable:u,isYouTubeVideo:i,citationExcerptState:o})}),rxe=A.memo(function({renderTrigger:t,webResults:n,citationGroup:r,hideHoverCard:s=!1,onCitationClick:a,scrollContainerRef:o,entryUUID:i,citationExcerptsOnHoverEnabled:c,trackEvent:u,onOpened:d}){const[m,p]=f.useState(!1),[h,g]=f.useState(void 0),{isMobileStyle:y}=Be(),b=y&&!1,x=h??0,_=f.useRef(null),[v,C]=f.useState(void 0);f.useEffect(()=>{_.current&&v===void 0&&C(_.current.offsetWidth)},[v]);const w=f.useMemo(()=>n.map(R=>R.url).filter(Boolean),[n]),{citationExcerptStates:S}=oF({entryUUID:i,webResultUrls:w,citationAnswerText:r.citationAnswerText,enabled:m&&!!c&&!b&&!!i&&!!r.citationAnswerText}),E=n[x]??n[0],T=f.useRef(!1),k=f.useRef(!1);f.useEffect(()=>{if(m){g(0),k.current=!0,d?.();const R=setTimeout(()=>{k.current=!1},400);return()=>clearTimeout(R)}else{k.current=!1;const R=setTimeout(()=>{g(void 0)},200);return()=>clearTimeout(R)}},[m,d]);const M=f.useCallback(()=>{p(!1)},[]),N=f.useCallback(R=>{if(s){p(!1);return}const I=T.current&&R&&m,F=!R&&k.current;I||F||(R&&(T.current=!1),p(R))},[s,m]),P=f.useCallback(R=>{R.button===0&&(T.current=!0)},[]),O=f.useCallback(R=>{T.current=!1;const I=R.metaKey||R.ctrlKey||R.shiftKey||R.altKey;if(h===void 0||k.current){R.preventDefault(),m||(g(0),p(!0));return}if(I&&E?.url){R.preventDefault(),window.open(E.url,"_blank");return}a&&E&&a({webResult:E,event:R}),!R.defaultPrevented&&E?.url&&(R.preventDefault(),window.open(E.url,"_blank"))},[a,E,h,m]),L=f.useCallback(R=>{m&&(R.key==="ArrowLeft"?(R.preventDefault(),g(x===0?n.length-1:x-1)):R.key==="ArrowRight"&&(R.preventDefault(),g(x===n.length-1?0:x+1)))},[x,n.length,m]),H=f.useMemo(()=>l.jsx("span",{ref:_,className:"group/trigger inline-flex min-w-0",onPointerDown:P,onClick:O,onKeyDown:L,children:t({activeResult:E,isMobileWeb:b,width:v})}),[t,E,b,P,O,L,v]);return l.jsx(dF,{open:m,onOpenChange:N,triggerElement:H,scrollContainerRef:o,align:"start",children:l.jsx(txe,{webResults:n,citationGroup:r,onCitationClick:a,onClose:M,citationExcerptStates:S,citationExcerptsOnHoverEnabled:c,activeResultIndex:x,onActiveResultIndexChange:g,trackEvent:u})})}),hF="_entity_chip",P_="pplx-entity-id";function sxe(e){const t=e.match(/^pplx:\/\/entity_chip\/(?<id>.+)$/);if(!(!t||!t.groups?.id))return t.groups.id}const O_={key:"ts"};function m1(e,t){if(!t)return e;switch(t.key){case O_.key:{const n=new URL(e);return n.searchParams.set("t",String(t.value)),n.toString()}default:return e}}const axe=e=>typeof e=="object"&&"text"in e,oxe=(e,t,n,r,s,a,o)=>{let i=a||0;const c=t.map(u=>{const d=typeof u=="string"?u:u.text,m={start:{line:1,column:1,offset:i},end:{line:1,column:1,offset:i+d.length}};if(i+=d.length,e(d)){let p="#";return o&&(p=o(d)??""),{type:"link",url:p,title:s,children:[{type:"text",value:d,position:m}],...axe(u)&&u.metadata?.citationGroup&&{data:{citationGroup:u.metadata.citationGroup,hProperties:{dataCitationGroup:JSON.stringify(u.metadata.citationGroup)}}}}}return{type:"text",value:d,position:m}});return r.children.splice(n,1,...c),n+c.length},JM=(e,t)=>({offset:(e.offset??0)+(t.offset??0),line:e.line+t.line-1,column:e.line==1?e.column+t.column-1:e.column}),gF=(e,t,n=2)=>{n<0||e.position&&(e.position.start=JM(e.position.start,t),e.position.end=JM(e.position.end,t),e.children?.forEach(r=>gF(r,t,n-1)))};var Cr;(function(e){e.YOUTUBE="youtube",e.FILE="file",e.MEMORY="memory",e.CONVERSATION_HISTORY="conversation_history",e.WEB="web",e.NUMBERED="numbered",e.MEETING_TRANSCRIPT="meeting_transcript"})(Cr||(Cr={}));const qYe="data-pplx-citation",$Ye="data-pplx-citation-spacing",WYe="data-pplx-citation-url";function L_(e){if(e){if(Io(e))return D("award");if(e.url&&kl(e.url))return D("brand-youtube");if(e.is_memory)return D("bubble-text");if(e.is_conversation_history)return D("list-search");if(Qf(e))return D("microphone");if(e.is_attachment)return D("paperclip")}}const gy={defaultMessage:"History",id:"djJp6cHQ6H"};function ixe(e,t){if(!e)return;if(e.is_conversation_history)return t.formatMessage(gy);if(Io(e))return e.name;if(e.is_memory&&e.name)return e.name.toLocaleLowerCase();if(Qf(e)||e.is_attachment)return e.name;const n=e.meta_data;return n?.citation_domain_name||n?.domain_name||void 0}function yF(e){return{disableClick:e,linkBehavior:e?"none":"external"}}function lxe(e){const{category:t,isFile:n,isMemory:r,isConversationHistory:s,enableCitationGrouping:a,isMeetingTranscript:o}=e;return t==="youtube"?Cr.YOUTUBE:o?Cr.MEETING_TRANSCRIPT:n?Cr.FILE:a?r?Cr.MEMORY:s?Cr.CONVERSATION_HISTORY:Cr.WEB:Cr.NUMBERED}function cxe({citationType:e,cleanStr:t,fileName:n,webResult:r,annotation:s,enableCitationGrouping:a,linkBehavior:o,href:i,trackEvent:c,intl:u}){switch(e){case Cr.YOUTUBE:{const d=s?.key==="ts";return{label:a?d?pF(s.value):"YouTube":t,icon:d?void 0:D("brand-youtube")}}case Cr.FILE:{const d=r?Ote(r):void 0,m=d?Jf(d.toLowerCase())??void 0:void 0;return{label:a?n??t:t,icon:L_(r)??D("paperclip"),truncate:!0,linkBehavior:"onClick",className:"cursor-pointer",iconUrl:m}}case Cr.MEETING_TRANSCRIPT:return{label:n??t,icon:D("microphone"),truncate:!0,linkBehavior:"onClick"};case Cr.NUMBERED:return{label:t,icon:L_(r),linkBehavior:o,href:i,trackEvent:c};case Cr.MEMORY:return{label:r?.name?.toLocaleLowerCase()??t,icon:D("bubble-text"),truncate:!0,linkBehavior:"onClick"};case Cr.CONVERSATION_HISTORY:return{label:u.formatMessage(gy),icon:D("list-search"),truncate:!1,linkBehavior:"onClick"};case Cr.WEB:default:return}}function uxe({result:e,intl:t,citationSize:n,overflowCount:r,...s}){const a=ixe(e,t),o=e.meta_data;return l.jsx(aF,{domain:a,url:e.url,overflowCount:r??0,size:n,isAccented:xo(e),source:a,mcpServerSource:o?.mcp_server,citationIcon:L_(e),...s})}function xF({result:e,intl:t,options:{citationSize:n,overflowCount:r,trackEvent:s,onCitationClick:a,isMobileWeb:o=!1,annotation:i}}){const{disableClick:c,linkBehavior:u}=yF(o),d=c?void 0:h=>{const g=vS(e);s?.("click citation",{source:"inline",citation_url:e.url,...g}),a&&a({webResult:e,event:h}),!h?.defaultPrevented&&e.url&&(h?.preventDefault(),window.open(e.url,"_blank"))};return e.url&&kl(e.url)&&i?.key==="ts"?l.jsx(Bl,{size:n,onClick:d,forceExternalHandler:u==="external",isAccented:xo(e),overflowCount:r,label:pF(i.value)}):uxe({result:e,intl:t,citationSize:n,overflowCount:r,href:u==="external"?e.url:void 0,linkBehavior:u,trackEvent:s,onClick:d,forceExternalHandler:u==="external"})}const dxe=A.memo(function(t){const{str:n,href:r,className:s,trackEvent:a,isFile:o,isMeetingTranscript:i,isDownloadable:c,citationSize:u,onCitationClick:d,getAttachmentUrl:m,isMemory:p,isConversationHistory:h,citationGroup:g,enableCitationGrouping:y,citationDomain:b,fileName:x,webResult:_,isAccented:v,ref:C,forceExternalHandler:w,citationAnnotation:S,isMobileWeb:E=!1,...T}=t,k=Q(),M=Ec.test(n),{disableClick:N,linkBehavior:P}=yF(E);if(!M)return l.jsx("span",{children:n});const O=n.replace(/\[|\]|,.*$/g,""),L=g?.category==="youtube",H=!!(r&&!p&&!h&&!L&&!c&&!ZD(_)),R=lxe({category:g?.category,isFile:o,isMemory:p,isConversationHistory:h,enableCitationGrouping:y,isMeetingTranscript:i});if(R===Cr.WEB&&!_)return null;const I=y&&g&&g.citations.length>1,F=E?P:!H||I?"onClick":"external",j={size:u,onClick:N?void 0:X=>{_&&d&&d({webResult:_,event:X})},forceExternalHandler:w,isAccented:v,overflowCount:g?.overflowCount},$=cxe({citationType:R,cleanStr:O,fileName:x,webResult:_,annotation:S,enableCitationGrouping:y,linkBehavior:F,href:r,trackEvent:a,intl:k});let q;return $?q=l.jsx(Bl,{...j,label:$.label,icon:$.icon,truncate:$.truncate,linkBehavior:$.linkBehavior,className:$.className,iconUrl:$.iconUrl,href:$.href,trackEvent:$.trackEvent}):q=xF({result:_,intl:k,options:{citationSize:u,overflowCount:g?.overflowCount,trackEvent:a,onCitationClick:d,isMobileWeb:E,annotation:S}}),l.jsxs(l.Fragment,{children:[l.jsx("span",{className:z(s,"citation inline"),"data-pplx-citation":"","data-pplx-citation-url":r,ref:C,...T,children:q}),""]})}),fxe=function(t){const{ref:n,...r}=t,{anchor:s,className:a,...o}=r,i=d=>{const m=document.getElementById(d);m&&m.scrollIntoView({behavior:"smooth"})},c=s.replace(/\[|\]/g,""),u=f.useCallback(()=>i(`#search${s}`),[s]);return l.jsx(Dt,{href:`#search${s}`,onClick:u,className:a,ref:n,...o,children:l.jsx(Bl,{label:c})})},bF=Bt("MarkdownLinkContext",{}),mxe=A.memo(function(t){const{className:n,href:r,title:s,children:a,target:o="_blank",node:i,ref:c,...u}=t,{hideHoverCard:d=!1,trackEvent:m,citationSize:p,onCitationClick:h,getAttachmentUrl:g,enableCitationGrouping:y=!1,webResults:b=_e,EntityChipComponent:x,inlineTokenAnnotationsLookup:_,forceExternalHandler:v,scrollContainerRef:C,entryUUID:w,citationExcerptsOnHoverEnabled:S,isMobileWeb:E=!1}=f.useContext(bF),T=y&&i?.data?i.data.citationGroup:void 0,k=T?.citationAnnotations?.[0],M=f.useMemo(()=>{if(!(!T||T.citations.length<=1))return T.citations.map((he,ie)=>{const ue=b[he-1];if(!ue)return;const ce=T.citationAnnotations?.[ie];if(!ce)return ue;const me=m1(ue.url??"",ce);return{...ue,url:me}}).filter(he=>he!==void 0).sort((he,ie)=>{const ue=xo(he),ce=xo(ie);return ue&&!ce?-1:!ue&&ce?1:0})},[T,b]),N=i?.data?.webResult,P=M?.[0]??N,O=T&&T.citations.length>1,L=f.useMemo(()=>r&&m1(r,k),[r,k]),H=f.useMemo(()=>{if(!P)return;if(O)return P;const he=m1(P.url??"",k);return he!==P.url?{...P,url:he}:P},[P,k,O]),R=(H?.is_attachment??!1)||Io(H),I=i?.data?.webResultCitation,F=i?.data?.citationAnswerText,G=H?.is_memory??!1,j=H?.is_conversation_history??!1,$=Qf(H),q=Q(),{$t:U}=q,X=f.useCallback(({webResult:he,event:ie})=>{if(O){ie?.preventDefault();return}he&&h&&h({webResult:he,event:ie})},[O,h]),J=f.useMemo(()=>{if(!i||!_||!(P_ in i.properties))return;const he=i.properties[P_];if(typeof he=="string")return _[he]},[i,_]),ne=f.useMemo(()=>H?{onClick(he){if(m){const ie=vS(H);m("click citation",{source:"inline hoverCard",citation_url:H.url,...ie})}X({webResult:H,event:he})}}:void 0,[H,X,m]),ae=f.useMemo(()=>({color:"light"}),[]),de=f.useCallback((he,ie)=>()=>{m&&ie&&m("inline link clicked",{linkURL:r,linkText:A.Children.toArray(a).join(""),linkSurface:he,isNavLink:!1})},[r,a,m]),oe=f.useCallback(he=>()=>{m&&he&&m("inline link viewed",{linkURL:r,linkText:A.Children.toArray(a).join(""),isNavLink:!1})},[r,a,m]),le=f.useMemo(()=>({onClick:de("citation_hover_card",H)}),[de,H]),se=f.useMemo(()=>T?T.citations.some(he=>{const ie=b[he-1];return xo(ie)}):xo(H),[T,b,H]);let re;switch(s){case"_citation":{if(T?.isHidden)return null;re=l.jsx(dxe,{isMemory:G,isConversationHistory:j,onCitationClick:X,className:n,str:A.Children.toArray(a).join(""),href:L,rel:"nofollow noopener",trackEvent:m,isFile:R,isMeetingTranscript:$,isDownloadable:H?Yf(H):!1,citationSize:p,getAttachmentUrl:g,citationGroup:T,enableCitationGrouping:y,citationDomain:H?.meta_data?.citation_domain_name,fileName:H?.name,webResult:H,isAccented:se,ref:c,forceExternalHandler:v,citationAnnotation:k,isMobileWeb:E});break}case"_anchor_citation":{re=l.jsx(fxe,{anchor:A.Children.toArray(a).join(""),className:n,ref:c,...u});break}case hF:return!J||!x?null:l.jsx(x,{annotation:J,trackEvent:m,ref:c});default:{const{"aria-label":he,onClick:ie,...ue}=u,ce=(()=>{if(!(!b?.length||!r))return b.find(Oe=>Oe.url===r)})(),me=ce!==void 0,pe=!!(!me&&s),xe=l.jsx(Al,{variant:"inline",href:r,target:o,title:pe?s:void 0,rel:"nofollow noopener",ref:c,bold:!0,onTrackEvent:de("answer",ce),__dangerousDoNotUseOnClick:ie,...ue,children:a});me?re=l.jsx(j_,{result:ce,onOpened:oe(ce),linkProps:le,scrollContainerRef:C,onCitationClick:h,children:xe}):re=xe}}if(H){if(y&&T&&T.citations.length>1){const ie=({activeResult:ue,isMobileWeb:ce,width:me,activeIndex:pe})=>{const xe=T?.citationAnnotations?.[pe??0];return l.jsx("span",{className:z(n,"citation inline-flex min-w-0"),style:me?{width:`${me}px`}:void 0,ref:c,children:xF({result:ue,intl:q,options:{citationSize:p,overflowCount:T?.overflowCount,trackEvent:m,onCitationClick:h,isMobileWeb:ce,annotation:xe}})})};return l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"citation-nbsp"}),l.jsx(rxe,{webResults:M||[],citationGroup:T,renderTrigger:ie,hideHoverCard:d,onCitationClick:h,scrollContainerRef:C,entryUUID:w,citationExcerptsOnHoverEnabled:S,trackEvent:m,onOpened:()=>{m?.("citation popover viewed",{citationUrl:M?.[0]?.url,entryUUID:w,citationExcerptsOnHoverEnabled:S,citationAnswerText:T.citationAnswerText,isGrouped:!0})}})]})}return l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"citation-nbsp"}),l.jsx(j_,{hideHoverCard:d,linkProps:ne,result:H,timestampComponent:BO.isRecentlyTrending(H)?l.jsx(ug,{recentlyUpdatedLabel:U({defaultMessage:"Just now",description:"Label for recently updated content",id:"FlgDFQFpF1"}),timestamp:H.meta_data?.published_date??null,timestampProps:ae,children:"Updated"}):null,webResultCitation:I,citationAnswerText:F,scrollContainerRef:C,entryUUID:w,citationExcerptsOnHoverEnabled:S,onCitationClick:h,onOpened:()=>{m?.("citation popover viewed",{citationUrl:H.url,entryUUID:w,citationExcerptsOnHoverEnabled:S,citationAnswerText:F,isGrouped:!1})},children:re})]})}return re},fL),eT={APPLE_HEALTHKIT_LOCAL_MCP:"APPLE_HEALTHKIT_LOCAL_MCP",LOCAL_MCP:"LOCAL_MCP"},pxe={[$r.GOOGLE_DRIVE]:D("brand-google-drive"),[$r.ONEDRIVE]:D("brand-onedrive"),[$r.SHAREPOINT]:D("brand-windows"),[$r.DROPBOX]:D("custom-brand-dropbox"),[$r.BOX]:D("custom-brand-box"),[$r.GENERATED_IMAGE]:D("photo"),[$r.GENERATED_VIDEO]:D("slideshow"),[$r.WILEY]:D("custom-brand-wiley"),[$r.LOCAL]:D("file")},hxe={[eT.APPLE_HEALTHKIT_LOCAL_MCP]:D("heart"),[eT.LOCAL_MCP]:D("file")},_F=A.memo(function({url:t,mcpServerSource:n,isConversationHistory:r,isMemory:s,isInlineAttachment:a,connectionType:o,isAttachment:i,isPatent:c,isClientContext:u,isMeetingTranscript:d}){const m=f.useMemo(()=>{const p=Ph(t),h=i?eI(t):null,g=n?Jf(n):null,y=n?hxe[n]:null;if(r)return l.jsx(ye,{icon:D("list-search"),size:"xs"});if(c)return l.jsx(ye,{icon:D("award"),className:"size-3.5"});if(s)return l.jsx(ye,{icon:D("bubble-text"),size:"xs"});if(d)return l.jsx(ye,{icon:D("microphone"),size:"xs"});if(y)return l.jsx(ye,{icon:y,size:"xs"});if(o){const b=pxe[o];return b?l.jsx(ye,{icon:b}):l.jsx(bf,{domain:p,overrideIconUrl:g||void 0})}else return a?l.jsx(ye,{icon:D("paperclip"),size:"xs"}):i?l.jsx(ye,{icon:h||D("file"),size:"xs"}):u?l.jsx(ye,{icon:D("hourglass-high"),size:"xs"}):l.jsx(bf,{domain:p,overrideIconUrl:g||void 0})},[t,i,n,r,c,s,d,o,a,u]);return l.jsx("div",{className:"flex size-4 items-center justify-center",children:m})}),vF=A.memo(function({url:t,source:n,isAttachment:r,connectionType:s,isConversationHistory:a,isPatent:o}){const i=Q(),c=f.useMemo(()=>{if(a)return i.formatMessage(gy);if(o)return i.formatMessage(jre.patents);if(n!=null)return n;let u;return r?u=El(t):s?u=EI(s):u=ys(t),u.replace(/\.[^.]*$/,"")},[t,n,r,s,a,o,i]);return l.jsx(l.Fragment,{children:c})}),gxe=A.memo(function({url:t,source:n,isAttachment:r,isClientContext:s,variant:a="small",color:o="default",truncate:i=!0,className:c,connectionType:u,mcpServerSource:d,isInlineAttachment:m,isMemory:p,isPatent:h,isConversationHistory:g,name:y,snippet:b,isMeetingTranscript:x,..._}){return l.jsxs(Y,{className:"flex items-center gap-x-1.5 min-w-0",children:[l.jsx(B,{variant:a,className:"relative flex-none",color:p||g?"light":o,children:l.jsx(_F,{url:t,source:n,mcpServerSource:d,isConversationHistory:g,isMemory:p,isInlineAttachment:m,connectionType:u,isAttachment:r,isPatent:h,isClientContext:s,isMeetingTranscript:x})}),y&&l.jsx(B,{variant:a,color:o,..._,className:z(c,"min-w-0 truncate"),children:y}),l.jsx(B,{variant:a,color:y?"light":o,className:z("truncate min-w-0 grow break-all transition-all duration-300",{"max-w-[150px]":(n!=null||h)&&i},c),..._,children:l.jsx(vF,{url:t,source:n,isAttachment:r,connectionType:u,isMemory:p,isConversationHistory:g,isPatent:h})})]})}),gl=Object.assign(gxe,{Icon:_F,Source:vF}),yxe=A.memo(function({onClick:t,urls:n}){const r=f.useMemo(()=>n.map(s=>l.jsx(xxe,{url:s,onClick:t},s)),[t,n]);return l.jsx("div",{className:"gap-sm flex flex-wrap",children:l.jsx(hy,{items:r,initialDisplayCount:1})})}),xxe=A.memo(function({url:t,onClick:n}){const r=f.useCallback(()=>{n?.(t)},[t,n]);return l.jsx(Dt,{className:"block",href:t,target:"_blank",rel:"noopener nofollow",onClick:r,children:l.jsx(Y,{variant:"subtler",bgHover:"subtle",className:"py-xs rounded-lg pl-1.5 pr-2.5",children:l.jsx(gl,{variant:"tinyMono",className:"!text-[0.7rem]",url:t,isAttachment:!1,connectionType:$r.GENERATED_VIDEO,source:"Generated Video"})})},t)}),bxe=A.memo(function({prompt:t,success:n}){const{$t:r}=Q(),[s,a]=f.useState(!1),[o,i]=f.useState(!1),c=f.useRef(null);f.useLayoutEffect(()=>{const p=c.current;p&&!s&&i(p.scrollHeight>p.clientHeight)},[t,s]);const u=f.useCallback(()=>{a(p=>!p)},[]);if(!t)return null;const d=o||s,m=n===!1;return l.jsxs("div",{className:z("rounded-lg p-3",m?"bg-caution/10":"bg-subtler",d&&"cursor-pointer"),onClick:d?u:void 0,children:[l.jsx("div",{ref:c,className:z("text-default text-sm leading-relaxed",!s&&"line-clamp-2"),children:t}),d&&l.jsxs("button",{className:"text-light hover:text-default mt-2 flex items-center gap-0.5 text-xs",onClick:p=>{p.stopPropagation(),u()},children:[r(s?{defaultMessage:"Show less",id:"qyJtWyZ0yt"}:{defaultMessage:"Show more",id:"aWpBzjCXKS"}),l.jsx(ye,{icon:s?D("chevron-up"):D("chevron-down"),size:"xs"})]})]})}),tT=A.memo(function({color:t,title:n}){const r="bg-[#13343B] dark:bg-[#F5F5F5]",a=(o=>o?{red:"bg-[#C0152F] dark:bg-[#FF5459]",maroon:"bg-[#944454] dark:bg-[#B3C901]",orange:"bg-[#DB7100] dark:bg-[#FFAB44]",teal:"bg-[#21808D] dark:bg-[#32B8C6]",grey:r,brown:"bg-[#A84B2F] dark:bg-[#E68161]",green:"bg-[#848456] dark:bg-[#B4B662]",gold:"bg-[#D39900] dark:bg-[#F0B435]",purple:"bg-[#865D95] dark:bg-[#C48ED8]",blue:"bg-[#19789E] dark:bg-[#54B4E3]"}[o]??r:r)(t);return l.jsx("div",{className:z("py-xs w-fit rounded-md px-2.5",a),children:l.jsx(B,{className:"translate-y-half",variant:"tiny",color:"defaultInverted",children:n})})}),_xe=(e,t=1e4,{showTruncationIndicator:n=!0,format:r=!1}={})=>{if(e.length<=t)return r?CF(e):e;let s=t;const a=Math.max(0,t-100);for(let c=t-1;c>=a;c--){const u=e[c];if(u===","||u===`
`||u===" "||u==="	"){s=c;break}}const o=e.substring(0,s).trim(),i=r?vxe(e,o):o;if(n){const c=`

// Content truncated at ${s} characters (original: ${e.length} chars)`;return i+c}return i};function CF(e){try{return tg(JSON.parse(e))}catch{return e}}function vxe(e,t){const n=CF(e),r=t.replace(/\s/g,"").length;let s=0,a=n;for(let i=0;i<n.length;i++)/\s/.test(n[i]??"")||(s++,s===r&&(a=n.substring(0,i+1)));const o=t.at(-1);for(let i=a.length-1;i>=0;i--)if(a[i]===o){a=a.substring(0,i+1);break}return a}const Cxe={language:"json"},wxe=2e3,F_=({content:e,title:t,maxContentLength:n=wxe,truncationOptions:r={showTruncationIndicator:!1,format:!0},className:s,isError:a=!1,showTruncationMessage:o=!0})=>{const{formatNumber:i}=Q(),{processedContent:c,originalLength:u}=f.useMemo(()=>{if(typeof e=="string")return{processedContent:_xe(e,n,r),originalLength:e.length};if(e&&typeof e=="object"){const p=tg(e);return{processedContent:p,originalLength:p.length}}const m=String(e);return{processedContent:m,originalLength:m.length}},[e,n,r]),d=u>n;return l.jsxs(Y,{className:z("rounded-lg",s),variant:"subtler",children:[l.jsx(B,{variant:"tiny",className:z("p-md pb-0",a&&"text-negative"),children:t}),l.jsx(hl,{className:"p-sm !my-0 pt-0 text-xs",codeBlockProps:Cxe,hideTools:!0,children:c||"No content"}),o&&d&&l.jsx("div",{className:"bg-subtler flex items-center justify-center rounded-b p-2",children:l.jsx(B,{variant:"tiny",color:"light",children:l.jsx(be,{defaultMessage:"Content truncated at {truncatedSize} (original size: {originalSize})",id:"ipA00V5aGw",values:{truncatedSize:i(n/1024,{maximumFractionDigits:0,style:"unit",unit:"kilobyte",unitDisplay:"narrow"}),originalSize:i(u/1024,{maximumFractionDigits:0,style:"unit",unit:"kilobyte",unitDisplay:"narrow"})}})})})]})},nT="clicked enterprise ad",rT="https://www.perplexity.ai/enterprise",Sxe="/onboarding/org/create",Exe=()=>{const{session:e}=je(),{trackEvent:t}=Ze(e),n=hn(),r=f.useCallback(async h=>{h?.preventDefault(),t(nT,{source:"settingsHeader"}),n.push(rT)},[t,n]),s=f.useCallback(async h=>{h.preventDefault(),t(nT,{source:"paywall"}),n.push(rT)},[t,n]),a=f.useCallback(async h=>{h?.preventDefault(),t("enterprise pro onboarding started",{origin:Ke.SETTINGS}),n.push(Sxe)},[t,n]),o=f.useCallback(({invitedEmail:h,source:g,orgUUID:y,inviteType:b})=>{t("org user invited",{invitedEmail:h,source:g,orgUUID:y,inviteType:b})},[t]),i=f.useCallback(({invitedEmails:h,inviteCount:g,successCount:y,failureCount:b,source:x,orgUUID:_,inviteType:v})=>{t("org users bulk invited",{invitedEmails:h,inviteCount:g,successCount:y,failureCount:b,source:x,orgUUID:_,inviteType:v})},[t]),c=f.useCallback(({orgUUID:h})=>{t("org invite step completed",{orgUUID:h})},[t]),u=f.useCallback(({orgUUID:h,source:g,intent:y,success:b,orgDraftUuid:x,subscriptionTier:_})=>t("org payment portal entered",{orgUUID:h,source:g,intent:y,success:b,orgDraftUuid:x,subscriptionTier:_}),[t]),d=f.useCallback(h=>{t("org creation intent",h)},[t]),m=f.useCallback(({orgUUID:h,success:g})=>{t("sso enabled",{orgUUID:h,success:g})},[t]),p=f.useCallback(h=>{t("mcp tool action",h)},[t]);return f.useMemo(()=>({handleSettingsHeaderAdClick:r,handleSettingsUpgradeClick:a,handlePaywallAdClick:s,trackOrgUserInvited:o,trackOrgUsersBulkInvited:i,trackOrgInviteStepCompleted:c,trackOrgPaymentPortalEntered:u,trackOrgCreationIntent:d,trackSSOEnabled:m,trackMcpToolApprovalAction:p}),[s,r,a,d,c,u,o,i,m,p])},kxe=A.memo(function({appName:t,appLogo:n,step:r,isFinished:s,onApprove:a,onActionTaken:o}){const{$t:i}=Q(),[c,u]=f.useState(!1),{isMobileStyle:d,isMobileUserAgent:m}=Be(),[p,h]=f.useState(!1),[g,y]=f.useState(""),[b,x]=f.useState(null),_=eF(),{trackMcpToolApprovalAction:v}=Exe(),C=r.content.tool_input_summary||i({defaultMessage:"This tool will perform an action",id:"m3EA/HeMzd"}),w=r.content,S=r.mcp_tool_output_content,E=w.request_user_approval?.uuid,T=_.isPending,k=T||s||!!b,M=f.useCallback(()=>{x(null)},[]),N=f.useCallback(R=>{if(E){if(R==="MODIFY"){h(!0);return}v({toolName:w.tool_name||"unknown_tool",appName:w.app||"unknown_app",entryUUID:E||"unknown_uuid",action:R}),x(R),_.mutate({uuid:E,allowToolCall:R},{onSuccess:()=>{o?.(),a?.()},onError:()=>{M()}})}},[E,_,M,w,v,a,o]),P=f.useCallback(()=>{!E||!g.trim()||(x("MODIFY"),v({toolName:w.tool_name||"unknown_tool",appName:w.app||"unknown_app",entryUUID:E||"unknown_uuid",action:"MODIFY"}),_.mutate({uuid:E,allowToolCall:"MODIFY",userRevision:g},{onSuccess:()=>{o?.()},onError:()=>{M()}}))},[E,g,_,M,w,v,o]),O=f.useCallback(()=>{h(!1),y(""),x(null)},[]),L=w.data_is_redacted===!0||S?.data_is_redacted===!0,H=f.useCallback(()=>{L||u(R=>!R)},[L]);return l.jsxs(Y,{className:"p-sm group-hover:bg-background grid grid-cols-[max-content_1fr] gap-x-2 gap-y-1 rounded-lg border pb-7 pl-4",variant:"raised",children:[l.jsxs("div",{className:z("col-span-full grid grid-cols-subgrid items-center",{"cursor-pointer":!L}),onClick:H,children:[n&&l.jsx("img",{src:n,alt:`${w.app} Logo`,className:"size-4 rounded object-cover"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(B,{variant:"smallBold",children:t}),!L&&l.jsx("div",{className:"ml-auto flex items-center gap-2",children:l.jsx(pt,{size:"small",pill:!0,icon:c?D("chevron-down"):D("chevron-right")})})]})]}),l.jsxs("div",{className:"col-start-2 col-end-3 flex min-w-0 flex-col",children:[l.jsx(B,{variant:"small",className:"text-pretty sm:pr-8",children:C}),l.jsx(EF,{isExpanded:c,mcpContent:w,mcpOutputContent:S}),l.jsx(ba,{mode:"popLayout",initial:!1,transition:{duration:.2,ease:rr},children:p&&l.jsx(bs,{children:l.jsx(Ul,{value:g,onChange:y,placeholder:i({defaultMessage:"What would you like to change?",id:"VkWAi878bt"}),isMobileStyle:d,isMobileUserAgent:m,disabled:T,minRows:3,className:"mt-4"})})}),l.jsx(Y,{className:"mt-4 flex items-center gap-2",children:p?l.jsxs(l.Fragment,{children:[l.jsx(st,{variant:"inverted",size:"small",text:i({defaultMessage:"Continue",id:"acrOozm08x"}),onClick:P,disabled:k||!g.trim()}),l.jsx(st,{variant:"border",size:"small",text:i({defaultMessage:"Cancel",id:"47FYwba+bI"}),onClick:O,disabled:T,extraCSS:"bg-transparent"})]}):l.jsxs(l.Fragment,{children:[l.jsx(st,{variant:"inverted",size:"small",text:i({defaultMessage:"Approve",id:"WCaf5CZSTt"}),onClick:()=>N("ALLOW"),disabled:k}),l.jsx(st,{variant:"common",size:"small",text:i({defaultMessage:"Refine",id:"EBZvikr2Av"}),onClick:()=>N("MODIFY"),disabled:k}),l.jsx(st,{variant:"border",size:"small",text:i({defaultMessage:"Skip",id:"/4tOwTiCH6"}),onClick:()=>N("DENY"),disabled:k,extraCSS:"ml-auto border-none bg-transparent mr-2"})]})})]})]})}),OE=()=>{const{session:e}=je(),{firstResult:t,inFlight:n}=Ht(),r=t?.author_username;return e?.user?.username===r||n},Mxe=1e4,Txe=1e3*60,Axe=["comet-default-browser-status"],Nxe=()=>{const e=Xt(),{data:t=null,isLoading:n,refetch:r}=gt({queryKey:Axe,queryFn:async()=>{try{return await e.getIsCometDefaultBrowser("check_default_browser")}catch{return null}},refetchInterval:s=>s?.state?.data?Txe:Mxe,refetchIntervalInBackground:!0,staleTime:0});return{isDefaultBrowser:t,isDefaultBrowserLoading:n,refetch:r}},Rxe=()=>{const e=It(),t=wu(),n=f.useMemo(()=>e.getQueryData(t),[e,t]),{connectors:r}=ga({reason:"useHasUnauthenticatedGmailGcal"});return f.useMemo(()=>{const s=!!r?.connectors.find(a=>a.name==="gcal"&&(!a.connected||a.has_required_scopes===!1));return!(!n||!s)},[n,r])},Dxe=({position:e,inFlight:t,isLastResult:n,upsellInformation:r,backendUuid:s,isThreadAuthor:a})=>{const[o,i]=f.useState(!1),[c,u]=f.useState(null);eo();const d="sidecar_thread",{session:m}=je(),{trackEventOnce:p,trackEvent:h}=Ze(m),g=Rxe(),{subscriptionTier:y}=Mt(),{isDefaultBrowser:b}=Nxe(),x=f.useMemo(()=>{if(o||!r||!r?.title||r.upsell_type==="UNSET"||e==="top"&&r.app_location!=="IN_THREAD"||e==="bottom"&&r.app_location!=="IN_THREAD_BOTTOM"||e==="input"&&r.app_location!=="IN_THREAD_INPUT"||e==="connector_auth"&&r.app_location!=="UPSELL_APP_LOCATION_UNSPECIFIED")return!1;const C=r.upsell_uuid;return!(!s||C===c||!n&&(!r.is_persistent||e==="input"||e==="router_steps"||e==="connector_auth")||e==="bottom"&&t||r.is_persistent&&(!a||r.name==="gmail_gcal_connector"&&!g||r.name==="comet_set_default_browser"&&b!==!1))},[o,r,e,s,c,n,t,a,g,b]);f.useEffect(()=>{r?.upsell_type==="UNSET"&&i(!1)},[r?.upsell_type]),f.useEffect(()=>{if(!x||!r)return;const C=s,w=r.upsell_uuid;u(w??null),i(!0),r.upsell_type&&(p("thread upsell banner viewed",{entryUUID:C,upsellType:r.upsell_type,upsellName:r.name??"",upsellUuid:r.upsell_uuid??"",cometSurface:d,subscriptionTier:y,eventMetadata:r.event_metadata}),p("upsell viewed",{upsellLocation:r.app_location??"",upsellUUID:r.upsell_uuid??"",entryUUID:C,upsellType:r.upsell_type,upsellName:r.name??"",cometSurface:d,subscriptionTier:y,eventMetadata:r.event_metadata}))},[s,x,p,r,d,y]);const _=f.useCallback(({hideBanner:C=!0}={})=>{C&&i(!1);const w=r,S=s;if(S&&w?.upsell_type){h("thread upsell banner dismissed",{entryUUID:S,upsellType:w.upsell_type??"",upsellName:w.name??"",upsellUuid:w.upsell_uuid??"",cometSurface:d,subscriptionTier:y,eventMetadata:w.event_metadata}),h("upsell dismissed",{upsellLocation:w.app_location??"",upsellUUID:w.upsell_uuid??"",entryUUID:S,upsellType:w.upsell_type??"",upsellName:w.name??"",cometSurface:d,subscriptionTier:y,eventMetadata:w.event_metadata});const E=w.cta==="SHORTCUT_MODAL"?w.cta_information?.recommended_shortcut?.name:void 0;WP({upsellName:w.name??"",upsellInstanceIdentifier:E,interactionType:"dismiss"})}},[s,h,r,d,y]),v=f.useCallback(()=>{i(!1)},[]);return f.useMemo(()=>({show:o,handleDismiss:_,handleHide:v}),[_,o,v])},Ixe="LANGUAGE_LEARNING_AUTOPLAY",jxe=/\[([^\]]+)\]\(pplx:\/\/action\/translate\)/g;function Pxe(e){const t=Array.from(e.matchAll(jxe)).map(n=>n[1]).filter(n=>n!==void 0);return[...new Set(t)]}const p1=async({queryKey:e})=>{const[t,n="",r=""]=Se.unmakeQueryKey(e);return wF({entryUUID:n,reason:"useThreadTranslations",phrase:r})},Oxe=(e,t)=>{switch(t.type){case"NEXT":{const n=e.currentIndex+1,r=n%e.translatePhrases.length;return!t.canLoop&&n!==r?(t.onPageChange?.(null),e):(t.onPageChange&&t.fetchTranslatedPhrase(e.translatePhrases[r]).then(s=>{t.onPageChange?.(s)}),{...e,currentPhrase:e.translatePhrases[r],currentIndex:r})}case"PREV":{const n=e.currentIndex-1+e.translatePhrases.length,r=n%e.translatePhrases.length;return!t.canLoop&&n!==r?(t.onPageChange?.(null),e):(t.onPageChange&&t.fetchTranslatedPhrase(e.translatePhrases[r]).then(s=>{t.onPageChange?.(s)}),{...e,currentPhrase:e.translatePhrases[r],currentIndex:r})}default:return e}},Lxe=()=>{const{result:e}=Pt();return f.useMemo(()=>{const t=Yt.parseAskTextField(e);return t?Pxe(t.answer):[]},[e])},Fxe=({clickedPhrase:e,entryUUID:t,contextUUID:n,translatePhrases:r})=>{const{session:s}=je(),{trackEvent:a}=Ze(s),o=f.useCallback((v,C)=>{a("language learning modal advance pressed",{entryUUID:t,contextUUID:n,direction:v,source:C})},[t,n,a]),[i,c]=f.useReducer(Oxe,{currentIndex:e?r.indexOf(e):0,translatePhrases:r,currentPhrase:e??r[0]}),u=i.currentPhrase,d=i.currentIndex,m=Se.makeQueryKey("translation_phrase_info",t,u),p=It();f.useEffect(()=>{const v=r[(r.length+d-1)%r.length],C=r[(d+1)%r.length];p.prefetchQuery({queryKey:Se.makeQueryKey("translation_phrase_info",t,v),queryFn:p1}),p.prefetchQuery({queryKey:Se.makeQueryKey("translation_phrase_info",t,C),queryFn:p1})},[t,r,d,p]);const{data:h,isLoading:g}=gt({queryKey:m,queryFn:p1}),y=f.useCallback(async v=>wF({entryUUID:t,reason:"useThreadTranslations",phrase:v}),[t]),b=f.useCallback(({onPageChange:v,source:C,canLoop:w})=>{c({type:"NEXT",onPageChange:v,fetchTranslatedPhrase:y,canLoop:w}),o("forward",C)},[o,y]),x=f.useCallback(({onPageChange:v,source:C,canLoop:w})=>{c({type:"PREV",onPageChange:v,fetchTranslatedPhrase:y,canLoop:w}),o("backward",C)},[o,y]),{data:_}=gt({queryKey:Se.makeQueryKey("translation_detected_languages",t),queryFn:()=>Uxe({entryUUID:t,reason:"useThreadTranslations"})});return{groupedTranslation:h,isLoading:g,advancePage:b,previousPage:x,translatePhrases:r,currentPhrase:u,currentIndex:d,detectedLanguages:_}},wF=async({entryUUID:e,reason:t,phrase:n})=>{const{data:r,error:s}=await ve.POST("/rest/translation/phrase_info",t,{body:{entry_uuid:e,translated:n},timeoutMs:3e4});return s?(Z.error(`Failed to fetch translated phrases for entry ${e}`),null):r?.translation??null},Uxe=async({entryUUID:e,reason:t})=>{const{data:n}=await ve.GET("/rest/translation/detect-languages/{entry_uuid}",t,{params:{path:{entry_uuid:e}},timeoutMs:5e3});return n||(Z.error(`Failed to detect languages for entry ${e}`),null)},Es={pro:D("custom-perplexity-copilot"),collection:D("layout-grid"),research:D("telescope"),labs:D("table-plus"),pro_perks:D("heart-handshake"),app:D("layout-collage"),slides:D("presentation"),document:D("file"),plaintext:D("file"),canvas:D("file"),advanced_models:D("cpu"),map_pin:D("map-pin")},Bxe=A.memo(function({variant:t,url:n,openInNewTab:r,upsellInformation:s}){const{$t:a}=Q(),{session:o}=je(),{trackEvent:i}=Ze(o),c=f.useCallback(()=>{s&&i("upsell clicked",{upsellLocation:s.app_location??"UPSELL_APP_LOCATION_UNSPECIFIED",upsellUUID:s.upsell_uuid,upsellName:s.name,upsellType:s.upsell_type,cta:"PERMALINK"}),n&&(r?window.open(n,"_blank"):oa(n,"Learn more from upsell"))},[n,r,i,s]);return l.jsx(at,{variant:t,size:"small",onClick:c,children:a({defaultMessage:"Learn more",id:"TdTXXf940t"})})}),Hxe=A.memo(function({upsellInformation:t,inFlight:n,position:r,onButtonClick:s,isLoading:a,textButtonIfSecondary:o=!1,hideUpsell:i,verticalLayout:c=!1}){const u=rl({upsellInformation:t,inFlight:n,options:{hideUpsell:i}}),d=f.useCallback(()=>{s?.(),u()},[s,u]),m=f.useCallback(E=>{if(r==="router_steps")return"inverted";switch(E){case"MAX_COLOR":return"maxGold";case"PRIMARY_COLOR":return"primary";case"INVERTED":return"inverted";default:return"common"}},[r]),p=f.useMemo(()=>m(t?.button_color),[m,t?.button_color]),h=t?.cta_information?.secondary_button,g=t?.cta_information?.tertiary_button,y=f.useMemo(()=>h?{...t,cta:h.cta,button_text:h.button_text}:t,[t,h]),b=f.useMemo(()=>g?{...t,cta:g.cta,button_text:g.button_text}:t,[t,g]),x=rl({upsellInformation:y,inFlight:n,options:{hideUpsell:i}}),_=rl({upsellInformation:b,inFlight:n,options:{hideUpsell:i}}),v=f.useCallback((E,T)=>{const k=m(E.button_color),M=E.button_color==="SECONDARY_COLOR",P={size:"regular",onClick:()=>{s?.(),T()},text:E.button_text,textClassName:"!text-sm",fullWidth:!0};return o&&M?l.jsx(pt,{...P,variant:"super",noPadding:!0}):l.jsx(st,{...P,variant:k})},[m,o,s]),C=f.useCallback(E=>{let T;t?.icon_reference==="comet_download"&&(T=l.jsx(ut,{name:D("download"),size:16}));const k={size:E?"regular":"small",onClick:d,text:t?.button_text,leadingComponent:T,textClassName:E?"!text-sm":void 0,fullWidth:!0,isLoading:a};return o&&t?.button_color==="SECONDARY_COLOR"?l.jsx(pt,{...k,variant:"super",noPadding:!0}):l.jsx(st,{...k,variant:p})},[p,d,t?.button_color,t?.button_text,t?.icon_reference,o,a]),w=h||g,S=!w&&t?.cta_information?.secondary_permalink;if(w){const E=[C(!0),h&&v(h,x),g&&v(g,_)].filter(Boolean);return E.length===1?E[0]:l.jsx("div",{className:z("gap-md flex",c?"flex-col":"flex-row"),children:c?E:[...E].reverse()})}if(S){const E=t?.cta_information?.secondary_permalink,T=t?.cta_information?.secondary_permalink_new_tab,k=l.jsx(Bxe,{url:E,variant:"text",openInNewTab:T,upsellInformation:t});return l.jsx("div",{className:z("gap-md flex",c?"flex-col":"flex-row"),children:c?l.jsxs(l.Fragment,{children:[C(!0),k]}):l.jsxs(l.Fragment,{children:[k,C(!0)]})})}return C(!1)}),Vxe=Pe(()=>W(()=>import("./TranslationModal-CH3pf6i5.js"),__vite__mapDeps([398,2,3,5,1,6,7,8,9,13,12,63,15,14,16,17]))),Gxe=({icon_reference:e,icon_image:t})=>{if(t)return l.jsx(Y,{variant:"subtle",className:"p-xs rounded-md border",children:l.jsx("img",{src:t.url,alt:t.alt,width:40,height:40,className:"rounded"})});const n={pro:l.jsx(ye,{icon:Es.pro,size:"lg"}),collection:l.jsx(ye,{icon:Es.collection,size:"lg"}),gmail_gcal:l.jsx(Y,{variant:"subtle",className:"p-xs rounded-md border",children:l.jsx("img",{src:t0,alt:"Gmail Gcal Upsell Banner",width:40,height:40})}),research:l.jsx(ye,{icon:Es.research,size:"lg"}),labs:l.jsx(ye,{icon:Es.labs,size:"lg"}),max:l.jsx(xi,{size:"tiny",variant:"mark",isMax:!0}),shortcut:l.jsx(ye,{icon:D("square-forbid-2"),size:"lg"}),comet_login:l.jsx(Y,{variant:"super",className:"p-xs rounded-md border",children:l.jsx(B,{color:"defaultInverted",children:l.jsx(ut,{name:D("custom-brand-comet"),size:24})})}),pro_perks:l.jsx(ye,{icon:Es.pro_perks,size:"lg"}),app:l.jsx(ye,{icon:Es.app,size:"lg"}),slides:l.jsx(ye,{icon:Es.slides,size:"lg"}),document:l.jsx(ye,{icon:Es.document,size:"lg"}),plaintext:l.jsx(ye,{icon:Es.plaintext,size:"lg"}),canvas:l.jsx(ye,{icon:Es.canvas,size:"lg"}),browser_agent:l.jsx(_n,{icon:D("click"),size:"large"}),advanced_models:l.jsx(ye,{icon:Es.advanced_models,size:"lg"}),map_pin:l.jsx(ye,{icon:Es.map_pin,size:"lg"})};return e==="comet_download"?null:n[e||""]||null},Cf=A.memo(function({position:t,upsellInformation:n,inFlight:r,isLastResult:s,backendUuid:a,contextUuid:o,queryStr:i,animateExpand:c=!0,hideOnAccept:u=!0,hideOnReject:d=!0,isSkipping:m=!1,onAccept:p,onReject:h,className:g}){const{$t:y}=Q(),b=OE(),{show:x,handleDismiss:_,handleHide:v}=Dxe({position:t,inFlight:r,isLastResult:s,upsellInformation:n,backendUuid:a,isThreadAuthor:b}),C=f.useCallback(async()=>{_({hideBanner:d}),n?.upsell_type==="WAIT_FOR_CONNECTOR_AUTH_CONFIRMATION"&&a&&await h_({uuid:a,event_type:"CONNECTOR_AUTH",connector_auth_action:!1}),h?.()},[_,h,d,n?.upsell_type,a]),w=f.useCallback(()=>{_({hideBanner:u}),p?.()},[_,p,u]),E=nn()?.get("handle_upsell");f.useEffect(()=>{if(x&&E){const P=new URLSearchParams(window.location.search);P.delete("handle_upsell");const O=Object.fromEntries(P.entries());_I(O),w()}},[w,x,E]);const T=wt();if(!x||!n||T&&n.upsell_type==="LOGIN")return null;if(n.upsell_type==="WAIT_FOR_BROWSER_AGENT_CONFIRMATION")return l.jsx(zxe,{upsellInformation:n,show:x,animateExpand:c,inFlight:r,onPermissionResponse:w,hideUpsell:v});if(n.upsell_type==="DAILY_QUESTIONS_FEATURE_ENTRYPOINTS")return l.jsx(qxe,{type:n.name??"",actionCards:n.action_cards??[],show:x,entryUUID:a,contextUUID:o,queryStr:i});const k=Gxe(n),M=n.upsell_type!=="WAIT_FOR_CANVAS_GENERATION_CONFIRMATION",N=l.jsx("div",{className:"bg-base",children:l.jsxs(Y,{variant:n.background_super?"superLight":"subtler",className:z("gap-sm mb-md p-md md:gap-md relative flex w-full flex-col items-center rounded-md md:flex-row",{"rounded-xl shadow-xl ring-1":t==="input"||t==="router_steps"},g),children:[k&&l.jsx(B,{color:"default",className:"hidden md:block",children:k}),l.jsxs("div",{className:"md:mr-sm relative flex w-full flex-col",children:[l.jsx(B,{variant:"smallBold",className:z("mr-lg md:mr-0",{"line-clamp-2":n.upsell_type==="CREATE_SHORTCUT"}),children:n.title}),l.jsx(B,{variant:"small",color:"light",className:"mb-0 font-normal leading-[1.3]",children:n.description})]}),l.jsxs("div",{className:"gap-sm flex w-full flex-col-reverse md:w-auto md:flex-row md:items-center md:justify-end",children:[M&&l.jsx(pt,{text:y({defaultMessage:"Skip",id:"/4tOwTiCH6"}),size:"small",onClick:C,variant:"common",isLoading:m}),n.button_text&&l.jsx(Hxe,{upsellInformation:n,inFlight:r,position:t,hideUpsell:v})]})]})});return c?l.jsx(da.Height,{isVisible:!0,children:N}):l.jsx(da.Fade,{isVisible:!0,children:N})}),zxe=A.memo(function({upsellInformation:t,show:n,animateExpand:r=!0,inFlight:s,onPermissionResponse:a,hideUpsell:o}){const i=rl({upsellInformation:t,inFlight:s,options:{hideUpsell:o}}),c=t?.cta_information?.secondary_button,u=t?.cta_information?.tertiary_button,d=rl({upsellInformation:c?{...t,cta:c.cta,button_text:c.button_text}:t,inFlight:s,options:{hideUpsell:o}}),m=rl({upsellInformation:u?{...t,cta:u.cta,button_text:u.button_text}:t,inFlight:s,options:{hideUpsell:o}});if(!n)return null;const p=l.jsxs(Zi,{title:t.title??"",description:t.description,leadingAccessory:D("click"),size:"default",children:[u&&l.jsx(Zi.Action,{variant:"text",onClick:()=>{a(),m()},children:u.button_text??""}),c&&l.jsx(Zi.Action,{variant:"secondary",onClick:()=>{a(),d()},children:c.button_text??""}),l.jsx(Zi.Action,{variant:"primary",onClick:()=>{a(),i()},children:t.button_text??""})]});return r?l.jsx(da.Height,{isVisible:!0,className:"mb-md",children:p}):l.jsx(da.Fade,{isVisible:!0,className:"mb-md",children:p})}),qxe=A.memo(function({actionCards:t,queryStr:n,entryUUID:r,contextUUID:s,show:a,animateExpand:o=!0}){const{$t:i}=Q(),c=Lxe(),{detectedLanguages:u}=Fxe({clickedPhrase:c[0]??"",entryUUID:r??"",contextUUID:s??"",translatePhrases:c}),{isMobileStyle:d}=Be(),m=Kt().openModal,p=f.useRef(null),h=f.useRef(null),g=f.useCallback((_,v)=>{const C={LANGUAGE_LEARNING_FLASHCARDS:"flashcards",LANGUAGE_LEARNING_VOICE_TUTOR:"voice_tutor"},w=yt.getItem(Ixe),S=_==="LANGUAGE_LEARNING_FLASHCARDS"?w?w==="true":!0:!1;m(Vxe,{stringBounds:v.current?.getBoundingClientRect()??new DOMRect,string:c[0]??"",entryUUID:r??"",contextUUID:s??"",queryStr:n??"",translatePhrases:c,isMobileStyle:d,autoplay:S,initialWidth:window.innerWidth,defaultMode:C[_]})},[c,d,r,s,n,m]),y=f.useMemo(()=>u?{LANGUAGE_LEARNING_FLASHCARDS:{text:i({defaultMessage:"Flash Cards",id:"t0yioEPoC6"}),subtext:i({defaultMessage:"Practice {language} with audio flash cards",id:"ZRcObnW+uj"},{language:u.learning_language}),onClick:()=>g("LANGUAGE_LEARNING_FLASHCARDS",p),ref:p},LANGUAGE_LEARNING_VOICE_TUTOR:{text:i({defaultMessage:"Voice Tutor",id:"rWFec/0yfN"}),subtext:i({defaultMessage:"Learn how to pronounce {language} words out loud.",id:"IXEyZm0BqT"},{language:u.learning_language}),onClick:()=>g("LANGUAGE_LEARNING_VOICE_TUTOR",h),ref:h}}:null,[u,g,i]),b=f.useMemo(()=>y?t.map(_=>{if(!_.cta)return null;const v=y[_.cta];return v?l.jsx(at,{variant:"text",onClick:v.onClick,ref:v.ref,children:l.jsxs("div",{className:"gap-xs flex flex-col items-start",children:[l.jsx(B,{variant:"smallBold",children:v.text}),l.jsx(B,{variant:"small",color:"light",children:v.subtext})]})},_.cta):null}):null,[t,y]);if(!u||!a)return null;const x=l.jsxs(l.Fragment,{children:[l.jsx(B,{variant:"baseSemi",children:i({defaultMessage:"More ways to learn {language}",id:"R68m2bFJEK"},{language:u.learning_language})}),l.jsx("div",{className:"gap-xs flex",children:b})]});return o?l.jsx(da.Height,{isVisible:!0,className:"gap-xs flex flex-col",children:x}):l.jsx(da.Fade,{isVisible:!0,className:"gap-xs flex flex-col",children:x})}),$xe=A.memo(function({tool_logo_url:t,app:n,merge_extra_args:r,step_uuid:s,backend_uuid:a}){const{$t:o}=Q(),i=cre(n||""),c=f.useCallback(async()=>{await $P({uuid:s,success:!1,reason:"User skipped authentication"})},[s]),u=f.useMemo(()=>({name:"mcp_connector_auth",upsell_type:"CONNECT_TO_CONNECTOR",app_location:"UPSELL_APP_LOCATION_UNSPECIFIED",title:o({defaultMessage:"Connect your {appName} account",id:"YPjv1DRLLL"},{appName:i}),description:o({defaultMessage:"Connect your {appName} account to get started",id:"MtMLxu8Eaj"},{appName:i}),secondary_title:"",cta:"MERGE_AUTH_CONNECTOR",icon_reference:i,...t&&{icon_image:{url:t,alt:i}},button_color:"INVERTED",button_text:"Connect",cta_information:{merge_auth_token:r?.auth_info?.auth_token,merge_auth_callback_uuid:s},show_in_comet:!0,is_persistent:!0,backend_uuid:a,image_asset:"",image_asset_low_res:"",image_asset_dark:"",image_asset_low_res_dark:"",background_super:!1,event_metadata:void 0,upsell_uuid:crypto.randomUUID(),ui_type:"BANNER_WITH_BUTTONS",action_cards:[]}),[i,a,t,o,r?.auth_info?.auth_token,s]);return l.jsx(Cf,{position:"router_steps",upsellInformation:u,backendUuid:a,isLastResult:!0,hideOnAccept:!1,hideOnReject:!1,onReject:c})}),Wxe={language:"json"},Kxe=A.memo(function(t){const{tool_args:n,tool_name:r}=t,[s,a]=f.useState(!1),o=f.useCallback(()=>a(i=>!i),[]);return l.jsx(Y,{className:"border-subtlest p-sm rounded-lg border",children:!!(n&&typeof n=="object"&&n!==null)&&l.jsxs(Y,{className:"border-subtlest p-sm rounded-lg border",children:[l.jsxs(Y,{className:"flex items-center justify-between",children:[l.jsx(B,{variant:"smallMono",children:r}),l.jsx(pt,{size:"small",icon:s?D("chevron-down"):D("chevron-right"),onClick:o})]}),l.jsx(ba,{mode:"popLayout",transition:{duration:.2,ease:rr},children:s&&l.jsx(bs,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},transition:{duration:.15,ease:rr},children:l.jsxs(Y,{className:"mt-sm rounded-lg",variant:"subtler",children:[l.jsx(B,{variant:"tiny",className:"p-md pb-0",children:l.jsx(be,{defaultMessage:"Request",id:"p1P+hQq6tY"})}),l.jsx(hl,{className:"scrollbar-subtle my-0 max-h-[200px] overflow-y-auto text-xs",codeBlockProps:Wxe,hideTools:!0,children:n&&typeof n=="object"?JSON.stringify(n):"No instructions"})]})})})]})})}),Yxe=A.memo(function(t){const{authenticated:n}=t;return n?l.jsx(Kxe,{...t}):l.jsx($xe,{...t})}),Qxe=()=>{const{variation:e}=cR(!1),{mcpStdioServers:t}=Sn(),r=hY()?.local_mcp.call===!0;return(mn()?e:r)&&t!==void 0},Xxe=({permission:e,connectorName:t})=>{const{$t:n}=Q();return f.useMemo(()=>{if(!e)return null;switch(e){case"full_disk_access":return{title:n({defaultMessage:"Comet needs full disk access",id:"KaK1awrgFQ"}),description:n(t?{defaultMessage:"To use this connector, Comet needs permission to access your disk. Enable it in System Settings.",id:"O9WzUyHg3f"}:{defaultMessage:"To use all your connectors, Comet needs permission to access your disk. Enable it in System Settings.",id:"xusC3M5hQD"}),videoUrl:"https://r2cdn.perplexity.ai/comet/toggle-permission.mp4",tooltipTitle:n({defaultMessage:"Full disk access required",id:"ry8L5i2JdM"}),tooltipDescription:n({defaultMessage:"Turn on disk access in System Settings to use this connector",id:"zQpOIZuVrk"}),buttonText:n({defaultMessage:"Open System Settings",id:"U/a2e7uAwk"})};case"contacts":return{title:n({defaultMessage:"Comet needs access to your contacts",id:"Gh5VRh+h5k"}),description:n(t?{defaultMessage:"To use this connector, Comet needs permission to access your contacts.",id:"lbQ3o1etQa"}:{defaultMessage:"To use all your connectors, Comet needs permission to access your contacts.",id:"WgPxDUwZSj"}),videoUrl:"https://r2cdn.perplexity.ai/comet/toggle-permission.mp4",tooltipTitle:n({defaultMessage:"Contacts permission required",id:"QKFGSziMOF"}),tooltipDescription:n({defaultMessage:"Grant contacts permission to use this connector",id:"uMNpHxa2KQ"}),buttonText:n({defaultMessage:"Grant Access",id:"Xq5/HeHSIt"})};default:return null}},[n,t,e])},Zxe=({connectorName:e,permission:t,cometAdapter:n})=>{const r=f.useMemo(()=>["comet/permission",t],[t]),s=QW({queryKey:r,queryFn:async()=>t?n.hasPermission(t):null}),a=It(),o=on({mutationKey:r,mutationFn:async()=>t?n.requestPermission(t):null,onSuccess:c=>{a.setQueryData(r,c)}}),i=Xxe({permission:t,connectorName:e});return f.useMemo(()=>({renderData:MN(s)?i:null,isRequestingPermission:o.isPending,requestPermission:()=>o.mutateAsync()}),[s,o,i])},Jxe=e=>Se.makeEphemeralQueryKey("comet/permission",e),e1e=({cometAdapter:e,permissions:t})=>{const n=QC({queries:(t??[]).map(o=>({queryKey:Jxe(o),queryFn:()=>e.hasPermission(o)}))}).map(o=>({isFetching:o.isFetching,data:o.data})),s=f.useMemo(()=>{let o;return i=>(xn(o,i,xn)||(o=i),o)},[])(n);return f.useMemo(()=>{const o=s.findIndex(i=>MN(i));return t?.[o]??null},[t,s])},SF=e=>{const{permission:t,connectorName:n,onDismiss:r}=e,s=Xt(),{$t:a}=Q(),{renderData:o,isRequestingPermission:i,requestPermission:c}=Zxe({permission:t,connectorName:n,cometAdapter:s});return o?l.jsxs(Y,{variant:"subtler",className:"border-subtler flex justify-between gap-6 rounded-lg border p-6",children:[l.jsxs("div",{className:"flex flex-1 flex-col justify-center",children:[l.jsxs("div",{children:[l.jsx(B,{variant:"baseSemi",as:"h3",className:"mb-1",children:o.title}),l.jsx(B,{variant:"small",color:"light",children:o.description})]}),l.jsxs("div",{className:"mt-5 flex gap-2",children:[l.jsx(at,{variant:"primary",onClick:c,disabled:i,children:o.buttonText}),r&&l.jsx(at,{variant:"secondary",onClick:r,children:a({defaultMessage:"Dismiss",id:"TDaF6JVgG6"})})]})]}),l.jsx("div",{className:"flex-1",children:l.jsx("video",{src:o.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,height:160,width:302,className:"rounded-lg"})})]}):null},t1e=e=>{const{permissions:t,className:n,connectorName:r,onDismiss:s}=e,a=Xt(),o=e1e({cometAdapter:a,permissions:t});return o?l.jsx("div",{className:n,children:l.jsx(SF,{permission:o,connectorName:r,onDismiss:s})}):null},n1e=e=>{const{permissions:t,className:n,connectorName:r,onDismiss:s}=e;return l.jsx("div",{className:z("space-y-4",n),children:t.map(a=>l.jsx(SF,{permission:a,connectorName:r,onDismiss:s},a))})},r1e=e=>{const{variant:t,...n}=e;return t==="first-required"?l.jsx(t1e,{...n}):l.jsx(n1e,{...n})},s1e=e=>Se.makeEphemeralQueryKey("comet/permission",e),a1e=({cometAdapter:e,permissions:t})=>{const n=QC({queries:(t??[]).map(a=>({queryKey:s1e(a),queryFn:()=>e.hasPermission(a)}))}).map(a=>({isFetching:a.isFetching,data:a.data})),s=f.useMemo(()=>{let a;return o=>(xn(a,o,xn)||(a=o),a)},[])(n);return f.useMemo(()=>!t||s.some(a=>a.isFetching)?null:s.every(a=>a.data!==!1),[s,t])},sT=[],o1e=({server:e,cometState:t,toolName:n})=>f.useMemo(()=>{if(!e)return null;if(!t.installedDxts)return sT;const r=Od(t.installedDxts,e);return r?Object.entries(lD(r)).filter(([,{for_tools:s}])=>!s||n&&s.includes(n)).map(([s])=>s):sT},[e,t.installedDxts,n]),i1e=A.memo(function({step:t,isFinished:n,onActionTaken:r}){const{lastResult:s}=Ht(),{submitQuery:a}=ya(),[o,i]=f.useState(!1),c=t.content,u=t.mcp_tool_output_content,d=!o&&c.request_user_approval?.request_user_approval,m=!n&&d===!1&&!u,p=c1e({stepId:t.uuid,shouldExecuteLocalTool:m,mcpContent:c}),h=f.useMemo(()=>!!u?.should_rerun_query,[u]),g=f.useCallback(async()=>{s?.query_str&&(await Cu({entryUUID:s.backend_uuid,reason:"mcp-tool-output-merge-api"}),a({rawQuery:s.query_str,existingEntryUUID:s.backend_uuid,redoSearch:!0,collection:null,newFrontendContextUUID:null,existingFrontendContextUUID:s.frontend_context_uuid,promptSource:"user",querySource:"mcp-tool-input",attachments:[],modelPreferenceOverride:"pplx_pro",sourcesOverride:jw(s.sources?.sources)}))},[a,s]);f.useEffect(()=>{h&&g()},[g,h]);const y=p?.name||c.app||"",b=p?.iconUrl||c.logo_url||lhe(c.app||"")||void 0;if(d&&p?.allPermissionsAreGranted!==!1)return l.jsx(kxe,{appName:y,appLogo:b,step:t,isFinished:n,onApprove:()=>i(!0),onActionTaken:r});const x=(!!p||c.authenticated)??null;return x===null?null:x?l.jsxs(l.Fragment,{children:[p?.askPermissionsBanner,l.jsx(l1e,{appLogo:b,appName:y,mcpContent:c,mcpOutputContent:u})]}):l.jsx(Yxe,{...c,step_uuid:t.uuid??"",backend_uuid:s?.backend_uuid??"",authenticated:x,tool_args:c.tool_args,tool_logo_url:b??void 0})}),l1e=e=>{const{appLogo:t,appName:n,mcpContent:r,mcpOutputContent:s}=e,[a,o]=f.useState(!1),i=r.data_is_redacted===!0||s?.data_is_redacted===!0,c=hi(r.source_type),u=f.useCallback(()=>{i||o(d=>!d)},[i]);return l.jsxs(Y,{className:"p-sm hover:bg-raised grid grid-cols-[max-content_1fr] gap-x-2 rounded-lg border pl-4",variant:a?"raised":void 0,children:[l.jsxs("div",{className:z("col-span-full grid grid-cols-subgrid items-center",{"cursor-pointer":!i}),onClick:u,children:[l.jsx(Jw,{serverName:n,iconUrl:t,size:"sm"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(B,{variant:"smallBold",children:n}),c&&l.jsx(CS,{variant:"premium"}),!i&&l.jsx("div",{className:"ml-auto flex items-center gap-2",children:l.jsx(pt,{size:"small",pill:!0,icon:a?D("chevron-down"):D("chevron-right")})})]})]}),l.jsx("div",{className:"col-start-2 col-end-3 min-w-0",children:l.jsx(EF,{isExpanded:a,mcpContent:r,mcpOutputContent:s})})]})},EF=({isExpanded:e,mcpContent:t,mcpOutputContent:n})=>l.jsx(ba,{mode:"popLayout",initial:!1,transition:{duration:.2,ease:rr},children:e&&l.jsx(bs,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},transition:{duration:.15,ease:rr},children:l.jsx("div",{className:"mt-sm",children:l.jsx(dm,{maxHeight:400,autoScroll:!1,scrollContainerClassName:"scrollbar-subtle !pl-0",showTopGradient:!1,showBottomGradient:!1,children:l.jsxs("div",{className:"flex flex-col gap-2 pt-1",children:[l.jsx(B,{variant:"tinyMono",children:t.tool_name}),!!(t.tool_args&&typeof t.tool_args=="object"&&t.tool_args!==null)&&l.jsx(F_,{title:l.jsx(be,{defaultMessage:"Request",id:"J+m4xH5bwC",description:"Request"}),content:t.tool_args,showTruncationMessage:!1}),n&&l.jsx(F_,{title:l.jsx(be,{defaultMessage:"Response",id:"UC/2Eq4W+h",description:"Response"}),content:n.content})]})})})})}),c1e=({stepId:e,shouldExecuteLocalTool:t,mcpContent:{app:n,mcp_server_type:r,tool_name:s,tool_args:a}})=>{const o=Sn(),i=Qxe(),c=Xt(),u=bY(),d=f.useMemo(()=>{if(!(!i||r!=="MCP_SERVER_TYPE_LOCAL"||!n))return o.mcpStdioServers?.find(C=>C.name===n)},[i,r,n,o.mcpStdioServers]),m=o1e({server:d,cometState:o,toolName:s}),p=a1e({cometAdapter:c,permissions:m}),{mutateAsync:h}=on({mutationKey:["comet/execute-local-tool",e],mutationFn:async({content:C,isError:w=!1})=>{if(!e)throw new Error("StepID is not set");return ve.POST("/rest/sse/perplexity_mcp_response","local-mcp-step",{body:{result:{content:C,is_error:w,uuid:e}}})}}),g=f.useCallback(()=>{h({content:'The MCP tool call was rejected by the user because he dismissed the permission request (refer to them as "you" or use the appropriate equivalent in their language when mentioning this)'})},[h]),y=!!(t&&n&&s&&e&&p);gt({queryKey:Se.makeQueryKey("comet/auto-execute-local-tool",e),enabled:y,queryFn:async()=>{if(!n||!s||!e)throw new Error("Missing required parameters");try{const C=await u.callMcpTool({mcpServerName:n,toolName:s,toolArgs:a},{step_uuid:e});return await h({content:C.content.map(w=>w.text).filter(Boolean).join(`

`)}),!0}catch(C){return await h({content:`The MCP tool call failed: ${C instanceof Error?C.message:"Unknown error"}`,isError:!0}),!1}}});const b=f.useMemo(()=>d?Od(o.installedDxts,d):null,[o.installedDxts,d]),x=b?.display_name??b?.name??n,_=eS(),v=f.useMemo(()=>d?iD(_,d):null,[_,d]);return f.useMemo(()=>x?{name:x,iconUrl:v??null,allPermissionsAreGranted:p,askPermissionsBanner:t&&!p&&m?l.jsx(r1e,{variant:"all",connectorName:x,permissions:m,className:"mb-4",onDismiss:g}):null}:null,[p,x,g,v,m,t])},u1e=A.memo(function(t){const{content:n,shouldRerunQuery:r=!1}=t,{lastResult:s}=Ht(),{submitQuery:a}=ya(),o=f.useCallback(async()=>{s?.query_str&&(await Cu({entryUUID:s.backend_uuid,reason:"mcp-tool-output-merge-api"}),a({rawQuery:s.query_str,existingEntryUUID:s.backend_uuid,redoSearch:!0,collection:null,newFrontendContextUUID:null,existingFrontendContextUUID:s.frontend_context_uuid,promptSource:"user",querySource:"mcp-tool-input",attachments:[],modelPreferenceOverride:"pplx_pro"}))},[a,s]);return f.useEffect(()=>{r&&o()},[o,r]),l.jsx(Y,{className:"border-subtlest p-sm rounded-lg border",children:l.jsx(F_,{title:l.jsx(be,{defaultMessage:"Response",id:"MgdnPiJHcj"}),content:n})})}),d1e=A.memo(function({step:t,action:n}){const{final:r}=t.content,s=!r;return l.jsx(st,{text:n,icon:D("file-type-pdf"),isLoading:s,size:"tiny",pill:!0})}),aT=["start","end"],f1e=A.memo(function({attachments:t,attachmentProcessingProgress:n}){const{$t:r}=Q(),a=t.filter(p=>Pd(p)).length+n.length,o=t.length+aT.length,i=Math.min(a/o*100,100),c=n.filter(p=>!p.success),u=f.useMemo(()=>!!n.filter(p=>p.file_url==="end").length,[n]),d=f.useCallback(p=>{const h=El(p.file_url??"");let g;switch(p.error_code){case"token_limit_exceeded":g=r({defaultMessage:"{filename} exceeds the model's token limit.",id:"60iyTByOrX"},{filename:h});break;case"file_type_not_supported":g=r({defaultMessage:"{filename} is of an unsupported file type. It will not be included in the results.",id:"sB9AI6thAL"},{filename:h});break;case"no_data_received":g=r({defaultMessage:"{filename} has timed out.",id:"/wyRgEWdz7"},{filename:h});break;default:g=r({defaultMessage:"{filename} could not be read. It will not be included in the results.",id:"7w0MjjvHs3"},{filename:h});break}return g},[r]),m=f.useMemo(()=>{const p=c.map((g,y)=>l.jsx(oT,{icon:D("exclamation-circle"),text:d(g)},y)),h=l.jsx(oT,{icon:D("check"),text:r({defaultMessage:"Successfully read {numAttachments, plural, one {# attached file} other {# attached files}}.",id:"A8hQ4/Kv4s"},{numAttachments:a-c.length-aT.length})});return[...p,...u?[h]:[]]},[c,r,a,u,d]);return l.jsx(mm,{className:"pt-md pb-xs px-xs !border-[#32B8C6]",children:l.jsx(dm,{maxHeight:250,autoScroll:!1,children:l.jsxs("div",{className:"pr-md gap-x-md flex w-full",children:[l.jsx(B,{className:"bg-super flex size-8 flex-none items-center justify-center rounded-md border-[0.75px] border-[#05FFFF]/20 shadow-[0px_1px_4px_0px_rgba(0,0,0,0.24)]",children:l.jsx(ye,{icon:D("paperclip"),size:"md",className:"text-inverse"})}),l.jsxs("div",{className:"gap-y-xs flex grow flex-col",children:[l.jsx(B,{variant:"smallBold",children:r({defaultMessage:"{numAttachments, plural, one {Reading # attached file} other {Reading # attached files}}",id:"6YvH7Waf0M"},{numAttachments:t.length})}),l.jsx("div",{className:"h-2 w-full rounded-[37px] bg-[#60584D]/[0.06]",children:l.jsx("div",{className:"h-2 rounded-[37px] bg-[#32B8C6] transition-all duration-300",style:{width:`${i}%`}})}),l.jsxs("div",{className:"pt-xs",children:[l.jsx(hy,{items:m,vertical:!0,truncate:!1}),!u&&l.jsx(Tr,{variant:"super",active:!u,as:"span",className:"pt-xs",children:l.jsx(B,{variant:"small",color:"super",children:r({defaultMessage:"Reading...",id:"IvE1kfOWAz"})})})]})]})]})})})}),oT=A.memo(function({icon:t,text:n}){return l.jsxs("div",{className:"py-xs gap-x-sm flex",children:[l.jsx(B,{className:"flex items-center justify-center",children:l.jsx(_n,{icon:t,size:"small"})}),l.jsx(B,{variant:"small",color:"light",children:n})]})}),KYe=e=>[...e].sort((t,n)=>{const r=new Date(t.start_date_time||"").getTime(),s=new Date(n.start_date_time||"").getTime();return r-s}),YYe=e=>{if(e.length<=1)return!1;const t=new Date(e[0]?.start_date_time||""),n=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime();return e.some(r=>{const s=new Date(r.start_date_time||"");return new Date(s.getFullYear(),s.getMonth(),s.getDate()).getTime()!==n})},m1e={"#AC725E":"#79554B","#D06B64":"#E67399","#F83A22":"#D50000","#FA573C":"#F4511E","#FF7537":"#EF6C00","#FFAD46":"#F09300","#42D692":"#009688","#16A765":"#0B8043","#7BD148":"#7CB342","#B3DC6C":"#C0CA33","#FBE983":"#E4C441","#FAD165":"#F6BF26","#92E1C0":"#039BE5","#9FE1E7":"#4285F4","#9FC6E7":"#3F51B5","#4986E7":"#7986CB","#9A9CFF":"#B39DDB","#C2C2C2":"#616161","#CABDBF":"#A79B8E","#CCA6AC":"#AD1457","#F691B2":"#D81B60","#CD74E6":"#8E24AA","#A47AE2":"#7B1FA2"},p1e="#039BE5",kF=e=>m1e[e.toUpperCase()]??p1e,MF=e=>{const t=e.replace("#",""),n=parseInt(t.substring(0,2),16),r=parseInt(t.substring(2,4),16),s=parseInt(t.substring(4,6),16),a=m=>{const p=m/255;return p<=.03928?p/12.92:Math.pow((p+.055)/1.055,2.4)},o=a(n),i=a(r),c=a(s),u=.2126*o+.7152*i+.0722*c,d=(Math.max(u,1)+.05)/(Math.min(u,1)+.05);return d>=7?"AAA":d>=4.5?"AA":d>=3?"A":"Fail"},h1e=e=>typeof e=="string"?{email:e,response_status:void 0,photo_url:void 0,display_name:void 0}:{email:e.email,response_status:e.response_status,photo_url:e.photo_url,display_name:e.display_name},iT=e=>e?e.map(h1e):[],g1e=e=>{if(!e||e.trim()==="")return"";const t=e.trim().split(/\s+/);return mN(t)?t[0].charAt(0).toUpperCase():((t[0]?.charAt(0)??"")+(t[t.length-1]?.charAt(0)??"")).toUpperCase()},TF=(e,t)=>t.formatDate(e,{timeZoneName:"short"}).split(", ").pop()||"",y1e=()=>{const{formatDate:e}=Q(),t=f.useCallback((s,a=!0)=>e(s,{month:"long",day:"numeric",...a&&{year:"numeric"}}),[e]),n=f.useCallback(s=>e(s,{weekday:"long",month:"long",day:"numeric"}),[e]),r=f.useCallback(s=>e(s,{weekday:"short",month:"long",day:"numeric"}),[e]);return f.useMemo(()=>({formatEventDate:t,formatEventDay:n,formatEventDayShort:r}),[t,n,r])},Sh=A.memo(function({startDate:t,endDate:n,isAllDay:r,showDate:s=!1,includeYear:a=!0}){const{$t:o}=Q();if(r){const i=o({defaultMessage:"All day",id:"Vob6h4Xsl3"});return s?l.jsxs(l.Fragment,{children:[l.jsx(Dx,{from:t,to:t,...a&&{year:"numeric"},month:"long",day:"numeric"}),", ",i]}):l.jsx(l.Fragment,{children:i})}return s?l.jsx(Dx,{from:t,to:n,...a&&{year:"numeric"},month:"long",day:"numeric",hour:"numeric",minute:"2-digit",timeZoneName:"short"}):l.jsx(Dx,{from:t,to:n,hour:"numeric",minute:"2-digit",timeZoneName:"short"})}),x1e=A.memo(function({result:t,textClassName:n}){const r=f.useMemo(()=>t.start?new Date(t.start):null,[t.start]),s=f.useMemo(()=>t.end?new Date(t.end):null,[t.end]),a=t.is_all_day===!0,o=kF(t.calendar_color?.background||"oklch(var(--super-color))"),i=MF(o),c=f.useMemo(()=>s?new Date(s.getTime()-1440*60*1e3):null,[s]),u=()=>r?a?(s?Math.round((s.getTime()-r.getTime())/864e5):1)<=1?l.jsx(Sh,{startDate:r,endDate:r,isAllDay:!0,showDate:!0,includeYear:!1}):l.jsx(Sh,{startDate:r,endDate:c,isAllDay:!0,showDate:!0,includeYear:!1}):l.jsx(Sh,{startDate:r,endDate:s||r,isAllDay:!1,showDate:!0,includeYear:!1}):null;return l.jsx("div",{className:"hover:bg-subtler dark:hover:bg-subtle relative flex min-w-0 cursor-pointer gap-3 rounded-lg px-2 py-1.5",children:l.jsxs("div",{className:"flex gap-2",children:[l.jsx("div",{className:"py-xs relative w-1",children:l.jsx("div",{className:z("inset-y-two absolute w-1 shrink-0 self-stretch rounded-full",{"brightness-[0.8]":i==="Fail"}),style:{backgroundColor:o}})}),l.jsxs("div",{className:"gap-two flex min-w-0 flex-1 flex-col",children:[l.jsx("div",{className:"flex min-w-0 items-center justify-between gap-2",children:t.title&&l.jsx(B,{variant:"smallBold",className:"shrink-0",as:"span",children:t.title})}),l.jsx("div",{className:"flex min-w-0 items-center gap-2",children:r&&l.jsx(B,{className:z("min-w-0 shrink text-ellipsis",n),variant:"tinyMono",color:"light",as:"span",children:u()})})]})]})})});var Dd={exports:{}};var b1e=Dd.exports,lT;function _1e(){return lT||(lT=1,(function(e,t){(function(n){var r=t,s=e&&e.exports==r&&e,a=typeof gc=="object"&&gc;(a.global===a||a.window===a)&&(n=a);var o=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,i=/[\x01-\x7F]/g,c=/[\x01-\t\x0B\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,u=/<\u20D2|=\u20E5|>\u20D2|\u205F\u200A|\u219D\u0338|\u2202\u0338|\u2220\u20D2|\u2229\uFE00|\u222A\uFE00|\u223C\u20D2|\u223D\u0331|\u223E\u0333|\u2242\u0338|\u224B\u0338|\u224D\u20D2|\u224E\u0338|\u224F\u0338|\u2250\u0338|\u2261\u20E5|\u2264\u20D2|\u2265\u20D2|\u2266\u0338|\u2267\u0338|\u2268\uFE00|\u2269\uFE00|\u226A\u0338|\u226A\u20D2|\u226B\u0338|\u226B\u20D2|\u227F\u0338|\u2282\u20D2|\u2283\u20D2|\u228A\uFE00|\u228B\uFE00|\u228F\u0338|\u2290\u0338|\u2293\uFE00|\u2294\uFE00|\u22B4\u20D2|\u22B5\u20D2|\u22D8\u0338|\u22D9\u0338|\u22DA\uFE00|\u22DB\uFE00|\u22F5\u0338|\u22F9\u0338|\u2933\u0338|\u29CF\u0338|\u29D0\u0338|\u2A6D\u0338|\u2A70\u0338|\u2A7D\u0338|\u2A7E\u0338|\u2AA1\u0338|\u2AA2\u0338|\u2AAC\uFE00|\u2AAD\uFE00|\u2AAF\u0338|\u2AB0\u0338|\u2AC5\u0338|\u2AC6\u0338|\u2ACB\uFE00|\u2ACC\uFE00|\u2AFD\u20E5|[\xA0-\u0113\u0116-\u0122\u0124-\u012B\u012E-\u014D\u0150-\u017E\u0192\u01B5\u01F5\u0237\u02C6\u02C7\u02D8-\u02DD\u0311\u0391-\u03A1\u03A3-\u03A9\u03B1-\u03C9\u03D1\u03D2\u03D5\u03D6\u03DC\u03DD\u03F0\u03F1\u03F5\u03F6\u0401-\u040C\u040E-\u044F\u0451-\u045C\u045E\u045F\u2002-\u2005\u2007-\u2010\u2013-\u2016\u2018-\u201A\u201C-\u201E\u2020-\u2022\u2025\u2026\u2030-\u2035\u2039\u203A\u203E\u2041\u2043\u2044\u204F\u2057\u205F-\u2063\u20AC\u20DB\u20DC\u2102\u2105\u210A-\u2113\u2115-\u211E\u2122\u2124\u2127-\u2129\u212C\u212D\u212F-\u2131\u2133-\u2138\u2145-\u2148\u2153-\u215E\u2190-\u219B\u219D-\u21A7\u21A9-\u21AE\u21B0-\u21B3\u21B5-\u21B7\u21BA-\u21DB\u21DD\u21E4\u21E5\u21F5\u21FD-\u2205\u2207-\u2209\u220B\u220C\u220F-\u2214\u2216-\u2218\u221A\u221D-\u2238\u223A-\u2257\u2259\u225A\u225C\u225F-\u2262\u2264-\u228B\u228D-\u229B\u229D-\u22A5\u22A7-\u22B0\u22B2-\u22BB\u22BD-\u22DB\u22DE-\u22E3\u22E6-\u22F7\u22F9-\u22FE\u2305\u2306\u2308-\u2310\u2312\u2313\u2315\u2316\u231C-\u231F\u2322\u2323\u232D\u232E\u2336\u233D\u233F\u237C\u23B0\u23B1\u23B4-\u23B6\u23DC-\u23DF\u23E2\u23E7\u2423\u24C8\u2500\u2502\u250C\u2510\u2514\u2518\u251C\u2524\u252C\u2534\u253C\u2550-\u256C\u2580\u2584\u2588\u2591-\u2593\u25A1\u25AA\u25AB\u25AD\u25AE\u25B1\u25B3-\u25B5\u25B8\u25B9\u25BD-\u25BF\u25C2\u25C3\u25CA\u25CB\u25EC\u25EF\u25F8-\u25FC\u2605\u2606\u260E\u2640\u2642\u2660\u2663\u2665\u2666\u266A\u266D-\u266F\u2713\u2717\u2720\u2736\u2758\u2772\u2773\u27C8\u27C9\u27E6-\u27ED\u27F5-\u27FA\u27FC\u27FF\u2902-\u2905\u290C-\u2913\u2916\u2919-\u2920\u2923-\u292A\u2933\u2935-\u2939\u293C\u293D\u2945\u2948-\u294B\u294E-\u2976\u2978\u2979\u297B-\u297F\u2985\u2986\u298B-\u2996\u299A\u299C\u299D\u29A4-\u29B7\u29B9\u29BB\u29BC\u29BE-\u29C5\u29C9\u29CD-\u29D0\u29DC-\u29DE\u29E3-\u29E5\u29EB\u29F4\u29F6\u2A00-\u2A02\u2A04\u2A06\u2A0C\u2A0D\u2A10-\u2A17\u2A22-\u2A27\u2A29\u2A2A\u2A2D-\u2A31\u2A33-\u2A3C\u2A3F\u2A40\u2A42-\u2A4D\u2A50\u2A53-\u2A58\u2A5A-\u2A5D\u2A5F\u2A66\u2A6A\u2A6D-\u2A75\u2A77-\u2A9A\u2A9D-\u2AA2\u2AA4-\u2AB0\u2AB3-\u2AC8\u2ACB\u2ACC\u2ACF-\u2ADB\u2AE4\u2AE6-\u2AE9\u2AEB-\u2AF3\u2AFD\uFB00-\uFB04]|\uD835[\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDD6B]/g,d={"":"shy","":"zwnj","":"zwj","":"lrm","":"ic","":"it","":"af","":"rlm","":"ZeroWidthSpace","":"NoBreak","":"DownBreve","":"tdot","":"DotDot","	":"Tab","\n":"NewLine","":"puncsp","":"MediumSpace","":"thinsp","":"hairsp","":"emsp13","":"ensp","":"emsp14","":"emsp","":"numsp","":"nbsp","":"ThickSpace","":"oline",_:"lowbar","":"dash","":"ndash","":"mdash","":"horbar",",":"comma",";":"semi","":"bsemi",":":"colon","":"Colone","!":"excl","":"iexcl","?":"quest","":"iquest",".":"period","":"nldr","":"mldr","":"middot","'":"apos","":"lsquo","":"rsquo","":"sbquo","":"lsaquo","":"rsaquo",'"':"quot","":"ldquo","":"rdquo","":"bdquo","":"laquo","":"raquo","(":"lpar",")":"rpar","[":"lsqb","]":"rsqb","{":"lcub","}":"rcub","":"lceil","":"rceil","":"lfloor","":"rfloor","":"lopar","":"ropar","":"lbrke","":"rbrke","":"lbrkslu","":"rbrksld","":"lbrksld","":"rbrkslu","":"langd","":"rangd","":"lparlt","":"rpargt","":"gtlPar","":"ltrPar","":"lobrk","":"robrk","":"lang","":"rang","":"Lang","":"Rang","":"loang","":"roang","":"lbbrk","":"rbbrk","":"Vert","":"sect","":"para","@":"commat","*":"ast","/":"sol",undefined:null,"&":"amp","#":"num","%":"percnt","":"permil","":"pertenk","":"dagger","":"Dagger","":"bull","":"hybull","":"prime","":"Prime","":"tprime","":"qprime","":"bprime","":"caret","`":"grave","":"acute","":"tilde","^":"Hat","":"macr","":"breve","":"dot","":"die","":"ring","":"dblac","":"cedil","":"ogon","":"circ","":"caron","":"deg","":"copy","":"reg","":"copysr","":"wp","":"rx","":"mho","":"iiota","":"larr","":"nlarr","":"rarr","":"nrarr","":"uarr","":"darr","":"harr","":"nharr","":"varr","":"nwarr","":"nearr","":"searr","":"swarr","":"rarrw","":"nrarrw","":"Larr","":"Uarr","":"Rarr","":"Darr","":"larrtl","":"rarrtl","":"mapstoleft","":"mapstoup","":"map","":"mapstodown","":"larrhk","":"rarrhk","":"larrlp","":"rarrlp","":"harrw","":"lsh","":"rsh","":"ldsh","":"rdsh","":"crarr","":"cularr","":"curarr","":"olarr","":"orarr","":"lharu","":"lhard","":"uharr","":"uharl","":"rharu","":"rhard","":"dharr","":"dharl","":"rlarr","":"udarr","":"lrarr","":"llarr","":"uuarr","":"rrarr","":"ddarr","":"lrhar","":"rlhar","":"lArr","":"nlArr","":"uArr","":"rArr","":"nrArr","":"dArr","":"iff","":"nhArr","":"vArr","":"nwArr","":"neArr","":"seArr","":"swArr","":"lAarr","":"rAarr","":"zigrarr","":"larrb","":"rarrb","":"duarr","":"loarr","":"roarr","":"hoarr","":"forall","":"comp","":"part","":"npart","":"exist","":"nexist","":"empty","":"Del","":"in","":"notin","":"ni","":"notni","":"bepsi","":"prod","":"coprod","":"sum","+":"plus","":"pm","":"div","":"times","<":"lt","":"nlt","<":"nvlt","=":"equals","":"ne","=":"bne","":"Equal",">":"gt","":"ngt",">":"nvgt","":"not","|":"vert","":"brvbar","":"minus","":"mp","":"plusdo","":"frasl","":"setmn","":"lowast","":"compfn","":"Sqrt","":"prop","":"infin","":"angrt","":"ang","":"nang","":"angmsd","":"angsph","":"mid","":"nmid","":"par","":"npar","":"and","":"or","":"cap","":"caps","":"cup","":"cups","":"int","":"Int","":"tint","":"qint","":"oint","":"Conint","":"Cconint","":"cwint","":"cwconint","":"awconint","":"there4","":"becaus","":"ratio","":"Colon","":"minusd","":"mDDot","":"homtht","":"sim","":"nsim","":"nvsim","":"bsim","":"race","":"ac","":"acE","":"acd","":"wr","":"esim","":"nesim","":"sime","":"nsime","":"cong","":"ncong","":"simne","":"ap","":"nap","":"ape","":"apid","":"napid","":"bcong","":"CupCap","":"NotCupCap","":"nvap","":"bump","":"nbump","":"bumpe","":"nbumpe","":"doteq","":"nedot","":"eDot","":"efDot","":"erDot","":"colone","":"ecolon","":"ecir","":"cire","":"wedgeq","":"veeeq","":"trie","":"equest","":"equiv","":"nequiv","":"bnequiv","":"le","":"nle","":"nvle","":"ge","":"nge","":"nvge","":"lE","":"nlE","":"gE","":"ngE","":"lvnE","":"lnE","":"gnE","":"gvnE","":"ll","":"nLtv","":"nLt","":"gg","":"nGtv","":"nGt","":"twixt","":"lsim","":"nlsim","":"gsim","":"ngsim","":"lg","":"ntlg","":"gl","":"ntgl","":"pr","":"npr","":"sc","":"nsc","":"prcue","":"nprcue","":"sccue","":"nsccue","":"prsim","":"scsim","":"NotSucceedsTilde","":"sub","":"nsub","":"vnsub","":"sup","":"nsup","":"vnsup","":"sube","":"nsube","":"supe","":"nsupe","":"vsubne","":"subne","":"vsupne","":"supne","":"cupdot","":"uplus","":"sqsub","":"NotSquareSubset","":"sqsup","":"NotSquareSuperset","":"sqsube","":"nsqsube","":"sqsupe","":"nsqsupe","":"sqcap","":"sqcaps","":"sqcup","":"sqcups","":"oplus","":"ominus","":"otimes","":"osol","":"odot","":"ocir","":"oast","":"odash","":"plusb","":"minusb","":"timesb","":"sdotb","":"vdash","":"nvdash","":"dashv","":"top","":"bot","":"models","":"vDash","":"nvDash","":"Vdash","":"nVdash","":"Vvdash","":"VDash","":"nVDash","":"prurel","":"vltri","":"nltri","":"vrtri","":"nrtri","":"ltrie","":"nltrie","":"nvltrie","":"rtrie","":"nrtrie","":"nvrtrie","":"origof","":"imof","":"mumap","":"hercon","":"intcal","":"veebar","":"barvee","":"angrtvb","":"lrtri","":"Wedge","":"Vee","":"xcap","":"xcup","":"diam","":"sdot","":"Star","":"divonx","":"bowtie","":"ltimes","":"rtimes","":"lthree","":"rthree","":"bsime","":"cuvee","":"cuwed","":"Sub","":"Sup","":"Cap","":"Cup","":"fork","":"epar","":"ltdot","":"gtdot","":"Ll","":"nLl","":"Gg","":"nGg","":"lesg","":"leg","":"gel","":"gesl","":"cuepr","":"cuesc","":"lnsim","":"gnsim","":"prnsim","":"scnsim","":"vellip","":"ctdot","":"utdot","":"dtdot","":"disin","":"isinsv","":"isins","":"isindot","":"notindot","":"notinvc","":"notinvb","":"isinE","":"notinE","":"nisd","":"xnis","":"nis","":"notnivc","":"notnivb","":"barwed","":"Barwed","":"drcrop","":"dlcrop","":"urcrop","":"ulcrop","":"bnot","":"profline","":"profsurf","":"telrec","":"target","":"ulcorn","":"urcorn","":"dlcorn","":"drcorn","":"frown","":"smile","":"cylcty","":"profalar","":"topbot","":"ovbar","":"solbar","":"angzarr","":"lmoust","":"rmoust","":"tbrk","":"bbrk","":"bbrktbrk","":"OverParenthesis","":"UnderParenthesis","":"OverBrace","":"UnderBrace","":"trpezium","":"elinters","":"blank","":"boxh","":"boxv","":"boxdr","":"boxdl","":"boxur","":"boxul","":"boxvr","":"boxvl","":"boxhd","":"boxhu","":"boxvh","":"boxH","":"boxV","":"boxdR","":"boxDr","":"boxDR","":"boxdL","":"boxDl","":"boxDL","":"boxuR","":"boxUr","":"boxUR","":"boxuL","":"boxUl","":"boxUL","":"boxvR","":"boxVr","":"boxVR","":"boxvL","":"boxVl","":"boxVL","":"boxHd","":"boxhD","":"boxHD","":"boxHu","":"boxhU","":"boxHU","":"boxvH","":"boxVh","":"boxVH","":"uhblk","":"lhblk","":"block","":"blk14","":"blk12","":"blk34","":"squ","":"squf","":"EmptyVerySmallSquare","":"rect","":"marker","":"fltns","":"xutri","":"utrif","":"utri","":"rtrif","":"rtri","":"xdtri","":"dtrif","":"dtri","":"ltrif","":"ltri","":"loz","":"cir","":"tridot","":"xcirc","":"ultri","":"urtri","":"lltri","":"EmptySmallSquare","":"FilledSmallSquare","":"starf","":"star","":"phone","":"female","":"male","":"spades","":"clubs","":"hearts","":"diams","":"sung","":"check","":"cross","":"malt","":"sext","":"VerticalSeparator","":"bsolhsub","":"suphsol","":"xlarr","":"xrarr","":"xharr","":"xlArr","":"xrArr","":"xhArr","":"xmap","":"dzigrarr","":"nvlArr","":"nvrArr","":"nvHarr","":"Map","":"lbarr","":"rbarr","":"lBarr","":"rBarr","":"RBarr","":"DDotrahd","":"UpArrowBar","":"DownArrowBar","":"Rarrtl","":"latail","":"ratail","":"lAtail","":"rAtail","":"larrfs","":"rarrfs","":"larrbfs","":"rarrbfs","":"nwarhk","":"nearhk","":"searhk","":"swarhk","":"nwnear","":"toea","":"tosa","":"swnwar","":"rarrc","":"nrarrc","":"cudarrr","":"ldca","":"rdca","":"cudarrl","":"larrpl","":"curarrm","":"cularrp","":"rarrpl","":"harrcir","":"Uarrocir","":"lurdshar","":"ldrushar","":"LeftRightVector","":"RightUpDownVector","":"DownLeftRightVector","":"LeftUpDownVector","":"LeftVectorBar","":"RightVectorBar","":"RightUpVectorBar","":"RightDownVectorBar","":"DownLeftVectorBar","":"DownRightVectorBar","":"LeftUpVectorBar","":"LeftDownVectorBar","":"LeftTeeVector","":"RightTeeVector","":"RightUpTeeVector","":"RightDownTeeVector","":"DownLeftTeeVector","":"DownRightTeeVector","":"LeftUpTeeVector","":"LeftDownTeeVector","":"lHar","":"uHar","":"rHar","":"dHar","":"luruhar","":"ldrdhar","":"ruluhar","":"rdldhar","":"lharul","":"llhard","":"rharul","":"lrhard","":"udhar","":"duhar","":"RoundImplies","":"erarr","":"simrarr","":"larrsim","":"rarrsim","":"rarrap","":"ltlarr","":"gtrarr","":"subrarr","":"suplarr","":"lfisht","":"rfisht","":"ufisht","":"dfisht","":"vzigzag","":"vangrt","":"angrtvbd","":"ange","":"range","":"dwangle","":"uwangle","":"angmsdaa","":"angmsdab","":"angmsdac","":"angmsdad","":"angmsdae","":"angmsdaf","":"angmsdag","":"angmsdah","":"bemptyv","":"demptyv","":"cemptyv","":"raemptyv","":"laemptyv","":"ohbar","":"omid","":"opar","":"operp","":"olcross","":"odsold","":"olcir","":"ofcir","":"olt","":"ogt","":"cirscir","":"cirE","":"solb","":"bsolb","":"boxbox","":"trisb","":"rtriltri","":"LeftTriangleBar","":"NotLeftTriangleBar","":"RightTriangleBar","":"NotRightTriangleBar","":"iinfin","":"infintie","":"nvinfin","":"eparsl","":"smeparsl","":"eqvparsl","":"lozf","":"RuleDelayed","":"dsol","":"xodot","":"xoplus","":"xotime","":"xuplus","":"xsqcup","":"fpartint","":"cirfnint","":"awint","":"rppolint","":"scpolint","":"npolint","":"pointint","":"quatint","":"intlarhk","":"pluscir","":"plusacir","":"simplus","":"plusdu","":"plussim","":"plustwo","":"mcomma","":"minusdu","":"loplus","":"roplus","":"Cross","":"timesd","":"timesbar","":"smashp","":"lotimes","":"rotimes","":"otimesas","":"Otimes","":"odiv","":"triplus","":"triminus","":"tritime","":"iprod","":"amalg","":"capdot","":"ncup","":"ncap","":"capand","":"cupor","":"cupcap","":"capcup","":"cupbrcap","":"capbrcup","":"cupcup","":"capcap","":"ccups","":"ccaps","":"ccupssm","":"And","":"Or","":"andand","":"oror","":"orslope","":"andslope","":"andv","":"orv","":"andd","":"ord","":"wedbar","":"sdote","":"simdot","":"congdot","":"ncongdot","":"easter","":"apacir","":"apE","":"napE","":"eplus","":"pluse","":"Esim","":"eDDot","":"equivDD","":"ltcir","":"gtcir","":"ltquest","":"gtquest","":"les","":"nles","":"ges","":"nges","":"lesdot","":"gesdot","":"lesdoto","":"gesdoto","":"lesdotor","":"gesdotol","":"lap","":"gap","":"lne","":"gne","":"lnap","":"gnap","":"lEg","":"gEl","":"lsime","":"gsime","":"lsimg","":"gsiml","":"lgE","":"glE","":"lesges","":"gesles","":"els","":"egs","":"elsdot","":"egsdot","":"el","":"eg","":"siml","":"simg","":"simlE","":"simgE","":"LessLess","":"NotNestedLessLess","":"GreaterGreater","":"NotNestedGreaterGreater","":"glj","":"gla","":"ltcc","":"gtcc","":"lescc","":"gescc","":"smt","":"lat","":"smte","":"smtes","":"late","":"lates","":"bumpE","":"pre","":"npre","":"sce","":"nsce","":"prE","":"scE","":"prnE","":"scnE","":"prap","":"scap","":"prnap","":"scnap","":"Pr","":"Sc","":"subdot","":"supdot","":"subplus","":"supplus","":"submult","":"supmult","":"subedot","":"supedot","":"subE","":"nsubE","":"supE","":"nsupE","":"subsim","":"supsim","":"vsubnE","":"subnE","":"vsupnE","":"supnE","":"csub","":"csup","":"csube","":"csupe","":"subsup","":"supsub","":"subsub","":"supsup","":"suphsub","":"supdsub","":"forkv","":"topfork","":"mlcp","":"Dashv","":"Vdashl","":"Barv","":"vBar","":"vBarv","":"Vbar","":"Not","":"bNot","":"rnmid","":"cirmid","":"midcir","":"topcir","":"nhpar","":"parsim","":"parsl","":"nparsl","":"flat","":"natur","":"sharp","":"curren","":"cent",$:"dollar","":"pound","":"yen","":"euro","":"sup1","":"half","":"frac13","":"frac14","":"frac15","":"frac16","":"frac18","":"sup2","":"frac23","":"frac25","":"sup3","":"frac34","":"frac35","":"frac38","":"frac45","":"frac56","":"frac58","":"frac78","":"ascr","":"aopf","":"afr","":"Aopf","":"Afr","":"Ascr",:"ordf",:"aacute",:"Aacute",:"agrave",:"Agrave",:"abreve",:"Abreve",:"acirc",:"Acirc",:"aring",:"angst",:"auml",:"Auml",:"atilde",:"Atilde",:"aogon",:"Aogon",:"amacr",:"Amacr",:"aelig",:"AElig","":"bscr","":"bopf","":"bfr","":"Bopf",:"Bscr","":"Bfr","":"cfr","":"cscr","":"copf",:"Cfr","":"Cscr",:"Copf",:"cacute",:"Cacute",:"ccirc",:"Ccirc",:"ccaron",:"Ccaron",:"cdot",:"Cdot",:"ccedil",:"Ccedil","":"incare","":"dfr","":"dd","":"dopf","":"dscr","":"Dscr","":"Dfr","":"DD","":"Dopf",:"dcaron",:"Dcaron",:"dstrok",:"Dstrok",:"eth",:"ETH","":"ee",:"escr","":"efr","":"eopf",:"Escr","":"Efr","":"Eopf",:"eacute",:"Eacute",:"egrave",:"Egrave",:"ecirc",:"Ecirc",:"ecaron",:"Ecaron",:"euml",:"Euml",:"edot",:"Edot",:"eogon",:"Eogon",:"emacr",:"Emacr","":"ffr","":"fopf","":"fscr","":"Ffr","":"Fopf",:"Fscr",:"fflig",:"ffilig",:"ffllig",:"filig",fj:"fjlig",:"fllig",:"fnof",:"gscr","":"gopf","":"gfr","":"Gscr","":"Gopf","":"Gfr",:"gacute",:"gbreve",:"Gbreve",:"gcirc",:"Gcirc",:"gdot",:"Gdot",:"Gcedil","":"hfr",:"planckh","":"hscr","":"hopf",:"Hscr",:"Hfr",:"Hopf",:"hcirc",:"Hcirc",:"hbar",:"hstrok",:"Hstrok","":"iopf","":"ifr","":"iscr","":"ii","":"Iopf",:"Iscr",:"Im",:"iacute",:"Iacute",:"igrave",:"Igrave",:"icirc",:"Icirc",:"iuml",:"Iuml",:"itilde",:"Itilde",:"Idot",:"iogon",:"Iogon",:"imacr",:"Imacr",:"ijlig",:"IJlig",:"imath","":"jscr","":"jopf","":"jfr","":"Jscr","":"Jfr","":"Jopf",:"jcirc",:"Jcirc","":"jmath","":"kopf","":"kscr","":"kfr","":"Kscr","":"Kopf","":"Kfr",:"kcedil",:"Kcedil","":"lfr","":"lscr",:"ell","":"lopf",:"Lscr","":"Lfr","":"Lopf",:"lacute",:"Lacute",:"lcaron",:"Lcaron",:"lcedil",:"Lcedil",:"lstrok",:"Lstrok",:"lmidot",:"Lmidot","":"mfr","":"mopf","":"mscr","":"Mfr","":"Mopf",:"Mscr","":"nfr","":"nopf","":"nscr",:"Nopf","":"Nscr","":"Nfr",:"nacute",:"Nacute",:"ncaron",:"Ncaron",:"ntilde",:"Ntilde",:"ncedil",:"Ncedil","":"numero",:"eng",:"ENG","":"oopf","":"ofr",:"oscr","":"Oscr","":"Ofr","":"Oopf",:"ordm",:"oacute",:"Oacute",:"ograve",:"Ograve",:"ocirc",:"Ocirc",:"ouml",:"Ouml",:"odblac",:"Odblac",:"otilde",:"Otilde",:"oslash",:"Oslash",:"omacr",:"Omacr",:"oelig",:"OElig","":"pfr","":"pscr","":"popf",:"Popf","":"Pfr","":"Pscr","":"qopf","":"qfr","":"qscr","":"Qscr","":"Qfr",:"Qopf",:"kgreen","":"rfr","":"ropf","":"rscr",:"Rscr",:"Re",:"Ropf",:"racute",:"Racute",:"rcaron",:"Rcaron",:"rcedil",:"Rcedil","":"sopf","":"sscr","":"sfr","":"Sopf","":"Sfr","":"Sscr","":"oS",:"sacute",:"Sacute",:"scirc",:"Scirc",:"scaron",:"Scaron",:"scedil",:"Scedil",:"szlig","":"tfr","":"tscr","":"topf","":"Tscr","":"Tfr","":"Topf",:"tcaron",:"Tcaron",:"tcedil",:"Tcedil","":"trade",:"tstrok",:"Tstrok","":"uscr","":"uopf","":"ufr","":"Uopf","":"Ufr","":"Uscr",:"uacute",:"Uacute",:"ugrave",:"Ugrave",:"ubreve",:"Ubreve",:"ucirc",:"Ucirc",:"uring",:"Uring",:"uuml",:"Uuml",:"udblac",:"Udblac",:"utilde",:"Utilde",:"uogon",:"Uogon",:"umacr",:"Umacr","":"vfr","":"vopf","":"vscr","":"Vfr","":"Vopf","":"Vscr","":"wopf","":"wscr","":"wfr","":"Wscr","":"Wopf","":"Wfr",:"wcirc",:"Wcirc","":"xfr","":"xscr","":"xopf","":"Xopf","":"Xfr","":"Xscr","":"yfr","":"yscr","":"yopf","":"Yscr","":"Yfr","":"Yopf",:"yacute",:"Yacute",:"ycirc",:"Ycirc",:"yuml",:"Yuml","":"zscr","":"zfr","":"zopf",:"Zfr",:"Zopf","":"Zscr",:"zacute",:"Zacute",:"zcaron",:"Zcaron",:"zdot",:"Zdot",:"imped",:"thorn",:"THORN",:"napos",:"alpha",:"Alpha",:"beta",:"Beta",:"gamma",:"Gamma",:"delta",:"Delta",:"epsi","":"epsiv",:"Epsilon",:"gammad",:"Gammad",:"zeta",:"Zeta",:"eta",:"Eta",:"theta",:"thetav",:"Theta",:"iota",:"Iota",:"kappa",:"kappav",:"Kappa",:"lambda",:"Lambda",:"mu",:"micro",:"Mu",:"nu",:"Nu",:"xi",:"Xi",:"omicron",:"Omicron",:"pi",:"piv",:"Pi",:"rho",:"rhov",:"Rho",:"sigma",:"Sigma",:"sigmaf",:"tau",:"Tau",:"upsi",:"Upsilon",:"Upsi",:"phi",:"phiv",:"Phi",:"chi",:"Chi",:"psi",:"Psi",:"omega",:"ohm",:"acy",:"Acy",:"bcy",:"Bcy",:"vcy",:"Vcy",:"gcy",:"Gcy",:"gjcy",:"GJcy",:"dcy",:"Dcy",:"djcy",:"DJcy",:"iecy",:"IEcy",:"iocy",:"IOcy",:"jukcy",:"Jukcy",:"zhcy",:"ZHcy",:"zcy",:"Zcy",:"dscy",:"DScy",:"icy",:"Icy",:"iukcy",:"Iukcy",:"yicy",:"YIcy",:"jcy",:"Jcy",:"jsercy",:"Jsercy",:"kcy",:"Kcy",:"kjcy",:"KJcy",:"lcy",:"Lcy",:"ljcy",:"LJcy",:"mcy",:"Mcy",:"ncy",:"Ncy",:"njcy",:"NJcy",:"ocy",:"Ocy",:"pcy",:"Pcy",:"rcy",:"Rcy",:"scy",:"Scy",:"tcy",:"Tcy",:"tshcy",:"TSHcy",:"ucy",:"Ucy",:"ubrcy",:"Ubrcy",:"fcy",:"Fcy",:"khcy",:"KHcy",:"tscy",:"TScy",:"chcy",:"CHcy",:"dzcy",:"DZcy",:"shcy",:"SHcy",:"shchcy",:"SHCHcy",:"hardcy",:"HARDcy",:"ycy",:"Ycy",:"softcy",:"SOFTcy",:"ecy",:"Ecy",:"yucy",:"YUcy",:"yacy",:"YAcy",:"aleph",:"beth",:"gimel",:"daleth"},m=/["&'<>`]/g,p={'"':"&quot;","&":"&amp;","'":"&#x27;","<":"&lt;",">":"&gt;","`":"&#x60;"},h=/&#(?:[xX][^a-fA-F0-9]|[^0-9xX])/,g=/[\0-\x08\x0B\x0E-\x1F\x7F-\x9F\uFDD0-\uFDEF\uFFFE\uFFFF]|[\uD83F\uD87F\uD8BF\uD8FF\uD93F\uD97F\uD9BF\uD9FF\uDA3F\uDA7F\uDABF\uDAFF\uDB3F\uDB7F\uDBBF\uDBFF][\uDFFE\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,y=/&(CounterClockwiseContourIntegral|DoubleLongLeftRightArrow|ClockwiseContourIntegral|NotNestedGreaterGreater|NotSquareSupersetEqual|DiacriticalDoubleAcute|NotRightTriangleEqual|NotSucceedsSlantEqual|NotPrecedesSlantEqual|CloseCurlyDoubleQuote|NegativeVeryThinSpace|DoubleContourIntegral|FilledVerySmallSquare|CapitalDifferentialD|OpenCurlyDoubleQuote|EmptyVerySmallSquare|NestedGreaterGreater|DoubleLongRightArrow|NotLeftTriangleEqual|NotGreaterSlantEqual|ReverseUpEquilibrium|DoubleLeftRightArrow|NotSquareSubsetEqual|NotDoubleVerticalBar|RightArrowLeftArrow|NotGreaterFullEqual|NotRightTriangleBar|SquareSupersetEqual|DownLeftRightVector|DoubleLongLeftArrow|leftrightsquigarrow|LeftArrowRightArrow|NegativeMediumSpace|blacktriangleright|RightDownVectorBar|PrecedesSlantEqual|RightDoubleBracket|SucceedsSlantEqual|NotLeftTriangleBar|RightTriangleEqual|SquareIntersection|RightDownTeeVector|ReverseEquilibrium|NegativeThickSpace|longleftrightarrow|Longleftrightarrow|LongLeftRightArrow|DownRightTeeVector|DownRightVectorBar|GreaterSlantEqual|SquareSubsetEqual|LeftDownVectorBar|LeftDoubleBracket|VerticalSeparator|rightleftharpoons|NotGreaterGreater|NotSquareSuperset|blacktriangleleft|blacktriangledown|NegativeThinSpace|LeftDownTeeVector|NotLessSlantEqual|leftrightharpoons|DoubleUpDownArrow|DoubleVerticalBar|LeftTriangleEqual|FilledSmallSquare|twoheadrightarrow|NotNestedLessLess|DownLeftTeeVector|DownLeftVectorBar|RightAngleBracket|NotTildeFullEqual|NotReverseElement|RightUpDownVector|DiacriticalTilde|NotSucceedsTilde|circlearrowright|NotPrecedesEqual|rightharpoondown|DoubleRightArrow|NotSucceedsEqual|NonBreakingSpace|NotRightTriangle|LessEqualGreater|RightUpTeeVector|LeftAngleBracket|GreaterFullEqual|DownArrowUpArrow|RightUpVectorBar|twoheadleftarrow|GreaterEqualLess|downharpoonright|RightTriangleBar|ntrianglerighteq|NotSupersetEqual|LeftUpDownVector|DiacriticalAcute|rightrightarrows|vartriangleright|UpArrowDownArrow|DiacriticalGrave|UnderParenthesis|EmptySmallSquare|LeftUpVectorBar|leftrightarrows|DownRightVector|downharpoonleft|trianglerighteq|ShortRightArrow|OverParenthesis|DoubleLeftArrow|DoubleDownArrow|NotSquareSubset|bigtriangledown|ntrianglelefteq|UpperRightArrow|curvearrowright|vartriangleleft|NotLeftTriangle|nleftrightarrow|LowerRightArrow|NotHumpDownHump|NotGreaterTilde|rightthreetimes|LeftUpTeeVector|NotGreaterEqual|straightepsilon|LeftTriangleBar|rightsquigarrow|ContourIntegral|rightleftarrows|CloseCurlyQuote|RightDownVector|LeftRightVector|nLeftrightarrow|leftharpoondown|circlearrowleft|SquareSuperset|OpenCurlyQuote|hookrightarrow|HorizontalLine|DiacriticalDot|NotLessGreater|ntriangleright|DoubleRightTee|InvisibleComma|InvisibleTimes|LowerLeftArrow|DownLeftVector|NotSubsetEqual|curvearrowleft|trianglelefteq|NotVerticalBar|TildeFullEqual|downdownarrows|NotGreaterLess|RightTeeVector|ZeroWidthSpace|looparrowright|LongRightArrow|doublebarwedge|ShortLeftArrow|ShortDownArrow|RightVectorBar|GreaterGreater|ReverseElement|rightharpoonup|LessSlantEqual|leftthreetimes|upharpoonright|rightarrowtail|LeftDownVector|Longrightarrow|NestedLessLess|UpperLeftArrow|nshortparallel|leftleftarrows|leftrightarrow|Leftrightarrow|LeftRightArrow|longrightarrow|upharpoonleft|RightArrowBar|ApplyFunction|LeftTeeVector|leftarrowtail|NotEqualTilde|varsubsetneqq|varsupsetneqq|RightTeeArrow|SucceedsEqual|SucceedsTilde|LeftVectorBar|SupersetEqual|hookleftarrow|DifferentialD|VerticalTilde|VeryThinSpace|blacktriangle|bigtriangleup|LessFullEqual|divideontimes|leftharpoonup|UpEquilibrium|ntriangleleft|RightTriangle|measuredangle|shortparallel|longleftarrow|Longleftarrow|LongLeftArrow|DoubleLeftTee|Poincareplane|PrecedesEqual|triangleright|DoubleUpArrow|RightUpVector|fallingdotseq|looparrowleft|PrecedesTilde|NotTildeEqual|NotTildeTilde|smallsetminus|Proportional|triangleleft|triangledown|UnderBracket|NotHumpEqual|exponentiale|ExponentialE|NotLessTilde|HilbertSpace|RightCeiling|blacklozenge|varsupsetneq|HumpDownHump|GreaterEqual|VerticalLine|LeftTeeArrow|NotLessEqual|DownTeeArrow|LeftTriangle|varsubsetneq|Intersection|NotCongruent|DownArrowBar|LeftUpVector|LeftArrowBar|risingdotseq|GreaterTilde|RoundImplies|SquareSubset|ShortUpArrow|NotSuperset|quaternions|precnapprox|backepsilon|preccurlyeq|OverBracket|blacksquare|MediumSpace|VerticalBar|circledcirc|circleddash|CircleMinus|CircleTimes|LessGreater|curlyeqprec|curlyeqsucc|diamondsuit|UpDownArrow|Updownarrow|RuleDelayed|Rrightarrow|updownarrow|RightVector|nRightarrow|nrightarrow|eqslantless|LeftCeiling|Equilibrium|SmallCircle|expectation|NotSucceeds|thickapprox|GreaterLess|SquareUnion|NotPrecedes|NotLessLess|straightphi|succnapprox|succcurlyeq|SubsetEqual|sqsupseteq|Proportion|Laplacetrf|ImaginaryI|supsetneqq|NotGreater|gtreqqless|NotElement|ThickSpace|TildeEqual|TildeTilde|Fouriertrf|rmoustache|EqualTilde|eqslantgtr|UnderBrace|LeftVector|UpArrowBar|nLeftarrow|nsubseteqq|subsetneqq|nsupseteqq|nleftarrow|succapprox|lessapprox|UpTeeArrow|upuparrows|curlywedge|lesseqqgtr|varepsilon|varnothing|RightFloor|complement|CirclePlus|sqsubseteq|Lleftarrow|circledast|RightArrow|Rightarrow|rightarrow|lmoustache|Bernoullis|precapprox|mapstoleft|mapstodown|longmapsto|dotsquare|downarrow|DoubleDot|nsubseteq|supsetneq|leftarrow|nsupseteq|subsetneq|ThinSpace|ngeqslant|subseteqq|HumpEqual|NotSubset|triangleq|NotCupCap|lesseqgtr|heartsuit|TripleDot|Leftarrow|Coproduct|Congruent|varpropto|complexes|gvertneqq|LeftArrow|LessTilde|supseteqq|MinusPlus|CircleDot|nleqslant|NotExists|gtreqless|nparallel|UnionPlus|LeftFloor|checkmark|CenterDot|centerdot|Mellintrf|gtrapprox|bigotimes|OverBrace|spadesuit|therefore|pitchfork|rationals|PlusMinus|Backslash|Therefore|DownBreve|backsimeq|backprime|DownArrow|nshortmid|Downarrow|lvertneqq|eqvparsl|imagline|imagpart|infintie|integers|Integral|intercal|LessLess|Uarrocir|intlarhk|sqsupset|angmsdaf|sqsubset|llcorner|vartheta|cupbrcap|lnapprox|Superset|SuchThat|succnsim|succneqq|angmsdag|biguplus|curlyvee|trpezium|Succeeds|NotTilde|bigwedge|angmsdah|angrtvbd|triminus|cwconint|fpartint|lrcorner|smeparsl|subseteq|urcorner|lurdshar|laemptyv|DDotrahd|approxeq|ldrushar|awconint|mapstoup|backcong|shortmid|triangle|geqslant|gesdotol|timesbar|circledR|circledS|setminus|multimap|naturals|scpolint|ncongdot|RightTee|boxminus|gnapprox|boxtimes|andslope|thicksim|angmsdaa|varsigma|cirfnint|rtriltri|angmsdab|rppolint|angmsdac|barwedge|drbkarow|clubsuit|thetasym|bsolhsub|capbrcup|dzigrarr|doteqdot|DotEqual|dotminus|UnderBar|NotEqual|realpart|otimesas|ulcorner|hksearow|hkswarow|parallel|PartialD|elinters|emptyset|plusacir|bbrktbrk|angmsdad|pointint|bigoplus|angmsdae|Precedes|bigsqcup|varkappa|notindot|supseteq|precneqq|precnsim|profalar|profline|profsurf|leqslant|lesdotor|raemptyv|subplus|notnivb|notnivc|subrarr|zigrarr|vzigzag|submult|subedot|Element|between|cirscir|larrbfs|larrsim|lotimes|lbrksld|lbrkslu|lozenge|ldrdhar|dbkarow|bigcirc|epsilon|simrarr|simplus|ltquest|Epsilon|luruhar|gtquest|maltese|npolint|eqcolon|npreceq|bigodot|ddagger|gtrless|bnequiv|harrcir|ddotseq|equivDD|backsim|demptyv|nsqsube|nsqsupe|Upsilon|nsubset|upsilon|minusdu|nsucceq|swarrow|nsupset|coloneq|searrow|boxplus|napprox|natural|asympeq|alefsym|congdot|nearrow|bigstar|diamond|supplus|tritime|LeftTee|nvinfin|triplus|NewLine|nvltrie|nvrtrie|nwarrow|nexists|Diamond|ruluhar|Implies|supmult|angzarr|suplarr|suphsub|questeq|because|digamma|Because|olcross|bemptyv|omicron|Omicron|rotimes|NoBreak|intprod|angrtvb|orderof|uwangle|suphsol|lesdoto|orslope|DownTee|realine|cudarrl|rdldhar|OverBar|supedot|lessdot|supdsub|topfork|succsim|rbrkslu|rbrksld|pertenk|cudarrr|isindot|planckh|lessgtr|pluscir|gesdoto|plussim|plustwo|lesssim|cularrp|rarrsim|Cayleys|notinva|notinvb|notinvc|UpArrow|Uparrow|uparrow|NotLess|dwangle|precsim|Product|curarrm|Cconint|dotplus|rarrbfs|ccupssm|Cedilla|cemptyv|notniva|quatint|frac35|frac38|frac45|frac56|frac58|frac78|tridot|xoplus|gacute|gammad|Gammad|lfisht|lfloor|bigcup|sqsupe|gbreve|Gbreve|lharul|sqsube|sqcups|Gcedil|apacir|llhard|lmidot|Lmidot|lmoust|andand|sqcaps|approx|Abreve|spades|circeq|tprime|divide|topcir|Assign|topbot|gesdot|divonx|xuplus|timesd|gesles|atilde|solbar|SOFTcy|loplus|timesb|lowast|lowbar|dlcorn|dlcrop|softcy|dollar|lparlt|thksim|lrhard|Atilde|lsaquo|smashp|bigvee|thinsp|wreath|bkarow|lsquor|lstrok|Lstrok|lthree|ltimes|ltlarr|DotDot|simdot|ltrPar|weierp|xsqcup|angmsd|sigmav|sigmaf|zeetrf|Zcaron|zcaron|mapsto|vsupne|thetav|cirmid|marker|mcomma|Zacute|vsubnE|there4|gtlPar|vsubne|bottom|gtrarr|SHCHcy|shchcy|midast|midcir|middot|minusb|minusd|gtrdot|bowtie|sfrown|mnplus|models|colone|seswar|Colone|mstpos|searhk|gtrsim|nacute|Nacute|boxbox|telrec|hairsp|Tcedil|nbumpe|scnsim|ncaron|Ncaron|ncedil|Ncedil|hamilt|Scedil|nearhk|hardcy|HARDcy|tcedil|Tcaron|commat|nequiv|nesear|tcaron|target|hearts|nexist|varrho|scedil|Scaron|scaron|hellip|Sacute|sacute|hercon|swnwar|compfn|rtimes|rthree|rsquor|rsaquo|zacute|wedgeq|homtht|barvee|barwed|Barwed|rpargt|horbar|conint|swarhk|roplus|nltrie|hslash|hstrok|Hstrok|rmoust|Conint|bprime|hybull|hyphen|iacute|Iacute|supsup|supsub|supsim|varphi|coprod|brvbar|agrave|Supset|supset|igrave|Igrave|notinE|Agrave|iiiint|iinfin|copysr|wedbar|Verbar|vangrt|becaus|incare|verbar|inodot|bullet|drcorn|intcal|drcrop|cularr|vellip|Utilde|bumpeq|cupcap|dstrok|Dstrok|CupCap|cupcup|cupdot|eacute|Eacute|supdot|iquest|easter|ecaron|Ecaron|ecolon|isinsv|utilde|itilde|Itilde|curarr|succeq|Bumpeq|cacute|ulcrop|nparsl|Cacute|nprcue|egrave|Egrave|nrarrc|nrarrw|subsup|subsub|nrtrie|jsercy|nsccue|Jsercy|kappav|kcedil|Kcedil|subsim|ulcorn|nsimeq|egsdot|veebar|kgreen|capand|elsdot|Subset|subset|curren|aacute|lacute|Lacute|emptyv|ntilde|Ntilde|lagran|lambda|Lambda|capcap|Ugrave|langle|subdot|emsp13|numero|emsp14|nvdash|nvDash|nVdash|nVDash|ugrave|ufisht|nvHarr|larrfs|nvlArr|larrhk|larrlp|larrpl|nvrArr|Udblac|nwarhk|larrtl|nwnear|oacute|Oacute|latail|lAtail|sstarf|lbrace|odblac|Odblac|lbrack|udblac|odsold|eparsl|lcaron|Lcaron|ograve|Ograve|lcedil|Lcedil|Aacute|ssmile|ssetmn|squarf|ldquor|capcup|ominus|cylcty|rharul|eqcirc|dagger|rfloor|rfisht|Dagger|daleth|equals|origof|capdot|equest|dcaron|Dcaron|rdquor|oslash|Oslash|otilde|Otilde|otimes|Otimes|urcrop|Ubreve|ubreve|Yacute|Uacute|uacute|Rcedil|rcedil|urcorn|parsim|Rcaron|Vdashl|rcaron|Tstrok|percnt|period|permil|Exists|yacute|rbrack|rbrace|phmmat|ccaron|Ccaron|planck|ccedil|plankv|tstrok|female|plusdo|plusdu|ffilig|plusmn|ffllig|Ccedil|rAtail|dfisht|bernou|ratail|Rarrtl|rarrtl|angsph|rarrpl|rarrlp|rarrhk|xwedge|xotime|forall|ForAll|Vvdash|vsupnE|preceq|bigcap|frac12|frac13|frac14|primes|rarrfs|prnsim|frac15|Square|frac16|square|lesdot|frac18|frac23|propto|prurel|rarrap|rangle|puncsp|frac25|Racute|qprime|racute|lesges|frac34|abreve|AElig|eqsim|utdot|setmn|urtri|Equal|Uring|seArr|uring|searr|dashv|Dashv|mumap|nabla|iogon|Iogon|sdote|sdotb|scsim|napid|napos|equiv|natur|Acirc|dblac|erarr|nbump|iprod|erDot|ucirc|awint|esdot|angrt|ncong|isinE|scnap|Scirc|scirc|ndash|isins|Ubrcy|nearr|neArr|isinv|nedot|ubrcy|acute|Ycirc|iukcy|Iukcy|xutri|nesim|caret|jcirc|Jcirc|caron|twixt|ddarr|sccue|exist|jmath|sbquo|ngeqq|angst|ccaps|lceil|ngsim|UpTee|delta|Delta|rtrif|nharr|nhArr|nhpar|rtrie|jukcy|Jukcy|kappa|rsquo|Kappa|nlarr|nlArr|TSHcy|rrarr|aogon|Aogon|fflig|xrarr|tshcy|ccirc|nleqq|filig|upsih|nless|dharl|nlsim|fjlig|ropar|nltri|dharr|robrk|roarr|fllig|fltns|roang|rnmid|subnE|subne|lAarr|trisb|Ccirc|acirc|ccups|blank|VDash|forkv|Vdash|langd|cedil|blk12|blk14|laquo|strns|diams|notin|vDash|larrb|blk34|block|disin|uplus|vdash|vBarv|aelig|starf|Wedge|check|xrArr|lates|lbarr|lBarr|notni|lbbrk|bcong|frasl|lbrke|frown|vrtri|vprop|vnsup|gamma|Gamma|wedge|xodot|bdquo|srarr|doteq|ldquo|boxdl|boxdL|gcirc|Gcirc|boxDl|boxDL|boxdr|boxdR|boxDr|TRADE|trade|rlhar|boxDR|vnsub|npart|vltri|rlarr|boxhd|boxhD|nprec|gescc|nrarr|nrArr|boxHd|boxHD|boxhu|boxhU|nrtri|boxHu|clubs|boxHU|times|colon|Colon|gimel|xlArr|Tilde|nsime|tilde|nsmid|nspar|THORN|thorn|xlarr|nsube|nsubE|thkap|xhArr|comma|nsucc|boxul|boxuL|nsupe|nsupE|gneqq|gnsim|boxUl|boxUL|grave|boxur|boxuR|boxUr|boxUR|lescc|angle|bepsi|boxvh|varpi|boxvH|numsp|Theta|gsime|gsiml|theta|boxVh|boxVH|boxvl|gtcir|gtdot|boxvL|boxVl|boxVL|crarr|cross|Cross|nvsim|boxvr|nwarr|nwArr|sqsup|dtdot|Uogon|lhard|lharu|dtrif|ocirc|Ocirc|lhblk|duarr|odash|sqsub|Hacek|sqcup|llarr|duhar|oelig|OElig|ofcir|boxvR|uogon|lltri|boxVr|csube|uuarr|ohbar|csupe|ctdot|olarr|olcir|harrw|oline|sqcap|omacr|Omacr|omega|Omega|boxVR|aleph|lneqq|lnsim|loang|loarr|rharu|lobrk|hcirc|operp|oplus|rhard|Hcirc|orarr|Union|order|ecirc|Ecirc|cuepr|szlig|cuesc|breve|reals|eDDot|Breve|hoarr|lopar|utrif|rdquo|Umacr|umacr|efDot|swArr|ultri|alpha|rceil|ovbar|swarr|Wcirc|wcirc|smtes|smile|bsemi|lrarr|aring|parsl|lrhar|bsime|uhblk|lrtri|cupor|Aring|uharr|uharl|slarr|rbrke|bsolb|lsime|rbbrk|RBarr|lsimg|phone|rBarr|rbarr|icirc|lsquo|Icirc|emacr|Emacr|ratio|simne|plusb|simlE|simgE|simeq|pluse|ltcir|ltdot|empty|xharr|xdtri|iexcl|Alpha|ltrie|rarrw|pound|ltrif|xcirc|bumpe|prcue|bumpE|asymp|amacr|cuvee|Sigma|sigma|iiint|udhar|iiota|ijlig|IJlig|supnE|imacr|Imacr|prime|Prime|image|prnap|eogon|Eogon|rarrc|mdash|mDDot|cuwed|imath|supne|imped|Amacr|udarr|prsim|micro|rarrb|cwint|raquo|infin|eplus|range|rangd|Ucirc|radic|minus|amalg|veeeq|rAarr|epsiv|ycirc|quest|sharp|quot|zwnj|Qscr|race|qscr|Qopf|qopf|qint|rang|Rang|Zscr|zscr|Zopf|zopf|rarr|rArr|Rarr|Pscr|pscr|prop|prod|prnE|prec|ZHcy|zhcy|prap|Zeta|zeta|Popf|popf|Zdot|plus|zdot|Yuml|yuml|phiv|YUcy|yucy|Yscr|yscr|perp|Yopf|yopf|part|para|YIcy|Ouml|rcub|yicy|YAcy|rdca|ouml|osol|Oscr|rdsh|yacy|real|oscr|xvee|andd|rect|andv|Xscr|oror|ordm|ordf|xscr|ange|aopf|Aopf|rHar|Xopf|opar|Oopf|xopf|xnis|rhov|oopf|omid|xmap|oint|apid|apos|ogon|ascr|Ascr|odot|odiv|xcup|xcap|ocir|oast|nvlt|nvle|nvgt|nvge|nvap|Wscr|wscr|auml|ntlg|ntgl|nsup|nsub|nsim|Nscr|nscr|nsce|Wopf|ring|npre|wopf|npar|Auml|Barv|bbrk|Nopf|nopf|nmid|nLtv|beta|ropf|Ropf|Beta|beth|nles|rpar|nleq|bnot|bNot|nldr|NJcy|rscr|Rscr|Vscr|vscr|rsqb|njcy|bopf|nisd|Bopf|rtri|Vopf|nGtv|ngtr|vopf|boxh|boxH|boxv|nges|ngeq|boxV|bscr|scap|Bscr|bsim|Vert|vert|bsol|bull|bump|caps|cdot|ncup|scnE|ncap|nbsp|napE|Cdot|cent|sdot|Vbar|nang|vBar|chcy|Mscr|mscr|sect|semi|CHcy|Mopf|mopf|sext|circ|cire|mldr|mlcp|cirE|comp|shcy|SHcy|vArr|varr|cong|copf|Copf|copy|COPY|malt|male|macr|lvnE|cscr|ltri|sime|ltcc|simg|Cscr|siml|csub|Uuml|lsqb|lsim|uuml|csup|Lscr|lscr|utri|smid|lpar|cups|smte|lozf|darr|Lopf|Uscr|solb|lopf|sopf|Sopf|lneq|uscr|spar|dArr|lnap|Darr|dash|Sqrt|LJcy|ljcy|lHar|dHar|Upsi|upsi|diam|lesg|djcy|DJcy|leqq|dopf|Dopf|dscr|Dscr|dscy|ldsh|ldca|squf|DScy|sscr|Sscr|dsol|lcub|late|star|Star|Uopf|Larr|lArr|larr|uopf|dtri|dzcy|sube|subE|Lang|lang|Kscr|kscr|Kopf|kopf|KJcy|kjcy|KHcy|khcy|DZcy|ecir|edot|eDot|Jscr|jscr|succ|Jopf|jopf|Edot|uHar|emsp|ensp|Iuml|iuml|eopf|isin|Iscr|iscr|Eopf|epar|sung|epsi|escr|sup1|sup2|sup3|Iota|iota|supe|supE|Iopf|iopf|IOcy|iocy|Escr|esim|Esim|imof|Uarr|QUOT|uArr|uarr|euml|IEcy|iecy|Idot|Euml|euro|excl|Hscr|hscr|Hopf|hopf|TScy|tscy|Tscr|hbar|tscr|flat|tbrk|fnof|hArr|harr|half|fopf|Fopf|tdot|gvnE|fork|trie|gtcc|fscr|Fscr|gdot|gsim|Gscr|gscr|Gopf|gopf|gneq|Gdot|tosa|gnap|Topf|topf|geqq|toea|GJcy|gjcy|tint|gesl|mid|Sfr|ggg|top|ges|gla|glE|glj|geq|gne|gEl|gel|gnE|Gcy|gcy|gap|Tfr|tfr|Tcy|tcy|Hat|Tau|Ffr|tau|Tab|hfr|Hfr|ffr|Fcy|fcy|icy|Icy|iff|ETH|eth|ifr|Ifr|Eta|eta|int|Int|Sup|sup|ucy|Ucy|Sum|sum|jcy|ENG|ufr|Ufr|eng|Jcy|jfr|els|ell|egs|Efr|efr|Jfr|uml|kcy|Kcy|Ecy|ecy|kfr|Kfr|lap|Sub|sub|lat|lcy|Lcy|leg|Dot|dot|lEg|leq|les|squ|div|die|lfr|Lfr|lgE|Dfr|dfr|Del|deg|Dcy|dcy|lne|lnE|sol|loz|smt|Cup|lrm|cup|lsh|Lsh|sim|shy|map|Map|mcy|Mcy|mfr|Mfr|mho|gfr|Gfr|sfr|cir|Chi|chi|nap|Cfr|vcy|Vcy|cfr|Scy|scy|ncy|Ncy|vee|Vee|Cap|cap|nfr|scE|sce|Nfr|nge|ngE|nGg|vfr|Vfr|ngt|bot|nGt|nis|niv|Rsh|rsh|nle|nlE|bne|Bfr|bfr|nLl|nlt|nLt|Bcy|bcy|not|Not|rlm|wfr|Wfr|npr|nsc|num|ocy|ast|Ocy|ofr|xfr|Xfr|Ofr|ogt|ohm|apE|olt|Rho|ape|rho|Rfr|rfr|ord|REG|ang|reg|orv|And|and|AMP|Rcy|amp|Afr|ycy|Ycy|yen|yfr|Yfr|rcy|par|pcy|Pcy|pfr|Pfr|phi|Phi|afr|Acy|acy|zcy|Zcy|piv|acE|acd|zfr|Zfr|pre|prE|psi|Psi|qfr|Qfr|zwj|Or|ge|Gg|gt|gg|el|oS|lt|Lt|LT|Re|lg|gl|eg|ne|Im|it|le|DD|wp|wr|nu|Nu|dd|lE|Sc|sc|pi|Pi|ee|af|ll|Ll|rx|gE|xi|pm|Xi|ic|pr|Pr|in|ni|mp|mu|ac|Mu|or|ap|Gt|GT|ii);|&(Aacute|Agrave|Atilde|Ccedil|Eacute|Egrave|Iacute|Igrave|Ntilde|Oacute|Ograve|Oslash|Otilde|Uacute|Ugrave|Yacute|aacute|agrave|atilde|brvbar|ccedil|curren|divide|eacute|egrave|frac12|frac14|frac34|iacute|igrave|iquest|middot|ntilde|oacute|ograve|oslash|otilde|plusmn|uacute|ugrave|yacute|AElig|Acirc|Aring|Ecirc|Icirc|Ocirc|THORN|Ucirc|acirc|acute|aelig|aring|cedil|ecirc|icirc|iexcl|laquo|micro|ocirc|pound|raquo|szlig|thorn|times|ucirc|Auml|COPY|Euml|Iuml|Ouml|QUOT|Uuml|auml|cent|copy|euml|iuml|macr|nbsp|ordf|ordm|ouml|para|quot|sect|sup1|sup2|sup3|uuml|yuml|AMP|ETH|REG|amp|deg|eth|not|reg|shy|uml|yen|GT|LT|gt|lt)(?!;)([=a-zA-Z0-9]?)|&#([0-9]+)(;?)|&#[xX]([a-fA-F0-9]+)(;?)|&([0-9a-zA-Z]+)/g,b={aacute:"",Aacute:"",abreve:"",Abreve:"",ac:"",acd:"",acE:"",acirc:"",Acirc:"",acute:"",acy:"",Acy:"",aelig:"",AElig:"",af:"",afr:"",Afr:"",agrave:"",Agrave:"",alefsym:"",aleph:"",alpha:"",Alpha:"",amacr:"",Amacr:"",amalg:"",amp:"&",AMP:"&",and:"",And:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",aogon:"",Aogon:"",aopf:"",Aopf:"",ap:"",apacir:"",ape:"",apE:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",aring:"",Aring:"",ascr:"",Ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",atilde:"",Atilde:"",auml:"",Auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",barwed:"",Barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",bcy:"",Bcy:"",bdquo:"",becaus:"",because:"",Because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",beta:"",Beta:"",beth:"",between:"",bfr:"",Bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bnot:"",bNot:"",bopf:"",Bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxdl:"",boxdL:"",boxDl:"",boxDL:"",boxdr:"",boxdR:"",boxDr:"",boxDR:"",boxh:"",boxH:"",boxhd:"",boxhD:"",boxHd:"",boxHD:"",boxhu:"",boxhU:"",boxHu:"",boxHU:"",boxminus:"",boxplus:"",boxtimes:"",boxul:"",boxuL:"",boxUl:"",boxUL:"",boxur:"",boxuR:"",boxUr:"",boxUR:"",boxv:"",boxV:"",boxvh:"",boxvH:"",boxVh:"",boxVH:"",boxvl:"",boxvL:"",boxVl:"",boxVL:"",boxvr:"",boxvR:"",boxVr:"",boxVR:"",bprime:"",breve:"",Breve:"",brvbar:"",bscr:"",Bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpe:"",bumpE:"",bumpeq:"",Bumpeq:"",cacute:"",Cacute:"",cap:"",Cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",ccaron:"",Ccaron:"",ccedil:"",Ccedil:"",ccirc:"",Ccirc:"",Cconint:"",ccups:"",ccupssm:"",cdot:"",Cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",centerdot:"",CenterDot:"",cfr:"",Cfr:"",chcy:"",CHcy:"",check:"",checkmark:"",chi:"",Chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cire:"",cirE:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",colon:":",Colon:"",colone:"",Colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",conint:"",Conint:"",ContourIntegral:"",copf:"",Copf:"",coprod:"",Coproduct:"",copy:"",COPY:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",cross:"",Cross:"",cscr:"",Cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",cup:"",Cup:"",cupbrcap:"",cupcap:"",CupCap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",dagger:"",Dagger:"",daleth:"",darr:"",dArr:"",Darr:"",dash:"",dashv:"",Dashv:"",dbkarow:"",dblac:"",dcaron:"",Dcaron:"",dcy:"",Dcy:"",dd:"",DD:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",delta:"",Delta:"",demptyv:"",dfisht:"",dfr:"",Dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",diamond:"",Diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",djcy:"",DJcy:"",dlcorn:"",dlcrop:"",dollar:"$",dopf:"",Dopf:"",dot:"",Dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",downarrow:"",Downarrow:"",DownArrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",dscr:"",Dscr:"",dscy:"",DScy:"",dsol:"",dstrok:"",Dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",dzcy:"",DZcy:"",dzigrarr:"",eacute:"",Eacute:"",easter:"",ecaron:"",Ecaron:"",ecir:"",ecirc:"",Ecirc:"",ecolon:"",ecy:"",Ecy:"",eDDot:"",edot:"",eDot:"",Edot:"",ee:"",efDot:"",efr:"",Efr:"",eg:"",egrave:"",Egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",emacr:"",Emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",eng:"",ENG:"",ensp:"",eogon:"",Eogon:"",eopf:"",Eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",epsilon:"",Epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",escr:"",Escr:"",esdot:"",esim:"",Esim:"",eta:"",Eta:"",eth:"",ETH:"",euml:"",Euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",exponentiale:"",ExponentialE:"",fallingdotseq:"",fcy:"",Fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",ffr:"",Ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",fopf:"",Fopf:"",forall:"",ForAll:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",fscr:"",Fscr:"",gacute:"",gamma:"",Gamma:"",gammad:"",Gammad:"",gap:"",gbreve:"",Gbreve:"",Gcedil:"",gcirc:"",Gcirc:"",gcy:"",Gcy:"",gdot:"",Gdot:"",ge:"",gE:"",gel:"",gEl:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",gfr:"",Gfr:"",gg:"",Gg:"",ggg:"",gimel:"",gjcy:"",GJcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gne:"",gnE:"",gneq:"",gneqq:"",gnsim:"",gopf:"",Gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",gscr:"",Gscr:"",gsim:"",gsime:"",gsiml:"",gt:">",Gt:"",GT:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",hardcy:"",HARDcy:"",harr:"",hArr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",hcirc:"",Hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",hfr:"",Hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",hopf:"",Hopf:"",horbar:"",HorizontalLine:"",hscr:"",Hscr:"",hslash:"",hstrok:"",Hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",iacute:"",Iacute:"",ic:"",icirc:"",Icirc:"",icy:"",Icy:"",Idot:"",iecy:"",IEcy:"",iexcl:"",iff:"",ifr:"",Ifr:"",igrave:"",Igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",ijlig:"",IJlig:"",Im:"",imacr:"",Imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",int:"",Int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",iocy:"",IOcy:"",iogon:"",Iogon:"",iopf:"",Iopf:"",iota:"",Iota:"",iprod:"",iquest:"",iscr:"",Iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",itilde:"",Itilde:"",iukcy:"",Iukcy:"",iuml:"",Iuml:"",jcirc:"",Jcirc:"",jcy:"",Jcy:"",jfr:"",Jfr:"",jmath:"",jopf:"",Jopf:"",jscr:"",Jscr:"",jsercy:"",Jsercy:"",jukcy:"",Jukcy:"",kappa:"",Kappa:"",kappav:"",kcedil:"",Kcedil:"",kcy:"",Kcy:"",kfr:"",Kfr:"",kgreen:"",khcy:"",KHcy:"",kjcy:"",KJcy:"",kopf:"",Kopf:"",kscr:"",Kscr:"",lAarr:"",lacute:"",Lacute:"",laemptyv:"",lagran:"",lambda:"",Lambda:"",lang:"",Lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",larr:"",lArr:"",Larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",latail:"",lAtail:"",late:"",lates:"",lbarr:"",lBarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",lcaron:"",Lcaron:"",lcedil:"",Lcedil:"",lceil:"",lcub:"{",lcy:"",Lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",le:"",lE:"",LeftAngleBracket:"",leftarrow:"",Leftarrow:"",LeftArrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",leftrightarrow:"",Leftrightarrow:"",LeftRightArrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",leg:"",lEg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",lfr:"",Lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",ljcy:"",LJcy:"",ll:"",Ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",lmidot:"",Lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lne:"",lnE:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",longleftarrow:"",Longleftarrow:"",LongLeftArrow:"",longleftrightarrow:"",Longleftrightarrow:"",LongLeftRightArrow:"",longmapsto:"",longrightarrow:"",Longrightarrow:"",LongRightArrow:"",looparrowleft:"",looparrowright:"",lopar:"",lopf:"",Lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",lscr:"",Lscr:"",lsh:"",Lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",lstrok:"",Lstrok:"",lt:"<",Lt:"",LT:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",map:"",Map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",mcy:"",Mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",mfr:"",Mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",mopf:"",Mopf:"",mp:"",mscr:"",Mscr:"",mstpos:"",mu:"",Mu:"",multimap:"",mumap:"",nabla:"",nacute:"",Nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",ncaron:"",Ncaron:"",ncedil:"",Ncedil:"",ncong:"",ncongdot:"",ncup:"",ncy:"",Ncy:"",ndash:"",ne:"",nearhk:"",nearr:"",neArr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:`
`,nexist:"",nexists:"",nfr:"",Nfr:"",nge:"",ngE:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",ngt:"",nGt:"",ngtr:"",nGtv:"",nharr:"",nhArr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",njcy:"",NJcy:"",nlarr:"",nlArr:"",nldr:"",nle:"",nlE:"",nleftarrow:"",nLeftarrow:"",nleftrightarrow:"",nLeftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nlt:"",nLt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",nopf:"",Nopf:"",not:"",Not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrarr:"",nrArr:"",nrarrc:"",nrarrw:"",nrightarrow:"",nRightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",nscr:"",Nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsube:"",nsubE:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupe:"",nsupE:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",ntilde:"",Ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",nu:"",Nu:"",num:"#",numero:"",numsp:"",nvap:"",nvdash:"",nvDash:"",nVdash:"",nVDash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwarr:"",nwArr:"",nwarrow:"",nwnear:"",oacute:"",Oacute:"",oast:"",ocir:"",ocirc:"",Ocirc:"",ocy:"",Ocy:"",odash:"",odblac:"",Odblac:"",odiv:"",odot:"",odsold:"",oelig:"",OElig:"",ofcir:"",ofr:"",Ofr:"",ogon:"",ograve:"",Ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",omacr:"",Omacr:"",omega:"",Omega:"",omicron:"",Omicron:"",omid:"",ominus:"",oopf:"",Oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",or:"",Or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",oscr:"",Oscr:"",oslash:"",Oslash:"",osol:"",otilde:"",Otilde:"",otimes:"",Otimes:"",otimesas:"",ouml:"",Ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",pcy:"",Pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",pfr:"",Pfr:"",phi:"",Phi:"",phiv:"",phmmat:"",phone:"",pi:"",Pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",popf:"",Popf:"",pound:"",pr:"",Pr:"",prap:"",prcue:"",pre:"",prE:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",prime:"",Prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",pscr:"",Pscr:"",psi:"",Psi:"",puncsp:"",qfr:"",Qfr:"",qint:"",qopf:"",Qopf:"",qprime:"",qscr:"",Qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",quot:'"',QUOT:'"',rAarr:"",race:"",racute:"",Racute:"",radic:"",raemptyv:"",rang:"",Rang:"",rangd:"",range:"",rangle:"",raquo:"",rarr:"",rArr:"",Rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",rarrtl:"",Rarrtl:"",rarrw:"",ratail:"",rAtail:"",ratio:"",rationals:"",rbarr:"",rBarr:"",RBarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",rcaron:"",Rcaron:"",rcedil:"",Rcedil:"",rceil:"",rcub:"}",rcy:"",Rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",reg:"",REG:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",rfr:"",Rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",rho:"",Rho:"",rhov:"",RightAngleBracket:"",rightarrow:"",Rightarrow:"",RightArrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",ropf:"",Ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",rscr:"",Rscr:"",rsh:"",Rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",sacute:"",Sacute:"",sbquo:"",sc:"",Sc:"",scap:"",scaron:"",Scaron:"",sccue:"",sce:"",scE:"",scedil:"",Scedil:"",scirc:"",Scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",scy:"",Scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",searr:"",seArr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",sfr:"",Sfr:"",sfrown:"",sharp:"",shchcy:"",SHCHcy:"",shcy:"",SHcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",sigma:"",Sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",softcy:"",SOFTcy:"",sol:"/",solb:"",solbar:"",sopf:"",Sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",square:"",Square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",sscr:"",Sscr:"",ssetmn:"",ssmile:"",sstarf:"",star:"",Star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",sub:"",Sub:"",subdot:"",sube:"",subE:"",subedot:"",submult:"",subne:"",subnE:"",subplus:"",subrarr:"",subset:"",Subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",sum:"",Sum:"",sung:"",sup:"",Sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supe:"",supE:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supne:"",supnE:"",supplus:"",supset:"",Supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swarr:"",swArr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",tau:"",Tau:"",tbrk:"",tcaron:"",Tcaron:"",tcedil:"",Tcedil:"",tcy:"",Tcy:"",tdot:"",telrec:"",tfr:"",Tfr:"",there4:"",therefore:"",Therefore:"",theta:"",Theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",thorn:"",THORN:"",tilde:"",Tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",topf:"",Topf:"",topfork:"",tosa:"",tprime:"",trade:"",TRADE:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",tscr:"",Tscr:"",tscy:"",TScy:"",tshcy:"",TSHcy:"",tstrok:"",Tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",uacute:"",Uacute:"",uarr:"",uArr:"",Uarr:"",Uarrocir:"",ubrcy:"",Ubrcy:"",ubreve:"",Ubreve:"",ucirc:"",Ucirc:"",ucy:"",Ucy:"",udarr:"",udblac:"",Udblac:"",udhar:"",ufisht:"",ufr:"",Ufr:"",ugrave:"",Ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",umacr:"",Umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",uogon:"",Uogon:"",uopf:"",Uopf:"",uparrow:"",Uparrow:"",UpArrow:"",UpArrowBar:"",UpArrowDownArrow:"",updownarrow:"",Updownarrow:"",UpDownArrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",upsi:"",Upsi:"",upsih:"",upsilon:"",Upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",uring:"",Uring:"",urtri:"",uscr:"",Uscr:"",utdot:"",utilde:"",Utilde:"",utri:"",utrif:"",uuarr:"",uuml:"",Uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",varr:"",vArr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",vBar:"",Vbar:"",vBarv:"",vcy:"",Vcy:"",vdash:"",vDash:"",Vdash:"",VDash:"",Vdashl:"",vee:"",Vee:"",veebar:"",veeeq:"",vellip:"",verbar:"|",Verbar:"",vert:"|",Vert:"",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",vfr:"",Vfr:"",vltri:"",vnsub:"",vnsup:"",vopf:"",Vopf:"",vprop:"",vrtri:"",vscr:"",Vscr:"",vsubne:"",vsubnE:"",vsupne:"",vsupnE:"",Vvdash:"",vzigzag:"",wcirc:"",Wcirc:"",wedbar:"",wedge:"",Wedge:"",wedgeq:"",weierp:"",wfr:"",Wfr:"",wopf:"",Wopf:"",wp:"",wr:"",wreath:"",wscr:"",Wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",xfr:"",Xfr:"",xharr:"",xhArr:"",xi:"",Xi:"",xlarr:"",xlArr:"",xmap:"",xnis:"",xodot:"",xopf:"",Xopf:"",xoplus:"",xotime:"",xrarr:"",xrArr:"",xscr:"",Xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",yacute:"",Yacute:"",yacy:"",YAcy:"",ycirc:"",Ycirc:"",ycy:"",Ycy:"",yen:"",yfr:"",Yfr:"",yicy:"",YIcy:"",yopf:"",Yopf:"",yscr:"",Yscr:"",yucy:"",YUcy:"",yuml:"",Yuml:"",zacute:"",Zacute:"",zcaron:"",Zcaron:"",zcy:"",Zcy:"",zdot:"",Zdot:"",zeetrf:"",ZeroWidthSpace:"",zeta:"",Zeta:"",zfr:"",Zfr:"",zhcy:"",ZHcy:"",zigrarr:"",zopf:"",Zopf:"",zscr:"",Zscr:"",zwj:"",zwnj:""},x={aacute:"",Aacute:"",acirc:"",Acirc:"",acute:"",aelig:"",AElig:"",agrave:"",Agrave:"",amp:"&",AMP:"&",aring:"",Aring:"",atilde:"",Atilde:"",auml:"",Auml:"",brvbar:"",ccedil:"",Ccedil:"",cedil:"",cent:"",copy:"",COPY:"",curren:"",deg:"",divide:"",eacute:"",Eacute:"",ecirc:"",Ecirc:"",egrave:"",Egrave:"",eth:"",ETH:"",euml:"",Euml:"",frac12:"",frac14:"",frac34:"",gt:">",GT:">",iacute:"",Iacute:"",icirc:"",Icirc:"",iexcl:"",igrave:"",Igrave:"",iquest:"",iuml:"",Iuml:"",laquo:"",lt:"<",LT:"<",macr:"",micro:"",middot:"",nbsp:"",not:"",ntilde:"",Ntilde:"",oacute:"",Oacute:"",ocirc:"",Ocirc:"",ograve:"",Ograve:"",ordf:"",ordm:"",oslash:"",Oslash:"",otilde:"",Otilde:"",ouml:"",Ouml:"",para:"",plusmn:"",pound:"",quot:'"',QUOT:'"',raquo:"",reg:"",REG:"",sect:"",shy:"",sup1:"",sup2:"",sup3:"",szlig:"",thorn:"",THORN:"",times:"",uacute:"",Uacute:"",ucirc:"",Ucirc:"",ugrave:"",Ugrave:"",uml:"",uuml:"",Uuml:"",yacute:"",Yacute:"",yen:"",yuml:""},_={0:"",128:"",130:"",131:"",132:"",133:"",134:"",135:"",136:"",137:"",138:"",139:"",140:"",142:"",145:"",146:"",147:"",148:"",149:"",150:"",151:"",152:"",153:"",154:"",155:"",156:"",158:"",159:""},v=[1,2,3,4,5,6,7,8,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,64976,64977,64978,64979,64980,64981,64982,64983,64984,64985,64986,64987,64988,64989,64990,64991,64992,64993,64994,64995,64996,64997,64998,64999,65e3,65001,65002,65003,65004,65005,65006,65007,65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111],C=String.fromCharCode,w={},S=w.hasOwnProperty,E=function(G,j){return S.call(G,j)},T=function(G,j){for(var $=-1,q=G.length;++$<q;)if(G[$]==j)return!0;return!1},k=function(G,j){if(!G)return j;var $={},q;for(q in j)$[q]=E(G,q)?G[q]:j[q];return $},M=function(G,j){var $="";return G>=55296&&G<=57343||G>1114111?(j&&O("character reference outside the permissible Unicode range"),""):E(_,G)?(j&&O("disallowed character reference"),_[G]):(j&&T(v,G)&&O("disallowed character reference"),G>65535&&(G-=65536,$+=C(G>>>10&1023|55296),G=56320|G&1023),$+=C(G),$)},N=function(G){return"&#x"+G.toString(16).toUpperCase()+";"},P=function(G){return"&#"+G+";"},O=function(G){throw Error("Parse error: "+G)},L=function(G,j){j=k(j,L.options);var $=j.strict;$&&g.test(G)&&O("forbidden code point");var q=j.encodeEverything,U=j.useNamedReferences,X=j.allowUnsafeSymbols,J=j.decimal?P:N,ne=function(ae){return J(ae.charCodeAt(0))};return q?(G=G.replace(i,function(ae){return U&&E(d,ae)?"&"+d[ae]+";":ne(ae)}),U&&(G=G.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;").replace(/&#x66;&#x6A;/g,"&fjlig;")),U&&(G=G.replace(u,function(ae){return"&"+d[ae]+";"}))):U?(X||(G=G.replace(m,function(ae){return"&"+d[ae]+";"})),G=G.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;"),G=G.replace(u,function(ae){return"&"+d[ae]+";"})):X||(G=G.replace(m,ne)),G.replace(o,function(ae){var de=ae.charCodeAt(0),oe=ae.charCodeAt(1),le=(de-55296)*1024+oe-56320+65536;return J(le)}).replace(c,ne)};L.options={allowUnsafeSymbols:!1,encodeEverything:!1,strict:!1,useNamedReferences:!1,decimal:!1};var H=function(G,j){j=k(j,H.options);var $=j.strict;return $&&h.test(G)&&O("malformed character reference"),G.replace(y,function(q,U,X,J,ne,ae,de,oe,le){var se,re,he,ie,ue,ce;return U?(ue=U,b[ue]):X?(ue=X,ce=J,ce&&j.isAttributeValue?($&&ce=="="&&O("`&` did not start a character reference"),q):($&&O("named character reference was not terminated by a semicolon"),x[ue]+(ce||""))):ne?(he=ne,re=ae,$&&!re&&O("character reference was not terminated by a semicolon"),se=parseInt(he,10),M(se,$)):de?(ie=de,re=oe,$&&!re&&O("character reference was not terminated by a semicolon"),se=parseInt(ie,16),M(se,$)):($&&O("named character reference was not terminated by a semicolon"),q)})};H.options={isAttributeValue:!1,strict:!1};var R=function(G){return G.replace(m,function(j){return p[j]})},I={version:"1.2.0",encode:L,decode:H,escape:R,unescape:H};if(r&&!r.nodeType)if(s)s.exports=I;else for(var F in I)E(I,F)&&(r[F]=I[F]);else n.he=I})(b1e)})(Dd,Dd.exports)),Dd.exports}var v1e=_1e();const cT=ha(v1e),C1e=e=>{const t=e.match(/^(.+?)\s*<(.+)>$/);return t?t[1]?.trim().replace(/^["']|["']$/g,"")||t[2]?.trim()||"":e.trim().replace(/^["']|["']$/g,"")},w1e=e=>e==="GCAL"?{src:uM,alt:"Gmail"}:e==="OUTLOOK"?{src:uhe,alt:"Outlook"}:{src:uM,alt:"Gmail"},S1e=e=>{const t=Date.now(),n=new Date(e),r=t-n.getTime();if(r<0)return"";const s=1e3*60,a=s*60,o=a*24,i=o*7,c=o*30,u=o*365;return r<s?"1m":r<a?`${Math.floor(r/s)}m`:r<o?`${Math.floor(r/a)}h`:r<i?`${Math.floor(r/o)}d`:r<c?`${Math.floor(r/i)}w`:r<u?`${Math.floor(r/c)}mo`:`${Math.floor(r/u)}y`},E1e=A.memo(function({result:t,textClassName:n,icon:r}){const s=w1e(t.connection_type),a=r?l.jsx(_n,{icon:r,size:"tiny"}):l.jsx("img",{src:s.src,alt:s.alt,className:"size-[16px]"}),o=t.date?S1e(t.date):null;return l.jsxs("div",{className:"hover:bg-subtler dark:hover:bg-subtle relative flex min-w-0 cursor-pointer gap-3 rounded-lg px-2 py-1.5",children:[l.jsx("span",{className:"mt-two shrink-0",children:a}),l.jsxs("div",{className:"gap-two flex min-w-0 flex-1 flex-col",children:[l.jsx("div",{className:"flex min-w-0 items-center justify-between gap-2",children:t.sender&&l.jsx(B,{variant:"smallBold",className:"shrink-0",as:"span",children:C1e(t.sender)})}),l.jsx("div",{className:"flex min-w-0 items-center gap-2",children:t.subject&&l.jsx(B,{className:z("min-w-0 shrink text-ellipsis font-medium",n),variant:"small",as:"span",children:cT.decode(t.subject)})}),l.jsxs("div",{className:"flex min-w-0 items-center gap-2",children:[t.snippet&&l.jsx(B,{variant:"tinyMono",className:"min-w-0 shrink truncate",color:"light",as:"span",children:cT.decode(t.snippet)}),o&&l.jsx(B,{variant:"tinyMono",className:"shrink-0 text-right",color:"light",as:"span",children:o})]})]})]})}),k1e=A.memo(function({result:t,textClassName:n,icon:r}){const s=l.jsx(_n,{icon:r||D("user"),size:"tiny"}),a=("display_name"in t?t.display_name:void 0)||("name"in t?t.name:void 0)||"",o=("email_address"in t?t.email_address:void 0)||("url"in t?t.url:void 0)||"";return l.jsxs("div",{className:"hover:bg-subtler dark:hover:bg-subtle relative flex min-w-0 cursor-pointer items-center gap-3 rounded-lg px-2 py-1.5",children:[l.jsx("span",{className:"shrink-0",children:s}),l.jsxs("span",{className:"gap-xs flex min-w-0 items-center",children:[a&&l.jsx(B,{className:z("min-w-0 shrink text-ellipsis",n),variant:"small",as:"span",children:a||(o?o.split("@")[0]:"")}),o&&l.jsx(B,{variant:"tinyMono",className:"mt-px min-w-0 shrink truncate",color:"light",as:"span",children:o})]})]})}),M1e=A.memo(function({result:t,textClassName:n,icon:r}){const s=b0(t.url),a=em(t),o=a?.type==="patents",i=MI(t,s),c=r?l.jsx(_n,{icon:r,size:"tiny"}):l.jsx(gl.Icon,{url:t.url,isAttachment:t.is_attachment||!1,connectionType:s,isMemory:t.is_memory||!1,isConversationHistory:t.is_conversation_history||!1,isClientContext:t.is_client_context||!1,isInlineAttachment:!1,isPatent:o}),u=t.url?l.jsx(gl.Source,{url:t.url,source:i,isAttachment:t.is_attachment||!1,connectionType:s,isMemory:t.is_memory||!1,isConversationHistory:t.is_conversation_history||!1,snippet:t.snippet,isPatent:o}):null,d=t.is_memory?t.snippet:t.name;return l.jsxs("div",{className:"hover:bg-subtler relative flex min-w-0 cursor-pointer items-start gap-3 rounded-lg px-2 py-1.5",children:[l.jsx(B,{variant:"small",className:"mt-two shrink-0",children:c}),l.jsxs("div",{className:"gap-sm flex min-w-0 flex-1 items-start",children:[l.jsxs("div",{className:"flex min-w-0 flex-1 flex-col",children:[d&&l.jsx(B,{className:z("min-w-0 shrink truncate break-words",n),variant:"small",as:"span",children:d}),t.is_conversation_history&&l.jsx(B,{variant:"tinyRegular",color:"light",lineClamp:1,className:"pt-two",children:t.snippet})]}),!t.is_conversation_history&&l.jsx(B,{variant:"tinyRegular",className:z("overflow-wrap-anywhere mt-px break-words text-right",{lowercase:!a}),color:"light",as:"span",children:u})]})]})}),T1e=e=>{if(!e)return;const t=e.split("/").filter(Boolean);return t.length>0?t[t.length-1]:void 0},AF=e=>{const t=e.is_memory?"memory":"conversation_history",n=e.is_memory?e.url:void 0,r=e.is_conversation_history?T1e(e.url):void 0;return{snippet:e.snippet??"",url:e.url??"",title:e.name??"",type:t,memoryKey:n,entryUuid:r,timestamp:e.timestamp??""}},A1e=Pe(async()=>{const{MemorySearchHistoryModal:e}=await W(async()=>{const{MemorySearchHistoryModal:t}=await import("./MemorySearchHistoryModal-WAvgBTO8.js");return{MemorySearchHistoryModal:t}},__vite__mapDeps([399,3,2,5,1,6,7,8,9,13,12,14,15,16,17]));return{default:e}}),LE=()=>{const{openModal:e}=Kt(),{session:t}=je(),{trackEvent:n}=Ze(t);return f.useCallback(s=>{if(jE(s))return;const a=AF(s);e(A1e,{...a});const o=a.type,i=a.memoryKey,c=a.entryUuid;n("viewed memory search history modal",{type:o,...o==="memory"&&{memory_key:i},...o==="conversation_history"&&{entry_uuid:c}})},[e,n])},N1e=e=>{if(e&&e.includes("fallback"))return"FAMILY SUBSTITUTE DOCUMENT"},R1e=({reason:e,entryUUID:t,openFile:n,onSuccess:r})=>{const{openToast:s}=cn(),a=Q();return{openPatentInViewer:f.useCallback(async({name:i,url:c,fileSource:u,sourceLabel:d})=>{try{n({name:i,url:null,fileSource:u,entryUUID:t});const m=await BR({request:{file_url:c,view_mode:!0},reason:e}),{file_url:p,source:h}=m;r?.({entryUUID:t,fileName:i});const g=d??N1e(h);n({name:i,url:p,fileSource:u,entryUUID:t,source:g})}catch{n({name:i,url:null,fileSource:u,entryUUID:t}),s({message:a.formatMessage({defaultMessage:"The PDF for this patent is not available in our system and cannot be displayed.",id:"fG2vpLG+ct"}),variant:"error",timeout:3})}},[e,t,n,r,s,a])}},D1e=({heading:e,groupIndex:t})=>l.jsxs(l.Fragment,{children:[t>0&&l.jsx("div",{className:"border-subtlest border-b"}),l.jsx(Y,{variant:"raised",className:"-mx-xs pl-sm pb-sm sticky top-0 z-30 flex items-center gap-3 pt-3",children:l.jsx(B,{variant:"tinyRegular",children:e})})]}),Bi=A.memo(function({onClick:t,stepDelay:n,isFinished:r,results:s,textClassName:a,groupBy:o,icon:i,resultType:c="web",maxHeight:u=250}){const d=Xt(),m=LE(),{openFile:p}=f.useContext(Tw),{openPatentInViewer:h}=R1e({reason:"patent-search-result",openFile:p}),g=f.useCallback(x=>{(x.is_memory||x.is_conversation_history)&&m(x)},[m]),y=f.useCallback(x=>_=>{if("is_conversation_history"in x){if(x.is_conversation_history||x.is_memory){_.preventDefault(),g(x);return}if(x.is_attachment||x.is_memory)return _.preventDefault();if(Io(x)){_.preventDefault(),h({url:x.url,name:x.name});return}Mw(_)&&(_.preventDefault(),d.openTab({url:x.url,tabId:x.tab_id}).catch(()=>{window.open(x.url,"_blank")}))}if(c==="email"||c==="calendar"){if(t){_.preventDefault();const C="url"in x?x.url:"";t(C||"")}return}const v="url"in x?x.url:"";t?.(v||"")},[d,t,c,g,h]);if(!s||s.length===0)return null;let b=[];if(o){const x=s,_=new Map;x.forEach(w=>{const S=w.category;_.has(S)||_.set(S,[]),_.get(S).push(w)});const v={open_tab:{heading:"Opened tabs",icon:l.jsx(ye,{icon:D("browser-plus")})},closed_tab:{heading:"Recently closed tabs",icon:l.jsx(ye,{icon:D("browser-minus")})},history:{heading:"Browser history",icon:l.jsx(ye,{icon:D("history")})}},C=_.size>1;b=Array.from(_.entries()).map(([w,S])=>{const E=v[w];return{heading:C?E?.heading||w:void 0,icon:C?E?.icon:void 0,results:S}})}else s.length>0&&s[0]&&"results"in s[0]?b=s.map(v=>({heading:v.heading,results:v.results})):b=[{results:[...s]}];return l.jsx(mm,{children:l.jsx(dm,{maxHeight:u,autoScroll:!1,topGradientOffset:b.length>1?36:0,scrollContainerClassName:b.length===1?"pt-sm":void 0,children:l.jsx("div",{className:"flex flex-col gap-px",children:b.map((x,_)=>{const v=x.results.map((C,w)=>{const S="url"in C?C.url:"",E=()=>{const T={result:C,textClassName:typeof a=="function"?a(C):a,icon:i};switch(c){case"web":return l.jsx(M1e,{...T});case"userinfo":return l.jsx(k1e,{...T});case"email":return l.jsx(E1e,{...T});case"calendar":return l.jsx(x1e,{...T});default:return null}};return l.jsx(Dt,{className:"-ml-xs block",href:S||"#",target:"_blank",rel:"noopener nofollow",onClick:y(C),children:E()},`${_}-${S||w}-${w}`)});return l.jsxs("div",{className:"mb-sm last:mb-0",children:[x.heading&&b.length>1&&l.jsx(D1e,{heading:x.heading,groupIndex:_}),l.jsx(hy,{items:v,stepDelay:n,isFinished:r,vertical:!0,truncate:!1})]},_)})})})})}),ld=A.memo(function({result:t,onClick:n,visualStyle:r,showName:s,className:a}){const o=Xt(),i=b0(t.url),c=MI(t,i),u=Io(t),d=LE(),m=f.useCallback(()=>{(t.is_memory||t.is_conversation_history)&&d(t)},[d,t]),p=f.useCallback(h=>{if(t.is_conversation_history||t.is_memory){h.preventDefault(),m();return}if(t.is_attachment||t.is_memory)return h.preventDefault();Mw(h)&&(h.preventDefault(),o.openTab({url:t.url,tabId:t.tab_id}).catch(()=>{window.open(t.url,"_blank")})),n?.(t.url)},[o,n,t.is_attachment,t.is_memory,t.tab_id,t.url,m,t.is_conversation_history]);return l.jsx(Dt,{className:z("inline-block max-w-full",a),href:t.url,target:"_blank",rel:"noopener nofollow",onClick:p,children:l.jsx(Y,{variant:"subtler",bgHover:"subtle",className:"py-xs rounded-lg pl-1.5 pr-2.5",children:l.jsx(gl,{variant:"tinyRegular",className:r==="closedTab"?"!line-through":void 0,url:t.url,name:s?t.name:void 0,isAttachment:t.is_attachment,connectionType:i,source:c,isMemory:t.is_memory,isConversationHistory:t.is_conversation_history,isPatent:u})})})}),I1e=A.memo(function({step:t,action:n}){const{final:r,file_name:s,sheet_count:a,row_count:o}=t.content,i=!r;let c=n;return s&&r&&(c=s,a!=null?(c+=` (${a} sheets`,o!=null&&(c+=`, ${o} rows`),c+=")"):o!=null&&(c+=` (${o} rows)`)),l.jsx(st,{text:n,icon:D("file-spreadsheet"),isLoading:i,size:"tiny",pill:!0,toolTip:c,tooltipLayout:"top"})}),j1e=async(e,t,n)=>{try{const{data:r,error:s,response:a}=await ve.POST("/rest/sse/handle_perplexity_research_clarifying_answers","research-clarifying-questions",{body:{result:{tool_uuid:t,answers:e,submit_type:n}}});if(s){Z.log("Error submitting research clarifying questions:",s);return}return{data:r,error:s,response:a}}catch(r){Z.log(r);return}},P1e=()=>on({mutationFn:({answers:e,toolUuid:t,submitType:n})=>j1e(e,t,n)}),O1e=60,uT=100,L1e=A.memo(function({questions:t,toolUuid:n,autoSkipSeconds:r=O1e,isFinished:s=!1,entryUuid:a,title:o}){const{isMobileStyle:i}=Be(),c=f.useRef(null),[u,d]=f.useState(0),[m,p]=f.useState(!1),[h,g]=f.useState(!1),y=f.useRef(!1),b=f.useRef(new Map),{session:x}=je(),{trackEvent:_,trackEventOnce:v}=Ze(x),[C,w]=f.useState(new Map),{mutate:S,isPending:E}=P1e(),T=r*1e3;f.useEffect(()=>{t.forEach(R=>{R.question_text&&v("clarifying question input viewed",{entry_uuid:a,clarifying_question:R.question_text})})},[t,a,v]);const k=f.useCallback(()=>t.map(R=>({question:R.question_text,answer:C.get(R.question_text??"")??""})),[t,C]),M=f.useCallback(R=>{if(y.current)return;y.current=!0,k().forEach(F=>{F.answer&&_("clarifying question answer submitted",{entry_uuid:a,answer:F.answer})}),R==="USER_SUBMITTED"?p(!0):g(!0),c.current&&clearInterval(c.current),S({answers:k(),toolUuid:n,submitType:R})},[n,k,S,a,_]),N=f.useCallback(()=>{const R=Array.from(C.values()).some(I=>I.trim()!=="");M(R?"USER_SUBMITTED":"TIMEOUT")},[M,C]),P=f.useCallback((R,I)=>{w(F=>{const G=new Map(F);return G.set(R,I),G}),d(-1),c.current&&clearInterval(c.current)},[]),O=f.useCallback((R,I)=>{I?b.current.set(R,I):b.current.delete(R)},[]),L=f.useCallback(R=>{const I=t.findIndex(G=>G.question_text===R);if(I===t.length-1)N();else{const j=t[I+1]?.question_text;j&&b.current.get(j)?.focus()}},[t,N]);f.useEffect(()=>{u>=T&&!y.current&&M("TIMEOUT")},[u,T,M]);const H=E||m||h||s;return t.length===0?null:m?l.jsx(F1e,{answers:C}):h||s?null:l.jsxs(Y,{variant:"transparent",className:"rounded-xl p-md flex flex-col gap-y-sm relative border",children:[o&&l.jsx(B,{variant:"small",color:"light",children:o}),l.jsx("div",{className:"flex flex-col divide-y",children:t.map((R,I)=>l.jsx(B1e,{ref:F=>O(R.question_text??"",F),questionText:R.question_text??"",options:R.options??[],isDisabled:H,onAnswerChange:P,onEnterPressed:L,autoFocus:I===0&&!i,isMobileStyle:i,showPlaceholder:I===0},R.question_text))}),l.jsx("div",{className:"flex justify-end",children:E?l.jsx("div",{className:"inline-flex text-quieter h-8 items-center",children:l.jsx(To,{})}):l.jsx(U1e,{isSubmitting:H,onClick:N,skipProgress:u,setSkipProgress:d,skipDurationMs:T,interval:c})})]})}),F1e=A.memo(function({answers:t}){const{$t:n}=Q(),r=Array.from(t.entries()).filter(([,s])=>s.trim()!=="");return l.jsxs(Y,{variant:"transparent",className:"rounded-xl p-md flex flex-col gap-y-sm relative border",children:[l.jsxs(B,{variant:"small",color:"light",className:"flex items-center gap-xs",children:[l.jsx(ye,{icon:D("circle-check"),size:"sm"}),r.length<=1?n({defaultMessage:"Answer submitted",id:"nhijhP95Wa"}):n({defaultMessage:"Answers submitted",id:"slMbotVCdl"})]}),r.length>0&&l.jsx("div",{className:"flex flex-col gap-y-xs",children:r.map(([s,a])=>l.jsxs("div",{className:"flex flex-col",children:[l.jsx(B,{variant:"small",color:"light",children:s}),l.jsx(B,{variant:"small",children:a})]},s))})]})}),U1e=A.memo(function({isSubmitting:t,onClick:n,skipProgress:r,setSkipProgress:s,skipDurationMs:a,interval:o}){f.useEffect(()=>(o.current=setInterval(()=>{s(d=>Math.min(d+100,a))},100),()=>{o.current&&clearInterval(o.current)}),[o,s,a]);const{$t:i}=Q(),c=f.useMemo(()=>{const d=Math.ceil((a-r)/1e3);return t?i({defaultMessage:"Working...",id:"H6RqOb/hea"}):r<0?i({defaultMessage:"Continue",id:"acrOozm08x"}):i({defaultMessage:"Continue ({seconds})",id:"q9N0Gjq72e"},{seconds:d})},[r,t,a,i]),u=f.useMemo(()=>({width:`${r/a*100}%`}),[r,a]);return l.jsxs("div",{className:"relative",children:[l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"pointer-events-none relative opacity-0",children:l.jsx(at,{variant:"text",size:"small",onClick:n,disabled:t,children:r<0?i({defaultMessage:"Continue",id:"acrOozm08x"}):i({defaultMessage:"Continue (99)",id:"JLwyORtPZa"})})}),l.jsx("div",{className:"absolute inset-0",children:l.jsx(at,{variant:r<0?"primary":"text",size:"small",onClick:n,disabled:t,fullWidth:!0,children:c})})]}),l.jsxs("div",{className:z("grid grid-cols-1 grid-rows-1 rounded-lg overflow-hidden absolute inset-0 duration-normal pointer-events-none",t||r<0?"opacity-0":""),children:[l.jsx(Y,{className:"bg-subtle col-start-1 row-start-1 h-full",variant:"transparent"}),l.jsx(Y,{className:"opacity-5 col-start-1 row-start-1 h-full w-1/2 rounded-inherit duration-linear duration-100",variant:"textColor",style:u})]})]})}),h1=A.memo(function({text:t,isSelected:n,isDisabled:r,onClick:s,ref:a}){const o=f.useCallback(()=>{s(t)},[t,s]);return l.jsx("div",{className:z(n?"[&_button]:bg-inverse":"","inline-flex"),children:l.jsx(at,{ref:a,variant:n?"primary":"tonal",size:"tiny",disabled:r,onClick:o,children:t})})}),B1e=A.memo(function({questionText:t,options:n,isDisabled:r,onAnswerChange:s,onEnterPressed:a,autoFocus:o=!1,isMobileStyle:i=!1,showPlaceholder:c=!1,ref:u}){const[d,m]=f.useState(null),[p,h]=f.useState(!1),[g,y]=f.useState(""),{$t:b}=Q(),x=f.useRef(null),_=f.useRef(null);f.useImperativeHandle(u,()=>({focus:()=>{i?p?_.current?.focus():x.current?.focus():_.current?.focus()}}),[i,p]),f.useEffect(()=>{if(o){const k=setTimeout(()=>{i?x.current?.focus():_.current?.focus()},uT);return()=>clearTimeout(k)}},[o,i]);const v=f.useCallback(k=>{m(k),i?(h(!1),s(t,k)):(y(k),s(t,k))},[t,s,i]),C=f.useCallback(k=>{y(k),s(t,k)},[t,s]),w=f.useCallback(()=>{h(!1),y(""),s(t,"")},[t,s]),S=f.useCallback(()=>{h(!0),m(null),s(t,""),setTimeout(()=>{_.current?.focus()},uT)},[t,s]),E=f.useCallback(k=>{k.key==="Enter"&&!k.shiftKey&&(k.preventDefault(),a(t))},[t,a]),T=f.useCallback(k=>{k.key==="Enter"&&!k.shiftKey&&(k.preventDefault(),a(t))},[t,a]);return l.jsxs("div",{className:"flex flex-col gap-y-sm py-md first:pt-0 last:pb-0",onKeyDown:E,children:[l.jsx(B,{variant:"small",children:t}),!i&&l.jsxs(l.Fragment,{children:[l.jsx(xs,{ref:_,value:g,onChange:C,placeholder:c?b({defaultMessage:"Type your answer...",id:"eUQOmDCyHw"}):void 0,isMobileUserAgent:i,size:"sm",wrapperClassName:"w-full",className:"h-8",disabled:r,onKeyDown:T}),l.jsx("div",{className:"gap-sm flex flex-row flex-wrap",children:n.map(k=>l.jsx(h1,{text:k,isSelected:g===k,isDisabled:r,onClick:v},k))})]}),i&&l.jsx(l.Fragment,{children:p?l.jsxs("div",{className:"gap-x-sm flex flex-row items-center",children:[l.jsx(xs,{ref:_,value:g,onChange:C,placeholder:c?b({defaultMessage:"Type your answer...",id:"eUQOmDCyHw"}):void 0,isMobileUserAgent:i,size:"sm",wrapperClassName:"w-full",className:"h-8",disabled:r,onKeyDown:T}),l.jsx(at,{size:"small",onClick:w,icon:D("x"),"aria-label":b({defaultMessage:"Back",id:"cyR7KhiuaU"}),variant:"text",disabled:r})]}):l.jsxs("div",{className:"gap-sm flex flex-row flex-wrap",children:[n.map((k,M)=>l.jsx(h1,{ref:M===0?x:void 0,text:k,isSelected:d===k,isDisabled:r,onClick:v},k)),l.jsx(h1,{text:b({defaultMessage:"Other",id:"/VnDMl81rh"}),isSelected:!1,isDisabled:r,onClick:S})]})})]})}),H1e=A.memo(function({disabled:t,onClick:n}){return l.jsx(st,{disabled:t,onClick:n,icon:D("chevron-left"),variant:"common",size:"small"})}),V1e=A.memo(function({disabled:t,onClick:n}){return l.jsx(st,{disabled:t,onClick:n,icon:D("chevron-right"),variant:"common",size:"small"})}),G1e={tiny:"tiny",small:"tiny",default:"tiny",large:"small"},z1e={tiny:"text-xs",small:"text-sm",default:"text-sm",large:"text-base"},q1e=e=>{const t=Zg(e);return z(t,"justify-between")},$1e=()=>"ml-1 shrink-0 text-quiet";function Du({ref:e,children:t,"aria-expanded":n,"aria-haspopup":r="listbox","aria-controls":s,size:a="default",disabled:o=!1,onClick:i,leadingAccessory:c,...u}){const d=vN(e),m=Tl(u),p=G1e[a],h=z1e[a],g=f.useMemo(()=>z("font-normal",h,"text-box-trim-both","truncate",{"pl-1":c,"pr-1":!0,"min-w-0":!0}),[c,h]);return l.jsxs(Ls,{ref:d,...m,disabled:o,className:q1e({variant:"tonal",size:a,disabled:o,fullWidth:!0}),onClick:i,"aria-expanded":n,"aria-haspopup":r,"aria-controls":s,children:[l.jsxs("div",{className:"flex min-w-0 flex-1 items-center",children:[c&&l.jsx("div",{className:"mr-1 shrink-0",children:kW(c)?l.jsx(_n,{icon:c,size:a}):c}),l.jsx("span",{className:g,children:t})]}),l.jsx("div",{className:$1e(),children:l.jsx(_n,{icon:D("chevron-down"),size:p})})]})}const NF=f.memo(function({selectedAccount:t,availableAccounts:n,onAccountChange:r,disabled:s}){const{$t:a}=Q(),[o,i]=f.useState(!1),c=(n?.length??0)>1,u=t?.email_address||"",d=t?.display_name,m=f.useCallback(p=>{s||i(p)},[s]);return c?l.jsxs("div",{className:"border-subtlest px-md flex min-h-10 items-center gap-2 border-b py-2",children:[l.jsx("span",{className:"text-quiet text-sm",children:a({defaultMessage:"From",id:"dM+p3/YEXT"})}),l.jsx(Qe,{isOpen:o,onToggle:m,triggerElement:l.jsx(Du,{size:"default",disabled:s,children:d||u}),children:(n??[]).map(p=>{const h=p.connection_id===t?.connection_id,g=p.display_name||p.email_address||"";return l.jsxs(Qe.Item,{onSelect:()=>r(p.connection_id||""),trailingAccessory:h?l.jsx(_n,{icon:D("check"),size:"default"}):void 0,children:[g,p.display_name&&p.email_address&&l.jsxs("span",{className:"text-quiet ml-2 text-sm",children:["(",p.email_address,")"]})]},p.connection_id)})})]}):l.jsxs("div",{className:"border-subtlest px-md flex min-h-10 items-center gap-2 border-b py-2",children:[l.jsx("span",{className:"text-quiet text-sm",children:a({defaultMessage:"From",id:"dM+p3/YEXT"})}),l.jsx("span",{className:"text-foreground text-sm",children:d||u}),d&&l.jsxs("span",{className:"text-quiet text-sm",children:["(",u,")"]})]})});function W1e(){const{value:e}=zC({flag:"show-editable-calendar-components",defaultValue:!1});return e}const RF=({contact:e})=>l.jsxs("div",{className:"flex items-center gap-2",children:[e.image&&l.jsx("img",{src:e.image,alt:e.name,className:"size-4 rounded-full",referrerPolicy:"no-referrer"}),l.jsx("span",{className:"text-sm",children:e.name}),e.email&&l.jsx("span",{className:"text-quieter text-sm",children:e.email})]}),K1e=async({query:e,limit:t=10,reason:n})=>{try{const{data:r,error:s,response:a}=await ve.GET("/rest/autosuggest/contacts/list-autosuggest",n,{timeoutMs:Ct(),params:{query:{query:e,limit:t}}});if(s)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to get contacts autosuggestions",cause:s,status:a.status??0});return r?.results??[]}catch(r){return Z.error(r),[]}},Y1e=({query:e,limit:t=10,reason:n})=>gt({queryKey:Se.makeEphemeralQueryKey("/rest/autosuggest/contacts/list-autosuggest",e,t),queryFn:()=>K1e({query:e,limit:t,reason:n}),enabled:e?.trim().length>0,staleTime:120*1e3,gcTime:600*1e3,placeholderData:Ja});function DF({reason:e,limit:t=10}){const[n,r]=f.useState(""),{data:s}=Y1e({query:n,limit:t,reason:e}),a=f.useMemo(()=>Wg(c=>r(c),300),[]);f.useEffect(()=>()=>{a.cancel()},[a]);const o=f.useCallback(c=>{c.trim()===""?(a.cancel(),r("")):a(c)},[a]);return{suggestions:f.useMemo(()=>s?.filter(c=>c.email!==null).map(c=>({key:c.email,value:c.email,item:c})),[s]),handleDraftChange:o}}const Xn=A.memo(function({children:t,header:n,fullBleed:r,roundedClass:s,shadow:a,fullBleedBorderClassname:o,...i}){return l.jsxs(l.Fragment,{children:[n,l.jsxs(Y,{...i,variant:i.variant??"raised",className:z("relative",{border:!r&&!i.variant,[s||"rounded-xl"]:!i.variant,"shadow-[0_1px_2px_0_rgba(0,0,0,0.03)]":a},i.className),children:[r&&l.jsx("div",{className:z("rounded-inherit pointer-events-none absolute inset-0 z-[1] border border-[black]/5 dark:border-[white]/5",o)}),t]})]})});var na;(function(e){e.GOOGLE_MEET="google_meet",e.MICROSOFT_TEAMS="microsoft_teams",e.ZOOM="zoom"})(na||(na={}));const Q1e=e=>{if(!e)return!1;const t=e.indexOf("@"),n=e.lastIndexOf(".");return e.includes("@")&&e.includes(".")&&t<n&&t>0},yl=A.memo(function({oldText:t,newText:n,isDeletion:r=!1}){return!t&&!n?null:r&&(t||n)?l.jsx(B,{as:"span",color:"ultraLight",className:"line-through",children:t||n}):!t&&n?l.jsx(B,{as:"span",color:"default",className:"bg-attention/10",children:n}):!n&&t?t:t&&n&&t===n?l.jsx(B,{as:"span",color:"default",children:t}):t&&n&&t!==n?l.jsxs(l.Fragment,{children:[l.jsx(B,{as:"span",color:"ultraLight",className:"line-through",children:t}),"",l.jsx(B,{as:"span",color:"default",className:"bg-attention/10",children:n})]}):null}),ra=A.memo(function({children:t,icon:n,alignCenter:r=!1,iconSize:s="sm"}){return l.jsxs("div",{className:z("flex flex-row items-start gap-3",{"items-center":r}),children:[l.jsx(ye,{icon:n,size:s,className:"mt-px shrink-0"}),l.jsx("div",{className:"min-w-0 flex-1",children:t})]})}),X1e=A.memo(function({attendee:t,showRsvp:n=!1}){return l.jsxs("div",{className:"relative w-5",children:[t.photo_url?l.jsx(Xn,{fullBleed:!0,className:"absolute inset-0 mt-px size-5 overflow-hidden !rounded-full",children:l.jsx("img",{src:t.photo_url,className:"size-full object-cover",alt:t.display_name||t.email||""})}):l.jsx(Y,{variant:"subtle",className:"absolute inset-0 mt-px flex size-5 items-center justify-center rounded-full",children:l.jsx(B,{variant:"tinyMono",color:"light",className:"translate-y-half",children:g1e(t.display_name||t.email||"")})}),n&&(t.response_status==="accepted"||t.response_status==="declined")&&l.jsx(Y,{variant:"background",className:"p-two absolute bottom-[-4px] right-[-4px] z-10 rounded-full",children:l.jsx(B,{color:t.response_status==="accepted"?"super":t.response_status==="declined"?"red":"light",className:z("bg-base border-subtlest flex size-3 items-center justify-center rounded-full border",{"!bg-super/20 !border-super/10 border":t.response_status==="accepted","!bg-negative/20 !border-negative/10":t.response_status==="declined"}),children:l.jsx(ye,{icon:t.response_status==="accepted"?D("check"):t.response_status==="declined"?D("x"):D("question-mark"),size:"2xs",stroke:2.125})})})]})}),Z1e=A.memo(function({attendees:t,newAttendees:n,truncateAttendees:r,showRsvp:s=!1,isDeletion:a=!1}){const[o,i]=f.useState(!1),u=iT(t).filter(y=>!y.email?.includes("@resource.calendar.google"));let d;n&&(d=iT(n).filter(b=>!b.email?.includes("@resource.calendar.google")));const m=(y,b)=>{const x=y?.map(_=>{let v;return b?v=b?.find(C=>C.email===_.email)??{email:" ",response_status:void 0,photo_url:void 0,display_name:" "}:v=_,{oldValue:_,newValue:v}})??[];return b&&(y?b.filter(v=>!y.some(C=>C.email===v.email)):b).forEach(v=>{x.push({oldValue:void 0,newValue:v})}),x},p=d||u,h=m(u,d),g=f.useCallback(()=>i(!o),[o]);return l.jsxs("div",{className:"min-w-0",children:[(()=>{const y=p?.length??0;return l.jsx(B,{variant:"small",color:y>0?"default":"light",className:a?"line-through":"",children:y>0?`${y} ${y===1?"Guest":"Guests"}`:"No Guests"})})(),h&&h.length>0&&l.jsxs("div",{className:"gap-sm my-sm flex flex-col",children:[h.slice(0,r&&!o?r:void 0).map(y=>l.jsxs("div",{className:"gap-sm flex flex-row",children:[l.jsx(X1e,{attendee:y.newValue,showRsvp:s}),l.jsx(B,{variant:"small",color:"default",lineClamp:1,className:"text-ellipsis break-all",children:l.jsx(yl,{oldText:y.oldValue?.display_name||y.oldValue?.email,newText:y.newValue?.display_name||y.newValue?.email,isDeletion:a})})]},y.oldValue?.email??y.newValue?.email)),r&&h.length>r&&l.jsx(B,{as:"button",variant:"small",color:"default",className:"w-fit text-left hover:underline",onClick:g,children:o?"Show less":"Show all"})]})]})}),J1e=A.memo(function({videoEntryPoint:t,isDeletion:n}){const{$t:r}=Q(),s=f.useCallback(()=>window.open(t?.uri,"_blank","noopener,noreferrer"),[t?.uri]);return!t||n?null:l.jsx(ra,{icon:D("video"),alignCenter:!0,children:l.jsx(st,{variant:"primary",pill:!0,text:r({defaultMessage:"Join Meeting",id:"HK25u5mIfw"}),onClick:s,size:"small"})})}),ebe=A.memo(function({location:t,newLocation:n,isDeletion:r=!1}){return t?l.jsx(ra,{icon:D("map-pin"),children:l.jsx(B,{lineClamp:1,variant:"small",color:"light",children:l.jsx(yl,{oldText:t,newText:n,isDeletion:r})})}):null}),tbe=A.memo(function({description:t,newDescription:n,isDeletion:r=!1}){const[s,a]=f.useState(!1),o=f.useCallback(()=>a(!s),[s]);return t?l.jsx(ra,{icon:D("align-left"),children:l.jsxs("div",{className:"flex flex-col",children:[l.jsx(B,{variant:"small",className:z("break-words",{"line-clamp-2":!s}),children:l.jsx(yl,{oldText:t,newText:n,isDeletion:r})}),t.length>150&&l.jsx(B,{as:"button",variant:"small",color:"default",className:"mt-1 w-fit text-left hover:underline",onClick:o,children:s?"Show less":"Show more"})]})}):null}),nbe=A.memo(function({startDate:t,endDate:n,newStartDateObj:r,newEndDateObj:s,newEvent:a,is_all_day:o,formatEventDayShort:i,isDeletion:c=!1}){const u=Q(),d=a&&r?r:t,m=a&&s?s:n,p=a?a.is_all_day||!1:o;return l.jsxs("div",{className:"gap-two flex flex-col",children:[l.jsx(B,{lineClamp:1,variant:"smallBold",color:"default",children:l.jsx(yl,{oldText:i(t),newText:a&&r?i(r):void 0,isDeletion:c})}),l.jsx(B,{variant:"small",color:"light",children:l.jsxs("span",{className:c?"line-through":"",children:[l.jsx(Sh,{startDate:d,endDate:m,isAllDay:p}),!p&&` (${TF(d,u)})`]})})]})}),rbe=A.memo(function({startDate:t,endDate:n,newStartDateObj:r,newEndDateObj:s,newEvent:a,formatEventDayShort:o,isDeletion:i=!1}){const c=Q(),u=a&&s?s:n,d=a&&a.is_all_day||!1;return l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"gap-two flex flex-col",children:[l.jsx(B,{lineClamp:1,variant:"smallBold",color:"default",children:l.jsx(yl,{oldText:o(t),newText:a&&r?o(r):void 0,isDeletion:i})}),l.jsx(B,{variant:"small",color:"light",children:l.jsx("span",{className:i?"line-through":"",children:!a?.is_all_day&&l.jsx(rk,{value:a&&r?r:t,hour:"numeric",minute:"2-digit"})})})]}),l.jsx(B,{color:"light",className:"pt-two flex justify-center",children:l.jsx(ye,{icon:D("arrow-right"),size:"sm"})}),l.jsxs("div",{className:"gap-two flex flex-col",children:[l.jsx(B,{lineClamp:1,variant:"smallBold",color:"default",children:l.jsx(yl,{oldText:o(n),newText:a&&s?o(s):void 0,isDeletion:i})}),l.jsx(B,{variant:"small",color:"light",children:l.jsx("span",{className:i?"line-through":"",children:!d&&l.jsxs(l.Fragment,{children:[l.jsx(rk,{value:u,hour:"numeric",minute:"2-digit"}),` (${TF(u,c)})`]})})})]})]})}),sbe=A.memo(function({startDate:t,endDate:n,newStartDateObj:r,newEndDateObj:s,newEvent:a,is_all_day:o,formatEventDayShort:i,isDeletion:c=!1}){const u=Kye(t,n);return l.jsx(ra,{icon:D("clock"),children:l.jsxs("div",{className:"gap-sm flex",children:[u&&l.jsx(nbe,{startDate:t,endDate:n,newStartDateObj:r,newEndDateObj:s,newEvent:a,is_all_day:o,formatEventDayShort:i,isDeletion:c}),!u&&l.jsx(rbe,{startDate:t,endDate:n,newStartDateObj:r,newEndDateObj:s,newEvent:a,formatEventDayShort:i,isDeletion:c})]})})}),abe=A.memo(function({event:t,newEvent:n,className:r,truncateAttendees:s,showRsvp:a=!1,action:o}){const{start_date_time:i,end_date_time:c,attendees:u,description:d,location:m,conference_data:p,is_all_day:h}=t,g=o==="DELETE",{formatEventDayShort:y}=y1e(),b=f.useMemo(()=>new Date(i||""),[i]),x=f.useMemo(()=>new Date(c||""),[c]),_=f.useMemo(()=>{if(n&&n.start_date_time)return new Date(n.start_date_time||"")},[n]),v=f.useMemo(()=>{if(n&&n.end_date_time)return new Date(n.end_date_time||"")},[n]),C=p?.entry_points?.find(w=>w.entry_point_type==="video");return l.jsxs("div",{className:z("gap-md flex h-full flex-col",r),children:[l.jsx(sbe,{startDate:b,endDate:x,newStartDateObj:_,newEndDateObj:v,newEvent:n,is_all_day:h??!1,formatEventDayShort:y,isDeletion:g}),l.jsx(J1e,{videoEntryPoint:C,isDeletion:g}),l.jsx(ebe,{location:m,newLocation:n?.location,isDeletion:g}),l.jsx(tbe,{description:d,newDescription:n?.description,isDeletion:g}),l.jsx(ra,{icon:D("user"),children:l.jsx(Z1e,{attendees:u,newAttendees:n?.attendees,truncateAttendees:s,showRsvp:a,isDeletion:g})})]})});function g1(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}function cd(e){return(t,n)=>{const r=n?.context?String(n.context):"standalone";let s;if(r==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,i=n?.width?String(n.width):o;s=e.formattingValues[i]||e.formattingValues[o]}else{const o=e.defaultWidth,i=n?.width?String(n.width):e.defaultWidth;s=e.values[i]||e.values[o]}const a=e.argumentCallback?e.argumentCallback(t):t;return s[a]}}function ud(e){return(t,n={})=>{const r=n.width,s=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],a=t.match(s);if(!a)return null;const o=a[0],i=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(i)?ibe(i,m=>m.test(o)):obe(i,m=>m.test(o));let u;u=e.valueCallback?e.valueCallback(c):c,u=n.valueCallback?n.valueCallback(u):u;const d=t.slice(o.length);return{value:u,rest:d}}}function obe(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function ibe(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function lbe(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const s=r[0],a=t.match(e.parsePattern);if(!a)return null;let o=e.valueCallback?e.valueCallback(a[0]):a[0];o=n.valueCallback?n.valueCallback(o):o;const i=t.slice(s.length);return{value:o,rest:i}}}const FE=6048e5,cbe=864e5,dT=Symbol.for("constructDateFrom");function hr(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&dT in e?e[dT](t):e instanceof Date?new e.constructor(t):new Date(t)}function Iu(e,...t){const n=hr.bind(null,e||t.find(r=>typeof r=="object"));return t.map(n)}let ube={};function pm(){return ube}function ln(e,t){return hr(t||e,e)}function Wa(e,t){const n=pm(),r=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,s=ln(e,t?.in),a=s.getDay(),o=(a<r?7:0)+a-r;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}const dbe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},fbe=(e,t,n)=>{let r;const s=dbe[e];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r},mbe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},pbe=(e,t,n,r)=>mbe[e],hbe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},gbe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},ybe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},xbe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},bbe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},_be={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},vbe=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Cbe={ordinalNumber:vbe,era:cd({values:hbe,defaultWidth:"wide"}),quarter:cd({values:gbe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:cd({values:ybe,defaultWidth:"wide"}),day:cd({values:xbe,defaultWidth:"wide"}),dayPeriod:cd({values:bbe,defaultWidth:"wide",formattingValues:_be,defaultFormattingWidth:"wide"})},wbe=/^(\d+)(th|st|nd|rd)?/i,Sbe=/\d+/i,Ebe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},kbe={any:[/^b/i,/^(a|c)/i]},Mbe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Tbe={any:[/1/i,/2/i,/3/i,/4/i]},Abe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Nbe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Rbe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Dbe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Ibe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},jbe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Pbe={ordinalNumber:lbe({matchPattern:wbe,parsePattern:Sbe,valueCallback:e=>parseInt(e,10)}),era:ud({matchPatterns:Ebe,defaultMatchWidth:"wide",parsePatterns:kbe,defaultParseWidth:"any"}),quarter:ud({matchPatterns:Mbe,defaultMatchWidth:"wide",parsePatterns:Tbe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ud({matchPatterns:Abe,defaultMatchWidth:"wide",parsePatterns:Nbe,defaultParseWidth:"any"}),day:ud({matchPatterns:Rbe,defaultMatchWidth:"wide",parsePatterns:Dbe,defaultParseWidth:"any"}),dayPeriod:ud({matchPatterns:Ibe,defaultMatchWidth:"any",parsePatterns:jbe,defaultParseWidth:"any"})},Obe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Lbe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Fbe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Ube={date:g1({formats:Obe,defaultWidth:"full"}),time:g1({formats:Lbe,defaultWidth:"full"}),dateTime:g1({formats:Fbe,defaultWidth:"full"})},IF={code:"en-US",formatDistance:fbe,formatLong:Ube,formatRelative:pbe,localize:Cbe,match:Pbe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Ds(e,t,n){const r=ln(e,n?.in);return isNaN(t)?hr(n?.in||e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Ka(e,t,n){const r=ln(e,n?.in);if(isNaN(t))return hr(n?.in||e,NaN);if(!t)return r;const s=r.getDate(),a=hr(n?.in||e,r.getTime());a.setMonth(r.getMonth()+t+1,0);const o=a.getDate();return s>=o?a:(r.setFullYear(a.getFullYear(),a.getMonth(),s),r)}function xl(e,t){return Wa(e,{...t,weekStartsOn:1})}function jF(e,t){const n=ln(e,t?.in),r=n.getFullYear(),s=hr(n,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const a=xl(s),o=hr(n,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);const i=xl(o);return n.getTime()>=a.getTime()?r+1:n.getTime()>=i.getTime()?r:r-1}function dg(e){const t=ln(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function eu(e,t){const n=ln(e,t?.in);return n.setHours(0,0,0,0),n}function ja(e,t,n){const[r,s]=Iu(n?.in,e,t),a=eu(r),o=eu(s),i=+a-dg(a),c=+o-dg(o);return Math.round((i-c)/cbe)}function Bbe(e,t){const n=jF(e,t),r=hr(e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),xl(r)}function U_(e,t,n){return Ds(e,t*7,n)}function Hbe(e,t,n){return Ka(e,t*12,n)}function Vbe(e,t){let n,r=t?.in;return e.forEach(s=>{!r&&typeof s=="object"&&(r=hr.bind(null,s));const a=ln(s,r);(!n||n<a||isNaN(+a))&&(n=a)}),hr(r,n||NaN)}function Gbe(e,t){let n,r=t?.in;return e.forEach(s=>{!r&&typeof s=="object"&&(r=hr.bind(null,s));const a=ln(s,r);(!n||n>a||isNaN(+a))&&(n=a)}),hr(r,n||NaN)}function Qr(e,t,n){const[r,s]=Iu(n?.in,e,t);return+eu(r)==+eu(s)}function UE(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function zbe(e){return!(!UE(e)&&typeof e!="number"||isNaN(+ln(e)))}function wf(e,t,n){const[r,s]=Iu(n?.in,e,t),a=r.getFullYear()-s.getFullYear(),o=r.getMonth()-s.getMonth();return a*12+o}function qbe(e,t,n){const[r,s]=Iu(n?.in,e,t),a=Wa(r,n),o=Wa(s,n),i=+a-dg(a),c=+o-dg(o);return Math.round((i-c)/FE)}function BE(e,t){const n=ln(e,t?.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function ts(e,t){const n=ln(e,t?.in);return n.setDate(1),n.setHours(0,0,0,0),n}function PF(e,t){const n=ln(e,t?.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function HE(e,t){const n=pm(),r=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,s=ln(e,t?.in),a=s.getDay(),o=(a<r?-7:0)+6-(a-r);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}function OF(e,t){return HE(e,{...t,weekStartsOn:1})}function $be(e,t){const n=ln(e,t?.in);return ja(n,PF(n))+1}function LF(e,t){const n=ln(e,t?.in),r=+xl(n)-+Bbe(n);return Math.round(r/FE)+1}function FF(e,t){const n=ln(e,t?.in),r=n.getFullYear(),s=pm(),a=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,o=hr(t?.in||e,0);o.setFullYear(r+1,0,a),o.setHours(0,0,0,0);const i=Wa(o,t),c=hr(t?.in||e,0);c.setFullYear(r,0,a),c.setHours(0,0,0,0);const u=Wa(c,t);return+n>=+i?r+1:+n>=+u?r:r-1}function Wbe(e,t){const n=pm(),r=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,s=FF(e,t),a=hr(t?.in||e,0);return a.setFullYear(s,0,r),a.setHours(0,0,0,0),Wa(a,t)}function UF(e,t){const n=ln(e,t?.in),r=+Wa(n,t)-+Wbe(n,t);return Math.round(r/FE)+1}function sn(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const $o={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return sn(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):sn(n+1,2)},d(e,t){return sn(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return sn(e.getHours()%12||12,t.length)},H(e,t){return sn(e.getHours(),t.length)},m(e,t){return sn(e.getMinutes(),t.length)},s(e,t){return sn(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),s=Math.trunc(r*Math.pow(10,n-3));return sn(s,t.length)}},nc={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},fT={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),s=r>0?r:1-r;return n.ordinalNumber(s,{unit:"year"})}return $o.y(e,t)},Y:function(e,t,n,r){const s=FF(e,r),a=s>0?s:1-s;if(t==="YY"){const o=a%100;return sn(o,2)}return t==="Yo"?n.ordinalNumber(a,{unit:"year"}):sn(a,t.length)},R:function(e,t){const n=jF(e);return sn(n,t.length)},u:function(e,t){const n=e.getFullYear();return sn(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return sn(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return sn(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return $o.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return sn(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const s=UF(e,r);return t==="wo"?n.ordinalNumber(s,{unit:"week"}):sn(s,t.length)},I:function(e,t,n){const r=LF(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):sn(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):$o.d(e,t)},D:function(e,t,n){const r=$be(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):sn(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const s=e.getDay(),a=(s-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return sn(a,2);case"eo":return n.ordinalNumber(a,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const s=e.getDay(),a=(s-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return sn(a,t.length);case"co":return n.ordinalNumber(a,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),s=r===0?7:r;switch(t){case"i":return String(s);case"ii":return sn(s,t.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let s;switch(r===12?s=nc.noon:r===0?s=nc.midnight:s=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let s;switch(r>=17?s=nc.evening:r>=12?s=nc.afternoon:r>=4?s=nc.morning:s=nc.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return $o.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):$o.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):sn(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):sn(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):$o.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):$o.s(e,t)},S:function(e,t){return $o.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return pT(r);case"XXXX":case"XX":return zi(r);case"XXXXX":case"XXX":default:return zi(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return pT(r);case"xxxx":case"xx":return zi(r);case"xxxxx":case"xxx":default:return zi(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+mT(r,":");case"OOOO":default:return"GMT"+zi(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+mT(r,":");case"zzzz":default:return"GMT"+zi(r,":")}},t:function(e,t,n){const r=Math.trunc(+e/1e3);return sn(r,t.length)},T:function(e,t,n){return sn(+e,t.length)}};function mT(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=Math.trunc(r/60),a=r%60;return a===0?n+String(s):n+String(s)+t+sn(a,2)}function pT(e,t){return e%60===0?(e>0?"-":"+")+sn(Math.abs(e)/60,2):zi(e,t)}function zi(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=sn(Math.trunc(r/60),2),a=sn(r%60,2);return n+s+t+a}const hT=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},BF=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},Kbe=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return hT(e,t);let a;switch(r){case"P":a=t.dateTime({width:"short"});break;case"PP":a=t.dateTime({width:"medium"});break;case"PPP":a=t.dateTime({width:"long"});break;case"PPPP":default:a=t.dateTime({width:"full"});break}return a.replace("{{date}}",hT(r,t)).replace("{{time}}",BF(s,t))},Ybe={p:BF,P:Kbe},Qbe=/^D+$/,Xbe=/^Y+$/,Zbe=["D","DD","YY","YYYY"];function Jbe(e){return Qbe.test(e)}function e2e(e){return Xbe.test(e)}function t2e(e,t,n){const r=n2e(e,t,n);if(console.warn(r),Zbe.includes(e))throw new RangeError(r)}function n2e(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const r2e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,s2e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,a2e=/^'([^]*?)'?$/,o2e=/''/g,i2e=/[a-zA-Z]/;function Hl(e,t,n){const r=pm(),s=n?.locale??r.locale??IF,a=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,o=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,i=ln(e,n?.in);if(!zbe(i))throw new RangeError("Invalid time value");let c=t.match(s2e).map(d=>{const m=d[0];if(m==="p"||m==="P"){const p=Ybe[m];return p(d,s.formatLong)}return d}).join("").match(r2e).map(d=>{if(d==="''")return{isToken:!1,value:"'"};const m=d[0];if(m==="'")return{isToken:!1,value:l2e(d)};if(fT[m])return{isToken:!0,value:d};if(m.match(i2e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+m+"`");return{isToken:!1,value:d}});s.localize.preprocessor&&(c=s.localize.preprocessor(i,c));const u={firstWeekContainsDate:a,weekStartsOn:o,locale:s};return c.map(d=>{if(!d.isToken)return d.value;const m=d.value;(!n?.useAdditionalWeekYearTokens&&e2e(m)||!n?.useAdditionalDayOfYearTokens&&Jbe(m))&&t2e(m,t,String(e));const p=fT[m[0]];return p(i,m,s.localize,u)}).join("")}function l2e(e){const t=e.match(a2e);return t?t[1].replace(o2e,"'"):e}function c2e(e,t){const n=ln(e,t?.in),r=n.getFullYear(),s=n.getMonth(),a=hr(n,0);return a.setFullYear(r,s+1,0),a.setHours(0,0,0,0),a.getDate()}function u2e(e){return Math.trunc(+ln(e)/1e3)}function d2e(e,t){const n=ln(e,t?.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(0,0,0,0),ln(n,t?.in)}function f2e(e,t){const n=ln(e,t?.in);return qbe(d2e(n,t),ts(n,t),t)+1}function HF(e,t){return+ln(e)>+ln(t)}function VF(e,t){return+ln(e)<+ln(t)}function VE(e,t,n){const[r,s]=Iu(n?.in,e,t);return r.getFullYear()===s.getFullYear()&&r.getMonth()===s.getMonth()}function m2e(e,t,n){const[r,s]=Iu(n?.in,e,t);return r.getFullYear()===s.getFullYear()}function gT(e,t,n){return Ds(e,-t,n)}function y1(e,t,n){const r=ln(e,n?.in),s=r.getFullYear(),a=r.getDate(),o=hr(e,0);o.setFullYear(s,t,15),o.setHours(0,0,0,0);const i=c2e(o);return r.setMonth(t,Math.min(a,i)),r}function yT(e,t,n){const r=ln(e,n?.in);return isNaN(+r)?hr(e,NaN):(r.setFullYear(t),r)}var ht=function(){return ht=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},ht.apply(this,arguments)};function p2e(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}function GF(e,t,n){for(var r=0,s=t.length,a;r<s;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}function hm(e){return e.mode==="multiple"}function gm(e){return e.mode==="range"}function yy(e){return e.mode==="single"}var h2e={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function g2e(e,t){return Hl(e,"LLLL y",t)}function y2e(e,t){return Hl(e,"d",t)}function x2e(e,t){return Hl(e,"LLLL",t)}function b2e(e){return"".concat(e)}function _2e(e,t){return Hl(e,"cccccc",t)}function v2e(e,t){return Hl(e,"yyyy",t)}var C2e=Object.freeze({__proto__:null,formatCaption:g2e,formatDay:y2e,formatMonthCaption:x2e,formatWeekNumber:b2e,formatWeekdayName:_2e,formatYearCaption:v2e}),w2e=function(e,t,n){return Hl(e,"do MMMM (EEEE)",n)},S2e=function(){return"Month: "},E2e=function(){return"Go to next month"},k2e=function(){return"Go to previous month"},M2e=function(e,t){return Hl(e,"cccc",t)},T2e=function(e){return"Week n. ".concat(e)},A2e=function(){return"Year: "},N2e=Object.freeze({__proto__:null,labelDay:w2e,labelMonthDropdown:S2e,labelNext:E2e,labelPrevious:k2e,labelWeekNumber:T2e,labelWeekday:M2e,labelYearDropdown:A2e});function R2e(){var e="buttons",t=h2e,n=IF,r={},s={},a=1,o={},i=new Date;return{captionLayout:e,classNames:t,formatters:C2e,labels:N2e,locale:n,modifiersClassNames:r,modifiers:s,numberOfMonths:a,styles:o,today:i,mode:"default"}}function D2e(e){var t=e.fromYear,n=e.toYear,r=e.fromMonth,s=e.toMonth,a=e.fromDate,o=e.toDate;return r?a=ts(r):t&&(a=new Date(t,0,1)),s?o=BE(s):n&&(o=new Date(n,11,31)),{fromDate:a?eu(a):void 0,toDate:o?eu(o):void 0}}var zF=f.createContext(void 0);function I2e(e){var t,n=e.initialProps,r=R2e(),s=D2e(n),a=s.fromDate,o=s.toDate,i=(t=n.captionLayout)!==null&&t!==void 0?t:r.captionLayout;i!=="buttons"&&(!a||!o)&&(i="buttons");var c;(yy(n)||hm(n)||gm(n))&&(c=n.onSelect);var u=ht(ht(ht({},r),n),{captionLayout:i,classNames:ht(ht({},r.classNames),n.classNames),components:ht({},n.components),formatters:ht(ht({},r.formatters),n.formatters),fromDate:a,labels:ht(ht({},r.labels),n.labels),mode:n.mode||r.mode,modifiers:ht(ht({},r.modifiers),n.modifiers),modifiersClassNames:ht(ht({},r.modifiersClassNames),n.modifiersClassNames),onSelect:c,styles:ht(ht({},r.styles),n.styles),toDate:o});return A.createElement(zF.Provider,{value:u},e.children)}function Mn(){var e=f.useContext(zF);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function qF(e){var t=Mn(),n=t.locale,r=t.classNames,s=t.styles,a=t.formatters.formatCaption;return A.createElement("div",{className:r.caption_label,style:s.caption_label,"aria-live":"polite",role:"presentation",id:e.id},a(e.displayMonth,{locale:n}))}function j2e(e){return A.createElement("svg",ht({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e),A.createElement("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"}))}function $F(e){var t,n,r=e.onChange,s=e.value,a=e.children,o=e.caption,i=e.className,c=e.style,u=Mn(),d=(n=(t=u.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&n!==void 0?n:j2e;return A.createElement("div",{className:i,style:c},A.createElement("span",{className:u.classNames.vhidden},e["aria-label"]),A.createElement("select",{name:e.name,"aria-label":e["aria-label"],className:u.classNames.dropdown,style:u.styles.dropdown,value:s,onChange:r},a),A.createElement("div",{className:u.classNames.caption_label,style:u.styles.caption_label,"aria-hidden":"true"},o,A.createElement(d,{className:u.classNames.dropdown_icon,style:u.styles.dropdown_icon})))}function P2e(e){var t,n=Mn(),r=n.fromDate,s=n.toDate,a=n.styles,o=n.locale,i=n.formatters.formatMonthCaption,c=n.classNames,u=n.components,d=n.labels.labelMonthDropdown;if(!r)return A.createElement(A.Fragment,null);if(!s)return A.createElement(A.Fragment,null);var m=[];if(m2e(r,s))for(var p=ts(r),h=r.getMonth();h<=s.getMonth();h++)m.push(y1(p,h));else for(var p=ts(new Date),h=0;h<=11;h++)m.push(y1(p,h));var g=function(b){var x=Number(b.target.value),_=y1(ts(e.displayMonth),x);e.onChange(_)},y=(t=u?.Dropdown)!==null&&t!==void 0?t:$F;return A.createElement(y,{name:"months","aria-label":d(),className:c.dropdown_month,style:a.dropdown_month,onChange:g,value:e.displayMonth.getMonth(),caption:i(e.displayMonth,{locale:o})},m.map(function(b){return A.createElement("option",{key:b.getMonth(),value:b.getMonth()},i(b,{locale:o}))}))}function O2e(e){var t,n=e.displayMonth,r=Mn(),s=r.fromDate,a=r.toDate,o=r.locale,i=r.styles,c=r.classNames,u=r.components,d=r.formatters.formatYearCaption,m=r.labels.labelYearDropdown,p=[];if(!s)return A.createElement(A.Fragment,null);if(!a)return A.createElement(A.Fragment,null);for(var h=s.getFullYear(),g=a.getFullYear(),y=h;y<=g;y++)p.push(yT(PF(new Date),y));var b=function(_){var v=yT(ts(n),Number(_.target.value));e.onChange(v)},x=(t=u?.Dropdown)!==null&&t!==void 0?t:$F;return A.createElement(x,{name:"years","aria-label":m(),className:c.dropdown_year,style:i.dropdown_year,onChange:b,value:n.getFullYear(),caption:d(n,{locale:o})},p.map(function(_){return A.createElement("option",{key:_.getFullYear(),value:_.getFullYear()},d(_,{locale:o}))}))}function L2e(e,t){var n=f.useState(e),r=n[0],s=n[1],a=t===void 0?r:t;return[a,s]}function F2e(e){var t=e.month,n=e.defaultMonth,r=e.today,s=t||n||r||new Date,a=e.toDate,o=e.fromDate,i=e.numberOfMonths,c=i===void 0?1:i;if(a&&wf(a,s)<0){var u=-1*(c-1);s=Ka(a,u)}return o&&wf(s,o)<0&&(s=o),ts(s)}function U2e(){var e=Mn(),t=F2e(e),n=L2e(t,e.month),r=n[0],s=n[1],a=function(o){var i;if(!e.disableNavigation){var c=ts(o);s(c),(i=e.onMonthChange)===null||i===void 0||i.call(e,c)}};return[r,a]}function B2e(e,t){for(var n=t.reverseMonths,r=t.numberOfMonths,s=ts(e),a=ts(Ka(s,r)),o=wf(a,s),i=[],c=0;c<o;c++){var u=Ka(s,c);i.push(u)}return n&&(i=i.reverse()),i}function H2e(e,t){if(!t.disableNavigation){var n=t.toDate,r=t.pagedNavigation,s=t.numberOfMonths,a=s===void 0?1:s,o=r?a:1,i=ts(e);if(!n)return Ka(i,o);var c=wf(n,e);if(!(c<a))return Ka(i,o)}}function V2e(e,t){if(!t.disableNavigation){var n=t.fromDate,r=t.pagedNavigation,s=t.numberOfMonths,a=s===void 0?1:s,o=r?a:1,i=ts(e);if(!n)return Ka(i,-o);var c=wf(i,n);if(!(c<=0))return Ka(i,-o)}}var WF=f.createContext(void 0);function G2e(e){var t=Mn(),n=U2e(),r=n[0],s=n[1],a=B2e(r,t),o=H2e(r,t),i=V2e(r,t),c=function(m){return a.some(function(p){return VE(m,p)})},u=function(m,p){c(m)||(p&&VF(m,p)?s(Ka(m,1+t.numberOfMonths*-1)):s(m))},d={currentMonth:r,displayMonths:a,goToMonth:s,goToDate:u,previousMonth:i,nextMonth:o,isDateDisplayed:c};return A.createElement(WF.Provider,{value:d},e.children)}function ym(){var e=f.useContext(WF);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function xT(e){var t,n=Mn(),r=n.classNames,s=n.styles,a=n.components,o=ym().goToMonth,i=function(d){o(d)},c=(t=a?.CaptionLabel)!==null&&t!==void 0?t:qF,u=A.createElement(c,{id:e.id,displayMonth:e.displayMonth});return A.createElement("div",{className:r.caption_dropdowns,style:s.caption_dropdowns},A.createElement("div",{className:r.vhidden},u),A.createElement(P2e,{onChange:i,displayMonth:e.displayMonth}),A.createElement(O2e,{onChange:i,displayMonth:e.displayMonth}))}function z2e(e){return A.createElement("svg",ht({width:"16px",height:"16px",viewBox:"0 0 120 120"},e),A.createElement("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"}))}function q2e(e){return A.createElement("svg",ht({width:"16px",height:"16px",viewBox:"0 0 120 120"},e),A.createElement("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"}))}var fg=f.forwardRef(function(e,t){var n=Mn(),r=n.classNames,s=n.styles,a=[r.button_reset,r.button];e.className&&a.push(e.className);var o=a.join(" "),i=ht(ht({},s.button_reset),s.button);return e.style&&Object.assign(i,e.style),A.createElement("button",ht({},e,{ref:t,type:"button",className:o,style:i}))});function $2e(e){var t,n,r=Mn(),s=r.dir,a=r.locale,o=r.classNames,i=r.styles,c=r.labels,u=c.labelPrevious,d=c.labelNext,m=r.components;if(!e.nextMonth&&!e.previousMonth)return A.createElement(A.Fragment,null);var p=u(e.previousMonth,{locale:a}),h=[o.nav_button,o.nav_button_previous].join(" "),g=d(e.nextMonth,{locale:a}),y=[o.nav_button,o.nav_button_next].join(" "),b=(t=m?.IconRight)!==null&&t!==void 0?t:q2e,x=(n=m?.IconLeft)!==null&&n!==void 0?n:z2e;return A.createElement("div",{className:o.nav,style:i.nav},!e.hidePrevious&&A.createElement(fg,{name:"previous-month","aria-label":p,className:h,style:i.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick},s==="rtl"?A.createElement(b,{className:o.nav_icon,style:i.nav_icon}):A.createElement(x,{className:o.nav_icon,style:i.nav_icon})),!e.hideNext&&A.createElement(fg,{name:"next-month","aria-label":g,className:y,style:i.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick},s==="rtl"?A.createElement(x,{className:o.nav_icon,style:i.nav_icon}):A.createElement(b,{className:o.nav_icon,style:i.nav_icon})))}function bT(e){var t=Mn().numberOfMonths,n=ym(),r=n.previousMonth,s=n.nextMonth,a=n.goToMonth,o=n.displayMonths,i=o.findIndex(function(g){return VE(e.displayMonth,g)}),c=i===0,u=i===o.length-1,d=t>1&&(c||!u),m=t>1&&(u||!c),p=function(){r&&a(r)},h=function(){s&&a(s)};return A.createElement($2e,{displayMonth:e.displayMonth,hideNext:d,hidePrevious:m,nextMonth:s,previousMonth:r,onPreviousClick:p,onNextClick:h})}function W2e(e){var t,n=Mn(),r=n.classNames,s=n.disableNavigation,a=n.styles,o=n.captionLayout,i=n.components,c=(t=i?.CaptionLabel)!==null&&t!==void 0?t:qF,u;return s?u=A.createElement(c,{id:e.id,displayMonth:e.displayMonth}):o==="dropdown"?u=A.createElement(xT,{displayMonth:e.displayMonth,id:e.id}):o==="dropdown-buttons"?u=A.createElement(A.Fragment,null,A.createElement(xT,{displayMonth:e.displayMonth,id:e.id}),A.createElement(bT,{displayMonth:e.displayMonth,id:e.id})):u=A.createElement(A.Fragment,null,A.createElement(c,{id:e.id,displayMonth:e.displayMonth}),A.createElement(bT,{displayMonth:e.displayMonth,id:e.id})),A.createElement("div",{className:r.caption,style:a.caption},u)}function K2e(e){var t=Mn(),n=t.footer,r=t.styles,s=t.classNames.tfoot;return n?A.createElement("tfoot",{className:s,style:r.tfoot},A.createElement("tr",null,A.createElement("td",{colSpan:8},n))):A.createElement(A.Fragment,null)}function Y2e(e,t,n){for(var r=n?xl(new Date):Wa(new Date,{locale:e,weekStartsOn:t}),s=[],a=0;a<7;a++){var o=Ds(r,a);s.push(o)}return s}function Q2e(){var e=Mn(),t=e.classNames,n=e.styles,r=e.showWeekNumber,s=e.locale,a=e.weekStartsOn,o=e.ISOWeek,i=e.formatters.formatWeekdayName,c=e.labels.labelWeekday,u=Y2e(s,a,o);return A.createElement("tr",{style:n.head_row,className:t.head_row},r&&A.createElement("td",{style:n.head_cell,className:t.head_cell}),u.map(function(d,m){return A.createElement("th",{key:m,scope:"col",className:t.head_cell,style:n.head_cell,"aria-label":c(d,{locale:s})},i(d,{locale:s}))}))}function X2e(){var e,t=Mn(),n=t.classNames,r=t.styles,s=t.components,a=(e=s?.HeadRow)!==null&&e!==void 0?e:Q2e;return A.createElement("thead",{style:r.head,className:n.head},A.createElement(a,null))}function Z2e(e){var t=Mn(),n=t.locale,r=t.formatters.formatDay;return A.createElement(A.Fragment,null,r(e.date,{locale:n}))}var GE=f.createContext(void 0);function J2e(e){if(!hm(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return A.createElement(GE.Provider,{value:t},e.children)}return A.createElement(e_e,{initialProps:e.initialProps,children:e.children})}function e_e(e){var t=e.initialProps,n=e.children,r=t.selected,s=t.min,a=t.max,o=function(u,d,m){var p,h;(p=t.onDayClick)===null||p===void 0||p.call(t,u,d,m);var g=!!(d.selected&&s&&r?.length===s);if(!g){var y=!!(!d.selected&&a&&r?.length===a);if(!y){var b=r?GF([],r):[];if(d.selected){var x=b.findIndex(function(_){return Qr(u,_)});b.splice(x,1)}else b.push(u);(h=t.onSelect)===null||h===void 0||h.call(t,b,u,d,m)}}},i={disabled:[]};r&&i.disabled.push(function(u){var d=a&&r.length>a-1,m=r.some(function(p){return Qr(p,u)});return!!(d&&!m)});var c={selected:r,onDayClick:o,modifiers:i};return A.createElement(GE.Provider,{value:c},n)}function zE(){var e=f.useContext(GE);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function t_e(e,t){var n=t||{},r=n.from,s=n.to;if(!r)return{from:e,to:void 0};if(!s&&Qr(r,e))return{from:r,to:e};if(!s&&VF(e,r))return{from:e,to:r};if(!s)return{from:r,to:e};if(!(Qr(s,e)&&Qr(r,e))){if(Qr(s,e))return{from:s,to:void 0};if(!Qr(r,e))return HF(r,e)?{from:e,to:s}:{from:r,to:e}}}var qE=f.createContext(void 0);function n_e(e){if(!gm(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return A.createElement(qE.Provider,{value:t},e.children)}return A.createElement(r_e,{initialProps:e.initialProps,children:e.children})}function r_e(e){var t=e.initialProps,n=e.children,r=t.selected,s=r||{},a=s.from,o=s.to,i=t.min,c=t.max,u=function(h,g,y){var b,x;(b=t.onDayClick)===null||b===void 0||b.call(t,h,g,y);var _=t_e(h,r);(x=t.onSelect)===null||x===void 0||x.call(t,_,h,g,y)},d={range_start:[],range_end:[],range_middle:[],disabled:[]};if(a&&(d.range_start=[a],o?(d.range_end=[o],Qr(a,o)||(d.range_middle=[{after:a,before:o}])):d.range_end=[a]),i&&(a&&!o&&d.disabled.push({after:gT(a,i-1),before:Ds(a,i-1)}),a&&o&&d.disabled.push({after:a,before:Ds(a,i-1)})),c&&(a&&!o&&(d.disabled.push({before:Ds(a,-c+1)}),d.disabled.push({after:Ds(a,c-1)})),a&&o)){var m=ja(o,a)+1,p=c-m;d.disabled.push({before:gT(a,p)}),d.disabled.push({after:Ds(o,p)})}return A.createElement(qE.Provider,{value:{selected:r,onDayClick:u,modifiers:d}},n)}function $E(){var e=f.useContext(qE);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function Eh(e){return Array.isArray(e)?GF([],e):e!==void 0?[e]:[]}function s_e(e){var t={};return Object.entries(e).forEach(function(n){var r=n[0],s=n[1];t[r]=Eh(s)}),t}var ma;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(ma||(ma={}));var a_e=ma.Selected,fo=ma.Disabled,o_e=ma.Hidden,i_e=ma.Today,x1=ma.RangeEnd,b1=ma.RangeMiddle,_1=ma.RangeStart,l_e=ma.Outside;function c_e(e,t,n){var r,s=(r={},r[a_e]=Eh(e.selected),r[fo]=Eh(e.disabled),r[o_e]=Eh(e.hidden),r[i_e]=[e.today],r[x1]=[],r[b1]=[],r[_1]=[],r[l_e]=[],r);return e.fromDate&&s[fo].push({before:e.fromDate}),e.toDate&&s[fo].push({after:e.toDate}),hm(e)?s[fo]=s[fo].concat(t.modifiers[fo]):gm(e)&&(s[fo]=s[fo].concat(n.modifiers[fo]),s[_1]=n.modifiers[_1],s[b1]=n.modifiers[b1],s[x1]=n.modifiers[x1]),s}var KF=f.createContext(void 0);function u_e(e){var t=Mn(),n=zE(),r=$E(),s=c_e(t,n,r),a=s_e(t.modifiers),o=ht(ht({},s),a);return A.createElement(KF.Provider,{value:o},e.children)}function YF(){var e=f.useContext(KF);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function d_e(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function f_e(e){return!!(e&&typeof e=="object"&&"from"in e)}function m_e(e){return!!(e&&typeof e=="object"&&"after"in e)}function p_e(e){return!!(e&&typeof e=="object"&&"before"in e)}function h_e(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function g_e(e,t){var n,r=t.from,s=t.to;if(!r)return!1;if(!s&&Qr(r,e))return!0;if(!s)return!1;var a=ja(s,r)<0;a&&(n=[s,r],r=n[0],s=n[1]);var o=ja(e,r)>=0&&ja(s,e)>=0;return o}function y_e(e){return UE(e)}function x_e(e){return Array.isArray(e)&&e.every(UE)}function b_e(e,t){return t.some(function(n){if(typeof n=="boolean")return n;if(y_e(n))return Qr(e,n);if(x_e(n))return n.includes(e);if(f_e(n))return g_e(e,n);if(h_e(n))return n.dayOfWeek.includes(e.getDay());if(d_e(n)){var r=ja(n.before,e),s=ja(n.after,e),a=r>0,o=s<0,i=HF(n.before,n.after);return i?o&&a:a||o}return m_e(n)?ja(e,n.after)>0:p_e(n)?ja(n.before,e)>0:typeof n=="function"?n(e):!1})}function WE(e,t,n){var r=Object.keys(t).reduce(function(a,o){var i=t[o];return b_e(e,i)&&a.push(o),a},[]),s={};return r.forEach(function(a){return s[a]=!0}),n&&!VE(e,n)&&(s.outside=!0),s}function __e(e,t){for(var n=ts(e[0]),r=BE(e[e.length-1]),s,a,o=n;o<=r;){var i=WE(o,t),c=!i.disabled&&!i.hidden;if(!c){o=Ds(o,1);continue}if(i.selected)return o;i.today&&!a&&(a=o),s||(s=o),o=Ds(o,1)}return a||s}var v_e=365;function QF(e,t){var n=t.moveBy,r=t.direction,s=t.context,a=t.modifiers,o=t.retry,i=o===void 0?{count:0,lastFocused:e}:o,c=s.weekStartsOn,u=s.fromDate,d=s.toDate,m=s.locale,p={day:Ds,week:U_,month:Ka,year:Hbe,startOfWeek:function(b){return s.ISOWeek?xl(b):Wa(b,{locale:m,weekStartsOn:c})},endOfWeek:function(b){return s.ISOWeek?OF(b):HE(b,{locale:m,weekStartsOn:c})}},h=p[n](e,r==="after"?1:-1);r==="before"&&u?h=Vbe([u,h]):r==="after"&&d&&(h=Gbe([d,h]));var g=!0;if(a){var y=WE(h,a);g=!y.disabled&&!y.hidden}return g?h:i.count>v_e?i.lastFocused:QF(h,{moveBy:n,direction:r,context:s,modifiers:a,retry:ht(ht({},i),{count:i.count+1})})}var XF=f.createContext(void 0);function C_e(e){var t=ym(),n=YF(),r=f.useState(),s=r[0],a=r[1],o=f.useState(),i=o[0],c=o[1],u=__e(t.displayMonths,n),d=s??(i&&t.isDateDisplayed(i))?i:u,m=function(){c(s),a(void 0)},p=function(b){a(b)},h=Mn(),g=function(b,x){if(s){var _=QF(s,{moveBy:b,direction:x,context:h,modifiers:n});Qr(s,_)||(t.goToDate(_,s),p(_))}},y={focusedDay:s,focusTarget:d,blur:m,focus:p,focusDayAfter:function(){return g("day","after")},focusDayBefore:function(){return g("day","before")},focusWeekAfter:function(){return g("week","after")},focusWeekBefore:function(){return g("week","before")},focusMonthBefore:function(){return g("month","before")},focusMonthAfter:function(){return g("month","after")},focusYearBefore:function(){return g("year","before")},focusYearAfter:function(){return g("year","after")},focusStartOfWeek:function(){return g("startOfWeek","before")},focusEndOfWeek:function(){return g("endOfWeek","after")}};return A.createElement(XF.Provider,{value:y},e.children)}function KE(){var e=f.useContext(XF);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function w_e(e,t){var n=YF(),r=WE(e,n,t);return r}var YE=f.createContext(void 0);function S_e(e){if(!yy(e.initialProps)){var t={selected:void 0};return A.createElement(YE.Provider,{value:t},e.children)}return A.createElement(E_e,{initialProps:e.initialProps,children:e.children})}function E_e(e){var t=e.initialProps,n=e.children,r=function(a,o,i){var c,u,d;if((c=t.onDayClick)===null||c===void 0||c.call(t,a,o,i),o.selected&&!t.required){(u=t.onSelect)===null||u===void 0||u.call(t,void 0,a,o,i);return}(d=t.onSelect)===null||d===void 0||d.call(t,a,a,o,i)},s={selected:t.selected,onDayClick:r};return A.createElement(YE.Provider,{value:s},n)}function ZF(){var e=f.useContext(YE);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function k_e(e,t){var n=Mn(),r=ZF(),s=zE(),a=$E(),o=KE(),i=o.focusDayAfter,c=o.focusDayBefore,u=o.focusWeekAfter,d=o.focusWeekBefore,m=o.blur,p=o.focus,h=o.focusMonthBefore,g=o.focusMonthAfter,y=o.focusYearBefore,b=o.focusYearAfter,x=o.focusStartOfWeek,_=o.focusEndOfWeek,v=function(I){var F,G,j,$;yy(n)?(F=r.onDayClick)===null||F===void 0||F.call(r,e,t,I):hm(n)?(G=s.onDayClick)===null||G===void 0||G.call(s,e,t,I):gm(n)?(j=a.onDayClick)===null||j===void 0||j.call(a,e,t,I):($=n.onDayClick)===null||$===void 0||$.call(n,e,t,I)},C=function(I){var F;p(e),(F=n.onDayFocus)===null||F===void 0||F.call(n,e,t,I)},w=function(I){var F;m(),(F=n.onDayBlur)===null||F===void 0||F.call(n,e,t,I)},S=function(I){var F;(F=n.onDayMouseEnter)===null||F===void 0||F.call(n,e,t,I)},E=function(I){var F;(F=n.onDayMouseLeave)===null||F===void 0||F.call(n,e,t,I)},T=function(I){var F;(F=n.onDayPointerEnter)===null||F===void 0||F.call(n,e,t,I)},k=function(I){var F;(F=n.onDayPointerLeave)===null||F===void 0||F.call(n,e,t,I)},M=function(I){var F;(F=n.onDayTouchCancel)===null||F===void 0||F.call(n,e,t,I)},N=function(I){var F;(F=n.onDayTouchEnd)===null||F===void 0||F.call(n,e,t,I)},P=function(I){var F;(F=n.onDayTouchMove)===null||F===void 0||F.call(n,e,t,I)},O=function(I){var F;(F=n.onDayTouchStart)===null||F===void 0||F.call(n,e,t,I)},L=function(I){var F;(F=n.onDayKeyUp)===null||F===void 0||F.call(n,e,t,I)},H=function(I){var F;switch(I.key){case"ArrowLeft":I.preventDefault(),I.stopPropagation(),n.dir==="rtl"?i():c();break;case"ArrowRight":I.preventDefault(),I.stopPropagation(),n.dir==="rtl"?c():i();break;case"ArrowDown":I.preventDefault(),I.stopPropagation(),u();break;case"ArrowUp":I.preventDefault(),I.stopPropagation(),d();break;case"PageUp":I.preventDefault(),I.stopPropagation(),I.shiftKey?y():h();break;case"PageDown":I.preventDefault(),I.stopPropagation(),I.shiftKey?b():g();break;case"Home":I.preventDefault(),I.stopPropagation(),x();break;case"End":I.preventDefault(),I.stopPropagation(),_();break}(F=n.onDayKeyDown)===null||F===void 0||F.call(n,e,t,I)},R={onClick:v,onFocus:C,onBlur:w,onKeyDown:H,onKeyUp:L,onMouseEnter:S,onMouseLeave:E,onPointerEnter:T,onPointerLeave:k,onTouchCancel:M,onTouchEnd:N,onTouchMove:P,onTouchStart:O};return R}function M_e(){var e=Mn(),t=ZF(),n=zE(),r=$E(),s=yy(e)?t.selected:hm(e)?n.selected:gm(e)?r.selected:void 0;return s}function T_e(e){return Object.values(ma).includes(e)}function A_e(e,t){var n=[e.classNames.day];return Object.keys(t).forEach(function(r){var s=e.modifiersClassNames[r];if(s)n.push(s);else if(T_e(r)){var a=e.classNames["day_".concat(r)];a&&n.push(a)}}),n}function N_e(e,t){var n=ht({},e.styles.day);return Object.keys(t).forEach(function(r){var s;n=ht(ht({},n),(s=e.modifiersStyles)===null||s===void 0?void 0:s[r])}),n}function R_e(e,t,n){var r,s,a,o=Mn(),i=KE(),c=w_e(e,t),u=k_e(e,c),d=M_e(),m=!!(o.onDayClick||o.mode!=="default");f.useEffect(function(){var S;c.outside||i.focusedDay&&m&&Qr(i.focusedDay,e)&&((S=n.current)===null||S===void 0||S.focus())},[i.focusedDay,e,n,m,c.outside]);var p=A_e(o,c).join(" "),h=N_e(o,c),g=!!(c.outside&&!o.showOutsideDays||c.hidden),y=(a=(s=o.components)===null||s===void 0?void 0:s.DayContent)!==null&&a!==void 0?a:Z2e,b=A.createElement(y,{date:e,displayMonth:t,activeModifiers:c}),x={style:h,className:p,children:b,role:"gridcell"},_=i.focusTarget&&Qr(i.focusTarget,e)&&!c.outside,v=i.focusedDay&&Qr(i.focusedDay,e),C=ht(ht(ht({},x),(r={disabled:c.disabled,role:"gridcell"},r["aria-selected"]=c.selected,r.tabIndex=v||_?0:-1,r)),u),w={isButton:m,isHidden:g,activeModifiers:c,selectedDays:d,buttonProps:C,divProps:x};return w}function D_e(e){var t=f.useRef(null),n=R_e(e.date,e.displayMonth,t);return n.isHidden?A.createElement("div",{role:"gridcell"}):n.isButton?A.createElement(fg,ht({name:"day",ref:t},n.buttonProps)):A.createElement("div",ht({},n.divProps))}function I_e(e){var t=e.number,n=e.dates,r=Mn(),s=r.onWeekNumberClick,a=r.styles,o=r.classNames,i=r.locale,c=r.labels.labelWeekNumber,u=r.formatters.formatWeekNumber,d=u(Number(t),{locale:i});if(!s)return A.createElement("span",{className:o.weeknumber,style:a.weeknumber},d);var m=c(Number(t),{locale:i}),p=function(h){s(t,n,h)};return A.createElement(fg,{name:"week-number","aria-label":m,className:o.weeknumber,style:a.weeknumber,onClick:p},d)}function j_e(e){var t,n,r=Mn(),s=r.styles,a=r.classNames,o=r.showWeekNumber,i=r.components,c=(t=i?.Day)!==null&&t!==void 0?t:D_e,u=(n=i?.WeekNumber)!==null&&n!==void 0?n:I_e,d;return o&&(d=A.createElement("td",{className:a.cell,style:s.cell},A.createElement(u,{number:e.weekNumber,dates:e.dates}))),A.createElement("tr",{className:a.row,style:s.row},d,e.dates.map(function(m){return A.createElement("td",{className:a.cell,style:s.cell,key:u2e(m),role:"presentation"},A.createElement(c,{displayMonth:e.displayMonth,date:m}))}))}function _T(e,t,n){for(var r=n?.ISOWeek?OF(t):HE(t,n),s=n?.ISOWeek?xl(e):Wa(e,n),a=ja(r,s),o=[],i=0;i<=a;i++)o.push(Ds(s,i));var c=o.reduce(function(u,d){var m=n?.ISOWeek?LF(d):UF(d,n),p=u.find(function(h){return h.weekNumber===m});return p?(p.dates.push(d),u):(u.push({weekNumber:m,dates:[d]}),u)},[]);return c}function P_e(e,t){var n=_T(ts(e),BE(e),t);if(t?.useFixedWeeks){var r=f2e(e,t);if(r<6){var s=n[n.length-1],a=s.dates[s.dates.length-1],o=U_(a,6-r),i=_T(U_(a,1),o,t);n.push.apply(n,i)}}return n}function O_e(e){var t,n,r,s=Mn(),a=s.locale,o=s.classNames,i=s.styles,c=s.hideHead,u=s.fixedWeeks,d=s.components,m=s.weekStartsOn,p=s.firstWeekContainsDate,h=s.ISOWeek,g=P_e(e.displayMonth,{useFixedWeeks:!!u,ISOWeek:h,locale:a,weekStartsOn:m,firstWeekContainsDate:p}),y=(t=d?.Head)!==null&&t!==void 0?t:X2e,b=(n=d?.Row)!==null&&n!==void 0?n:j_e,x=(r=d?.Footer)!==null&&r!==void 0?r:K2e;return A.createElement("table",{className:o.table,style:i.table,role:"grid","aria-labelledby":e["aria-labelledby"]},!c&&A.createElement(y,null),A.createElement("tbody",{className:o.tbody,style:i.tbody,role:"rowgroup"},g.map(function(_){return A.createElement(b,{displayMonth:e.displayMonth,key:_.weekNumber,dates:_.dates,weekNumber:_.weekNumber})})),A.createElement(x,{displayMonth:e.displayMonth}))}function L_e(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var F_e=L_e()?f.useLayoutEffect:f.useEffect,v1=!1,U_e=0;function vT(){return"react-day-picker-".concat(++U_e)}function B_e(e){var t,n=e??(v1?vT():null),r=f.useState(n),s=r[0],a=r[1];return F_e(function(){s===null&&a(vT())},[]),f.useEffect(function(){v1===!1&&(v1=!0)},[]),(t=e??s)!==null&&t!==void 0?t:void 0}function H_e(e){var t,n,r=Mn(),s=r.dir,a=r.classNames,o=r.styles,i=r.components,c=ym().displayMonths,u=B_e(r.id?"".concat(r.id,"-").concat(e.displayIndex):void 0),d=[a.month],m=o.month,p=e.displayIndex===0,h=e.displayIndex===c.length-1,g=!p&&!h;s==="rtl"&&(t=[p,h],h=t[0],p=t[1]),p&&(d.push(a.caption_start),m=ht(ht({},m),o.caption_start)),h&&(d.push(a.caption_end),m=ht(ht({},m),o.caption_end)),g&&(d.push(a.caption_between),m=ht(ht({},m),o.caption_between));var y=(n=i?.Caption)!==null&&n!==void 0?n:W2e;return A.createElement("div",{key:e.displayIndex,className:d.join(" "),style:m},A.createElement(y,{id:u,displayMonth:e.displayMonth}),A.createElement(O_e,{"aria-labelledby":u,displayMonth:e.displayMonth}))}function V_e(e){var t=e.initialProps,n=Mn(),r=KE(),s=ym(),a=f.useState(!1),o=a[0],i=a[1];f.useEffect(function(){n.initialFocus&&r.focusTarget&&(o||(r.focus(r.focusTarget),i(!0)))},[n.initialFocus,o,r.focus,r.focusTarget,r]);var c=[n.classNames.root,n.className];n.numberOfMonths>1&&c.push(n.classNames.multiple_months),n.showWeekNumber&&c.push(n.classNames.with_weeknumber);var u=ht(ht({},n.styles.root),n.style),d=Object.keys(t).filter(function(m){return m.startsWith("data-")}).reduce(function(m,p){var h;return ht(ht({},m),(h={},h[p]=t[p],h))},{});return A.createElement("div",ht({className:c.join(" "),style:u,dir:n.dir,id:n.id},d),A.createElement("div",{className:n.classNames.months,style:n.styles.months},s.displayMonths.map(function(m,p){return A.createElement(H_e,{key:p,displayIndex:p,displayMonth:m})})))}function G_e(e){var t=e.children,n=p2e(e,["children"]);return A.createElement(I2e,{initialProps:n},A.createElement(G2e,null,A.createElement(S_e,{initialProps:n},A.createElement(J2e,{initialProps:n},A.createElement(n_e,{initialProps:n},A.createElement(u_e,null,A.createElement(C_e,null,t)))))))}function z_e(e){return A.createElement(G_e,ht({},e),A.createElement(V_e,{initialProps:e}))}const JF=A.memo(function({className:t,showOutsideDays:n=!0,...r}){const s=A.useMemo(()=>({months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-between relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:"h-7 w-7 p-0 rounded hover:bg-subtle flex items-center justify-center bg-subtler [&_*]:fill-quiet",table:"w-full border-collapse",head_row:"flex",head_cell:"text-quiet rounded-md w-8 font-normal text-sm font-mono",row:"flex w-full mt-1",cell:z("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected].day-range-end)]:rounded-r-full",r.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-full [&:has([aria-selected])]:bg-superBG [&:has(>.day-range-start)]:rounded-l-full first:[&:has([aria-selected])]:rounded-l-full last:[&:has([aria-selected])]:rounded-r-full":"[&:has([aria-selected])]:rounded-md"),day:"size-8 p-0 font-normal select-none aria-selected:opacity-100 flex items-center justify-center rounded-full hover:bg-subtler cursor-pointer",day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:z(r.mode==="range"?"[&.day-range-start]:!bg-super [&.day-range-start]:!text-inverse [&.day-range-start]:hover:!bg-super [&.day-range-end]:!bg-super [&.day-range-end]:!text-inverse [&.day-range-end]:hover:!bg-super":"!bg-super !text-inverse hover:!bg-super"),day_today:"bg-superBG text-super hover:bg-superBG",day_outside:"day-outside text-quiet aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-quiet opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...z}),[r.mode]),a=f.useMemo(()=>({IconLeft:({className:o,...i})=>l.jsx(ye,{icon:D("chevron-left"),className:o,size:"sm",...i}),IconRight:({className:o,...i})=>l.jsx(ye,{icon:D("chevron-right"),className:o,size:"sm",...i})}),[]);return l.jsx(z_e,{showOutsideDays:n,className:z("p-3 font-sans text-base",t),classNames:s,components:a,...r})}),q_e=e=>e.toLocaleDateString(),mg=f.memo(function({value:t,onChange:n,placeholder:r="Select date",formatDate:s=q_e,showIcon:a=!0,buttonClassName:o,variant:i="default",trailingIcon:c,fromDate:u,endDate:d,allowPastDates:m=!1}){const[p,h]=f.useState(!1),g=f.useCallback(()=>{h(C=>!C)},[]),y=f.useCallback(C=>{n(C),h(!1)},[n]),b=f.useMemo(()=>{const C=new Date;return C.setHours(0,0,0,0),C},[]),x=(()=>{switch(i){case"subtle":return"bg-subtle";case"default":return"bg-subtler";default:St(i)}})(),_=f.useMemo(()=>m?d?{after:d}:void 0:{before:u??b,after:d},[m,d,u,b]),v=f.useMemo(()=>l.jsxs("div",{role:"button",tabIndex:0,onClick:g,className:z(x,"flex cursor-pointer items-center justify-between rounded-lg px-4 font-sans","hover:border-subtler focus:border-subtler border border-transparent","transition-colors duration-200 ease-out","h-10 w-full","outline-none focus:outline-none focus:ring-0",o),children:[l.jsxs("div",{className:"flex items-center gap-2",children:[a&&l.jsx(ut,{name:D("calendar"),size:16,className:"text-foreground"}),l.jsx("span",{className:"text-foreground text-sm",children:t?s(t):r})]}),c]}),[x,o,s,g,r,a,c,t]);return l.jsx("div",{className:"relative size-full",children:l.jsx(fa,{interaction:"click",open:p,onOpenChange:h,triggerElement:v,children:l.jsx(JF,{mode:"single",selected:t,onSelect:y,defaultMonth:t,disabled:_,fromDate:m?void 0:u??b})})})}),CT=e=>e?e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}):"",wT="border-subtler bg-subtler text-foreground focus:border-super !h-9 rounded-lg border px-3 py-1 text-sm focus:outline-none [&::-webkit-calendar-picker-indicator]:hidden [&::-webkit-inner-spin-button]:hidden [&::-webkit-outer-spin-button]:hidden bg-transparent",ST="data-[state=closed]:border-subtler data-[state=open]:border-super data-[state=open]:hover:border-super !px-3 !h-9 bg-transparent",$_e=f.memo(function({startDateTime:t,endDateTime:n,onStartDateChange:r,onEndDateChange:s,onStartTimeChange:a,onEndTimeChange:o}){const{$t:i}=Q(),c=f.useMemo(()=>t?new Date(t):void 0,[t]),u=f.useMemo(()=>n?new Date(n):void 0,[n]),d=f.useCallback(x=>{if(!x)return;const _=new Date(c||"");if(!isNaN(_.getTime())){if(_.setDate(x.getDate()),_.setMonth(x.getMonth()),_.setFullYear(x.getFullYear()),u&&u.getTime()<_.getTime()){const v=new Date(_.getTime());v.setHours(u.getHours()),v.setMinutes(u.getMinutes()),v.setSeconds(u.getSeconds()),s(v)}r(_)}},[c,u,r,s]),m=f.useCallback(x=>{if(!x)return;const _=new Date(u||"");isNaN(_.getTime())||(_.setDate(x.getDate()),_.setMonth(x.getMonth()),_.setFullYear(x.getFullYear()),c&&_<c&&r(_),s(_))},[c,u,r,s]),p=f.useCallback(x=>{a(x)},[a]),h=f.useCallback(x=>{if(!c)return;const[_,v]=x.split(":").map(Number);if(_===void 0||v===void 0)return;const C=new Date(c);isNaN(C.getTime())||(C.setHours(_),C.setMinutes(v),!isNaN(C.getTime())&&(u&&C.getTime()>u.getTime()&&s(C),r(C)))},[c,u,r,s]),g=f.useCallback(x=>{o(x)},[o]),y=f.useCallback(x=>{if(!u)return;const[_,v]=x.split(":").map(Number);if(_===void 0||v===void 0)return;const C=new Date(u);isNaN(C.getTime())||(C.setHours(_),C.setMinutes(v),!isNaN(C.getTime())&&(c&&C.getTime()<c.getTime()&&r(C),s(C)))},[c,u,r,s]),b=f.useCallback(x=>x.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),[]);return l.jsxs("div",{className:"flex flex-col items-center gap-2 md:flex-row",children:[l.jsxs("div",{className:"flex w-full items-center gap-2",children:[l.jsx(mg,{buttonClassName:ST,value:c,onChange:d,placeholder:i({defaultMessage:"Select start date",id:"oUUhTXC2Mx"}),formatDate:b,showIcon:!1}),l.jsx("input",{type:"time",value:CT(c),onChange:x=>p(x.target.value),onBlur:x=>h(x.target.value),className:wT})]}),l.jsx("span",{className:"text-quieter mx-1 text-sm",children:i({defaultMessage:"to",id:"NLeFGnA9M4"})}),l.jsxs("div",{className:"flex w-full items-center gap-2",children:[l.jsx("input",{type:"time",value:CT(u),onChange:x=>g(x.target.value),onBlur:x=>y(x.target.value),className:wT}),l.jsx(mg,{buttonClassName:ST,value:u,onChange:m,placeholder:i({defaultMessage:"Select end date",id:"0A4/NpHFx/"}),formatDate:b,showIcon:!1})]})]})});function W_e(e){if(!e)return null;try{let t=e;e.startsWith("RRULE:")&&(t=e.substring(6));const n={};for(const r of t.split(";"))if(r.includes("=")){const[s,a]=r.split("=",2);s&&a&&(n[s]=a)}return{freq:n.FREQ?.toUpperCase(),interval:n.INTERVAL?parseInt(n.INTERVAL,10):1,byDay:n.BYDAY?.split(","),byMonthDay:n.BYMONTHDAY,count:n.COUNT}}catch{return null}}function K_e(e){try{if(!e.freq)return null;let t=`RRULE:FREQ=${e.freq}`;return e.interval&&e.interval!==1&&(t+=`;INTERVAL=${e.interval}`),e.byDay&&e.byDay.length>0&&(t+=`;BYDAY=${e.byDay.join(",")}`),e.byMonthDay&&(t+=`;BYMONTHDAY=${e.byMonthDay}`),e.count&&(t+=`;COUNT=${e.count}`),t}catch{return null}}const B_=A.memo(function({id:t,label:n,extraCSS:r,options:s,activeKey:a,onOptionChange:o,isDisabled:i=!1,testId:c,defaultOption:u,icon:d,...m}){u&&(s=[{label:u,value:""}].concat(s||[]));const p=s||[],h=g=>{o(u&&g===""?null:g)};return l.jsxs("div",{children:[l.jsx(tE,{withMargin:!1,label:n}),l.jsx(B,{variant:"small",className:n&&"mt-sm",children:l.jsxs("div",{className:"relative flex items-center",children:[l.jsx("select",{"data-testid":c,id:t,onChange:g=>h(g.target.value),value:a??"",className:z("border-subtler bg-base p-sm pr-lg outline-super ring-subtler dark:border-subtle dark:bg-subtler dark:ring-subtle w-full appearance-none rounded border transition duration-300 focus:outline-none",{"cursor-pointer hover:ring-1":!i,"pl-lg":d},r),disabled:i,...m,children:p.map(g=>l.jsx("option",{value:g.value,className:"pl-sm",children:g.label},g.value))}),d&&l.jsx("div",{className:"left-sm absolute",children:d}),l.jsx(B,{color:"light",variant:"small",className:"right-sm pointer-events-none absolute",children:l.jsx(ye,{icon:D("chevron-down"),size:"md"})})]})})]})}),bp={frequency:"WEEKLY",endType:"never",interval:"1"},_p=Me({day:{id:"ruG8dNqKt0",defaultMessage:"{count, plural, one {Day} other {Days}}"},week:{id:"cR0w/cReH+",defaultMessage:"{count, plural, one {Week} other {Weeks}}"},month:{id:"svowrjAWNi",defaultMessage:"{count, plural, one {Month} other {Months}}"},year:{id:"OPfd4WaWUE",defaultMessage:"{count, plural, one {Year} other {Years}}"}}),Y_e=e=>[{label:e({defaultMessage:"Daily",id:"zxvhnETmn2"}),value:"DAILY"},{label:e({defaultMessage:"Weekly",id:"/clOBUs/wZ"}),value:"WEEKLY"},{label:e({defaultMessage:"Monthly",id:"wYsv4ZHu+B"}),value:"MONTHLY"},{label:e({defaultMessage:"Yearly",id:"dqD39hnoA/"}),value:"YEARLY"}],Q_e=e=>[{label:e({defaultMessage:"Never",id:"du1laW45Py"}),value:"never"},{label:e({defaultMessage:"After",id:"4X+U8o+ztO"}),value:"after"}],X_e=e=>[{label:e({defaultMessage:"Mo",id:"EIk6EqFZZN"}),value:"MO"},{label:e({defaultMessage:"Tu",id:"dswupo3WZd"}),value:"TU"},{label:e({defaultMessage:"We",id:"p02wWlGXK3"}),value:"WE"},{label:e({defaultMessage:"Th",id:"Ee4Ne0CnpN"}),value:"TH"},{label:e({defaultMessage:"Fr",id:"pCVXo8kVuW"}),value:"FR"},{label:e({defaultMessage:"Sa",id:"QJaSgEWRy1"}),value:"SA"},{label:e({defaultMessage:"Su",id:"n4xx4rvq9+"}),value:"SU"}],Z_e=e=>{if(!e.frequency||e.frequency==="WEEKLY"&&(!e.byDay||e.byDay.length===0))return!1;if(e.interval){const t=parseInt(e.interval,10);if(isNaN(t)||t<1)return!1}if(e.endType==="after"){if(!e.count)return!1;const t=parseInt(e.count,10);if(isNaN(t)||t<1)return!1}return!0},J_e=(e,t)=>({MO:t({defaultMessage:"Mon",id:"T8JZHei06V"}),TU:t({defaultMessage:"Tue",id:"C4ENlvYIEr"}),WE:t({defaultMessage:"Wed",id:"2NqUghZFW1"}),TH:t({defaultMessage:"Thu",id:"FC0AP4JIua"}),FR:t({defaultMessage:"Fri",id:"hFYE2MSlqH"}),SA:t({defaultMessage:"Sat",id:"3Hv4FbI9Kl"}),SU:t({defaultMessage:"Sun",id:"1Aday2s3it"})})[e]||e,eve=f.memo(function({value:t,onChange:n}){const{$t:r}=Q(),[s,a]=f.useState(!1),[o,i]=f.useState(bp);f.useEffect(()=>{if(ko(t)&&!s){const x=W_e(t[0]);x&&(i({...bp,frequency:x.freq,interval:x.interval?.toString()||"1",byDay:x.byDay,count:x.count,endType:x.count?"after":"never"}),a(!0))}},[t,s]);const c=f.useMemo(()=>Y_e(r),[r]),u=f.useMemo(()=>Q_e(r),[r]),d=f.useMemo(()=>X_e(r),[r]),m=parseInt(o.interval||"1",10),p={DAILY:r(_p.day,{count:m}),WEEKLY:r(_p.week,{count:m}),MONTHLY:r(_p.month,{count:m}),YEARLY:r(_p.year,{count:m})},h=x=>{if(Z_e(x)){const _=K_e({freq:x.frequency,interval:x.interval?parseInt(x.interval,10):1,byDay:x.byDay,count:x.endType==="after"?x.count:void 0});_&&n([_])}},g=x=>{const _={...o,...x};i(_),h(_)},y=x=>{const _=o.byDay||[],v=_.includes(x)?_.filter(w=>w!==x):[..._,x],C={...o,byDay:v};i(C),h(C)},b=()=>{a(!1),i(bp),n([])};return l.jsxs(Y,{className:"space-y-1 pl-1",children:[!s&&t.length===0&&l.jsx(Y,{className:"flex items-center justify-between pl-1",children:l.jsx(pt,{onClick:()=>{a(!0),i(bp)},noPadding:!0,variant:"noBackground",text:r({defaultMessage:"Repeat",id:"tw5j2+ZRIB"}),leadingComponent:l.jsx(ut,{name:D("plus"),size:16}),size:"tiny"})}),s&&l.jsxs(Y,{className:"flex flex-col gap-2 rounded",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-quieter whitespace-nowrap pr-1 text-xs",children:r({defaultMessage:"Every",id:"JE2YVbgaBx"})}),l.jsx(xs,{isMobileUserAgent:!1,min:1,max:99,type:"number",value:o.interval?.toString()||"1",onChange:x=>g({interval:x}),className:"focus:!border-super !w-16 rounded-lg !px-3 focus:!ring-transparent"}),l.jsx(B_,{id:"frequency-select",activeKey:o.frequency||"WEEKLY",options:c.map(x=>({...x,label:p[x.value]})),onOptionChange:x=>g({frequency:x}),extraCSS:"rounded-lg"}),l.jsx("span",{className:"text-quieter whitespace-nowrap pl-2 pr-1 text-xs",children:r({defaultMessage:"Ends",id:"04xGLEkMMo"})}),l.jsx(B_,{id:"end-type-select",activeKey:o.endType||"never",options:u,onOptionChange:x=>g({endType:x,count:x==="after"?"1":void 0}),extraCSS:"rounded-lg w-full"}),o.endType==="after"&&l.jsxs(l.Fragment,{children:[l.jsx(xs,{isMobileUserAgent:!1,min:1,max:99,type:"number",value:o.count||"1",onChange:x=>g({count:x}),className:"focus:!border-super !w-16 rounded-lg !px-3 focus:!ring-transparent"}),l.jsx("span",{className:"text-quieter pr-sm whitespace-nowrap text-xs",children:o.count==="1"?r({defaultMessage:"time",id:"nTBG1bRQLC"}):r({defaultMessage:"times",id:"KSQJ7UVwln"})})]}),l.jsx(st,{onClick:b,text:r({defaultMessage:"Cancel",id:"47FYwba+bI"}),variant:"common",extraCSS:"px-3 py-1 text-xs ml-auto"})]}),o.frequency==="WEEKLY"&&l.jsxs(Y,{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-quieter w-9 whitespace-nowrap text-xs",children:r({defaultMessage:"On",id:"Zh+5A6yahu"})}),l.jsx("div",{className:"flex gap-2",children:d.map(x=>l.jsx(st,{onClick:()=>y(x.value),text:x.label,size:"tiny",pill:!0,variant:o.byDay?.includes(x.value)?"inverted":"common",ariaLabel:r({defaultMessage:"Toggle {day}",id:"i/JqE0BlGw"},{day:J_e(x.value,r)}),noPadding:!0,extraCSS:"w-8 h-8 !p-0 !text-2xs"},x.value))})]})]})]})}),ET=Rl("inline-flex max-w-full items-center rounded-lg border text-sm transition-colors duration-150",{variants:{size:{default:"h-6 px-2",small:"h-5 px-1.5 text-xs"},selected:{false:"border-subtler bg-subtle",true:"border-super bg-subtle"},disabled:{false:"cursor-pointer",true:"cursor-default opacity-50"}},compoundVariants:[{selected:!1,disabled:!1,class:"hover:bg-subtler"},{selected:!0,disabled:!1,class:"hover:bg-subtler"}],defaultVariants:{size:"default",selected:!1,disabled:!1}});function tve({label:e,size:t="default",selected:n=!1,disabled:r=!1,onClick:s,onDelete:a,deleteAriaLabel:o,title:i,shouldAvoidFocusShift:c=!1}){const u=f.useCallback(h=>{s?.({shiftKey:h.shiftKey,metaKey:h.metaKey,ctrlKey:h.ctrlKey})},[s]),d=f.useCallback(()=>{a?.()},[a]),m=f.useCallback(h=>{c&&h.preventDefault()},[c]);return a&&!r?l.jsxs("div",{className:z(ET({size:t,selected:n,disabled:r}),"pr-1",!r&&["has-[:hover]:bg-subtler","has-[:first-child:focus-visible]:outline has-[:first-child:focus-visible]:outline-2 has-[:first-child:focus-visible]:outline-offset-2 has-[:first-child:focus-visible]:outline-super/80"]),title:i,children:[l.jsx(Ls,{className:"truncate focus-visible:outline-none",onClick:r?void 0:u,onMouseDown:m,disabled:r,children:e}),l.jsx(wn,{content:o,children:l.jsx(Ls,{"aria-label":o,onClick:d,onMouseDown:m,className:"ml-1 -mr-0.5 rounded text-quiet transition-colors duration-150 hover:bg-subtler hover:text-foreground",children:l.jsx(_n,{icon:D("x"),size:"tiny"})})})]}):l.jsx(Ls,{className:ET({size:t,selected:n,disabled:r}),onClick:r?void 0:u,onMouseDown:m,disabled:r,title:i,children:l.jsx("span",{className:"truncate",children:e})})}var kT=1,nve=.9,rve=.8,sve=.17,C1=.1,w1=.999,ave=.9999,ove=.99,ive=/[\\\/_+.#"@\[\(\{&]/,lve=/[\\\/_+.#"@\[\(\{&]/g,cve=/[\s-]/,eU=/[\s-]/g;function H_(e,t,n,r,s,a,o){if(a===t.length)return s===e.length?kT:ove;var i=`${s},${a}`;if(o[i]!==void 0)return o[i];for(var c=r.charAt(a),u=n.indexOf(c,s),d=0,m,p,h,g;u>=0;)m=H_(e,t,n,r,u+1,a+1,o),m>d&&(u===s?m*=kT:ive.test(e.charAt(u-1))?(m*=rve,h=e.slice(s,u-1).match(lve),h&&s>0&&(m*=Math.pow(w1,h.length))):cve.test(e.charAt(u-1))?(m*=nve,g=e.slice(s,u-1).match(eU),g&&s>0&&(m*=Math.pow(w1,g.length))):(m*=sve,s>0&&(m*=Math.pow(w1,u-s))),e.charAt(u)!==t.charAt(a)&&(m*=ave)),(m<C1&&n.charAt(u-1)===r.charAt(a+1)||r.charAt(a+1)===r.charAt(a)&&n.charAt(u-1)!==r.charAt(a))&&(p=H_(e,t,n,r,u+1,a+2,o),p*C1>m&&(m=p*C1)),m>d&&(d=m),u=n.indexOf(c,u+1);return o[i]=d,d}function MT(e){return e.toLowerCase().replace(eU," ")}function uve(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,H_(e,t,MT(e),MT(t),0,0,{})}var dd='[cmdk-group=""]',S1='[cmdk-group-items=""]',dve='[cmdk-group-heading=""]',tU='[cmdk-item=""]',TT=`${tU}:not([aria-disabled="true"])`,V_="cmdk-item-select",mc="data-value",fve=(e,t,n)=>uve(e,t,n),nU=f.createContext(void 0),xm=()=>f.useContext(nU),rU=f.createContext(void 0),QE=()=>f.useContext(rU),sU=f.createContext(void 0),aU=f.forwardRef((e,t)=>{let n=pc(()=>{var q,U;return{search:"",value:(U=(q=e.value)!=null?q:e.defaultValue)!=null?U:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),r=pc(()=>new Set),s=pc(()=>new Map),a=pc(()=>new Map),o=pc(()=>new Set),i=oU(e),{label:c,children:u,value:d,onValueChange:m,filter:p,shouldFilter:h,loop:g,disablePointerSelection:y=!1,vimBindings:b=!0,...x}=e,_=ri(),v=ri(),C=ri(),w=f.useRef(null),S=wve();bl(()=>{if(d!==void 0){let q=d.trim();n.current.value=q,E.emit()}},[d]),bl(()=>{S(6,O)},[]);let E=f.useMemo(()=>({subscribe:q=>(o.current.add(q),()=>o.current.delete(q)),snapshot:()=>n.current,setState:(q,U,X)=>{var J,ne,ae,de;if(!Object.is(n.current[q],U)){if(n.current[q]=U,q==="search")P(),M(),S(1,N);else if(q==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let oe=document.getElementById(C);oe?oe.focus():(J=document.getElementById(_))==null||J.focus()}if(S(7,()=>{var oe;n.current.selectedItemId=(oe=L())==null?void 0:oe.id,E.emit()}),X||S(5,O),((ne=i.current)==null?void 0:ne.value)!==void 0){let oe=U??"";(de=(ae=i.current).onValueChange)==null||de.call(ae,oe);return}}E.emit()}},emit:()=>{o.current.forEach(q=>q())}}),[]),T=f.useMemo(()=>({value:(q,U,X)=>{var J;U!==((J=a.current.get(q))==null?void 0:J.value)&&(a.current.set(q,{value:U,keywords:X}),n.current.filtered.items.set(q,k(U,X)),S(2,()=>{M(),E.emit()}))},item:(q,U)=>(r.current.add(q),U&&(s.current.has(U)?s.current.get(U).add(q):s.current.set(U,new Set([q]))),S(3,()=>{P(),M(),n.current.value||N(),E.emit()}),()=>{a.current.delete(q),r.current.delete(q),n.current.filtered.items.delete(q);let X=L();S(4,()=>{P(),X?.getAttribute("id")===q&&N(),E.emit()})}),group:q=>(s.current.has(q)||s.current.set(q,new Set),()=>{a.current.delete(q),s.current.delete(q)}),filter:()=>i.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>i.current.disablePointerSelection,listId:_,inputId:C,labelId:v,listInnerRef:w}),[]);function k(q,U){var X,J;let ne=(J=(X=i.current)==null?void 0:X.filter)!=null?J:fve;return q?ne(q,n.current.search,U):0}function M(){if(!n.current.search||i.current.shouldFilter===!1)return;let q=n.current.filtered.items,U=[];n.current.filtered.groups.forEach(J=>{let ne=s.current.get(J),ae=0;ne.forEach(de=>{let oe=q.get(de);ae=Math.max(oe,ae)}),U.push([J,ae])});let X=w.current;H().sort((J,ne)=>{var ae,de;let oe=J.getAttribute("id"),le=ne.getAttribute("id");return((ae=q.get(le))!=null?ae:0)-((de=q.get(oe))!=null?de:0)}).forEach(J=>{let ne=J.closest(S1);ne?ne.appendChild(J.parentElement===ne?J:J.closest(`${S1} > *`)):X.appendChild(J.parentElement===X?J:J.closest(`${S1} > *`))}),U.sort((J,ne)=>ne[1]-J[1]).forEach(J=>{var ne;let ae=(ne=w.current)==null?void 0:ne.querySelector(`${dd}[${mc}="${encodeURIComponent(J[0])}"]`);ae?.parentElement.appendChild(ae)})}function N(){let q=H().find(X=>X.getAttribute("aria-disabled")!=="true"),U=q?.getAttribute(mc);E.setState("value",U||void 0)}function P(){var q,U,X,J;if(!n.current.search||i.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let ne=0;for(let ae of r.current){let de=(U=(q=a.current.get(ae))==null?void 0:q.value)!=null?U:"",oe=(J=(X=a.current.get(ae))==null?void 0:X.keywords)!=null?J:[],le=k(de,oe);n.current.filtered.items.set(ae,le),le>0&&ne++}for(let[ae,de]of s.current)for(let oe of de)if(n.current.filtered.items.get(oe)>0){n.current.filtered.groups.add(ae);break}n.current.filtered.count=ne}function O(){var q,U,X;let J=L();J&&(((q=J.parentElement)==null?void 0:q.firstChild)===J&&((X=(U=J.closest(dd))==null?void 0:U.querySelector(dve))==null||X.scrollIntoView({block:"nearest"})),J.scrollIntoView({block:"nearest"}))}function L(){var q;return(q=w.current)==null?void 0:q.querySelector(`${tU}[aria-selected="true"]`)}function H(){var q;return Array.from(((q=w.current)==null?void 0:q.querySelectorAll(TT))||[])}function R(q){let U=H()[q];U&&E.setState("value",U.getAttribute(mc))}function I(q){var U;let X=L(),J=H(),ne=J.findIndex(de=>de===X),ae=J[ne+q];(U=i.current)!=null&&U.loop&&(ae=ne+q<0?J[J.length-1]:ne+q===J.length?J[0]:J[ne+q]),ae&&E.setState("value",ae.getAttribute(mc))}function F(q){let U=L(),X=U?.closest(dd),J;for(;X&&!J;)X=q>0?vve(X,dd):Cve(X,dd),J=X?.querySelector(TT);J?E.setState("value",J.getAttribute(mc)):I(q)}let G=()=>R(H().length-1),j=q=>{q.preventDefault(),q.metaKey?G():q.altKey?F(1):I(1)},$=q=>{q.preventDefault(),q.metaKey?R(0):q.altKey?F(-1):I(-1)};return f.createElement(Hn.div,{ref:t,tabIndex:-1,...x,"cmdk-root":"",onKeyDown:q=>{var U;(U=x.onKeyDown)==null||U.call(x,q);let X=q.nativeEvent.isComposing||q.keyCode===229;if(!(q.defaultPrevented||X))switch(q.key){case"n":case"j":{b&&q.ctrlKey&&j(q);break}case"ArrowDown":{j(q);break}case"p":case"k":{b&&q.ctrlKey&&$(q);break}case"ArrowUp":{$(q);break}case"Home":{q.preventDefault(),R(0);break}case"End":{q.preventDefault(),G();break}case"Enter":{q.preventDefault();let J=L();if(J){let ne=new Event(V_);J.dispatchEvent(ne)}}}}},f.createElement("label",{"cmdk-label":"",htmlFor:T.inputId,id:T.labelId,style:Eve},c),xy(e,q=>f.createElement(rU.Provider,{value:E},f.createElement(nU.Provider,{value:T},q))))}),mve=f.forwardRef((e,t)=>{var n,r;let s=ri(),a=f.useRef(null),o=f.useContext(sU),i=xm(),c=oU(e),u=(r=(n=c.current)==null?void 0:n.forceMount)!=null?r:o?.forceMount;bl(()=>{if(!u)return i.item(s,o?.id)},[u]);let d=iU(s,a,[e.value,e.children,a],e.keywords),m=QE(),p=bi(S=>S.value&&S.value===d.current),h=bi(S=>u||i.filter()===!1?!0:S.search?S.filtered.items.get(s)>0:!0);f.useEffect(()=>{let S=a.current;if(!(!S||e.disabled))return S.addEventListener(V_,g),()=>S.removeEventListener(V_,g)},[h,e.onSelect,e.disabled]);function g(){var S,E;y(),(E=(S=c.current).onSelect)==null||E.call(S,d.current)}function y(){m.setState("value",d.current,!0)}if(!h)return null;let{disabled:b,value:x,onSelect:_,forceMount:v,keywords:C,...w}=e;return f.createElement(Hn.div,{ref:of(a,t),...w,id:s,"cmdk-item":"",role:"option","aria-disabled":!!b,"aria-selected":!!p,"data-disabled":!!b,"data-selected":!!p,onPointerMove:b||i.getDisablePointerSelection()?void 0:y,onClick:b?void 0:g},e.children)}),pve=f.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:s,...a}=e,o=ri(),i=f.useRef(null),c=f.useRef(null),u=ri(),d=xm(),m=bi(h=>s||d.filter()===!1?!0:h.search?h.filtered.groups.has(o):!0);bl(()=>d.group(o),[]),iU(o,i,[e.value,e.heading,c]);let p=f.useMemo(()=>({id:o,forceMount:s}),[s]);return f.createElement(Hn.div,{ref:of(i,t),...a,"cmdk-group":"",role:"presentation",hidden:m?void 0:!0},n&&f.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:u},n),xy(e,h=>f.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?u:void 0},f.createElement(sU.Provider,{value:p},h))))}),hve=f.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,s=f.useRef(null),a=bi(o=>!o.search);return!n&&!a?null:f.createElement(Hn.div,{ref:of(s,t),...r,"cmdk-separator":"",role:"separator"})}),gve=f.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,s=e.value!=null,a=QE(),o=bi(u=>u.search),i=bi(u=>u.selectedItemId),c=xm();return f.useEffect(()=>{e.value!=null&&a.setState("search",e.value)},[e.value]),f.createElement(Hn.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":i,id:c.inputId,type:"text",value:s?e.value:o,onChange:u=>{s||a.setState("search",u.target.value),n?.(u.target.value)}})}),yve=f.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...s}=e,a=f.useRef(null),o=f.useRef(null),i=bi(u=>u.selectedItemId),c=xm();return f.useEffect(()=>{if(o.current&&a.current){let u=o.current,d=a.current,m,p=new ResizeObserver(()=>{m=requestAnimationFrame(()=>{let h=u.offsetHeight;d.style.setProperty("--cmdk-list-height",h.toFixed(1)+"px")})});return p.observe(u),()=>{cancelAnimationFrame(m),p.unobserve(u)}}},[]),f.createElement(Hn.div,{ref:of(a,t),...s,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":i,"aria-label":r,id:c.listId},xy(e,u=>f.createElement("div",{ref:of(o,c.listInnerRef),"cmdk-list-sizer":""},u)))}),xve=f.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:s,contentClassName:a,container:o,...i}=e;return f.createElement(MW,{open:n,onOpenChange:r},f.createElement(TW,{container:o},f.createElement(AW,{"cmdk-overlay":"",className:s}),f.createElement(NW,{"aria-label":e.label,"cmdk-dialog":"",className:a},f.createElement(aU,{ref:t,...i}))))}),bve=f.forwardRef((e,t)=>bi(n=>n.filtered.count===0)?f.createElement(Hn.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),_ve=f.forwardRef((e,t)=>{let{progress:n,children:r,label:s="Loading...",...a}=e;return f.createElement(Hn.div,{ref:t,...a,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":s},xy(e,o=>f.createElement("div",{"aria-hidden":!0},o)))}),bm=Object.assign(aU,{List:yve,Item:mve,Input:gve,Group:pve,Separator:hve,Dialog:xve,Empty:bve,Loading:_ve});function vve(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function Cve(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function oU(e){let t=f.useRef(e);return bl(()=>{t.current=e}),t}var bl=typeof window>"u"?f.useEffect:f.useLayoutEffect;function pc(e){let t=f.useRef();return t.current===void 0&&(t.current=e()),t}function bi(e){let t=QE(),n=()=>e(t.snapshot());return f.useSyncExternalStore(t.subscribe,n,n)}function iU(e,t,n,r=[]){let s=f.useRef(),a=xm();return bl(()=>{var o;let i=(()=>{var u;for(let d of n){if(typeof d=="string")return d.trim();if(typeof d=="object"&&"current"in d)return d.current?(u=d.current.textContent)==null?void 0:u.trim():s.current}})(),c=r.map(u=>u.trim());a.value(e,i,c),(o=t.current)==null||o.setAttribute(mc,i),s.current=i}),s}var wve=()=>{let[e,t]=f.useState(),n=pc(()=>new Map);return bl(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,s)=>{n.current.set(r,s),t({})}};function Sve(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function xy({asChild:e,children:t},n){return e&&f.isValidElement(t)?f.cloneElement(Sve(t),{ref:t.ref},n(t.props.children)):n(t)}var Eve={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const lU={xs:12,sm:14,md:16,lg:20},kve={xs:"[&_input]:pr-sm [&_input]:pl-7",sm:"[&_input]:pr-sm [&_input]:pl-[30px]",md:"[&_input]:pr-sm [&_input]:pl-8",lg:"[&_input]:pr-sm [&_input]:pl-9"};function cU({options:e,value:t,onValueChange:n,placement:r="bottom-start",keepDraftValue:s=!1}){const[a,o]=f.useState(!1),[i,c]=f.useState(void 0),[u,d]=f.useState(!1),m=f.useRef(null),p=i===void 0,{refs:h,floatingStyles:g}=RW({open:a,placement:r,strategy:"fixed",middleware:[S$(4),E$({padding:8,fallbackAxisSideDirection:"start"}),k$({padding:8}),M$({padding:8,apply({availableHeight:k,rects:M,elements:N}){N.floating.style.maxHeight=`${Math.min(k,300)}px`,N.floating.style.width=`${M.reference.width}px`}})],whileElementsMounted:w$}),y=f.useCallback(()=>{const k=e.find(M=>M.value===t);return k?k.label:""},[t,e]),b=f.useCallback(()=>{o(!1),s||c(void 0),m.current?.blur()},[s]);f.useEffect(()=>{if(!a)return;const k=M=>{const N=h.reference.current,P=h.floating.current,O=M.target,L=N&&"contains"in N&&!N.contains(O),H=P&&"contains"in P&&!P.contains(O);L&&H&&b()};return document.addEventListener("mousedown",k),()=>{document.removeEventListener("mousedown",k)}},[a,h,b]);const x=f.useCallback(k=>{c(k),k===""&&n?.(""),a||o(!0)},[a,n]),_=f.useCallback(()=>{o(!0),d(!0),s||(c(void 0),queueMicrotask(()=>{m.current?.select()}))},[s]),v=f.useCallback(k=>{d(!1)},[]),C=f.useCallback(k=>{n?.(k),c(void 0),o(!1),m.current?.blur()},[n]),w=y(),S=f.useMemo(()=>u?i===void 0?w:i:i??w,[u,w,i]),E=f.useMemo(()=>({...g,position:g.position,zIndex:50}),[g]),T=f.useMemo(()=>({width:"100%"}),[]);return f.useMemo(()=>({isOpen:a,draft:i,isPristine:p,isFocused:u,displayValue:S,inputRef:m,refs:h,listWrapperStyles:T,floatingListStyles:E,onInputChange:x,onFocus:_,onBlur:v,onSelect:C}),[a,i,p,u,S,m,h,T,E,x,_,v,C])}const uU=f.memo(function({children:t,loop:n=!0,filter:r,shouldFilter:s=!0}){return l.jsx(bm,{loop:n,filter:r,shouldFilter:s,children:t})}),G_=f.memo(function({value:t,onValueChange:n,onFocus:r,onBlur:s,onPaste:a,onKeyDown:o,placeholder:i,size:c="md",colorVariant:u="default",noRounded:d=!1,disabled:m,autoFocus:p,ref:h,horizontalSpacing:g,verticalSpacing:y}){const b={subtle:"bg-subtle",default:"bg-base dark:bg-subtler",borderless:"bg-transparent focus:!ring-0!border-0 !bg-transparent !px-0 focus:!ring-0 !border-0"},x={xs:"text-xs placeholder:text-xs",sm:"text-sm placeholder:text-sm",md:"text-sm placeholder:text-sm",lg:"text-lg placeholder:text-base"},_={none:"",xs:"px-xs",sm:"px-sm",md:"px-md",lg:"px-lg",xl:"px-xl"},v={none:"",xs:"py-xs",sm:"py-sm",md:"py-md",lg:"py-lg",xl:"py-xl"},C={xs:"sm",sm:"sm",md:"md",lg:"xl"},w={xs:"xs",sm:"sm",md:"sm",lg:"lg"},S=_[g??C[c]],E=v[y??w[c]];return l.jsx(bm.Input,{ref:h,value:t,onValueChange:n,onFocus:r,onBlur:s,onPaste:a,onKeyDown:o,placeholder:i,disabled:m,autoFocus:p,className:z("focus:ring-subtler w-full font-sans outline-none focus:outline-none","text-foreground caret-super selection:bg-super/50","border-subtler placeholder-quieter border focus:ring-1","transition-all duration-200",!d&&"rounded-lg",b[u],x[c],S,E,m&&"cursor-not-allowed opacity-50")})}),Mve=f.memo(function({icon:t,size:n=16}){return l.jsx("div",{className:z("pointer-events-none left-2 top-1/2 -translate-y-1/2","absolute"),children:l.jsx(ut,{name:t,size:n,className:"text-quieter"})})}),dU=f.memo(function({children:t,style:n}){return l.jsx(bm.List,{className:z("z-50","max-h-[300px] overflow-y-auto","border-subtler shadow-overlay rounded-xl border","bg-base p-xs","flex flex-col gap-px"),style:n,children:t})}),fU=f.memo(function({value:t,onSelect:n,selected:r,disabled:s,children:a,size:o="md",ref:i}){const c={xs:"text-xs py-1 px-xs",sm:"text-sm py-1 px-sm",md:"text-sm py-1.5 px-sm",lg:"text-base py-2 px-md"};return l.jsx(bm.Item,{value:t,onSelect:n,disabled:s,ref:i,className:z("relative select-none rounded-lg transition-all duration-300",c[o],{"hover:bg-subtler cursor-pointer":!s,"cursor-not-allowed":s,"aria-selected:bg-subtler":!0},s&&"opacity-50"),children:l.jsx("span",{className:z({"text-super":r}),children:a})})}),mU=f.memo(function({children:t,size:n="md"}){const r={xs:"text-xs py-2",sm:"text-sm py-2.5",md:"text-sm py-3",lg:"text-base py-3.5"};return l.jsx(bm.Empty,{className:z("text-quieter text-center",r[n]),children:t})}),Tve=f.memo(function({option:t,value:n,disabled:r,size:s="md",onSelect:a}){const o=f.useCallback(()=>{a(t.value)},[a,t.value]),i=t.icon;return l.jsx(fU,{value:t.label,onSelect:o,selected:n===t.value,disabled:r,size:s,children:i?l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ut,{name:i,size:lU[s]}),l.jsx("span",{children:t.label})]}):t.label})}),QYe=f.memo(function({options:t,placeholder:n,value:r,onValueChange:s,filter:a,emptyMessage:o,placement:i="bottom-start",referenceRef:c,keepDraftValue:u=!1,size:d="md",colorVariant:m="default",noRounded:p=!1,horizontalSpacing:h,verticalSpacing:g,disabled:y=!1,autoFocus:b=!1}){const x=cU({options:t,value:r,onValueChange:s,placement:i,keepDraftValue:u}),{isOpen:_,displayValue:v,inputRef:C,refs:w,onInputChange:S,onFocus:E,onSelect:T,listWrapperStyles:k,floatingListStyles:M}=x,P=f.useMemo(()=>t.find(L=>L.value===r),[t,r])?.icon;f.useEffect(()=>{c?.current&&x.refs.setReference(c.current)},[c,x.refs]);const O=f.useCallback(L=>{c||x.refs.setReference(L)},[c,x.refs]);return l.jsx("div",{ref:O,className:"relative",children:l.jsxs(uU,{filter:a,shouldFilter:!x.isFocused||!x.isPristine||(x.draft?.length??0)>0,children:[P?l.jsxs("div",{className:"relative",children:[l.jsx(Mve,{icon:P,size:lU[d]}),l.jsx("div",{className:kve[d],children:l.jsx(G_,{ref:C,value:v,onValueChange:S,onFocus:E,onBlur:x.onBlur,placeholder:n,size:d,horizontalSpacing:"none",verticalSpacing:g,colorVariant:m,noRounded:p,disabled:y,autoFocus:b})})]}):l.jsx(G_,{ref:C,value:v,onValueChange:S,onFocus:E,onBlur:x.onBlur,placeholder:n,size:d,horizontalSpacing:h,verticalSpacing:g,colorVariant:m,noRounded:p,disabled:y,autoFocus:b}),_&&l.jsx("div",{ref:w.setFloating,style:M,children:l.jsxs(dU,{style:k,children:[l.jsx(mU,{size:d,children:o}),t.map(L=>l.jsx(Tve,{option:L,value:r,disabled:y,size:d,onSelect:T},L.value))]})})]})})});function Ave(e,t=!0){const n=f.useRef(null);return f.useEffect(()=>{if(!t)return;const r=s=>{n.current&&!n.current.contains(s.target)&&e()};return document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}},[t,e]),n}const Nve=async(e,t)=>{if(!t){await z_(e);return}try{const n=new Blob([t],{type:"text/html"}),r=new Blob([e],{type:"text/plain"});await navigator.clipboard.write([new ClipboardItem({"text/html":n,"text/plain":r})])}catch{await z_(e)}},z_=async e=>{try{await navigator.clipboard.writeText(e)}catch{const t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}},Rve=A.memo(function({chip:t,selected:n,disabled:r,onDelete:s,onClick:a}){const{$t:o}=Q(),i=f.useCallback(()=>{s(t.value)},[s,t.value]),c=f.useCallback(d=>{a(t.value,d)},[a,t.value]),u=o({defaultMessage:"Remove",id:"G/yZLul6P1"});return l.jsx(tve,{label:t.label,selected:n,title:t.value,onDelete:i,onClick:c,disabled:r,deleteAriaLabel:u,shouldAvoidFocusShift:!0})});function Dve({option:e,draft:t,onSelect:n,renderSuggestion:r}){const s=f.useCallback(()=>{n(e.value)},[n,e.value]);return l.jsx(fU,{value:e.value,onSelect:s,selected:t===e.value,children:r?.(e.item)})}function Ive({suggestions:e,draft:t,onSelect:n,renderSuggestion:r,referenceElement:s,onValueChange:a}){const o=e?.map(c=>({value:c.value,label:c.key}))||[],i=cU({options:o,value:t,onValueChange:a});return f.useEffect(()=>{s&&i.refs.setReference(s)},[s,i.refs]),l.jsx(DW,{children:l.jsx("div",{ref:i.refs.setFloating,style:i.floatingListStyles,children:l.jsxs(dU,{style:i.listWrapperStyles,children:[l.jsx(mU,{children:"No results found"}),e.map(c=>l.jsx(Dve,{option:c,draft:t,onSelect:n,renderSuggestion:r},c.key))]})})})}function jve({chips:e,limit:t=1/0,onAdd:n,onDelete:r,validator:s,placeholder:a,disabled:o=!1,testId:i,children:c,className:u,placeholderOnFocusOnly:d=!1,onDraftChange:m,suggestions:p,renderSuggestion:h}){const[g,y]=f.useState(""),[b,x]=f.useState(!1),[_,v]=f.useState([]),C=f.useRef(null),w=Ave(()=>{v([])}),S=f.useCallback(R=>{y(R),m?.(R)},[m]),E=f.useCallback(R=>{const I=(R??g).trim();if(I===""||e.find(G=>G.value===I))return!1;if(s){const G=s(I);if(typeof G=="string"||!G)return!1}const F=p?.find(G=>G.value===I);return y(""),n([I],F?[F.item]:void 0),!0},[g,n,e,s,p]);f.useEffect(()=>{_.length>0&&w.current&&w.current.focus()},[_,w]);const T=f.useCallback(R=>{if((R.metaKey||R.ctrlKey)&&R.key==="a"&&g){R.stopPropagation();return}if(R.key==="Enter"||R.key==="Tab"||R.key===" "||R.key===","||R.key===";"){if(!E())return;R.preventDefault(),x(!0);return}if(R.key==="Escape"){y(""),x(!1);return}if(R.key==="Backspace"){if(_.length>0)return;if(!g&&!_.length){R.stopPropagation(),R.preventDefault();const I=e[e.length-1];I&&v([I.value]),x(!1)}return}if((R.key==="ArrowLeft"||R.key==="ArrowRight")&&!g){if(R.preventDefault(),R.stopPropagation(),R.key==="ArrowLeft"&&e.length>0){const I=e[e.length-1];I&&(v([I.value]),x(!1))}return}},[E,_,g,e]),k=f.useCallback(R=>{r([R]),v(I=>I.filter(F=>F!==R)),x(!0)},[r]),M=f.useCallback((R,I)=>{v(F=>{const G=I.shiftKey,j=I.metaKey,$=I.ctrlKey;return j||$?F.includes(R)?F.filter(q=>q!==R):[...F,R]:G?F.includes(R)?F:[...F,R]:F.includes(R)?F.filter(q=>q!==R):[R]})},[]),N=f.useCallback(()=>{g.trim()!==""&&!E()||x(!1)},[g,E]),P=f.useCallback(()=>{z_(_.join(","))},[_]),O=f.useCallback(R=>{const{metaKey:I,ctrlKey:F,key:G}=R;if((I||F)&&G==="a"){if(b&&g)return;R.preventDefault(),v(e.map(j=>j.value)),b&&x(!1);return}if((I||F)&&G==="c"&&_.length>0){R.preventDefault(),P();return}if((I||F)&&G==="x"&&_.length>0){R.preventDefault(),P();const j=[..._];v([]),r(j),x(!0);return}if(G==="Backspace"&&_.length>0&&!g){R.preventDefault();const j=[..._];v([]),r(j),x(!0);return}if(G==="ArrowLeft"||G==="ArrowRight"){if(document.activeElement===C.current?.element())return;R.preventDefault();const $=G==="ArrowLeft",q=G==="ArrowRight",U=X=>{const J=e[X];J&&v([J.value])};if(_.length===0)e.length>0&&U($?e.length-1:0);else{const X=_.map(J=>e.findIndex(ne=>ne.value===J)).filter(J=>J!==-1).sort((J,ne)=>J-ne);if(X.length>0){const J=$?X[0]:X[X.length-1];if(J!==void 0)if(q&&J===e.length-1)v([]),x(!0);else{const ne=$?Math.max(0,J-1):Math.min(e.length-1,J+1);U(ne)}}}return}},[_,r,e,b,g,P]),L=f.useCallback(R=>{const F=R.clipboardData.getData("text").split(/[,;\n\t]+/).map(G=>G.trim()).filter(Boolean);if(F.length>1){const G=[],j=[];if(F.forEach($=>{if(s){if(s($)===!0){G.push($);const U=p?.find(X=>X.value===$);U&&j.push(U.item)}}else{G.push($);const q=p?.find(U=>U.value===$);q&&j.push(q.item)}}),G.length>0)R.preventDefault(),R.stopPropagation(),n(G,j.length>0?j:void 0);else return}},[s,n,p]),H=f.useCallback(R=>{E(R)||y(""),queueMicrotask(()=>{C.current?.focus()})},[E]);return l.jsxs("div",{ref:w,tabIndex:0,className:z("flex min-h-10 w-full flex-row flex-wrap items-center gap-1 py-2 focus:outline-none",u),"data-test-id":i,onKeyDown:O,onPointerDown:R=>{b&&R.target===w.current&&R.preventDefault()},onClick:R=>{b||(R.stopPropagation(),R.preventDefault(),!o&&e.length<t&&(v([]),x(!0)))},children:[e.map(R=>l.jsx(Rve,{chip:R,selected:_.includes(R.value),disabled:o,onDelete:k,onClick:M},R.value)),!o&&e.length<t&&(d?b:b||e.length===0)&&l.jsx("div",{className:"min-w-40 flex-1",children:l.jsxs(uU,{shouldFilter:!1,children:[l.jsx(G_,{autoFocus:!0,noRounded:!0,colorVariant:"borderless",verticalSpacing:"none",ref:C,value:g,onValueChange:S,placeholder:a,onBlur:N,onKeyDown:T,onPaste:L}),p&&p.length>0&&g.trim()&&l.jsx(Ive,{suggestions:p,draft:g,onSelect:H,renderSuggestion:h,referenceElement:w.current,onValueChange:S})]})}),c]})}const pU=A.memo(jve);function Pve(e){const t=e.display_name?.trim(),n=e.email;return t||n}function Ove(e){if(!e?.solution?.name)return"none";const t=e.solution.name.toLowerCase();return t.includes("zoom")?na.ZOOM:t.includes("teams")?na.MICROSOFT_TEAMS:t.includes("meet")||t.includes("google")?na.GOOGLE_MEET:"none"}function Lve(e){return e.filter(t=>t.email).map(t=>({label:Pve(t),value:t.email}))}const AT=f.memo(function({event:t,newEvent:n,onEventChange:r,isEditable:s=!0,truncateAttendees:a,noWrapper:o=!1,action:i}){const{$t:c}=Q(),[u,d]=f.useState({event_id:t.event_id,title:t.title,start_date_time:t.start_date_time,end_date_time:t.end_date_time,attendees:t.attendees?.map(H=>({email:H.email,optional:H.optional,display_name:H.display_name,photo_url:H.photo_url})),organizer:t.organizer,description:t.description,location:t.location,link:t.link,calendar_color:t.calendar_color,event_color:t.event_color,conference_data:t.conference_data,creator:t.creator,html_description:t.html_description,is_all_day:t.is_all_day,recurrence:t.recurrence?.map(H=>H.toString())}),m=f.useRef(null),{suggestions:p,handleDraftChange:h}=DF({reason:"calendar_event"}),{connectors:g}=ga({reason:"calendar-event-video-conferencing"}),y=f.useMemo(()=>{const H=g?.connectors??[];return{hasGoogleMeet:H.some(R=>R.connection_type===$r.GCAL&&R.connected),hasZoom:H.some(R=>R.connection_type===$r.ZOOM&&R.connected),hasTeams:H.some(R=>R.connection_type===$r.OUTLOOK&&R.connected)}},[g?.connectors]);f.useEffect(()=>{r?.(u)},[u,r]);const b=f.useCallback(H=>{H&&d(R=>({...R,start_date_time:H.toISOString()}))},[]),x=f.useCallback(H=>{H&&d(R=>({...R,end_date_time:H.toISOString()}))},[]),_=f.useCallback(H=>{d(R=>{const I=new Date(R.start_date_time||""),[F,G]=H.split(":").map(Number);return F===void 0||G===void 0||(I.setHours(F),I.setMinutes(G),isNaN(I.getTime()))?R:{...R,start_date_time:I.toISOString()}})},[]),v=f.useCallback(H=>{d(R=>{const I=new Date(R.end_date_time||""),[F,G]=H.split(":").map(Number);return F===void 0||G===void 0||(I.setHours(F),I.setMinutes(G),isNaN(I.getTime()))?R:{...R,end_date_time:I.toISOString()}})},[]),C=({action:H,email:R,newEmail:I,displayName:F,photoUrl:G})=>{d(j=>{const $=[...j.attendees||[]];switch(H){case"add":$.some(q=>q.email===R)||$.push({email:R,display_name:F,photo_url:G});break;case"delete":return{...j,attendees:$.filter(q=>q.email!==R)};case"edit":return{...j,attendees:$.map(q=>q.email===R?{...q,email:I}:q)}}return{...j,attendees:$}})},w=kF(t?.calendar_color?.background??"#AC725E"),S=MF(w),E=f.useCallback(H=>d(R=>({...R,title:H})),[]),T=f.useCallback((H,R)=>{const I=Cq(R,"email");H.forEach(F=>{const G=I[F];C({action:"add",email:F,displayName:G?.name,photoUrl:G?.image||void 0})})},[]),k=f.useCallback(H=>{H.forEach(R=>C({action:"delete",email:R}))},[]),M=f.useCallback(H=>d(R=>({...R,location:H})),[]),N=f.useCallback(H=>{d(R=>({...R,recurrence:H}))},[]),P=f.useCallback(H=>{let R;H===na.GOOGLE_MEET?R={entry_points:[],solution:{name:"Google Meet",key_type:"hangoutsMeet"}}:H===na.ZOOM?R={entry_points:[],solution:{name:"Zoom",key_type:"zoom"}}:H===na.MICROSOFT_TEAMS?R={entry_points:[],solution:{name:"Microsoft Teams",key_type:"teams"}}:R=void 0,d(I=>({...I,conference_data:R}))},[]),O=f.useCallback(H=>l.jsx(RF,{contact:H}),[]),L=f.useMemo(()=>{const H=[];return y.hasGoogleMeet&&H.push({label:c({defaultMessage:"Google Meet",id:"crZ+Bimh7N"}),value:na.GOOGLE_MEET}),y.hasZoom&&H.push({label:c({defaultMessage:"Zoom",id:"yMbKjuDH/n"}),value:na.ZOOM}),y.hasTeams&&H.push({label:c({defaultMessage:"Microsoft Teams",id:"IIfj4GddO3"}),value:na.MICROSOFT_TEAMS}),H.push({label:c({defaultMessage:"No video conferencing",id:"PYY40S2Jrm"}),value:"none"}),H},[c,y]);if(!s){const{title:H}=t;if((!t.attendees||t.attendees.length==0)&&!t.start_date_time&&!t.end_date_time&&!t.title)return null;const R=l.jsxs("div",{className:"gap-md relative flex",children:[l.jsx("div",{className:z("inset-y-xs absolute left-0 w-1 shrink-0 self-stretch rounded-full",{"brightness-[0.8]":S==="Fail"}),style:{backgroundColor:w}}),l.jsxs("div",{className:"gap-md flex flex-col pl-5",children:[l.jsx(yl,{oldText:H,newText:n?.title??void 0,isDeletion:i==="DELETE"}),l.jsx(abe,{event:t,newEvent:n,action:i,truncateAttendees:a})]})]});return o?l.jsx("div",{className:"p-md relative overflow-hidden",children:R}):l.jsx(Xn,{fullBleed:!0,className:"p-md relative overflow-hidden",roundedClass:"rounded-md",children:R})}return l.jsxs(Xn,{fullBleed:!0,className:"relative flex flex-col gap-4 overflow-hidden px-8 py-2",roundedClass:"rounded-md",fullBleedBorderClassname:"border-none",children:[l.jsx("div",{className:"shrink-none left-xs absolute bottom-2 top-2 w-1.5 self-stretch rounded-full"+(S==="Fail"?" brightness-[0.8]":""),style:{backgroundColor:w}}),l.jsx(xs,{size:"md",type:"text",value:u.title||"",onChange:E,className:"border-subtler text-foreground w-full rounded-none rounded-t-md border-x-0 border-b border-t-0 pb-2 pl-0 pr-4 font-medium shadow-none focus:!outline-none focus:!ring-0",placeholder:c({defaultMessage:"Add title",id:"k09nVJqic1"}),isMobileUserAgent:!1}),l.jsxs("div",{className:"flex flex-col gap-3",children:[l.jsx(ra,{icon:D("clock"),alignCenter:!0,iconSize:"sm",children:l.jsx($_e,{startDateTime:u.start_date_time,endDateTime:u.end_date_time,onStartDateChange:b,onEndDateChange:x,onStartTimeChange:_,onEndTimeChange:v})}),l.jsx(ra,{icon:D("calendar-repeat"),iconSize:"sm",children:l.jsx(eve,{value:u.recurrence||[],onChange:N})}),l.jsx(ra,{icon:D("user"),iconSize:"sm",alignCenter:!0,children:l.jsx("div",{className:z("border-subtler text-foreground focus-within:border-super w-full rounded-lg border px-2",{"!px-3":!u.attendees?.length}),children:l.jsx(pU,{chips:Lve(u.attendees??[]),onAdd:T,onDelete:k,validator:Q1e,placeholder:c({defaultMessage:"Add guests",id:"pP5ifNp+MS"}),suggestions:p,renderSuggestion:O,onDraftChange:h})})}),l.jsx(ra,{icon:D("map-pin"),iconSize:"sm",alignCenter:!0,children:l.jsx(xs,{type:"text",value:u.location||"",onChange:M,placeholder:c({defaultMessage:"Add rooms or location",id:"bb7ELr4Sk+"}),className:"focus:!border-super rounded-lg !px-3 focus:!ring-transparent",isMobileUserAgent:!1})}),l.jsx(ra,{icon:D("video"),iconSize:"sm",alignCenter:!0,children:l.jsx(B_,{id:"video-conferencing-select",activeKey:Ove(u.conference_data),options:L,onOptionChange:P,extraCSS:"rounded-lg pl-3 [&+div]:right-3"})}),l.jsx(ra,{icon:D("align-left"),iconSize:"sm",children:l.jsx(bP,{wrapperClass:"bg-transparent focus-within:!border-super rounded-md px-3 py-2 text-sm focus-within:!ring-transparent",inputRef:m,isMobileUserAgent:!1,children:l.jsx(Mle,{value:u.description||"",onChange:H=>d(R=>({...R,description:H})),placeholder:c({defaultMessage:"Add a description",id:"bocXKEDBwm"}),minRows:4,isMobileStyle:!1,isMobileUserAgent:!1,ref:m})})})]})]})});var vc;(function(e){e.CREATED="CREATED",e.UPDATED="UPDATED",e.DELETED="DELETED",e.REJECTED="REJECTED"})(vc||(vc={}));const Fve=A.memo(function({operation:t,selectedAccount:n,isShowEditableComponentsEnabled:r,buttonVariant:s,buttonText:a,onConfirm:o,onSkip:i}){const{$t:c}=Q(),[u,d]=f.useState();f.useEffect(()=>{d(void 0)},[t]);const m=f.useMemo(()=>{if(t?.update){const x=t.update.event,_=t.update.new_event;return x&&_?{...x,...Object.fromEntries(Object.entries(_).filter(([C,w])=>w!==null))}:_||x}return t?.add?.event||t?.delete?.event},[t]),p=f.useCallback(x=>{d(x)},[]),h=f.useCallback(x=>[{...t.add&&{add:{event:x,selected_account:n,available_accounts:t.add.available_accounts}},...t.update&&{update:{new_event:t.update.new_event,event:x,selected_account:n}},...t.delete&&{delete:{event:x,delete_scope:t.delete.delete_scope,selected_account:n}},status:x.status.toUpperCase()}],[t,n]),g=f.useCallback((x,_)=>{const v=_||{...u||m,status:x};return{confirmed:!0,operations:v?h(v):[]}},[u,m,h]),y=f.useCallback(()=>{let x=vc.CREATED;t.update?x=vc.UPDATED:t.delete&&(x=vc.DELETED),o(g(x))},[g,o,t]),b=f.useCallback(()=>{i(g(vc.REJECTED))},[g,i]);return l.jsxs(l.Fragment,{children:[m&&t.delete&&l.jsx(Y,{className:"px-sm mb-sm",children:l.jsx(AT,{event:m,newEvent:t.update?.new_event,isEditable:!1})}),m&&!t.delete&&l.jsx(Y,{className:"px-md py-sm",children:l.jsx(AT,{event:m,newEvent:t.update?.new_event,onEventChange:p,isEditable:r})}),l.jsx("form",{onSubmit:x=>{x.preventDefault(),y()},children:l.jsx(Y,{className:"px-md py-sm gap-4 border-t pt-4",children:l.jsx("div",{className:"gap-sm flex items-center justify-between",children:l.jsxs("div",{className:"gap-sm flex items-center",children:[l.jsx(st,{size:"small",variant:s,text:a,type:"submit"}),l.jsx(pt,{size:"small",text:c({defaultMessage:"Skip",id:"/4tOwTiCH6"}),onClick:b})]})})})})]})}),Uve=({result:e,isDeleteOperation:t})=>{const{$t:n}=Q();return e?.confirmed===!0?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(ut,{name:D("circle-check-filled"),size:14,className:"shrink-0 text-[#16a34a]",title:"Confirmed"}),l.jsx("span",{className:"text-xs font-medium leading-none text-[#16a34a]",children:n(t?{defaultMessage:"Deleted",id:"KQvWvDRI1B"}:{defaultMessage:"Accepted",id:"aFyFm0PsCy"})})]}):e?.confirmed===!1?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(ut,{name:D("x"),size:14,className:"text-negative shrink-0",title:"Skipped"}),l.jsx("span",{className:"text-negative text-xs font-medium leading-none",children:n({defaultMessage:"Skipped",id:"djZCU5enGS"})})]}):null},Bve=A.memo(function({updateCalendarContent:t,sendStepResult:n,isFinished:r}){const s="calendar-operation-step",[a,o]=f.useState(r??!1),{$t:i}=Q(),c=W1e(),u=f.useMemo(()=>t?.operations??[],[t?.operations]),[d,m]=f.useState({}),p=f.useCallback((O,L)=>{m(H=>({...H,[O]:L}))},[]),[h,g]=f.useState(0),[y,b]=f.useState(()=>Array(u.length).fill(null)),x=f.useRef(!1),_=f.useMemo(()=>u[h],[u,h]),v=f.useMemo(()=>_?.delete?.event?"rejected":"inverted",[_?.delete?.event]),C=f.useMemo(()=>_?_.delete?.event?i({defaultMessage:"Delete",id:"K3r6DQW7h+"}):i({defaultMessage:"Schedule",id:"hGQqkWwmJD"}):i({defaultMessage:"Schedule",id:"hGQqkWwmJD"}),[_,i]),w=u.length>1,S=f.useMemo(()=>{if(!_)return null;let O,L;return _.add?(O=_.add.selected_account,L=_.add.available_accounts):_.update?O=_.update.selected_account:_.delete&&(O=_.delete.selected_account),O=d[h]??O,{selectedAccount:O,availableAccounts:L}},[_,d,h]),E=f.useCallback(O=>{const L=S?.availableAccounts;if(!L)return;const H=L.find(R=>R.connection_id===O);H&&p(h,H)},[S?.availableAccounts,h,p]),T=f.useMemo(()=>({position:"absolute",bottom:16,right:16,zIndex:10}),[]),k=f.useCallback(()=>{g(O=>Math.max(O-1,0))},[]),M=f.useCallback(()=>{g(O=>Math.min(O+1,u.length-1))},[u.length]),N=f.useCallback(O=>{b(L=>{const H=[...L];H[h]=O;const R=H.findIndex(F=>F===null);if(H.every(F=>F!==null)&&!x.current){x.current=!0;const F=H.map(G=>G?.operations).filter(G=>Array.isArray(G)).flat();F.length>0?n({confirmed:!0,operations:F},s,!1):n({confirmed:!1},s,!1),o(!0)}else R!==-1&&g(R);return H})},[h,n,s]),P=f.useCallback(O=>{N(O)},[N]);return a?l.jsx(cr,{icon:D("circle-check-filled"),iconClassName:"text-super",text:i({defaultMessage:"Done",id:"JXdbo8Vnlw"})}):_?l.jsxs(Y,{variant:"raised",className:"py-sm relative rounded-lg border",children:[S?.selectedAccount&&l.jsx(NF,{selectedAccount:S.selectedAccount,availableAccounts:S.availableAccounts,onAccountChange:E}),l.jsx(Fve,{operation:_,selectedAccount:S?.selectedAccount,isShowEditableComponentsEnabled:c,buttonVariant:v,buttonText:C,onConfirm:N,onSkip:P},`operation-${h}`),w&&l.jsxs(Y,{style:T,className:"flex items-center gap-4",children:[l.jsx(Uve,{result:y[h]??null,isDeleteOperation:!!_?.delete?.event}),l.jsxs("span",{className:"text-xs font-medium",children:[l.jsx("span",{className:"text-foreground",children:h+1}),l.jsxs("span",{children:[" of ",u.length]})]}),l.jsxs(Y,{className:"flex gap-2",children:[l.jsx(H1e,{disabled:h===0,onClick:k}),l.jsx(V1e,{disabled:h===u.length-1,onClick:M})]})]})]}):l.jsx(Y,{variant:"raised",className:"py-sm relative rounded-lg border",children:l.jsx("div",{className:"p-4 text-center",children:i({defaultMessage:"No calendar operation available",id:"Hm6yv1Uz2P"})})})}),Hve=A.memo(function({user:t,onRemove:n}){const r=f.useCallback(()=>{n(t)},[n,t]);return l.jsxs("div",{className:"border-subtlest gap-two pr-three flex h-8 items-center justify-between rounded-lg border pl-1.5 font-sans shadow-sm",children:[l.jsxs("div",{className:"gap-xs px-xs flex min-w-0 flex-row text-left",children:[l.jsx(B,{variant:"small",as:"span",children:t.display_name}),l.jsx(B,{variant:"small",color:"light",className:"truncate",as:"span",children:t.email_address})]}),l.jsx(pt,{variant:"common",size:"tiny",onClick:r,icon:D("x"),extraCSS:"rounded-md","aria-label":`Remove ${t.display_name}`})]})}),Vve=A.memo(function({goalId:t,foundUsers:n,names:r,sendStepResult:s}){const{$t:a}=Q(),[o,i]=f.useState([]),c=f.useRef(null);f.useEffect(()=>{c.current&&c.current.focus()},[]);const u=f.useCallback(C=>{const w=C.map(S=>({...S,selected:!0}));i(w)},[]),d=f.useCallback(async()=>{await s({goal_id:t,selected_users:o,submitted:!0},"User selected contacts and clicked continue",!1)},[t,o,s]),m=f.useCallback(C=>{Zr.isEnterKeyWithoutShift(C.nativeEvent)&&o.length>0&&(C.preventDefault(),d())},[o.length,d]),p=a({defaultMessage:"Confirm or change contacts",id:"j4L7Bt/R+D"}),h=a({defaultMessage:"More contacts...",id:"XqmjEIgTyk"}),g=a({defaultMessage:"Pick contacts...",id:"dAWwl8XInO"}),y=a({defaultMessage:"Confirm",id:"N2IrpMDHDB"}),b=a({defaultMessage:"Skip",id:"/4tOwTiCH6"}),x=f.useCallback(C=>{const w=o.some(S=>S.email_address===C.email_address);u(w?o.filter(S=>S.email_address!==C.email_address):[...o,C])},[o,u]);f.useEffect(()=>{if(n&&n.length>0&&o.length===0){const C=n.filter(w=>w.selected);if(C.length>0)u(C);else{const w=Math.min(r?.length||1,n.length);u(n.slice(0,w))}}},[n]);const _=f.useCallback(C=>{u(o.filter(w=>w.email_address!==C.email_address))},[o,u]),v=f.useCallback(async()=>{await s({goal_id:t,selected_users:n,submitted:!1},"User clicked skip",!1)},[n,t,s]);return l.jsxs(Xn,{ref:c,className:"py-2 pt-4 outline-none",onKeyDown:m,tabIndex:0,children:[l.jsxs("div",{className:"gap-md flex flex-col px-4",children:[l.jsx(B,{variant:"smallBold",children:p}),l.jsxs("div",{className:"gap-sm flex flex-wrap items-stretch",children:[o.map(C=>l.jsx(Hve,{user:C,onRemove:_},C.email_address)),o.length<(n?.length??0)&&l.jsx(Qe,{triggerElement:l.jsx(Qe.Button,{icon:D("plus"),variant:"tonal",size:"small",showChevron:!1,"aria-label":o.length===0?g:h}),align:"start",side:"bottom",children:(n??[]).map(C=>l.jsx(Qe.CheckboxItem,{checked:o.some(w=>w.email_address===C.email_address),onCheckedChange:()=>x(C),subtitle:C.email_address??"",children:C.display_name??""},C.email_address))})]})]}),l.jsxs("div",{className:"gap-sm mt-4 flex items-center px-4 py-2",children:[l.jsx(st,{size:"small",variant:"inverted",text:y,disabled:o.length===0,onClick:d}),l.jsx(pt,{size:"small",text:b,onClick:v})]})]})}),tu=async({contextUUID:e,stepUUID:t,result:n,reason:r})=>{try{const{error:s,response:a}=await ve.POST("/rest/sse/pro_search_step_result",r,{body:{context_uuid:e,step_uuid:t,result:n},timeoutMs:Ct({productionMs:5e3}),numRetries:0});if(s)throw new Ue("API_CLIENTS_ERROR",{cause:s,status:a.status??0})}catch(s){Z.error(s)}},Gve=A.memo(function({stepUUID:t,goalId:n,foundBookingOptions:r,isSubmitted:s}){const{$t:a}=Q(),[o,i]=f.useState(r?.[0]),[c,u]=f.useState(0),d=f.useRef(null),m=f.useRef([]),p=f.useMemo(()=>({title:a({defaultMessage:"Choose booking options",id:"5yyo9+Yhan"}),description:a({defaultMessage:"Select your preferred booking provider",id:"gnnwIHEPAG"}),continue:a({defaultMessage:"Confirm",id:"N2IrpMDHDB"}),confirmed:a({defaultMessage:"Confirmed",id:"dX7+RvbH/9"}),skip:a({defaultMessage:"Skip",id:"/4tOwTiCH6"})}),[a]),h=f.useCallback(async()=>{await tu({stepUUID:t,result:{goal_id:n,selected_booking_options:o,submitted:!0},reason:"User selected booking and clicked continue"})},[t,n,o]),g=f.useCallback(async()=>{await tu({stepUUID:t,result:{goal_id:n,selected_booking_options:void 0,submitted:!1},reason:"User clicked skip"})},[n,t]),y=f.useCallback(_=>{i(_)},[]),b=f.useCallback(_=>{u(_)},[]),x=f.useCallback((_,v)=>{m.current[v]=_},[]);return f.useEffect(()=>{if(!r?.length||s)return;const _=C=>{const w=S=>{C.preventDefault(),u(E=>{const T=S==="down"?Math.min(E+1,r.length-1):Math.max(E-1,0);return m.current[T]?.focus(),T})};switch(C.key){case"ArrowDown":w("down");break;case"ArrowUp":w("up");break;case"Enter":case" ":C.preventDefault(),c>=0&&c<r.length&&i(r[c]);break}},v=d.current;if(v)return v.addEventListener("keydown",_),()=>v.removeEventListener("keydown",_)},[r,c,s]),l.jsxs(mm,{className:"pb-2 outline-none",title:p.title,description:p.description,descriptionClassName:"text-quiet",children:[l.jsx("div",{className:"gap-md mt-md flex flex-col px-4",children:l.jsx("div",{ref:d,className:"gap-xs flex flex-col",tabIndex:-1,role:"listbox","aria-label":"Booking options",children:(r??[]).map((_,v)=>{const C=o===_,w=z("group flex w-full items-center rounded-none border outline-none transition-[border-color,border-radius,box-shadow] duration-200 hover:transition-none",!s&&"cursor-pointer","border-t-subtlest border-x-transparent","last:border-b-subtlest [&:not(:last-child)]:border-b-transparent",C&&["!border-super/75 dark:bg-black bg-gradient-to-r from-super/25 to-super/25 !rounded-lg shadow-sm"],!C&&!s&&["hover:!border-subtlest hover:bg-subtler hover:rounded-lg","focus-visible:!border-subtlest focus-visible:bg-subtler focus-visible:rounded-lg"],!s&&'[&:is(:hover,:focus-visible,[data-selected="true"])+div:not(:hover):not(:focus-visible):not([data-selected="true"])]:border-t-transparent [&:is(:hover,:focus-visible,[data-selected="true"])+div:not(:hover):not(:focus-visible):not([data-selected="true"])]:transition-none');return l.jsx("div",{ref:S=>x(S,v),tabIndex:s?-1:0,role:"option","aria-selected":C,"data-selected":C,className:w,onClick:()=>!s&&y(_),onFocus:()=>!s&&b(v),children:l.jsxs("div",{className:"flex w-full items-center justify-between px-5 py-4",children:[l.jsxs("div",{className:"flex items-center gap-6",children:[_?.together?.airline_logos?.[0]&&l.jsx("img",{src:_.together.airline_logos[0],alt:"airline logo",className:"-mt-two size-6 rounded object-contain"}),l.jsx("div",{className:"flex flex-col items-start gap-px",children:l.jsxs(B,{variant:"baseSemi",children:[_?.together?.book_with||"Flight",_?.together?.option_title?` (${_.together.option_title})`:""]})})]}),_?.together?.price&&l.jsxs(B,{variant:"baseSemi",className:"font-bold",children:["$",_.together.price]})]})},v)})})}),l.jsxs("div",{className:"gap-sm mt-sm flex items-center px-4 py-2",children:[l.jsx(st,{size:"small",variant:"inverted",text:s?p.confirmed:p.continue,icon:s?D("check"):void 0,disabled:!o||s,onClick:h}),l.jsx(pt,{size:"small",text:p.skip,disabled:s,onClick:g})]})]})}),NT={weekday:"short",month:"short",day:"numeric",year:"numeric"},zve={hour:"numeric",minute:"2-digit",hour12:!0},q_="en-US",RT=e=>{if(!e)return"00:00 AM";try{return new Date(e).toLocaleTimeString(q_,zve).toUpperCase()}catch{return"00:00 AM"}},qve=e=>{if(!e)return"";const t=Math.floor(e/60),n=e%60;return`${t}h ${n}m`},$ve=e=>{if(!e||e.length===0)return"Nonstop";const t=e.length;return`${t} Stop${t>1?"s":""}`},DT=e=>{if(!e||e.length===0)return null;if(e.length===1){const t=e[0]?.duration||0,n=Math.floor(t/60),r=t%60;return`${n}h ${r}m ${e[0]?.id}`}return e.map(t=>t.id).join(", ")},Wve=(e,t,n)=>{if(!e)return"";const s=new Date(e).toLocaleDateString(q_,NT);if(n==="ROUND_TRIP"&&t){const i=new Date(t).toLocaleDateString(q_,NT);return`  ${s}  ${i}`}return`  ${s}`},Kve=A.memo(function({flight:t,index:n,isSelected:r,isSubmitted:s,onSelect:a,onFocus:o,setRef:i}){const c=t.flights?.[0]?.departure_airport?.time,u=t.flights?.[t.flights.length-1]?.arrival_airport?.time,d=t.flights?.[0]?.departure_airport?.id||"XXX",m=t.flights?.[t.flights.length-1]?.arrival_airport?.id||"XXX",p=t.flights?.[0]?.airline,h=z("group flex w-full items-center rounded-none border outline-none transition-[border-color,border-radius,box-shadow] duration-200 hover:transition-none",!s&&"cursor-pointer","border-t-subtlest border-x-transparent","last:border-b-subtlest [&:not(:last-child)]:border-b-transparent",r&&["!border-super/75 dark:bg-black bg-gradient-to-r from-super/25 to-super/25 !rounded-lg shadow-sm"],!r&&!s&&["hover:!border-subtlest hover:bg-subtler hover:rounded-lg","focus-visible:!border-subtlest focus-visible:bg-subtler focus-visible:rounded-lg"],!s&&'[&:is(:hover,:focus-visible,[data-selected="true"])+div:not(:hover):not(:focus-visible):not([data-selected="true"])]:border-t-transparent [&:is(:hover,:focus-visible,[data-selected="true"])+div:not(:hover):not(:focus-visible):not([data-selected="true"])]:transition-none');return l.jsx("div",{ref:g=>i(g,n),tabIndex:s?-1:0,role:"option","aria-selected":r,"data-selected":r,className:h,onClick:()=>!s&&a(t),onFocus:()=>!s&&o(n),children:l.jsxs("div",{className:"grid w-full grid-cols-[auto_1fr_88px_88px_88px] items-start gap-6 px-5 py-4",children:[l.jsx("div",{className:"pt-two flex self-stretch",children:t.airline_logo&&l.jsx("img",{src:t.airline_logo,alt:"airline logo",className:"size-10 rounded object-contain"})}),l.jsxs("div",{className:"flex flex-col items-start gap-px",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(B,{variant:"baseSemi",children:RT(c)}),l.jsx("span",{className:"text-quieter px-1",children:""}),l.jsx(B,{variant:"baseSemi",children:RT(u)})]}),p&&l.jsx(B,{variant:"tinyMono",color:"light",children:p})]}),l.jsxs("div",{className:"flex flex-col items-start gap-px",children:[l.jsx(B,{variant:"baseSemi",children:qve(t.total_duration)}),l.jsxs(B,{variant:"tinyMono",color:"light",children:[d,"",m]})]}),l.jsxs("div",{className:"flex flex-col items-start gap-px",children:[l.jsx(B,{variant:"baseSemi",children:$ve(t.layovers)}),DT(t.layovers)&&l.jsx(B,{variant:"tinyMono",color:"light",children:DT(t.layovers)})]}),l.jsxs("div",{className:"flex flex-col items-end justify-end gap-px",children:[t.price&&l.jsxs(B,{variant:"baseSemi",className:"font-bold",children:["$",t.price]}),l.jsx(B,{variant:"tinyMono",color:"light",children:t.type})]})]})},`flight-${n}`)}),Yve=A.memo(function({stepUUID:t,goalId:n,foundFlights:r,isSubmitted:s,outboundDate:a,returnDate:o,flightType:i}){const{$t:c}=Q(),[u,d]=f.useState(r?.length>0?0:-1),[m,p]=f.useState(0),h=f.useRef(null),g=f.useRef([]),y=f.useMemo(()=>Wve(a,o,i),[a,o,i]),b=f.useMemo(()=>({title:c({defaultMessage:"Top departing flights",id:"tHwLRV4b68"})+y,description:c({defaultMessage:"Ranked by price and convenience. Prices include taxes and fees for one adult.",id:"cAxRMXuRMO"}),continue:c({defaultMessage:"Confirm",id:"N2IrpMDHDB"}),confirmed:c({defaultMessage:"Confirmed",id:"dX7+RvbH/9"}),skip:c({defaultMessage:"Skip",id:"/4tOwTiCH6"})}),[c,y]),x=f.useCallback(async()=>{const S=u>=0&&r?r[u]:void 0;await tu({stepUUID:t,result:{goal_id:n,selected_flight:S,submitted:!0},reason:"User selected flight and clicked continue"})},[t,n,u,r]),_=f.useCallback(async()=>{await tu({stepUUID:t,result:{goal_id:n,selected_flight:void 0,submitted:!1},reason:"User clicked skip"})},[n,t]),v=f.useCallback(S=>{const E=r?.findIndex(T=>T===S)??-1;d(E)},[r]),C=f.useCallback(S=>{p(S)},[]),w=f.useCallback((S,E)=>{g.current[E]=S},[]);return f.useEffect(()=>{if(!r?.length||s)return;const S=T=>{const k=M=>{T.preventDefault(),p(N=>{const P=M==="down"?Math.min(N+1,r.length-1):Math.max(N-1,0);return g.current[P]?.focus(),P})};switch(T.key){case"ArrowDown":k("down");break;case"ArrowUp":k("up");break;case"Enter":case" ":T.preventDefault(),m>=0&&m<r.length&&d(m);break}},E=h.current;if(E)return E.addEventListener("keydown",S),()=>E.removeEventListener("keydown",S)},[r,m,s]),l.jsxs(mm,{className:"pb-2 outline-none",title:b.title,description:b.description,descriptionClassName:"text-quiet",children:[l.jsx("div",{className:"gap-md mt-md flex flex-col px-4",children:l.jsx("div",{ref:h,className:"gap-xs flex flex-col",tabIndex:-1,role:"listbox","aria-label":"Flight options",children:(r??[]).map((S,E)=>l.jsx(Kve,{flight:S,index:E,isSelected:u===E,isSubmitted:s,onSelect:v,onFocus:C,setRef:w},E))})}),l.jsxs("div",{className:"gap-sm mt-sm flex items-center px-4 py-2",children:[l.jsx(st,{size:"small",variant:"inverted",text:s?b.confirmed:b.continue,icon:s?D("check"):void 0,disabled:u<0||s,onClick:x}),l.jsx(pt,{size:"small",text:b.skip,disabled:s,onClick:_})]})]})}),Qve=f.memo(function({children:t,defaultExpanded:n=!1,title:r}){const{$t:s}=Q(),[a,o]=f.useState(n),i=f.useCallback(()=>{o(u=>!u)},[]),c=f.useMemo(()=>a?D("chevron-down"):D("chevron-right"),[a]);return l.jsx(ba,{className:"overflow-hidden",transition:{duration:.3,ease:rr},children:l.jsxs("div",{children:[l.jsx(st,{variant:"common",text:r??s({defaultMessage:"Advanced",id:"3Rx6Qo1x+1"}),onClick:i,size:"tiny",icon:c,noPadding:!0,extraCSS:"!bg-transparent hover:!bg-subtler"}),l.jsx(bs,{children:a&&l.jsx("div",{className:"pt-2",children:t})})]})})}),Sf=f.memo(function({children:t}){return l.jsx("div",{className:"min-w-0 flex-1 rounded-md",children:t})}),IT=Me({selectModel:{defaultMessage:"Select model...",id:"XZsGHYyuKM"},selectModelAriaLabel:{defaultMessage:"Select AI model",id:"lCA6X6iiTe"}}),Xve=({selectedModel:e,onModelChange:t,isOpen:n,onOpen:r,onClose:s})=>{const a="task-modal-model-selector",o=Vs(),i=e||o,{$t:c}=Q(),{getSearchModelLabel:u}=X0({reason:a}),d=On(),{menuItems:m}=zj({currentModel:i,onModelSelect:b=>{t?.(b)},openPaywallUpsell:d}),p=u(i)??c(IT.selectModel),h=f.useCallback(b=>{b?r?.():s?.()},[r,s]),g=f.useMemo(()=>l.jsx(Du,{"aria-label":c(IT.selectModelAriaLabel),children:p}),[c,p]),y=f.useMemo(()=>m.map((b,x)=>l.jsx(Md,{...b},x)),[m]);return l.jsx(Qe,{triggerElement:g,isOpen:n??!1,onToggle:h,onOpen:r,maxHeightPx:400,minWidthPx:280,children:y})},Zve=Me({selectSourcesAriaLabel:{defaultMessage:"Select search sources",id:"onhJbmcKvr"}});function Jve({sources:e,onChange:t,isOpen:n,onOpen:r,onClose:s}){const{$t:a}=Q(),{getSourceLabel:o}=Gs(),i=f.useMemo(()=>{if(e.length===1){const p=e[0];if(p)return o(p)}return a({defaultMessage:"{count} sources",id:"l1+6PggBqU"},{count:e.length})},[e,o,a]),c=p=>{t(p.filter(Ga))},u=a(Zve.selectSourcesAriaLabel),d=f.useMemo(()=>l.jsx(Du,{"aria-label":u,children:i}),[u,i]),m=f.useMemo(()=>[Qo.org,Qo.google_drive,Qo.onedrive,Qo.sharepoint,Qo.my_files],[]);return l.jsx(iP,{isOpen:n??!1,sources:e,onChange:c,triggerElement:d,onOpen:r,onClose:s,omitCometMcpSources:!0,omittedSources:m})}const eCe=f.memo(function({isOpen:t,onToggle:n,searchMode:r,onSearchModeSelect:s,variant:a="tonal",size:o="default",triggerElement:i,omittedSearchModes:c}){const[u,d]=f.useState(!1),m=t??u,p=n??d,h=gi(r),g=Ia(r),y=f.useMemo(()=>l.jsx(Qe.Button,{variant:a,size:o,leadingAccessory:h,children:l.jsx(be,{...g})}),[h,g,a,o]);return l.jsx(Qe,{isOpen:m,onToggle:p,minWidthPx:220,triggerElement:i??y,children:l.jsx(JI,{searchMode:r,onSearchModeSelect:s,omittedSearchModes:c})})}),tCe=[K.STUDY],hU=f.memo(function({searchModel:t,onSearchModelChange:n,sources:r,onSourcesChange:s,variant:a="default"}){const o=yr(),i=o(t),{hasActiveSubscription:c}=Mt(),[u,d]=f.useState(!1),[m,p]=f.useState(!1),h=Zf(),{getPreferredSearchModelForSearchMode:g}=k0(),y=f.useCallback(()=>{d(!0),p(!1)},[]),b=f.useCallback(()=>{d(!1)},[]),x=f.useCallback(()=>{p(!0),d(!1)},[]),_=f.useCallback(()=>{p(!1)},[]),v=o(t),C=f.useCallback(w=>{const S=g(w);n(S)},[g,n]);return l.jsx("div",{className:"flex w-full flex-col gap-2",children:l.jsxs("div",{className:"flex gap-3",children:[c&&l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx(B,{variant:"tiny",color:"light",className:"select-none",children:l.jsx(be,{defaultMessage:"Mode",id:"mrOnjMzgC4"})}),l.jsxs("div",{className:"h-full w-fit",children:[h&&l.jsx("div",{className:"min-w-[240px]",children:l.jsx(eCe,{searchMode:v,onSearchModeSelect:C,omittedSearchModes:tCe})}),!h&&l.jsx(cie,{value:t,onChange:n,layoutKey:"task-modal",className:"h-full",variant:a,buttonSize:"regular"})]})]}),c&&i===K.SEARCH&&l.jsxs("div",{className:"flex min-w-[100px] flex-1 flex-col gap-2",children:[l.jsx(B,{variant:"tiny",color:"light",className:"select-none",children:l.jsx(be,{defaultMessage:"Model",id:"rhSI1/3g21"})}),l.jsx(Sf,{children:l.jsx(Xve,{selectedModel:t,onModelChange:w=>n(w),isOpen:u,onOpen:y,onClose:b})})]}),c&&l.jsxs("div",{className:"flex min-w-[100px] flex-col gap-2",children:[l.jsx(B,{variant:"tiny",color:"light",className:"select-none",children:l.jsx(be,{defaultMessage:"Sources",id:"fhwTpAcBLC"})}),l.jsx(Sf,{children:l.jsx(Jve,{sources:r,onChange:s,isOpen:m,onOpen:x,onClose:_})})]})]})})});function nCe(e){return e%4===0&&e%100!==0||e%400===0}function rCe(e,t){const n=[31,28,31,30,31,30,31,31,30,31,30,31];return t===1&&nCe(e)?29:n[t]??31}function vp(e,t,n){return n<=rCe(e,t)}const sCe=e=>{switch(e.kind){case"ONCE":return new Date(e.year,e.month,e.day,e.hour,e.minute);case"DAILY":return new Date(2e3,0,1,e.hour,e.minute);case"WEEKLY":return new Date(2e3,0,2+e.dayOfWeek,e.hour,e.minute);case"MONTHLY":return new Date(2e3,0,e.day,e.hour,e.minute);case"YEARLY":return new Date(2e3,e.month,e.day,e.hour,e.minute);case"WEEKDAYS":return new Date(2e3,0,1,e.hour,e.minute)}};function XE(e,t){const n=new Date;switch(e.kind){case"ONCE":{const r=new Date(e.year,e.month,e.day,e.hour,e.minute);return r>n?r:n}case"DAILY":{const r=new Date(n.getFullYear(),n.getMonth(),n.getDate(),e.hour,e.minute,0,0);return r<=n&&r.setDate(r.getDate()+1),r}case"WEEKLY":{const r=n.getDay();let s=e.dayOfWeek-r;s<0&&(s+=7);const a=new Date(n.getFullYear(),n.getMonth(),n.getDate()+s,e.hour,e.minute,0,0);return a<=n&&a.setDate(a.getDate()+7),a}case"MONTHLY":{let r=n.getFullYear(),s=n.getMonth();if(vp(r,s,e.day)){const a=new Date(r,s,e.day,e.hour,e.minute,0,0);if(a>n)return a}do s++,s>11&&(s=0,r++);while(!vp(r,s,e.day));return new Date(r,s,e.day,e.hour,e.minute,0,0)}case"YEARLY":{let r=n.getFullYear();if(vp(r,e.month,e.day)){const s=new Date(r,e.month,e.day,e.hour,e.minute,0,0);if(s>n)return s}do r++;while(!vp(r,e.month,e.day));return new Date(r,e.month,e.day,e.hour,e.minute,0,0)}case"WEEKDAYS":{const r=n.getDay();let s=0;r===0?s=1:r===6&&(s=2);const a=new Date(n.getFullYear(),n.getMonth(),n.getDate()+s,e.hour,e.minute,0,0);if(a<=n){a.setDate(a.getDate()+1);const o=a.getDay();o===0?a.setDate(a.getDate()+1):o===6&&a.setDate(a.getDate()+2)}return a}default:return n}}function aCe(e,t){const n=sCe(e);switch(e.kind){case"ONCE":return t.formatDate(n,{dateStyle:"medium",timeStyle:"short"});case"DAILY":return t.formatTime(n,{timeStyle:"short"});case"WEEKLY":return t.formatDate(n,{weekday:"short",hour:"numeric",minute:"numeric"});case"MONTHLY":return t.formatMessage({defaultMessage:"Day {day}, {time}",id:"grA/MDsLjr"},{day:n.getDate().toString(),time:t.formatTime(n,{timeStyle:"short"})});case"YEARLY":return t.formatDate(n,{hour:"numeric",minute:"numeric",day:"numeric",month:"short"});case"WEEKDAYS":return t.formatTime(n,{timeStyle:"short"})}}const rc=Me({kindOnce:{defaultMessage:"Once",id:"DqTQOpG2Me"},kindDaily:{defaultMessage:"Daily",id:"zxvhnETmn2"},kindWeekly:{defaultMessage:"Weekly",id:"/clOBUs/wZ"},kindWeekdays:{defaultMessage:"Every weekday",id:"8Hjql2wdJG"},kindMonthly:{defaultMessage:"Monthly",id:"wYsv4ZHu+B"},kindYearly:{defaultMessage:"Yearly",id:"dqD39hnoA/"}}),oCe={ONCE:rc.kindOnce,DAILY:rc.kindDaily,WEEKLY:rc.kindWeekly,MONTHLY:rc.kindMonthly,YEARLY:rc.kindYearly,WEEKDAYS:rc.kindWeekdays};function vr(){const e=new Date;return e.setHours(e.getHours()+1,e.getMinutes(),0,0),{kind:"ONCE",minute:e.getMinutes(),hour:e.getHours(),day:e.getDate(),month:e.getMonth(),year:e.getFullYear(),dayOfWeek:e.getDay()}}function XYe({prompt:e="",searchModel:t,searchMode:n,sources:r=_e}){return{title:"",prompt:e,schedule:vr(),searchModel:t,sources:r,expiryDate:void 0,defaultExpiryDate:xU(n)}}function iCe(e,t){return t.formatMessage(oCe[e])}const lCe=()=>Intl.DateTimeFormat().resolvedOptions().timeZone;function cCe(e){switch(e.kind){case"ONCE":return new Date(e.year,e.month,e.day,e.hour,e.minute);default:return new Date}}function uCe(e){switch(e.kind){case"ONCE":return"FREQ=DAILY;COUNT=1";case"DAILY":return`FREQ=DAILY;BYHOUR=${e.hour};BYMINUTE=${e.minute}`;case"WEEKLY":return`FREQ=WEEKLY;BYDAY=${["SU","MO","TU","WE","TH","FR","SA"][e.dayOfWeek]};BYHOUR=${e.hour};BYMINUTE=${e.minute}`;case"MONTHLY":return`FREQ=MONTHLY;BYMONTHDAY=${e.day};BYHOUR=${e.hour};BYMINUTE=${e.minute}`;case"YEARLY":return`FREQ=YEARLY;BYMONTH=${e.month+1};BYMONTHDAY=${e.day};BYHOUR=${e.hour};BYMINUTE=${e.minute}`;case"WEEKDAYS":return`FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR;BYHOUR=${e.hour};BYMINUTE=${e.minute}`}}function gU(e){const t=cCe(e);return{start_at:LN(t),rrule:uCe(e),tzid:lCe()}}function yU(e){if(!(e===null||!e))return LN(e)}const dCe={SU:0,MO:1,TU:2,WE:3,TH:4,FR:5,SA:6};function fCe(e){const t={},n=s=>{const a=parseInt(s,10);return Number.isNaN(a)?void 0:a},r=e.split(";");for(const s of r){const[a,o]=s.split("=");if(!(!a||!o))switch(a.toUpperCase()){case"FREQ":t.freq=o.toUpperCase();break;case"BYHOUR":t.byhour=n(o);break;case"BYMINUTE":t.byminute=n(o);break;case"BYMONTH":t.bymonth=n(o);break;case"BYMONTHDAY":t.bymonthday=n(o);break;case"BYDAY":t.byday=o.split(",");break;case"COUNT":t.count=n(o);break}}return t}function jT(e){const t=new Date(e.start_at),n={kind:"ONCE",minute:t.getMinutes(),hour:t.getHours(),day:t.getDate(),month:t.getMonth(),year:t.getFullYear(),dayOfWeek:t.getDay()};if(e.rrule.includes("FREQ=DAILY;COUNT=1"))return n;const r=fCe(e.rrule);switch(r.freq){case"DAILY":return r.byhour===void 0||r.byminute===void 0?(Z.error("DAILY schedule missing required BYHOUR or BYMINUTE parameter"),{...n}):{...n,kind:"DAILY",hour:r.byhour,minute:r.byminute};case"WEEKLY":{if(r.byday===void 0||r.byhour===void 0||r.byminute===void 0)return Z.error("WEEKLY schedule missing required parameters"),{...n};if(r.byday.length===5)return{...n,kind:"WEEKDAYS",hour:r.byhour,minute:r.byminute};const s=r.byday[0],a=dCe[s??""]??0;return{...n,kind:"WEEKLY",dayOfWeek:a,hour:r.byhour,minute:r.byminute}}case"MONTHLY":return r.bymonthday===void 0||r.byhour===void 0||r.byminute===void 0?(Z.error("MONTHLY schedule missing required BYMONTHDAY parameter"),{...n}):{...n,kind:"MONTHLY",day:r.bymonthday,hour:r.byhour,minute:r.byminute};case"YEARLY":return r.bymonth===void 0||r.bymonthday===void 0||r.byhour===void 0||r.byminute===void 0?(Z.error("YEARLY schedule missing required BYMONTH parameter"),{...n}):{...n,kind:"YEARLY",month:r.bymonth-1,day:r.bymonthday,hour:r.byhour,minute:r.byminute}}return Z.error("Invalid task schedule"),{...n}}function mCe({expiryDate:e,schedule:t,defaultExpiryDate:n}){return e===null||!e||!t?e:XE(t)>e?n??null:e}function pCe(e,t){return(e===K.STUDIO||e===K.RESEARCH)&&(t.kind==="DAILY"||t.kind==="WEEKLY"||t.kind==="WEEKDAYS")}function xU(e,t){if(!(!t||!pCe(e,t))&&(e===K.STUDIO||e===K.RESEARCH)){const n=XE(t);return(s=>{switch(s){case"DAILY":return D2(n,14);case"WEEKLY":return zW(n,14);case"WEEKDAYS":return D2(n,21);case"ONCE":case"MONTHLY":case"YEARLY":return;default:St(s)}})(t.kind)}}var nt;(function(e){e.SCHEDULED="scheduled",e.PRICE_ALERT="priceAlert",e.SHORTCUT="shortcut"})(nt||(nt={}));var nr;(function(e){e.TARGET_PRICE="targetPrice",e.MOVEMENT_AMOUNT="movementAmount"})(nr||(nr={}));const ju={should_send_email:!0,should_send_in_app:!0,should_send_push:!0},hCe=e=>{const t=e.enrichments?e.enrichments.space??null:void 0;return{id:e.task_id,type:gCe(e),createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at),expiryDate:e.end_at?new Date(e.end_at):void 0,title:e.task_name,prompt:e.task_data.task_prompt,status:e.status,nextRun:new Date(e.next_trigger_intended_time),scheduleInfo:{start_at:e.start_at,rrule:e.trigger_condition_schedule,tzid:e.tzid},subscription:e.event_subscription,searchModel:e.task_data?.task_params?.model_preference||"pplx_pro",sources:e.task_data?.task_params?.sources||["web"],notificationSettings:e.notification_settings||ju,collectionUuid:e.collection_uuid,space:t,userId:e.user_task_context?.user_nextauth_id??null}},gCe=e=>{switch(e.scheduler_type){case"EVENT_PUSH":return"ALERT";case"POLL":return"SCHEDULE";case"SHORTCUT":return"SHORTCUT";default:return null}};function ZYe({intl:e,triggerType:t}){switch(t){case nt.SCHEDULED:return e.formatMessage({defaultMessage:"Scheduled task",id:"dG8VrMkuAT"});case nt.PRICE_ALERT:return e.formatMessage({defaultMessage:"Price alert",id:"XMapyUiPpV"});case nt.SHORTCUT:return e.formatMessage({defaultMessage:"Shortcut",id:"tceWOrncgz"});default:St(t)}}function JYe({intl:e,triggerType:t,actionPerformed:n}){const r=yCe({intl:e,actionPerformed:n});switch(t){case nt.SCHEDULED:return e.formatMessage({defaultMessage:"Task has been {actionDisplayName}",id:"dztI4FIBBf"},{actionDisplayName:r});case nt.PRICE_ALERT:return e.formatMessage({defaultMessage:"Price alert has been {actionDisplayName}",id:"ApBHuTxt1D"},{actionDisplayName:r});case nt.SHORTCUT:return e.formatMessage({defaultMessage:"Shortcut has been {actionDisplayName}",id:"oprPa0O7KY"},{actionDisplayName:r});default:St(t)}}function yCe({intl:e,actionPerformed:t}){switch(t){case"created":return e.formatMessage({defaultMessage:"created",id:"lr7wlbGcN2"});case"updated":return e.formatMessage({defaultMessage:"updated",id:"fM7xZh2bri"});case"paused":return e.formatMessage({defaultMessage:"paused",id:"onIpArq3j6"});case"resumed":return e.formatMessage({defaultMessage:"resumed",id:"NUz1enNtoA"});case"deleted":return e.formatMessage({defaultMessage:"deleted",id:"GBLHN+CxXe"});case"copied":return e.formatMessage({defaultMessage:"copied",id:"JZWZSAD5l1"});case"skipped":return e.formatMessage({defaultMessage:"skipped",id:"yrhXAwV22L"});default:St(t)}}function bU({defaultSearchModel:e}){return{trigger:{type:nt.SCHEDULED,schedule:vr()},query:{searchModel:e,prompt:"",sources:by()},status:"ACTIVE",notificationSettings:ju}}function xCe({defaultSearchModel:e,symbol:t=""}){return{trigger:{type:nt.PRICE_ALERT,alertType:nr.TARGET_PRICE,price:0,currency:"usd",symbol:t},query:{prompt:"",searchModel:e,sources:by()},status:"ACTIVE"}}function _U(e,{getSearchModeForSearchModel:t}){if(e.trigger.type!==nt.SCHEDULED)return e;const n=t(e.query.searchModel),r=xU(n,e.trigger.schedule),s=mCe({expiryDate:e.trigger.expiryDate,schedule:e.trigger.schedule,defaultExpiryDate:r});return e.id?{...e,trigger:{...e.trigger,expiryDate:s}}:{...e,trigger:{...e.trigger,schedule:{...e.trigger.schedule},expiryDate:s,defaultExpiryDate:r}}}const bCe=["web"];function by(){return bCe}const _Ce=f.memo(function({query:t,onQueryChange:n}){const{$t:r}=Q(),{hasActiveSubscription:s}=Mt(),a=f.useCallback(c=>{n({...t,searchModel:c})},[n,t]),o=f.useCallback(c=>{n({...t,sources:c})},[n,t]);if(!s)return null;const i=r({defaultMessage:"Model options",id:"ObVxV7yacw"});return l.jsx(Qve,{title:i,children:l.jsx(hU,{searchModel:t.searchModel,onSearchModelChange:a,sources:t.sources??by(),onSourcesChange:o,variant:"subtle"})})}),vCe=f.memo(function({trigger:t,query:n,onQueryChange:r}){switch(t.type){case nt.SCHEDULED:return l.jsx(_Ce,{query:n,onQueryChange:r});case nt.PRICE_ALERT:case nt.SHORTCUT:return null;default:St(t)}}),CCe=f.memo(function({expiryDate:t,onExpiryDateChange:n,schedule:r}){const{$t:s}=Q(),a=f.useCallback(c=>{c.stopPropagation(),n(null)},[n]),o=f.useMemo(()=>l.jsx(st,{type:"button",onClick:a,icon:D("x"),size:"tiny",variant:"common"}),[a]),i=f.useMemo(()=>{if(t===null)return;const c=r?XE(r):void 0;return c?D2(c,1):void 0},[t,r]);return l.jsx(mg,{value:t===null?void 0:t,onChange:n,buttonClassName:"w-full py-sm bg-subtle",trailingIcon:o,fromDate:i,placeholder:s({defaultMessage:"None selected",id:"7MYtB45RD0"})})}),wCe=f.memo(function({defaultExpiryDate:t,expiryDate:n,onExpiryDateChange:r,schedule:s}){const a=f.useCallback(o=>{r?.(o)},[r]);return l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx(B,{variant:"tiny",color:"light",className:"select-none",children:l.jsx(be,{defaultMessage:"Expiration date",id:"CICBj0Td+l"})}),l.jsx(CCe,{expiryDate:n||t,onExpiryDateChange:a,schedule:s})]})}),SCe=f.memo(function({trigger:t,onTriggerChange:n}){const r=f.useCallback(s=>{t.type===nt.SCHEDULED&&n({...t,type:nt.SCHEDULED,expiryDate:s})},[n,t]);switch(t.type){case nt.SCHEDULED:return t.schedule.kind!=="ONCE"?l.jsx(wCe,{defaultExpiryDate:t.defaultExpiryDate,expiryDate:t.expiryDate,onExpiryDateChange:r,schedule:t.schedule}):null;case nt.PRICE_ALERT:case nt.SHORTCUT:return null;default:St(t)}}),ECe=({options:e,selectedValues:t,onSelectionChange:n,placeholder:r="Select options...",disabled:s=!1})=>{const a=Q(),[o,i]=f.useState(!1),c=f.useCallback(m=>{i(m)},[]),u=f.useCallback((m,p)=>{n(p?[...t,m]:t.filter(h=>h!==m))},[t,n]),d=f.useMemo(()=>{if(t.length===0)return r;const m=t.map(p=>e.find(h=>h.value===p)?.label).filter(Boolean);return new Intl.ListFormat(a.locale,{style:"long",type:"conjunction"}).format(m)},[t,e,r,a.locale]);return l.jsx(Qe,{isOpen:o,onToggle:c,align:"end",triggerElement:l.jsx(Du,{size:"default",disabled:s,children:d}),children:e.map(m=>l.jsx(Qe.CheckboxItem,{checked:t.includes(m.value),onCheckedChange:p=>u(m.value,p),children:m.label},m.value))})},kCe=f.memo(function({notificationSettings:t,onNotificationSettingsChange:n,disabled:r}){const{$t:s}=Q(),a=f.useMemo(()=>[{value:"in_app",label:s({defaultMessage:"In-app",id:"E7zWOQXV+k"})},{value:"email",label:s({defaultMessage:"Email",id:"sy+pv5U9ls"})},{value:"push",label:s({defaultMessage:"Mobile",id:"GWtmtuCmOx"})}],[s]),o=f.useMemo(()=>{const c=[];return t.should_send_in_app&&c.push("in_app"),t.should_send_email&&c.push("email"),t.should_send_push&&c.push("push"),c},[t]),i=f.useCallback(c=>{n({should_send_email:c.includes("email"),should_send_push:c.includes("push"),should_send_in_app:c.includes("in_app")})},[n]);return l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx(B,{variant:"tiny",color:"light",className:"select-none",children:l.jsx(be,{defaultMessage:"Notification platform",id:"L9evilaxeT"})}),l.jsx(ECe,{options:a,selectedValues:o,onSelectionChange:i,placeholder:s({defaultMessage:"Select platform",id:"Gl5w1+hLYC"}),disabled:r})]})}),ZE=(e,t)=>{try{return new Intl.NumberFormat(t,{style:"currency",currency:e.toUpperCase(),currencyDisplay:"symbol"}).format(0).replace(/[0-9.,\s]/g,"").trim()||"$"}catch{return"$"}},JE="5";function $_(e){const t={selectedSymbol:e.symbol,additionalInstructions:"",selectedOption:"price",priceValue:"",percentValue:"",positiveSelected:!0,negativeSelected:!0};switch(e.alertType){case nr.TARGET_PRICE:return{...t,selectedOption:"price",priceValue:e.price===0?"":e.price.toString()};case nr.MOVEMENT_AMOUNT:{const n=e.percentageDecimalUpperBound>0&&e.percentageDecimalUpperBound!==Zc/100,r=e.percentageDecimalLowerBound<0&&e.percentageDecimalLowerBound!==Jc/100;let s="";return n?s=(e.percentageDecimalUpperBound*100).toFixed(2):r&&(s=(Math.abs(e.percentageDecimalLowerBound)*100).toFixed(2)),s?{...t,selectedOption:"movement",percentValue:s,positiveSelected:n,negativeSelected:r}:{...t,selectedOption:"movement",percentValue:JE,positiveSelected:!0,negativeSelected:!0}}default:St(e)}}function MCe(e){switch(e.selectedOption){case"price":{const t=parseFloat(e.priceValue.replace(/[^0-9.]/g,""));return{type:nt.PRICE_ALERT,alertType:nr.TARGET_PRICE,symbol:e.selectedSymbol??"",price:t||0,currency:"usd"}}case"movement":{const n=(parseFloat(e.percentValue)||0)/100;let r=0,s=0;return e.positiveSelected&&e.negativeSelected?(r=n,s=-n):e.positiveSelected?r=n:e.negativeSelected&&(s=-n),{type:nt.PRICE_ALERT,alertType:nr.MOVEMENT_AMOUNT,symbol:e.selectedSymbol??"",percentageDecimalUpperBound:r,percentageDecimalLowerBound:s}}default:St(e.selectedOption)}}function TCe({trigger:e,onTriggerChange:t}){const[n,r]=f.useState(()=>$_(e)),s=f.useMemo(()=>e.alertType===nr.TARGET_PRICE?`${e.symbol}-${e.alertType}-${e.price}`:`${e.symbol}-${e.alertType}-${e.percentageDecimalUpperBound}-${e.percentageDecimalLowerBound}`,[e]),a=f.useRef(s);f.useEffect(()=>{s!==a.current&&(r($_(e)),a.current=s)},[s,e]);const o=f.useCallback(y=>{const b=MCe(y);t(b)},[t]),i=f.useCallback(y=>{r(b=>{const x=y(b);return o(x),x})},[o]),c=f.useCallback(y=>{i(b=>({...b,selectedSymbol:y}))},[i]),u=f.useCallback((y,b="")=>{i(x=>{switch(y){case"price":return{...x,selectedOption:y,priceValue:b};case"movement":return{...x,selectedOption:y,percentValue:JE,positiveSelected:!0,negativeSelected:!0};default:St(y)}})},[i]),d=f.useCallback(y=>{i(b=>({...b,priceValue:typeof y=="function"?y(b.priceValue):y}))},[i]),m=f.useCallback(y=>{i(b=>({...b,percentValue:typeof y=="function"?y(b.percentValue):y}))},[i]),p=f.useCallback(y=>{i(b=>({...b,positiveSelected:y}))},[i]),h=f.useCallback(y=>{i(b=>({...b,negativeSelected:y}))},[i]),g=f.useCallback(y=>{r(b=>({...b,additionalInstructions:y}))},[]);return f.useMemo(()=>({formState:n,onSymbolChange:c,onOptionChange:u,onPriceValueChange:d,onPercentValueChange:m,onPositiveChange:p,onNegativeChange:h,onAdditionalInstructionsChange:g}),[n,c,u,d,m,p,h,g])}const ACe=async e=>{const{data:t,error:n,response:r}=await ve.GET("/rest/finance/quote/{market_identifier}","automations/quote",{params:{path:{market_identifier:e}}});if(n)throw new Ue("API_CLIENTS_ERROR",{cause:n,status:r.status??0});return t},NCe=e=>["automations/quote",e],_y=({symbol:e,enabled:t=!!e,onInitialSuccess:n})=>{const r=f.useRef(!1),s=gt({enabled:t&&!!e,queryKey:NCe(e),queryFn:()=>ACe(e)});return f.useEffect(()=>{s.isSuccess&&s.data&&!r.current&&n&&(r.current=!0,n(s.data))},[s.isSuccess,s.data,n]),s},RCe=f.memo(function({trigger:t,prompt:n,onPromptChange:r,error:s,variant:a="default",disabled:o}){const{isMobileUserAgent:i}=Be(),{$t:c,locale:u}=Q(),d=$_(t),{selectedSymbol:m,priceValue:p,percentValue:h}=d,{data:g,isLoading:y}=_y({symbol:d.selectedSymbol}),b=t.alertType===nr.TARGET_PRICE?"price":"movement",x=g?.currency?ZE(g?.currency,u):"$",{displayInstructions:_}=E0e({selectedSymbol:m,quote:g,isLoading:y,alertType:b,priceValue:p,percentValue:h,currencySymbol:x,$t:c});return l.jsxs("div",{className:z("gap-md flex flex-col",o&&"pointer-events-none opacity-50"),children:[l.jsxs("div",{className:"gap-sm flex w-full flex-col items-start",children:[l.jsx("div",{className:"gap-xs flex w-full items-center",children:l.jsx(B,{variant:"tiny",color:"light",className:"flex shrink-0 items-center",children:l.jsx(be,{defaultMessage:"Default query",id:"7SalR4PwjB"})})}),l.jsx("div",{className:"w-full [&>*]:w-full",children:l.jsx(B,{variant:"small",color:"light",className:"pl-sm border-subtlest border-l-2",children:_})})]}),l.jsxs("div",{className:"gap-sm flex w-full flex-col items-start",children:[l.jsx("div",{className:"gap-xs flex w-full items-center",children:l.jsx(B,{variant:"tiny",color:"light",className:"flex shrink-0 items-center",children:l.jsx(be,{defaultMessage:"Additional Instructions (optional)",id:"QFuOkrgHHJ"})})}),l.jsx("div",{className:"w-full [&>*]:w-full",children:l.jsx(Ul,{value:n,onChange:r,isMobileUserAgent:i,isMobileStyle:!1,minRows:3,maxLength:VN,className:z("[&_textarea]:placeholder:!text-quietest placeholder:!text-quietest hover:!border-subtler focus-within:!border-subtler !border !border-transparent","w-full"),placeholder:"Check news and social media sentiment to assess consensus or controversy",variant:a,disabled:o})})]}),s&&l.jsxs("div",{className:"gap-xs flex items-center",children:[l.jsx(ut,{name:D("exclamation-circle"),size:12,className:"text-caution"}),l.jsx(B,{variant:"tinyRegular",color:"red",className:"mt-0.5",children:s})]})]})}),DCe=f.memo(function({trigger:t,prompt:n,onPromptChange:r,error:s,variant:a,disabled:o}){const{data:i}=_y({symbol:t.symbol}),c=f.useMemo(()=>{if(!t.symbol)return"";const m=i?.name?` (${i.name})`:"";return t.alertType===nr.TARGET_PRICE?my({symbol:t.symbol,quoteName:m}):py({symbol:t.symbol,quoteName:m})},[t.symbol,t.alertType,i?.name]),u=f.useMemo(()=>{const m=i?.name?` (${i.name})`:"";return S0e({prompt:n,symbol:t.symbol,quoteName:m})},[n,t.symbol,i?.name]),d=m=>{const p=JL({baseInstructions:c,additionalInstructions:m});r(p)};return l.jsx(RCe,{trigger:t,prompt:u,onPromptChange:d,error:s,variant:a,disabled:o})}),vU=f.memo(function({trigger:t,prompt:n,onPromptChange:r,placeholder:s,error:a,variant:o="default",disabled:i}){const{isMobileUserAgent:c}=Be(),u=(()=>{switch(o){case"default":return"bg-subtler [&_textarea]:bg-transparent";case"subtle":return"bg-subtle [&_textarea]:bg-transparent";default:St(o)}})();switch(t.type){case nt.SCHEDULED:case nt.SHORTCUT:return l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx(B,{variant:"tiny",color:"light",className:"select-none",children:l.jsx(be,{defaultMessage:"Instructions",id:"sV2v5LjRpX"})}),l.jsx(Ul,{placeholder:s,value:n,onChange:r,isMobileUserAgent:c,isMobileStyle:!1,minRows:3,maxLength:VN,allowEnterNewlines:!0,className:z("hover:!border-subtler focus-within:!border-subtler !border !border-transparent",u),variant:o,disabled:i}),a&&l.jsxs("div",{className:"gap-xs flex items-center",children:[l.jsx(ut,{name:D("exclamation-circle"),size:12,className:"text-caution"}),l.jsx(B,{variant:"tinyRegular",color:"red",className:"mt-0.5",children:a})]})]});case nt.PRICE_ALERT:return l.jsx(DCe,{trigger:t,prompt:n,onPromptChange:r,error:a,variant:o,disabled:i});default:St(t)}}),ICe=f.memo(function({trigger:t,query:n,onQueryChange:r}){const{$t:s}=Q(),a=f.useCallback(u=>{r({...n,prompt:u})},[r,n]),o=f.useCallback(u=>{r({...n,searchModel:u})},[r,n]),i=f.useCallback(u=>{r({...n,sources:u})},[r,n]),c=f.useMemo(()=>{switch(t.type){case nt.SCHEDULED:return null;case nt.PRICE_ALERT:return null;case nt.SHORTCUT:return l.jsx(hU,{searchModel:n.searchModel,onSearchModelChange:o,sources:n.sources??by(),onSourcesChange:i,variant:"subtle"});default:St(t)}},[o,i,n.searchModel,n.sources,t]);return t.type===nt.PRICE_ALERT?null:l.jsxs("div",{className:"flex flex-col gap-4",children:[l.jsx(vU,{trigger:t,prompt:n.prompt,placeholder:s({defaultMessage:"Send me a daily summary of AI news every morning",id:"MTpela8SVy"}),onPromptChange:a,variant:"subtle"}),c]})}),jCe=async({query:e,locale:t,reason:n})=>{try{const{data:r,error:s,response:a}=await ve.GET("/rest/autosuggest/finance/tasks-autosuggest",n,{params:{query:{query:e}},headers:{"accept-language":t},shouldNotAddSourceVersionQueryParams:!1});if(s)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to get finance tasks suggestions",cause:s,status:a.status??0});return"results"in r?r.results:[]}catch(r){return Z.error(r),[]}},PCe=({symbol:e})=>l.jsx(B,{color:"light",children:l.jsx("span",{className:"font-mono opacity-70",children:e.slice(0,1)})}),e3=({image:e,imageDark:t,alt:n,watchlistType:r,className:s,imageClassName:a})=>{const o=r==="FINANCE",{colorScheme:i}=Cs(),c=o&&i==="dark"&&t?t:e,[u,d]=f.useState(()=>{if(!c)return!1;const g=new Image;return g.src=c,g.complete&&g.naturalWidth>0}),[m,p]=f.useState(!1),h=!u||m;return l.jsxs("div",{className:z("relative flex size-6 items-center justify-center",{"bg-subtler":h},s),children:[h&&l.jsx(PCe,{symbol:n??""}),!m&&l.jsx("div",{className:z("absolute",a),children:l.jsx("img",{src:c,alt:n,width:32,height:32,className:z("inset-0 size-full object-contain",{"opacity-0":!u}),onLoad:()=>d(!0),onError:()=>p(!0)})})]})},CU="[&_textarea]:placeholder:!text-quietest placeholder:!text-quietest hover:!border-subtler focus-within:!border-subtler !border !border-transparent",OCe=e=>/^(\d+(\.\d{0,2})?|\.\d{1,2})$/.test(e),LCe=e=>/^(\d+(\.\d{0,1})?|\.\d{0,1})$/.test(e),FCe=({currentPrice:e,value:t,onChange:n,variant:r="default",currency:s="USD"})=>{const{isMobileUserAgent:a}=Be(),{locale:o,$t:i}=Q(),c=f.useMemo(()=>ZE(s,o),[s,o]),u=f.useMemo(()=>e?.toLocaleString(o,{style:"currency",currency:s.toUpperCase()}),[e,o,s]),d=f.useCallback(y=>{n(b=>{if(y===c)return y;const x=y.replace(c,"");return OCe(x)||y===""?c+x:b})},[n,c]),m=f.useCallback(()=>{t===""&&n(c)},[n,t,c]),p=f.useCallback(()=>{t===c&&n("")},[n,t,c]),h=(()=>{switch(r){case"default":return"bg-subtler [&_textarea]:bg-subtler";case"subtle":return"bg-subtle [&_textarea]:bg-subtle";default:St(r)}})(),g=z(CU,h);return l.jsxs("div",{className:"gap-sm flex flex-col items-start",children:[l.jsx(B,{variant:"tiny",color:"light",children:u?i({id:"74LVOPcS2E",defaultMessage:"Target Price (currently {formattedPrice})"},{formattedPrice:u}):i({id:"xPMPP84OOV",defaultMessage:"Target Price"})}),l.jsx("div",{className:"gap-sm flex items-stretch",children:l.jsx(xs,{placeholder:c,className:z(g,"p-sm !rounded-md"),variant:"monospace",isMobileUserAgent:a,value:t,onChange:d,onFocus:m,onBlur:p,disable1pass:!0,colorVariant:r})})]})},UCe=({value:e,onChange:t,positiveSelected:n,onPositiveChange:r,negativeSelected:s,onNegativeChange:a,variant:o="default"})=>{const{isMobileUserAgent:i}=Be(),{$t:c}=Q(),u=f.useCallback(()=>{a(!s)},[s,a]),d=f.useCallback(()=>{r(!n)},[r,n]),m=f.useCallback(y=>{t(b=>LCe(y)||y===""?y:b)},[t]),p=f.useMemo(()=>({delayDurationMs:100}),[]),h=(()=>{switch(o){case"default":return"bg-subtler [&_textarea]:bg-subtler";case"subtle":return"bg-subtle [&_textarea]:bg-subtle";default:St(o)}})(),g=z(CU,h);return l.jsx("div",{className:"gap-md flex flex-col",children:l.jsxs("div",{className:"gap-sm flex flex-col items-start",children:[l.jsx(B,{variant:"tiny",color:"light",children:c({id:"agMnIX4PMS",defaultMessage:"Movement Amount (%)"})}),l.jsxs("div",{className:"gap-md flex h-full items-center",children:[l.jsxs("div",{className:"gap-sm flex h-full items-center",children:[l.jsx(st,{variant:s?"primaryGhost":"border",size:"small",onClick:u,pill:!0,icon:D("minus"),toolTip:c({id:"M9L9vXrgoN",defaultMessage:"Negative Movement"}),tooltipProps:p}),l.jsx(st,{variant:n?"primaryGhost":"border",size:"small",onClick:d,pill:!0,icon:D("plus"),toolTip:c({id:"iFYP+IX00i",defaultMessage:"Positive Movement"}),tooltipProps:p})]}),l.jsx(xs,{className:z(g,"p-sm !rounded-md"),variant:"monospace",isMobileUserAgent:i,value:e,onChange:m,disable1pass:!0,colorVariant:o})]})]})})},BCe=A.memo(function(t){const{selectedSymbol:n,selectedOption:r,onSymbolChange:s,onOptionChange:a,showSymbolInput:o=!0,currentPrice:i,priceValue:c,onPriceValueChange:u,percentValue:d,onPercentValueChange:m,positiveSelected:p,onPositiveChange:h,negativeSelected:g,onNegativeChange:y,externalInputValue:b,variant:x,colorVariant:_="default",currency:v,isAssetSelected:C=!0}=t,w=()=>{switch(x){case"full":return{additionalInstructions:t.additionalInstructions,onAdditionalInstructionsChange:t.onAdditionalInstructionsChange,displayPriceInstructions:t.displayPriceInstructions,displayMovementInstructions:t.displayMovementInstructions};case"trigger":return{additionalInstructions:"",onAdditionalInstructionsChange:()=>{},displayPriceInstructions:void 0,displayMovementInstructions:void 0};default:return St(x)}},{additionalInstructions:S,onAdditionalInstructionsChange:E,displayPriceInstructions:T,displayMovementInstructions:k}=w(),{isMobileUserAgent:M}=Be(),{$t:N,locale:P}=Q(),[O,L]=f.useState(!1),[H,R]=f.useState(0),[I,F]=f.useState(""),[G,j]=f.useState([]),$=f.useRef(null),q=It(),U=f.useRef(I);U.current=I,f.useEffect(()=>{F(b??"")},[b]),f.useEffect(()=>{if(v&&c){const xe=ZE(v.toUpperCase(),P);if(/^\d+(\.\d+)?$/.test(c)){u(xe+c);return}const Te=c.replace(/[^0-9.]/g,"");c.replace(/[0-9.]/g,"").trim()!==xe&&Te&&u(xe+Te)}},[v,P,c,u]);const X=f.useMemo(()=>[{label:N({id:"xPMPP84OOV",defaultMessage:"Target Price"}),value:"price"},{label:N({id:"24152tl1L3",defaultMessage:"Movement Amount"}),value:"movement"}].map(Oe=>({label:Oe.label,value:Oe.value,children:l.jsx("div",{className:"w-full flex-1",children:l.jsx(sP,{label:Oe.label,isActiveOption:r===Oe.value})})})),[r,N]),J=f.useCallback(async xe=>{const Te=(await q.fetchQuery({queryKey:Se.makeEphemeralQueryKey("finance-tasks-autosuggest",xe),queryFn:()=>jCe({query:xe,reason:"finance-add-alert"}),staleTime:0})).map(we=>({query:we.title??"",title:we.title??"",image:we.image??"",imageDark:we.image_dark??"",description:we.description??"",identifier:we.query??""}));j(Te)},[q]),ne=Wg(J,100,{leading:!0,trailing:!0}),ae=f.useCallback(xe=>{ne(xe)},[ne]),de=f.useCallback(()=>{L(!0),R(-1),ae(U.current)},[ae]),oe=f.useCallback(()=>{L(!1)},[]),le=f.useCallback(xe=>{const Oe=xe;F(Oe),ae(Oe),Oe.trim()===""&&(s(null),u(""),m(""))},[ae,s,u,m]),se=f.useCallback(xe=>{s(xe.identifier??null),F(xe.title??""),L(!1),$.current?.blur()},[s]),re=wP({userInputQuery:I,suggestionsDisabled:!O||G.length===0,suggestions:G,focusedIndex:H,setFocusedIndex:R,onChange:xe=>{F(xe)},handleSuggestionSubmission:se,inputRef:$}),he=f.useCallback(xe=>{a(xe)},[a]),ie=f.useCallback(xe=>{E?.(xe)},[E]),ue=z("h-10 rounded-md dark:border-0 dark:border-transparent dark:bg-subtle p-4 dark:[&:focus]:ring-0",{"rounded-t-md rounded-b-none":O&&G.length>0}),ce=f.useMemo(()=>({image:xe,imageDark:Oe,alt:Te})=>l.jsx(e3,{image:xe,imageDark:Oe,alt:Te,watchlistType:"FINANCE",className:"bg-subtler mr-sm !size-8 rounded",imageClassName:"inset-xs"}),[]),me=({onClear:xe})=>l.jsx(pt,{icon:D("x"),size:"tiny",pill:!0,onClick:xe}),pe=f.useMemo(()=>({RightIconComponent:()=>null,LeftIconComponent:ce}),[ce]);return l.jsxs("div",{className:"flex flex-col gap-3",children:[o&&l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx(B,{variant:"tiny",color:"light",children:l.jsx(be,{defaultMessage:"Find a stock, token, or fund...",id:"DTOgClV6qi"})}),l.jsx(mP,{isOpen:O&&G.length>0,suggestedQueries:G,focusedIndex:H,setFocusedIndex:R,handlePasteQuery:jr,handleSubmit:se,value:I,components:pe,dropdownClassName:"dark:border-none dark:ml-0 dark:mr-0 dark:w-full",dropdownType:"select",popoverClassName:"dark:!border-none",children:l.jsx(xs,{autoFocus:!n,onFocus:de,onBlur:oe,onKeyDown:re,className:ue,ref:$,isMobileUserAgent:M,placeholder:N({defaultMessage:"Search for any asset",id:"BeYic/1TvC"}),value:I,onChange:le,ClearIcon:me,colorVariant:_})})]}),l.jsxs("div",{className:z("flex flex-col gap-3 sm:flex-row",!C&&"pointer-events-none opacity-50"),children:[l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx(B,{variant:"tiny",color:"light",children:l.jsx(be,{defaultMessage:"Alert criteria",id:"h44KqVtM6/"})}),l.jsx(ze.div,{layout:!0,layoutRoot:!0,children:l.jsx(rP,{layoutKey:"task",options:X,value:r,onValueChange:he,className:"p-three inline-flex",variant:_})})]}),l.jsxs("div",{className:"gap-md flex flex-col",children:[r==="price"&&l.jsx(FCe,{currentPrice:i,value:c,onChange:u,variant:_,currency:v}),r==="movement"&&l.jsx(UCe,{value:d,onChange:m,positiveSelected:p,onPositiveChange:h,negativeSelected:g,onNegativeChange:y,variant:_})]})]}),x==="full"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"gap-sm flex w-full flex-col items-start",children:[l.jsx("div",{className:"gap-xs flex w-full items-center",children:l.jsx(B,{variant:"smallBold",color:"light",className:"flex shrink-0 items-center",children:N({id:"qax5d8pQCh",defaultMessage:"Default Query"})})}),l.jsx("div",{className:"w-full [&>*]:w-full",children:l.jsx(B,{variant:"small",color:"light",className:"pl-sm border-subtlest border-l-2",children:r==="price"?T:k})})]}),l.jsxs("div",{className:"gap-sm flex w-full flex-col items-start",children:[l.jsx("div",{className:"gap-xs flex w-full items-center",children:l.jsx(B,{variant:"smallBold",color:"light",className:"flex shrink-0 items-center",children:N({id:"QFuOkrgHHJ",defaultMessage:"Additional Instructions (optional)"})})}),l.jsx("div",{className:"w-full [&>*]:w-full",children:l.jsx(Ul,{value:S,onChange:ie,isMobileUserAgent:M,isMobileStyle:!1,minRows:3,placeholder:N({id:"DtwY5RHKrT",defaultMessage:"Check news and social media sentiment to assess consensus or controversy"})})})]})]})]})}),HCe=f.memo(function({trigger:t,onTriggerChange:n,isEditing:r,defaultTargetPriceValue:s}){const{formState:a,onSymbolChange:o,onOptionChange:i,onPriceValueChange:c,onPercentValueChange:u,onPositiveChange:d,onNegativeChange:m}=TCe({trigger:t,onTriggerChange:n}),p=f.useCallback(x=>s||(x.price?VCe(x.price):""),[s]),h=f.useCallback(x=>{switch(a.selectedOption){case"price":{if(x&&!a.priceValue){const _=p(x);_&&c(_)}break}case"movement":break;default:St(a.selectedOption)}},[a.priceValue,a.selectedOption,p,c]),{data:g}=_y({symbol:a.selectedSymbol,onInitialSuccess:h}),y=f.useCallback(x=>{let _="";switch(x){case"price":{_=a.priceValue,g&&(_=p(g));break}case"movement":break;default:St(x)}i(x,_)},[a.priceValue,p,i,g]),b=!!t.symbol&&t.symbol.trim()!=="";return l.jsx("div",{children:l.jsx(BCe,{variant:"trigger",externalInputValue:a.selectedSymbol??void 0,selectedSymbol:a.selectedSymbol,selectedOption:a.selectedOption,onSymbolChange:o,onOptionChange:y,showSymbolInput:!r,currentPrice:g?.price,priceValue:a.priceValue,onPriceValueChange:c,percentValue:a.percentValue,onPercentValueChange:u,positiveSelected:a.positiveSelected,onPositiveChange:d,negativeSelected:a.negativeSelected,onNegativeChange:m,colorVariant:"subtle",currency:g?.currency??void 0,isAssetSelected:b})})});function VCe(e){return(e*(1+parseInt(JE,10)/100)).toFixed(2)}const GCe=[{value:"ONCE",label:"Once"},{value:"DAILY",label:"Daily"},{value:"WEEKLY",label:"Weekly"},{value:"WEEKDAYS",label:"Every weekday"},{value:"MONTHLY",label:"Monthly"},{value:"YEARLY",label:"Yearly"}],zCe=[{value:"0",label:"Sunday"},{value:"1",label:"Monday"},{value:"2",label:"Tuesday"},{value:"3",label:"Wednesday"},{value:"4",label:"Thursday"},{value:"5",label:"Friday"},{value:"6",label:"Saturday"}],qCe=[...Array(31)].map((e,t)=>({value:String(t+1),label:String(t+1)})),$Ce=[{value:"0",label:"January"},{value:"1",label:"February"},{value:"2",label:"March"},{value:"3",label:"April"},{value:"4",label:"May"},{value:"5",label:"June"},{value:"6",label:"July"},{value:"7",label:"August"},{value:"8",label:"September"},{value:"9",label:"October"},{value:"10",label:"November"},{value:"11",label:"December"}],PT=({hour:e,minute:t})=>`${e%12||12}:${t.toString().padStart(2,"0")} ${e>=12?"PM":"AM"}`,OT=e=>{const t=e.trim().match(/^((?:0?[1-9]|1[0-2])):([0-5]\d)\s*([ap]m)$/i);if(!t||t.length!==4)return null;const n=parseInt(t[1]??"",10),r=parseInt(t[2]??"",10);if(isNaN(n)||isNaN(r))return null;const s=t[3]?.toLowerCase();return s==="pm"&&n!==12?{hour:n+12,minute:r}:s==="am"&&n===12?{hour:0,minute:r}:{hour:n,minute:r}},WCe=(e,t)=>e.hour===t.hour&&e.minute===t.minute,KCe=Array.from({length:48},(e,t)=>({hour:Math.floor(t/2),minute:t%2*30}));function YCe({value:e,onChange:t,placeholder:n="Select time",variant:r="default",withIcon:s}){const[a,o]=f.useState(""),[i,c]=f.useState(!1),u=f.useRef(null),d=a.trim()!==""&&!OT(a),m=f.useRef(null),p=e?PT(e):n,h=f.useMemo(()=>KCe.map(w=>({key:`${w.hour}:${w.minute}`,label:PT(w),value:w})),[]),g=f.useCallback(w=>{w&&i&&e&&m.current&&m.current?.scrollIntoView({behavior:"instant",block:"start"})},[i,e]),y=()=>{const w=OT(a);w&&t(w),o("")},b=w=>{t(w),o(""),c(!1)},x=()=>{c(!i)},_=()=>{c(!i),setTimeout(()=>{u.current&&u.current.focus()},0)},v=(()=>{switch(r){case"subtle":return"bg-subtle";case"default":return"bg-subtler";default:St(r)}})(),C=f.useMemo(()=>l.jsx(ye,{icon:D("clock"),size:"sm"}),[]);return l.jsx("div",{className:"relative size-full",children:l.jsx(fa,{interaction:"click",open:i,onOpenChange:c,triggerElement:l.jsxs("div",{role:"button",tabIndex:0,onClick:x,className:z(v,"text-foreground flex size-full cursor-pointer items-center gap-2 rounded-lg px-4 font-sans","border transition-colors duration-200 ease-out","outline-none focus:outline-none focus:ring-0","hover:border-subtler focus-within:border-subtler border-transparent",{"!border-negative":d}),children:[s&&C,l.jsx("input",{ref:u,type:"text",value:a||p,placeholder:n,onChange:w=>o(w.target.value),onBlur:y,onClick:_,className:"w-full bg-transparent text-sm focus:outline-none"}),l.jsx(ye,{size:"xs",icon:D("chevron-down"),className:"right-sm pointer-events-none absolute text-inherit opacity-50"})]}),children:l.jsx("div",{ref:g,className:"p-xs scrollbar-subtle max-h-64 overflow-y-auto",children:h.map(w=>l.jsx("div",{ref:e&&WCe(w.value,e)?m:null,role:"button",tabIndex:0,onClick:()=>b(w.value),className:"px-sm text-foreground cursor-pointer rounded-lg py-1.5 hover:bg-subtler",children:l.jsx(B,{variant:"extraSmall",children:w.label})},w.key))})})})}const Cp=f.memo(function({options:t,value:n,onChange:r}){const s=Q(),a=f.useCallback(c=>{r(c)},[r]),i=f.useMemo(()=>t.find(c=>c.value===n),[t,n])?.label||s.formatMessage({defaultMessage:"Select...",id:"724CrE1YuG"});return l.jsx(Sf,{children:l.jsx(Qe,{triggerElement:l.jsx(Du,{size:"default",children:i}),children:l.jsx(Qe.RadioGroup,{value:n,onValueChange:a,closeOnSelect:!0,children:t.map(c=>l.jsx(Qe.RadioItem,{value:c.value,children:c.label},c.value))})})})}),QCe=f.memo(function({schedule:t,onScheduleChange:n,variant:r="default"}){const{formatMessage:s}=Q(),a=f.useMemo(()=>new Date(t.year,t.month,t.day,t.hour,t.minute),[t.year,t.month,t.day,t.hour,t.minute]),{kind:o}=t,i=o==="ONCE",c=o==="WEEKLY",u=o==="MONTHLY"||o==="YEARLY",d=o==="YEARLY",m=f.useCallback(_=>{n({kind:_})},[n]),p=f.useCallback(_=>{n({dayOfWeek:parseInt(_,10)})},[n]),h=f.useCallback(_=>{n({month:parseInt(_,10)})},[n]),g=f.useCallback(_=>{n({day:parseInt(_,10)})},[n]),y=f.useCallback(_=>{_&&n({day:_.getDate(),month:_.getMonth(),year:_.getFullYear()})},[n]),b=f.useCallback(_=>{n({hour:_.hour,minute:_.minute})},[n]),x=f.useMemo(()=>({hour:t.hour,minute:t.minute}),[t.hour,t.minute]);return l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx(B,{variant:"tiny",color:"light",className:"select-none",children:s({defaultMessage:"Schedule",id:"hGQqkWwmJD"})}),l.jsxs("div",{className:"flex h-10 flex-wrap gap-3",children:[l.jsx(Cp,{options:GCe,value:t.kind,onChange:m}),c&&l.jsx(Cp,{options:zCe,value:String(t.dayOfWeek),onChange:p}),d&&l.jsx(Cp,{options:$Ce,value:String(t.month),onChange:h}),u&&l.jsx(Cp,{options:qCe,value:String(t.day),onChange:g}),i&&l.jsx(Sf,{children:l.jsx(mg,{value:a,onChange:y,variant:r})}),l.jsx(Sf,{children:l.jsx(YCe,{value:x,onChange:b,variant:r})})]})]})}),LT=f.memo(function({trigger:t,onTriggerChange:n}){const r=f.useMemo(()=>t?.schedule??vr(),[t?.schedule]),s=f.useCallback(a=>{n({type:nt.SCHEDULED,...t,schedule:{...r,...a}})},[n,r,t]);return l.jsx(QCe,{schedule:r,onScheduleChange:s,variant:"subtle"})}),XCe=f.memo(function(){return l.jsx("div",{children:"Shortcut Trigger Configuration"})}),ZCe=f.memo(function({trigger:t,onTriggerChange:n,isEditing:r=!1,defaultTargetPriceValue:s}){if(!t)return l.jsx(LT,{trigger:null,onTriggerChange:n});switch(t.type){case nt.SCHEDULED:return l.jsx(LT,{trigger:t,onTriggerChange:n});case nt.PRICE_ALERT:return l.jsx(HCe,{trigger:t,onTriggerChange:n,isEditing:r,defaultTargetPriceValue:s});case nt.SHORTCUT:return l.jsx(XCe,{});default:St(t)}}),JCe=async({limit:e=50,offset:t=0,reason:n})=>{const{data:r,error:s,response:a}=await ve.GET("/rest/spaces/writable",n,{params:{query:{limit:e,offset:t}},timeoutMs:Ct()});if(s)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to list writable spaces",cause:s,status:a.status??0});return r},ewe=50;function twe({reason:e,limit:t=ewe}){const n=XW({queryKey:Se.makeQueryKey(VP),queryFn:({pageParam:s=0})=>JCe({limit:t,offset:s,reason:e}),getNextPageParam:(s,a)=>{if(s.has_next_page)return a.length*t},initialPageParam:0}),r=f.useMemo(()=>n.data?.pages?.flatMap(s=>s.spaces)??[],[n.data]);return{...n,spaces:r}}const wU=f.memo(function({emoji:t,size:n="md"}){return l.jsx(B,{variant:n==="lg"?"section-title":"base",className:z("flex items-center justify-center",{"size-5":n==="lg","size-4":n==="md"}),children:t})}),nwe=f.memo(function({space:t,isSelected:n,onSelect:r}){const s=_S(t.emoji),a=f.useMemo(()=>s?()=>l.jsx(wU,{emoji:s}):D("layout-grid"),[s]);return l.jsx(Qe.Item,{leadingAccessory:a,trailingAccessory:n?l.jsx(_n,{icon:D("check"),size:"default"}):void 0,onSelect:()=>r(t.uuid),children:t.title})}),rwe=f.memo(function({selectedSpaceUuid:t,onSpaceChange:n,disabled:r=!1}){const{$t:s}=Q(),{openToast:a}=cn(),[o,i]=f.useState(!1),{spaces:c,isLoading:u,isError:d}=twe({reason:"automation-modal-space-selector"}),m=f.useCallback(y=>{r||u||d||i(y)},[r,u,d]);f.useEffect(()=>{d&&a({message:s({defaultMessage:"Failed to load spaces",id:"+uuI8WqZfv"}),variant:"error",timeout:null})},[d,s,a]);const p=c.find(y=>y.uuid===t),h=p?_S(p.emoji):null,g=f.useMemo(()=>h?()=>l.jsx(wU,{emoji:h,size:"lg"}):D("layout-grid"),[h]);return!u&&!d&&c.length===0?null:l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx(B,{variant:"tiny",color:"light",className:"select-none",children:l.jsx(be,{defaultMessage:"Space",id:"0ah2udCSKF"})}),l.jsx(Qe,{isOpen:o,onToggle:m,triggerElement:l.jsx(Du,{size:"default",disabled:r||u||d,leadingAccessory:g,children:p?p.title:l.jsx(be,{defaultMessage:"None Selected",id:"HeX7TW9V+Q"})}),children:l.jsxs("div",{className:"max-h-[38vh] overflow-y-auto",children:[t&&l.jsx(Qe.Item,{leadingAccessory:D("x"),onSelect:()=>n(null),children:l.jsx(be,{defaultMessage:"Clear Selection",id:"WbPFiMz647"})}),c.map(y=>l.jsx(nwe,{space:y,isSelected:y.uuid===t,onSelect:n},y.uuid))]})})]})}),swe=(e,t)=>{const{value:n,loading:r}=Lt({flag:"tasks-notification-settings-enabled",defaultValue:e,extraAttributes:t,subjectType:"user_nextauth_id"});return f.useMemo(()=>({variation:n,loading:r}),[n,r])},E1=new Date,k1=new Date;function or(e,t,n,r){function s(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return s.floor=a=>(e(a=new Date(+a)),a),s.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),s.round=a=>{const o=s(a),i=s.ceil(a);return a-o<i-a?o:i},s.offset=(a,o)=>(t(a=new Date(+a),o==null?1:Math.floor(o)),a),s.range=(a,o,i)=>{const c=[];if(a=s.ceil(a),i=i==null?1:Math.floor(i),!(a<o)||!(i>0))return c;let u;do c.push(u=new Date(+a)),t(a,i),e(a);while(u<a&&a<o);return c},s.filter=a=>or(o=>{if(o>=o)for(;e(o),!a(o);)o.setTime(o-1)},(o,i)=>{if(o>=o)if(i<0)for(;++i<=0;)for(;t(o,-1),!a(o););else for(;--i>=0;)for(;t(o,1),!a(o););}),n&&(s.count=(a,o)=>(E1.setTime(+a),k1.setTime(+o),e(E1),e(k1),Math.floor(n(E1,k1))),s.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?s.filter(r?o=>r(o)%a===0:o=>s.count(0,o)%a===0):s)),s}const pg=or(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);pg.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?or(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):pg);pg.range;const bo=1e3,Ps=bo*60,_o=Ps*60,No=_o*24,t3=No*7,FT=No*30,M1=No*365,vo=or(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*bo)},(e,t)=>(t-e)/bo,e=>e.getUTCSeconds());vo.range;const vy=or(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*bo)},(e,t)=>{e.setTime(+e+t*Ps)},(e,t)=>(t-e)/Ps,e=>e.getMinutes());vy.range;const Cy=or(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ps)},(e,t)=>(t-e)/Ps,e=>e.getUTCMinutes());Cy.range;const wy=or(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*bo-e.getMinutes()*Ps)},(e,t)=>{e.setTime(+e+t*_o)},(e,t)=>(t-e)/_o,e=>e.getHours());wy.range;const Sy=or(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*_o)},(e,t)=>(t-e)/_o,e=>e.getUTCHours());Sy.range;const Pu=or(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ps)/No,e=>e.getDate()-1);Pu.range;const _m=or(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/No,e=>e.getUTCDate()-1);_m.range;const SU=or(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/No,e=>Math.floor(e/No));SU.range;function Vl(e){return or(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Ps)/t3)}const vm=Vl(0),hg=Vl(1),awe=Vl(2),owe=Vl(3),nu=Vl(4),iwe=Vl(5),lwe=Vl(6);vm.range;hg.range;awe.range;owe.range;nu.range;iwe.range;lwe.range;function Gl(e){return or(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/t3)}const Cm=Gl(0),gg=Gl(1),cwe=Gl(2),uwe=Gl(3),ru=Gl(4),dwe=Gl(5),fwe=Gl(6);Cm.range;gg.range;cwe.range;uwe.range;ru.range;dwe.range;fwe.range;const wm=or(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());wm.range;const Ey=or(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Ey.range;const pa=or(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());pa.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:or(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});pa.range;const Ya=or(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Ya.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:or(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Ya.range;function Yd(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function mwe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Sm(e){let t,n,r;e.length!==2?(t=Yd,n=(i,c)=>Yd(e(i),c),r=(i,c)=>e(i)-c):(t=e===Yd||e===mwe?e:pwe,n=e,r=e);function s(i,c,u=0,d=i.length){if(u<d){if(t(c,c)!==0)return d;do{const m=u+d>>>1;n(i[m],c)<0?u=m+1:d=m}while(u<d)}return u}function a(i,c,u=0,d=i.length){if(u<d){if(t(c,c)!==0)return d;do{const m=u+d>>>1;n(i[m],c)<=0?u=m+1:d=m}while(u<d)}return u}function o(i,c,u=0,d=i.length){const m=s(i,c,u,d-1);return m>u&&r(i[m-1],c)>-r(i[m],c)?m-1:m}return{left:s,center:o,right:a}}function pwe(){return 0}function EU(e){return e===null?NaN:+e}const hwe=Sm(Yd),Ou=hwe.right;Sm(EU).center;function Os(e,t){let n,r;if(t===void 0)for(const s of e)s!=null&&(n===void 0?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)));else{let s=-1;for(let a of e)(a=t(a,++s,e))!=null&&(n===void 0?a>=a&&(n=r=a):(n>a&&(n=a),r<a&&(r=a)))}return[n,r]}class UT extends Map{constructor(t,n=xwe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,s]of t)this.set(r,s)}get(t){return super.get(BT(this,t))}has(t){return super.has(BT(this,t))}set(t,n){return super.set(gwe(this,t),n)}delete(t){return super.delete(ywe(this,t))}}function BT({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function gwe({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function ywe({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function xwe(e){return e!==null&&typeof e=="object"?e.valueOf():e}var W_=Math.sqrt(50),K_=Math.sqrt(10),Y_=Math.sqrt(2);function Q_(e,t,n){var r,s=-1,a,o,i;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((r=t<e)&&(a=e,e=t,t=a),(i=kU(e,t,n))===0||!isFinite(i))return[];if(i>0){let c=Math.round(e/i),u=Math.round(t/i);for(c*i<e&&++c,u*i>t&&--u,o=new Array(a=u-c+1);++s<a;)o[s]=(c+s)*i}else{i=-i;let c=Math.round(e*i),u=Math.round(t*i);for(c/i<e&&++c,u/i>t&&--u,o=new Array(a=u-c+1);++s<a;)o[s]=(c+s)/i}return r&&o.reverse(),o}function kU(e,t,n){var r=(t-e)/Math.max(0,n),s=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,s);return s>=0?(a>=W_?10:a>=K_?5:a>=Y_?2:1)*Math.pow(10,s):-Math.pow(10,-s)/(a>=W_?10:a>=K_?5:a>=Y_?2:1)}function X_(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),s=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/s;return a>=W_?s*=10:a>=K_?s*=5:a>=Y_&&(s*=2),t<e?-s:s}function bwe(e,t,n=EU){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,s=(r-1)*t,a=Math.floor(s),o=+n(e[a],a,e),i=+n(e[a+1],a+1,e);return o+(i-o)*(s-a)}}function _we(e,t,n){e=+e,t=+t,n=(s=arguments.length)<2?(t=e,e=0,1):s<3?1:+n;for(var r=-1,s=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(s);++r<s;)a[r]=e+r*n;return a}function MU(e,t,n,r,s,a){const o=[[vo,1,bo],[vo,5,5*bo],[vo,15,15*bo],[vo,30,30*bo],[a,1,Ps],[a,5,5*Ps],[a,15,15*Ps],[a,30,30*Ps],[s,1,_o],[s,3,3*_o],[s,6,6*_o],[s,12,12*_o],[r,1,No],[r,2,2*No],[n,1,t3],[t,1,FT],[t,3,3*FT],[e,1,M1]];function i(u,d,m){const p=d<u;p&&([u,d]=[d,u]);const h=m&&typeof m.range=="function"?m:c(u,d,m),g=h?h.range(u,+d+1):[];return p?g.reverse():g}function c(u,d,m){const p=Math.abs(d-u)/m,h=Sm(([,,b])=>b).right(o,p);if(h===o.length)return e.every(X_(u/M1,d/M1,m));if(h===0)return pg.every(Math.max(X_(u,d,m),1));const[g,y]=o[p/o[h-1][2]<o[h][2]/p?h-1:h];return g.every(y)}return[i,c]}const[vwe,Cwe]=MU(Ya,Ey,Cm,SU,Sy,Cy),[wwe,Swe]=MU(pa,wm,vm,Pu,wy,vy);function T1(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function A1(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function fd(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Ewe(e){var t=e.dateTime,n=e.date,r=e.time,s=e.periods,a=e.days,o=e.shortDays,i=e.months,c=e.shortMonths,u=md(s),d=pd(s),m=md(a),p=pd(a),h=md(o),g=pd(o),y=md(i),b=pd(i),x=md(c),_=pd(c),v={a:I,A:F,b:G,B:j,c:null,d:$T,e:$T,f:Kwe,g:sSe,G:oSe,H:qwe,I:$we,j:Wwe,L:TU,m:Ywe,M:Qwe,p:$,q,Q:YT,s:QT,S:Xwe,u:Zwe,U:Jwe,V:eSe,w:tSe,W:nSe,x:null,X:null,y:rSe,Y:aSe,Z:iSe,"%":KT},C={a:U,A:X,b:J,B:ne,c:null,d:WT,e:WT,f:dSe,g:vSe,G:wSe,H:lSe,I:cSe,j:uSe,L:NU,m:fSe,M:mSe,p:ae,q:de,Q:YT,s:QT,S:pSe,u:hSe,U:gSe,V:ySe,w:xSe,W:bSe,x:null,X:null,y:_Se,Y:CSe,Z:SSe,"%":KT},w={a:M,A:N,b:P,B:O,c:L,d:zT,e:zT,f:Hwe,g:GT,G:VT,H:qT,I:qT,j:Lwe,L:Bwe,m:Owe,M:Fwe,p:k,q:Pwe,Q:Gwe,s:zwe,S:Uwe,u:Nwe,U:Rwe,V:Dwe,w:Awe,W:Iwe,x:H,X:R,y:GT,Y:VT,Z:jwe,"%":Vwe};v.x=S(n,v),v.X=S(r,v),v.c=S(t,v),C.x=S(n,C),C.X=S(r,C),C.c=S(t,C);function S(oe,le){return function(se){var re=[],he=-1,ie=0,ue=oe.length,ce,me,pe;for(se instanceof Date||(se=new Date(+se));++he<ue;)oe.charCodeAt(he)===37&&(re.push(oe.slice(ie,he)),(me=HT[ce=oe.charAt(++he)])!=null?ce=oe.charAt(++he):me=ce==="e"?" ":"0",(pe=le[ce])&&(ce=pe(se,me)),re.push(ce),ie=he+1);return re.push(oe.slice(ie,he)),re.join("")}}function E(oe,le){return function(se){var re=fd(1900,void 0,1),he=T(re,oe,se+="",0),ie,ue;if(he!=se.length)return null;if("Q"in re)return new Date(re.Q);if("s"in re)return new Date(re.s*1e3+("L"in re?re.L:0));if(le&&!("Z"in re)&&(re.Z=0),"p"in re&&(re.H=re.H%12+re.p*12),re.m===void 0&&(re.m="q"in re?re.q:0),"V"in re){if(re.V<1||re.V>53)return null;"w"in re||(re.w=1),"Z"in re?(ie=A1(fd(re.y,0,1)),ue=ie.getUTCDay(),ie=ue>4||ue===0?gg.ceil(ie):gg(ie),ie=_m.offset(ie,(re.V-1)*7),re.y=ie.getUTCFullYear(),re.m=ie.getUTCMonth(),re.d=ie.getUTCDate()+(re.w+6)%7):(ie=T1(fd(re.y,0,1)),ue=ie.getDay(),ie=ue>4||ue===0?hg.ceil(ie):hg(ie),ie=Pu.offset(ie,(re.V-1)*7),re.y=ie.getFullYear(),re.m=ie.getMonth(),re.d=ie.getDate()+(re.w+6)%7)}else("W"in re||"U"in re)&&("w"in re||(re.w="u"in re?re.u%7:"W"in re?1:0),ue="Z"in re?A1(fd(re.y,0,1)).getUTCDay():T1(fd(re.y,0,1)).getDay(),re.m=0,re.d="W"in re?(re.w+6)%7+re.W*7-(ue+5)%7:re.w+re.U*7-(ue+6)%7);return"Z"in re?(re.H+=re.Z/100|0,re.M+=re.Z%100,A1(re)):T1(re)}}function T(oe,le,se,re){for(var he=0,ie=le.length,ue=se.length,ce,me;he<ie;){if(re>=ue)return-1;if(ce=le.charCodeAt(he++),ce===37){if(ce=le.charAt(he++),me=w[ce in HT?le.charAt(he++):ce],!me||(re=me(oe,se,re))<0)return-1}else if(ce!=se.charCodeAt(re++))return-1}return re}function k(oe,le,se){var re=u.exec(le.slice(se));return re?(oe.p=d.get(re[0].toLowerCase()),se+re[0].length):-1}function M(oe,le,se){var re=h.exec(le.slice(se));return re?(oe.w=g.get(re[0].toLowerCase()),se+re[0].length):-1}function N(oe,le,se){var re=m.exec(le.slice(se));return re?(oe.w=p.get(re[0].toLowerCase()),se+re[0].length):-1}function P(oe,le,se){var re=x.exec(le.slice(se));return re?(oe.m=_.get(re[0].toLowerCase()),se+re[0].length):-1}function O(oe,le,se){var re=y.exec(le.slice(se));return re?(oe.m=b.get(re[0].toLowerCase()),se+re[0].length):-1}function L(oe,le,se){return T(oe,t,le,se)}function H(oe,le,se){return T(oe,n,le,se)}function R(oe,le,se){return T(oe,r,le,se)}function I(oe){return o[oe.getDay()]}function F(oe){return a[oe.getDay()]}function G(oe){return c[oe.getMonth()]}function j(oe){return i[oe.getMonth()]}function $(oe){return s[+(oe.getHours()>=12)]}function q(oe){return 1+~~(oe.getMonth()/3)}function U(oe){return o[oe.getUTCDay()]}function X(oe){return a[oe.getUTCDay()]}function J(oe){return c[oe.getUTCMonth()]}function ne(oe){return i[oe.getUTCMonth()]}function ae(oe){return s[+(oe.getUTCHours()>=12)]}function de(oe){return 1+~~(oe.getUTCMonth()/3)}return{format:function(oe){var le=S(oe+="",v);return le.toString=function(){return oe},le},parse:function(oe){var le=E(oe+="",!1);return le.toString=function(){return oe},le},utcFormat:function(oe){var le=S(oe+="",C);return le.toString=function(){return oe},le},utcParse:function(oe){var le=E(oe+="",!0);return le.toString=function(){return oe},le}}}var HT={"-":"",_:" ",0:"0"},xr=/^\s*\d+/,kwe=/^%/,Mwe=/[\\^$*+?|[\]().{}]/g;function Zt(e,t,n){var r=e<0?"-":"",s=(r?-e:e)+"",a=s.length;return r+(a<n?new Array(n-a+1).join(t)+s:s)}function Twe(e){return e.replace(Mwe,"\\$&")}function md(e){return new RegExp("^(?:"+e.map(Twe).join("|")+")","i")}function pd(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function Awe(e,t,n){var r=xr.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Nwe(e,t,n){var r=xr.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Rwe(e,t,n){var r=xr.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Dwe(e,t,n){var r=xr.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Iwe(e,t,n){var r=xr.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function VT(e,t,n){var r=xr.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function GT(e,t,n){var r=xr.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function jwe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Pwe(e,t,n){var r=xr.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function Owe(e,t,n){var r=xr.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function zT(e,t,n){var r=xr.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Lwe(e,t,n){var r=xr.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function qT(e,t,n){var r=xr.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Fwe(e,t,n){var r=xr.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Uwe(e,t,n){var r=xr.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Bwe(e,t,n){var r=xr.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Hwe(e,t,n){var r=xr.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Vwe(e,t,n){var r=kwe.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Gwe(e,t,n){var r=xr.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function zwe(e,t,n){var r=xr.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function $T(e,t){return Zt(e.getDate(),t,2)}function qwe(e,t){return Zt(e.getHours(),t,2)}function $we(e,t){return Zt(e.getHours()%12||12,t,2)}function Wwe(e,t){return Zt(1+Pu.count(pa(e),e),t,3)}function TU(e,t){return Zt(e.getMilliseconds(),t,3)}function Kwe(e,t){return TU(e,t)+"000"}function Ywe(e,t){return Zt(e.getMonth()+1,t,2)}function Qwe(e,t){return Zt(e.getMinutes(),t,2)}function Xwe(e,t){return Zt(e.getSeconds(),t,2)}function Zwe(e){var t=e.getDay();return t===0?7:t}function Jwe(e,t){return Zt(vm.count(pa(e)-1,e),t,2)}function AU(e){var t=e.getDay();return t>=4||t===0?nu(e):nu.ceil(e)}function eSe(e,t){return e=AU(e),Zt(nu.count(pa(e),e)+(pa(e).getDay()===4),t,2)}function tSe(e){return e.getDay()}function nSe(e,t){return Zt(hg.count(pa(e)-1,e),t,2)}function rSe(e,t){return Zt(e.getFullYear()%100,t,2)}function sSe(e,t){return e=AU(e),Zt(e.getFullYear()%100,t,2)}function aSe(e,t){return Zt(e.getFullYear()%1e4,t,4)}function oSe(e,t){var n=e.getDay();return e=n>=4||n===0?nu(e):nu.ceil(e),Zt(e.getFullYear()%1e4,t,4)}function iSe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Zt(t/60|0,"0",2)+Zt(t%60,"0",2)}function WT(e,t){return Zt(e.getUTCDate(),t,2)}function lSe(e,t){return Zt(e.getUTCHours(),t,2)}function cSe(e,t){return Zt(e.getUTCHours()%12||12,t,2)}function uSe(e,t){return Zt(1+_m.count(Ya(e),e),t,3)}function NU(e,t){return Zt(e.getUTCMilliseconds(),t,3)}function dSe(e,t){return NU(e,t)+"000"}function fSe(e,t){return Zt(e.getUTCMonth()+1,t,2)}function mSe(e,t){return Zt(e.getUTCMinutes(),t,2)}function pSe(e,t){return Zt(e.getUTCSeconds(),t,2)}function hSe(e){var t=e.getUTCDay();return t===0?7:t}function gSe(e,t){return Zt(Cm.count(Ya(e)-1,e),t,2)}function RU(e){var t=e.getUTCDay();return t>=4||t===0?ru(e):ru.ceil(e)}function ySe(e,t){return e=RU(e),Zt(ru.count(Ya(e),e)+(Ya(e).getUTCDay()===4),t,2)}function xSe(e){return e.getUTCDay()}function bSe(e,t){return Zt(gg.count(Ya(e)-1,e),t,2)}function _Se(e,t){return Zt(e.getUTCFullYear()%100,t,2)}function vSe(e,t){return e=RU(e),Zt(e.getUTCFullYear()%100,t,2)}function CSe(e,t){return Zt(e.getUTCFullYear()%1e4,t,4)}function wSe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?ru(e):ru.ceil(e),Zt(e.getUTCFullYear()%1e4,t,4)}function SSe(){return"+0000"}function KT(){return"%"}function YT(e){return+e}function QT(e){return Math.floor(+e/1e3)}var sc,Em,DU;ESe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ESe(e){return sc=Ewe(e),Em=sc.format,sc.parse,DU=sc.utcFormat,sc.utcParse,sc}const kSe=Em("%b %d"),MSe=Em("%b"),TSe=Em("%Y");function ASe(e){return e?(e=new Date(e),(wm(e)<e?kSe:pa(e)<e?MSe:TSe)(e)):""}const Z_=(e,t,n)=>{if(!e&&(e!==0||!n?.renderZero))return"";const s=t&&/^[A-Z]{3}$/.test(t)?t:void 0,a=e%1===0&&!n?.alwaysShowMinor||n?.roundToMajor?0:2;let o=n?.roundToMajor?0:2;if(e>0&&e<1){const c=Math.abs(e).toExponential();o=Math.abs(parseInt(c.split("e")[1]))+1}const i=Intl.NumberFormat(void 0,{style:s?"currency":"decimal",currency:s,minimumFractionDigits:1,maximumFractionDigits:1,currencyDisplay:n?.currencyDisplay??"narrowSymbol"});return n?.truncate&&e>=1e6?`${i.format(e/1e6)}M`:n?.truncate&&e>=1e3?`${i.format(e/1e3)}k`:e.toLocaleString(void 0,{style:s?"currency":"decimal",currency:s,minimumFractionDigits:a,maximumFractionDigits:o,currencyDisplay:n?.currencyDisplay??"narrowSymbol"})},IU=f.memo(function({configuration:t,onConfigurationChange:n,errorMessage:r,onError:s,canEditSpace:a}){const o=!!t.id,i=f.useCallback(g=>{let y=t.query;switch(g.type){case nt.PRICE_ALERT:{y={...t.query,prompt:t.query.prompt};break}case nt.SCHEDULED:case nt.SHORTCUT:break;default:St(g)}const b={...t,trigger:g,query:y};s?.(null),n(b)},[t,n,s]),c=f.useCallback(g=>{const y={...t,query:g};n(y)},[t,n]),u=f.useCallback(g=>{const y={...t,collectionUuid:g};n(y)},[t,n]),d=f.useCallback(g=>{const y={...t,notificationSettings:g};n(y)},[t,n]),{variation:m,loading:p}=swe(!0),h=t.trigger.type===nt.PRICE_ALERT&&(!t.trigger.symbol||t.trigger.symbol.trim()==="");return l.jsxs("div",{className:"flex flex-col gap-3",children:[l.jsx(ICe,{trigger:t.trigger,query:t.query,onQueryChange:c}),t.trigger.type===nt.SCHEDULED&&l.jsx(rwe,{selectedSpaceUuid:t.collectionUuid,onSpaceChange:u,disabled:!a}),l.jsx(ZCe,{trigger:t.trigger,onTriggerChange:i,isEditing:o,defaultTargetPriceValue:t.defaultTargetPriceValue}),l.jsx(SCe,{trigger:t.trigger,onTriggerChange:i}),!p&&m&&l.jsx(kCe,{notificationSettings:t.notificationSettings??ju,onNotificationSettingsChange:d,disabled:h}),t.trigger.type===nt.PRICE_ALERT&&l.jsx("div",{className:"flex flex-col gap-2",children:l.jsx(vU,{trigger:t.trigger,prompt:t.query.prompt,onPromptChange:g=>c({...t.query,prompt:g}),variant:"subtle",disabled:h})}),l.jsx(vCe,{trigger:t.trigger,query:t.query,onQueryChange:c}),r&&l.jsxs("div",{className:"gap-xs flex items-center",children:[l.jsx(ut,{name:D("exclamation-circle"),size:12,className:"text-caution"}),l.jsx(B,{variant:"tinyRegular",color:"red",className:"mt-0.5",children:r})]})]})});function NSe(e,t,n,r){return{prompt:t.prompt,model_preference:t.searchModel,sources:t.sources,schedule:gU(e.schedule),task_name:"",expiry_date:yU(e.expiryDate??e.defaultExpiryDate),notification_settings:n,collection_uuid:r??void 0}}function RSe(e,t){return{prompt:t.prompt,model_preference:t.searchModel,sources:t.sources,task_name:e.shortcut,schedule:{rrule:"",start_at:"",tzid:""}}}function jU({trigger:e,query:t,quote:n}){const{symbol:r}=e,s=n?.name?` (${n.name})`:void 0;switch(e.alertType){case nr.TARGET_PRICE:{const a=n?.price||0,o=my({symbol:r,quoteName:s}),i=e.price>a?"above":"below",c=OM({rawInstructions:o,symbol:r,quoteName:s||"",eventValue:`$${e.price}`,direction:i}),u=PM({prompt:t.prompt,baseInstructions:c});return LM({symbol:r,alertType:"price",priceValue:`$${e.price}`,priceThreshold:i,baseInstructions:c,additionalInstructions:u})}case nr.MOVEMENT_AMOUNT:{const a=py({symbol:r,quoteName:s}),o=e.percentageDecimalUpperBound>0&&e.percentageDecimalUpperBound!==Zc/100,i=e.percentageDecimalLowerBound<0&&e.percentageDecimalLowerBound!==Jc/100;let c,u;o&&i?(c=(e.percentageDecimalUpperBound*100).toFixed(2),u="increase or decrease"):o?(c=(e.percentageDecimalUpperBound*100).toFixed(2),u="increase"):i?(c=(Math.abs(e.percentageDecimalLowerBound)*100).toFixed(2),u="decrease"):(c="0.00",u="change");const d=OM({rawInstructions:a,symbol:r,quoteName:s||"",eventValue:c,direction:u}),m=PM({prompt:t.prompt,baseInstructions:d});return LM({symbol:r,alertType:"movement",percentValue:c,positiveSelected:o,negativeSelected:i,baseInstructions:d,additionalInstructions:m})}default:St(e)}}function DSe(e,t,n,r,s){return{prompt:t.prompt,model_preference:t.searchModel,sources:t.sources,status:n==="COMPLETED"?"PAUSED":n,schedule:gU(e.schedule),expiry_date:yU(e.expiryDate??e.defaultExpiryDate),clear_expiry:e.expiryDate===null?!0:void 0,notification_settings:r,collection_uuid:s===null?void 0:s,clear_collection_uuid:s===null?!0:void 0}}function ISe(e,t,n){return{prompt:t.prompt,model_preference:t.searchModel,sources:t.sources,status:n==="COMPLETED"?"PAUSED":n,task_name:e.shortcut}}function jSe({trigger:e,query:t,status:n,quote:r}){const s=jU({trigger:e,query:t,quote:r});return s?{task_name:s.task_name,prompt:s.prompt,event_subscription:s.event_subscription,model_preference:s.model_preference,status:n==="COMPLETED"?"PAUSED":n}:null}const PSe=async({payload:e,reason:t})=>{const{data:n,error:r,response:s}=await ve.POST("/rest/tasks/finance",t,{body:e});if(r)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to create user finance task",cause:r,status:s.status??0});return n},PU=async({taskId:e,reason:t})=>ve.DELETE("/rest/tasks/{task_id}",t,{params:{path:{task_id:e}},timeoutMs:vP}),OSe=async({taskId:e,payload:t,reason:n})=>{const{data:r,error:s,response:a}=await ve.PATCH("/rest/tasks/finance/{task_id}",n,{params:{path:{task_id:e}},body:t});if(s)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to update user finance task",cause:s,status:a.status??0});return r};function LSe({onCreateSuccess:e,onCreateError:t,onUpdateSuccess:n,onUpdateError:r,onDeleteSuccess:s,onDeleteError:a}={}){const{$t:o}=Q(),i=It(),c=on({mutationFn:p=>PSe({payload:p,reason:"finance-add-alert"}),onSuccess:()=>{i.invalidateQueries({queryKey:gh()}),e?.()},onError:p=>t?.(p)}),u=on({mutationFn:({taskId:p,payload:h})=>OSe({taskId:p,payload:h,reason:"finance-edit-alert"}),onSuccess:()=>{i.invalidateQueries({queryKey:gh()}),n?.()},onError:p=>{if(p instanceof Error)switch(p.name){case"TimeoutError":r?.({detail:o({defaultMessage:"Network Timeout",id:"Z+mLGQc4GD"})});break;default:Z.error(`Unknown error occured: ${p.name}`),r?.({detail:o({defaultMessage:"Unknown error occurred",id:"y1q3uzCFY6"})})}else r?.(p)}}),d=on({mutationFn:p=>PU({taskId:p,reason:"finance-delete-alert"}),onSuccess:()=>{i.invalidateQueries({queryKey:gh()}),s?.()},onError:()=>a?.()}),m=c.isPending||u.isPending||d.isPending;return f.useMemo(()=>({createMutation:c,updateMutation:u,deleteMutation:d,isMutationLoading:m}),[c,u,d,m])}const XT={TASK_LIMIT_EXCEEDED:"TASK_LIMIT_EXCEEDED",SHORTCUT_NAME_ALREADY_EXISTS:"SHORTCUT_NAME_ALREADY_EXISTS"},FSe=()=>{const{formatMessage:e}=Q();return{getErrorMessage:n=>{switch(n?.detail?.error_code){case XT.TASK_LIMIT_EXCEEDED:return e({defaultMessage:"You have reached the maximum of number of active tasks of this type for your subscription level.",id:"3H43PMJpfD"});case XT.SHORTCUT_NAME_ALREADY_EXISTS:return e({defaultMessage:"A shortcut with this name already exists. Please choose a different name.",id:"GpnXJDWEkN"});default:return e({defaultMessage:"Something went wrong. Please try again.",id:"W/5hwrn09m"})}}}},USe={settings_create:!0,settings_edit:!0,settings_suggest:!0,settings_primer:!0,task_widget:!0,discover_task_widget:!0,thread_dropdown:!0,typeahead_create:!0,notifications_panel:!0,router:!0,space_tasks_create:!0,space_tasks_edit:!0,study_hub_spaced_repetition:!0};function BSe(e){return e in USe}const HSe={settings_create:!0,settings_edit:!0,settings_suggest:!0,finance_home_page:!0,finance_asset_page:!0};function eQe(e){return e in HSe}const VSe={settings_create:!0,settings_edit:!0,typeahead_create:!0,thread_create:!0,suggestions_dropdown:!0,notifications_panel:!0,typeahead_edit:!0,shortcut_widget:!0,settings_paste:!0,try_assistant_suggestions:!0,thread_upsell_create:!0};function tQe(e){return e in VSe}const GSe={created:!0,updated:!0,deleted:!0,paused:!0,resumed:!0,skipped:!0};function zSe(e){return e in GSe}const qSe={created:!0,updated:!0,deleted:!0,paused:!0,resumed:!0,skipped:!0};function nQe(e){return e in qSe}const $Se={created:!0,updated:!0,deleted:!0,copied:!0,skipped:!0};function rQe(e){return e in $Se}const WSe=async({payload:e,reason:t})=>{const{data:n,error:r,response:s}=await ve.POST("/rest/tasks/",t,{body:e});if(r)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to create user task",cause:r,status:s.status??0});return n},ZT=async({taskId:e,payload:t,reason:n})=>{const{data:r,error:s,response:a}=await ve.PATCH("/rest/tasks/{task_id}",n,{params:{path:{task_id:e}},body:t});if(s)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to update user task",cause:s,status:a.status??0});return r};function KSe({reason:e,source:t,onSuccess:n,onError:r}){const s=It(),{session:a}=je(),{trackEvent:o}=Ze(a),{getErrorMessage:i}=FSe(),c=f.useCallback((y,b)=>{s.invalidateQueries({queryKey:gh()}),s.invalidateQueries({queryKey:Ple()}),b&&s.invalidateQueries({queryKey:_P(b)}),n?.(y)},[s,n]),u=f.useCallback((y,b)=>{BSe(t)&&zSe(y)&&o("task modal action",{source:t,action:y}),c(y,b)},[t,o,c]),d=on({mutationFn:y=>WSe({payload:y,reason:e}),onSuccess:y=>u("created",y.task_id),onError:y=>r(i(y))}),m=on({mutationFn:({id:y,payload:b})=>ZT({taskId:y,payload:b,reason:e}),onSuccess:y=>u("updated",y.task.task_id),onError:y=>r(i(y))}),p=on({mutationFn:({id:y,newStatus:b})=>ZT({taskId:y,payload:{status:b},reason:e}),onSuccess:y=>{u(y.task.status==="PAUSED"?"paused":"resumed",y.task.task_id)},onError:y=>r(i(y))}),h=on({mutationFn:y=>PU({taskId:y,reason:e}),onSuccess:()=>u("deleted"),onError:y=>r(i(y))}),g=d.isPending||m.isPending||p.isPending||h.isPending;return{createMutation:d,updateMutation:m,toggleMutation:p,deleteMutation:h,isMutationLoading:g,invalidateAndClose:c}}function sQe({initialConfiguration:e,isModalOpened:t,reason:n,source:r,onSuccess:s,onError:a}){const{$t:o}=Q(),i=Vs(),c=yr(),[u,d]=f.useState(_U(e??bU({defaultSearchModel:i}),{getSearchModeForSearchModel:c})),m=f.useCallback(k=>{d(k)},[]),p=(()=>{switch(u.trigger.type){case nt.PRICE_ALERT:return u.trigger.symbol;case nt.SCHEDULED:case nt.SHORTCUT:return null;default:St(u.trigger)}})(),{data:h,isLoading:g}=_y({symbol:p,enabled:!!p&&t}),y=KSe({reason:n,source:r,onSuccess:s,onError:a}),b=LSe({onCreateSuccess:()=>s("created"),onCreateError:k=>a(`Failed to create price alert - ${k.detail}`),onUpdateSuccess:()=>s("updated"),onUpdateError:k=>a(`Failed to update price alert - ${k.detail}`),onDeleteSuccess:()=>s("deleted"),onDeleteError:()=>a("Failed to delete price alert")}),x=g||y.isMutationLoading||b.isMutationLoading,_=f.useCallback(k=>{const M=k?{...u,...k}:u;if(M.id)switch(M.trigger.type){case nt.SCHEDULED:y.updateMutation.mutate({id:M.id,payload:DSe(M.trigger,M.query,M.status,M.notificationSettings,M.collectionUuid)});break;case nt.PRICE_ALERT:{const N=jSe({trigger:M.trigger,query:M.query,status:M.status,quote:h});N?b.updateMutation.mutate({taskId:M.id,payload:N}):a(o({defaultMessage:"Failed to update price alert payload - Missing inputs",id:"293dgMfZdE"}));break}case nt.SHORTCUT:y.updateMutation.mutate({id:M.id,payload:ISe(M.trigger,M.query,M.status)});break;default:St(M.trigger)}else switch(M.trigger.type){case nt.SCHEDULED:y.createMutation.mutate(NSe(M.trigger,M.query,M.notificationSettings??ju,M.collectionUuid));break;case nt.PRICE_ALERT:{const N=jU({trigger:M.trigger,query:M.query,quote:h});N?b.createMutation.mutate(N):a(o({defaultMessage:"Failed to create price alert payload - Missing inputs",id:"Fimh9vZMY/"}));break}case nt.SHORTCUT:y.createMutation.mutate(RSe(M.trigger,M.query));break;default:St(M.trigger)}},[u,y.updateMutation,y.createMutation,h,b.updateMutation,b.createMutation,a,o]),v=f.useCallback(()=>{_()},[_]),C=f.useCallback(k=>{if(!u.id)return;_({status:k?"ACTIVE":"PAUSED"})},[u.id,_]),w=f.useCallback(()=>{if(u.id)switch(u.trigger.type){case nt.SCHEDULED:y.deleteMutation.mutate(u.id);break;case nt.PRICE_ALERT:b.deleteMutation.mutate(u.id);break;case nt.SHORTCUT:y.deleteMutation.mutate(u.id);break;default:St(u.trigger)}},[u.id,u.trigger,b.deleteMutation,y.deleteMutation]),S=OU({isLoading:x,currentConfiguration:u}),E=f.useMemo(()=>{switch(u.trigger.type){case nt.SCHEDULED:case nt.SHORTCUT:return;case nt.PRICE_ALERT:return S?o({defaultMessage:"Select stock, token or fund to begin",id:"x/nyvvB4aQ"}):void 0;default:St(u.trigger)}},[o,u.trigger,S]),T=u.status==="ACTIVE";return{currentConfiguration:u,setCurrentConfiguration:m,onClickSave:v,onClickToggle:C,onClickDelete:w,isEnabled:T,isLoading:x,isSaveDisabled:S,saveButtonTooltipText:E}}function OU({isLoading:e,currentConfiguration:t}){if(e)return!0;switch(t.trigger.type){case nt.SCHEDULED:case nt.SHORTCUT:return!t.query.prompt;case nt.PRICE_ALERT:{const n=t.trigger;if(!n.symbol||n.symbol.trim()==="")return!0;switch(n.alertType){case nr.TARGET_PRICE:if(!n.price||n.price<=0)return!0;break;case nr.MOVEMENT_AMOUNT:{const r=n.percentageDecimalLowerBound!==Jc/100&&n.percentageDecimalLowerBound!==0;if(!(n.percentageDecimalUpperBound!==Zc/100&&n.percentageDecimalUpperBound!==0)&&!r)return!0;break}default:St(n)}break}default:St(t.trigger)}return!1}const ky=0,My=1,n3=!0,Ty="finance",LU=!1,FU="1d",UU=0,BU=!0,HU=!0,VU=!1,GU=null,zU=null,qU=null,r3=({prefix:e="/rest/finance/quote/{market_identifier}",symbol:t,withHistory:n=LU,historyAfterHours:r=BU,historyPeriod:s=FU,historyOffset:a=UU,historyRedirect:o=VU,historyInterval:i=GU,historyStartDate:c=zU,historyEndDate:u=qU,withUiHints:d=HU})=>Se.makeEphemeralQueryKey(e,t,n,r,s,i,a,o,c,u,d),_l=async({symbol:e,withHistory:t=LU,historyAfterHours:n=BU,historyPeriod:r=FU,historyOffset:s=UU,historyRedirect:a=VU,historyInterval:o=GU,withUiHints:i=HU,historyStartDate:c=zU,historyEndDate:u=qU})=>{const{data:d,error:m,response:p}=await ve.GET("/rest/finance/quote/{market_identifier}",Ty,{params:{path:{market_identifier:e},query:{with_history:t,history_period:r,history_offset:s,history_after_hours:n,with_ui_hints:i,history_redirect:a,history_time_interval:o,history_start_date:c,history_end_date:u}},timeoutMs:ky,numRetries:My,shouldNotAddSourceVersionQueryParams:n3});if(p.status===404)return null;if(m)throw new Ue("API_CLIENTS_ERROR",{cause:m,status:p.status??0});return d},$U=({onSkip:e,onConfirm:t,disabled:n=!1,isLoading:r=!1,result:s=null,buttonText:a,loadingText:o})=>{const{$t:i}=Q();return s!==null?l.jsx(Y,{className:"bg-base border-t pt-4",children:l.jsx("div",{className:"text-quiet text-sm",children:s?.confirmed===!0?i({defaultMessage:"Task will be created",id:"+A0SHGFNa7"}):i({defaultMessage:"Task was skipped",id:"uRAWVsTn39"})})}):l.jsx(Y,{className:"bg-base border-t pt-4",children:l.jsx("div",{className:"flex items-center justify-between gap-4",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(st,{size:"small",variant:"primary",text:r?o||i({defaultMessage:"Creating...",id:"mRL9Vh/e/Z"}):a||i({defaultMessage:"Create Task",id:"4+iiEILSrA"}),onClick:t,disabled:n||r}),l.jsx(pt,{size:"small",text:i({defaultMessage:"Skip",id:"/4tOwTiCH6"}),onClick:e,disabled:n||r})]})})})};function YSe(e,t){const n=t.target_price!=null,r=t.movement_percent!=null,s=t.target_price?.toString(),a={query:{prompt:e.prompt||"",searchModel:e.model_preference||te.DEFAULT},status:"ACTIVE",notificationSettings:ju,defaultTargetPriceValue:s};if(n)return{...a,trigger:{type:nt.PRICE_ALERT,alertType:nr.TARGET_PRICE,price:t.target_price,currency:FM,symbol:t.ticker_symbol}};if(r){const o=t.movement_percent/100;return{...a,trigger:{type:nt.PRICE_ALERT,alertType:nr.MOVEMENT_AMOUNT,percentageDecimalLowerBound:t.negative_direction?-o:0,percentageDecimalUpperBound:t.positive_direction?o:0,symbol:t.ticker_symbol}}}else return{...a,trigger:{type:nt.PRICE_ALERT,alertType:nr.TARGET_PRICE,price:0,currency:FM,symbol:t.ticker_symbol}}}async function QSe(e){try{return(await _l({symbol:e}))?.currency?.toLowerCase()||"usd"}catch(t){return Z.warn(`Failed to fetch currency for symbol ${e}`,{error:t}),"usd"}}const XSe=({result:e})=>e?.confirmed===!0?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(ut,{name:D("circle-check-filled"),size:14,className:"text-super shrink-0",title:"Confirmed"}),l.jsx("span",{className:"text-super text-xs font-medium leading-none",children:l.jsx(be,{defaultMessage:"Alert confirmed",id:"0wByyMUPxz"})})]}):e?.confirmed===!1?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(ut,{name:D("x"),size:14,className:"text-negative shrink-0",title:"Skipped"}),l.jsx("span",{className:"text-negative text-xs font-medium leading-none",children:l.jsx(be,{defaultMessage:"Alert skipped",id:"AYQONqG1U3"})})]}):null,ZSe=A.memo(function({sendStepResult:t,taskAction:n,priceAlertData:r,stepUUID:s,isFinished:a=!1}){const{$t:o}=Q(),{session:i}=je(),{trackEvent:c}=Ze(i),u="settings_create",[d,m]=f.useState(()=>YSe(n,r)),[p,h]=f.useState(null),[g,y]=f.useState(null),[b,x]=f.useState(null),_=f.useRef(!1),v="price_alert_operation";f.useEffect(()=>{(async()=>{if(!r.ticker_symbol||a){y(!0);return}try{await _l({symbol:r.ticker_symbol})===null?(y(!1),t({confirmed:!1,user_input:o({defaultMessage:'The stock symbol "{symbol}" could not be found. Please verify the ticker symbol is correct.',id:"yWihQJNDOI"},{symbol:r.ticker_symbol})},v,!1)):y(!0)}catch(M){Z.error("Failed to validate ticker",{ticker:r.ticker_symbol,error:M}),y(!1),t({confirmed:!1,user_input:o({defaultMessage:'Unable to validate the stock symbol "{symbol}" due to a network error. Please try again.',id:"C0nM7QfjoN"},{symbol:r.ticker_symbol})},v,!1)}})()},[r.ticker_symbol]),f.useEffect(()=>{n&&!a&&g===!0&&!_.current&&(c("price alert modal opened",{source:u}),_.current=!0)},[g]),f.useEffect(()=>{(async()=>{if(r.ticker_symbol&&g===!0&&d.trigger.type===nt.PRICE_ALERT)try{const M=await QSe(r.ticker_symbol);m(N=>({...N,trigger:{...N.trigger,currency:M}}))}catch(M){Z.warn("Failed to fetch currency for ticker",{ticker:r.ticker_symbol,error:M})}})()},[r.ticker_symbol,g,d.trigger.type]);const C=f.useMemo(()=>o({defaultMessage:"Create Price Alert",id:"WY6/zFtq4x"}),[o]),w=f.useCallback(k=>{h(k),k.confirmed?(c("price alert modal action",{source:u,action:"created"}),t({confirmed:!0,task_action:k.task_action},v,!1)):(c("price alert modal action",{source:u,action:"deleted"}),t({confirmed:!1},v,!1))},[t,v,c,u]),S=f.useCallback(()=>{h({confirmed:!1}),c("price alert modal action",{source:u,action:"skipped"}),t({confirmed:!1},v,!1)},[c,u,t,v]),E=f.useCallback(()=>{const k=d.trigger;let M={task_name:`Price Alert: ${r.ticker_symbol}`,prompt:d.query?.prompt,model_preference:d.query?.searchModel||te.DEFAULT,schedule:void 0,expiry_date:void 0,event_entity:r.ticker_symbol};switch(k.alertType){case nr.TARGET_PRICE:{M={...M,event_type:"STOCK_PRICE_TARGET",target_price:k.price,current_price:r.current_price};break}case nr.MOVEMENT_AMOUNT:{const N=k.percentageDecimalUpperBound,P=k.percentageDecimalLowerBound;M={...M,event_type:"STOCK_PRICE_MOVEMENT",upper_bound:N&&N>0?N*100:void 0,lower_bound:P&&P<0?P*100:void 0};break}default:St(k)}w({confirmed:!0,task_action:M})},[d,w,r]),T=f.useMemo(()=>a?!0:OU({isLoading:!1,currentConfiguration:d}),[d,a]);return!n||!r?null:a?l.jsx(cr,{icon:D("circle-check-filled"),iconClassName:"text-super",text:o({defaultMessage:"Done",id:"JXdbo8Vnlw"})}):g===null||g===!1?null:l.jsxs("div",{className:"bg-subtler border-subtlest transform rounded-xl border transition-transform duration-200",children:[l.jsxs("div",{className:"flex items-center justify-between rounded-t-lg px-4 py-3",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"bg-subtle flex size-8 items-center justify-center rounded-lg",children:l.jsx(ut,{name:D("trending-up"),size:16,className:"text-quiet"})}),l.jsx("h3",{className:"text-foreground text-sm font-medium",children:C})]}),l.jsx(XSe,{result:p})]}),l.jsx("div",{className:"p-4",children:l.jsx(x0,{children:l.jsxs("div",{className:"flex flex-col gap-3",children:[l.jsx(IU,{configuration:d,onConfigurationChange:m,errorMessage:b??void 0,onError:x,canEditSpace:!0}),b&&l.jsxs("div",{className:"gap-xs flex items-center",children:[l.jsx(ut,{name:D("exclamation-circle"),size:12,className:"text-caution"}),l.jsx(B,{variant:"tinyRegular",color:"red",className:"mt-0.5",children:b})]}),l.jsx($U,{onSkip:S,onConfirm:E,disabled:T,result:p,buttonText:C})]})})})]})}),JSe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9-]*\.)+[A-Z]{2,}$/i;function WU(e){return typeof e!="string"?!1:JSe.test(e)}function N1({label:e,chips:t,onAdd:n,onDelete:r,children:s,placeholder:a,onDraftChange:o,contactSuggestions:i,renderContactSuggestion:c}){return l.jsxs("div",{className:"border-subtlest pl-md pr-sm flex min-h-10 flex-1 items-center border-b p-0",children:[l.jsx(B,{variant:"small",color:"light",className:"w-10 min-w-[32px] select-none",children:e}),l.jsx("div",{className:"flex-1",children:l.jsx(pU,{chips:t,onAdd:n,onDelete:r,placeholder:a,validator:WU,placeholderOnFocusOnly:!0,onDraftChange:o,suggestions:i,renderSuggestion:c})}),s]})}function eEe(e,t){const r=t.get(e)?.display_name?.trim();return r||e}function R1(e,t){return e.map(n=>({label:eEe(n,t),value:n}))}const tEe=A.memo(function({email:t,onChange:n,onSend:r,onDraftChange:s,contactSuggestions:a,renderContactSuggestion:o,disableEditContents:i}){const c=f.useMemo(()=>t?.to??[],[t?.to]),u=f.useMemo(()=>t?.cc??[],[t?.cc]),d=f.useMemo(()=>t?.bcc??[],[t?.bcc]),[m,p]=f.useState(u.length>0),[h,g]=f.useState(d.length>0),{isMobileUserAgent:y}=Be(),b=()=>{(!u||u.length===0)&&(!d||d.length===0)&&(p(!1),g(!1))},{$t:x}=Q(),_={to:x({defaultMessage:"To",id:"9j3hXO4Ojb"}),cc:x({defaultMessage:"Cc",id:"J1CYkLdqdy"}),bcc:x({defaultMessage:"Bcc",id:"qLl3P2UOlZ"}),addRecipient:x({defaultMessage:"Add recipient",id:"o2g2HQVmtC"}),subject:x({defaultMessage:"Subject",id:"LLtKhppiyE"}),writeMessage:x({defaultMessage:"Write your message...",id:"yoP6t+NY/q"})},v=f.useCallback(O=>({onAdd:(R,I)=>{const F=t?.[O]??[],G=R.filter(j=>WU(j)&&!F.includes(j));if(G.length>0){const j=t?.contacts?[...t.contacts]:[];if(I&&I.length>0){const $=I.filter(q=>!j.some(U=>U.email===q.email)).map(q=>({email:q.email,display_name:q.name,photo_url:q.image||void 0}));j.push(...$)}n({...t,[O]:[...F,...G],contacts:j})}},onDelete:R=>{const I=t?.[O]??[];n({...t,[O]:I.filter(F=>!R.includes(F))})}}),[t,n]),C=f.useMemo(()=>new Map((t?.contacts??[]).filter(O=>O.email).map(O=>[O.email,O])),[t?.contacts]),w=f.useMemo(()=>R1(c,C),[c,C]),S=f.useMemo(()=>R1(u,C),[u,C]),E=f.useMemo(()=>R1(d,C),[d,C]),T=v("to"),k=v("cc"),M=v("bcc"),N=f.useCallback(O=>n({...t,subject:O}),[t,n]),P=f.useCallback(O=>n({...t,body:O.target.value}),[t,n]);return l.jsxs("div",{className:"dark:bg-subtler flex w-full flex-col",children:[l.jsx(N1,{label:_.to,chips:w,onAdd:T.onAdd,onDelete:T.onDelete,placeholder:_.addRecipient,onDraftChange:s,contactSuggestions:a,renderContactSuggestion:o,children:l.jsxs("div",{className:"gap-two ml-2 flex",children:[!m&&l.jsx("button",{type:"button",className:"hover:bg-subtler text-quiet rounded-lg px-2 py-1 font-sans text-sm",onClick:()=>p(!0),children:_.cc}),!h&&l.jsx("button",{type:"button",className:"hover:bg-subtler text-quiet rounded-lg px-2 py-1 font-sans text-sm",onClick:()=>g(!0),children:_.bcc})]})}),m&&l.jsx(N1,{label:_.cc,chips:S,onAdd:k.onAdd,onDelete:k.onDelete,placeholder:_.addRecipient,onDraftChange:s,contactSuggestions:a,renderContactSuggestion:o}),h&&l.jsx(N1,{label:_.bcc,chips:E,onAdd:M.onAdd,onDelete:M.onDelete,placeholder:_.addRecipient,onDraftChange:s,contactSuggestions:a,renderContactSuggestion:o}),!i&&l.jsx(xs,{isMobileUserAgent:y,name:"subject-input",type:"text",value:t?.subject,onChange:N,placeholder:_.subject,className:"border-subtlest text-foreground !px-md !py-sm min-h-10 w-full !rounded-none border-0 border-b !bg-transparent focus:outline-none focus:!ring-0","aria-label":_.subject}),!i&&l.jsx("textarea",{name:"body",value:t?.body,onChange:P,placeholder:_.writeMessage,rows:8,className:"text-foreground placeholder:text-quieter p-md min-h-[180px] w-full resize-none border-0 bg-transparent font-sans text-sm shadow-none focus:outline-none focus:ring-0","aria-label":_.writeMessage,onFocus:b})]})}),nEe=A.memo(function({sendEmailContent:t,sendStepResult:n,isFinished:r}){const s="send-email-step",[a,o]=f.useState(r??!1),{suggestions:i,handleDraftChange:c}=DF({reason:"email_compose"}),u=t?.action,[d,m]=f.useState(t?.selected_account?.connection_id),p=f.useMemo(()=>!d||!t?.available_accounts?t?.selected_account:t.available_accounts.find(H=>H.connection_id===d)??t?.selected_account,[d,t?.available_accounts,t?.selected_account]),h=f.useMemo(()=>{if(u?.send)return u.send.email;if(u?.forward)return{to:u.forward.to,cc:u.forward.cc,bcc:u.forward.bcc,contacts:u.forward.contacts}},[u]),[g,y]=f.useState(h),{$t:b}=Q(),x=f.useMemo(()=>!!(g?.to&&g.to.length===0),[g]),_=f.useMemo(()=>b({defaultMessage:"Send",id:"9WRlF4R2gm"}),[b]),[v,C]=f.useState(""),[w,S]=f.useState(!1),E=f.useCallback(()=>{o(!0),n({confirmed:!1},s,!1)},[n,s]),T=f.useCallback((H,R)=>{!H&&(!R||!R.trim())||(o(!0),n({confirmed:H,...R&&{user_input:R.trim()},...g&&{email:g},selected_connection_id:d},s,!1),!H&&R&&(S(!1),C("")))},[n,s,g,d]),k=f.useCallback(()=>T(!0),[T]),M=f.useCallback(()=>T(!1,v),[T,v]),N=f.useCallback(H=>{Zr.isEnterKeyWithoutShift(H)&&(H.preventDefault(),M())},[M]),P=f.useCallback(()=>{S(!1),C("")},[]),O=f.useCallback(H=>{H.preventDefault(),S(!0)},[]),L=f.useCallback(H=>l.jsx(RF,{contact:H}),[]);return a?l.jsx(cr,{icon:D("circle-check-filled"),iconClassName:"text-super",text:b({defaultMessage:"Done",id:"JXdbo8Vnlw"})}):l.jsxs(Y,{variant:"raised",className:"rounded-lg border",children:[t?.available_accounts&&t.available_accounts.length>0&&l.jsx(NF,{selectedAccount:p,availableAccounts:t.available_accounts,onAccountChange:m}),g&&l.jsx(Y,{children:l.jsx(tEe,{email:g,onChange:y,onDraftChange:c,contactSuggestions:i,renderContactSuggestion:L,disableEditContents:!!u?.forward})}),w&&l.jsxs("form",{onSubmit:M,children:[l.jsx(Y,{className:"px-md py-sm gap-4 border-t",children:l.jsx(Ul,{isMobileStyle:!1,isMobileUserAgent:!1,placeholder:b({defaultMessage:"What would you like to change about this email?",id:"lrZrku1OFD"}),value:v,onChange:C,onKeyDown:N,minRows:3,className:"mt-sm !pl-3",autoFocus:!0})}),l.jsxs("div",{className:"gap-sm p-md pt-sm flex items-center justify-between",children:[l.jsxs("div",{className:"gap-sm flex",children:[l.jsx(st,{size:"small",variant:"inverted",text:b({defaultMessage:"Continue",id:"acrOozm08x"}),type:"submit"}),l.jsx(pt,{variant:"negative",size:"small",text:b({defaultMessage:"Cancel",id:"47FYwba+bI"}),onClick:P})]}),l.jsx(pt,{size:"small",text:b({defaultMessage:"Skip",id:"/4tOwTiCH6"}),onClick:E})]})]}),!w&&l.jsx("form",{onSubmit:k,children:l.jsxs("div",{className:"gap-sm p-md flex items-center justify-between border-t",children:[l.jsxs("div",{className:"gap-sm flex",children:[l.jsx(st,{size:"small",variant:"inverted",text:_,type:"submit",disabled:x}),l.jsx(st,{size:"small",variant:"common",text:b({defaultMessage:"Refine email",id:"xTUBb7cWyO"}),onClick:O})]}),l.jsx(pt,{size:"small",text:b({defaultMessage:"Skip",id:"/4tOwTiCH6"}),onClick:E})]})})]})}),rEe=({result:e})=>{const{$t:t}=Q();return e?.confirmed===!0?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(ut,{name:D("circle-check-filled"),size:14,className:"shrink-0 text-[#16a34a]",title:"Confirmed"}),l.jsx("span",{className:"text-xs font-medium leading-none text-[#16a34a] dark:text-[#4ade80]",children:t({defaultMessage:"Task confirmed",id:"oLLCmoruP6"})})]}):e?.confirmed===!1?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(ut,{name:D("x"),size:14,className:"text-negative shrink-0",title:"Skipped"}),l.jsx("span",{className:"text-negative text-xs font-medium leading-none",children:t({defaultMessage:"Task skipped",id:"uMaJWuUUvD"})})]}):null},sEe=A.memo(function({sendStepResult:t,taskAction:n,stepUUID:r,isFinished:s=!1}){const{$t:a}=Q(),{session:o}=je(),{trackEvent:i}=Ze(o),c="router",u=Vs(),d=f.useMemo(()=>{const T=n.expiry_date?new Date(n.expiry_date):void 0;return{trigger:{type:nt.SCHEDULED,schedule:oEe(n.schedule),expiryDate:T},query:{prompt:n.prompt||"",searchModel:n.model_preference||te.DEFAULT},status:"ACTIVE",notificationSettings:ju}},[n]),m=yr(),[p,h]=f.useState(_U(d??bU({defaultSearchModel:u}),{getSearchModeForSearchModel:m})),[g,y]=f.useState(null),[b,x]=f.useState(null),_="task_operation";f.useEffect(()=>{n&&!s&&i("task modal opened",{source:c})},[n,s,i,c]),Z.error("TaskOperationStep rendered",{stepUUID:r,hasTaskAction:!!n,isFinished:s,taskAction:n,taskActionType:typeof n,taskActionKeys:n?Object.keys(n):[],source:c});const v=f.useMemo(()=>a({defaultMessage:"Create Task",id:"4+iiEILSrA"}),[a]),C=f.useCallback(T=>{y(T),T.confirmed?(i("task modal action",{source:c,action:"created"}),t({confirmed:!0,task_action:T.task_action},_,!1)):(i("task modal action",{source:c,action:"deleted"}),t({confirmed:!1},_,!1))},[t,_,c,i]),w=f.useCallback(()=>{C({confirmed:!1})},[C]),S=f.useCallback(()=>{const T={task_name:p.query?.prompt||"Untitled Task",prompt:p.query?.prompt,model_preference:p.query?.searchModel||te.DEFAULT,schedule:p.trigger.type===nt.SCHEDULED?aEe(p.trigger.schedule):void 0,expiry_date:n.expiry_date};C({confirmed:!0,task_action:T})},[p,C,n.expiry_date]),E=f.useCallback(T=>{h(T)},[]);return n?s?l.jsx(cr,{icon:D("circle-check-filled"),iconClassName:"text-super",text:a({defaultMessage:"Done",id:"JXdbo8Vnlw"})}):l.jsxs("div",{className:"bg-subtler border-subtlest transform overflow-hidden rounded-xl border transition-transform duration-200",children:[l.jsxs("div",{className:"bg-subtler border-subtler flex items-center justify-between border-b px-4 py-3",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"bg-subtle flex size-8 items-center justify-center rounded-lg",children:l.jsx(ut,{name:D("clock"),size:16,className:"text-quiet"})}),l.jsx("h3",{className:"text-foreground text-sm font-medium",children:v})]}),l.jsx(rEe,{result:g})]}),l.jsx("div",{className:"bg-base p-4",children:l.jsx(x0,{children:l.jsxs("div",{className:"flex flex-col gap-3",children:[l.jsx(IU,{configuration:p,onConfigurationChange:E,canEditSpace:!0}),b&&l.jsxs("div",{className:"gap-xs flex items-center",children:[l.jsx(ut,{name:D("exclamation-circle"),size:12,className:"text-caution"}),l.jsx(B,{variant:"tinyRegular",color:"red",className:"mt-0.5",children:b})]}),l.jsx($U,{onSkip:w,onConfirm:S,disabled:s,result:g})]})})})]}):(Z.error("TaskOperationStep received null/undefined taskAction - will not render",{stepUUID:r,taskAction:n,isFinished:s,source:c}),null)});function aEe(e){const t=`${e.hour.toString().padStart(2,"0")}:${e.minute.toString().padStart(2,"0")}`;switch(e.kind){case"ONCE":return{one_time:{datetime:new Date(e.year,e.month,e.day,e.hour,e.minute).toISOString()}};case"DAILY":return{daily:{time:t}};case"WEEKLY":return{weekly:{time:t,day_of_week:(e.dayOfWeek+6)%7}};case"MONTHLY":return{monthly:{time:t,day_of_month:e.day}};case"YEARLY":return{yearly:{time:t,day_of_month:e.day,month_of_year:e.month+1}};case"WEEKDAYS":return{weekdays:{time:t}};default:return{daily:{time:t}}}}function oEe(e){if(!e)return vr();if(e.one_time){const t=e.one_time.datetime;if(!t)return vr();const n=new Date(t);return{kind:"ONCE",minute:n.getMinutes(),hour:n.getHours(),day:n.getDate(),month:n.getMonth(),year:n.getFullYear(),dayOfWeek:n.getDay()}}else if(e.daily){const t=e.daily.time;if(!t)return vr();const[n="",r=""]=t.split(":"),s=parseInt(n,10),a=parseInt(r,10);if(isNaN(s)||isNaN(a))return vr();const o=new Date;return{kind:"DAILY",minute:a,hour:s,day:o.getDate(),month:o.getMonth(),year:o.getFullYear(),dayOfWeek:o.getDay()}}else if(e.weekly){const t=e.weekly.time,n=e.weekly.day_of_week;if(!t||n==null)return vr();const[r="",s=""]=t.split(":"),a=parseInt(r,10),o=parseInt(s,10);if(isNaN(a)||isNaN(o))return vr();const i=(n+1)%7,c=new Date;return{kind:"WEEKLY",minute:o,hour:a,day:c.getDate(),month:c.getMonth(),year:c.getFullYear(),dayOfWeek:i}}else if(e.monthly){const t=e.monthly.time,n=e.monthly.day_of_month;if(!t||n==null)return vr();const[r="",s=""]=t.split(":"),a=parseInt(r,10),o=parseInt(s,10);if(isNaN(a)||isNaN(o))return vr();const i=new Date;return{kind:"MONTHLY",minute:o,hour:a,day:n,month:i.getMonth(),year:i.getFullYear(),dayOfWeek:i.getDay()}}else if(e.yearly){const t=e.yearly.time,n=e.yearly.month_of_year,r=e.yearly.day_of_month;if(!t||n==null||r==null)return vr();const[s="",a=""]=t.split(":"),o=parseInt(s,10),i=parseInt(a,10);if(isNaN(o)||isNaN(i))return vr();const c=new Date;return{kind:"YEARLY",minute:i,hour:o,day:r,month:n-1,year:c.getFullYear(),dayOfWeek:c.getDay()}}else if(e.weekdays){const t=e.weekdays.time;if(!t)return vr();const[n="",r=""]=t.split(":"),s=parseInt(n,10),a=parseInt(r,10);if(isNaN(s)||isNaN(a))return vr();const o=new Date;return{kind:"WEEKDAYS",minute:a,hour:s,day:o.getDate(),month:o.getMonth(),year:o.getFullYear(),dayOfWeek:o.getDay()}}return vr()}const JT=A.memo(function({question:t,sendStepResult:n,isFinished:r}){const s="user-clarification-step",[a,o]=f.useState(r??!1),[i,c]=f.useState(""),{$t:u}=Q(),d=f.useCallback(()=>{o(!0),n({confirmed:!1,user_input:i.length>0?i:"The user chose to confirm with the information provided"},s,!1)},[i,n]),m=f.useCallback(()=>{o(!0),n({confirmed:!1},s,!1)},[n]),p=f.useCallback(h=>{Zr.isEnterKeyWithoutShift(h)&&(h.preventDefault(),d())},[d]);return a?l.jsx(cr,{icon:D("circle-check-filled"),iconClassName:"text-super",text:u({defaultMessage:"Done",id:"JXdbo8Vnlw"})}):l.jsx(Y,{variant:"raised",className:"py-sm rounded-lg border",children:l.jsxs("form",{onSubmit:d,children:[t&&l.jsxs("div",{className:"px-md pt-sm",children:[l.jsx(B,{variant:"small",children:t}),l.jsx("div",{className:"gap-sm mt-3 flex items-center",children:l.jsx("div",{className:"grow",children:l.jsx(Ul,{isMobileStyle:!1,isMobileUserAgent:!1,placeholder:u({defaultMessage:"Add details",id:"GTIJ9uAEMf"}),value:i,onChange:c,onKeyDown:p,minRows:3,className:"!pl-3",autoFocus:!0})})})]}),l.jsxs("div",{className:"gap-sm px-md py-sm mt-4 flex items-center",children:[l.jsx(st,{size:"small",variant:"inverted",text:u({defaultMessage:"Continue",id:"acrOozm08x"}),type:"submit"}),l.jsx(pt,{size:"small",text:u({defaultMessage:"Skip",id:"/4tOwTiCH6"}),onClick:m})]})]})})}),iEe=e=>e.toLowerCase().replace(/_/g," ").replace(/^\w/,t=>t.toUpperCase()),lEe={CREATE_CLIENT_APP:"building_app",CREATE_CHART:"creating_chart",URL_NAVIGATE:"navigate",BROWSER_OPEN_TAB_RESULTS:"opening_tab",BROWSER_CLOSE_TABS_RESULTS:"closing_tabs",READ_GMAIL:"searching_gmail",READ_EMAIL:"searching_gmail",READ_GMAIL_RESPONSE:"reading_emails",READ_EMAIL_RESPONSE:"reading_emails",READ_CALENDAR:"searching_calendar",READ_CALENDAR_RESPONSE:"reading_events",UPDATE_CALENDAR:"scheduling",UPDATE_CALENDAR_RESPONSE:"scheduling",SEND_GMAIL:"emailing",SEND_EMAIL:"emailing",SEND_GMAIL_RESPONSE:"emailing",SEND_EMAIL_RESPONSE:"emailing",EMAIL_CALENDAR_AGENT_RESPONSE:"emailing",GMAIL_GCAL_AGENT_RESPONSE:"emailing",FLIGHTS_SEARCH:"searching_flights",FLIGHTS_SEARCH_RESPONSE:"looking_for_booking_options",FLIGHTS_BOOKING:"reviewing_booking_options",FLIGHTS_BOOKING_RESPONSE:"redirecting_to_booking",TERMINATE:"conclusion",GENERATE_IMAGE:"generating_images",GENERATE_VIDEO:"generating_images",GENERATE_VIDEO_RESULTS:"presenting_images",BROWSER_GROUP_TABS:"grouping_tabs",BROWSER_UNGROUP:"ungrouping_tabs",BROWSER_SEARCH_TAB_GROUPS:"searching_tab_groups",BROWSER_SEARCH_TAB_GROUPS_RESULT:"reading",GET_FREEBUSY:"getting_freebusy",GET_FREEBUSY_RESPONSE:"getting_freebusy",SEARCH_BROWSER:"searching_browser",CREATE_TASKS:"scheduling",CREATE_TASKS_RESPONSE:"scheduled"};function KU(e,t){switch(e.step_type){case"SEARCH_WEB":{const n=e.content.queries??[];return n.length>0&&n.every(s=>s.engine==="image")?"search_images":"search"}case"SEARCH_RESULTS":{const n=e.content.web_results;return n.length===0?"reviewing_sources":n.every(r=>r.is_memory)?n.length===1?"reviewing_memory":"reviewing_memories":n.every(r=>r.is_conversation_history)?"reviewing_conversation_history":n.length===1?"reviewing_source":"reviewing_sources"}case"GET_URL_CONTENT":return e.content.pages.length>1?"getting_sources":"getting_source";case"GET_USER_INFO":{const n=e.content,r=n.found_users,s=r&&r.length>0,a=n.submitted;return s&&!a?"found_contacts":"getting_user_info"}case"GET_USER_INFO_RESPONSE":{const{submitted:n,selected_users:r}=e.content??{};return!n||!r?void 0:r.some(a=>a.selected===!0)?"selecting_contacts":"getting_contact_details"}case"CREATE_TASKS":{const n=e.content?.task_action;return n?n.event_group==="FINANCE"&&n.event_type&&n.event_entity?"setting_up_price_alert_automation":"scheduling":void 0}case"COMET_AGENT_TOOL_INPUT":{const n=e.content.tool_input;if(n?.todo_write){const a=t?.findIndex(i=>i.uuid===e.uuid)??-1;return t?.some((i,c)=>c>=a?!1:i?.step_type==="COMET_AGENT_TOOL_INPUT"&&"tool_input"in i.content&&i.content.tool_input?.todo_write)??!1?"updating_todo_list":"creating_todo_list"}if(n?.subagent_tool_inputs)return"running_sub_tasks";const r=n?.computer_list?.actions;if(r&&r.length>0){const a=r[r.length-1]?.action;return a&&a in La?a:"working"}const s=n?.computer?n.computer.action:Object.entries(n??{}).find(([a,o])=>o)?.[0];return s&&s in La?s:"working"}default:return lEe[e.step_type]}}function cEe(e){const{step:t,streamId:n,inFlight:r,allSteps:s}=e;f.useEffect(()=>{if(!Si()||!n||!r)return;const o=KU(t,s);if(!o)return;const i=new CustomEvent("comet-agent-step-update",{detail:{stepAction:o,streamId:n}});document.dispatchEvent(i)},[t,n,r,s])}function uEe(e,t,n){if(e.step_type==="COMET_AGENT_TOOL_INPUT")return;const r=KU(e,n);return r?t(r):void 0}const dEe={FINANCE:"FINANCE"},fEe={STOCK_PRICE_MOVEMENT:"STOCK_PRICE_MOVEMENT"};function mEe(e){const t=[];let n=0;for(;n<e.length;){const r=e[n],s=e[n+1];r?.step_type==="GET_FREEBUSY_RESPONSE"?n+=1:r?.step_type==="GET_FREEBUSY"&&s?.step_type==="GET_FREEBUSY_RESPONSE"?(t.push({...r,get_free_busy_response_content:s.get_free_busy_response_content,originalEndIndex:n+1}),n+=2):(t.push({...r,originalEndIndex:n}),n+=1)}return t}function pEe(e){return e.map((t,n)=>({...t,originalEndIndex:n}))}function hEe(e){const{step:t,isStudio:n,isFinished:r,onStepClick:s,stepDelay:a,showAllNestedSteps:o,isNested:i,disableAnimations:c,isMissionControl:u,hasAnswer:d,$t:m,getActionMessage:p,translations:h,assetsContent:g,sendStepResult:y,taskComputerActions:b,allSteps:x,setShouldShowSkipButtonOverride:_,shouldShowSourceSkipButton:v,entryResult:C,enabledSources:w,shouldHideScreenshotsInSidecar:S,StepRendererComponent:E}=e;switch(t.step_type){case"SEARCH_WEB":{const k=t.content.queries??[];return{content:l.jsx(Vr,{queries:k.map(M=>M.query),stepDelay:n?2:void 0,isFinished:r})}}case"SEARCH_RESULTS":{const k=t.content.web_results;return{content:k.length===0?l.jsx(cr,{icon:D("zoom-out"),text:m({defaultMessage:"No sources found",id:"yWSiuEkfbY"})}):mN(k)?l.jsx(ld,{result:k[0],showName:!0,onClick:s}):l.jsx(Bi,{onClick:s,results:k,stepDelay:n?2:void 0,isFinished:r})}}case"ENTROPY_REQUEST":return{content:l.jsx(wye,{step:t,isFinished:r??!1,isMissionControl:u??!1})};case"CODE":return{content:l.jsx(Nye,{action:p("working"),step:t})};case"PDF":return{content:!g&&l.jsx(d1e,{action:p("creating_pdf"),step:t})};case"DOCX":return{content:!g&&l.jsx(jye,{action:p("creating_docx"),step:t})};case"XLSX":return{content:!g&&l.jsx(I1e,{action:p("creating_xlsx"),step:t})};case"CREATE_APP_RESULT":return{content:null};case"RESEARCH_ANSWER":return{content:null};case"CREATE_CLIENT_APP":return{content:l.jsx(B,{variant:"tinyRegular",className:"!text-[0.68rem]",children:t.content.caption})};case"CREATE_CHART":return{content:l.jsx(B,{variant:"tinyRegular",className:"!text-[0.68rem]",children:t.content.caption})};case"GET_URL_CONTENT":{const k=t.content.pages;return{content:k.length===0?l.jsx(cr,{icon:D("zoom-out-area"),text:m({defaultMessage:"No content found",id:"JlMgLJz0nd"})}):l.jsx("div",{className:"flex flex-wrap gap-2",children:k.map((M,N)=>l.jsx(ld,{result:{name:"",snippet:"",is_attachment:!1,url:M.url},showName:!1,onClick:s},M.url||N))})}}case"CLARIFYING_QUESTIONS_OUTPUT":return t.content.clarification?{content:l.jsx(Aye,{step:t})}:null;case"IN_CONTEXT_SUGGESTIONS_OUTPUT":return t.content.selected_suggestion?{content:l.jsx("div",{className:"gap-sm flex flex-row",children:l.jsx(cr,{icon:D("bulb"),text:t.content.selected_suggestion})})}:null;case"THOUGHT":{const k=t.content.web_results??[];return k.length>0?{content:l.jsxs("div",{className:"-mb-[1px] rounded-lg border border-border-subtle p-3",children:[l.jsxs("div",{className:"mb-2 flex flex-wrap items-center gap-1.5",children:[l.jsx(ut,{name:D("bulb"),className:"text-default size-4"}),l.jsx(B,{variant:"smallBold",children:"Insight"}),l.jsx("div",{className:"ml-auto flex flex-wrap gap-1.5",children:k.map((N,P)=>l.jsx(ld,{result:N,showName:!0,onClick:s},N.url||P))})]}),l.jsx(B,{variant:"small",children:t.content.thought})]})}:{content:l.jsx(B,{variant:"small",children:t.content.thought})}}case"URL_NAVIGATE":return{content:l.jsx(Vr,{queries:t.content.urls})};case"BROWSER_OPEN_TAB_RESULTS":return{content:l.jsx(ld,{result:{name:t.content.tab.title,url:t.content.tab.url,snippet:"",is_attachment:!1,is_client_context:!0,tab_id:t.content.tab.id},showName:!0,onClick:s})};case"BROWSER_CLOSE_TABS_RESULTS":{const k=t.content.tabs,M=[h.failedClosedTabs];return{content:k.length===0?l.jsx(Vr,{queries:M,icon:D("cancel")}):l.jsx(Bi,{results:k.map(N=>({name:N.title,url:N.url,snippet:"",is_attachment:!1})),textClassName:N=>{const P="url"in N&&N.url,O="name"in N&&N.name;return P||O?"opacity-65 line-through":""}})}}case"READ_GMAIL":case"READ_EMAIL":{const k=t.content.queries?.length?t.content.queries:[h.allEmail];return{content:l.jsx(Vr,{queries:k,icon:D("mail-search")})}}case"READ_GMAIL_RESPONSE":case"READ_EMAIL_RESPONSE":{const k=t.content;return k?.authenticated&&k?.count>0?{content:k.results?l.jsx(Bi,{results:k.results,resultType:"email",onClick:s,stepDelay:a,isFinished:r,maxHeight:400}):null}:{content:null}}case"READ_CALENDAR":return{content:l.jsx(Vr,{queries:t.content.queries??[],icon:D("user-scan")})};case"READ_CALENDAR_RESPONSE":return t.content.authenticated&&(t.content.count??0)>0?{content:t.content.results?l.jsx(Bi,{results:t.content.results,resultType:"calendar",onClick:s,stepDelay:a,isFinished:r,maxHeight:400}):null}:{content:null};case"UPDATE_CALENDAR":return{isFinished:!0,content:t.content?.clarification?l.jsx(JT,{isFinished:!1,question:t.content.clarification,sendStepResult:y}):t.content?l.jsx(Bve,{isFinished:!1,updateCalendarContent:t.content,sendStepResult:y}):null};case"UPDATE_CALENDAR_RESPONSE":return{isFinished:!0,content:(()=>{const k=t.content?.operations;return!k||k.length===0?l.jsx(cr,{icon:D("circle-check-filled"),iconClassName:"text-super",text:m({defaultMessage:"Done",id:"JXdbo8Vnlw"})}):l.jsx(kye,{operations:k})})()};case"CREATE_TASKS":{const M=t.content?.task_action;if(!M)return null;if(M.event_group===dEe.FINANCE&&M.event_type&&M.event_entity){const N={ticker_symbol:M.event_entity,target_price:M.target_price,current_price:M.current_price,...M.event_type===fEe.STOCK_PRICE_MOVEMENT&&{movement_percent:hp(M.upper_bound)?M.upper_bound:hp(M.lower_bound)?Math.abs(M.lower_bound):void 0,positive_direction:hp(M.upper_bound),negative_direction:hp(M.lower_bound)}};return{isFinished:!0,content:l.jsx(ZSe,{taskAction:M,priceAlertData:N,stepUUID:t.uuid??"",isFinished:r,sendStepResult:y})}}return{isFinished:!0,content:l.jsx(sEe,{taskAction:M,stepUUID:t.uuid??"",isFinished:r,sendStepResult:y})}}case"CREATE_TASKS_RESPONSE":return{isFinished:!0,content:l.jsx(cr,{icon:D("circle-check-filled"),iconClassName:"text-super",text:"Done"})};case"SEND_GMAIL":case"SEND_EMAIL":return d?null:{content:t.content?.clarification?l.jsx(JT,{isFinished:!1,question:t.content.clarification,sendStepResult:y}):t.content?l.jsx(nEe,{isFinished:!1,sendEmailContent:t.content,sendStepResult:y}):null};case"SEND_GMAIL_RESPONSE":case"SEND_EMAIL_RESPONSE":return{isFinished:!0,content:l.jsx(Pye,{status:t.content?.status})};case"EMAIL_CALENDAR_AGENT_RESPONSE":case"GMAIL_GCAL_AGENT_RESPONSE":return{content:null};case"EMAIL_CALENDAR_AGENT":case"GMAIL_GCAL_AGENT":{const k=mEe(t.content.steps??[]),M=o?k:k.slice(-1);return{content:l.jsx(l.Fragment,{children:M.map(N=>{const P={step_type:N.step_type||"EMAIL_CALENDAR_AGENT",content:N.step_type==="GET_FREEBUSY"&&N.get_free_busy_response_content?{...N.get_free_busy_content,...N.get_free_busy_response_content}:N.get_free_busy_content??N.get_user_info_content??N.get_user_info_response_content??N.send_email_content??N.update_calendar_content??N.update_calendar_response_content??N.send_email_response_content??N.get_free_busy_response_content??N.read_calendar_content??N.read_calendar_response_content??N.read_email_content??N.read_email_response_content??{},uuid:N.uuid||"",assets:void 0},O=o?r||N.originalEndIndex<(t.content.steps?.length??0)-1:r;return l.jsx(E,{step:P,isFinished:O,isNested:i,onStepClick:s,showAllNestedSteps:o,disableAnimations:c},N.uuid)})})}}case"FLIGHTS_SEARCH":{const k=t.content;if(!k)return null;const M=k.found_flights,N=M&&M.length>0,P=k.submitted;return{isFinished:N,content:N&&!P?l.jsx(Yve,{stepUUID:t.uuid??"",goalId:k.goal_id??"",foundFlights:k.found_flights,isSubmitted:P??!1,outboundDate:k.outbound_date,returnDate:k.return_date,flightType:k.flight_type}):null}}case"FLIGHTS_SEARCH_RESPONSE":{const{selected_flight:k,submitted:M}=t.content??{},N=k?.flights?.map($=>$.airline).filter(Boolean).join(", ")||"",P=k?.flights?.[0]?.departure_airport?.id||"",O=k?.flights?.[k.flights.length-1]?.arrival_airport?.id||"",L=k?.total_duration||0,H=Math.floor(L/60),R=L%60,I=H>0?`${H}h ${R}min`:`${R}min`;let F=P;if(k?.flights&&k.flights.length>1)for(let $=1;$<k.flights.length;$++){const q=k.flights[$]?.departure_airport?.id;q&&q!==F.split(" -> ").pop()&&(F+=` -> ${q}`)}F+=` -> ${O}`;const j=[`${N} (${F}): ${I}`];return M&&k?{isFinished:r||d,content:l.jsx(Vr,{queries:j,icon:D("plane-inflight")})}:null}case"FLIGHTS_BOOKING":{const k=t.content;if(!k)return null;const M=k.found_booking_options,N=M&&M.length>0,P=k.submitted;return{isFinished:N,content:N?l.jsx(Gve,{stepUUID:t.uuid??"",goalId:k.goal_id??"",foundBookingOptions:k.found_booking_options,isSubmitted:P??!1}):null}}case"FLIGHTS_BOOKING_RESPONSE":{const{selected_booking_options:k,submitted:M}=t.content??{};return M&&k?{isFinished:r||d,content:(()=>{const P=[(O=>{const L=[];return O.together?.book_with?L.push(O.together.book_with):(O.departing?.book_with&&L.push(`Departing: ${O.departing.book_with}`),O.returning?.book_with&&L.push(`Returning: ${O.returning.book_with}`)),L.join(" | ")||"Booking options"})(k)];return l.jsx(Vr,{queries:P,icon:D("brand-booking")})})()}:null}case"FLIGHTS_AGENT":{const k=pEe(t.content.steps??[]),M=o?k:k.slice(-1);return{content:l.jsx(l.Fragment,{children:M.map(N=>{const P={step_type:N.step_type||"FLIGHTS_AGENT",content:N.browser_open_tab_content??N.browser_open_tab_results_content??N.flights_search_content??N.flights_booking_content??N.flights_search_response_content??N.flights_booking_response_content??{},uuid:N.uuid||"",assets:void 0},O=o?r||N.originalEndIndex<(t.content.steps?.length??0)-1:r;return l.jsx(E,{step:P,isFinished:O,isNested:i,onStepClick:s,showAllNestedSteps:o,disableAnimations:c},N.uuid)})})}}case"TERMINATE":return{content:t.content.reason?l.jsx(Y,{variant:"subtler",className:"py-xs inline-block rounded-lg px-2.5",children:l.jsx(B,{variant:"tinyRegular",className:"!text-[0.68rem]",children:t.content.reason})}):null};case"CANVAS_AGENT":{const k=t.content.asset_types??[],M={CODE_FILE:"a file",PDF_FILE:"a PDF",DOCX_FILE:"a document",XLSX_FILE:"a spreadsheet",APP:"an app",SLIDES:"slides"};return{content:l.jsx(Tye,{assetTypes:k,assetTypeLabels:M,isFinished:r})}}case"GENERATE_IMAGE":{const k=t.content.success;return{content:l.jsx(bxe,{prompt:t.content.prompt,success:k})}}case"GENERATE_VIDEO":return{content:l.jsx(B,{variant:"tinyRegular",className:"!text-[0.68rem]",children:t.content.prompt})};case"GENERATE_VIDEO_RESULTS":return{content:!g&&l.jsx(yxe,{urls:t.content.video_results.map(k=>k.url??""),onClick:s})};case"BROWSER_GROUP_TABS":return{content:t.content.payloads?.length>0?l.jsx("div",{className:"gap-sm flex flex-row flex-wrap",children:t.content.payloads.map((k,M)=>l.jsx(tT,{color:k.color,title:k.title??""},M))}):null};case"BROWSER_GROUP_TABS_RESULTS":return{content:t.content.success?null:l.jsx(cr,{icon:D("cancel"),text:h.couldNotFinish})};case"BROWSER_UNGROUP":return{content:t.content.payload?.groups_metadata&&t.content.payload.groups_metadata.length>0?(()=>{const k=t.content.payload.groups_metadata.map((M,N)=>({name:M.title||`Group ${N+1}`,url:"",source:M.title||`Group ${N+1}`}));return k.length===1?l.jsx(Vr,{queries:t.content.payload.groups_metadata.map(M=>M.title||"Unnamed Group"),initialDisplayCount:3,icon:D("folders")}):l.jsx(Bi,{results:k,icon:D("folders"),textClassName:"opacity-65 line-through decoration-subtle"})})():null};case"BROWSER_SEARCH_TAB_GROUPS":return{content:l.jsx(Vr,{queries:t.content.payload?.queries?.length?t.content.payload.queries:[h.allTabGroups],icon:D("user-scan")})};case"BROWSER_SEARCH_TAB_GROUPS_RESULT":return{content:t.content.results.length>0?l.jsx("div",{className:"gap-sm flex flex-row flex-wrap",children:t.content.results.map((k,M)=>l.jsx(tT,{color:k.color,title:k.title??""},M))}):null};case"GET_USER_INFO":{const k=t.content;if(!k||!k.names)return null;const M=k.found_users,N=M&&M.length>0,P=k.submitted;return{content:N&&!P?l.jsx(Vve,{goalId:k.goal_id??"",foundUsers:k.found_users,names:k.names,sendStepResult:y}):l.jsx(Vr,{queries:k.names,icon:D("user-search")})}}case"GET_USER_INFO_RESPONSE":{const{submitted:k,selected_users:M}=t.content??{},N=M?.some(P=>P.selected===!0);return k&&M?{content:(()=>{if(M.length===0){const P=[p("no_contacts_found")];return l.jsx(Vr,{queries:P,icon:D("address-book-off")})}return M.length===1?l.jsx(Vr,{queries:M.map(P=>`${P.display_name||""} ${P.email_address?`(${P.email_address})`:""}`.trim()),icon:D("address-book")}):l.jsx(Bi,{results:M.map(P=>({...P,url:P.email_address?`mailto:${P.email_address}`:void 0})),icon:D("address-book"),resultType:"userinfo",textClassName:P=>{const O="email_address"in P?P.email_address:void 0,L=M?.find(H=>H.email_address===O);return N&&L?.selected===!1?"opacity-65 line-through decoration-subtle":""}})})()}:null}case"GET_FREEBUSY":{const k=t.content;return{content:(()=>{const M=k.free_busy_response?.available_periods?.length??0;let N,P;return!k.authenticated&&r?(N=h.googleCalendarNotAuthenticated,P=D("calendar-off")):M===0&&r?(N=h.noAvailabilityFound,P=D("calendar-off")):M>0&&(N=h.availableTimesFound(M),P=D("calendar-week")),N?l.jsx(cr,{text:N,icon:P}):null})()}}case"GET_FREEBUSY_RESPONSE":return{content:(()=>{const k=t.content.free_busy_response?.available_periods?.length??0;let M,N;return!t.content.authenticated&&r?(M=h.googleCalendarNotAuthenticated,N=D("calendar-off")):k===0&&r?(M=h.noAvailabilityFound,N=D("calendar-off")):k>0&&(M=h.availableTimesFound(k),N=D("calendar-week")),M?l.jsx(cr,{text:M,icon:N}):null})()};case"PENDING_FILES":return{content:l.jsx(f1e,{attachments:t.content.attachments,attachmentProcessingProgress:t.content.attachmentProcessingProgress})};case"SEARCH_BROWSER":{const k=t.content.queries?.filter(N=>N!=null&&N.trim()!=="")||[],M=k.length>0?k:t.content.browser_content_sources?.map(N=>N in La?p(N):iEe(N))||[];return{content:l.jsx(Vr,{queries:M,isFinished:r})}}case"SEARCH_BROWSER_RESULTS":return{content:(()=>{const{open_tabs:k,recently_closed_tabs:M,history:N}=t.content,P=(k?.length||0)+(M?.length||0)+(N?.length||0);if(P===0)return l.jsx(cr,{icon:D("zoom-out"),text:m({defaultMessage:"No sources found",id:"yWSiuEkfbY"})});if(P===1){const L=k?.[0]||M?.[0]||N?.[0];return l.jsx(ld,{result:{...L},showName:!0,onClick:s})}const O=[];return k&&k.length>0&&O.push(...k.map(L=>({...L,category:"open_tab"}))),M&&M.length>0&&O.push(...M.map(L=>({...L,category:"closed_tab"}))),N&&N.length>0&&O.push(...N.map(L=>({...L,category:"history"}))),l.jsx(Bi,{onClick:s,results:O,groupBy:"category",stepDelay:n?2:void 0,isFinished:r})})()};case"MCP_TOOL_INPUT":{const k=t.content,M=k.source_type;if("authenticated"in k&&(k.authenticated===void 0||k.authenticated===null))return null;let N=m({id:"bTDpQ+Tk24",defaultMessage:"external service"});k.mcp_server_type==="MCP_SERVER_TYPE_LOCAL"?N=m({id:"0asQ8snMnq",defaultMessage:"local MCP"}):k?.app&&(N=k.app);const P=k.request_user_approval?.uuid;return{content:l.jsxs(l.Fragment,{children:[l.jsx(i1e,{step:t,isFinished:r,onActionTaken:()=>_(!1)}),v&&l.jsx("div",{className:"mt-2",children:l.jsx(UM,{entryUUID:C?.backend_uuid??"",sourceType:M,sourceName:N,userApprovalUuid:P,onSkipSourceClicked:()=>_(!0),isAutoDetected:M?!w.includes(M):!1})})]})}}case"MCP_TOOL_OUTPUT":{const k=t.content;return{content:l.jsx(u1e,{content:k.content||"",shouldRerunQuery:!!k.should_rerun_query})}}case"CONNECTOR_DIRECT_SEARCH_INPUT":{const k=t.content.source_type,M=t.content.formatted_connection_type,N=!!t.output_content,P=!!C?.backend_uuid&&!!k;return{content:l.jsxs(l.Fragment,{children:[l.jsx(c0e,{step:t}),P&&l.jsx("div",{className:"mt-2",children:l.jsx(UM,{entryUUID:C.backend_uuid,sourceType:k,sourceName:M,onSkipSourceClicked:()=>{},isAutoDetected:!1})})]}),isFinished:N}}case"RESEARCH_CLARIFYING_QUESTIONS":{const k=t.content.questions||[],M=t.content.auto_skip_seconds,N=t.content.title;return{content:l.jsx(L1e,{questions:k,toolUuid:t.content.uuid||t.uuid,autoSkipSeconds:M,isFinished:r,entryUuid:C?.backend_uuid,title:N})}}case"COMET_AGENT_TOOL_INPUT":{const k=t.content.tool_input;if(k?.todo_write){const M=x?.findIndex(L=>L.uuid===t.uuid)??-1,P=x?.some((L,H)=>H>=M?!1:L?.step_type==="COMET_AGENT_TOOL_INPUT"&&"tool_input"in L.content&&L.content.tool_input?.todo_write)??!1?"updating_todo_list":"creating_todo_list",O=k.todo_write.todos||[];return{content:l.jsxs(l.Fragment,{children:[l.jsx(ea,{action:P,isFinished:r,className:"mb-two",showAnimation:c}),l.jsx(v0e,{todos:O})]})}}else{if(k?.subagent_tool_inputs)return{content:l.jsxs(l.Fragment,{children:[l.jsx(ea,{action:"running_sub_tasks",isFinished:r,className:"mb-two",showAnimation:c}),l.jsx(b0e,{tool_input_content:t.content})]})};if(k?.computer_list?.actions?.length){const M=k.computer_list.uuid,N=k.computer_list.actions,P=b[M??""]??[],O=r?N:P;return{content:l.jsx(l.Fragment,{children:O.map((L,H)=>{const R=H===O.length-1,I=L.action,F=I&&I in La?I:"working";if(I==="wait")return l.jsx(ea,{title:h.waitingDuration(L.duration??1),icon:D("access-point"),isFinished:r||!R,className:"-my-1.5",showAnimation:c},H);let G;return I==="type"&&L.text?G=`: ${Nx(L.text,35)}`:I==="key"&&(G=`: ${L.text}`),l.jsx(ea,{action:F,title:G,isFinished:r||!R,className:"-my-1.5",showAnimation:c},H)})})}}else if(k?.navigate?.url){const M=k.navigate.url,N=M==="forward"?h.navigatingForward:M==="back"?h.navigatingBack:h.navigatingToUrl(Nx(M,35));return{content:l.jsx(ea,{title:N,icon:D("location"),isFinished:r,className:"-my-1.5",showAnimation:c})}}else{if(k?.bash)return{content:l.jsx(ea,{title:k.bash.description||h.runningCommand,icon:D("terminal-2"),isFinished:r,className:"-my-1.5",showAnimation:c})};{const M=Object.entries(k??{}).find(([O,L])=>L)?.[0];if(!M)return null;const N=M in La?M:"working";let P;return k?.find?.query?P=`: ${Nx(k.find.query,35)}`:k?.file_read?P=` ${k.file_read.file_name}`:k?.file_write?P=` ${k.file_write.file_name}`:k?.file_edit&&(P=` ${k.file_edit.file_name}`),{content:l.jsx(ea,{action:N,title:P,isFinished:r,className:"-my-1.5",showAnimation:c})}}}}}case"COMET_AGENT_TOOL_OUTPUT":{const k=t.content.tool_output;if(k?.call_site_specific_tool?.connector)return{content:l.jsx(mL,{connector:k.call_site_specific_tool.connector}),isFinished:r};if(k?.enterprise_blocked)return{content:l.jsx(cr,{icon:D("shield-lock"),text:m({defaultMessage:"Action blocked by your organization",id:"5ffgbeDQIU"})})};const M=k?.computer?.screenshot_uuid||k?.tabs_create?.screenshot_uuid||k?.navigate?.screenshot_uuid||k?.form_input?.screenshot_uuid,N=k?.computer?.screenshots||k?.tabs_create?.screenshots||k?.navigate?.screenshots||k?.form_input?.screenshots;return S?null:{content:l.jsx(Rye,{isFinished:r,screenshot_uuid:M,screenshots:N})}}case"COUNCIL_RESEARCH":{const k=t.content.model_summaries??[];return{content:l.jsx(x0e,{modelSummaries:k,StepRendererComponent:E,isFinished:r})}}default:return null}}const gEe=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"hide-screenshots-in-sidecar",defaultValue:e,extraAttributes:t,subjectType:"user_nextauth_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])};function yEe(e){const{sourceType:t,skippedSources:n}=e;return!(!t||n.has(t))}const YU=e=>{const{searchMode:t,hasAnswer:n,result:r,inFlight:s,skippedSources:a,steps:o}=Pt(),i=t===K.STUDIO,{taskComputerActions:c}=Sn(),{$t:u}=Q(),{step:d,onStepClick:m,isFinished:p,stepDelay:h,motionProps:g,isNested:y=!1,showAllNestedSteps:b=!0,isMissionControl:x=!1,disableAnimations:_=!1}=e,[v,C]=f.useState(void 0),w=d.step_type==="MCP_TOOL_INPUT"?d.content.source_type:void 0,S=Array.from(r?.sources?.sources??[]),E=yEe({sourceType:w,skippedSources:new Set(a)}),{variation:T}=gEe(!1),k=d.step_type==="MCP_TOOL_INPUT"?d.content.app:void 0,M=A.useMemo(()=>v!==void 0?v:E&&!p&&!!r?.backend_uuid&&d.step_type==="MCP_TOOL_INPUT"&&!!k,[v,E,p,r?.backend_uuid,d.step_type,k]),N=f.useCallback(async(le,se)=>{d.uuid&&await tu({contextUUID:r?.context_uuid,stepUUID:d.uuid,result:le,reason:se})},[d.uuid,r]),P=f.useCallback(async()=>{await N({confirmed:!0},"thread-upsell-accepted")},[N]),O=f.useCallback(async()=>{await N({confirmed:!1},"thread-upsell-dismissed")},[N]),L=(le,se)=>{const re=La[le]?.message;return re?se?u(re,se):u(re):""},H=dhe(),R=d.assets&&d.assets.length>0?l.jsx("div",{className:"gap-sm my-sm flex flex-row flex-wrap",children:d.assets.map(le=>l.jsx(che,{asset:le},le.uuid))}):null,I=d.step_type,F=d.content.should_show_upsell??!1,G=d.content.upsell_information,j=l.jsx(Cf,{position:"router_steps",upsellInformation:G,inFlight:!p,stepUUID:d.uuid,backendUuid:G?.backend_uuid,isLastResult:!0,onAccept:P,onReject:O}),$=hEe({step:d,isStudio:i,isFinished:p,onStepClick:m,stepDelay:h,showAllNestedSteps:b,isNested:y,disableAnimations:_,isMissionControl:x,hasAnswer:n,$t:u,getActionMessage:L,translations:H,assetsContent:R,sendStepResult:N,taskComputerActions:c,allSteps:o,setShouldShowSkipButtonOverride:C,shouldShowSourceSkipButton:M,entryResult:r,enabledSources:S,shouldHideScreenshotsInSidecar:T,StepRendererComponent:YU});if(cEe({step:d,streamId:r?.uuid,inFlight:s,allSteps:o}),!$)return x?l.jsx(ea,{title:L("working"),showAnimation:_,className:"mt-sm"}):null;const{content:q,isFinished:U}=$,X=uEe(d,L,o),J=F&&G?!0:U??p??!1,ne={key:d.uuid,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"mt-1.5 empty:hidden"},ae={...ne,...g,className:g?.className?`${ne.className} ${g.className}`:ne.className},{key:de,...oe}=ae;return l.jsxs(ze.div,{...oe,children:[X&&l.jsx(ea,{title:X,isFinished:J,className:"mb-two",showAnimation:_}),!X&&x&&!J&&I!=="ENTROPY_REQUEST"&&l.jsx(ea,{title:L("working"),showAnimation:_,className:"mb-two"}),F&&G?j:q,R]},de)},xEe={xs:7,sm:9,md:11,lg:15},bEe=A.memo(function({state:t,className:n,size:r="md",showFinishedIcon:s=!0}){const a=xEe[r],o={width:a,height:a,backfaceVisibility:"hidden"},i=f.useMemo(()=>({height:`calc(100% - ${a/3}px)`}),[a]);return t==="hidden"?null:l.jsxs("div",{className:z({relative:!n?.includes("absolute")&&!n?.includes("relative")},n),children:[l.jsx("div",{className:z("shrink-0 rounded-full border",{"bg-base border-subtler":t==="planned","bg-inverse/25 dark:bg-inverse/20 flex border-transparent":t==="finished","border-super bg-super":t==="loading"}),style:o,children:t==="finished"&&s&&l.jsx("div",{className:"relative flex size-full bg-transparent transition-opacity ease-linear",children:l.jsx(ye,{icon:D("check"),className:"text-inverse w-full place-self-center",stroke:4,style:i})})}),t==="loading"&&l.jsx("div",{className:"border-super absolute left-0 top-0 animate-ping rounded-full border-2 opacity-75",style:o})]})}),Ay=[.4,0,.2,1],_Ee=A.memo(function({status:t,state:n,showStatus:r,timelineConnectorClassName:s,hasSteps:a,isFinalGoal:o=!1}){return r?l.jsxs("span",{className:"relative flex w-[15px] shrink-0 flex-col items-center",children:[l.jsx("span",{className:z(s,"h-[13px]","group-first/goal:opacity-0 group-only/goal:opacity-0")}),r&&l.jsx(ze.div,{animate:{scale:t==="loading"?1.1:1,transition:{duration:.2,ease:Ay}},children:l.jsx("div",{className:"bg-base",children:l.jsx(bEe,{state:n,showFinishedIcon:!1,size:"xs"})})}),!o&&l.jsx("span",{className:z(s,"grow",!a&&"group-last/goal:opacity-0")})]}):null});function QU(){const{value:e}=Lt({flag:"move-citations-to-paragraph-end",subjectType:"visitor_id",defaultValue:!0});return e}typeof globalThis<"u"&&(globalThis.__useMoveCitationsToParagraphEnd=QU);const vEe=()=>{const[e,t]=f.useState(!1),n=f.useCallback(s=>{(s.key==="PrintScreen"||s.metaKey&&s.shiftKey)&&t(!0)},[]),r=f.useCallback(()=>{t(!1)},[]);return f.useEffect(()=>(window.addEventListener("keydown",n),window.addEventListener("keyup",r),()=>{window.removeEventListener("keydown",n),window.removeEventListener("keyup",r)}),[n,r]),e};function aQe(e){const t=[],n=String(e||"");let r=n.indexOf(","),s=0,a=!1;for(;!a;){r===-1&&(r=n.length,a=!0);const o=n.slice(s,r).trim();(o||!a)&&t.push(o),s=r+1,r=n.indexOf(",",s)}return t}function CEe(e,t){const n={};return(e[e.length-1]===""?[...e,""]:e).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const wEe=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,SEe=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,EEe={};function eA(e,t){return(EEe.jsx?SEe:wEe).test(e)}const kEe=/[ \t\n\f\r]/g;function MEe(e){return typeof e=="object"?e.type==="text"?tA(e.value):!1:tA(e)}function tA(e){return e.replace(kEe,"")===""}class km{constructor(t,n,r){this.normal=n,this.property=t,r&&(this.space=r)}}km.prototype.normal={};km.prototype.property={};km.prototype.space=void 0;function XU(e,t){const n={},r={};for(const s of e)Object.assign(n,s.property),Object.assign(r,s.normal);return new km(n,r,t)}function J_(e){return e.toLowerCase()}class rs{constructor(t,n){this.attribute=n,this.property=t}}rs.prototype.attribute="";rs.prototype.booleanish=!1;rs.prototype.boolean=!1;rs.prototype.commaOrSpaceSeparated=!1;rs.prototype.commaSeparated=!1;rs.prototype.defined=!1;rs.prototype.mustUseProperty=!1;rs.prototype.number=!1;rs.prototype.overloadedBoolean=!1;rs.prototype.property="";rs.prototype.spaceSeparated=!1;rs.prototype.space=void 0;let TEe=0;const kt=zl(),Kn=zl(),ZU=zl(),Ie=zl(),vn=zl(),Nc=zl(),is=zl();function zl(){return 2**++TEe}const ev=Object.freeze(Object.defineProperty({__proto__:null,boolean:kt,booleanish:Kn,commaOrSpaceSeparated:is,commaSeparated:Nc,number:Ie,overloadedBoolean:ZU,spaceSeparated:vn},Symbol.toStringTag,{value:"Module"})),D1=Object.keys(ev);class s3 extends rs{constructor(t,n,r,s){let a=-1;if(super(t,n),nA(this,"space",s),typeof r=="number")for(;++a<D1.length;){const o=D1[a];nA(this,D1[a],(r&ev[o])===ev[o])}}}s3.prototype.defined=!0;function nA(e,t,n){n&&(e[t]=n)}function Lu(e){const t={},n={};for(const[r,s]of Object.entries(e.properties)){const a=new s3(r,e.transform(e.attributes||{},r),s,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(a.mustUseProperty=!0),t[r]=a,n[J_(r)]=r,n[J_(a.attribute)]=r}return new km(t,n,e.space)}const JU=Lu({properties:{ariaActiveDescendant:null,ariaAtomic:Kn,ariaAutoComplete:null,ariaBusy:Kn,ariaChecked:Kn,ariaColCount:Ie,ariaColIndex:Ie,ariaColSpan:Ie,ariaControls:vn,ariaCurrent:null,ariaDescribedBy:vn,ariaDetails:null,ariaDisabled:Kn,ariaDropEffect:vn,ariaErrorMessage:null,ariaExpanded:Kn,ariaFlowTo:vn,ariaGrabbed:Kn,ariaHasPopup:null,ariaHidden:Kn,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:vn,ariaLevel:Ie,ariaLive:null,ariaModal:Kn,ariaMultiLine:Kn,ariaMultiSelectable:Kn,ariaOrientation:null,ariaOwns:vn,ariaPlaceholder:null,ariaPosInSet:Ie,ariaPressed:Kn,ariaReadOnly:Kn,ariaRelevant:null,ariaRequired:Kn,ariaRoleDescription:vn,ariaRowCount:Ie,ariaRowIndex:Ie,ariaRowSpan:Ie,ariaSelected:Kn,ariaSetSize:Ie,ariaSort:null,ariaValueMax:Ie,ariaValueMin:Ie,ariaValueNow:Ie,ariaValueText:null,role:null},transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()}});function eB(e,t){return t in e?e[t]:t}function tB(e,t){return eB(e,t.toLowerCase())}const AEe=Lu({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Nc,acceptCharset:vn,accessKey:vn,action:null,allow:null,allowFullScreen:kt,allowPaymentRequest:kt,allowUserMedia:kt,alt:null,as:null,async:kt,autoCapitalize:null,autoComplete:vn,autoFocus:kt,autoPlay:kt,blocking:vn,capture:null,charSet:null,checked:kt,cite:null,className:vn,cols:Ie,colSpan:null,content:null,contentEditable:Kn,controls:kt,controlsList:vn,coords:Ie|Nc,crossOrigin:null,data:null,dateTime:null,decoding:null,default:kt,defer:kt,dir:null,dirName:null,disabled:kt,download:ZU,draggable:Kn,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:kt,formTarget:null,headers:vn,height:Ie,hidden:kt,high:Ie,href:null,hrefLang:null,htmlFor:vn,httpEquiv:vn,id:null,imageSizes:null,imageSrcSet:null,inert:kt,inputMode:null,integrity:null,is:null,isMap:kt,itemId:null,itemProp:vn,itemRef:vn,itemScope:kt,itemType:vn,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:kt,low:Ie,manifest:null,max:null,maxLength:Ie,media:null,method:null,min:null,minLength:Ie,multiple:kt,muted:kt,name:null,nonce:null,noModule:kt,noValidate:kt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:kt,optimum:Ie,pattern:null,ping:vn,placeholder:null,playsInline:kt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:kt,referrerPolicy:null,rel:vn,required:kt,reversed:kt,rows:Ie,rowSpan:Ie,sandbox:vn,scope:null,scoped:kt,seamless:kt,selected:kt,shadowRootClonable:kt,shadowRootDelegatesFocus:kt,shadowRootMode:null,shape:null,size:Ie,sizes:null,slot:null,span:Ie,spellCheck:Kn,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Ie,step:null,style:null,tabIndex:Ie,target:null,title:null,translate:null,type:null,typeMustMatch:kt,useMap:null,value:Kn,width:Ie,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:vn,axis:null,background:null,bgColor:null,border:Ie,borderColor:null,bottomMargin:Ie,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:kt,declare:kt,event:null,face:null,frame:null,frameBorder:null,hSpace:Ie,leftMargin:Ie,link:null,longDesc:null,lowSrc:null,marginHeight:Ie,marginWidth:Ie,noResize:kt,noHref:kt,noShade:kt,noWrap:kt,object:null,profile:null,prompt:null,rev:null,rightMargin:Ie,rules:null,scheme:null,scrolling:Kn,standby:null,summary:null,text:null,topMargin:Ie,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Ie,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:kt,disableRemotePlayback:kt,prefix:null,property:null,results:Ie,security:null,unselectable:null},space:"html",transform:tB}),NEe=Lu({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:is,accentHeight:Ie,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Ie,amplitude:Ie,arabicForm:null,ascent:Ie,attributeName:null,attributeType:null,azimuth:Ie,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Ie,by:null,calcMode:null,capHeight:Ie,className:vn,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Ie,diffuseConstant:Ie,direction:null,display:null,dur:null,divisor:Ie,dominantBaseline:null,download:kt,dx:null,dy:null,edgeMode:null,editable:null,elevation:Ie,enableBackground:null,end:null,event:null,exponent:Ie,externalResourcesRequired:null,fill:null,fillOpacity:Ie,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Nc,g2:Nc,glyphName:Nc,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Ie,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Ie,horizOriginX:Ie,horizOriginY:Ie,id:null,ideographic:Ie,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Ie,k:Ie,k1:Ie,k2:Ie,k3:Ie,k4:Ie,kernelMatrix:is,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Ie,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Ie,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Ie,overlineThickness:Ie,paintOrder:null,panose1:null,path:null,pathLength:Ie,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:vn,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Ie,pointsAtY:Ie,pointsAtZ:Ie,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:is,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:is,rev:is,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:is,requiredFeatures:is,requiredFonts:is,requiredFormats:is,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Ie,specularExponent:Ie,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Ie,strikethroughThickness:Ie,string:null,stroke:null,strokeDashArray:is,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Ie,strokeOpacity:Ie,strokeWidth:null,style:null,surfaceScale:Ie,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:is,tabIndex:Ie,tableValues:null,target:null,targetX:Ie,targetY:Ie,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:is,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Ie,underlineThickness:Ie,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Ie,values:null,vAlphabetic:Ie,vMathematical:Ie,vectorEffect:null,vHanging:Ie,vIdeographic:Ie,version:null,vertAdvY:Ie,vertOriginX:Ie,vertOriginY:Ie,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Ie,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:eB}),nB=Lu({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()}}),rB=Lu({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:tB}),sB=Lu({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()}}),REe={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},DEe=/[A-Z]/g,rA=/-[a-z]/g,IEe=/^data[-\w.:]+$/i;function jEe(e,t){const n=J_(t);let r=t,s=rs;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&IEe.test(t)){if(t.charAt(4)==="-"){const a=t.slice(5).replace(rA,OEe);r="data"+a.charAt(0).toUpperCase()+a.slice(1)}else{const a=t.slice(4);if(!rA.test(a)){let o=a.replace(DEe,PEe);o.charAt(0)!=="-"&&(o="-"+o),t="data"+o}}s=s3}return new s(r,t)}function PEe(e){return"-"+e.toLowerCase()}function OEe(e){return e.charAt(1).toUpperCase()}const LEe=XU([JU,AEe,nB,rB,sB],"html"),a3=XU([JU,NEe,nB,rB,sB],"svg");function FEe(e){const t=String(e||"").trim();return t?t.split(/[ \t\n\r\f]+/g):[]}function UEe(e){return e.join(" ").trim()}var ac={},I1,sA;function BEe(){if(sA)return I1;sA=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,t=/\n/g,n=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,s=/^:\s*/,a=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,o=/^[;\s]*/,i=/^\s+|\s+$/g,c=`
`,u="/",d="*",m="",p="comment",h="declaration";I1=function(y,b){if(typeof y!="string")throw new TypeError("First argument must be a string");if(!y)return[];b=b||{};var x=1,_=1;function v(O){var L=O.match(t);L&&(x+=L.length);var H=O.lastIndexOf(c);_=~H?O.length-H:_+O.length}function C(){var O={line:x,column:_};return function(L){return L.position=new w(O),T(),L}}function w(O){this.start=O,this.end={line:x,column:_},this.source=b.source}w.prototype.content=y;function S(O){var L=new Error(b.source+":"+x+":"+_+": "+O);if(L.reason=O,L.filename=b.source,L.line=x,L.column=_,L.source=y,!b.silent)throw L}function E(O){var L=O.exec(y);if(L){var H=L[0];return v(H),y=y.slice(H.length),L}}function T(){E(n)}function k(O){var L;for(O=O||[];L=M();)L!==!1&&O.push(L);return O}function M(){var O=C();if(!(u!=y.charAt(0)||d!=y.charAt(1))){for(var L=2;m!=y.charAt(L)&&(d!=y.charAt(L)||u!=y.charAt(L+1));)++L;if(L+=2,m===y.charAt(L-1))return S("End of comment missing");var H=y.slice(2,L-2);return _+=2,v(H),y=y.slice(L),_+=2,O({type:p,comment:H})}}function N(){var O=C(),L=E(r);if(L){if(M(),!E(s))return S("property missing ':'");var H=E(a),R=O({type:h,property:g(L[0].replace(e,m)),value:H?g(H[0].replace(e,m)):m});return E(o),R}}function P(){var O=[];k(O);for(var L;L=N();)L!==!1&&(O.push(L),k(O));return O}return T(),P()};function g(y){return y?y.replace(i,m):m}return I1}var aA;function HEe(){if(aA)return ac;aA=1;var e=ac&&ac.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ac,"__esModule",{value:!0}),ac.default=n;var t=e(BEe());function n(r,s){var a=null;if(!r||typeof r!="string")return a;var o=(0,t.default)(r),i=typeof s=="function";return o.forEach(function(c){if(c.type==="declaration"){var u=c.property,d=c.value;i?s(u,d,c):d&&(a=a||{},a[u]=d)}}),a}return ac}var hd={},oA;function VEe(){if(oA)return hd;oA=1,Object.defineProperty(hd,"__esModule",{value:!0}),hd.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,t=/-([a-z])/g,n=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,s=/^-(ms)-/,a=function(u){return!u||n.test(u)||e.test(u)},o=function(u,d){return d.toUpperCase()},i=function(u,d){return"".concat(d,"-")},c=function(u,d){return d===void 0&&(d={}),a(u)?u:(u=u.toLowerCase(),d.reactCompat?u=u.replace(s,i):u=u.replace(r,i),u.replace(t,o))};return hd.camelCase=c,hd}var gd,iA;function GEe(){if(iA)return gd;iA=1;var e=gd&&gd.__importDefault||function(s){return s&&s.__esModule?s:{default:s}},t=e(HEe()),n=VEe();function r(s,a){var o={};return!s||typeof s!="string"||(0,t.default)(s,function(i,c){i&&c&&(o[(0,n.camelCase)(i,a)]=c)}),o}return r.default=r,gd=r,gd}var zEe=GEe();const qEe=ha(zEe),aB=oB("end"),o3=oB("start");function oB(e){return t;function t(n){const r=n&&n.position&&n.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function $Ee(e){const t=o3(e),n=aB(e);if(t&&n)return{start:t,end:n}}function Qd(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?lA(e.position):"start"in e||"end"in e?lA(e):"line"in e||"column"in e?tv(e):""}function tv(e){return cA(e&&e.line)+":"+cA(e&&e.column)}function lA(e){return tv(e&&e.start)+"-"+tv(e&&e.end)}function cA(e){return e&&typeof e=="number"?e:1}class Ar extends Error{constructor(t,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let s="",a={},o=!1;if(n&&("line"in n&&"column"in n?a={place:n}:"start"in n&&"end"in n?a={place:n}:"type"in n?a={ancestors:[n],place:n.position}:a={...n}),typeof t=="string"?s=t:!a.cause&&t&&(o=!0,s=t.message,a.cause=t),!a.ruleId&&!a.source&&typeof r=="string"){const c=r.indexOf(":");c===-1?a.ruleId=r:(a.source=r.slice(0,c),a.ruleId=r.slice(c+1))}if(!a.place&&a.ancestors&&a.ancestors){const c=a.ancestors[a.ancestors.length-1];c&&(a.place=c.position)}const i=a.place&&"start"in a.place?a.place.start:a.place;this.ancestors=a.ancestors||void 0,this.cause=a.cause||void 0,this.column=i?i.column:void 0,this.fatal=void 0,this.file,this.message=s,this.line=i?i.line:void 0,this.name=Qd(a.place)||"1:1",this.place=a.place||void 0,this.reason=this.message,this.ruleId=a.ruleId||void 0,this.source=a.source||void 0,this.stack=o&&a.cause&&typeof a.cause.stack=="string"?a.cause.stack:"",this.actual,this.expected,this.note,this.url}}Ar.prototype.file="";Ar.prototype.name="";Ar.prototype.reason="";Ar.prototype.message="";Ar.prototype.stack="";Ar.prototype.column=void 0;Ar.prototype.line=void 0;Ar.prototype.ancestors=void 0;Ar.prototype.cause=void 0;Ar.prototype.fatal=void 0;Ar.prototype.place=void 0;Ar.prototype.ruleId=void 0;Ar.prototype.source=void 0;const i3={}.hasOwnProperty,WEe=new Map,KEe=/[A-Z]/g,YEe=new Set(["table","tbody","thead","tfoot","tr"]),QEe=new Set(["td","th"]),iB="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function XEe(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=t.filePath||void 0;let r;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=a3e(n,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=s3e(n,t.jsx,t.jsxs)}const s={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:r,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?a3:LEe,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},a=lB(s,e,void 0);return a&&typeof a!="string"?a:s.create(e,s.Fragment,{children:a||void 0},void 0)}function lB(e,t,n){if(t.type==="element")return ZEe(e,t,n);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return JEe(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return t3e(e,t,n);if(t.type==="mdxjsEsm")return e3e(e,t);if(t.type==="root")return n3e(e,t,n);if(t.type==="text")return r3e(e,t)}function ZEe(e,t,n){const r=e.schema;let s=r;t.tagName.toLowerCase()==="svg"&&r.space==="html"&&(s=a3,e.schema=s),e.ancestors.push(t);const a=uB(e,t.tagName,!1),o=o3e(e,t);let i=c3(e,t);return YEe.has(t.tagName)&&(i=i.filter(function(c){return typeof c=="string"?!MEe(c):!0})),cB(e,o,a,t),l3(o,i),e.ancestors.pop(),e.schema=r,e.create(t,a,o,n)}function JEe(e,t){if(t.data&&t.data.estree&&e.evaluater){const r=t.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}Ef(e,t.position)}function e3e(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);Ef(e,t.position)}function t3e(e,t,n){const r=e.schema;let s=r;t.name==="svg"&&r.space==="html"&&(s=a3,e.schema=s),e.ancestors.push(t);const a=t.name===null?e.Fragment:uB(e,t.name,!0),o=i3e(e,t),i=c3(e,t);return cB(e,o,a,t),l3(o,i),e.ancestors.pop(),e.schema=r,e.create(t,a,o,n)}function n3e(e,t,n){const r={};return l3(r,c3(e,t)),e.create(t,e.Fragment,r,n)}function r3e(e,t){return t.value}function cB(e,t,n,r){typeof n!="string"&&n!==e.Fragment&&e.passNode&&(t.node=r)}function l3(e,t){if(t.length>0){const n=t.length>1?t:t[0];n&&(e.children=n)}}function s3e(e,t,n){return r;function r(s,a,o,i){const u=Array.isArray(o.children)?n:t;return i?u(a,o,i):u(a,o)}}function a3e(e,t){return n;function n(r,s,a,o){const i=Array.isArray(a.children),c=o3(r);return t(s,a,o,i,{columnNumber:c?c.column-1:void 0,fileName:e,lineNumber:c?c.line:void 0},void 0)}}function o3e(e,t){const n={};let r,s;for(s in t.properties)if(s!=="children"&&i3.call(t.properties,s)){const a=l3e(e,s,t.properties[s]);if(a){const[o,i]=a;e.tableCellAlignToStyle&&o==="align"&&typeof i=="string"&&QEe.has(t.tagName)?r=i:n[o]=i}}if(r){const a=n.style||(n.style={});a[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return n}function i3e(e,t){const n={};for(const r of t.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const a=r.data.estree.body[0];a.type;const o=a.expression;o.type;const i=o.properties[0];i.type,Object.assign(n,e.evaluater.evaluateExpression(i.argument))}else Ef(e,t.position);else{const s=r.name;let a;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const i=r.value.data.estree.body[0];i.type,a=e.evaluater.evaluateExpression(i.expression)}else Ef(e,t.position);else a=r.value===null?!0:r.value;n[s]=a}return n}function c3(e,t){const n=[];let r=-1;const s=e.passKeys?new Map:WEe;for(;++r<t.children.length;){const a=t.children[r];let o;if(e.passKeys){const c=a.type==="element"?a.tagName:a.type==="mdxJsxFlowElement"||a.type==="mdxJsxTextElement"?a.name:void 0;if(c){const u=s.get(c)||0;o=c+"-"+u,s.set(c,u+1)}}const i=lB(e,a,o);i!==void 0&&n.push(i)}return n}function l3e(e,t,n){const r=jEe(e.schema,t);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?CEe(n):UEe(n)),r.property==="style"){let s=typeof n=="object"?n:c3e(e,String(n));return e.stylePropertyNameCase==="css"&&(s=u3e(s)),["style",s]}return[e.elementAttributeNameCase==="react"&&r.space?REe[r.property]||r.property:r.attribute,n]}}function c3e(e,t){try{return qEe(t,{reactCompat:!0})}catch(n){if(e.ignoreInvalidStyle)return{};const r=n,s=new Ar("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw s.file=e.filePath||void 0,s.url=iB+"#cannot-parse-style-attribute",s}}function uB(e,t,n){let r;if(!n)r={type:"Literal",value:t};else if(t.includes(".")){const s=t.split(".");let a=-1,o;for(;++a<s.length;){const i=eA(s[a])?{type:"Identifier",name:s[a]}:{type:"Literal",value:s[a]};o=o?{type:"MemberExpression",object:o,property:i,computed:!!(a&&i.type==="Literal"),optional:!1}:i}r=o}else r=eA(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(r.type==="Literal"){const s=r.value;return i3.call(e.components,s)?e.components[s]:s}if(e.evaluater)return e.evaluater.evaluateExpression(r);Ef(e)}function Ef(e,t){const n=new Ar("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=iB+"#cannot-handle-mdx-estrees-without-createevaluater",n}function u3e(e){const t={};let n;for(n in e)i3.call(e,n)&&(t[d3e(n)]=e[n]);return t}function d3e(e){let t=e.replace(KEe,f3e);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function f3e(e){return"-"+e.toLowerCase()}const j1={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},m3e={};function u3(e,t){const n=m3e,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,s=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return dB(e,r,s)}function dB(e,t,n){if(p3e(e)){if("value"in e)return e.type==="html"&&!n?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return uA(e.children,t,n)}return Array.isArray(e)?uA(e,t,n):""}function uA(e,t,n){const r=[];let s=-1;for(;++s<e.length;)r[s]=dB(e[s],t,n);return r.join("")}function p3e(e){return!!(e&&typeof e=="object")}const dA=document.createElement("i");function d3(e){const t="&"+e+";";dA.innerHTML=t;const n=dA.textContent;return n.charCodeAt(n.length-1)===59&&e!=="semi"||n===t?!1:n}function gs(e,t,n,r){const s=e.length;let a=0,o;if(t<0?t=-t>s?0:s+t:t=t>s?s:t,n=n>0?n:0,r.length<1e4)o=Array.from(r),o.unshift(t,n),e.splice(...o);else for(n&&e.splice(t,n);a<r.length;)o=r.slice(a,a+1e4),o.unshift(t,0),e.splice(...o),a+=1e4,t+=1e4}function Ns(e,t){return e.length>0?(gs(e,e.length,0,t),e):t}const fA={}.hasOwnProperty;function fB(e){const t={};let n=-1;for(;++n<e.length;)h3e(t,e[n]);return t}function h3e(e,t){let n;for(n in t){const s=(fA.call(e,n)?e[n]:void 0)||(e[n]={}),a=t[n];let o;if(a)for(o in a){fA.call(s,o)||(s[o]=[]);const i=a[o];g3e(s[o],Array.isArray(i)?i:i?[i]:[])}}}function g3e(e,t){let n=-1;const r=[];for(;++n<t.length;)(t[n].add==="after"?e:r).push(t[n]);gs(e,0,0,r)}function mB(e,t){const n=Number.parseInt(e,t);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"":String.fromCodePoint(n)}function ua(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Pr=Ri(/[A-Za-z]/),Mr=Ri(/[\dA-Za-z]/),y3e=Ri(/[#-'*+\--9=?A-Z^-~]/);function yg(e){return e!==null&&(e<32||e===127)}const nv=Ri(/\d/),x3e=Ri(/[\dA-Fa-f]/),b3e=Ri(/[!-/:-@[-`{-~]/);function Xe(e){return e!==null&&e<-2}function bn(e){return e!==null&&(e<0||e===32)}function Ot(e){return e===-2||e===-1||e===32}const Ny=Ri(new RegExp("\\p{P}|\\p{S}","u")),vl=Ri(/\s/);function Ri(e){return t;function t(n){return n!==null&&n>-1&&e.test(String.fromCharCode(n))}}function Fu(e){const t=[];let n=-1,r=0,s=0;for(;++n<e.length;){const a=e.charCodeAt(n);let o="";if(a===37&&Mr(e.charCodeAt(n+1))&&Mr(e.charCodeAt(n+2)))s=2;else if(a<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(a))||(o=String.fromCharCode(a));else if(a>55295&&a<57344){const i=e.charCodeAt(n+1);a<56320&&i>56319&&i<57344?(o=String.fromCharCode(a,i),s=1):o=""}else o=String.fromCharCode(a);o&&(t.push(e.slice(r,n),encodeURIComponent(o)),r=n+s+1,o=""),s&&(n+=s,s=0)}return t.join("")+e.slice(r)}function Nt(e,t,n,r){const s=r?r-1:Number.POSITIVE_INFINITY;let a=0;return o;function o(c){return Ot(c)?(e.enter(n),i(c)):t(c)}function i(c){return Ot(c)&&a++<s?(e.consume(c),i):(e.exit(n),t(c))}}const _3e={tokenize:v3e};function v3e(e){const t=e.attempt(this.parser.constructs.contentInitial,r,s);let n;return t;function r(i){if(i===null){e.consume(i);return}return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),Nt(e,t,"linePrefix")}function s(i){return e.enter("paragraph"),a(i)}function a(i){const c=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=c),n=c,o(i)}function o(i){if(i===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(i);return}return Xe(i)?(e.consume(i),e.exit("chunkText"),a):(e.consume(i),o)}}const C3e={tokenize:w3e},mA={tokenize:S3e};function w3e(e){const t=this,n=[];let r=0,s,a,o;return i;function i(v){if(r<n.length){const C=n[r];return t.containerState=C[1],e.attempt(C[0].continuation,c,u)(v)}return u(v)}function c(v){if(r++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,s&&_();const C=t.events.length;let w=C,S;for(;w--;)if(t.events[w][0]==="exit"&&t.events[w][1].type==="chunkFlow"){S=t.events[w][1].end;break}x(r);let E=C;for(;E<t.events.length;)t.events[E][1].end={...S},E++;return gs(t.events,w+1,0,t.events.slice(C)),t.events.length=E,u(v)}return i(v)}function u(v){if(r===n.length){if(!s)return p(v);if(s.currentConstruct&&s.currentConstruct.concrete)return g(v);t.interrupt=!!(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(mA,d,m)(v)}function d(v){return s&&_(),x(r),p(v)}function m(v){return t.parser.lazy[t.now().line]=r!==n.length,o=t.now().offset,g(v)}function p(v){return t.containerState={},e.attempt(mA,h,g)(v)}function h(v){return r++,n.push([t.currentConstruct,t.containerState]),p(v)}function g(v){if(v===null){s&&_(),x(0),e.consume(v);return}return s=s||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:s,contentType:"flow",previous:a}),y(v)}function y(v){if(v===null){b(e.exit("chunkFlow"),!0),x(0),e.consume(v);return}return Xe(v)?(e.consume(v),b(e.exit("chunkFlow")),r=0,t.interrupt=void 0,i):(e.consume(v),y)}function b(v,C){const w=t.sliceStream(v);if(C&&w.push(null),v.previous=a,a&&(a.next=v),a=v,s.defineSkip(v.start),s.write(w),t.parser.lazy[v.start.line]){let S=s.events.length;for(;S--;)if(s.events[S][1].start.offset<o&&(!s.events[S][1].end||s.events[S][1].end.offset>o))return;const E=t.events.length;let T=E,k,M;for(;T--;)if(t.events[T][0]==="exit"&&t.events[T][1].type==="chunkFlow"){if(k){M=t.events[T][1].end;break}k=!0}for(x(r),S=E;S<t.events.length;)t.events[S][1].end={...M},S++;gs(t.events,T+1,0,t.events.slice(E)),t.events.length=S}}function x(v){let C=n.length;for(;C-- >v;){const w=n[C];t.containerState=w[1],w[0].exit.call(t,e)}n.length=v}function _(){s.write([null]),a=void 0,s=void 0,t.containerState._closeFlow=void 0}}function S3e(e,t,n){return Nt(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function su(e){if(e===null||bn(e)||vl(e))return 1;if(Ny(e))return 2}function Ry(e,t,n){const r=[];let s=-1;for(;++s<e.length;){const a=e[s].resolveAll;a&&!r.includes(a)&&(t=a(t,n),r.push(a))}return t}const rv={name:"attention",resolveAll:E3e,tokenize:k3e};function E3e(e,t){let n=-1,r,s,a,o,i,c,u,d;for(;++n<e.length;)if(e[n][0]==="enter"&&e[n][1].type==="attentionSequence"&&e[n][1]._close){for(r=n;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&t.sliceSerialize(e[r][1]).charCodeAt(0)===t.sliceSerialize(e[n][1]).charCodeAt(0)){if((e[r][1]._close||e[n][1]._open)&&(e[n][1].end.offset-e[n][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[n][1].end.offset-e[n][1].start.offset)%3))continue;c=e[r][1].end.offset-e[r][1].start.offset>1&&e[n][1].end.offset-e[n][1].start.offset>1?2:1;const m={...e[r][1].end},p={...e[n][1].start};pA(m,-c),pA(p,c),o={type:c>1?"strongSequence":"emphasisSequence",start:m,end:{...e[r][1].end}},i={type:c>1?"strongSequence":"emphasisSequence",start:{...e[n][1].start},end:p},a={type:c>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[n][1].start}},s={type:c>1?"strong":"emphasis",start:{...o.start},end:{...i.end}},e[r][1].end={...o.start},e[n][1].start={...i.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=Ns(u,[["enter",e[r][1],t],["exit",e[r][1],t]])),u=Ns(u,[["enter",s,t],["enter",o,t],["exit",o,t],["enter",a,t]]),u=Ns(u,Ry(t.parser.constructs.insideSpan.null,e.slice(r+1,n),t)),u=Ns(u,[["exit",a,t],["enter",i,t],["exit",i,t],["exit",s,t]]),e[n][1].end.offset-e[n][1].start.offset?(d=2,u=Ns(u,[["enter",e[n][1],t],["exit",e[n][1],t]])):d=0,gs(e,r-1,n-r+3,u),n=r+u.length-d-2;break}}for(n=-1;++n<e.length;)e[n][1].type==="attentionSequence"&&(e[n][1].type="data");return e}function k3e(e,t){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,s=su(r);let a;return o;function o(c){return a=c,e.enter("attentionSequence"),i(c)}function i(c){if(c===a)return e.consume(c),i;const u=e.exit("attentionSequence"),d=su(c),m=!d||d===2&&s||n.includes(c),p=!s||s===2&&d||n.includes(r);return u._open=!!(a===42?m:m&&(s||!p)),u._close=!!(a===42?p:p&&(d||!m)),t(c)}}function pA(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const M3e={name:"autolink",tokenize:T3e};function T3e(e,t,n){let r=0;return s;function s(h){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(h),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),a}function a(h){return Pr(h)?(e.consume(h),o):h===64?n(h):u(h)}function o(h){return h===43||h===45||h===46||Mr(h)?(r=1,i(h)):u(h)}function i(h){return h===58?(e.consume(h),r=0,c):(h===43||h===45||h===46||Mr(h))&&r++<32?(e.consume(h),i):(r=0,u(h))}function c(h){return h===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(h),e.exit("autolinkMarker"),e.exit("autolink"),t):h===null||h===32||h===60||yg(h)?n(h):(e.consume(h),c)}function u(h){return h===64?(e.consume(h),d):y3e(h)?(e.consume(h),u):n(h)}function d(h){return Mr(h)?m(h):n(h)}function m(h){return h===46?(e.consume(h),r=0,d):h===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(h),e.exit("autolinkMarker"),e.exit("autolink"),t):p(h)}function p(h){if((h===45||Mr(h))&&r++<63){const g=h===45?p:m;return e.consume(h),g}return n(h)}}const Mm={partial:!0,tokenize:A3e};function A3e(e,t,n){return r;function r(a){return Ot(a)?Nt(e,s,"linePrefix")(a):s(a)}function s(a){return a===null||Xe(a)?t(a):n(a)}}const pB={continuation:{tokenize:R3e},exit:D3e,name:"blockQuote",tokenize:N3e};function N3e(e,t,n){const r=this;return s;function s(o){if(o===62){const i=r.containerState;return i.open||(e.enter("blockQuote",{_container:!0}),i.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(o),e.exit("blockQuoteMarker"),a}return n(o)}function a(o){return Ot(o)?(e.enter("blockQuotePrefixWhitespace"),e.consume(o),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(o))}}function R3e(e,t,n){const r=this;return s;function s(o){return Ot(o)?Nt(e,a,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):a(o)}function a(o){return e.attempt(pB,t,n)(o)}}function D3e(e){e.exit("blockQuote")}const hB={name:"characterEscape",tokenize:I3e};function I3e(e,t,n){return r;function r(a){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(a),e.exit("escapeMarker"),s}function s(a){return b3e(a)?(e.enter("characterEscapeValue"),e.consume(a),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(a)}}const gB={name:"characterReference",tokenize:j3e};function j3e(e,t,n){const r=this;let s=0,a,o;return i;function i(m){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(m),e.exit("characterReferenceMarker"),c}function c(m){return m===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(m),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),a=31,o=Mr,d(m))}function u(m){return m===88||m===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(m),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),a=6,o=x3e,d):(e.enter("characterReferenceValue"),a=7,o=nv,d(m))}function d(m){if(m===59&&s){const p=e.exit("characterReferenceValue");return o===Mr&&!d3(r.sliceSerialize(p))?n(m):(e.enter("characterReferenceMarker"),e.consume(m),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return o(m)&&s++<a?(e.consume(m),d):n(m)}}const hA={partial:!0,tokenize:O3e},gA={concrete:!0,name:"codeFenced",tokenize:P3e};function P3e(e,t,n){const r=this,s={partial:!0,tokenize:w};let a=0,o=0,i;return c;function c(S){return u(S)}function u(S){const E=r.events[r.events.length-1];return a=E&&E[1].type==="linePrefix"?E[2].sliceSerialize(E[1],!0).length:0,i=S,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),d(S)}function d(S){return S===i?(o++,e.consume(S),d):o<3?n(S):(e.exit("codeFencedFenceSequence"),Ot(S)?Nt(e,m,"whitespace")(S):m(S))}function m(S){return S===null||Xe(S)?(e.exit("codeFencedFence"),r.interrupt?t(S):e.check(hA,y,C)(S)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),p(S))}function p(S){return S===null||Xe(S)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),m(S)):Ot(S)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Nt(e,h,"whitespace")(S)):S===96&&S===i?n(S):(e.consume(S),p)}function h(S){return S===null||Xe(S)?m(S):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),g(S))}function g(S){return S===null||Xe(S)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),m(S)):S===96&&S===i?n(S):(e.consume(S),g)}function y(S){return e.attempt(s,C,b)(S)}function b(S){return e.enter("lineEnding"),e.consume(S),e.exit("lineEnding"),x}function x(S){return a>0&&Ot(S)?Nt(e,_,"linePrefix",a+1)(S):_(S)}function _(S){return S===null||Xe(S)?e.check(hA,y,C)(S):(e.enter("codeFlowValue"),v(S))}function v(S){return S===null||Xe(S)?(e.exit("codeFlowValue"),_(S)):(e.consume(S),v)}function C(S){return e.exit("codeFenced"),t(S)}function w(S,E,T){let k=0;return M;function M(H){return S.enter("lineEnding"),S.consume(H),S.exit("lineEnding"),N}function N(H){return S.enter("codeFencedFence"),Ot(H)?Nt(S,P,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(H):P(H)}function P(H){return H===i?(S.enter("codeFencedFenceSequence"),O(H)):T(H)}function O(H){return H===i?(k++,S.consume(H),O):k>=o?(S.exit("codeFencedFenceSequence"),Ot(H)?Nt(S,L,"whitespace")(H):L(H)):T(H)}function L(H){return H===null||Xe(H)?(S.exit("codeFencedFence"),E(H)):T(H)}}}function O3e(e,t,n){const r=this;return s;function s(o){return o===null?n(o):(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a)}function a(o){return r.parser.lazy[r.now().line]?n(o):t(o)}}const P1={name:"codeIndented",tokenize:F3e},L3e={partial:!0,tokenize:U3e};function F3e(e,t,n){const r=this;return s;function s(u){return e.enter("codeIndented"),Nt(e,a,"linePrefix",5)(u)}function a(u){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?o(u):n(u)}function o(u){return u===null?c(u):Xe(u)?e.attempt(L3e,o,c)(u):(e.enter("codeFlowValue"),i(u))}function i(u){return u===null||Xe(u)?(e.exit("codeFlowValue"),o(u)):(e.consume(u),i)}function c(u){return e.exit("codeIndented"),t(u)}}function U3e(e,t,n){const r=this;return s;function s(o){return r.parser.lazy[r.now().line]?n(o):Xe(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),s):Nt(e,a,"linePrefix",5)(o)}function a(o){const i=r.events[r.events.length-1];return i&&i[1].type==="linePrefix"&&i[2].sliceSerialize(i[1],!0).length>=4?t(o):Xe(o)?s(o):n(o)}}const B3e={name:"codeText",previous:V3e,resolve:H3e,tokenize:G3e};function H3e(e){let t=e.length-4,n=3,r,s;if((e[n][1].type==="lineEnding"||e[n][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(r=n;++r<t;)if(e[r][1].type==="codeTextData"){e[n][1].type="codeTextPadding",e[t][1].type="codeTextPadding",n+=2,t-=2;break}}for(r=n-1,t++;++r<=t;)s===void 0?r!==t&&e[r][1].type!=="lineEnding"&&(s=r):(r===t||e[r][1].type==="lineEnding")&&(e[s][1].type="codeTextData",r!==s+2&&(e[s][1].end=e[r-1][1].end,e.splice(s+2,r-s-2),t-=r-s-2,r=s+2),s=void 0);return e}function V3e(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function G3e(e,t,n){let r=0,s,a;return o;function o(m){return e.enter("codeText"),e.enter("codeTextSequence"),i(m)}function i(m){return m===96?(e.consume(m),r++,i):(e.exit("codeTextSequence"),c(m))}function c(m){return m===null?n(m):m===32?(e.enter("space"),e.consume(m),e.exit("space"),c):m===96?(a=e.enter("codeTextSequence"),s=0,d(m)):Xe(m)?(e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),c):(e.enter("codeTextData"),u(m))}function u(m){return m===null||m===32||m===96||Xe(m)?(e.exit("codeTextData"),c(m)):(e.consume(m),u)}function d(m){return m===96?(e.consume(m),s++,d):s===r?(e.exit("codeTextSequence"),e.exit("codeText"),t(m)):(a.type="codeTextData",u(m))}}class z3e{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,n){const r=n??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(t,r):t>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(t,n,r){const s=n||0;this.setCursor(Math.trunc(t));const a=this.right.splice(this.right.length-s,Number.POSITIVE_INFINITY);return r&&yd(this.left,r),a.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),yd(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),yd(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const n=this.left.splice(t,Number.POSITIVE_INFINITY);yd(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);yd(this.left,n.reverse())}}}function yd(e,t){let n=0;if(t.length<1e4)e.push(...t);else for(;n<t.length;)e.push(...t.slice(n,n+1e4)),n+=1e4}function yB(e){const t={};let n=-1,r,s,a,o,i,c,u;const d=new z3e(e);for(;++n<d.length;){for(;n in t;)n=t[n];if(r=d.get(n),n&&r[1].type==="chunkFlow"&&d.get(n-1)[1].type==="listItemPrefix"&&(c=r[1]._tokenizer.events,a=0,a<c.length&&c[a][1].type==="lineEndingBlank"&&(a+=2),a<c.length&&c[a][1].type==="content"))for(;++a<c.length&&c[a][1].type!=="content";)c[a][1].type==="chunkText"&&(c[a][1]._isInFirstContentOfListItem=!0,a++);if(r[0]==="enter")r[1].contentType&&(Object.assign(t,q3e(d,n)),n=t[n],u=!0);else if(r[1]._container){for(a=n,s=void 0;a--;)if(o=d.get(a),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(s&&(d.get(s)[1].type="lineEndingBlank"),o[1].type="lineEnding",s=a);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;s&&(r[1].end={...d.get(s)[1].start},i=d.slice(s,n),i.unshift(r),d.splice(s,n-s+1,i))}}return gs(e,0,Number.POSITIVE_INFINITY,d.slice(0)),!u}function q3e(e,t){const n=e.get(t)[1],r=e.get(t)[2];let s=t-1;const a=[];let o=n._tokenizer;o||(o=r.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const i=o.events,c=[],u={};let d,m,p=-1,h=n,g=0,y=0;const b=[y];for(;h;){for(;e.get(++s)[1]!==h;);a.push(s),h._tokenizer||(d=r.sliceStream(h),h.next||d.push(null),m&&o.defineSkip(h.start),h._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(d),h._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),m=h,h=h.next}for(h=n;++p<i.length;)i[p][0]==="exit"&&i[p-1][0]==="enter"&&i[p][1].type===i[p-1][1].type&&i[p][1].start.line!==i[p][1].end.line&&(y=p+1,b.push(y),h._tokenizer=void 0,h.previous=void 0,h=h.next);for(o.events=[],h?(h._tokenizer=void 0,h.previous=void 0):b.pop(),p=b.length;p--;){const x=i.slice(b[p],b[p+1]),_=a.pop();c.push([_,_+x.length-1]),e.splice(_,2,x)}for(c.reverse(),p=-1;++p<c.length;)u[g+c[p][0]]=g+c[p][1],g+=c[p][1]-c[p][0]-1;return u}const $3e={resolve:K3e,tokenize:Y3e},W3e={partial:!0,tokenize:Q3e};function K3e(e){return yB(e),e}function Y3e(e,t){let n;return r;function r(i){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),s(i)}function s(i){return i===null?a(i):Xe(i)?e.check(W3e,o,a)(i):(e.consume(i),s)}function a(i){return e.exit("chunkContent"),e.exit("content"),t(i)}function o(i){return e.consume(i),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,s}}function Q3e(e,t,n){const r=this;return s;function s(o){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),Nt(e,a,"linePrefix")}function a(o){if(o===null||Xe(o))return n(o);const i=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&i&&i[1].type==="linePrefix"&&i[2].sliceSerialize(i[1],!0).length>=4?t(o):e.interrupt(r.parser.constructs.flow,n,t)(o)}}function xB(e,t,n,r,s,a,o,i,c){const u=c||Number.POSITIVE_INFINITY;let d=0;return m;function m(x){return x===60?(e.enter(r),e.enter(s),e.enter(a),e.consume(x),e.exit(a),p):x===null||x===32||x===41||yg(x)?n(x):(e.enter(r),e.enter(o),e.enter(i),e.enter("chunkString",{contentType:"string"}),y(x))}function p(x){return x===62?(e.enter(a),e.consume(x),e.exit(a),e.exit(s),e.exit(r),t):(e.enter(i),e.enter("chunkString",{contentType:"string"}),h(x))}function h(x){return x===62?(e.exit("chunkString"),e.exit(i),p(x)):x===null||x===60||Xe(x)?n(x):(e.consume(x),x===92?g:h)}function g(x){return x===60||x===62||x===92?(e.consume(x),h):h(x)}function y(x){return!d&&(x===null||x===41||bn(x))?(e.exit("chunkString"),e.exit(i),e.exit(o),e.exit(r),t(x)):d<u&&x===40?(e.consume(x),d++,y):x===41?(e.consume(x),d--,y):x===null||x===32||x===40||yg(x)?n(x):(e.consume(x),x===92?b:y)}function b(x){return x===40||x===41||x===92?(e.consume(x),y):y(x)}}function bB(e,t,n,r,s,a){const o=this;let i=0,c;return u;function u(h){return e.enter(r),e.enter(s),e.consume(h),e.exit(s),e.enter(a),d}function d(h){return i>999||h===null||h===91||h===93&&!c||h===94&&!i&&"_hiddenFootnoteSupport"in o.parser.constructs?n(h):h===93?(e.exit(a),e.enter(s),e.consume(h),e.exit(s),e.exit(r),t):Xe(h)?(e.enter("lineEnding"),e.consume(h),e.exit("lineEnding"),d):(e.enter("chunkString",{contentType:"string"}),m(h))}function m(h){return h===null||h===91||h===93||Xe(h)||i++>999?(e.exit("chunkString"),d(h)):(e.consume(h),c||(c=!Ot(h)),h===92?p:m)}function p(h){return h===91||h===92||h===93?(e.consume(h),i++,m):m(h)}}function _B(e,t,n,r,s,a){let o;return i;function i(p){return p===34||p===39||p===40?(e.enter(r),e.enter(s),e.consume(p),e.exit(s),o=p===40?41:p,c):n(p)}function c(p){return p===o?(e.enter(s),e.consume(p),e.exit(s),e.exit(r),t):(e.enter(a),u(p))}function u(p){return p===o?(e.exit(a),c(o)):p===null?n(p):Xe(p)?(e.enter("lineEnding"),e.consume(p),e.exit("lineEnding"),Nt(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),d(p))}function d(p){return p===o||p===null||Xe(p)?(e.exit("chunkString"),u(p)):(e.consume(p),p===92?m:d)}function m(p){return p===o||p===92?(e.consume(p),d):d(p)}}function Xd(e,t){let n;return r;function r(s){return Xe(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),n=!0,r):Ot(s)?Nt(e,r,n?"linePrefix":"lineSuffix")(s):t(s)}}const X3e={name:"definition",tokenize:J3e},Z3e={partial:!0,tokenize:e5e};function J3e(e,t,n){const r=this;let s;return a;function a(h){return e.enter("definition"),o(h)}function o(h){return bB.call(r,e,i,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(h)}function i(h){return s=ua(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),h===58?(e.enter("definitionMarker"),e.consume(h),e.exit("definitionMarker"),c):n(h)}function c(h){return bn(h)?Xd(e,u)(h):u(h)}function u(h){return xB(e,d,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(h)}function d(h){return e.attempt(Z3e,m,m)(h)}function m(h){return Ot(h)?Nt(e,p,"whitespace")(h):p(h)}function p(h){return h===null||Xe(h)?(e.exit("definition"),r.parser.defined.push(s),t(h)):n(h)}}function e5e(e,t,n){return r;function r(i){return bn(i)?Xd(e,s)(i):n(i)}function s(i){return _B(e,a,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(i)}function a(i){return Ot(i)?Nt(e,o,"whitespace")(i):o(i)}function o(i){return i===null||Xe(i)?t(i):n(i)}}const t5e={name:"hardBreakEscape",tokenize:n5e};function n5e(e,t,n){return r;function r(a){return e.enter("hardBreakEscape"),e.consume(a),s}function s(a){return Xe(a)?(e.exit("hardBreakEscape"),t(a)):n(a)}}const r5e={name:"headingAtx",resolve:s5e,tokenize:a5e};function s5e(e,t){let n=e.length-2,r=3,s,a;return e[r][1].type==="whitespace"&&(r+=2),n-2>r&&e[n][1].type==="whitespace"&&(n-=2),e[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&e[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(s={type:"atxHeadingText",start:e[r][1].start,end:e[n][1].end},a={type:"chunkText",start:e[r][1].start,end:e[n][1].end,contentType:"text"},gs(e,r,n-r+1,[["enter",s,t],["enter",a,t],["exit",a,t],["exit",s,t]])),e}function a5e(e,t,n){let r=0;return s;function s(d){return e.enter("atxHeading"),a(d)}function a(d){return e.enter("atxHeadingSequence"),o(d)}function o(d){return d===35&&r++<6?(e.consume(d),o):d===null||bn(d)?(e.exit("atxHeadingSequence"),i(d)):n(d)}function i(d){return d===35?(e.enter("atxHeadingSequence"),c(d)):d===null||Xe(d)?(e.exit("atxHeading"),t(d)):Ot(d)?Nt(e,i,"whitespace")(d):(e.enter("atxHeadingText"),u(d))}function c(d){return d===35?(e.consume(d),c):(e.exit("atxHeadingSequence"),i(d))}function u(d){return d===null||d===35||bn(d)?(e.exit("atxHeadingText"),i(d)):(e.consume(d),u)}}const o5e=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],yA=["pre","script","style","textarea"],i5e={concrete:!0,name:"htmlFlow",resolveTo:u5e,tokenize:d5e},l5e={partial:!0,tokenize:m5e},c5e={partial:!0,tokenize:f5e};function u5e(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function d5e(e,t,n){const r=this;let s,a,o,i,c;return u;function u(U){return d(U)}function d(U){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(U),m}function m(U){return U===33?(e.consume(U),p):U===47?(e.consume(U),a=!0,y):U===63?(e.consume(U),s=3,r.interrupt?t:j):Pr(U)?(e.consume(U),o=String.fromCharCode(U),b):n(U)}function p(U){return U===45?(e.consume(U),s=2,h):U===91?(e.consume(U),s=5,i=0,g):Pr(U)?(e.consume(U),s=4,r.interrupt?t:j):n(U)}function h(U){return U===45?(e.consume(U),r.interrupt?t:j):n(U)}function g(U){const X="CDATA[";return U===X.charCodeAt(i++)?(e.consume(U),i===X.length?r.interrupt?t:P:g):n(U)}function y(U){return Pr(U)?(e.consume(U),o=String.fromCharCode(U),b):n(U)}function b(U){if(U===null||U===47||U===62||bn(U)){const X=U===47,J=o.toLowerCase();return!X&&!a&&yA.includes(J)?(s=1,r.interrupt?t(U):P(U)):o5e.includes(o.toLowerCase())?(s=6,X?(e.consume(U),x):r.interrupt?t(U):P(U)):(s=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(U):a?_(U):v(U))}return U===45||Mr(U)?(e.consume(U),o+=String.fromCharCode(U),b):n(U)}function x(U){return U===62?(e.consume(U),r.interrupt?t:P):n(U)}function _(U){return Ot(U)?(e.consume(U),_):M(U)}function v(U){return U===47?(e.consume(U),M):U===58||U===95||Pr(U)?(e.consume(U),C):Ot(U)?(e.consume(U),v):M(U)}function C(U){return U===45||U===46||U===58||U===95||Mr(U)?(e.consume(U),C):w(U)}function w(U){return U===61?(e.consume(U),S):Ot(U)?(e.consume(U),w):v(U)}function S(U){return U===null||U===60||U===61||U===62||U===96?n(U):U===34||U===39?(e.consume(U),c=U,E):Ot(U)?(e.consume(U),S):T(U)}function E(U){return U===c?(e.consume(U),c=null,k):U===null||Xe(U)?n(U):(e.consume(U),E)}function T(U){return U===null||U===34||U===39||U===47||U===60||U===61||U===62||U===96||bn(U)?w(U):(e.consume(U),T)}function k(U){return U===47||U===62||Ot(U)?v(U):n(U)}function M(U){return U===62?(e.consume(U),N):n(U)}function N(U){return U===null||Xe(U)?P(U):Ot(U)?(e.consume(U),N):n(U)}function P(U){return U===45&&s===2?(e.consume(U),R):U===60&&s===1?(e.consume(U),I):U===62&&s===4?(e.consume(U),$):U===63&&s===3?(e.consume(U),j):U===93&&s===5?(e.consume(U),G):Xe(U)&&(s===6||s===7)?(e.exit("htmlFlowData"),e.check(l5e,q,O)(U)):U===null||Xe(U)?(e.exit("htmlFlowData"),O(U)):(e.consume(U),P)}function O(U){return e.check(c5e,L,q)(U)}function L(U){return e.enter("lineEnding"),e.consume(U),e.exit("lineEnding"),H}function H(U){return U===null||Xe(U)?O(U):(e.enter("htmlFlowData"),P(U))}function R(U){return U===45?(e.consume(U),j):P(U)}function I(U){return U===47?(e.consume(U),o="",F):P(U)}function F(U){if(U===62){const X=o.toLowerCase();return yA.includes(X)?(e.consume(U),$):P(U)}return Pr(U)&&o.length<8?(e.consume(U),o+=String.fromCharCode(U),F):P(U)}function G(U){return U===93?(e.consume(U),j):P(U)}function j(U){return U===62?(e.consume(U),$):U===45&&s===2?(e.consume(U),j):P(U)}function $(U){return U===null||Xe(U)?(e.exit("htmlFlowData"),q(U)):(e.consume(U),$)}function q(U){return e.exit("htmlFlow"),t(U)}}function f5e(e,t,n){const r=this;return s;function s(o){return Xe(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a):n(o)}function a(o){return r.parser.lazy[r.now().line]?n(o):t(o)}}function m5e(e,t,n){return r;function r(s){return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),e.attempt(Mm,t,n)}}const p5e={name:"htmlText",tokenize:h5e};function h5e(e,t,n){const r=this;let s,a,o;return i;function i(j){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(j),c}function c(j){return j===33?(e.consume(j),u):j===47?(e.consume(j),w):j===63?(e.consume(j),v):Pr(j)?(e.consume(j),T):n(j)}function u(j){return j===45?(e.consume(j),d):j===91?(e.consume(j),a=0,g):Pr(j)?(e.consume(j),_):n(j)}function d(j){return j===45?(e.consume(j),h):n(j)}function m(j){return j===null?n(j):j===45?(e.consume(j),p):Xe(j)?(o=m,I(j)):(e.consume(j),m)}function p(j){return j===45?(e.consume(j),h):m(j)}function h(j){return j===62?R(j):j===45?p(j):m(j)}function g(j){const $="CDATA[";return j===$.charCodeAt(a++)?(e.consume(j),a===$.length?y:g):n(j)}function y(j){return j===null?n(j):j===93?(e.consume(j),b):Xe(j)?(o=y,I(j)):(e.consume(j),y)}function b(j){return j===93?(e.consume(j),x):y(j)}function x(j){return j===62?R(j):j===93?(e.consume(j),x):y(j)}function _(j){return j===null||j===62?R(j):Xe(j)?(o=_,I(j)):(e.consume(j),_)}function v(j){return j===null?n(j):j===63?(e.consume(j),C):Xe(j)?(o=v,I(j)):(e.consume(j),v)}function C(j){return j===62?R(j):v(j)}function w(j){return Pr(j)?(e.consume(j),S):n(j)}function S(j){return j===45||Mr(j)?(e.consume(j),S):E(j)}function E(j){return Xe(j)?(o=E,I(j)):Ot(j)?(e.consume(j),E):R(j)}function T(j){return j===45||Mr(j)?(e.consume(j),T):j===47||j===62||bn(j)?k(j):n(j)}function k(j){return j===47?(e.consume(j),R):j===58||j===95||Pr(j)?(e.consume(j),M):Xe(j)?(o=k,I(j)):Ot(j)?(e.consume(j),k):R(j)}function M(j){return j===45||j===46||j===58||j===95||Mr(j)?(e.consume(j),M):N(j)}function N(j){return j===61?(e.consume(j),P):Xe(j)?(o=N,I(j)):Ot(j)?(e.consume(j),N):k(j)}function P(j){return j===null||j===60||j===61||j===62||j===96?n(j):j===34||j===39?(e.consume(j),s=j,O):Xe(j)?(o=P,I(j)):Ot(j)?(e.consume(j),P):(e.consume(j),L)}function O(j){return j===s?(e.consume(j),s=void 0,H):j===null?n(j):Xe(j)?(o=O,I(j)):(e.consume(j),O)}function L(j){return j===null||j===34||j===39||j===60||j===61||j===96?n(j):j===47||j===62||bn(j)?k(j):(e.consume(j),L)}function H(j){return j===47||j===62||bn(j)?k(j):n(j)}function R(j){return j===62?(e.consume(j),e.exit("htmlTextData"),e.exit("htmlText"),t):n(j)}function I(j){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(j),e.exit("lineEnding"),F}function F(j){return Ot(j)?Nt(e,G,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(j):G(j)}function G(j){return e.enter("htmlTextData"),o(j)}}const f3={name:"labelEnd",resolveAll:b5e,resolveTo:_5e,tokenize:v5e},g5e={tokenize:C5e},y5e={tokenize:w5e},x5e={tokenize:S5e};function b5e(e){let t=-1;const n=[];for(;++t<e.length;){const r=e[t][1];if(n.push(e[t]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const s=r.type==="labelImage"?4:2;r.type="data",t+=s}}return e.length!==n.length&&gs(e,0,e.length,n),e}function _5e(e,t){let n=e.length,r=0,s,a,o,i;for(;n--;)if(s=e[n][1],a){if(s.type==="link"||s.type==="labelLink"&&s._inactive)break;e[n][0]==="enter"&&s.type==="labelLink"&&(s._inactive=!0)}else if(o){if(e[n][0]==="enter"&&(s.type==="labelImage"||s.type==="labelLink")&&!s._balanced&&(a=n,s.type!=="labelLink")){r=2;break}}else s.type==="labelEnd"&&(o=n);const c={type:e[a][1].type==="labelLink"?"link":"image",start:{...e[a][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[a][1].start},end:{...e[o][1].end}},d={type:"labelText",start:{...e[a+r+2][1].end},end:{...e[o-2][1].start}};return i=[["enter",c,t],["enter",u,t]],i=Ns(i,e.slice(a+1,a+r+3)),i=Ns(i,[["enter",d,t]]),i=Ns(i,Ry(t.parser.constructs.insideSpan.null,e.slice(a+r+4,o-3),t)),i=Ns(i,[["exit",d,t],e[o-2],e[o-1],["exit",u,t]]),i=Ns(i,e.slice(o+1)),i=Ns(i,[["exit",c,t]]),gs(e,a,e.length,i),e}function v5e(e,t,n){const r=this;let s=r.events.length,a,o;for(;s--;)if((r.events[s][1].type==="labelImage"||r.events[s][1].type==="labelLink")&&!r.events[s][1]._balanced){a=r.events[s][1];break}return i;function i(p){return a?a._inactive?m(p):(o=r.parser.defined.includes(ua(r.sliceSerialize({start:a.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(p),e.exit("labelMarker"),e.exit("labelEnd"),c):n(p)}function c(p){return p===40?e.attempt(g5e,d,o?d:m)(p):p===91?e.attempt(y5e,d,o?u:m)(p):o?d(p):m(p)}function u(p){return e.attempt(x5e,d,m)(p)}function d(p){return t(p)}function m(p){return a._balanced=!0,n(p)}}function C5e(e,t,n){return r;function r(m){return e.enter("resource"),e.enter("resourceMarker"),e.consume(m),e.exit("resourceMarker"),s}function s(m){return bn(m)?Xd(e,a)(m):a(m)}function a(m){return m===41?d(m):xB(e,o,i,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(m)}function o(m){return bn(m)?Xd(e,c)(m):d(m)}function i(m){return n(m)}function c(m){return m===34||m===39||m===40?_B(e,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(m):d(m)}function u(m){return bn(m)?Xd(e,d)(m):d(m)}function d(m){return m===41?(e.enter("resourceMarker"),e.consume(m),e.exit("resourceMarker"),e.exit("resource"),t):n(m)}}function w5e(e,t,n){const r=this;return s;function s(i){return bB.call(r,e,a,o,"reference","referenceMarker","referenceString")(i)}function a(i){return r.parser.defined.includes(ua(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(i):n(i)}function o(i){return n(i)}}function S5e(e,t,n){return r;function r(a){return e.enter("reference"),e.enter("referenceMarker"),e.consume(a),e.exit("referenceMarker"),s}function s(a){return a===93?(e.enter("referenceMarker"),e.consume(a),e.exit("referenceMarker"),e.exit("reference"),t):n(a)}}const E5e={name:"labelStartImage",resolveAll:f3.resolveAll,tokenize:k5e};function k5e(e,t,n){const r=this;return s;function s(i){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(i),e.exit("labelImageMarker"),a}function a(i){return i===91?(e.enter("labelMarker"),e.consume(i),e.exit("labelMarker"),e.exit("labelImage"),o):n(i)}function o(i){return i===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(i):t(i)}}const M5e={name:"labelStartLink",resolveAll:f3.resolveAll,tokenize:T5e};function T5e(e,t,n){const r=this;return s;function s(o){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelLink"),a}function a(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(o):t(o)}}const O1={name:"lineEnding",tokenize:A5e};function A5e(e,t){return n;function n(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),Nt(e,t,"linePrefix")}}const kh={name:"thematicBreak",tokenize:N5e};function N5e(e,t,n){let r=0,s;return a;function a(u){return e.enter("thematicBreak"),o(u)}function o(u){return s=u,i(u)}function i(u){return u===s?(e.enter("thematicBreakSequence"),c(u)):r>=3&&(u===null||Xe(u))?(e.exit("thematicBreak"),t(u)):n(u)}function c(u){return u===s?(e.consume(u),r++,c):(e.exit("thematicBreakSequence"),Ot(u)?Nt(e,i,"whitespace")(u):i(u))}}const Gr={continuation:{tokenize:j5e},exit:O5e,name:"list",tokenize:I5e},R5e={partial:!0,tokenize:L5e},D5e={partial:!0,tokenize:P5e};function I5e(e,t,n){const r=this,s=r.events[r.events.length-1];let a=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0,o=0;return i;function i(h){const g=r.containerState.type||(h===42||h===43||h===45?"listUnordered":"listOrdered");if(g==="listUnordered"?!r.containerState.marker||h===r.containerState.marker:nv(h)){if(r.containerState.type||(r.containerState.type=g,e.enter(g,{_container:!0})),g==="listUnordered")return e.enter("listItemPrefix"),h===42||h===45?e.check(kh,n,u)(h):u(h);if(!r.interrupt||h===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),c(h)}return n(h)}function c(h){return nv(h)&&++o<10?(e.consume(h),c):(!r.interrupt||o<2)&&(r.containerState.marker?h===r.containerState.marker:h===41||h===46)?(e.exit("listItemValue"),u(h)):n(h)}function u(h){return e.enter("listItemMarker"),e.consume(h),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||h,e.check(Mm,r.interrupt?n:d,e.attempt(R5e,p,m))}function d(h){return r.containerState.initialBlankLine=!0,a++,p(h)}function m(h){return Ot(h)?(e.enter("listItemPrefixWhitespace"),e.consume(h),e.exit("listItemPrefixWhitespace"),p):n(h)}function p(h){return r.containerState.size=a+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(h)}}function j5e(e,t,n){const r=this;return r.containerState._closeFlow=void 0,e.check(Mm,s,a);function s(i){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Nt(e,t,"listItemIndent",r.containerState.size+1)(i)}function a(i){return r.containerState.furtherBlankLines||!Ot(i)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(i)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(D5e,t,o)(i))}function o(i){return r.containerState._closeFlow=!0,r.interrupt=void 0,Nt(e,e.attempt(Gr,t,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(i)}}function P5e(e,t,n){const r=this;return Nt(e,s,"listItemIndent",r.containerState.size+1);function s(a){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?t(a):n(a)}}function O5e(e){e.exit(this.containerState.type)}function L5e(e,t,n){const r=this;return Nt(e,s,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function s(a){const o=r.events[r.events.length-1];return!Ot(a)&&o&&o[1].type==="listItemPrefixWhitespace"?t(a):n(a)}}const xA={name:"setextUnderline",resolveTo:F5e,tokenize:U5e};function F5e(e,t){let n=e.length,r,s,a;for(;n--;)if(e[n][0]==="enter"){if(e[n][1].type==="content"){r=n;break}e[n][1].type==="paragraph"&&(s=n)}else e[n][1].type==="content"&&e.splice(n,1),!a&&e[n][1].type==="definition"&&(a=n);const o={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[s][1].type="setextHeadingText",a?(e.splice(s,0,["enter",o,t]),e.splice(a+1,0,["exit",e[r][1],t]),e[r][1].end={...e[a][1].end}):e[r][1]=o,e.push(["exit",o,t]),e}function U5e(e,t,n){const r=this;let s;return a;function a(u){let d=r.events.length,m;for(;d--;)if(r.events[d][1].type!=="lineEnding"&&r.events[d][1].type!=="linePrefix"&&r.events[d][1].type!=="content"){m=r.events[d][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||m)?(e.enter("setextHeadingLine"),s=u,o(u)):n(u)}function o(u){return e.enter("setextHeadingLineSequence"),i(u)}function i(u){return u===s?(e.consume(u),i):(e.exit("setextHeadingLineSequence"),Ot(u)?Nt(e,c,"lineSuffix")(u):c(u))}function c(u){return u===null||Xe(u)?(e.exit("setextHeadingLine"),t(u)):n(u)}}const B5e={tokenize:H5e};function H5e(e){const t=this,n=e.attempt(Mm,r,e.attempt(this.parser.constructs.flowInitial,s,Nt(e,e.attempt(this.parser.constructs.flow,s,e.attempt($3e,s)),"linePrefix")));return n;function r(a){if(a===null){e.consume(a);return}return e.enter("lineEndingBlank"),e.consume(a),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}function s(a){if(a===null){e.consume(a);return}return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t.currentConstruct=void 0,n}}const V5e={resolveAll:CB()},G5e=vB("string"),z5e=vB("text");function vB(e){return{resolveAll:CB(e==="text"?q5e:void 0),tokenize:t};function t(n){const r=this,s=this.parser.constructs[e],a=n.attempt(s,o,i);return o;function o(d){return u(d)?a(d):i(d)}function i(d){if(d===null){n.consume(d);return}return n.enter("data"),n.consume(d),c}function c(d){return u(d)?(n.exit("data"),a(d)):(n.consume(d),c)}function u(d){if(d===null)return!0;const m=s[d];let p=-1;if(m)for(;++p<m.length;){const h=m[p];if(!h.previous||h.previous.call(r,r.previous))return!0}return!1}}}function CB(e){return t;function t(n,r){let s=-1,a;for(;++s<=n.length;)a===void 0?n[s]&&n[s][1].type==="data"&&(a=s,s++):(!n[s]||n[s][1].type!=="data")&&(s!==a+2&&(n[a][1].end=n[s-1][1].end,n.splice(a+2,s-a-2),s=a+2),a=void 0);return e?e(n,r):n}}function q5e(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||e[n][1].type==="lineEnding")&&e[n-1][1].type==="data"){const r=e[n-1][1],s=t.sliceStream(r);let a=s.length,o=-1,i=0,c;for(;a--;){const u=s[a];if(typeof u=="string"){for(o=u.length;u.charCodeAt(o-1)===32;)i++,o--;if(o)break;o=-1}else if(u===-2)c=!0,i++;else if(u!==-1){a++;break}}if(t._contentTypeTextTrailing&&n===e.length&&(i=0),i){const u={type:n===e.length||c||i<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:a?o:r.start._bufferIndex+o,_index:r.start._index+a,line:r.end.line,column:r.end.column-i,offset:r.end.offset-i},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(n,0,["enter",u,t],["exit",u,t]),n+=2)}n++}return e}const $5e={42:Gr,43:Gr,45:Gr,48:Gr,49:Gr,50:Gr,51:Gr,52:Gr,53:Gr,54:Gr,55:Gr,56:Gr,57:Gr,62:pB},W5e={91:X3e},K5e={[-2]:P1,[-1]:P1,32:P1},Y5e={35:r5e,42:kh,45:[xA,kh],60:i5e,61:xA,95:kh,96:gA,126:gA},Q5e={38:gB,92:hB},X5e={[-5]:O1,[-4]:O1,[-3]:O1,33:E5e,38:gB,42:rv,60:[M3e,p5e],91:M5e,92:[t5e,hB],93:f3,95:rv,96:B3e},Z5e={null:[rv,V5e]},J5e={null:[42,95]},eke={null:[]},tke=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:J5e,contentInitial:W5e,disable:eke,document:$5e,flow:Y5e,flowInitial:K5e,insideSpan:Z5e,string:Q5e,text:X5e},Symbol.toStringTag,{value:"Module"}));function nke(e,t,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const s={},a=[];let o=[],i=[];const c={attempt:E(w),check:E(S),consume:_,enter:v,exit:C,interrupt:E(S,{interrupt:!0})},u={code:null,containerState:{},defineSkip:y,events:[],now:g,parser:e,previous:null,sliceSerialize:p,sliceStream:h,write:m};let d=t.tokenize.call(u,c);return t.resolveAll&&a.push(t),u;function m(N){return o=Ns(o,N),b(),o[o.length-1]!==null?[]:(T(t,0),u.events=Ry(a,u.events,u),u.events)}function p(N,P){return ske(h(N),P)}function h(N){return rke(o,N)}function g(){const{_bufferIndex:N,_index:P,line:O,column:L,offset:H}=r;return{_bufferIndex:N,_index:P,line:O,column:L,offset:H}}function y(N){s[N.line]=N.column,M()}function b(){let N;for(;r._index<o.length;){const P=o[r._index];if(typeof P=="string")for(N=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===N&&r._bufferIndex<P.length;)x(P.charCodeAt(r._bufferIndex));else x(P)}}function x(N){d=d(N)}function _(N){Xe(N)?(r.line++,r.column=1,r.offset+=N===-3?2:1,M()):N!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=N}function v(N,P){const O=P||{};return O.type=N,O.start=g(),u.events.push(["enter",O,u]),i.push(O),O}function C(N){const P=i.pop();return P.end=g(),u.events.push(["exit",P,u]),P}function w(N,P){T(N,P.from)}function S(N,P){P.restore()}function E(N,P){return O;function O(L,H,R){let I,F,G,j;return Array.isArray(L)?q(L):"tokenize"in L?q([L]):$(L);function $(ne){return ae;function ae(de){const oe=de!==null&&ne[de],le=de!==null&&ne.null,se=[...Array.isArray(oe)?oe:oe?[oe]:[],...Array.isArray(le)?le:le?[le]:[]];return q(se)(de)}}function q(ne){return I=ne,F=0,ne.length===0?R:U(ne[F])}function U(ne){return ae;function ae(de){return j=k(),G=ne,ne.partial||(u.currentConstruct=ne),ne.name&&u.parser.constructs.disable.null.includes(ne.name)?J():ne.tokenize.call(P?Object.assign(Object.create(u),P):u,c,X,J)(de)}}function X(ne){return N(G,j),H}function J(ne){return j.restore(),++F<I.length?U(I[F]):R}}}function T(N,P){N.resolveAll&&!a.includes(N)&&a.push(N),N.resolve&&gs(u.events,P,u.events.length-P,N.resolve(u.events.slice(P),u)),N.resolveTo&&(u.events=N.resolveTo(u.events,u))}function k(){const N=g(),P=u.previous,O=u.currentConstruct,L=u.events.length,H=Array.from(i);return{from:L,restore:R};function R(){r=N,u.previous=P,u.currentConstruct=O,u.events.length=L,i=H,M()}}function M(){r.line in s&&r.column<2&&(r.column=s[r.line],r.offset+=s[r.line]-1)}}function rke(e,t){const n=t.start._index,r=t.start._bufferIndex,s=t.end._index,a=t.end._bufferIndex;let o;if(n===s)o=[e[n].slice(r,a)];else{if(o=e.slice(n,s),r>-1){const i=o[0];typeof i=="string"?o[0]=i.slice(r):o.shift()}a>0&&o.push(e[s].slice(0,a))}return o}function ske(e,t){let n=-1;const r=[];let s;for(;++n<e.length;){const a=e[n];let o;if(typeof a=="string")o=a;else switch(a){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=t?" ":"	";break}case-1:{if(!t&&s)continue;o=" ";break}default:o=String.fromCharCode(a)}s=a===-2,r.push(o)}return r.join("")}function ake(e){const r={constructs:fB([tke,...(e||{}).extensions||[]]),content:s(_3e),defined:[],document:s(C3e),flow:s(B5e),lazy:{},string:s(G5e),text:s(z5e)};return r;function s(a){return o;function o(i){return nke(r,a,i)}}}function oke(e){for(;!yB(e););return e}const bA=/[\0\t\n\r]/g;function ike(){let e=1,t="",n=!0,r;return s;function s(a,o,i){const c=[];let u,d,m,p,h;for(a=t+(typeof a=="string"?a.toString():new TextDecoder(o||void 0).decode(a)),m=0,t="",n&&(a.charCodeAt(0)===65279&&m++,n=void 0);m<a.length;){if(bA.lastIndex=m,u=bA.exec(a),p=u&&u.index!==void 0?u.index:a.length,h=a.charCodeAt(p),!u){t=a.slice(m);break}if(h===10&&m===p&&r)c.push(-3),r=void 0;else switch(r&&(c.push(-5),r=void 0),m<p&&(c.push(a.slice(m,p)),e+=p-m),h){case 0:{c.push(65533),e++;break}case 9:{for(d=Math.ceil(e/4)*4,c.push(-2);e++<d;)c.push(-1);break}case 10:{c.push(-4),e=1;break}default:r=!0,e=1}m=p+1}return i&&(r&&c.push(-5),t&&c.push(t),c.push(null)),c}}const lke=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function cke(e){return e.replace(lke,uke)}function uke(e,t,n){if(t)return t;if(n.charCodeAt(0)===35){const s=n.charCodeAt(1),a=s===120||s===88;return mB(n.slice(a?2:1),a?16:10)}return d3(n)||e}const wB={}.hasOwnProperty;function dke(e,t,n){return typeof t!="string"&&(n=t,t=void 0),fke(n)(oke(ake(n).document().write(ike()(e,t,!0))))}function fke(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:a(xe),autolinkProtocol:k,autolinkEmail:k,atxHeading:a(ue),blockQuote:a(le),characterEscape:k,characterReference:k,codeFenced:a(se),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:a(se,o),codeText:a(re,o),codeTextData:k,data:k,codeFlowValue:k,definition:a(he),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:a(ie),hardBreakEscape:a(ce),hardBreakTrailing:a(ce),htmlFlow:a(me,o),htmlFlowData:k,htmlText:a(me,o),htmlTextData:k,image:a(pe),label:o,link:a(xe),listItem:a(Te),listItemValue:p,listOrdered:a(Oe,m),listUnordered:a(Oe),paragraph:a(we),reference:U,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:a(ue),strong:a(ke),thematicBreak:a(ot)},exit:{atxHeading:c(),atxHeadingSequence:w,autolink:c(),autolinkEmail:oe,autolinkProtocol:de,blockQuote:c(),characterEscapeValue:M,characterReferenceMarkerHexadecimal:J,characterReferenceMarkerNumeric:J,characterReferenceValue:ne,characterReference:ae,codeFenced:c(b),codeFencedFence:y,codeFencedFenceInfo:h,codeFencedFenceMeta:g,codeFlowValue:M,codeIndented:c(x),codeText:c(H),codeTextData:M,data:M,definition:c(),definitionDestinationString:C,definitionLabelString:_,definitionTitleString:v,emphasis:c(),hardBreakEscape:c(P),hardBreakTrailing:c(P),htmlFlow:c(O),htmlFlowData:M,htmlText:c(L),htmlTextData:M,image:c(I),label:G,labelText:F,lineEnding:N,link:c(R),listItem:c(),listOrdered:c(),listUnordered:c(),paragraph:c(),referenceString:X,resourceDestinationString:j,resourceTitleString:$,resource:q,setextHeading:c(T),setextHeadingLineSequence:E,setextHeadingText:S,strong:c(),thematicBreak:c()}};SB(t,(e||{}).mdastExtensions||[]);const n={};return r;function r(ge){let Ce={type:"root",children:[]};const Ae={stack:[Ce],tokenStack:[],config:t,enter:i,exit:u,buffer:o,resume:d,data:n},He=[];let rt=-1;for(;++rt<ge.length;)if(ge[rt][1].type==="listOrdered"||ge[rt][1].type==="listUnordered")if(ge[rt][0]==="enter")He.push(rt);else{const Ft=He.pop();rt=s(ge,Ft,rt)}for(rt=-1;++rt<ge.length;){const Ft=t[ge[rt][0]];wB.call(Ft,ge[rt][1].type)&&Ft[ge[rt][1].type].call(Object.assign({sliceSerialize:ge[rt][2].sliceSerialize},Ae),ge[rt][1])}if(Ae.tokenStack.length>0){const Ft=Ae.tokenStack[Ae.tokenStack.length-1];(Ft[1]||_A).call(Ae,void 0,Ft[0])}for(Ce.position={start:Wo(ge.length>0?ge[0][1].start:{line:1,column:1,offset:0}),end:Wo(ge.length>0?ge[ge.length-2][1].end:{line:1,column:1,offset:0})},rt=-1;++rt<t.transforms.length;)Ce=t.transforms[rt](Ce)||Ce;return Ce}function s(ge,Ce,Ae){let He=Ce-1,rt=-1,Ft=!1,Qt,Ye,We,it;for(;++He<=Ae;){const Ee=ge[He];switch(Ee[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Ee[0]==="enter"?rt++:rt--,it=void 0;break}case"lineEndingBlank":{Ee[0]==="enter"&&(Qt&&!it&&!rt&&!We&&(We=He),it=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:it=void 0}if(!rt&&Ee[0]==="enter"&&Ee[1].type==="listItemPrefix"||rt===-1&&Ee[0]==="exit"&&(Ee[1].type==="listUnordered"||Ee[1].type==="listOrdered")){if(Qt){let et=He;for(Ye=void 0;et--;){const xt=ge[et];if(xt[1].type==="lineEnding"||xt[1].type==="lineEndingBlank"){if(xt[0]==="exit")continue;Ye&&(ge[Ye][1].type="lineEndingBlank",Ft=!0),xt[1].type="lineEnding",Ye=et}else if(!(xt[1].type==="linePrefix"||xt[1].type==="blockQuotePrefix"||xt[1].type==="blockQuotePrefixWhitespace"||xt[1].type==="blockQuoteMarker"||xt[1].type==="listItemIndent"))break}We&&(!Ye||We<Ye)&&(Qt._spread=!0),Qt.end=Object.assign({},Ye?ge[Ye][1].start:Ee[1].end),ge.splice(Ye||He,0,["exit",Qt,Ee[2]]),He++,Ae++}if(Ee[1].type==="listItemPrefix"){const et={type:"listItem",_spread:!1,start:Object.assign({},Ee[1].start),end:void 0};Qt=et,ge.splice(He,0,["enter",et,Ee[2]]),He++,Ae++,We=void 0,it=!0}}}return ge[Ce][1]._spread=Ft,Ae}function a(ge,Ce){return Ae;function Ae(He){i.call(this,ge(He),He),Ce&&Ce.call(this,He)}}function o(){this.stack.push({type:"fragment",children:[]})}function i(ge,Ce,Ae){this.stack[this.stack.length-1].children.push(ge),this.stack.push(ge),this.tokenStack.push([Ce,Ae||void 0]),ge.position={start:Wo(Ce.start),end:void 0}}function c(ge){return Ce;function Ce(Ae){ge&&ge.call(this,Ae),u.call(this,Ae)}}function u(ge,Ce){const Ae=this.stack.pop(),He=this.tokenStack.pop();if(He)He[0].type!==ge.type&&(Ce?Ce.call(this,ge,He[0]):(He[1]||_A).call(this,ge,He[0]));else throw new Error("Cannot close `"+ge.type+"` ("+Qd({start:ge.start,end:ge.end})+"): its not open");Ae.position.end=Wo(ge.end)}function d(){return u3(this.stack.pop())}function m(){this.data.expectingFirstListItemValue=!0}function p(ge){if(this.data.expectingFirstListItemValue){const Ce=this.stack[this.stack.length-2];Ce.start=Number.parseInt(this.sliceSerialize(ge),10),this.data.expectingFirstListItemValue=void 0}}function h(){const ge=this.resume(),Ce=this.stack[this.stack.length-1];Ce.lang=ge}function g(){const ge=this.resume(),Ce=this.stack[this.stack.length-1];Ce.meta=ge}function y(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function b(){const ge=this.resume(),Ce=this.stack[this.stack.length-1];Ce.value=ge.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function x(){const ge=this.resume(),Ce=this.stack[this.stack.length-1];Ce.value=ge.replace(/(\r?\n|\r)$/g,"")}function _(ge){const Ce=this.resume(),Ae=this.stack[this.stack.length-1];Ae.label=Ce,Ae.identifier=ua(this.sliceSerialize(ge)).toLowerCase()}function v(){const ge=this.resume(),Ce=this.stack[this.stack.length-1];Ce.title=ge}function C(){const ge=this.resume(),Ce=this.stack[this.stack.length-1];Ce.url=ge}function w(ge){const Ce=this.stack[this.stack.length-1];if(!Ce.depth){const Ae=this.sliceSerialize(ge).length;Ce.depth=Ae}}function S(){this.data.setextHeadingSlurpLineEnding=!0}function E(ge){const Ce=this.stack[this.stack.length-1];Ce.depth=this.sliceSerialize(ge).codePointAt(0)===61?1:2}function T(){this.data.setextHeadingSlurpLineEnding=void 0}function k(ge){const Ae=this.stack[this.stack.length-1].children;let He=Ae[Ae.length-1];(!He||He.type!=="text")&&(He=Fe(),He.position={start:Wo(ge.start),end:void 0},Ae.push(He)),this.stack.push(He)}function M(ge){const Ce=this.stack.pop();Ce.value+=this.sliceSerialize(ge),Ce.position.end=Wo(ge.end)}function N(ge){const Ce=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Ae=Ce.children[Ce.children.length-1];Ae.position.end=Wo(ge.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(Ce.type)&&(k.call(this,ge),M.call(this,ge))}function P(){this.data.atHardBreak=!0}function O(){const ge=this.resume(),Ce=this.stack[this.stack.length-1];Ce.value=ge}function L(){const ge=this.resume(),Ce=this.stack[this.stack.length-1];Ce.value=ge}function H(){const ge=this.resume(),Ce=this.stack[this.stack.length-1];Ce.value=ge}function R(){const ge=this.stack[this.stack.length-1];if(this.data.inReference){const Ce=this.data.referenceType||"shortcut";ge.type+="Reference",ge.referenceType=Ce,delete ge.url,delete ge.title}else delete ge.identifier,delete ge.label;this.data.referenceType=void 0}function I(){const ge=this.stack[this.stack.length-1];if(this.data.inReference){const Ce=this.data.referenceType||"shortcut";ge.type+="Reference",ge.referenceType=Ce,delete ge.url,delete ge.title}else delete ge.identifier,delete ge.label;this.data.referenceType=void 0}function F(ge){const Ce=this.sliceSerialize(ge),Ae=this.stack[this.stack.length-2];Ae.label=cke(Ce),Ae.identifier=ua(Ce).toLowerCase()}function G(){const ge=this.stack[this.stack.length-1],Ce=this.resume(),Ae=this.stack[this.stack.length-1];if(this.data.inReference=!0,Ae.type==="link"){const He=ge.children;Ae.children=He}else Ae.alt=Ce}function j(){const ge=this.resume(),Ce=this.stack[this.stack.length-1];Ce.url=ge}function $(){const ge=this.resume(),Ce=this.stack[this.stack.length-1];Ce.title=ge}function q(){this.data.inReference=void 0}function U(){this.data.referenceType="collapsed"}function X(ge){const Ce=this.resume(),Ae=this.stack[this.stack.length-1];Ae.label=Ce,Ae.identifier=ua(this.sliceSerialize(ge)).toLowerCase(),this.data.referenceType="full"}function J(ge){this.data.characterReferenceType=ge.type}function ne(ge){const Ce=this.sliceSerialize(ge),Ae=this.data.characterReferenceType;let He;Ae?(He=mB(Ce,Ae==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):He=d3(Ce);const rt=this.stack[this.stack.length-1];rt.value+=He}function ae(ge){const Ce=this.stack.pop();Ce.position.end=Wo(ge.end)}function de(ge){M.call(this,ge);const Ce=this.stack[this.stack.length-1];Ce.url=this.sliceSerialize(ge)}function oe(ge){M.call(this,ge);const Ce=this.stack[this.stack.length-1];Ce.url="mailto:"+this.sliceSerialize(ge)}function le(){return{type:"blockquote",children:[]}}function se(){return{type:"code",lang:null,meta:null,value:""}}function re(){return{type:"inlineCode",value:""}}function he(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function ie(){return{type:"emphasis",children:[]}}function ue(){return{type:"heading",depth:0,children:[]}}function ce(){return{type:"break"}}function me(){return{type:"html",value:""}}function pe(){return{type:"image",title:null,url:"",alt:null}}function xe(){return{type:"link",title:null,url:"",children:[]}}function Oe(ge){return{type:"list",ordered:ge.type==="listOrdered",start:null,spread:ge._spread,children:[]}}function Te(ge){return{type:"listItem",spread:ge._spread,checked:null,children:[]}}function we(){return{type:"paragraph",children:[]}}function ke(){return{type:"strong",children:[]}}function Fe(){return{type:"text",value:""}}function ot(){return{type:"thematicBreak"}}}function Wo(e){return{line:e.line,column:e.column,offset:e.offset}}function SB(e,t){let n=-1;for(;++n<t.length;){const r=t[n];Array.isArray(r)?SB(e,r):mke(e,r)}}function mke(e,t){let n;for(n in t)if(wB.call(t,n))switch(n){case"canContainEols":{const r=t[n];r&&e[n].push(...r);break}case"transforms":{const r=t[n];r&&e[n].push(...r);break}case"enter":case"exit":{const r=t[n];r&&Object.assign(e[n],r);break}}}function _A(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+Qd({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+Qd({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+Qd({start:t.start,end:t.end})+") is still open")}function EB(e){const t=this;t.parser=n;function n(r){return dke(r,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function pke(e,t){const n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)}function hke(e,t){const n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:`
`}]}function gke(e,t){const n=t.value?t.value+`
`:"",r={};t.lang&&(r.className=["language-"+t.lang]);let s={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return t.meta&&(s.data={meta:t.meta}),e.patch(t,s),s=e.applyData(t,s),s={type:"element",tagName:"pre",properties:{},children:[s]},e.patch(t,s),s}function yke(e,t){const n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function xke(e,t){const n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function bke(e,t){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(t.identifier).toUpperCase(),s=Fu(r.toLowerCase()),a=e.footnoteOrder.indexOf(r);let o,i=e.footnoteCounts.get(r);i===void 0?(i=0,e.footnoteOrder.push(r),o=e.footnoteOrder.length):o=a+1,i+=1,e.footnoteCounts.set(r,i);const c={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+s,id:n+"fnref-"+s+(i>1?"-"+i:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};e.patch(t,c);const u={type:"element",tagName:"sup",properties:{},children:[c]};return e.patch(t,u),e.applyData(t,u)}function _ke(e,t){const n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function vke(e,t){if(e.options.allowDangerousHtml){const n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}}function kB(e,t){const n=t.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+r}];const s=e.all(t),a=s[0];a&&a.type==="text"?a.value="["+a.value:s.unshift({type:"text",value:"["});const o=s[s.length-1];return o&&o.type==="text"?o.value+=r:s.push({type:"text",value:r}),s}function Cke(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return kB(e,t);const s={src:Fu(r.url||""),alt:t.alt};r.title!==null&&r.title!==void 0&&(s.title=r.title);const a={type:"element",tagName:"img",properties:s,children:[]};return e.patch(t,a),e.applyData(t,a)}function wke(e,t){const n={src:Fu(t.url)};t.alt!==null&&t.alt!==void 0&&(n.alt=t.alt),t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,r),e.applyData(t,r)}function Ske(e,t){const n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,r),e.applyData(t,r)}function Eke(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return kB(e,t);const s={href:Fu(r.url||"")};r.title!==null&&r.title!==void 0&&(s.title=r.title);const a={type:"element",tagName:"a",properties:s,children:e.all(t)};return e.patch(t,a),e.applyData(t,a)}function kke(e,t){const n={href:Fu(t.url)};t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function Mke(e,t,n){const r=e.all(t),s=n?Tke(n):MB(t),a={},o=[];if(typeof t.checked=="boolean"){const d=r[0];let m;d&&d.type==="element"&&d.tagName==="p"?m=d:(m={type:"element",tagName:"p",properties:{},children:[]},r.unshift(m)),m.children.length>0&&m.children.unshift({type:"text",value:" "}),m.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),a.className=["task-list-item"]}let i=-1;for(;++i<r.length;){const d=r[i];(s||i!==0||d.type!=="element"||d.tagName!=="p")&&o.push({type:"text",value:`
`}),d.type==="element"&&d.tagName==="p"&&!s?o.push(...d.children):o.push(d)}const c=r[r.length-1];c&&(s||c.type!=="element"||c.tagName!=="p")&&o.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:a,children:o};return e.patch(t,u),e.applyData(t,u)}function Tke(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const n=e.children;let r=-1;for(;!t&&++r<n.length;)t=MB(n[r])}return t}function MB(e){const t=e.spread;return t??e.children.length>1}function Ake(e,t){const n={},r=e.all(t);let s=-1;for(typeof t.start=="number"&&t.start!==1&&(n.start=t.start);++s<r.length;){const o=r[s];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const a={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(r,!0)};return e.patch(t,a),e.applyData(t,a)}function Nke(e,t){const n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function Rke(e,t){const n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)}function Dke(e,t){const n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function Ike(e,t){const n=e.all(t),r=n.shift(),s=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(t.children[0],o),s.push(o)}if(n.length>0){const o={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},i=o3(t.children[1]),c=aB(t.children[t.children.length-1]);i&&c&&(o.position={start:i,end:c}),s.push(o)}const a={type:"element",tagName:"table",properties:{},children:e.wrap(s,!0)};return e.patch(t,a),e.applyData(t,a)}function jke(e,t,n){const r=n?n.children:void 0,a=(r?r.indexOf(t):1)===0?"th":"td",o=n&&n.type==="table"?n.align:void 0,i=o?o.length:t.children.length;let c=-1;const u=[];for(;++c<i;){const m=t.children[c],p={},h=o?o[c]:void 0;h&&(p.align=h);let g={type:"element",tagName:a,properties:p,children:[]};m&&(g.children=e.all(m),e.patch(m,g),g=e.applyData(m,g)),u.push(g)}const d={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(t,d),e.applyData(t,d)}function Pke(e,t){const n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}const vA=9,CA=32;function Oke(e){const t=String(e),n=/\r?\n|\r/g;let r=n.exec(t),s=0;const a=[];for(;r;)a.push(wA(t.slice(s,r.index),s>0,!0),r[0]),s=r.index+r[0].length,r=n.exec(t);return a.push(wA(t.slice(s),s>0,!1)),a.join("")}function wA(e,t,n){let r=0,s=e.length;if(t){let a=e.codePointAt(r);for(;a===vA||a===CA;)r++,a=e.codePointAt(r)}if(n){let a=e.codePointAt(s-1);for(;a===vA||a===CA;)s--,a=e.codePointAt(s-1)}return s>r?e.slice(r,s):""}function Lke(e,t){const n={type:"text",value:Oke(String(t.value))};return e.patch(t,n),e.applyData(t,n)}function Fke(e,t){const n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)}const Uke={blockquote:pke,break:hke,code:gke,delete:yke,emphasis:xke,footnoteReference:bke,heading:_ke,html:vke,imageReference:Cke,image:wke,inlineCode:Ske,linkReference:Eke,link:kke,listItem:Mke,list:Ake,paragraph:Nke,root:Rke,strong:Dke,table:Ike,tableCell:Pke,tableRow:jke,text:Lke,thematicBreak:Fke,toml:wp,yaml:wp,definition:wp,footnoteDefinition:wp};function wp(){}const TB=-1,Dy=0,Zd=1,xg=2,m3=3,p3=4,h3=5,g3=6,AB=7,NB=8,SA=typeof self=="object"?self:globalThis,Bke=(e,t)=>{const n=(s,a)=>(e.set(a,s),s),r=s=>{if(e.has(s))return e.get(s);const[a,o]=t[s];switch(a){case Dy:case TB:return n(o,s);case Zd:{const i=n([],s);for(const c of o)i.push(r(c));return i}case xg:{const i=n({},s);for(const[c,u]of o)i[r(c)]=r(u);return i}case m3:return n(new Date(o),s);case p3:{const{source:i,flags:c}=o;return n(new RegExp(i,c),s)}case h3:{const i=n(new Map,s);for(const[c,u]of o)i.set(r(c),r(u));return i}case g3:{const i=n(new Set,s);for(const c of o)i.add(r(c));return i}case AB:{const{name:i,message:c}=o;return n(new SA[i](c),s)}case NB:return n(BigInt(o),s);case"BigInt":return n(Object(BigInt(o)),s);case"ArrayBuffer":return n(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:i}=new Uint8Array(o);return n(new DataView(i),o)}}return n(new SA[a](o),s)};return r},EA=e=>Bke(new Map,e)(0),oc="",{toString:Hke}={},{keys:Vke}=Object,xd=e=>{const t=typeof e;if(t!=="object"||!e)return[Dy,t];const n=Hke.call(e).slice(8,-1);switch(n){case"Array":return[Zd,oc];case"Object":return[xg,oc];case"Date":return[m3,oc];case"RegExp":return[p3,oc];case"Map":return[h3,oc];case"Set":return[g3,oc];case"DataView":return[Zd,n]}return n.includes("Array")?[Zd,n]:n.includes("Error")?[AB,n]:[xg,n]},Sp=([e,t])=>e===Dy&&(t==="function"||t==="symbol"),Gke=(e,t,n,r)=>{const s=(o,i)=>{const c=r.push(o)-1;return n.set(i,c),c},a=o=>{if(n.has(o))return n.get(o);let[i,c]=xd(o);switch(i){case Dy:{let d=o;switch(c){case"bigint":i=NB,d=o.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+c);d=null;break;case"undefined":return s([TB],o)}return s([i,d],o)}case Zd:{if(c){let p=o;return c==="DataView"?p=new Uint8Array(o.buffer):c==="ArrayBuffer"&&(p=new Uint8Array(o)),s([c,[...p]],o)}const d=[],m=s([i,d],o);for(const p of o)d.push(a(p));return m}case xg:{if(c)switch(c){case"BigInt":return s([c,o.toString()],o);case"Boolean":case"Number":case"String":return s([c,o.valueOf()],o)}if(t&&"toJSON"in o)return a(o.toJSON());const d=[],m=s([i,d],o);for(const p of Vke(o))(e||!Sp(xd(o[p])))&&d.push([a(p),a(o[p])]);return m}case m3:return s([i,o.toISOString()],o);case p3:{const{source:d,flags:m}=o;return s([i,{source:d,flags:m}],o)}case h3:{const d=[],m=s([i,d],o);for(const[p,h]of o)(e||!(Sp(xd(p))||Sp(xd(h))))&&d.push([a(p),a(h)]);return m}case g3:{const d=[],m=s([i,d],o);for(const p of o)(e||!Sp(xd(p)))&&d.push(a(p));return m}}const{message:u}=o;return s([i,{name:c,message:u}],o)};return a},kA=(e,{json:t,lossy:n}={})=>{const r=[];return Gke(!(t||n),!!t,new Map,r)(e),r},il=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?EA(kA(e,t)):structuredClone(e):(e,t)=>EA(kA(e,t));function zke(e,t){const n=[{type:"text",value:""}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function qke(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function $ke(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||zke,r=e.options.footnoteBackLabel||qke,s=e.options.footnoteLabel||"Footnotes",a=e.options.footnoteLabelTagName||"h2",o=e.options.footnoteLabelProperties||{className:["sr-only"]},i=[];let c=-1;for(;++c<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[c]);if(!u)continue;const d=e.all(u),m=String(u.identifier).toUpperCase(),p=Fu(m.toLowerCase());let h=0;const g=[],y=e.footnoteCounts.get(m);for(;y!==void 0&&++h<=y;){g.length>0&&g.push({type:"text",value:" "});let _=typeof n=="string"?n:n(c,h);typeof _=="string"&&(_={type:"text",value:_}),g.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+p+(h>1?"-"+h:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(c,h),className:["data-footnote-backref"]},children:Array.isArray(_)?_:[_]})}const b=d[d.length-1];if(b&&b.type==="element"&&b.tagName==="p"){const _=b.children[b.children.length-1];_&&_.type==="text"?_.value+=" ":b.children.push({type:"text",value:" "}),b.children.push(...g)}else d.push(...g);const x={type:"element",tagName:"li",properties:{id:t+"fn-"+p},children:e.wrap(d,!0)};e.patch(u,x),i.push(x)}if(i.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:a,properties:{...il(o),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(i,!0)},{type:"text",value:`
`}]}}const Iy=(function(e){if(e==null)return Qke;if(typeof e=="function")return jy(e);if(typeof e=="object")return Array.isArray(e)?Wke(e):Kke(e);if(typeof e=="string")return Yke(e);throw new Error("Expected function, string, or object as test")});function Wke(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=Iy(e[n]);return jy(r);function r(...s){let a=-1;for(;++a<t.length;)if(t[a].apply(this,s))return!0;return!1}}function Kke(e){const t=e;return jy(n);function n(r){const s=r;let a;for(a in e)if(s[a]!==t[a])return!1;return!0}}function Yke(e){return jy(t);function t(n){return n&&n.type===e}}function jy(e){return t;function t(n,r,s){return!!(Xke(n)&&e.call(this,n,typeof r=="number"?r:void 0,s||void 0))}}function Qke(){return!0}function Xke(e){return e!==null&&typeof e=="object"&&"type"in e}const RB=[],au=!0,sv=!1,Lr="skip";function DB(e,t,n,r){let s;typeof t=="function"&&typeof n!="function"?(r=n,n=t):s=t;const a=Iy(s),o=r?-1:1;i(e,void 0,[])();function i(c,u,d){const m=c&&typeof c=="object"?c:{};if(typeof m.type=="string"){const h=typeof m.tagName=="string"?m.tagName:typeof m.name=="string"?m.name:void 0;Object.defineProperty(p,"name",{value:"node ("+(c.type+(h?"<"+h+">":""))+")"})}return p;function p(){let h=RB,g,y,b;if((!t||a(c,u,d[d.length-1]||void 0))&&(h=Zke(n(c,d)),h[0]===sv))return h;if("children"in c&&c.children){const x=c;if(x.children&&h[0]!==Lr)for(y=(r?x.children.length:-1)+o,b=d.concat(x);y>-1&&y<x.children.length;){const _=x.children[y];if(g=i(_,y,b)(),g[0]===sv)return g;y=typeof g[1]=="number"?g[1]:y+o}}return h}}}function Zke(e){return Array.isArray(e)?e:typeof e=="number"?[au,e]:e==null?RB:[e]}function Bn(e,t,n,r){let s,a,o;typeof t=="function"&&typeof n!="function"?(a=void 0,o=t,s=n):(a=t,o=n,s=r),DB(e,a,i,s);function i(c,u){const d=u[u.length-1],m=d?d.children.indexOf(c):void 0;return o(c,m,d)}}const av={}.hasOwnProperty,Jke={};function e4e(e,t){const n=t||Jke,r=new Map,s=new Map,a=new Map,o={...Uke,...n.handlers},i={all:u,applyData:n4e,definitionById:r,footnoteById:s,footnoteCounts:a,footnoteOrder:[],handlers:o,one:c,options:n,patch:t4e,wrap:s4e};return Bn(e,function(d){if(d.type==="definition"||d.type==="footnoteDefinition"){const m=d.type==="definition"?r:s,p=String(d.identifier).toUpperCase();m.has(p)||m.set(p,d)}}),i;function c(d,m){const p=d.type,h=i.handlers[p];if(av.call(i.handlers,p)&&h)return h(i,d,m);if(i.options.passThrough&&i.options.passThrough.includes(p)){if("children"in d){const{children:y,...b}=d,x=il(b);return x.children=i.all(d),x}return il(d)}return(i.options.unknownHandler||r4e)(i,d,m)}function u(d){const m=[];if("children"in d){const p=d.children;let h=-1;for(;++h<p.length;){const g=i.one(p[h],d);if(g){if(h&&p[h-1].type==="break"&&(!Array.isArray(g)&&g.type==="text"&&(g.value=MA(g.value)),!Array.isArray(g)&&g.type==="element")){const y=g.children[0];y&&y.type==="text"&&(y.value=MA(y.value))}Array.isArray(g)?m.push(...g):m.push(g)}}}return m}}function t4e(e,t){e.position&&(t.position=$Ee(e))}function n4e(e,t){let n=t;if(e&&e.data){const r=e.data.hName,s=e.data.hChildren,a=e.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const o="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:o}}n.type==="element"&&a&&Object.assign(n.properties,il(a)),"children"in n&&n.children&&s!==null&&s!==void 0&&(n.children=s)}return n}function r4e(e,t){const n=t.data||{},r="value"in t&&!(av.call(n,"hProperties")||av.call(n,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function s4e(e,t){const n=[];let r=-1;for(t&&n.push({type:"text",value:`
`});++r<e.length;)r&&n.push({type:"text",value:`
`}),n.push(e[r]);return t&&e.length>0&&n.push({type:"text",value:`
`}),n}function MA(e){let t=0,n=e.charCodeAt(t);for(;n===9||n===32;)t++,n=e.charCodeAt(t);return e.slice(t)}function TA(e,t){const n=e4e(e,t),r=n.one(e,void 0),s=$ke(n),a=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return s&&a.children.push({type:"text",value:`
`},s),a}function a4e(e,t){return e&&"run"in e?async function(n,r){const s=TA(n,{file:r,...t});await e.run(s,r)}:function(n,r){return TA(n,{file:r,...e||t})}}function AA(e){if(e)throw e}var L1,NA;function o4e(){if(NA)return L1;NA=1;var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,n=Object.defineProperty,r=Object.getOwnPropertyDescriptor,s=function(u){return typeof Array.isArray=="function"?Array.isArray(u):t.call(u)==="[object Array]"},a=function(u){if(!u||t.call(u)!=="[object Object]")return!1;var d=e.call(u,"constructor"),m=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!d&&!m)return!1;var p;for(p in u);return typeof p>"u"||e.call(u,p)},o=function(u,d){n&&d.name==="__proto__"?n(u,d.name,{enumerable:!0,configurable:!0,value:d.newValue,writable:!0}):u[d.name]=d.newValue},i=function(u,d){if(d==="__proto__")if(e.call(u,d)){if(r)return r(u,d).value}else return;return u[d]};return L1=function c(){var u,d,m,p,h,g,y=arguments[0],b=1,x=arguments.length,_=!1;for(typeof y=="boolean"&&(_=y,y=arguments[1]||{},b=2),(y==null||typeof y!="object"&&typeof y!="function")&&(y={});b<x;++b)if(u=arguments[b],u!=null)for(d in u)m=i(y,d),p=i(u,d),y!==p&&(_&&p&&(a(p)||(h=s(p)))?(h?(h=!1,g=m&&s(m)?m:[]):g=m&&a(m)?m:{},o(y,{name:d,newValue:c(_,g,p)})):typeof p<"u"&&o(y,{name:d,newValue:p}));return y},L1}var i4e=o4e();const F1=ha(i4e);function ov(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function l4e(){const e=[],t={run:n,use:r};return t;function n(...s){let a=-1;const o=s.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);i(null,...s);function i(c,...u){const d=e[++a];let m=-1;if(c){o(c);return}for(;++m<s.length;)(u[m]===null||u[m]===void 0)&&(u[m]=s[m]);s=u,d?c4e(d,i)(...u):o(null,...u)}}function r(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return e.push(s),t}}function c4e(e,t){let n;return r;function r(...o){const i=e.length>o.length;let c;i&&o.push(s);try{c=e.apply(this,o)}catch(u){const d=u;if(i&&n)throw d;return s(d)}i||(c&&c.then&&typeof c.then=="function"?c.then(a,s):c instanceof Error?s(c):a(c))}function s(o,...i){n||(n=!0,t(o,...i))}function a(o){s(null,o)}}const Aa={basename:u4e,dirname:d4e,extname:f4e,join:m4e,sep:"/"};function u4e(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Tm(e);let n=0,r=-1,s=e.length,a;if(t===void 0||t.length===0||t.length>e.length){for(;s--;)if(e.codePointAt(s)===47){if(a){n=s+1;break}}else r<0&&(a=!0,r=s+1);return r<0?"":e.slice(n,r)}if(t===e)return"";let o=-1,i=t.length-1;for(;s--;)if(e.codePointAt(s)===47){if(a){n=s+1;break}}else o<0&&(a=!0,o=s+1),i>-1&&(e.codePointAt(s)===t.codePointAt(i--)?i<0&&(r=s):(i=-1,r=o));return n===r?r=o:r<0&&(r=e.length),e.slice(n,r)}function d4e(e){if(Tm(e),e.length===0)return".";let t=-1,n=e.length,r;for(;--n;)if(e.codePointAt(n)===47){if(r){t=n;break}}else r||(r=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function f4e(e){Tm(e);let t=e.length,n=-1,r=0,s=-1,a=0,o;for(;t--;){const i=e.codePointAt(t);if(i===47){if(o){r=t+1;break}continue}n<0&&(o=!0,n=t+1),i===46?s<0?s=t:a!==1&&(a=1):s>-1&&(a=-1)}return s<0||n<0||a===0||a===1&&s===n-1&&s===r+1?"":e.slice(s,n)}function m4e(...e){let t=-1,n;for(;++t<e.length;)Tm(e[t]),e[t]&&(n=n===void 0?e[t]:n+"/"+e[t]);return n===void 0?".":p4e(n)}function p4e(e){Tm(e);const t=e.codePointAt(0)===47;let n=h4e(e,!t);return n.length===0&&!t&&(n="."),n.length>0&&e.codePointAt(e.length-1)===47&&(n+="/"),t?"/"+n:n}function h4e(e,t){let n="",r=0,s=-1,a=0,o=-1,i,c;for(;++o<=e.length;){if(o<e.length)i=e.codePointAt(o);else{if(i===47)break;i=47}if(i===47){if(!(s===o-1||a===1))if(s!==o-1&&a===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(c=n.lastIndexOf("/"),c!==n.length-1){c<0?(n="",r=0):(n=n.slice(0,c),r=n.length-1-n.lastIndexOf("/")),s=o,a=0;continue}}else if(n.length>0){n="",r=0,s=o,a=0;continue}}t&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(s+1,o):n=e.slice(s+1,o),r=o-s-1;s=o,a=0}else i===46&&a>-1?a++:a=-1}return n}function Tm(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const g4e={cwd:y4e};function y4e(){return"/"}function iv(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function x4e(e){if(typeof e=="string")e=new URL(e);else if(!iv(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return b4e(e)}function b4e(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const t=e.pathname;let n=-1;for(;++n<t.length;)if(t.codePointAt(n)===37&&t.codePointAt(n+1)===50){const r=t.codePointAt(n+2);if(r===70||r===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(t)}const U1=["history","path","basename","stem","extname","dirname"];class IB{constructor(t){let n;t?iv(t)?n={path:t}:typeof t=="string"||_4e(t)?n={value:t}:n=t:n={},this.cwd="cwd"in n?"":g4e.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<U1.length;){const a=U1[r];a in n&&n[a]!==void 0&&n[a]!==null&&(this[a]=a==="history"?[...n[a]]:n[a])}let s;for(s in n)U1.includes(s)||(this[s]=n[s])}get basename(){return typeof this.path=="string"?Aa.basename(this.path):void 0}set basename(t){H1(t,"basename"),B1(t,"basename"),this.path=Aa.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?Aa.dirname(this.path):void 0}set dirname(t){RA(this.basename,"dirname"),this.path=Aa.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?Aa.extname(this.path):void 0}set extname(t){if(B1(t,"extname"),RA(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Aa.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){iv(t)&&(t=x4e(t)),H1(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?Aa.basename(this.path,this.extname):void 0}set stem(t){H1(t,"stem"),B1(t,"stem"),this.path=Aa.join(this.dirname||"",t+(this.extname||""))}fail(t,n,r){const s=this.message(t,n,r);throw s.fatal=!0,s}info(t,n,r){const s=this.message(t,n,r);return s.fatal=void 0,s}message(t,n,r){const s=new Ar(t,n,r);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function B1(e,t){if(e&&e.includes(Aa.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+Aa.sep+"`")}function H1(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function RA(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function _4e(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const v4e=(function(e){const r=this.constructor.prototype,s=r[e],a=function(){return s.apply(a,arguments)};return Object.setPrototypeOf(a,r),a}),C4e={}.hasOwnProperty;class y3 extends v4e{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=l4e()}copy(){const t=new y3;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];t.use(...r)}return t.data(F1(!0,{},this.namespace)),t}data(t,n){return typeof t=="string"?arguments.length===2?(z1("data",this.frozen),this.namespace[t]=n,this):C4e.call(this.namespace,t)&&this.namespace[t]||void 0:t?(z1("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const s=n.call(t,...r);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const n=Ep(t),r=this.parser||this.Parser;return V1("parse",r),r(String(n),n)}process(t,n){const r=this;return this.freeze(),V1("process",this.parser||this.Parser),G1("process",this.compiler||this.Compiler),n?s(void 0,n):new Promise(s);function s(a,o){const i=Ep(t),c=r.parse(i);r.run(c,i,function(d,m,p){if(d||!m||!p)return u(d);const h=m,g=r.stringify(h,p);S4e(g)?p.value=g:p.result=g,u(d,p)});function u(d,m){d||!m?o(d):a?a(m):n(void 0,m)}}}processSync(t){let n=!1,r;return this.freeze(),V1("processSync",this.parser||this.Parser),G1("processSync",this.compiler||this.Compiler),this.process(t,s),IA("processSync","process",n),r;function s(a,o){n=!0,AA(a),r=o}}run(t,n,r){DA(t),this.freeze();const s=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?a(void 0,r):new Promise(a);function a(o,i){const c=Ep(n);s.run(t,c,u);function u(d,m,p){const h=m||t;d?i(d):o?o(h):r(void 0,h,p)}}}runSync(t,n){let r=!1,s;return this.run(t,n,a),IA("runSync","run",r),s;function a(o,i){AA(o),s=i,r=!0}}stringify(t,n){this.freeze();const r=Ep(n),s=this.compiler||this.Compiler;return G1("stringify",s),DA(t),s(t,r)}use(t,...n){const r=this.attachers,s=this.namespace;if(z1("use",this.frozen),t!=null)if(typeof t=="function")c(t,n);else if(typeof t=="object")Array.isArray(t)?i(t):o(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function a(u){if(typeof u=="function")c(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[d,...m]=u;c(d,m)}else o(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function o(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");i(u.plugins),u.settings&&(s.settings=F1(!0,s.settings,u.settings))}function i(u){let d=-1;if(u!=null)if(Array.isArray(u))for(;++d<u.length;){const m=u[d];a(m)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function c(u,d){let m=-1,p=-1;for(;++m<r.length;)if(r[m][0]===u){p=m;break}if(p===-1)r.push([u,...d]);else if(d.length>0){let[h,...g]=d;const y=r[p][1];ov(y)&&ov(h)&&(h=F1(!0,y,h)),r[p]=[u,h,...g]}}}}const jB=new y3().freeze();function V1(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function G1(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function z1(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function DA(e){if(!ov(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function IA(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function Ep(e){return w4e(e)?e:new IB(e)}function w4e(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function S4e(e){return typeof e=="string"||E4e(e)}function E4e(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const k4e="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",jA=[],PA={allowDangerousHtml:!0},M4e=/^(https?|ircs?|mailto|xmpp)$/i,T4e=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function A4e(e){const t=e.allowedElements,n=e.allowElement,r=e.children||"",s=e.className,a=e.components,o=e.disallowedElements,i=e.rehypePlugins||jA,c=e.remarkPlugins||jA,u=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...PA}:PA,d=e.skipHtml,m=e.unwrapDisallowed,p=e.urlTransform||N4e,h=jB().use(EB).use(c).use(a4e,u).use(i),g=new IB;typeof r=="string"&&(g.value=r);for(const _ of T4e)Object.hasOwn(e,_.from)&&(""+_.from+(_.to?"use `"+_.to+"` instead":"remove it")+k4e+_.id,void 0);const y=h.parse(g);let b=h.runSync(y,g);return s&&(b={type:"element",tagName:"div",properties:{className:s},children:b.type==="root"?b.children:[b]}),Bn(b,x),XEe(b,{Fragment:l.Fragment,components:a,ignoreInvalidStyle:!0,jsx:l.jsx,jsxs:l.jsxs,passKeys:!0,passNode:!0});function x(_,v,C){if(_.type==="raw"&&C&&typeof v=="number")return d?C.children.splice(v,1):C.children[v]={type:"text",value:_.value},v;if(_.type==="element"){let w;for(w in j1)if(Object.hasOwn(j1,w)&&Object.hasOwn(_.properties,w)){const S=_.properties[w],E=j1[w];(E===null||E.includes(_.tagName))&&(_.properties[w]=p(String(S||""),w,_))}}if(_.type==="element"){let w=t?!t.includes(_.tagName):o?o.includes(_.tagName):!1;if(!w&&n&&typeof v=="number"&&(w=!n(_,v,C)),w&&C&&typeof v=="number")return m&&_.children?C.children.splice(v,1,..._.children):C.children.splice(v,1),v}}}function N4e(e){const t=e.indexOf(":"),n=e.indexOf("?"),r=e.indexOf("#"),s=e.indexOf("/");return t===-1||s!==-1&&t>s||n!==-1&&t>n||r!==-1&&t>r||M4e.test(e.slice(0,t))?e:""}const PB=(function(e){if(e==null)return I4e;if(typeof e=="string")return D4e(e);if(typeof e=="object")return R4e(e);if(typeof e=="function")return x3(e);throw new Error("Expected function, string, or array as `test`")});function R4e(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=PB(e[n]);return x3(r);function r(...s){let a=-1;for(;++a<t.length;)if(t[a].apply(this,s))return!0;return!1}}function D4e(e){return x3(t);function t(n){return n.tagName===e}}function x3(e){return t;function t(n,r,s){return!!(j4e(n)&&e.call(this,n,typeof r=="number"?r:void 0,s||void 0))}}function I4e(e){return!!(e&&typeof e=="object"&&"type"in e&&e.type==="element"&&"tagName"in e&&typeof e.tagName=="string")}function j4e(e){return e!==null&&typeof e=="object"&&"type"in e&&"tagName"in e}const P4e=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,O4e=/^[a-zA-Z]:\\/;function L4e(e){if(typeof e!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof e}\``);return O4e.test(e)?!1:P4e.test(e)}const F4e=["http","https"],U4e=["nofollow"],B4e={};function H4e(e){const t=e||B4e,n=t.protocols||F4e,r=PB(t.test);return function(s){Bn(s,"element",function(a,o,i){if(a.tagName==="a"&&typeof a.properties.href=="string"&&r(a,o,i)){const c=a.properties.href;if(L4e(c)?n.includes(c.slice(0,c.indexOf(":"))):c.startsWith("//")){const u=bd(t.content,a),d=u&&!Array.isArray(u)?[u]:u,m=bd(t.rel,a)||U4e,p=typeof m=="string"?FEe(m):m,h=bd(t.target,a),g=bd(t.properties,a);if(g&&Object.assign(a.properties,il(g)),p.length>0&&(a.properties.rel=[...p]),h&&(a.properties.target=h),d){const y=bd(t.contentProperties,a)||{};a.children.push({type:"element",tagName:"span",properties:il(y),children:il(d)})}}}})}}function bd(e,t){return typeof e=="function"?e(t):e}function OA(e,t){const n=String(e);if(typeof t!="string")throw new TypeError("Expected character");let r=0,s=n.indexOf(t);for(;s!==-1;)r++,s=n.indexOf(t,s+t.length);return r}function V4e(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function G4e(e,t,n){const s=Iy((n||{}).ignore||[]),a=z4e(t);let o=-1;for(;++o<a.length;)DB(e,"text",i);function i(u,d){let m=-1,p;for(;++m<d.length;){const h=d[m],g=p?p.children:void 0;if(s(h,g?g.indexOf(h):void 0,p))return;p=h}if(p)return c(u,d)}function c(u,d){const m=d[d.length-1],p=a[o][0],h=a[o][1];let g=0;const b=m.children.indexOf(u);let x=!1,_=[];p.lastIndex=0;let v=p.exec(u.value);for(;v;){const C=v.index,w={index:v.index,input:v.input,stack:[...d,u]};let S=h(...v,w);if(typeof S=="string"&&(S=S.length>0?{type:"text",value:S}:void 0),S===!1?p.lastIndex=C+1:(g!==C&&_.push({type:"text",value:u.value.slice(g,C)}),Array.isArray(S)?_.push(...S):S&&_.push(S),g=C+v[0].length,x=!0),!p.global)break;v=p.exec(u.value)}return x?(g<u.value.length&&_.push({type:"text",value:u.value.slice(g)}),m.children.splice(b,1,..._)):_=[u],b+_.length}}function z4e(e){const t=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const n=!e[0]||Array.isArray(e[0])?e:[e];let r=-1;for(;++r<n.length;){const s=n[r];t.push([q4e(s[0]),$4e(s[1])])}return t}function q4e(e){return typeof e=="string"?new RegExp(V4e(e),"g"):e}function $4e(e){return typeof e=="function"?e:function(){return e}}const q1="phrasing",$1=["autolink","link","image","label"];function W4e(){return{transforms:[eMe],enter:{literalAutolink:Y4e,literalAutolinkEmail:W1,literalAutolinkHttp:W1,literalAutolinkWww:W1},exit:{literalAutolink:J4e,literalAutolinkEmail:Z4e,literalAutolinkHttp:Q4e,literalAutolinkWww:X4e}}}function K4e(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:q1,notInConstruct:$1},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:q1,notInConstruct:$1},{character:":",before:"[ps]",after:"\\/",inConstruct:q1,notInConstruct:$1}]}}function Y4e(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function W1(e){this.config.enter.autolinkProtocol.call(this,e)}function Q4e(e){this.config.exit.autolinkProtocol.call(this,e)}function X4e(e){this.config.exit.data.call(this,e);const t=this.stack[this.stack.length-1];t.type,t.url="http://"+this.sliceSerialize(e)}function Z4e(e){this.config.exit.autolinkEmail.call(this,e)}function J4e(e){this.exit(e)}function eMe(e){G4e(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,tMe],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),nMe]],{ignore:["link","linkReference"]})}function tMe(e,t,n,r,s){let a="";if(!OB(s)||(/^w/i.test(t)&&(n=t+n,t="",a="http://"),!rMe(n)))return!1;const o=sMe(n+r);if(!o[0])return!1;const i={type:"link",title:null,url:a+t+o[0],children:[{type:"text",value:t+o[0]}]};return o[1]?[i,{type:"text",value:o[1]}]:i}function nMe(e,t,n,r){return!OB(r,!0)||/[-\d_]$/.test(n)?!1:{type:"link",title:null,url:"mailto:"+t+"@"+n,children:[{type:"text",value:t+"@"+n}]}}function rMe(e){const t=e.split(".");return!(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))}function sMe(e){const t=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!t)return[e,void 0];e=e.slice(0,t.index);let n=t[0],r=n.indexOf(")");const s=OA(e,"(");let a=OA(e,")");for(;r!==-1&&s>a;)e+=n.slice(0,r+1),n=n.slice(r+1),r=n.indexOf(")"),a++;return[e,n]}function OB(e,t){const n=e.input.charCodeAt(e.index-1);return(e.index===0||vl(n)||Ny(n))&&(!t||n!==47)}LB.peek=mMe;function aMe(){this.buffer()}function oMe(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function iMe(){this.buffer()}function lMe(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function cMe(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.type,n.identifier=ua(this.sliceSerialize(e)).toLowerCase(),n.label=t}function uMe(e){this.exit(e)}function dMe(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.type,n.identifier=ua(this.sliceSerialize(e)).toLowerCase(),n.label=t}function fMe(e){this.exit(e)}function mMe(){return"["}function LB(e,t,n,r){const s=n.createTracker(r);let a=s.move("[^");const o=n.enter("footnoteReference"),i=n.enter("reference");return a+=s.move(n.safe(n.associationId(e),{after:"]",before:a})),i(),o(),a+=s.move("]"),a}function pMe(){return{enter:{gfmFootnoteCallString:aMe,gfmFootnoteCall:oMe,gfmFootnoteDefinitionLabelString:iMe,gfmFootnoteDefinition:lMe},exit:{gfmFootnoteCallString:cMe,gfmFootnoteCall:uMe,gfmFootnoteDefinitionLabelString:dMe,gfmFootnoteDefinition:fMe}}}function hMe(e){let t=!1;return e&&e.firstLineBlank&&(t=!0),{handlers:{footnoteDefinition:n,footnoteReference:LB},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function n(r,s,a,o){const i=a.createTracker(o);let c=i.move("[^");const u=a.enter("footnoteDefinition"),d=a.enter("label");return c+=i.move(a.safe(a.associationId(r),{before:c,after:"]"})),d(),c+=i.move("]:"),r.children&&r.children.length>0&&(i.shift(4),c+=i.move((t?`
`:" ")+a.indentLines(a.containerFlow(r,i.current()),t?FB:gMe))),u(),c}}function gMe(e,t,n){return t===0?e:FB(e,t,n)}function FB(e,t,n){return(n?"":"    ")+e}const yMe=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];UB.peek=CMe;function xMe(){return{canContainEols:["delete"],enter:{strikethrough:_Me},exit:{strikethrough:vMe}}}function bMe(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:yMe}],handlers:{delete:UB}}}function _Me(e){this.enter({type:"delete",children:[]},e)}function vMe(e){this.exit(e)}function UB(e,t,n,r){const s=n.createTracker(r),a=n.enter("strikethrough");let o=s.move("~~");return o+=n.containerPhrasing(e,{...s.current(),before:o,after:"~"}),o+=s.move("~~"),a(),o}function CMe(){return"~"}function wMe(e){return e.length}function SMe(e,t){const n=t||{},r=(n.align||[]).concat(),s=n.stringLength||wMe,a=[],o=[],i=[],c=[];let u=0,d=-1;for(;++d<e.length;){const y=[],b=[];let x=-1;for(e[d].length>u&&(u=e[d].length);++x<e[d].length;){const _=EMe(e[d][x]);if(n.alignDelimiters!==!1){const v=s(_);b[x]=v,(c[x]===void 0||v>c[x])&&(c[x]=v)}y.push(_)}o[d]=y,i[d]=b}let m=-1;if(typeof r=="object"&&"length"in r)for(;++m<u;)a[m]=LA(r[m]);else{const y=LA(r);for(;++m<u;)a[m]=y}m=-1;const p=[],h=[];for(;++m<u;){const y=a[m];let b="",x="";y===99?(b=":",x=":"):y===108?b=":":y===114&&(x=":");let _=n.alignDelimiters===!1?1:Math.max(1,c[m]-b.length-x.length);const v=b+"-".repeat(_)+x;n.alignDelimiters!==!1&&(_=b.length+_+x.length,_>c[m]&&(c[m]=_),h[m]=_),p[m]=v}o.splice(1,0,p),i.splice(1,0,h),d=-1;const g=[];for(;++d<o.length;){const y=o[d],b=i[d];m=-1;const x=[];for(;++m<u;){const _=y[m]||"";let v="",C="";if(n.alignDelimiters!==!1){const w=c[m]-(b[m]||0),S=a[m];S===114?v=" ".repeat(w):S===99?w%2?(v=" ".repeat(w/2+.5),C=" ".repeat(w/2-.5)):(v=" ".repeat(w/2),C=v):C=" ".repeat(w)}n.delimiterStart!==!1&&!m&&x.push("|"),n.padding!==!1&&!(n.alignDelimiters===!1&&_==="")&&(n.delimiterStart!==!1||m)&&x.push(" "),n.alignDelimiters!==!1&&x.push(v),x.push(_),n.alignDelimiters!==!1&&x.push(C),n.padding!==!1&&x.push(" "),(n.delimiterEnd!==!1||m!==u-1)&&x.push("|")}g.push(n.delimiterEnd===!1?x.join("").replace(/ +$/,""):x.join(""))}return g.join(`
`)}function EMe(e){return e==null?"":String(e)}function LA(e){const t=typeof e=="string"?e.codePointAt(0):0;return t===67||t===99?99:t===76||t===108?108:t===82||t===114?114:0}function kMe(e,t,n,r){const s=n.enter("blockquote"),a=n.createTracker(r);a.move("> "),a.shift(2);const o=n.indentLines(n.containerFlow(e,a.current()),MMe);return s(),o}function MMe(e,t,n){return">"+(n?"":" ")+e}function TMe(e,t){return FA(e,t.inConstruct,!0)&&!FA(e,t.notInConstruct,!1)}function FA(e,t,n){if(typeof t=="string"&&(t=[t]),!t||t.length===0)return n;let r=-1;for(;++r<t.length;)if(e.includes(t[r]))return!0;return!1}function UA(e,t,n,r){let s=-1;for(;++s<n.unsafe.length;)if(n.unsafe[s].character===`
`&&TMe(n.stack,n.unsafe[s]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function BB(e,t){const n=String(e);let r=n.indexOf(t),s=r,a=0,o=0;if(typeof t!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===s?++a>o&&(o=a):a=1,s=r+t.length,r=n.indexOf(t,s);return o}function AMe(e,t){return!!(t.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function NMe(e){const t=e.options.fence||"`";if(t!=="`"&&t!=="~")throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function RMe(e,t,n,r){const s=NMe(n),a=e.value||"",o=s==="`"?"GraveAccent":"Tilde";if(AMe(e,n)){const m=n.enter("codeIndented"),p=n.indentLines(a,DMe);return m(),p}const i=n.createTracker(r),c=s.repeat(Math.max(BB(a,s)+1,3)),u=n.enter("codeFenced");let d=i.move(c);if(e.lang){const m=n.enter(`codeFencedLang${o}`);d+=i.move(n.safe(e.lang,{before:d,after:" ",encode:["`"],...i.current()})),m()}if(e.lang&&e.meta){const m=n.enter(`codeFencedMeta${o}`);d+=i.move(" "),d+=i.move(n.safe(e.meta,{before:d,after:`
`,encode:["`"],...i.current()})),m()}return d+=i.move(`
`),a&&(d+=i.move(a+`
`)),d+=i.move(c),u(),d}function DMe(e,t,n){return(n?"":"    ")+e}function b3(e){const t=e.options.quote||'"';if(t!=='"'&&t!=="'")throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function IMe(e,t,n,r){const s=b3(n),a=s==='"'?"Quote":"Apostrophe",o=n.enter("definition");let i=n.enter("label");const c=n.createTracker(r);let u=c.move("[");return u+=c.move(n.safe(n.associationId(e),{before:u,after:"]",...c.current()})),u+=c.move("]: "),i(),!e.url||/[\0- \u007F]/.test(e.url)?(i=n.enter("destinationLiteral"),u+=c.move("<"),u+=c.move(n.safe(e.url,{before:u,after:">",...c.current()})),u+=c.move(">")):(i=n.enter("destinationRaw"),u+=c.move(n.safe(e.url,{before:u,after:e.title?" ":`
`,...c.current()}))),i(),e.title&&(i=n.enter(`title${a}`),u+=c.move(" "+s),u+=c.move(n.safe(e.title,{before:u,after:s,...c.current()})),u+=c.move(s),i()),o(),u}function jMe(e){const t=e.options.emphasis||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}function kf(e){return"&#x"+e.toString(16).toUpperCase()+";"}function bg(e,t,n){const r=su(e),s=su(t);return r===void 0?s===void 0?n==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}HB.peek=PMe;function HB(e,t,n,r){const s=jMe(n),a=n.enter("emphasis"),o=n.createTracker(r),i=o.move(s);let c=o.move(n.containerPhrasing(e,{after:s,before:i,...o.current()}));const u=c.charCodeAt(0),d=bg(r.before.charCodeAt(r.before.length-1),u,s);d.inside&&(c=kf(u)+c.slice(1));const m=c.charCodeAt(c.length-1),p=bg(r.after.charCodeAt(0),m,s);p.inside&&(c=c.slice(0,-1)+kf(m));const h=o.move(s);return a(),n.attentionEncodeSurroundingInfo={after:p.outside,before:d.outside},i+c+h}function PMe(e,t,n){return n.options.emphasis||"*"}function OMe(e,t){let n=!1;return Bn(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return n=!0,sv}),!!((!e.depth||e.depth<3)&&u3(e)&&(t.options.setext||n))}function LMe(e,t,n,r){const s=Math.max(Math.min(6,e.depth||1),1),a=n.createTracker(r);if(OMe(e,n)){const d=n.enter("headingSetext"),m=n.enter("phrasing"),p=n.containerPhrasing(e,{...a.current(),before:`
`,after:`
`});return m(),d(),p+`
`+(s===1?"=":"-").repeat(p.length-(Math.max(p.lastIndexOf("\r"),p.lastIndexOf(`
`))+1))}const o="#".repeat(s),i=n.enter("headingAtx"),c=n.enter("phrasing");a.move(o+" ");let u=n.containerPhrasing(e,{before:"# ",after:`
`,...a.current()});return/^[\t ]/.test(u)&&(u=kf(u.charCodeAt(0))+u.slice(1)),u=u?o+" "+u:o,n.options.closeAtx&&(u+=" "+o),c(),i(),u}VB.peek=FMe;function VB(e){return e.value||""}function FMe(){return"<"}GB.peek=UMe;function GB(e,t,n,r){const s=b3(n),a=s==='"'?"Quote":"Apostrophe",o=n.enter("image");let i=n.enter("label");const c=n.createTracker(r);let u=c.move("![");return u+=c.move(n.safe(e.alt,{before:u,after:"]",...c.current()})),u+=c.move("]("),i(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(i=n.enter("destinationLiteral"),u+=c.move("<"),u+=c.move(n.safe(e.url,{before:u,after:">",...c.current()})),u+=c.move(">")):(i=n.enter("destinationRaw"),u+=c.move(n.safe(e.url,{before:u,after:e.title?" ":")",...c.current()}))),i(),e.title&&(i=n.enter(`title${a}`),u+=c.move(" "+s),u+=c.move(n.safe(e.title,{before:u,after:s,...c.current()})),u+=c.move(s),i()),u+=c.move(")"),o(),u}function UMe(){return"!"}zB.peek=BMe;function zB(e,t,n,r){const s=e.referenceType,a=n.enter("imageReference");let o=n.enter("label");const i=n.createTracker(r);let c=i.move("![");const u=n.safe(e.alt,{before:c,after:"]",...i.current()});c+=i.move(u+"]["),o();const d=n.stack;n.stack=[],o=n.enter("reference");const m=n.safe(n.associationId(e),{before:c,after:"]",...i.current()});return o(),n.stack=d,a(),s==="full"||!u||u!==m?c+=i.move(m+"]"):s==="shortcut"?c=c.slice(0,-1):c+=i.move("]"),c}function BMe(){return"!"}qB.peek=HMe;function qB(e,t,n){let r=e.value||"",s="`",a=-1;for(;new RegExp("(^|[^`])"+s+"([^`]|$)").test(r);)s+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++a<n.unsafe.length;){const o=n.unsafe[a],i=n.compilePattern(o);let c;if(o.atBreak)for(;c=i.exec(r);){let u=c.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(c.index+1)}}return s+r+s}function HMe(){return"`"}function $B(e,t){const n=u3(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(n===e.url||"mailto:"+n===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}WB.peek=VMe;function WB(e,t,n,r){const s=b3(n),a=s==='"'?"Quote":"Apostrophe",o=n.createTracker(r);let i,c;if($B(e,n)){const d=n.stack;n.stack=[],i=n.enter("autolink");let m=o.move("<");return m+=o.move(n.containerPhrasing(e,{before:m,after:">",...o.current()})),m+=o.move(">"),i(),n.stack=d,m}i=n.enter("link"),c=n.enter("label");let u=o.move("[");return u+=o.move(n.containerPhrasing(e,{before:u,after:"](",...o.current()})),u+=o.move("]("),c(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(c=n.enter("destinationLiteral"),u+=o.move("<"),u+=o.move(n.safe(e.url,{before:u,after:">",...o.current()})),u+=o.move(">")):(c=n.enter("destinationRaw"),u+=o.move(n.safe(e.url,{before:u,after:e.title?" ":")",...o.current()}))),c(),e.title&&(c=n.enter(`title${a}`),u+=o.move(" "+s),u+=o.move(n.safe(e.title,{before:u,after:s,...o.current()})),u+=o.move(s),c()),u+=o.move(")"),i(),u}function VMe(e,t,n){return $B(e,n)?"<":"["}KB.peek=GMe;function KB(e,t,n,r){const s=e.referenceType,a=n.enter("linkReference");let o=n.enter("label");const i=n.createTracker(r);let c=i.move("[");const u=n.containerPhrasing(e,{before:c,after:"]",...i.current()});c+=i.move(u+"]["),o();const d=n.stack;n.stack=[],o=n.enter("reference");const m=n.safe(n.associationId(e),{before:c,after:"]",...i.current()});return o(),n.stack=d,a(),s==="full"||!u||u!==m?c+=i.move(m+"]"):s==="shortcut"?c=c.slice(0,-1):c+=i.move("]"),c}function GMe(){return"["}function _3(e){const t=e.options.bullet||"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function zMe(e){const t=_3(e),n=e.options.bulletOther;if(!n)return t==="*"?"-":"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(n===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+n+"`) to be different");return n}function qMe(e){const t=e.options.bulletOrdered||".";if(t!=="."&&t!==")")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function YB(e){const t=e.options.rule||"*";if(t!=="*"&&t!=="-"&&t!=="_")throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function $Me(e,t,n,r){const s=n.enter("list"),a=n.bulletCurrent;let o=e.ordered?qMe(n):_3(n);const i=e.ordered?o==="."?")":".":zMe(n);let c=t&&n.bulletLastUsed?o===n.bulletLastUsed:!1;if(!e.ordered){const d=e.children?e.children[0]:void 0;if((o==="*"||o==="-")&&d&&(!d.children||!d.children[0])&&n.stack[n.stack.length-1]==="list"&&n.stack[n.stack.length-2]==="listItem"&&n.stack[n.stack.length-3]==="list"&&n.stack[n.stack.length-4]==="listItem"&&n.indexStack[n.indexStack.length-1]===0&&n.indexStack[n.indexStack.length-2]===0&&n.indexStack[n.indexStack.length-3]===0&&(c=!0),YB(n)===o&&d){let m=-1;for(;++m<e.children.length;){const p=e.children[m];if(p&&p.type==="listItem"&&p.children&&p.children[0]&&p.children[0].type==="thematicBreak"){c=!0;break}}}}c&&(o=i),n.bulletCurrent=o;const u=n.containerFlow(e,r);return n.bulletLastUsed=o,n.bulletCurrent=a,s(),u}function WMe(e){const t=e.options.listItemIndent||"one";if(t!=="tab"&&t!=="one"&&t!=="mixed")throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function KMe(e,t,n,r){const s=WMe(n);let a=n.bulletCurrent||_3(n);t&&t.type==="list"&&t.ordered&&(a=(typeof t.start=="number"&&t.start>-1?t.start:1)+(n.options.incrementListMarker===!1?0:t.children.indexOf(e))+a);let o=a.length+1;(s==="tab"||s==="mixed"&&(t&&t.type==="list"&&t.spread||e.spread))&&(o=Math.ceil(o/4)*4);const i=n.createTracker(r);i.move(a+" ".repeat(o-a.length)),i.shift(o);const c=n.enter("listItem"),u=n.indentLines(n.containerFlow(e,i.current()),d);return c(),u;function d(m,p,h){return p?(h?"":" ".repeat(o))+m:(h?a:a+" ".repeat(o-a.length))+m}}function YMe(e,t,n,r){const s=n.enter("paragraph"),a=n.enter("phrasing"),o=n.containerPhrasing(e,r);return a(),s(),o}const QMe=Iy(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function XMe(e,t,n,r){return(e.children.some(function(o){return QMe(o)})?n.containerPhrasing:n.containerFlow).call(n,e,r)}function ZMe(e){const t=e.options.strong||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}QB.peek=JMe;function QB(e,t,n,r){const s=ZMe(n),a=n.enter("strong"),o=n.createTracker(r),i=o.move(s+s);let c=o.move(n.containerPhrasing(e,{after:s,before:i,...o.current()}));const u=c.charCodeAt(0),d=bg(r.before.charCodeAt(r.before.length-1),u,s);d.inside&&(c=kf(u)+c.slice(1));const m=c.charCodeAt(c.length-1),p=bg(r.after.charCodeAt(0),m,s);p.inside&&(c=c.slice(0,-1)+kf(m));const h=o.move(s+s);return a(),n.attentionEncodeSurroundingInfo={after:p.outside,before:d.outside},i+c+h}function JMe(e,t,n){return n.options.strong||"*"}function eTe(e,t,n,r){return n.safe(e.value,r)}function tTe(e){const t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}function nTe(e,t,n){const r=(YB(n)+(n.options.ruleSpaces?" ":"")).repeat(tTe(n));return n.options.ruleSpaces?r.slice(0,-1):r}const XB={blockquote:kMe,break:UA,code:RMe,definition:IMe,emphasis:HB,hardBreak:UA,heading:LMe,html:VB,image:GB,imageReference:zB,inlineCode:qB,link:WB,linkReference:KB,list:$Me,listItem:KMe,paragraph:YMe,root:XMe,strong:QB,text:eTe,thematicBreak:nTe};function rTe(){return{enter:{table:sTe,tableData:BA,tableHeader:BA,tableRow:oTe},exit:{codeText:iTe,table:aTe,tableData:K1,tableHeader:K1,tableRow:K1}}}function sTe(e){const t=e._align;this.enter({type:"table",align:t.map(function(n){return n==="none"?null:n}),children:[]},e),this.data.inTable=!0}function aTe(e){this.exit(e),this.data.inTable=void 0}function oTe(e){this.enter({type:"tableRow",children:[]},e)}function K1(e){this.exit(e)}function BA(e){this.enter({type:"tableCell",children:[]},e)}function iTe(e){let t=this.resume();this.data.inTable&&(t=t.replace(/\\([\\|])/g,lTe));const n=this.stack[this.stack.length-1];n.type,n.value=t,this.exit(e)}function lTe(e,t){return t==="|"?t:e}function cTe(e){const t=e||{},n=t.tableCellPadding,r=t.tablePipeAlign,s=t.stringLength,a=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:p,table:o,tableCell:c,tableRow:i}};function o(h,g,y,b){return u(d(h,y,b),h.align)}function i(h,g,y,b){const x=m(h,y,b),_=u([x]);return _.slice(0,_.indexOf(`
`))}function c(h,g,y,b){const x=y.enter("tableCell"),_=y.enter("phrasing"),v=y.containerPhrasing(h,{...b,before:a,after:a});return _(),x(),v}function u(h,g){return SMe(h,{align:g,alignDelimiters:r,padding:n,stringLength:s})}function d(h,g,y){const b=h.children;let x=-1;const _=[],v=g.enter("table");for(;++x<b.length;)_[x]=m(b[x],g,y);return v(),_}function m(h,g,y){const b=h.children;let x=-1;const _=[],v=g.enter("tableRow");for(;++x<b.length;)_[x]=c(b[x],h,g,y);return v(),_}function p(h,g,y){let b=XB.inlineCode(h,g,y);return y.stack.includes("tableCell")&&(b=b.replace(/\|/g,"\\$&")),b}}function uTe(){return{exit:{taskListCheckValueChecked:HA,taskListCheckValueUnchecked:HA,paragraph:fTe}}}function dTe(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:mTe}}}function HA(e){const t=this.stack[this.stack.length-2];t.type,t.checked=e.type==="taskListCheckValueChecked"}function fTe(e){const t=this.stack[this.stack.length-2];if(t&&t.type==="listItem"&&typeof t.checked=="boolean"){const n=this.stack[this.stack.length-1];n.type;const r=n.children[0];if(r&&r.type==="text"){const s=t.children;let a=-1,o;for(;++a<s.length;){const i=s[a];if(i.type==="paragraph"){o=i;break}}o===n&&(r.value=r.value.slice(1),r.value.length===0?n.children.shift():n.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,n.position.start=Object.assign({},r.position.start)))}}this.exit(e)}function mTe(e,t,n,r){const s=e.children[0],a=typeof e.checked=="boolean"&&s&&s.type==="paragraph",o="["+(e.checked?"x":" ")+"] ",i=n.createTracker(r);a&&i.move(o);let c=XB.listItem(e,t,n,{...r,...i.current()});return a&&(c=c.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,u)),c;function u(d){return d+o}}function pTe(){return[W4e(),pMe(),xMe(),rTe(),uTe()]}function hTe(e){return{extensions:[K4e(),hMe(e),bMe(),cTe(e),dTe()]}}const gTe={tokenize:CTe,partial:!0},ZB={tokenize:wTe,partial:!0},JB={tokenize:STe,partial:!0},eH={tokenize:ETe,partial:!0},yTe={tokenize:kTe,partial:!0},tH={name:"wwwAutolink",tokenize:_Te,previous:rH},nH={name:"protocolAutolink",tokenize:vTe,previous:sH},Lo={name:"emailAutolink",tokenize:bTe,previous:aH},so={};function xTe(){return{text:so}}let Hi=48;for(;Hi<123;)so[Hi]=Lo,Hi++,Hi===58?Hi=65:Hi===91&&(Hi=97);so[43]=Lo;so[45]=Lo;so[46]=Lo;so[95]=Lo;so[72]=[Lo,nH];so[104]=[Lo,nH];so[87]=[Lo,tH];so[119]=[Lo,tH];function bTe(e,t,n){const r=this;let s,a;return o;function o(m){return!lv(m)||!aH.call(r,r.previous)||v3(r.events)?n(m):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),i(m))}function i(m){return lv(m)?(e.consume(m),i):m===64?(e.consume(m),c):n(m)}function c(m){return m===46?e.check(yTe,d,u)(m):m===45||m===95||Mr(m)?(a=!0,e.consume(m),c):d(m)}function u(m){return e.consume(m),s=!0,c}function d(m){return a&&s&&Pr(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(m)):n(m)}}function _Te(e,t,n){const r=this;return s;function s(o){return o!==87&&o!==119||!rH.call(r,r.previous)||v3(r.events)?n(o):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(gTe,e.attempt(ZB,e.attempt(JB,a),n),n)(o))}function a(o){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(o)}}function vTe(e,t,n){const r=this;let s="",a=!1;return o;function o(m){return(m===72||m===104)&&sH.call(r,r.previous)&&!v3(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),s+=String.fromCodePoint(m),e.consume(m),i):n(m)}function i(m){if(Pr(m)&&s.length<5)return s+=String.fromCodePoint(m),e.consume(m),i;if(m===58){const p=s.toLowerCase();if(p==="http"||p==="https")return e.consume(m),c}return n(m)}function c(m){return m===47?(e.consume(m),a?u:(a=!0,c)):n(m)}function u(m){return m===null||yg(m)||bn(m)||vl(m)||Ny(m)?n(m):e.attempt(ZB,e.attempt(JB,d),n)(m)}function d(m){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(m)}}function CTe(e,t,n){let r=0;return s;function s(o){return(o===87||o===119)&&r<3?(r++,e.consume(o),s):o===46&&r===3?(e.consume(o),a):n(o)}function a(o){return o===null?n(o):t(o)}}function wTe(e,t,n){let r,s,a;return o;function o(u){return u===46||u===95?e.check(eH,c,i)(u):u===null||bn(u)||vl(u)||u!==45&&Ny(u)?c(u):(a=!0,e.consume(u),o)}function i(u){return u===95?r=!0:(s=r,r=void 0),e.consume(u),o}function c(u){return s||r||!a?n(u):t(u)}}function STe(e,t){let n=0,r=0;return s;function s(o){return o===40?(n++,e.consume(o),s):o===41&&r<n?a(o):o===33||o===34||o===38||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===60||o===63||o===93||o===95||o===126?e.check(eH,t,a)(o):o===null||bn(o)||vl(o)?t(o):(e.consume(o),s)}function a(o){return o===41&&r++,e.consume(o),s}}function ETe(e,t,n){return r;function r(i){return i===33||i===34||i===39||i===41||i===42||i===44||i===46||i===58||i===59||i===63||i===95||i===126?(e.consume(i),r):i===38?(e.consume(i),a):i===93?(e.consume(i),s):i===60||i===null||bn(i)||vl(i)?t(i):n(i)}function s(i){return i===null||i===40||i===91||bn(i)||vl(i)?t(i):r(i)}function a(i){return Pr(i)?o(i):n(i)}function o(i){return i===59?(e.consume(i),r):Pr(i)?(e.consume(i),o):n(i)}}function kTe(e,t,n){return r;function r(a){return e.consume(a),s}function s(a){return Mr(a)?n(a):t(a)}}function rH(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||bn(e)}function sH(e){return!Pr(e)}function aH(e){return!(e===47||lv(e))}function lv(e){return e===43||e===45||e===46||e===95||Mr(e)}function v3(e){let t=e.length,n=!1;for(;t--;){const r=e[t][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){n=!0;break}if(r._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}const MTe={tokenize:PTe,partial:!0};function TTe(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:DTe,continuation:{tokenize:ITe},exit:jTe}},text:{91:{name:"gfmFootnoteCall",tokenize:RTe},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:ATe,resolveTo:NTe}}}}function ATe(e,t,n){const r=this;let s=r.events.length;const a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o;for(;s--;){const c=r.events[s][1];if(c.type==="labelImage"){o=c;break}if(c.type==="gfmFootnoteCall"||c.type==="labelLink"||c.type==="label"||c.type==="image"||c.type==="link")break}return i;function i(c){if(!o||!o._balanced)return n(c);const u=ua(r.sliceSerialize({start:o.end,end:r.now()}));return u.codePointAt(0)!==94||!a.includes(u.slice(1))?n(c):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(c),e.exit("gfmFootnoteCallLabelMarker"),t(c))}}function NTe(e,t){let n=e.length;for(;n--;)if(e[n][1].type==="labelImage"&&e[n][0]==="enter"){e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},s={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};s.end.column++,s.end.offset++,s.end._bufferIndex++;const a={type:"gfmFootnoteCallString",start:Object.assign({},s.end),end:Object.assign({},e[e.length-1][1].start)},o={type:"chunkString",contentType:"string",start:Object.assign({},a.start),end:Object.assign({},a.end)},i=[e[n+1],e[n+2],["enter",r,t],e[n+3],e[n+4],["enter",s,t],["exit",s,t],["enter",a,t],["enter",o,t],["exit",o,t],["exit",a,t],e[e.length-2],e[e.length-1],["exit",r,t]];return e.splice(n,e.length-n+1,...i),e}function RTe(e,t,n){const r=this,s=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let a=0,o;return i;function i(m){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(m),e.exit("gfmFootnoteCallLabelMarker"),c}function c(m){return m!==94?n(m):(e.enter("gfmFootnoteCallMarker"),e.consume(m),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",u)}function u(m){if(a>999||m===93&&!o||m===null||m===91||bn(m))return n(m);if(m===93){e.exit("chunkString");const p=e.exit("gfmFootnoteCallString");return s.includes(ua(r.sliceSerialize(p)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(m),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):n(m)}return bn(m)||(o=!0),a++,e.consume(m),m===92?d:u}function d(m){return m===91||m===92||m===93?(e.consume(m),a++,u):u(m)}}function DTe(e,t,n){const r=this,s=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let a,o=0,i;return c;function c(g){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(g){return g===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",d):n(g)}function d(g){if(o>999||g===93&&!i||g===null||g===91||bn(g))return n(g);if(g===93){e.exit("chunkString");const y=e.exit("gfmFootnoteDefinitionLabelString");return a=ua(r.sliceSerialize(y)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),p}return bn(g)||(i=!0),o++,e.consume(g),g===92?m:d}function m(g){return g===91||g===92||g===93?(e.consume(g),o++,d):d(g)}function p(g){return g===58?(e.enter("definitionMarker"),e.consume(g),e.exit("definitionMarker"),s.includes(a)||s.push(a),Nt(e,h,"gfmFootnoteDefinitionWhitespace")):n(g)}function h(g){return t(g)}}function ITe(e,t,n){return e.check(Mm,t,e.attempt(MTe,t,n))}function jTe(e){e.exit("gfmFootnoteDefinition")}function PTe(e,t,n){const r=this;return Nt(e,s,"gfmFootnoteDefinitionIndent",5);function s(a){const o=r.events[r.events.length-1];return o&&o[1].type==="gfmFootnoteDefinitionIndent"&&o[2].sliceSerialize(o[1],!0).length===4?t(a):n(a)}}function OTe(e){let n=(e||{}).singleTilde;const r={name:"strikethrough",tokenize:a,resolveAll:s};return n==null&&(n=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function s(o,i){let c=-1;for(;++c<o.length;)if(o[c][0]==="enter"&&o[c][1].type==="strikethroughSequenceTemporary"&&o[c][1]._close){let u=c;for(;u--;)if(o[u][0]==="exit"&&o[u][1].type==="strikethroughSequenceTemporary"&&o[u][1]._open&&o[c][1].end.offset-o[c][1].start.offset===o[u][1].end.offset-o[u][1].start.offset){o[c][1].type="strikethroughSequence",o[u][1].type="strikethroughSequence";const d={type:"strikethrough",start:Object.assign({},o[u][1].start),end:Object.assign({},o[c][1].end)},m={type:"strikethroughText",start:Object.assign({},o[u][1].end),end:Object.assign({},o[c][1].start)},p=[["enter",d,i],["enter",o[u][1],i],["exit",o[u][1],i],["enter",m,i]],h=i.parser.constructs.insideSpan.null;h&&gs(p,p.length,0,Ry(h,o.slice(u+1,c),i)),gs(p,p.length,0,[["exit",m,i],["enter",o[c][1],i],["exit",o[c][1],i],["exit",d,i]]),gs(o,u-1,c-u+3,p),c=u+p.length-2;break}}for(c=-1;++c<o.length;)o[c][1].type==="strikethroughSequenceTemporary"&&(o[c][1].type="data");return o}function a(o,i,c){const u=this.previous,d=this.events;let m=0;return p;function p(g){return u===126&&d[d.length-1][1].type!=="characterEscape"?c(g):(o.enter("strikethroughSequenceTemporary"),h(g))}function h(g){const y=su(u);if(g===126)return m>1?c(g):(o.consume(g),m++,h);if(m<2&&!n)return c(g);const b=o.exit("strikethroughSequenceTemporary"),x=su(g);return b._open=!x||x===2&&!!y,b._close=!y||y===2&&!!x,i(g)}}}class LTe{constructor(){this.map=[]}add(t,n,r){FTe(this,t,n,r)}consume(t){if(this.map.sort(function(a,o){return a[0]-o[0]}),this.map.length===0)return;let n=this.map.length;const r=[];for(;n>0;)n-=1,r.push(t.slice(this.map[n][0]+this.map[n][1]),this.map[n][2]),t.length=this.map[n][0];r.push(t.slice()),t.length=0;let s=r.pop();for(;s;){for(const a of s)t.push(a);s=r.pop()}this.map.length=0}}function FTe(e,t,n,r){let s=0;if(!(n===0&&r.length===0)){for(;s<e.map.length;){if(e.map[s][0]===t){e.map[s][1]+=n,e.map[s][2].push(...r);return}s+=1}e.map.push([t,n,r])}}function UTe(e,t){let n=!1;const r=[];for(;t<e.length;){const s=e[t];if(n){if(s[0]==="enter")s[1].type==="tableContent"&&r.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(s[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){const a=r.length-1;r[a]=r[a]==="left"?"center":"right"}}else if(s[1].type==="tableDelimiterRow")break}else s[0]==="enter"&&s[1].type==="tableDelimiterRow"&&(n=!0);t+=1}return r}function BTe(){return{flow:{null:{name:"table",tokenize:HTe,resolveAll:VTe}}}}function HTe(e,t,n){const r=this;let s=0,a=0,o;return i;function i(M){let N=r.events.length-1;for(;N>-1;){const L=r.events[N][1].type;if(L==="lineEnding"||L==="linePrefix")N--;else break}const P=N>-1?r.events[N][1].type:null,O=P==="tableHead"||P==="tableRow"?S:c;return O===S&&r.parser.lazy[r.now().line]?n(M):O(M)}function c(M){return e.enter("tableHead"),e.enter("tableRow"),u(M)}function u(M){return M===124||(o=!0,a+=1),d(M)}function d(M){return M===null?n(M):Xe(M)?a>1?(a=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(M),e.exit("lineEnding"),h):n(M):Ot(M)?Nt(e,d,"whitespace")(M):(a+=1,o&&(o=!1,s+=1),M===124?(e.enter("tableCellDivider"),e.consume(M),e.exit("tableCellDivider"),o=!0,d):(e.enter("data"),m(M)))}function m(M){return M===null||M===124||bn(M)?(e.exit("data"),d(M)):(e.consume(M),M===92?p:m)}function p(M){return M===92||M===124?(e.consume(M),m):m(M)}function h(M){return r.interrupt=!1,r.parser.lazy[r.now().line]?n(M):(e.enter("tableDelimiterRow"),o=!1,Ot(M)?Nt(e,g,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(M):g(M))}function g(M){return M===45||M===58?b(M):M===124?(o=!0,e.enter("tableCellDivider"),e.consume(M),e.exit("tableCellDivider"),y):w(M)}function y(M){return Ot(M)?Nt(e,b,"whitespace")(M):b(M)}function b(M){return M===58?(a+=1,o=!0,e.enter("tableDelimiterMarker"),e.consume(M),e.exit("tableDelimiterMarker"),x):M===45?(a+=1,x(M)):M===null||Xe(M)?C(M):w(M)}function x(M){return M===45?(e.enter("tableDelimiterFiller"),_(M)):w(M)}function _(M){return M===45?(e.consume(M),_):M===58?(o=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(M),e.exit("tableDelimiterMarker"),v):(e.exit("tableDelimiterFiller"),v(M))}function v(M){return Ot(M)?Nt(e,C,"whitespace")(M):C(M)}function C(M){return M===124?g(M):M===null||Xe(M)?!o||s!==a?w(M):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(M)):w(M)}function w(M){return n(M)}function S(M){return e.enter("tableRow"),E(M)}function E(M){return M===124?(e.enter("tableCellDivider"),e.consume(M),e.exit("tableCellDivider"),E):M===null||Xe(M)?(e.exit("tableRow"),t(M)):Ot(M)?Nt(e,E,"whitespace")(M):(e.enter("data"),T(M))}function T(M){return M===null||M===124||bn(M)?(e.exit("data"),E(M)):(e.consume(M),M===92?k:T)}function k(M){return M===92||M===124?(e.consume(M),T):T(M)}}function VTe(e,t){let n=-1,r=!0,s=0,a=[0,0,0,0],o=[0,0,0,0],i=!1,c=0,u,d,m;const p=new LTe;for(;++n<e.length;){const h=e[n],g=h[1];h[0]==="enter"?g.type==="tableHead"?(i=!1,c!==0&&(VA(p,t,c,u,d),d=void 0,c=0),u={type:"table",start:Object.assign({},g.start),end:Object.assign({},g.end)},p.add(n,0,[["enter",u,t]])):g.type==="tableRow"||g.type==="tableDelimiterRow"?(r=!0,m=void 0,a=[0,0,0,0],o=[0,n+1,0,0],i&&(i=!1,d={type:"tableBody",start:Object.assign({},g.start),end:Object.assign({},g.end)},p.add(n,0,[["enter",d,t]])),s=g.type==="tableDelimiterRow"?2:d?3:1):s&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")?(r=!1,o[2]===0&&(a[1]!==0&&(o[0]=o[1],m=kp(p,t,a,s,void 0,m),a=[0,0,0,0]),o[2]=n)):g.type==="tableCellDivider"&&(r?r=!1:(a[1]!==0&&(o[0]=o[1],m=kp(p,t,a,s,void 0,m)),a=o,o=[a[1],n,0,0])):g.type==="tableHead"?(i=!0,c=n):g.type==="tableRow"||g.type==="tableDelimiterRow"?(c=n,a[1]!==0?(o[0]=o[1],m=kp(p,t,a,s,n,m)):o[1]!==0&&(m=kp(p,t,o,s,n,m)),s=0):s&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")&&(o[3]=n)}for(c!==0&&VA(p,t,c,u,d),p.consume(t.events),n=-1;++n<t.events.length;){const h=t.events[n];h[0]==="enter"&&h[1].type==="table"&&(h[1]._align=UTe(t.events,n))}return e}function kp(e,t,n,r,s,a){const o=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",i="tableContent";n[0]!==0&&(a.end=Object.assign({},hc(t.events,n[0])),e.add(n[0],0,[["exit",a,t]]));const c=hc(t.events,n[1]);if(a={type:o,start:Object.assign({},c),end:Object.assign({},c)},e.add(n[1],0,[["enter",a,t]]),n[2]!==0){const u=hc(t.events,n[2]),d=hc(t.events,n[3]),m={type:i,start:Object.assign({},u),end:Object.assign({},d)};if(e.add(n[2],0,[["enter",m,t]]),r!==2){const p=t.events[n[2]],h=t.events[n[3]];if(p[1].end=Object.assign({},h[1].end),p[1].type="chunkText",p[1].contentType="text",n[3]>n[2]+1){const g=n[2]+1,y=n[3]-n[2]-1;e.add(g,y,[])}}e.add(n[3]+1,0,[["exit",m,t]])}return s!==void 0&&(a.end=Object.assign({},hc(t.events,s)),e.add(s,0,[["exit",a,t]]),a=void 0),a}function VA(e,t,n,r,s){const a=[],o=hc(t.events,n);s&&(s.end=Object.assign({},o),a.push(["exit",s,t])),r.end=Object.assign({},o),a.push(["exit",r,t]),e.add(n+1,0,a)}function hc(e,t){const n=e[t],r=n[0]==="enter"?"start":"end";return n[1][r]}const GTe={name:"tasklistCheck",tokenize:qTe};function zTe(){return{text:{91:GTe}}}function qTe(e,t,n){const r=this;return s;function s(c){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?n(c):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(c),e.exit("taskListCheckMarker"),a)}function a(c){return bn(c)?(e.enter("taskListCheckValueUnchecked"),e.consume(c),e.exit("taskListCheckValueUnchecked"),o):c===88||c===120?(e.enter("taskListCheckValueChecked"),e.consume(c),e.exit("taskListCheckValueChecked"),o):n(c)}function o(c){return c===93?(e.enter("taskListCheckMarker"),e.consume(c),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),i):n(c)}function i(c){return Xe(c)?t(c):Ot(c)?e.check({tokenize:$Te},t,n)(c):n(c)}}function $Te(e,t,n){return Nt(e,r,"whitespace");function r(s){return s===null?n(s):t(s)}}function WTe(e){return fB([xTe(),TTe(),OTe(e),BTe(),zTe()])}const KTe={};function YTe(e){const t=this,n=e||KTe,r=t.data(),s=r.micromarkExtensions||(r.micromarkExtensions=[]),a=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),o=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);s.push(WTe(n)),a.push(pTe()),o.push(hTe(n))}function QTe(){return{enter:{mathFlow:e,mathFlowFenceMeta:t,mathText:a},exit:{mathFlow:s,mathFlowFence:r,mathFlowFenceMeta:n,mathFlowValue:i,mathText:o,mathTextData:i}};function e(c){const u={type:"element",tagName:"code",properties:{className:["language-math","math-display"]},children:[]};this.enter({type:"math",meta:null,value:"",data:{hName:"pre",hChildren:[u]}},c)}function t(){this.buffer()}function n(){const c=this.resume(),u=this.stack[this.stack.length-1];u.type,u.meta=c}function r(){this.data.mathFlowInside||(this.buffer(),this.data.mathFlowInside=!0)}function s(c){const u=this.resume().replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),d=this.stack[this.stack.length-1];d.type,this.exit(c),d.value=u;const m=d.data.hChildren[0];m.type,m.tagName,m.children.push({type:"text",value:u}),this.data.mathFlowInside=void 0}function a(c){this.enter({type:"inlineMath",value:"",data:{hName:"code",hProperties:{className:["language-math","math-inline"]},hChildren:[]}},c),this.buffer()}function o(c){const u=this.resume(),d=this.stack[this.stack.length-1];d.type,this.exit(c),d.value=u,d.data.hChildren.push({type:"text",value:u})}function i(c){this.config.enter.data.call(this,c),this.config.exit.data.call(this,c)}}function XTe(e){let t=(e||{}).singleDollarTextMath;return t==null&&(t=!0),r.peek=s,{unsafe:[{character:"\r",inConstruct:"mathFlowMeta"},{character:`
`,inConstruct:"mathFlowMeta"},{character:"$",after:t?void 0:"\\$",inConstruct:"phrasing"},{character:"$",inConstruct:"mathFlowMeta"},{atBreak:!0,character:"$",after:"\\$"}],handlers:{math:n,inlineMath:r}};function n(a,o,i,c){const u=a.value||"",d=i.createTracker(c),m="$".repeat(Math.max(BB(u,"$")+1,2)),p=i.enter("mathFlow");let h=d.move(m);if(a.meta){const g=i.enter("mathFlowMeta");h+=d.move(i.safe(a.meta,{after:`
`,before:h,encode:["$"],...d.current()})),g()}return h+=d.move(`
`),u&&(h+=d.move(u+`
`)),h+=d.move(m),p(),h}function r(a,o,i){let c=a.value||"",u=1;for(t||u++;new RegExp("(^|[^$])"+"\\$".repeat(u)+"([^$]|$)").test(c);)u++;const d="$".repeat(u);/[^ \r\n]/.test(c)&&(/^[ \r\n]/.test(c)&&/[ \r\n]$/.test(c)||/^\$|\$$/.test(c))&&(c=" "+c+" ");let m=-1;for(;++m<i.unsafe.length;){const p=i.unsafe[m];if(!p.atBreak)continue;const h=i.compilePattern(p);let g;for(;g=h.exec(c);){let y=g.index;c.codePointAt(y)===10&&c.codePointAt(y-1)===13&&y--,c=c.slice(0,y)+" "+c.slice(g.index+1)}}return d+c+d}function s(){return"$"}}const ZTe={tokenize:JTe,concrete:!0,name:"mathFlow"},GA={tokenize:eAe,partial:!0};function JTe(e,t,n){const r=this,s=r.events[r.events.length-1],a=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0;let o=0;return i;function i(_){return e.enter("mathFlow"),e.enter("mathFlowFence"),e.enter("mathFlowFenceSequence"),c(_)}function c(_){return _===36?(e.consume(_),o++,c):o<2?n(_):(e.exit("mathFlowFenceSequence"),Nt(e,u,"whitespace")(_))}function u(_){return _===null||Xe(_)?m(_):(e.enter("mathFlowFenceMeta"),e.enter("chunkString",{contentType:"string"}),d(_))}function d(_){return _===null||Xe(_)?(e.exit("chunkString"),e.exit("mathFlowFenceMeta"),m(_)):_===36?n(_):(e.consume(_),d)}function m(_){return e.exit("mathFlowFence"),r.interrupt?t(_):e.attempt(GA,p,b)(_)}function p(_){return e.attempt({tokenize:x,partial:!0},b,h)(_)}function h(_){return(a?Nt(e,g,"linePrefix",a+1):g)(_)}function g(_){return _===null?b(_):Xe(_)?e.attempt(GA,p,b)(_):(e.enter("mathFlowValue"),y(_))}function y(_){return _===null||Xe(_)?(e.exit("mathFlowValue"),g(_)):(e.consume(_),y)}function b(_){return e.exit("mathFlow"),t(_)}function x(_,v,C){let w=0;return Nt(_,S,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4);function S(k){return _.enter("mathFlowFence"),_.enter("mathFlowFenceSequence"),E(k)}function E(k){return k===36?(w++,_.consume(k),E):w<o?C(k):(_.exit("mathFlowFenceSequence"),Nt(_,T,"whitespace")(k))}function T(k){return k===null||Xe(k)?(_.exit("mathFlowFence"),v(k)):C(k)}}}function eAe(e,t,n){const r=this;return s;function s(o){return o===null?t(o):(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a)}function a(o){return r.parser.lazy[r.now().line]?n(o):t(o)}}const tAe={tokenize:nAe,concrete:!0,name:"mathFlowLatex"},zA={tokenize:rAe,partial:!0};function nAe(e,t,n){const r=this,s=r.events[r.events.length-1],a=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0;let o=!1,i=!1;return c;function c(_){return e.enter("mathFlow"),e.enter("mathFlowFence"),e.enter("mathFlowFenceSequence"),e.consume(_),u}function u(_){return _===91?(e.consume(_),e.exit("mathFlowFenceSequence"),d):n(_)}function d(_){return _===null||Xe(_)?(e.exit("mathFlowFence"),r.interrupt?t(_):e.attempt(zA,m,b)(_)):n(_)}function m(_){return e.attempt({tokenize:x,partial:!0},b,p)(_)}function p(_){return(a?Nt(e,h,"linePrefix",a+1):h)(_)}function h(_){return _===null?b(_):Xe(_)?e.attempt(zA,m,b)(_):(i||(e.enter("mathFlowValue"),o=!1,i=!0),g(_))}function g(_){return _===null||Xe(_)?(o&&(e.exit("mathFlowValue"),i=!1,o=!1),h(_)):_===92&&o?(e.exit("mathFlowValue"),i=!1,e.attempt({tokenize:x,partial:!0},b,y)(_)):(e.consume(_),o=!0,g)}function y(_){return e.enter("mathFlowValue"),i=!0,e.consume(_),o=!0,g}function b(_){return e.exit("mathFlow"),t(_)}function x(_,v,C){return Nt(_,w,"linePrefix",r.parser.constructs.disable.null&&r.parser.constructs.disable.null.includes("codeIndented")?void 0:4);function w(k){return k===92?(_.enter("mathFlowFence"),_.enter("mathFlowFenceSequence"),_.consume(k),S):C(k)}function S(k){return k===93?(_.consume(k),_.exit("mathFlowFenceSequence"),Nt(_,E,"whitespace")):C(k)}function E(k){return _.exit("mathFlowFence"),k===null||Xe(k)?v(k):(_.enter("mathFlowTrailing"),T(k))}function T(k){return k===null||Xe(k)?(_.exit("mathFlowTrailing"),v(k)):(_.consume(k),T)}}}function rAe(e,t,n){const r=this;return s;function s(o){return o===null?t(o):(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a)}function a(o){return r.parser.lazy[r.now().line]?n(o):t(o)}}function sAe(e){let n=(e||{}).singleDollarTextMath;return n==null&&(n=!0),{tokenize:r,resolve:aAe,previous:oAe,name:"mathText"};function r(s,a,o){let i=0,c,u;return d;function d(y){return s.enter("mathText"),s.enter("mathTextSequence"),m(y)}function m(y){return y===36?(s.consume(y),i++,m):i<2&&!n?o(y):(s.exit("mathTextSequence"),p(y))}function p(y){return y===null?o(y):y===36?(u=s.enter("mathTextSequence"),c=0,g(y)):y===32?(s.enter("space"),s.consume(y),s.exit("space"),p):Xe(y)?(s.enter("lineEnding"),s.consume(y),s.exit("lineEnding"),p):(s.enter("mathTextData"),h(y))}function h(y){return y===null||y===32||y===36||Xe(y)?(s.exit("mathTextData"),p(y)):(s.consume(y),h)}function g(y){return y===36?(s.consume(y),c++,g):c===i?(s.exit("mathTextSequence"),s.exit("mathText"),a(y)):(u.type="mathTextData",h(y))}}}function aAe(e){let t=e.length-4,n=3,r,s;if((e[n][1].type==="lineEnding"||e[n][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(r=n;++r<t;)if(e[r][1].type==="mathTextData"){e[t][1].type="mathTextPadding",e[n][1].type="mathTextPadding",n+=2,t-=2;break}}for(r=n-1,t++;++r<=t;)s===void 0?r!==t&&e[r][1].type!=="lineEnding"&&(s=r):(r===t||e[r][1].type==="lineEnding")&&(e[s][1].type="mathTextData",r!==s+2&&(e[s][1].end=e[r-1][1].end,e.splice(s+2,r-s-2),t-=r-s-2,r=s+2),s=void 0);return e}function oAe(e){return e!==36||this.events[this.events.length-1][1].type==="characterEscape"}const iAe={tokenize:lAe,resolve:cAe,previous:uAe,name:"mathTextLatex"};function lAe(e,t,n){let r,s,a;return o;function o(m){return s=e.enter("mathText"),e.enter("mathTextSequence"),e.consume(m),i}function i(m){return m===40||m===91?(a=m,e.consume(m),e.exit("mathTextSequence"),c):n(m)}function c(m){return m===null?n(m):m===92?(r=e.enter("mathTextSequence"),e.consume(m),d):m===32?(e.enter("space"),e.consume(m),e.exit("space"),c):Xe(m)?(e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),c):(e.enter("mathTextData"),u(m))}function u(m){return m===null||m===32||m===92||Xe(m)?(e.exit("mathTextData"),c(m)):(e.consume(m),u)}function d(m){return m===(a===91?93:41)?(e.consume(m),e.exit("mathTextSequence"),e.exit(s.type),t):(r.type="mathTextData",u(m))}}function cAe(e){let t=e.length-4,n=3,r,s;if((e[n][1].type==="lineEnding"||e[n][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(r=n;++r<t;)if(e[r][1].type==="mathTextData"){e[t][1].type="mathTextPadding",e[n][1].type="mathTextPadding",n+=2,t-=2;break}}for(r=n-1,t++;++r<=t;)s===void 0?r!==t&&e[r][1].type!=="lineEnding"&&(s=r):(r===t||e[r][1].type==="lineEnding")&&(e[s][1].type="mathTextData",r!==s+2&&(e[s][1].end=e[r-1][1].end,e.splice(s+2,r-s-2),t-=r-s-2,r=s+2),s=void 0);return e}function uAe(e){return e!==92||this.events[this.events.length-1][1].type==="characterEscape"}function dAe(e){return{flow:{36:ZTe,92:tAe},text:{36:sAe(e),92:iAe}}}const fAe={};function mAe(e){const t=this,n=e||fAe,r=t.data(),s=r.micromarkExtensions||(r.micromarkExtensions=[]),a=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),o=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);s.push(dAe(n)),a.push(QTe()),o.push(XTe(n))}const pAe=({title:e,url:t,citationUrl:n,domain:r,iconUrl:s,variant:a="small",textColor:o="light",className:i=""})=>t?l.jsxs(B,{variant:a,color:o,className:i,title:e,children:[e," ",l.jsx("span",{className:"inline-block max-w-[15ch] -mt-1",children:l.jsx(aF,{domain:r,url:t,href:n||t,linkBehavior:"external",textColor:o==="white"?"white":void 0,iconUrl:s})})]}):l.jsx(B,{variant:a,color:o,className:i,title:e,children:e}),oH=A.memo(function({item:t,onClick:n,alt:r}){const[s,a]=f.useState(!1);f.useEffect(()=>{a(!1)},[t]);const o=t.thumbnail,i=f.useCallback(()=>{a(!0)},[]);if(!o||s){const c=o?"Failed to load image":"Image not available";return l.jsx(Ls,{className:z("relative w-full",{"cursor-pointer":n}),onClick:n,disabled:!n,children:l.jsx("div",{className:"bg-subtler flex aspect-square w-full items-center justify-center rounded-lg",children:l.jsxs("div",{className:"text-center",children:[l.jsx(ye,{icon:D("photo"),size:"xl",className:"mx-auto mb-2 opacity-50"}),l.jsx(B,{variant:"small",color:"light",children:c})]})})})}return l.jsx(Ls,{className:z("relative w-full",{"cursor-pointer":n}),onClick:n,disabled:!n,children:l.jsx("img",{src:o,alt:r||t.name||t.author_name||"Image",className:"aspect-square w-full rounded-lg object-cover transition-opacity hover:opacity-90",onError:i,loading:"lazy"})})}),hAe=A.memo(function({item:t,index:n,isSelected:r,onClick:s}){const[a,o]=f.useState(!1),i=t.thumbnail||t.image;f.useEffect(()=>{o(!1)},[t]);const c=f.useCallback(()=>{o(!0)},[]);return l.jsx(Ls,{className:z("flex-shrink-0 cursor-pointer transition-all",r?"ring-super rounded-md ring-2":"hover:opacity-75"),onClick:s,children:i&&!a?l.jsx("img",{src:i,alt:t.name||t.author_name||`Image ${n+1}`,className:"h-12 w-16 rounded-md object-cover",onError:c}):l.jsx("div",{className:"bg-subtler flex h-12 w-16 items-center justify-center rounded-md",children:l.jsx(ye,{icon:D("photo"),size:"xs",className:"opacity-50"})})})}),gAe=A.memo(function({item:t,onClick:n}){return l.jsxs("div",{children:[l.jsx("div",{className:"mb-3",children:l.jsx(oH,{item:t,onClick:n})}),l.jsx(iH,{item:t})]})}),qA=A.memo(function({items:t,selectedIndex:n,onImageSelect:r,onImageClick:s}){const a=f.useCallback(()=>{s(n)},[s,n]),o=f.useCallback(()=>{const d=n>0?n-1:t.length-1;r(d)},[n,t.length,r]),i=f.useCallback(()=>{const d=n<t.length-1?n+1:0;r(d)},[n,t.length,r]),c=f.useCallback(d=>{d.key==="ArrowLeft"?(d.preventDefault(),o()):d.key==="ArrowRight"&&(d.preventDefault(),i())},[o,i]),u=t[n];return u?l.jsxs("div",{onKeyDownCapture:c,tabIndex:0,children:[l.jsxs("div",{className:"relative mb-3",children:[l.jsx(oH,{item:u,onClick:a,alt:u.name||u.author_name||`Image ${n+1}`}),t.length>1&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"absolute left-1 top-1/2 -translate-y-1/2",children:l.jsx(at,{onClick:o,rounded:!0,icon:D("chevron-left"),size:"small","aria-label":"Previous image",variant:"tonal"})}),l.jsx("div",{className:"absolute right-1 top-1/2 -translate-y-1/2",children:l.jsx(at,{onClick:i,rounded:!0,icon:D("chevron-right"),size:"small","aria-label":"Next image",variant:"tonal"})})]})]}),l.jsx("div",{className:"mb-3",children:l.jsx("div",{className:"flex gap-2 overflow-x-auto p-1 pb-2 [scrollbar-width:thin]",children:t.map((d,m)=>l.jsx(hAe,{item:d,index:m,isSelected:n===m,onClick:()=>r(m)},m))})}),l.jsx(iH,{item:u,index:n})]}):null}),iH=A.memo(function({item:t,index:n}){const r=t.name||t.author_name||(n!==void 0?`Image ${n+1}`:"Image");return l.jsx("div",{className:"mt-2",children:l.jsx(pAe,{title:r,url:t.url,citationUrl:t.citation_info?.url,domain:t.citation_info?.domain_name,iconUrl:t.citation_info?.favicon_url,className:"line-clamp-3 font-medium leading-tight"})})}),yAe=A.memo(function({mediaItem:t,allMediaItems:n,trackEvent:r,overflowCount:s,openGallery:a,entryUUID:o}){const i=f.useRef(null),c=f.useRef(!1);f.useEffect(()=>{c.current=!1},[t.url]),f.useEffect(()=>{if(!i.current||!r)return;const E=new IntersectionObserver(T=>{for(const k of T)k.isIntersecting&&!c.current&&(r("inline image citation viewed",{image_url:t.image||t.thumbnail,citation_url:t.url,entryUUID:o,source:t.source}),c.current=!0,E.disconnect())},{threshold:.1});return E.observe(i.current),()=>{E.disconnect()}},[t.image,t.thumbnail,t.url,t.source,r,o]);const u=f.useMemo(()=>(n||[t]).filter(T=>T.image||T.thumbnail),[n,t]),{label:d,isTruncated:m}=f.useMemo(()=>{if(t.url){const E=Vf(t.url),T=E.split("."),k=T.length>1?T.slice(-2).join("."):E,M=k.length>12;return{label:M?k.slice(0,12):k,isTruncated:M}}return{label:"image",isTruncated:!1}},[t.url]),p=f.useMemo(()=>s&&s>0?l.jsxs("span",{className:"opacity-50",children:["+",s]}):void 0,[s]),{isMobileStyle:h}=Be(),[g,y]=f.useState(0),[b,x]=f.useState(!1),_=f.useCallback(E=>{y(E)},[]),v=f.useCallback(E=>{if(h)return;u[E]&&a&&(x(!1),a(u,E))},[u,a,h]),C=f.useCallback(()=>{if(!a)return;u[0]&&(x(!1),a(u))},[u,a]),w=f.useCallback(()=>{h&&u.length>1||a&&a(u,0)},[u,a,h]),S=f.useMemo(()=>l.jsx("span",{ref:i,className:"inline-flex",onClick:w,children:l.jsx(Bl,{label:d,icon:D("photo"),accessory:p,truncate:m})}),[d,m,p,w]);return u.length===0?null:h&&u.length===1?S:h?l.jsx(fa,{interaction:"click",side:"bottom",align:"start",open:b,onOpenChange:x,triggerElement:S,children:l.jsx("div",{className:"bg-base w-full md:-mx-3 md:-my-2 md:w-80",children:l.jsx("div",{className:"md:p-3",children:l.jsx(qA,{items:u,selectedIndex:g,onImageSelect:_,onImageClick:v})})})}):l.jsx(fa,{interaction:"hover",openDelayMs:200,closeDelayMs:200,side:"bottom",align:"start",open:b,onOpenChange:x,triggerElement:S,children:l.jsx("div",{className:"bg-base w-full md:-mx-3 md:-my-2 md:w-80",children:l.jsx("div",{className:"md:p-3",children:u.length===1?l.jsx(gAe,{item:u[0],onClick:C}):l.jsx(qA,{items:u,selectedIndex:g,onImageSelect:_,onImageClick:v})})})})}),xAe=A.memo(function({blockquoteText:t}){const[n,r]=f.useState(!1),{$t:s}=Q(),a=f.useCallback(()=>{navigator.clipboard.writeText(t),r(!0)},[t]);return l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"citation-nbsp"}),l.jsx("span",{className:"inline-block align-middle",onPointerEnter:()=>r(!1),children:l.jsx(at,{variant:"text",tooltipShouldStayOpenOnClick:!0,rounded:!0,size:"tiny",icon:D("copy"),onClick:a,"aria-label":s(n?{defaultMessage:"Copied",id:"p556q3uvbn"}:{defaultMessage:"Copy",id:"4l6vz1/eZ5"})})})]})}),bAe=A.memo(function({node:t,...n}){return l.jsx("button",{...n})}),_Ae={abap:"abap",actionscript:"actionscript",ada:"ada",arduino:"arduino",autoit:"autoit",bash:"bash",c:"c",clojure:"clojure",coffeescript:"coffeescript",cpp:"cpp",csharp:"csharp",css:"css",cuda:"cuda",d:"d",dart:"dart",delphi:"delphi",elixir:"elixir",erlang:"erlang",fortran:"fortran",foxpro:"foxpro",fsharp:"fsharp",go:"go",graphql:"graphql",gql:"gql",groovy:"groovy",haskell:"haskell",haxe:"haxe",html:"xml",java:"java",javascript:"javascript",json:"json",julia:"julia",jsx:"jsx",js:"js",kotlin:"kotlin",latex:"tex",lisp:"lisp",livescript:"livescript",lua:"lua",markup:"markup",mathematica:"mathematica",makefile:"makefile",matlab:"matlab",objectivec:"objectivec","objective-c":"objectivec","objective-j":"objectivec",objectpascal:"delphi",ocaml:"ocaml",octave:"matlab",perl:"perl",php:"php",powershell:"powershell",prolog:"prolog",puppet:"puppet",python:"python",qml:"qml",r:"r",racket:"lisp",restructuredtext:"rest",rest:"rest",ruby:"ruby",rust:"rust",sass:"less",less:"less",scala:"scala",scheme:"scheme",shell:"shell",smalltalk:"smalltalk",sql:"sql",standardml:"sml",sml:"sml",swift:"swift",tcl:"tcl",tex:"tex",text:"text",tsx:"tsx",ts:"ts",typescript:"typescript",vala:"vala",vbnet:"vbnet",verilog:"verilog",vhdl:"vhdl",xml:"xml",xquery:"xquery"},vAe=e=>{const{trackEvent:t}=e;return A.memo(function({inline:s,className:a,children:o,node:i,...c}){const u=a?.replace("language-","")||"",d=f.useMemo(()=>({language:_Ae?.[u]}),[u]),{$t:m}=Q(),p=f.useMemo(()=>({copy:m({defaultMessage:"Copy code",id:"CNXQN5zp9z"}),wrap:m({defaultMessage:"Wrap lines",id:"k+v14s5FhJ"}),noWrap:m({defaultMessage:"No line wrap",id:"IS43cwTSaV"})}),[m]);return s?l.jsx("code",{children:o}):l.jsx(hl,{className:"bg-subtler",codeBlockProps:d,trackEvent:t,translations:p,...c,children:o})})},lH=e=>{try{if(typeof e=="string")return e.toLowerCase().replace(/ /g,"-").replace(/[^a-z0-9-]/g,"").slice(0,50).replace(/^-+|-+$/g,"")}catch{}return""},C3="mb-2 mt-4 [.has-inline-images_&]:clear-end",CAe=A.memo(function({node:t,level:n,...r}){const s=lH(r.children);return l.jsx("h1",{className:`font-sans visRefresh2026AnswerSerif:font-editorial first:mt-xs ${C3} font-semimedium visRefresh2026Fonts:font-bold text-lg leading-[1.5em] lg:text-xl`,id:s,...r})}),wAe=A.memo(function({node:t,level:n,...r}){const s=lH(r.children);return l.jsx("h2",{className:`${C3} font-sans visRefresh2026AnswerSerif:font-editorial font-semimedium visRefresh2026Fonts:font-bold text-base visRefresh2026Fonts:text-lg first:mt-0 md:text-lg [hr+&]:mt-4`,id:s,...r})}),SAe=A.memo(function({node:t,level:n,...r}){return l.jsx("h2",{className:`${C3} font-sans visRefresh2026AnswerSerif:font-editorial font-semimedium visRefresh2026Fonts:font-bold text-base first:mt-0`,...r})}),EAe=A.memo(function(t){return l.jsx("hr",{className:"bg-subtle h-px border-0",...t})}),kAe=A.memo(function({className:t,src:n,alt:r,node:s,...a}){return l.jsx("img",{className:t+" rounded-lg",src:n,alt:r,...a})}),MAe=A.memo(function({node:t,depth:n,children:r,ordered:s,...a}){return l.jsx("ol",{className:z("marker:text-quiet list-decimal",{"pl-8":n===0}),...a,children:r})}),TAe=A.memo(function({node:t,depth:n,children:r,ordered:s,...a}){return l.jsx("ul",{className:z("marker:text-quiet list-disc",{"pl-8":n===0}),...a,children:r})}),AAe=A.memo(function({className:t,children:n,ordered:r,node:s,...a}){const o=`py-0 my-0 prose-p:pt-0 prose-p:mb-2 prose-p:my-0 [&>p]:pt-0 [&>p]:mb-2 [&>p]:my-0 ${t||""}`.trim();return l.jsx("li",{...a,className:o,children:n})}),NAe=A.memo(function({node:t,className:n,children:r,...s}){return l.jsx("p",{className:z("my-2 [&+p]:mt-4 [&_strong:has(+br)]:inline-block [&_strong:has(+br)]:pb-2",n),...s,children:r})}),RAe=e=>A.memo(function({children:r,node:s,...a}){return l.jsx("div",{className:z("w-full",{"md:max-w-[90vw]":!e}),children:l.jsx("pre",{className:"not-prose w-full rounded font-mono text-sm font-extralight",...a,children:r})})}),DAe=e=>{if(!e)return{success:!1,error:{type:"INVALID_TABLE",message:"Invalid node: expected table element"}};const n=e.outerHTML.replace("<table",'<table style="border-collapse: collapse; width: 100%; font-family: Arial, sans-serif;').replaceAll("<th ",'<th style="background-color: #f2f2f2; border: 1px solid #ddd; padding: 8px; text-align: left;"').replaceAll("<td ",'<td style="border: 1px solid #ddd; padding: 8px; text-align: left;"');let r=[];const s=[],a=e.querySelectorAll("thead tr"),o=e.querySelectorAll("tbody tr");return a.forEach(c=>{const u=[];c.querySelectorAll("th").forEach(d=>{u.push(d.textContent?.trim()||"")}),u.length>0&&s.push({cells:u,isHeader:!0}),r=u.map(d=>d.length)}),o.forEach(c=>{const u=[];c.querySelectorAll("td").forEach(d=>{u.push(d.textContent?.trim()||"")}),u.length>0&&s.push({cells:u,isHeader:!1})}),s.forEach(c=>{c.cells.forEach((u,d)=>{d>=r.length?r.push(u.length):r[d]=Math.max(r[d]??0,u.length)})}),{success:!0,data:{markdownText:jAe(s,r),htmlText:n}}},IAe=e=>e.replace(/\\/g,"\\\\").replace(/\|/g,"\\|"),jAe=(e,t)=>{if(e.length===0)return"";const n=[];return e.forEach((r,s)=>{const a=[];for(let o=0;o<t.length;o++){const i=r.cells[o]||"",c=IAe(i);a.push(c.padEnd(t[o]??0))}if(n.push(`| ${a.join(" | ")} |`),s===0){const o=`| ${t.map(i=>"-".repeat(i)).join(" | ")} |`;n.push(o)}}),n.join(`
`)},PAe=A.memo(function(t){const{isDisabled:n,tableRef:r,trackEvent:s}=t,{$t:a}=Q(),[o,i]=f.useState(!1),{openToast:c}=cn(),u=f.useCallback(async()=>{i(!0);try{if(!r.current)throw new Error("Table element not found");const d=DAe(r.current);if(!d.success){pi.error("Failed to convert table to clipboard format:",d.error.message),c({message:a({defaultMessage:"Failed to copy table",id:"6PLluVvMhZ"}),description:a({defaultMessage:"Table format is invalid",id:"LSnhEoAVyJ"}),variant:"error",timeout:5});return}const{markdownText:m,htmlText:p}=d.data;await Nve(m,p),s?.("clicked copy table",{source:"markdown"}),c({message:a({defaultMessage:"Table copied to clipboard",id:"cPHpHA3m/M"}),variant:"success",timeout:5})}catch(d){pi.error("Failed to copy rich text:",d),c({message:a({defaultMessage:"Failed to copy table to clipboard",id:"GqiB7jDhXC"}),variant:"error",timeout:5})}finally{i(!1)}},[a,c,r,s]);return l.jsx(ze.div,{className:"flex",animate:{opacity:n?0:1},children:l.jsx(pt,{disabled:n||o,icon:D("copy"),onClick:u,size:"small",clickFeedback:!0,toolTip:a({defaultMessage:"Copy table",id:"uU7t5KxHne"}),variant:"noBackground",extraCSS:"aspect-square"})})});function OAe({csvString:e,filename:t="perplexity.csv"}){if(typeof window>"u")throw new Error("Attempting to download a CSV file in a server context.");try{const n=new Blob([e],{type:"text/csv;charset=utf-8;"}),r=window.URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s)}catch(n){throw n}}function LAe(){return f.useCallback(e=>{OAe(e)},[])}class FAe{static stringArrayToCSV(t){return t.map(this.escapeCSVString).join(",")}static escapeCSVString(t){return`"${t.replace(/"/g,'""')}"`}static tableToCSV(t){if(t.tagName!=="table")throw new Error("Attempting to convert node of wrong tagName to CSV from 'table'");try{const n=[];let r="";return Bn(t,{tagName:"thead"},s=>{const a=[];Bn(s,{tagName:"th"},o=>{const i=$A(o);a.push(i)}),n.push(this.stringArrayToCSV(a)),r+=a.join("-").replace(/[^a-z0-9\\-]/gi,"")}),Bn(t,{tagName:"tbody"},s=>{Bn(s,{tagName:"tr"},a=>{const o=[];Bn(a,{tagName:"td"},i=>{const c=$A(i);o.push(c)}),n.push(this.stringArrayToCSV(o))})}),{csvString:n.join(`
`),filename:r}}catch(n){throw new Error(`Error attempting to convert table node to CSV string: ${n}`)}}}const $A=e=>{const t=[];let n="";Bn(e,[{type:"text"},{tagName:"br"},{tagName:"a"}],s=>{if(s.type==="element"&&s.tagName==="br"){t.push(`
`);return}s.type==="element"&&s.tagName==="a"&&s.properties?.href&&(n=String(s.properties.href)),s.type==="text"&&t.push(s.value.trim())});const r=t.join("");return r?r.replace(/\s*\[\d+\]\s*/g," ").replace(/[ \t]+/g," ").trim():n},UAe=A.memo(function(t){const{isFinal:n,tableNode:r,trackEvent:s}=t,a=LAe(),{$t:o}=Q(),i=f.useCallback(()=>{const c=FAe.tableToCSV(r);a(c),s?.("clicked download table as csv",{source:"markdown"})},[a,r,s]);return l.jsx(ze.div,{className:"flex",animate:{opacity:n?1:0},children:l.jsx(pt,{disabled:!n,icon:D("download"),onClick:i,size:"small",toolTip:o({defaultMessage:"Download CSV",id:"fBhctxdFka"}),variant:"noBackground",extraCSS:"aspect-square"})})}),BAe=e=>{const{embedded:t,isCSVDownloadEnabled:n=!1,isSaveTableAsFileEnabled:r=!1,isCopyTableToClipboardEnabled:s=!1,isFinal:a=!0,trackEvent:o}=e;return A.memo(function({node:u,...d}){const m=A.useRef(null),p=(n||r)&&a;return l.jsxs("div",{className:"group relative",children:[l.jsx(Y,{className:z("w-full overflow-x-auto",{"md:max-w-[90vw]":!t}),children:l.jsx("table",{ref:m,className:"border-subtler my-[1em] w-full table-auto border-separate border-spacing-0 border-l border-t",...d})}),p&&l.jsxs("div",{className:z("bg-base border-subtler shadow-subtle pointer-coarse:opacity-100 right-xs absolute bottom-0 flex rounded-lg border opacity-0 transition-opacity group-hover:opacity-100","[&>*:not(:first-child)]:border-subtle [&>*:not(:first-child)]:border-l"),children:[r&&e.saveTableAsFile&&l.jsx(e.saveTableAsFile,{isFinal:a,tableNode:u,trackEvent:o}),s&&l.jsx(PAe,{isDisabled:!a,tableRef:m,trackEvent:o}),n&&l.jsx(UAe,{isFinal:a,tableNode:u,trackEvent:o})]})]})})},HAe=A.memo(function({node:t,isHeader:n,...r}){return l.jsx("td",{className:"px-sm border-subtler min-w-[48px] break-normal border-b border-r",...r})}),VAe=A.memo(function({node:t,...n}){return l.jsx("thead",{className:"bg-subtler",...n})}),GAe=A.memo(function({node:t,...n}){return l.jsx("th",{className:"border-subtler p-sm break-normal border-b border-r text-left align-top",...n})}),cH=e=>e.type==="text"?e.value:"children"in e&&Array.isArray(e.children)?e.children.map(cH).join(""):"",zAe=e=>e.replace(new RegExp(Ec.source,"g"),""),qAe=()=>e=>{Bn(e,"element",t=>{if(t.tagName!=="blockquote")return;const n=zAe(cH(t)).trim(),r={type:"element",tagName:"span",properties:{className:["blockquote-copy-button"]},children:[],data:{isBlockquoteCopyButton:!0,blockquoteText:n}},s=t.children.slice().reverse().find(a=>a.type==="element");s?s.children.push(r):t.children.push(r)})},$Ae=/^<br\s?\/?>$/,WAe=()=>e=>{Bn(e,"raw",(t,n,r)=>{n!=null&&$Ae.test(t.value)&&r&&(r.children[n]={type:"element",tagName:"br",position:t.position,properties:{},children:[]})})},uH=e=>e.type=="element"&&e.tagName=="span"&&e.properties?.className=="whitespace-nowrap"&&e.children.length==2,KAe=e=>uH(e)?e.children[0]:e,YAe=()=>e=>{Bn(e,{tagName:"a"},(t,n,r)=>{if(t.properties?.title!="_citation"||n===null)return Lr;const s=n!=null?r?.children[n+1]:void 0;if(s?.type!="text"||s.value.charAt(0)!=".")return Lr;t.properties.className=(t.properties.className||"")+" mr-[2px]",r&&n!=null&&(r.children[n]={type:"element",tagName:"span",properties:{className:"whitespace-nowrap"},children:[t,{type:"text",value:"."}]}),s.value=s.value.slice(1)})};function dH(e){return e.type==="text"?e.value:"children"in e?e.children.map(dH).join(""):""}function QAe(e,t){try{const n=JSON.parse(e);return n&&typeof n=="object"&&Array.isArray(n.citations)?{success:!0,group:{category:n.category||"web",overflowCount:Number(n.overflowCount)||0,citations:n.citations,citationAnnotations:n.citationAnnotations,isGrouped:n.overflowCount>0,totalCount:n.citations.length,isHidden:!!n.isHidden,citationAnswerText:t}}:{success:!1}}catch{return{success:!1}}}const XAe=(e,t)=>function(n){let r=0,s="";Bn(n,"element",a=>{const o=uH(a)?KAe(a):a;if(o.tagName!=="a"){if(o.tagName==="p"||o.tagName==="tr"){const c=dH(a);c.length>0&&(s=c)}return au}const[i]=o.children;if(i&&i.type==="text"){const c=Iw(i.value,e);if(c){const u=t.find(m=>m.index===r),d=o.data||{};if(o.data=d,d.webResult=c,d.webResultCitation=u,d.citationAnswerText=s,o.properties&&typeof o.properties=="object"&&o.properties?.dataCitationGroup){const m=o.properties.dataCitationGroup;if(m.startsWith("{")&&m.endsWith("}")){const p=QAe(m,s);p.success&&(d.citationGroup=p.group)}}return r+=1,Lr}}return Lr})},ZAe=e=>t=>{if(!e?.length)return;const n=e[0],r=[];e.length===1?r.push({mediaItem:n,overflowCount:0}):e.length>1&&r.push({mediaItem:n,overflowCount:e.length-1});const s=r.flatMap(({mediaItem:i,overflowCount:c})=>{const u=p=>p.url?Vf(p.url):p.name||"img",d={type:"element",tagName:"span",properties:{className:["citation-nbsp"]},children:[]},m={type:"element",tagName:"span",properties:{className:["select-none","inline","align-baseline"]},children:[{type:"text",value:u(i)}],data:{mediaItem:i,allMediaItems:e,isImageCitation:!0,component:"ImageCitation",citationType:"image",overflowCount:c}};return[d,m]}),o=(i=>{const c=i.children.slice().reverse().find(d=>d.type==="element"&&(d.tagName==="ul"||d.tagName==="ol"));if(c){const d=c.children.slice().reverse().find(m=>m.type==="element"&&m.tagName==="li");if(d){const m=d.children.slice().reverse().find(p=>p.type==="element"&&p.tagName==="p");return m||d}}const u=i.children.slice().reverse().find(d=>d.type==="element"&&d.tagName==="p");return u||null})(t);o?o.children.push(...s):t.children.push({type:"element",tagName:"span",properties:{className:["inline-flex","flex-wrap"]},children:s})},JAe=()=>function(e){Bn(e,"element",function(t,n,r){if(t.tagName!=="code")return;const s=!(r&&r.tagName==="pre");t.data||(t.data={}),t.properties||(t.properties={}),t.properties.inline=s})},e6e=()=>{const e=(t,n)=>{for(let r=t;r<n.children.length;r++)if(n.children[r].type=="element")return n.children[r];return null};return t=>{Bn(t,{tagName:"p"},(n,r,s)=>{if(n.data??={},r!=null&&s){const a=e(r+1,s);n.data.nextIsParagraph=!!a&&a.type!=="comment"&&a.type!=="text"&&a.type!=="raw"&&a.type!=="link"&&a.type!=="break"&&a?.tagName=="p"}return Lr})}},t6e="pplx://action/",n6e="pplx-href",r6e=()=>e=>{Bn(e,"element",t=>{if(t.tagName!=="a")return au;const n=t?.properties?.href?.toString()??"";if(!n.startsWith(t6e))return au;const r=t;return r.tagName="button",r.properties={...r.properties,[n6e]:n,href:void 0,type:"button"},Lr})},s6e="pplx://entity_chip/",fH=()=>e=>{Bn(e,"element",t=>{if(t.tagName!=="a")return au;const n=t?.properties?.href?.toString()??"";if(!n.startsWith(s6e))return au;const r=sxe(n);if(!r)return Lr;const s=t,a=s.properties?.className,o=Array.isArray(a)?a:[a].filter(Boolean);return s.properties={...s.properties,className:[...o,"entity-chip"],[P_]:r,title:hF},Lr})},a6e=()=>e=>{Bn(e,"text",(t,n,r)=>(t.value===""&&n!=null&&r?.children.splice(n,1),Lr))},Y1=/[\t ]*(?:\r?\n|\r)/g,o6e=()=>e=>{Bn(e,"text",(t,n,r)=>{const s=[];let a=0;const o=t.position?.start.offset??0;Y1.lastIndex=0;let i=Y1.exec(t.value);for(;i;){const c=i.index;if(a!==c){const u={start:{line:1,column:1,offset:a+o},end:{line:1,column:1,offset:c+o}};s.push({type:"text",value:t.value.slice(a,c),position:u})}s.push({type:"break"}),a=c+i[0].length,i=Y1.exec(t.value)}if(s.length>0&&r&&typeof n=="number"){if(a<t.value.length){const c={start:{line:1,column:1,offset:a+o},end:{line:1,column:1,offset:t.value.length-a+o}};s.push({type:"text",value:t.value.slice(a),position:c})}return r.children.splice(n,1,...s),n+s.length}})},i6e=e=>{const{citation:t,enableTimecodeAnnotationsForYoutube:n}=e,r=t.indexOf("{"),s=t.indexOf("}");if(r===-1||s===-1)return null;const a=t.substring(r+1,s),o=a.indexOf(":");if(o===-1)return null;const i=a.substring(0,o).trim(),c=a.substring(o+1).trim();if(i===O_.key){if(!n)return null;const u=parseInt(c,10);return isNaN(u)?null:{key:O_.key,value:u}}return null},l6e=e=>{const{match:t,web_results:n,enableTimecodeAnnotationsForYoutube:r}=e,s=t[0]??"",a=parseInt(s.replace(/[[\]]/g,""),10),o=Iw(s,n),i=i6e({citation:s,enableTimecodeAnnotationsForYoutube:r});return{citation:s,number:a,annotation:i,webResult:o,groupCategory:c6e(o),startIndex:t.index,endIndex:t.index+s.length}},c6e=e=>e?e.is_memory?"memory":e.is_attachment?"attachment":e.url&&kl(e.url)?"youtube":"web":"web",u6e=e=>{if(e.length===0)return[];const t=e[0],n=[];let r=[t];for(let s=1;s<e.length;s++){const a=e[s],o=r[r.length-1];a.startIndex===o.endIndex?r.push(a):(n.push(r),r=[a])}return n.push(r),n.flatMap(d6e)},d6e=e=>{if(e.length<=1)return e;const t=e.reduce((n,r)=>{const s=r.groupCategory==="conversation_history"?"web":r.groupCategory;return n.has(s)?n.get(s).members.push(r):n.set(s,{representative:r,members:[r]}),n},new Map);return e.map(n=>{const r=n.groupCategory==="conversation_history"?"web":n.groupCategory,s=t.get(r),a=n===s.representative;return{...n,groupMetadata:{isGroupRepresentative:a,groupCategory:n.groupCategory,groupSize:a?s.members.length:1,groupCitations:s.members.map(o=>o.number),groupAnnotations:s.members.map(o=>o.annotation)}}})},f6e=(e,t)=>{const n=[];let r=0;for(const s of t){const a=!s.groupMetadata||s.groupMetadata.isGroupRepresentative;if(s.startIndex>r){const o=e.slice(r,s.startIndex);o&&n.push(o)}n.push({text:s.citation,metadata:{citationGroup:{category:s.groupCategory,overflowCount:s.groupMetadata&&a?s.groupMetadata.groupSize-1:0,citations:s.groupMetadata?s.groupMetadata.groupCitations:[s.number],citationAnnotations:s.groupMetadata?s.groupMetadata.groupAnnotations:[s.annotation],isHidden:s.groupMetadata&&!a}}}),r=s.endIndex}if(r<e.length){const s=e.slice(r);s&&n.push(s)}return n},m6e=(e={})=>{let{web_results:t,isAnchorLink:n,enableGrouping:r=!1,enableTimecodeAnnotationsForYoutube:s=!1}=e;t=Array.isArray(t)?t:[];const a=(c,u,d,m,p)=>oxe(h=>typeof h=="string"?p?.has(h)??Ec.test(h):h.text?Ec.test(h.text):!1,c,u,d,n?"_anchor_citation":"_citation",m,h=>{const g=typeof h=="string"?h:h.text;return Iw(g,t)?.url??""}),o=(c,u)=>{if(u.length===0)return[c];const d=[];let m=0;for(const p of u)p.index>m&&d.push(c.slice(m,p.index)),d.push(p[0]),m=p.index+p[0].length;return m<c.length&&d.push(c.slice(m)),d.filter(Boolean)},i=new WeakSet;return c=>{Bn(c,"text",(u,d,m)=>{if(!m||d==null||i.has(u))return Lr;i.add(u);const p=[...u.value.matchAll(new RegExp(Ec,"g"))];if(p.length===0)return Lr;const h=new Set(p.map(y=>y[0]));if(m?.type==="link"&&u.value==m.url){const y=o(u.value,p);return m.url=y[0],Lr}if(r){const y=p.map(_=>l6e({match:_,web_results:t,enableTimecodeAnnotationsForYoutube:s})),b=u6e(y),x=f6e(u.value,b);return a(x,d,m,u.position?.start.offset,h)}const g=o(u.value,p);return a(g,d,m,u.position?.start.offset,h)})}},p6e=()=>e=>{Bn(e,"list",t=>{t.spread=!0})},h6e=/(?<![[\]<>()`])(https?:\/\/[^\s[\]<>()"`]+)(?:\[\d+\])+/g,g6e=/\[(https?:\/\/[^\s[\]<>()"`]+)\](?!\()/g,y6e=/\uff08(https?:\/\/[^\s[\]<>()"`\uff08\uff09]+)\uff09/g,x6e=/\*\*(https?:\/\/[^\s*<>()"`]+)\*\*/g,b6e=new RegExp(kR.source+"|"+MR.source,"g"),cv=(e,t)=>{if(typeof e!="string")return e;const n=e.replace(y6e,(r,s)=>`[${s}](${s})`).replace(h6e,(r,s)=>`<${s}>${r.slice(s.length)}`).replace(g6e,(r,s)=>`[${s}](${s})`).replace(x6e,(r,s)=>`[**${s}**](${s})`);return t?n:n.replace(b6e,"")};function _6e(e,t){return function(...r){const s=e(...r);return function(a,o){try{return s(a,o)}catch(i){i.message.startsWith("KaTeX parse error")}return a}}}const mH=[o6e,[H4e,{target:"_blank"}],[YTe,{singleTilde:!1}],[mAe,{singleDollarTextMath:!1}]],WA={rehypePostParagraphBreaks:e6e,rehypeInlineCode:JAe,rehypeBreaks:WAe,rehypePeriodWrap:YAe,rehypePPLXEntityLinks:fH,rehypeBlockquoteCopyButton:qAe};let Mp=null,Mh=null;async function v6e(e){return Mp||(Mp=Promise.all([W(()=>import("./index-Dp4gHirK.js"),__vite__mapDeps([400,401,402,2,3,1,7,8,13,5,12,9,6,14,15,16,17])),W(()=>import("./katex-CmGQIWW6.js").then(t=>t.a),__vite__mapDeps([401,402]))]).then(([{default:t}])=>{const n=e?[_6e(t),{throwOnError:!0}]:[t,{throwOnError:!1}];return Mh=n,n}),Mp)}const C6e=({final:e,renderFollowUps:t,renderCitations:n,webResults:r,webResultCitations:s,imageCitations:a,inlineTokenAnnotations:o})=>{const[i,c]=f.useState(Mh?{...WA,rehypeKatex:Mh}:WA);return f.useEffect(()=>{Mh||v6e(e).then(d=>{c(m=>({...m,rehypeKatex:d}))})},[e]),f.useMemo(()=>[...Object.values({...i,rehypePPLXActionLinks:t?r6e:null,rehypeCitations:n?[XAe,r,s??[]]:null,rehypeImageCitations:a?.length?[ZAe,a]:null,rehypePPLXEntityLinks:Object.keys(o??{}).length>0?fH:null}).filter(d=>d!==null),a6e],[i,t,n,r,s,a,o])};function Q1(e,t){const{animateIn:n=!0,once:r=!0}=t??{},{device:{isIOS:s}}=jn(),a=!s&&n,o=f.useMemo(()=>a?c=>{const u=Mo(!0),d={...c,className:z(c.className,{"animate-in fade-in-25 duration-700":!(r&&u)})};return l.jsx(e,{...d})}:void 0,[e,r,a]);return!a||!o?e:o}const pH="prose dark:prose-invert inline leading-relaxed break-words min-w-0 [word-break:break-word] prose-strong:font-medium visRefresh2026Fonts:prose-strong:font-bold [&_>*:first-child]:mt-0",w6e=f.memo(MAe),S6e=f.memo(TAe),E6e=f.memo(VAe),k6e=f.memo(HAe),M6e=f.memo(GAe),T6e=f.memo(CAe),A6e=f.memo(wAe),Tp=f.memo(SAe),N6e=f.memo(EAe),hH=({str:e,final:t=!1,webResults:n,inlineTokenAnnotations:r,embedded:s=!1,wrapInParent:a=!0,animateIn:o=!1,isAnchorLink:i=!1,testId:c,trackEvent:u,renderCitations:d=!0,enableCitationGrouping:m=!1,experiments:p={},markdownComponents:h={},citationSize:g="default",renderFollowUps:y=!0,webResultCitations:b,imageCitations:x,saveTableAsFile:_,onCitationClick:v,getAttachmentUrl:C,forceExternalHandler:w,openGallery:S,scrollContainerRef:E,entryUUID:T,citationExcerptsOnHoverEnabled:k,enableTimecodeAnnotationsForYoutube:M,inlineClaims:N,onOpenClaimsPanel:P})=>{const{Paragraph:O=NAe,ListItem:L=AAe,Button:H=bAe,EntityChip:R}=h,{hideHoverCard:I,isDownloadTableAsCSVEnabled:F,isSaveTableAsFileEnabled:G,isCopyTableToClipboardEnabled:j}=p,$=f.useMemo(()=>{let Te;return we=>(xn(Te,we,xn)||(Te=we),Te)},[]),q=f.useMemo(()=>{let Te;return we=>(xn(Te,we,xn)||(Te=we),Te)},[]),U=f.useMemo(()=>{let Te;return we=>(xn(Te,we,xn)||(Te=we),Te)},[]),X=$(n),J=q(b),ne=U(N),ae=f.useMemo(()=>r?.reduce((Te,we)=>(we.id&&(Te[we.id]=we),Te),{}),[r]),de=f.useMemo(()=>mH.concat([d&&[m6e,{web_results:X,isAnchorLink:i,enableGrouping:m,enableTimecodeAnnotationsForYoutube:M}],p6e].filter(Boolean)),[d,X,i,m,M]),oe=C6e({final:t,renderFollowUps:y,renderCitations:d,webResults:X,webResultCitations:J,imageCitations:x,inlineTokenAnnotations:ae}),le=Q1(O,{animateIn:o,once:!1}),se=Q1(L,{animateIn:o,once:!1}),re=Q1(kAe,{animateIn:o}),he=f.useMemo(()=>BAe({embedded:s,isCSVDownloadEnabled:F,isSaveTableAsFileEnabled:G,isCopyTableToClipboardEnabled:j,isFinal:t,trackEvent:u,saveTableAsFile:_}),[s,F,G,j,t,u,_]),ie=f.useMemo(()=>vAe({trackEvent:u}),[u]),{isMobileStyle:ue}=Be(),ce=ue&&!1,me=f.useMemo(()=>({hideHoverCard:I,trackEvent:u,citationSize:g,onCitationClick:v,getAttachmentUrl:C,isMobileWeb:ce,enableCitationGrouping:m,webResults:X,inlineClaims:ne,inlineTokenAnnotationsLookup:ae,EntityChipComponent:R,forceExternalHandler:w,scrollContainerRef:E,entryUUID:T,citationExcerptsOnHoverEnabled:k,onOpenClaimsPanel:P}),[I,u,g,v,C,ce,m,X,ne,R,w,ae,E,T,k,P]),pe=f.useMemo(()=>({children:we,className:ke,node:Fe,...ot})=>Fe?.data?.isImageCitation&&Fe?.data?.component==="ImageCitation"?l.jsx(yAe,{mediaItem:Fe.data.mediaItem,allMediaItems:Fe.data.allMediaItems,overflowCount:Fe.data.overflowCount||0,openGallery:S,trackEvent:u,entryUUID:T}):Fe?.data?.isBlockquoteCopyButton?l.jsx(xAe,{blockquoteText:Fe.data.blockquoteText}):l.jsx("span",{className:Array.isArray(ke)?ke.join(" "):ke,...ot,children:we}),[S,u,T]),xe=f.useMemo(()=>RAe(s),[s]),Oe=f.useMemo(()=>({p:le,ol:w6e,hr:N6e,ul:S6e,li:se,table:he,thead:E6e,td:k6e,th:M6e,pre:xe,code:ie,img:re,a:mxe,h1:T6e,h2:A6e,h3:Tp,h4:Tp,h5:Tp,h6:Tp,button:H,span:pe}),[le,se,he,ie,re,xe,H,pe]);return l.jsx(ar,{fallback:null,children:l.jsx(bF.Provider,{value:me,children:l.jsx(A4e,{className:a?pH:void 0,remarkPlugins:de,rehypePlugins:oe,unwrapDisallowed:!0,components:Oe,"data-test-id":c,children:cv(e,d)})})})},R6e=A.memo(hH,({webResults:e,inlineTokenAnnotations:t,...n},{webResults:r,inlineTokenAnnotations:s,...a})=>{const o=t?.length===s?.length&&!!t?.every((i,c)=>i.progress===s?.[c]?.progress);return xn(n,a)&&xn(e,r,xn)&&o}),D6e=e=>{let t=0;return r=>{const s=[];for(;e.length;){const a=e.shift();if(t+=a.length,t>=r){s.push(a.slice(0,a.length+r-t));const o=a.slice(a.length+r-t);o&&(e.unshift(o),t-=o.length);break}s.push(a)}return s}},KA=jB().use(EB).use(mH);function YA(e,t){const n=KA.runSync(KA.parse(e),e);return t&&gF(n,t),n}const I6e=/(\s+)/g,j6e=[/(\*\*)/g,/(__)/g],P6e=10;function O6e(e,t){if(!e.children.every(a=>{const o=a.position?.start.offset,i=a.position?.end.offset;return(o||o==0)&&(i||i==0)}))return[t];const n=a=>{j6e.forEach(o=>{const c=a.join("").split(o);if((c.length-1)/2%2==1){const d=c.pop(),m=c.pop();if((d.split(I6e).length+1)/2<P6e){let h=d.length+m.length;for(let g=a.length-1;g>=0;g--){const y=a[g],b=y.length-h;if(b>0){a[g]=y.slice(0,b);break}else a.pop(),h-=y.length}}}})},r=D6e(t),s=[];return e.children.forEach((a,o)=>{r(a.position?.start.offset);const i=r(a.position?.end.offset);o==e.children.length-1&&n(i),s.push(i)}),s}const gH=({chunks:e,webResults:t,embedded:n,rendererProps:r,testId:s,webResultCitations:a,imageCitations:o,onCitationClick:i,enableCitationGrouping:c,inlineTokenAnnotations:u,inlineClaims:d,onOpenClaimsPanel:m})=>{const p=f.useMemo(()=>{let h,g=[],y="";return b=>{const x=b.slice(),_=g.every((C,w)=>C==x[w]),v=x.slice(g.length);if(!_||!h||!h.children.length)y=cv(x.join(""),!0),h=YA(y);else{const C=h.children.pop(),w=y.slice(C.position?.start.offset),S=cv(v.join(""),!0),E=w+S;y=y.slice(0,C.position?.start.offset)+E;const T=YA(E,C.position?.start);h.children.push(...T.children)}return g=x.slice(),O6e(h,[y])}},[]);return l.jsx("div",{className:pH,"data-test-id":s,children:p(e).map((h,g)=>l.jsx(A.Fragment,{children:l.jsx(R6e,{str:h.join(""),webResults:t,final:!1,embedded:n,wrapInParent:!1,animateIn:!0,onCitationClick:i,...r,webResultCitations:a,imageCitations:o,enableCitationGrouping:c,inlineTokenAnnotations:u,inlineClaims:d,onOpenClaimsPanel:m})},g))})},oQe=A.memo(gH,({webResults:e,chunks:t,...n},{webResults:r,chunks:s,...a})=>xn(n,a)&&xn(e,r,xn)&&xn(t,s,xn)),L6e=40,F6e=40,U6e=10,B6e=e=>e.previousSibling?e.previousSibling:e.parentNode?e.parentNode.previousSibling:null,Th=512,H6e=e=>{const t=e.startContainer,n=e.startOffset;if(t.nodeType!==Node.TEXT_NODE)return["",""];let r=t.textContent?.slice(0,n)||"",s=r,a=!1,o=t;for(let i=0;i<10&&(o=B6e(o),!(!o||r.length>Th));i++){if(o.nodeType===Node.TEXT_NODE&&o.textContent===`
`&&(a=!0),o.nodeType===Node.TEXT_NODE)r=(o.textContent||"")+r;else if(o.nodeType===Node.ELEMENT_NODE){const c=/^\d+\.$/,u=/^\d+\.?$/;c.test(o.textContent||"")?r="."+r:u.test(o.textContent||"")||(r=o.textContent+r)}a||(s=r)}return s.length>Th?r=s:r=r.slice(-Th),[s,r]},V6e=e=>e.nextSibling?e.nextSibling:e.parentNode?e.parentNode.nextSibling:null,G6e=e=>{const t=e.endContainer,n=e.endOffset;if(t.nodeType!==Node.TEXT_NODE)return"";let r=t.textContent?.slice(n)||"",s=t;for(let a=0;a<5&&(s=V6e(s),!(!s||s.nodeType===Node.TEXT_NODE&&s.textContent===`
`));a++)s.nodeType===Node.TEXT_NODE?r+=s.textContent:s.nodeType===Node.ELEMENT_NODE&&/^\d+\.$/.test(s.textContent||"")&&(r+=".");return r.slice(0,Th)},z6e=A.memo(function({embedded:t,isAnchorLink:n,isPending:r=!1,rendererTestId:s,response:a,streamerTestId:o,trackEvent:i,renderCitations:c=!0,experiments:u,markdownComponents:d,wrapInParent:m=!0,citationSize:p="default",webResultCitations:h,imageCitations:g,onCheckSources:y,onQuoteSelect:b,onOpenInSideDocument:x,saveTableAsFile:_,onCitationClick:v,getAttachmentUrl:C,enableCitationGrouping:w=!1,ref:S,forceExternalHandler:E,openGallery:T,scrollContainerRef:k,entryUUID:M,citationExcerptsOnHoverEnabled:N,enableTimecodeAnnotationsForYoutube:P,onOpenClaimsPanel:O}){const L=Q(),H=f.useRef(null),R=f.useRef(null),[I,F]=f.useState(void 0),[G,j]=f.useState(void 0),$=L.formatMessage({defaultMessage:"Check sources",id:"AxT33TYx0b"}),q=L.formatMessage({defaultMessage:"Add to follow-up",id:"EgzsNJ7SZP"}),U=y||b||x,X=f.useCallback(()=>{if(!U)return;j(void 0);const ue=window.getSelection();if(!ue||!ue.toString().trim()||!H.current){j(void 0);return}if(!H.current.contains(ue.anchorNode)||!H.current.contains(ue.focusNode)){j(void 0);return}const ce=ue.getRangeAt(0),me=ce.getClientRects();if(me.length===0){j(void 0);return}const pe=me[0],Oe=me[me.length-1].bottom-pe.top,Te=ce.cloneContents();Te.querySelectorAll(".select-none").forEach(He=>He.remove());const ke=Te.textContent?.trim(),Fe=H.current.getBoundingClientRect(),[ot,ge]=H6e(ce),Ce=ke||ue.toString(),Ae=G6e(ce);j({rect:pe,relativeTop:pe.top-Fe.top,relativeLeft:pe.left-Fe.left,quote:{extendedBeforeContext:ge,beforeContext:ot,selectedText:Ce,afterContext:Ae},totalHeight:Oe})},[U]),J=f.useCallback(()=>{const ue=window.getSelection();(!ue||!ue.toString().trim())&&j(void 0)},[]);f.useEffect(()=>{if(U)return document.addEventListener("mouseup",X),document.addEventListener("selectionchange",J),()=>{document.removeEventListener("mouseup",X),document.removeEventListener("selectionchange",J)}},[X,J,U]);const ne=f.useCallback(()=>{if(b&&G?.quote){const ue=G?.quote.selectedText.trim();window.getSelection()?.removeAllRanges(),j(void 0),b(ue),i?.("click quote reply",{selectedText:ue})}},[G?.quote,b,i]),ae=f.useCallback(()=>{y&&G?.quote&&(window.getSelection()?.removeAllRanges(),j(void 0),y(G?.quote),i?.("click check sources",{extendedBeforeContext:G?.quote.extendedBeforeContext,beforeContext:G?.quote.beforeContext,selectedText:G?.quote.selectedText,afterContext:G?.quote.afterContext}))},[G?.quote,y,i]);f.useEffect(()=>{G?.rect&&R.current&&F(R.current.getBoundingClientRect().width)},[G?.rect]);const de=f.useCallback(()=>{x&&G?.quote&&(x(G?.quote),j(void 0),i?.("click open in document",{extendedBeforeContext:G?.quote.extendedBeforeContext,beforeContext:G?.quote.beforeContext,selectedText:G?.quote.selectedText,afterContext:G?.quote.afterContext}))},[G?.quote,x,i]),oe=(ue,ce=0,me=0)=>ue?ce+me+U6e:ce-L6e,se=(()=>{if(!G?.rect||!H.current||!I)return null;const ue=H.current.getBoundingClientRect(),ce=Math.min(G.relativeLeft||0,ue.width-I),me=(G.relativeTop||0)<F6e;return{top:oe(me,G.relativeTop??0,G.totalHeight??0),left:ce}})(),re=f.useMemo(()=>({experiments:u,markdownComponents:d,citationSize:p,forceExternalHandler:E,renderCitations:c,scrollContainerRef:k,entryUUID:M,citationExcerptsOnHoverEnabled:N,enableTimecodeAnnotationsForYoutube:P}),[p,u,d,E,c,k,M,N,P]),he=vEe(),ie=f.useMemo(()=>{if(he)return[];const ue=[];return b&&ue.push({action:ne,text:q}),y&&ue.push({action:ae,text:$}),x&&ue.push({action:de,text:L.formatMessage({defaultMessage:"View in file",id:"owm3XhJD2c"})}),ue},[b,ne,q,y,ae,$,x,de,L,he]);return l.jsxs("div",{ref:QD([H,S]),className:"relative",children:[a&&r&&a.chunks&&l.jsx(gH,{chunks:a.chunks,webResults:a.web_results,embedded:t,testId:o,rendererProps:re,webResultCitations:h,imageCitations:g,onCitationClick:v,enableCitationGrouping:w,inlineTokenAnnotations:a.inline_token_annotations,inlineClaims:a.inline_claims,onOpenClaimsPanel:O}),a&&!r&&a.answer&&l.jsx(hH,{str:a.answer,webResults:a.web_results,final:!0,embedded:t,isAnchorLink:n,trackEvent:i,testId:s,renderCitations:c,enableCitationGrouping:w,experiments:u,markdownComponents:d,wrapInParent:m,citationSize:p,webResultCitations:h,imageCitations:g,saveTableAsFile:_,onCitationClick:v,getAttachmentUrl:C,inlineTokenAnnotations:a.inline_token_annotations,inlineClaims:a.inline_claims,forceExternalHandler:E,onOpenClaimsPanel:O,openGallery:T,scrollContainerRef:k,entryUUID:M,citationExcerptsOnHoverEnabled:N,enableTimecodeAnnotationsForYoutube:P}),ie.length>0&&G?.rect&&l.jsx("div",{ref:R,className:"absolute z-[5]",style:se||{visibility:"hidden"},children:l.jsx("div",{className:z("bg-base shadow-lg",ie.length>0?"rounded-lg":"rounded-full"),children:ie.map((ue,ce)=>l.jsx(st,{onClick:ue.action,size:"small",text:ue.text,variant:"primaryGhost",extraCSS:z("border transform-none active:transform-none active:scale-100 min-w-fit whitespace-nowrap",{"rounded-l-lg dark:rounded-l-lg":ce===0,"rounded-r-none":ie.length>1&&ce!==ie.length-1,"rounded-l-none":ce>0,"rounded-r-lg dark:rounded-r-lg":ce===ie.length-1,"!border-l-0":ce>0,"!rounded-full":ie.length==1})},ce))})})]})},({response:{answer:e,web_results:t,chunks:n,inline_token_annotations:r}={},...s},{response:{answer:a,web_results:o,chunks:i,inline_token_annotations:c}={},...u})=>{const d=r?.length===c?.length&&!!r?.every((m,p)=>m.progress===c?.[p]?.progress);return xn(s,u)&&xn(e,a)&&xn(t,o,xn)&&xn(n,i,xn)&&d}),q6e="gap-[7px]",$6e="w-px border-l border-subtler",W6e={initial:({animateEntry:e})=>({opacity:0,y:e?-8:0,transition:{opacity:{duration:.15},y:{duration:e?.15:0}}}),animate:{opacity:1,y:0,transition:{opacity:{duration:.15},y:{duration:.15}}},exit:({animateExit:e})=>({opacity:0,y:e?-8:0,transition:{opacity:{duration:.12},y:{duration:e?.12:0}}})},K6e=A.memo(function({cleanTitle:t,status:n,web_results:r}){const s=QU(),a=f.useMemo(()=>({Paragraph:({children:i})=>i}),[]),o=f.useMemo(()=>({answer:t,web_results:r}),[t,r]);return l.jsx("span",{className:"flex grow overflow-hidden py-[6px]",children:l.jsx(B,{className:"pr-sm block [&_code]:max-h-[300px] [&_code]:overflow-auto",variant:"small",color:n==="active"?"default":"light",inline:!0,children:l.jsx(z6e,{response:o,markdownComponents:a,wrapInParent:!1,citationSize:"small",enableCitationGrouping:s})})})}),Y6e=({steps:e,status:t,trackSearchResultsStep:n,disableAnimations:r})=>{const s=f.useMemo(()=>{if(!e)return[];const a=ihe(e);return ahe(a)},[e]);return f.useMemo(()=>s?.map((a,o)=>{const i=o===(s?.length??0)-1,c=t==="finished"||!i;return l.jsx(X6e,{isFinished:c,index:o,step:a,disableAnimations:r,trackSearchResultsStep:n},`${a.uuid}-${o}`)}).filter(Boolean),[s,t,r,n])},Q6e=A.memo(function(t){const{className:n="",title:r,status:s,steps:a,web_results:o=_e,showStatus:i=!0,timelineGapClassName:c=q6e,animateEntry:u=!0,animateExit:d=!0,placeholder:m=!1,keepNewLines:p=!1,isFinalGoal:h=!1,disableAnimations:g=!1,ref:y,...b}=t,{session:x}=je(),{trackEvent:_}=Ze(x),v=r.replace(/^\n+|\n+$/g,"").replace(/\n/g,p?`
`:" "),C=s==="finished"||s==="loading"?s:"planned",w=f.useCallback(N=>{_("click citation",{citation_url:N,source:"researchStep"})},[_]),S=l.jsx(Y6e,{steps:a,status:s,trackSearchResultsStep:w,disableAnimations:g}),E=!!a?.length,[T,{height:k}]=Ni(),M=!d&&u&&!g;return l.jsxs(ze.div,{ref:y,className:`group/goal relative flex overflow-hidden ${n} ${c}`,role:"listitem",initial:g?!1:M?{height:0}:"initial",animate:g?!1:M?{height:k||"auto"}:"animate",exit:g?void 0:"exit",transition:g?{duration:0}:M?{duration:.1,ease:"easeOut"}:void 0,variants:g?void 0:W6e,custom:{animateEntry:u&&!g,animateExit:d&&!g},...b,children:[l.jsx("div",{className:"flex",children:l.jsx(_Ee,{status:s,state:C,showStatus:i,timelineConnectorClassName:$6e,hasSteps:E,isFinalGoal:h})},"timeline-container"),l.jsx("div",{className:"min-w-0 grow",children:l.jsxs("div",{ref:T,className:"flex flex-col",children:[l.jsx(K6e,{cleanTitle:v,status:s,placeholder:m,web_results:o}),E&&l.jsx("div",{className:"pb-md gap-y-sm flex w-full flex-col empty:hidden group-last/goal:pb-0",children:l.jsx(Wt,{children:S})})]},"content-container")})]})},(e,t)=>!["id","status","title","steps","isFinalGoal"].some(s=>!fL(e[s],t[s]))),X6e=A.memo(function({isFinished:t,index:n,step:r,disableAnimations:s,trackSearchResultsStep:a}){const o=r.step_type==="SEARCH_RESULTS"?a:void 0,i=f.useMemo(()=>({id:r.uuid,initial:s?!1:{opacity:0,x:-10},animate:s?!1:{opacity:1,x:0},exit:s?void 0:{opacity:0,x:10},transition:s?{duration:0}:{duration:.2,delay:n*.05,ease:Ay}}),[s,n,r.uuid]);return l.jsx(YU,{step:r,isFinished:t,onStepClick:o,motionProps:i,disableAnimations:s},`${r.uuid}-${n}`)}),Z6e=A.memo(function({visibleGoals:t,isAgentWorkflowInFlight:n,forceShowAll:r,disableAnimations:s}){return l.jsx("div",{className:"relative z-0 flex flex-col",children:l.jsxs("div",{className:"relative pl-px",children:[l.jsx(Wt,{mode:n&&!r?"wait":void 0,children:t.map(a=>a?l.jsx(Q6e,{id:a.id,status:a.status,steps:a.steps,web_results:a.web_results,title:a.title,animateEntry:a.animateEntry,animateExit:!!(n&&!r),isFinalGoal:a.isFinalGoal,keepNewLines:!0,disableAnimations:a.disableAnimations||s&&a.status==="finished"},a.key):null)}),l.jsx("div",{className:"-mx-lg from-base to-base/0 absolute bottom-0 z-20 h-3 w-full bg-gradient-to-t"})]})})}),J6e=[],e7e=({hasPendingFiles:e,attachments:t=_e,attachment_processing_progress:n=_e})=>{const{$t:r}=Q(),s=f.useMemo(()=>e?[{description:r({defaultMessage:"Processing attachments...",id:"nCVqMMwJ07"}),final:!1,id:"pending-files-goal",steps:[{step_type:"PENDING_FILES",content:{attachments:t,attachmentProcessingProgress:n},uuid:"pending-files-step"}]}]:J6e,[r,n,t,e]),a=f.useMemo(()=>!e||n.some(i=>i.file_url==="end"),[n,e]),o=f.useMemo(()=>a?null:s.length>0?s[0]:null,[a,s]);return{pendingFilesGoals:s,activePendingFileGoal:o,isFileProcessingDone:a}},t7e=({researchPlan:e,reasoningPlan:t,hasAnswer:n,isProReasoningMode:r})=>{const s=t?.goals?.slice(1)??_e,a=f.useMemo(()=>!e||n||r&&s.length>0,[e,n,r,s.length]),o=f.useMemo(()=>!t&&!r||!!t?.final,[t,r]),i=n&&o&&a,c=f.useMemo(()=>o||!t?.goals?null:t.goals[t.goals.length-1],[t,o]);return{reasoningGoals:s,isResearchPlanFinished:a,isReasoningPlanFinished:o,isAllPlansFinished:i,activeReasoningGoal:c}},n7e=({researchPlan:e,steps:t,isResearchPlanFinished:n,backendUUID:r})=>{const s=r7e({backendUUID:r,steps:t,isResearchPlanFinished:n}),a=s7e({backendUUID:r,steps:t,isResearchPlanFinished:n}),o=f.useMemo(()=>{const d=new Map;return e?.goals?.forEach(m=>{m.id&&d.set(m.id,m.description)}),d},[e]),i=f.useMemo(()=>{const d=[];let m=null;for(const p of t){if(p.step_type==="INITIAL_QUERY"||p.step_type==="TERMINATE")continue;const h="goal_id"in p.content&&typeof p.content.goal_id=="string"?p.content.goal_id:null;if(h!==m||d.length===0){m=h;const g=h??`goal-${d.length}`;d.push({id:g,description:o.get(g)??null,final:!1,steps:[]})}d.at(-1)?.steps?.push(p)}return d},[t,o]),c=i.at(-1)??null,u=f.useMemo(()=>[...i,...s,...a],[i,s,a]);return f.useMemo(()=>({activeResearchGoal:c,researchGoals:u}),[c,u])},r7e=({backendUUID:e,steps:t,isResearchPlanFinished:n})=>{const r=Q(),{pendingClarifications:s,clearClarifications:a}=ny(),o=f.useMemo(()=>{if(n||!e)return[];const i=new Set(t.map(d=>d.uuid)),c=new Set;return t.forEach(d=>{d.step_type==="CLARIFYING_QUESTIONS_OUTPUT"&&d.content?.clarification&&c.add(d.content.clarification)}),s.filter(d=>d.entryUUID===e&&!i.has(d.UUID)&&!c.has(d.content)).map((d,m)=>({description:d.question??r.formatMessage({defaultMessage:"I'll consider the details you added.",id:"46H8Trfeps"}),final:!1,id:`c-${m}`,steps:[{content:{goal_id:`c-${m}`,clarification:d.content,question:d.question},step_type:"CLARIFYING_QUESTIONS_OUTPUT",uuid:d.UUID}]}))},[r,s,e,n,t]);return f.useEffect(()=>{n&&s.length&&a()},[a,n,s]),o},s7e=({backendUUID:e,steps:t,isResearchPlanFinished:n})=>{const r=Q(),{pendingSuggestions:s,clearPendingSuggestions:a}=ny(),o=f.useMemo(()=>{if(n||!e)return[];const i=new Set(t.map(d=>d.uuid)),c=new Set;return t.forEach(d=>{d.step_type==="IN_CONTEXT_SUGGESTIONS_OUTPUT"&&d.content?.selected_suggestion&&c.add(d.content.selected_suggestion)}),s.filter(d=>d.entryUUID===e&&!i.has(d.UUID)&&!c.has(d.suggestion)).map((d,m)=>({description:r.formatMessage({defaultMessage:"I'll refine my research based on your selection.",id:"SXOuvFDKhd"}),final:!1,id:`s-${m}`,steps:[{content:{goal_id:`s-${m}`,selected_suggestion:d.suggestion},step_type:"IN_CONTEXT_SUGGESTIONS_OUTPUT",uuid:d.UUID}]}))},[r,s,e,n,t]);return f.useEffect(()=>{n&&s.length&&a()},[a,n,s]),o},X1=e=>{const{goals:t,activeGoal:n,isPlanFinished:r,planType:s,web_results:a,skipFirstAnimation:o,$t:i}=e,c=n?t.indexOf(n):-1;return t.map((u,d)=>{const m=n?.id===u.id,p=c!==-1&&c>d||r,h=u.steps?.some(g=>g.step_type==="CLARIFYING_QUESTIONS_OUTPUT");return{...u,key:`${s}-${u.id?u.id+"-":""}${d}`,id:u.id??`${s}-${d}`,status:p?"finished":m?"loading":"planned",planType:s,animateEntry:!(d===0&&o)&&!p,web_results:a,isFinalGoal:!1,disableAnimations:h??!1,title:u?.title??u?.description??i({defaultMessage:"Thinking",id:"P1QHV0AhYD"}),description:u?.description??null,final:!1}})},a7e=()=>{const{result:{backend_uuid:e,attachments:t,attachment_processing_progress:n},steps:r,researchPlan:s,reasoningPlan:a,hasAnswer:o,isProReasoningMode:i=!1,hasPendingFiles:c}=Pt(),u=t7e({researchPlan:s,reasoningPlan:a,hasAnswer:o,isProReasoningMode:i}),d=n7e({researchPlan:s,steps:r??[],isResearchPlanFinished:u.isResearchPlanFinished,backendUUID:e??""}),m=e7e({hasPendingFiles:c,attachments:t,attachment_processing_progress:n});return f.useMemo(()=>({...u,...d,...m}),[u,d,m])},yH={status:"finished",planType:"final",animateEntry:!1,web_results:void 0,description:null,final:!0,steps:void 0,disableAnimations:!0},o7e=e=>({...yH,key:"final-goal",id:"final-goal",title:e({defaultMessage:"Finished",id:"EQpfkSbt5q"}),isFinalGoal:!0}),i7e=e=>({...yH,key:"answer-skipped-goal",id:"answer-skipped-goal",title:e({defaultMessage:"Answer skipped",id:"0siVz43iGV"}),isFinalGoal:!1}),xH=()=>{const{$t:e}=Q(),{researchPlan:t,reasoningPlan:n,isAnswerSkipped:r,isProReasoningMode:s}=Pt(),{reasoningGoals:a,isResearchPlanFinished:o,isReasoningPlanFinished:i,isAllPlansFinished:c,activeReasoningGoal:u,pendingFilesGoals:d,activePendingFileGoal:m,isFileProcessingDone:p,researchGoals:h,activeResearchGoal:g}=a7e(),y=n?.web_results,b=f.useMemo(()=>X1({goals:d??[],activeGoal:m,isPlanFinished:p,planType:"research",web_results:void 0,skipFirstAnimation:!1,$t:e}),[d,m,p,e]),x=f.useMemo(()=>t?X1({goals:h,activeGoal:g,isPlanFinished:o,planType:"research",web_results:void 0,skipFirstAnimation:!0,$t:e}):[],[t,h,g,o,e]),_=f.useMemo(()=>s?X1({goals:a,activeGoal:u,isPlanFinished:i,planType:"reasoning",web_results:y,skipFirstAnimation:!t,$t:e}):[],[s,a,u,i,y,t,e]);return f.useMemo(()=>[...b,...x,..._,...c?[o7e(e)]:[],...r?[i7e(e)]:[]],[b,x,_,c,r,e])},l7e=A.memo(function({isExpanded:t}){const{isAgentWorkflowInFlight:n,hasAnswer:r}=Pt(),s=xH(),a=f.useMemo(()=>{if(t)return s;if(n||r){const i=s[s.length-1];return i?[i]:[]}return[]},[s,n,r,t]);return!r||t?l.jsx(Z6e,{visibleGoals:a,isAgentWorkflowInFlight:n,forceShowAll:t,disableAnimations:t}):null}),c7e=({isExpanded:e})=>{const{idx:t,result:{backend_uuid:n},inFlight:r,isLastResult:s,isFirstResult:a,scrollToListItem:o,submitQuery:i}=Pt(),c=Ow(u=>u.results.find(d=>d.backend_uuid===n));return c?l.jsx(jO,{idx:t,result:c,inFlight:r,isLastResult:s,isFirstResult:a,scrollToListItem:o,submitQuery:i,children:l.jsx(l7e,{isExpanded:e})}):null};var ms;(function(e){e.COMPLETED="completed",e.ACTIVE="active",e.EXPECTED="expected",e.CANCELED="canceled"})(ms||(ms={}));var Jd;(function(e){e.DEFAULT_SEARCH="default_search",e.DEEP_RESEARCH="deep_research",e.LLM_COUNCIL="llm_council"})(Jd||(Jd={}));var sa;(function(e){e.TEXT="text",e.SOURCES="sources",e.CITED_MARKDOWN="cited_markdown",e.QUERIES="queries",e.WORKFLOW="workflow",e.USER_QUESTIONS="user_questions",e.DEPRECATED_ACTION="deprecated_action"})(sa||(sa={}));function u7e(e){switch(e){case"DEEP_RESEARCH":return Jd.DEEP_RESEARCH;case"LLM_COUNCIL":return Jd.LLM_COUNCIL;case"WORKFLOW_MODE_UNSPECIFIED":return Jd.DEFAULT_SEARCH;default:return}}function bH(e){switch(e){case"WORKFLOW_COMPLETED":return ms.COMPLETED;case"WORKFLOW_PENDING":return ms.ACTIVE;case"WORKFLOW_EXPECTED":return ms.EXPECTED;default:return ms.ACTIVE}}function d7e(e){switch(e.type){case"WORKFLOW_ITEM_TEXT":return{type:sa.TEXT,payload:{text:e.payload?.text_payload?.chunks?.[0]??e.payload?.text_payload?.text}};case"WORKFLOW_ITEM_SOURCES":return{type:sa.SOURCES,payload:{sources:e.payload?.sources_payload?.sources??[],assets:e.payload?.sources_payload?.assets??[]}};case"WORKFLOW_ITEM_QUERIES":return{type:sa.QUERIES,payload:{queries:e.payload?.queries_payload?.queries??[]}};case"WORKFLOW_ITEM_WORKFLOW":return{type:sa.WORKFLOW,payload:{workflow:_H(e.payload?.workflow_payload??{})}};case"WORKFLOW_ITEM_USER_QUESTIONS":return{type:sa.USER_QUESTIONS,payload:{userQuestions:e.payload?.user_questions_payload??{}}};default:return null}}function f7e(e){return{status:bH(e.status),title:e.title??"",started_at:e.started_at,completed_at:e.completed_at,items:e.items?.map(d7e).filter(t=>!!t)}}function _H(e){const t=e.mode==="WORKFLOW_MODE_UNSPECIFIED";return{version:"1.0",status:bH(e.status),mode:u7e(e.mode),model:e.model||void 0,headline:e.headline||void 0,showProgress:!t,steps:e.steps?.flatMap(f7e)??[],started_at:e.started_at||void 0,completed_at:e.completed_at||void 0,predicted_completion_at:e.predicted_completion_at||void 0}}var Gn;(function(e){e.SEND_EMAIL="send_email",e.FORWARD_EMAIL="forward_email",e.UPDATE_CALENDAR="update_calendar",e.CREATE_TASK="create_task",e.PICK_CONTACTS="pick_contacts",e.PICK_FLIGHTS="pick_flights",e.PICK_BOOKING="pick_booking",e.MCP_APPROVAL="mcp_approval",e.CLARIFYING_QUESTIONS="clarifying_questions",e.USER_CLARIFICATION="user_clarification"})(Gn||(Gn={}));function Le(e,t,n){return{status:t,title:e,items:[{type:sa.TEXT,payload:n?{text:n}:{}}]}}function Zn(e,t,n){return{status:t,title:e,items:[{type:sa.DEPRECATED_ACTION,payload:{action:n}}]}}function m7e(e,t,n){return{status:t,title:e,items:[{type:sa.QUERIES,payload:{queries:n}}]}}function Z1(e,t,n,r=[]){return{status:t,title:e,items:[{type:sa.SOURCES,payload:{sources:n,assets:r}}]}}function QA(e,t,n=""){if(e&&typeof e=="object"&&t in e){const r=e[t];return typeof r=="string"?r:n}return n}function p7e(e,t){const n=t?ms.COMPLETED:ms.ACTIVE;switch(e.step_type){case"SEARCH_WEB":{const r=e.content.queries??[],a=r.length>0&&r.every(i=>i.engine==="image")?"Searching for images":"Searching",o=r.map(i=>i.query);return m7e(a,n,o)}case"SEARCH_RESULTS":{const r=e.content.web_results;if(r.length===0)return Le("No sources found",n);if(r.every(a=>a.is_memory)){const a=r.length===1?"Reviewing memory":"Reviewing memories";return Z1(a,n,r)}if(r.every(a=>a.is_conversation_history))return Z1("Reviewing past queries",n,r);const s=r.length===1?"Reviewing source":"Reviewing sources";return Z1(s,n,r)}case"GET_URL_CONTENT":{const r=e.content.pages;if(r.length===0)return Le("No content found",n);const s=r.length>1?"Reading pages":"Reading page",a=r.slice(0,3).map(o=>o.url||"Unknown URL").join(", ");return Le(s,n,a)}case"ENTROPY_REQUEST":return Le("Browser action",n);case"CODE":return Le("Processing code",n);case"PDF":return Le("Creating PDF",n);case"DOCX":return Le("Creating Word document",n);case"XLSX":return Le("Creating spreadsheet",n);case"CREATE_APP_RESULT":return null;case"CREATE_CLIENT_APP":{const r=QA(e.content,"caption");return Le("Building application",n,r||void 0)}case"CREATE_CHART":{const r=QA(e.content,"caption");return Le("Creating chart",n,r||void 0)}case"CLARIFYING_QUESTIONS_OUTPUT":return e.content.clarification?Le("Clarification",n,e.content.clarification):null;case"IN_CONTEXT_SUGGESTIONS_OUTPUT":return e.content.selected_suggestion?Le("Suggestion",n,e.content.selected_suggestion):null;case"THOUGHT":return Le("Thinking",n,e.content.thought||void 0);case"URL_NAVIGATE":return Le("Navigating",n,e.content.urls?.join(", ")||void 0);case"BROWSER_OPEN_TAB_RESULTS":return Le("Opening tab",n,e.content.tab?.title||e.content.tab?.url||void 0);case"BROWSER_CLOSE_TABS_RESULTS":{const r=e.content.tabs;if(r.length===0)return Le("Failed to close tabs",n);const s=r.length===1?"Closed tab":`Closed ${r.length} tabs`;return Le(s,n)}case"READ_GMAIL":case"READ_EMAIL":{const r=e.content.queries?.length?e.content.queries.join(", "):void 0;return Le("Searching email",n,r)}case"READ_GMAIL_RESPONSE":case"READ_EMAIL_RESPONSE":{const r=e.content;if(!r?.authenticated||r?.count===0)return Le("No emails found",n);const s=r.count===1?"Reviewed 1 email":`Reviewed ${r.count} emails`;return Le(s,n)}case"READ_CALENDAR":{const r=e.content.queries?.join(", ");return Le("Searching calendar",n,r||void 0)}case"READ_CALENDAR_RESPONSE":{const r=e.content.count??0;if(!e.content.authenticated||r===0)return Le("No events found",n);const s=r===1?"Found 1 event":`Found ${r} events`;return Le(s,n)}case"UPDATE_CALENDAR":{const r=e.content;return r?.clarification?Zn("Scheduling",n,{type:Gn.USER_CLARIFICATION,payload:{question:r.clarification},submitted:t,stepUUID:e.uuid}):r?.operations&&r.operations.length>0?Zn("Updating calendar",n,{type:Gn.UPDATE_CALENDAR,payload:{goalId:r.goal_id,operations:r.operations},submitted:t,stepUUID:e.uuid}):Le("Updating calendar",n)}case"UPDATE_CALENDAR_RESPONSE":{const r=e.content?.operations;if(!r||r.length===0)return Le("Calendar updated",n);const s=r.length===1?"Completed 1 calendar update":`Completed ${r.length} calendar updates`;return Le(s,n)}case"CREATE_TASKS":{const r=e.content,s=r?.task_action;if(!s)return null;const a=s.event_group==="FINANCE"&&s.event_type&&s.event_entity;return Zn(a?"Setting up price alert":"Creating task",n,{type:Gn.CREATE_TASK,payload:{goalId:r?.goal_id,taskAction:s,isPriceAlert:!!a},submitted:t,stepUUID:e.uuid})}case"CREATE_TASKS_RESPONSE":return Le("Task created",n);case"SEND_GMAIL":case"SEND_EMAIL":{const r=e.content,s=r?.action;return r?.clarification?Zn("Sending email",n,{type:Gn.USER_CLARIFICATION,payload:{question:r.clarification},submitted:t,stepUUID:e.uuid}):s?.forward?Zn("Forwarding email",n,{type:Gn.FORWARD_EMAIL,payload:{goalId:r?.goal_id,action:s,email:s.forward.email},submitted:t,stepUUID:e.uuid}):s?.send||r?Zn("Sending email",n,{type:Gn.SEND_EMAIL,payload:{goalId:r?.goal_id,action:s,email:s?.send?.email},submitted:t,stepUUID:e.uuid}):Le("Sending email",n)}case"SEND_GMAIL_RESPONSE":case"SEND_EMAIL_RESPONSE":{const r=e.content?.status;return Le(r==="SENT"?"Email sent":r==="ERROR"?"Failed to send email":"Email processed",n)}case"EMAIL_CALENDAR_AGENT_RESPONSE":case"GMAIL_GCAL_AGENT_RESPONSE":return null;case"EMAIL_CALENDAR_AGENT":case"GMAIL_GCAL_AGENT":{const r=e.content.steps??[];if(r.length===0)return Le("Processing email and calendar",n);for(const o of r){if(o.send_email_response_content?.status==="REJECTED")return Le("Email canceled",ms.CANCELED);if(o.update_calendar_response_content?.operations?.some(c=>c.status==="REJECTED"))return Le("Calendar update canceled",ms.CANCELED)}const s=r[r.length-1];if(!s)return Le("Processing email and calendar",n);if(s.send_email_content){const o=s.send_email_content,i=o.action;return o.clarification?Zn("Sending email",n,{type:Gn.USER_CLARIFICATION,payload:{question:o.clarification},submitted:t,stepUUID:e.uuid}):i?.forward?Zn("Forwarding email",n,{type:Gn.FORWARD_EMAIL,payload:{goalId:o.goal_id,action:i,email:i.forward.email},submitted:t,stepUUID:e.uuid}):Zn("Sending email",n,{type:Gn.SEND_EMAIL,payload:{goalId:o.goal_id,action:i,email:i?.send?.email},submitted:t,stepUUID:e.uuid})}if(s.update_calendar_content){const o=s.update_calendar_content;if(o.clarification)return Zn("Scheduling",n,{type:Gn.USER_CLARIFICATION,payload:{question:o.clarification},submitted:t,stepUUID:e.uuid});if(o.operations&&o.operations.length>0)return Zn("Updating calendar",n,{type:Gn.UPDATE_CALENDAR,payload:{goalId:o.goal_id,operations:o.operations},submitted:t,stepUUID:e.uuid})}if(s.get_user_info_content){const o=s.get_user_info_content,i=o.found_users;if(i&&i.length>0&&!o.submitted){const c=i.length===1?"Found 1 contact":`Found ${i.length} contacts`;return Zn(c,n,{type:Gn.PICK_CONTACTS,payload:{goalId:o.goal_id,names:o.names,foundUsers:i},submitted:t||o.submitted,stepUUID:e.uuid})}}const a=s.step_type;return Le(a==="READ_EMAIL"||a==="READ_GMAIL"?"Searching email":a==="READ_CALENDAR"?"Searching calendar":a==="GET_FREEBUSY"?"Checking availability":"Processing email and calendar",n)}case"FLIGHTS_SEARCH":{const r=e.content;if(!r)return null;const s=r.found_flights;return s&&s.length>0&&!r.submitted?Zn("Searching flights",n,{type:Gn.PICK_FLIGHTS,payload:{goalId:r.goal_id,foundFlights:s,outboundDate:r.outbound_date,returnDate:r.return_date,flightType:r.flight_type},submitted:t||r.submitted,stepUUID:e.uuid}):Le("Searching flights",n)}case"FLIGHTS_SEARCH_RESPONSE":{const r=e.content?.selected_flight;if(!r)return null;const a=(r.flights||[]).map(o=>o.airline).filter(Boolean).join(", ");return Le("Looking for booking options",n,a||void 0)}case"FLIGHTS_BOOKING":{const r=e.content;if(!r)return null;const s=r.found_booking_options;if(s&&s.length>0){const o=s.length===1?"Found 1 booking option":`Found ${s.length} booking options`;return Zn(o,n,{type:Gn.PICK_BOOKING,payload:{goalId:r.goal_id,foundBookingOptions:s},submitted:t||r.submitted,stepUUID:e.uuid})}return Le("Looking for booking options",n)}case"FLIGHTS_BOOKING_RESPONSE":return Le("Opening booking site",n);case"FLIGHTS_AGENT":{const r=e.content.steps??[];if(r.length===0)return Le("Processing flights",n);const s=r[r.length-1];if(!s)return Le("Processing flights",n);if(s.flights_search_content){const a=s.flights_search_content,o=a.found_flights;return o&&o.length>0&&!a.submitted?Zn("Searching flights",n,{type:Gn.PICK_FLIGHTS,payload:{goalId:a.goal_id,foundFlights:o,outboundDate:a.outbound_date,returnDate:a.return_date,flightType:a.flight_type},submitted:t||a.submitted,stepUUID:e.uuid}):Le("Searching flights",n)}if(s.flights_booking_content){const a=s.flights_booking_content,o=a.found_booking_options;if(o&&o.length>0){const c=o.length===1?"Found 1 booking option":`Found ${o.length} booking options`;return Zn(c,n,{type:Gn.PICK_BOOKING,payload:{goalId:a.goal_id,foundBookingOptions:o},submitted:t||a.submitted,stepUUID:e.uuid})}return Le("Looking for booking options",n)}return Le("Processing flights",n)}case"TERMINATE":return Le("Wrapping up",n,e.content.reason||void 0);case"CANVAS_AGENT":{const r=e.content.asset_types??[],s={CODE_FILE:"file",PDF_FILE:"PDF",DOCX_FILE:"document",XLSX_FILE:"spreadsheet",APP:"app",SLIDES:"slides"},a=r.map(o=>s[o]||o).join(", ");return Le(`Creating ${a||"content"}`,n)}case"GENERATE_IMAGE":return Le("Generating image",n,e.content.prompt||void 0);case"GENERATE_VIDEO":return Le("Generating video",n,e.content.prompt||void 0);case"GENERATE_VIDEO_RESULTS":{const r=e.content.video_results?.length||0,s=r===1?"Generated 1 video":`Generated ${r} videos`;return Le(s,n)}case"BROWSER_GROUP_TABS":{const s=(e.content.payloads||[]).map(a=>a.title).filter(Boolean).join(", ");return Le("Grouping tabs",n,s||void 0)}case"BROWSER_GROUP_TABS_RESULTS":return e.content.success?Le("Grouped tabs",n):Le("Could not group tabs",n);case"BROWSER_UNGROUP":{const s=(e.content.payload?.groups_metadata||[]).map(a=>a.title).filter(Boolean).join(", ");return Le("Ungrouping tabs",n,s||void 0)}case"BROWSER_SEARCH_TAB_GROUPS":{const r=e.content.payload?.queries?.join(", ");return Le("Searching tab groups",n,r||void 0)}case"BROWSER_SEARCH_TAB_GROUPS_RESULT":{const r=e.content.results||[],s=r.length===1?"Found 1 tab group":`Found ${r.length} tab groups`;return Le(s,n)}case"GET_USER_INFO":{const r=e.content;if(!r||!r.names)return null;const s=r.found_users;if(s&&s.length>0&&!r.submitted){const a=s.length===1?"Found 1 contact":`Found ${s.length} contacts`;return Zn(a,n,{type:Gn.PICK_CONTACTS,payload:{goalId:r.goal_id,names:r.names,foundUsers:s},submitted:t||r.submitted,stepUUID:e.uuid})}return Le("Searching contacts",n,r.names.join(", "))}case"GET_USER_INFO_RESPONSE":{const r=e.content?.selected_users||[];if(r.length===0)return Le("No contacts found",n);const s=r.filter(o=>o.selected===!0).length;if(s>0){const o=s===1?"Selected 1 contact":`Selected ${s} contacts`;return Le(o,n)}const a=r.length===1?"Found 1 contact":`Found ${r.length} contacts`;return Le(a,n)}case"GET_FREEBUSY":{const r=e.content.free_busy_response?.available_periods?.length??0;if(r>0){const s=r===1?"Found 1 available time":`Found ${r} available times`;return Le(s,n)}return Le("Checking availability",n)}case"GET_FREEBUSY_RESPONSE":{const r=e.content.free_busy_response?.available_periods?.length??0;if(!e.content.authenticated)return Le("Calendar not connected",n);if(r===0)return Le("No availability found",n);const s=r===1?"Found 1 available time":`Found ${r} available times`;return Le(s,n)}case"PENDING_FILES":{const r=e.content.attachments||[],s=r.length===1?"Processing 1 file":`Processing ${r.length} files`;return Le(s,n)}case"SEARCH_BROWSER":{const r=e.content.queries?.filter(o=>o?.trim())||[],s=e.content.browser_content_sources||[],a=r.length>0?r.join(", "):s.join(", ")||void 0;return Le("Searching browser",n,a)}case"SEARCH_BROWSER_RESULTS":{const r=(e.content.open_tabs?.length||0)+(e.content.recently_closed_tabs?.length||0)+(e.content.history?.length||0);if(r===0)return Le("No browser sources found",n);const s=r===1?"Found 1 source":`Found ${r} sources`;return Le(s,n)}case"MCP_TOOL_INPUT":{const r=e.content,s=r.app||"external service",a=r.request_user_approval;return a?.request_user_approval?Zn(`Approve action for ${s}`,n,{type:Gn.MCP_APPROVAL,payload:{goalId:r.goal_id,toolName:r.tool_name,app:r.app,approvalUuid:a.uuid},submitted:t,stepUUID:e.uuid}):Le(`Connecting to ${s}`,n)}case"MCP_TOOL_OUTPUT":{const r=e.content.app||e.content.tool_name||"Tool";return Le(`${r} completed`,n)}case"CONNECTOR_DIRECT_SEARCH_INPUT":{const r=e.content.formatted_connection_type||"connector",s=e.content.queries,a=s&&s.length>0?s.join(", "):void 0;return Le(`Searching ${r}`,n,a)}case"RESEARCH_CLARIFYING_QUESTIONS":{const r=e.content,s=r.questions||[];if(s.length>0)return Zn("Clarifying questions",n,{type:Gn.CLARIFYING_QUESTIONS,payload:{uuid:r.uuid||e.uuid,questions:s,autoSkipSeconds:r.auto_skip_seconds},submitted:t,stepUUID:e.uuid});const a=s[0],o=typeof a=="string"?a:a?.question_text||void 0;return Le("Clarifying questions",n,o)}case"COMET_AGENT_TOOL_INPUT":{const r=e.content.tool_input;if(r?.todo_write){const s=r.todo_write.todos||[],a=s.length===1?"To-do: 1 item":`To-do: ${s.length} items`;return Le(a,n)}if(r?.subagent_tool_inputs)return Le("Running sub-tasks",n);if(r?.computer_list?.actions?.length){const s=r.computer_list.actions,a=s[s.length-1]?.action;return Le(a||"Working",n)}if(r?.navigate?.url){const s=r.navigate.url;return s==="forward"?Le("Going forward",n):s==="back"?Le("Going back",n):Le("Navigating",n,s)}return r?.bash?Le("Running command",n,r.bash.description||void 0):r?.find?.query?Le("Finding elements",n,r.find.query):r?.file_read?Le("Reading file",n,r.file_read.file_name||void 0):r?.file_write?Le("Writing file",n,r.file_write.file_name||void 0):r?.file_edit?Le("Editing file",n,r.file_edit.file_name||void 0):Le("Working",n)}case"COMET_AGENT_TOOL_OUTPUT":return e.content.tool_output?.enterprise_blocked?Le("Blocked by organization",n):null;default:return null}}function h7e(e){const t=e.every(c=>c.status==="finished"),n=e.some(c=>c.status==="loading"||c.status==="active"),r=t?ms.COMPLETED:n?ms.ACTIVE:ms.EXPECTED,s=e.filter(c=>!c.isFinalGoal),o=(s.length>0?s[s.length-1]:e[0])?.title||void 0,i=[];for(const c of e){const u=c.steps??[],d=c.status==="finished";for(const m of u){const p=p7e(m,d);p&&i.push(p)}}return{version:"1.0",status:r,headline:o,steps:i.length>0?i:void 0}}const g7e=Pe(async()=>{const{AnimatedWorkflowHeader:e}=await W(async()=>{const{AnimatedWorkflowHeader:t}=await import("./AnimatedWorkflowHeader-B4RfOQVC.js");return{AnimatedWorkflowHeader:t}},__vite__mapDeps([403,2,3,5,1,65,7,8,13,12,9,6,14,15,16,17]));return{default:e}}),y7e=Pe(async()=>{const{StaticHeader:e}=await W(async()=>{const{StaticHeader:t}=await import("./ProgressHeader-CAcQEW3W.js");return{StaticHeader:t}},__vite__mapDeps([404,2,3,5,1,7,8,13,12,9,6,14,15,16,17]));return{default:e}}),x7e=Pe(async()=>{const{Workflow:e}=await W(async()=>{const{Workflow:t}=await import("./Workflow-DWWtrH4d.js");return{Workflow:t}},__vite__mapDeps([405,2,3,5,1,6,7,8,9,65,13,12,14,15,16,17]));return{default:e}}),b7e=Pe(async()=>{const{DebugEntry:e}=await W(async()=>{const{DebugEntry:t}=await import("./DebugEntry-DTApjprN.js");return{DebugEntry:t}},__vite__mapDeps([406,2,3,407,22,12,1,9,5,7,8]));return{default:e}},{restricted:!0}),_7e=()=>{const{result:e,workflowStepsData:t,searchMode:n}=Pt(),{isPro:r,isMax:s}=Mt(),{createAssetClickHandler:a}=Dl(),o=xH(),[i,c]=f.useState("default"),u=s?"max":r?"pro":void 0,d=f.useMemo(()=>t?_H(t):h7e(o),[t,o]),m=f.useCallback(async(y,b,x)=>{await tu({contextUUID:e?.context_uuid,stepUUID:x,result:y,reason:b})},[e]),p=f.useCallback(()=>{c(y=>y==="default"?"chat":"default")},[]),h=n===K.AGENTIC_RESEARCH,g=f.useMemo(()=>a({backendUuid:e?.backend_uuid??"",contextUuid:e?.frontend_context_uuid}),[a,e?.backend_uuid,e?.frontend_context_uuid]);return l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx(b7e,{children:l.jsxs("button",{onClick:p,className:"self-start rounded-md bg-offset px-2 py-1 text-xs font-medium text-quiet hover:bg-subtle",children:["Variant: ",i]})}),l.jsx(x7e,{data:d,sendStepResult:m,entryUuid:e?.backend_uuid,variant:i,expanded:h,tier:u,onAssetClick:g})]})},J1=A.memo(function({isFastSearch:t,loading:n=!1}){const{hasAnyAgentSteps:r,isAnswerSkipped:s,response:a,isPending:o,isProcessingQuery:i,result:{backend_uuid:c,display_model:u,frontend_context_uuid:d,query_str:m},searchMode:p,steps:h,isFirstResult:g,isLastResult:y}=Pt(),b=f.useMemo(()=>y&&h.some(T=>T.step_type==="COMET_AGENT_TOOL_OUTPUT"&&T.content.tool_output?.call_site_specific_tool?.connector),[h,y]),[x,_]=f.useState(n),v=Nw(),{permission:C,requestPermission:w}=CR({windowsAppOnly:!1}),S=f.useCallback(()=>_(T=>!T),[]),E=f.useMemo(()=>{if(n)return!0;if(s)return!1;const T=!!a&&Yt.hasContent({chunks:a.chunks,answer:a.answer,structured_answer_blocks:a.structured_answer_blocks});return o&&!T},[o,a,s,n]);return f.useEffect(()=>{E||(p===K.AGENTIC_RESEARCH?_(!0):_(!!b))},[E,p,b]),v?t?null:l.jsx(_7e,{}):!r&&!i||!E&&t?null:l.jsxs("div",{className:"flex flex-col gap-sm",children:[l.jsx("div",{className:"flex items-center gap-x-md justify-between",children:E?l.jsx(g7e,{isFastSearch:t,steps:h,contextUUID:d,entryUUID:c,displayModel:u,queryString:m,searchMode:p,permission:C,isFirstResult:g,requestPermission:w}):l.jsx(y7e,{isExpanded:x,onToggleExpanded:S})}),!t&&l.jsx(c7e,{isExpanded:n||x})]})}),v7e=Pe(async()=>{const{MarkSpinner:e}=await W(async()=>{const{MarkSpinner:t}=await import("./MarkSpinner-DLLsyHlp.js");return{MarkSpinner:t}},__vite__mapDeps([54,2,3]));return{default:e}}),iQe=A.memo(function({title:t,titleIcon:n,titleAccessory:r,titleUrl:s,showPplxMark:a,queryStr:o,loading:i,className:c="mb-md"}){const{session:u}=je(),{trackEvent:d}=Ze(u),[m,p]=f.useState(!1),h=f.useCallback(()=>{s!=null&&(d("click result entry header",{query:o}),window.open(s,"_blank")?.focus())},[d,o,s]);return l.jsxs("div",{className:z("flex w-full items-center justify-between",c),children:[l.jsx("div",{onClick:h,className:z({"cursor-pointer":s!=null}),children:l.jsxs("div",{color:"super",className:"space-x-sm flex items-center",children:[(a||n)&&l.jsx(B,{variant:"section-title",as:"div",children:a?l.jsx("div",{className:"relative -top-px flex w-[24px] transform-gpu items-center justify-center",onClick:()=>{p(!0),setTimeout(()=>{p(!1)},0)},children:l.jsx(v7e,{size:24,shouldAnimate:i||m})}):n&&l.jsx("div",{className:"w-[24px]",children:l.jsx(_n,{icon:n,size:"large"})})}),l.jsx(B,{variant:"section-title",as:"div",children:t})]})}),r]})}),C7e=A.memo(function({header:t,children:n}){return l.jsxs(Y,{children:[t&&l.jsx(Y,{variant:"background",className:"flex items-center justify-between",children:t}),n]})}),w7e=({widgetType:e,widgetName:t})=>{const{session:n}=je(),{trackEvent:r}=Ze(n),{result:{backend_uuid:s,frontend_context_uuid:a}}=Pt(),o=f.useMemo(()=>({widgetType:e,widgetName:t,widgetLocation:"thread",position:0,frontendUUID:a,entryUUID:s}),[e,t,s,a]),i=f.useCallback(()=>{r("widget viewed",o)},[r,o]),c=f.useCallback(()=>{r("widget hovered",o)},[r,o]),u=f.useCallback(d=>{r("widget selected",{...o,widgetCTA:{type:"create_thread",permalink:d}})},[r,o]);return f.useMemo(()=>({widgetViewed:i,widgetHovered:c,widgetSelected:u}),[i,c,u])},ss=A.memo(function(t){const{children:n,...r}=t,{widgetSelected:s,widgetViewed:a,widgetHovered:o}=w7e(r),i=f.useRef({hovered:!1,viewed:!1}),{ref:c,isIntersecting:u}=aN({options:{threshold:.5},freezeOnceVisible:!0});f.useEffect(()=>{u&&!i.current.viewed&&(a(),i.current.viewed=!0)},[u,a]);const d=f.useCallback(()=>{i.current.hovered||(o(),i.current.hovered=!0)},[o]);return l.jsx("div",{ref:c,onMouseEnter:d,"data-testid":t.widgetType+"-widget",children:typeof n=="function"?n({widgetSelected:s}):n})}),Am=A.memo(({symbol:e,src:t,srcDark:n,className:r,size:s="lg",colorScheme:a})=>{n=n??t;const[o,i]=f.useState(!1),c=f.useRef(null),u=Cs(),d=a??u.colorScheme,m=()=>{c.current&&c.current.naturalHeight>0&&i(!1)};f.useEffect(()=>{c.current&&(c.current.complete&&c.current.naturalHeight===0?i(!0):i(!1))},[c]),f.useEffect(()=>{i(!1)},[e]);const p=d==="dark"?n:t;return l.jsx("div",{className:z({"size-lg":s==="lg","size-md":s==="md","size-sm":s==="sm"},"flex shrink-0 items-center justify-center",r),children:o||!p?l.jsx(S7e,{symbol:e}):l.jsx("img",{ref:c,src:p,alt:e,className:"size-full rounded-[4px] object-contain",onError:()=>{i(!0)},onLoad:m},e)})});Am.displayName="FinanceAssetLogo";const S7e=({symbol:e})=>{const t=f.useMemo(()=>e.replace(/[^a-zA-Z0-9]/g,"").slice(0,1).toUpperCase(),[e]);return l.jsx(Y,{variant:"subtle",className:"flex size-full items-center justify-center rounded-full",children:l.jsx(B,{color:"light",children:l.jsx("span",{className:"font-mono opacity-70",children:t||l.jsx(ut,{name:D("coin"),className:"size-4 text-gray-100 opacity-50"})})})})},E7e=async({ticker:e,reason:t})=>{const{data:n,error:r,response:s}=await ve.GET("/rest/tasks/finance/tickers/{ticker}",t,{params:{path:{ticker:e}},timeoutMs:Ct(),numRetries:wi});if(r)throw Z.error("Failed to get finance ticker",r),new Ue("API_CLIENTS_ERROR",{message:"Failed to get finance ticker",cause:r,status:s.status??0});return n},k7e=Pe(async()=>{const{AutomationModal:e}=await W(async()=>{const{AutomationModal:t}=await import("./AutomationModal-B7SFpMBA.js");return{AutomationModal:t}},__vite__mapDeps([408,2,3,5,1,6,7,8,9,13,12,14,15,16,17]));return{default:e}}),M7e=A.memo(function({symbol:t,buttonProps:n,watchlistAddedForSymbol:r,modalOpenedSource:s}){const{session:a}=je(),{trackEvent:o}=Ze(a),i=f.useMemo(()=>{try{return decodeURIComponent(t.toUpperCase())}catch{return t.toUpperCase()}},[t]),{data:c,isLoading:u}=gt({queryKey:Se.makeEphemeralQueryKey("getFinanceTicker",i),queryFn:()=>E7e({ticker:i,reason:"finance-ticker-supported-check"}),staleTime:1/0}),{isMobileStyle:d}=Be(),{$t:m}=Q(),p=!!c?.supported,h=!!(c?.supported&&r),g=r?`finance-alert-watchlist-${i}`:"finance-alert-page-visit",y=p||h,b=Vs(),{openModal:x}=Kt(),_=f.useCallback(()=>{o("price alert modal opened",{source:s}),x(k7e,{source:"settings_create",initialConfiguration:xCe({symbol:t,defaultSearchModel:b}),canEditSpace:!0,canDelete:!0})},[s,o,x,t,b]);return u||!c?.supported?null:l.jsx(eE,{cueKey:g,title:m({defaultMessage:"Set an alert for {ticker}",id:"bb+ueMBxHa"},{ticker:i}),enabled:y,side:"bottom",children:d?l.jsx(at,{size:"small",variant:"text",icon:D("trending-up"),onClick:_,"aria-label":m({id:"hrmMcFoV7/",defaultMessage:"Price Alert"}),rounded:n?.pill}):l.jsx(at,{size:"small",variant:"text",leadingIcon:D("trending-up"),onClick:_,pill:n?.pill,children:m({id:"hrmMcFoV7/",defaultMessage:"Price Alert"})})},g)}),T7e=(e,t)=>{const{value:n,loading:r}=Lt({flag:"tasks-free-user-access-enabled",defaultValue:e,extraAttributes:t,subjectType:"user_nextauth_id"});return f.useMemo(()=>({variation:n,loading:r}),[n,r])},uv=A.memo(function({symbol:t,buttonProps:n,watchlistAddedForSymbol:r}){const{hasAccessToProFeatures:s}=Mt(),{variation:a,loading:o}=T7e(!1);return o||!a&&!s?null:l.jsx(M7e,{symbol:t,buttonProps:n,watchlistAddedForSymbol:r,modalOpenedSource:"finance_asset_page"})});function A7e(){if(typeof window>"u")return!1;const e=window;return!!(e?.webkit?.messageHandlers?.pplx?.postMessage||e?.Android?.pplx?.postMessage)}function vH({type:e,data:t}){if(typeof window>"u")return!1;const n=window,r={type:e,data:t};return n?.webkit?.messageHandlers?.pplx?.postMessage?(n.webkit.messageHandlers.pplx.postMessage(r),!0):n?.Android?.pplx?.postMessage?(n.Android.pplx.postMessage(r),!0):!1}function N7e({query:e}){return vH({type:"pplx.ask",data:{query:e}})}const CH=Bt("CanonicalPageContext",{inApp:!1,preferredColorScheme:null,deviceId:null,appVersion:null,isIOS:!1,isAndroid:!1,client:null});A.memo(function({children:t,inApp:n}){const r=nn(),s=sr(),a=r?.get("mobile.deviceId")||null,o=r?.get("mobile.appVersion")||null,i=r?.get("mobile.preferredColorScheme")||null,c=r?.get("mobile.client")||null,u=c==="ios",d=c==="android";return f.useEffect(()=>{if(!s?.startsWith("/app")||!r)return;const m=["mobile.","version"],p=new URL(window.location.href.replace("/app",""));p.searchParams.forEach((h,g)=>{m.some(y=>g.startsWith(y))&&p.searchParams.delete(g)}),p.searchParams.set("referrer","canonical"),vH({type:"pplx.url.share",data:{url:p.href}})},[s,r]),l.jsx(CH.Provider,{value:{inApp:n,preferredColorScheme:i,deviceId:a,appVersion:o,isIOS:u,isAndroid:d,client:c},children:t})});function ao(){return f.useContext(CH)}const XA="pplx://www.pplx.com";function Py({href:e,inApp:t,queryParams:n}){if(!t||e==null)return e;const r=new URL(e,XA);return n?.forEach((s,a)=>{r.searchParams.get(a)||r.searchParams.set(a,s??"")}),r.pathname.startsWith("/app")||(r.pathname.startsWith("/")?r.pathname=`/app${r.pathname}`:r.pathname=`/app/${r.pathname}`),r.href.replace(XA,"")}const wH=()=>{const{scrollContainerRef:e}=xa();return f.useCallback(()=>{window.scrollTo({top:0,behavior:"instant"}),e?.current?.scrollTo({top:0,behavior:"instant"})},[e])},Oy=A.memo(function({children:t,href:n,...r}){const{inApp:s}=ao(),a=nn(),o=wH(),i=f.useCallback(c=>{o(),r.onClick?.(c)},[o,r]);return l.jsx(Dt,{...r,href:Py({href:n,inApp:s,queryParams:a}),onClick:i,children:t})});A.memo(function(t){const{inApp:n}=ao(),r=nn(),{href:s,...a}=t;return l.jsx(Al,{...a,href:Py({href:s,inApp:n,queryParams:r})??""})});A.memo(function(t){const n=t.href??void 0;return n?l.jsx(Oy,{...t,href:n}):t.children});const R7e=({value:e,format:t,suffix:n,animated:r})=>{const[s,a]=f.useState(!1);return f.useEffect(()=>{r&&Number.isFinite(e)&&a(!0)},[r,e]),l.jsx(Kd,{isolate:!0,value:e,format:t,suffix:n,animated:s})},D7e=!1,w3=A.memo(function({value:t,format:n,suffix:r,animated:s=D7e}){const{inApp:a}=ao(),{locale:o}=Q();return!s||a?l.jsxs("span",{children:[Intl.NumberFormat(o,n).format(t)," ",r]}):l.jsx(R7e,{value:t,format:n,suffix:r,animated:s})}),Ly={ENTITY_CHIP:"entity_chip",SEARCH_WIDGET:"search_widget",CHART_COMPARISON:"chart_comparison",SEARCH_AUTOSUGGEST:"search_autosuggest"},I7e={PREDICTIONS_WIDGET:"predictions_widget"},j7e={ASSET_PAGE:"asset"},Nm={ASSET_PAGE:"asset"},dv=A.memo(function({countryCode:t,square:n,...r}){const s=t??"NEU",a=n?`square/${s}`:s;return l.jsx("img",{src:`https://r2cdn.perplexity.ai/images/country_flags/${a}.svg`,alt:t??"NEU",...r})}),P7e={COMMODITY:"",FOREX:"FX",INDEX:"INDEX",CRYPTO:"CRYPTO"},Mf=A.memo(function({price:t,currency:n,sign:r,variant:s="small",className:a,animated:o,color:i="light"}){const c=f.useMemo(()=>({style:n?"currency":"decimal",currency:n||void 0,minimumFractionDigits:t<1e3?2:0,maximumFractionDigits:Math.abs(t)<.01?void 0:2,signDisplay:r?"exceptZero":void 0}),[n,t,r]);return l.jsx(B,{variant:s,color:i,className:a,children:l.jsx(w3,{value:t,format:c,animated:o})})}),S3=({name:e,variant:t="smallBold",className:n})=>e?l.jsx(B,{variant:t,className:z("min-w-0 truncate leading-tight",n),as:"span",children:e}):null,Rm=({symbol:e,exchange:t,country:n,gap:r="xs"})=>{const s=f.useMemo(()=>e&&decodeURIComponent(e).split(".")[0],[e]),a=f.useMemo(()=>t&&(P7e[t]??t),[t]);if(!s)return null;if(!a)return s;const o=n||null;return l.jsxs(Ao,{className:z("whitespace-nowrap",{"gap-xs":r==="xs","gap-sm":r==="sm"}),children:[l.jsx(Un,{id:"symbol",children:s}),l.jsx(Un,{id:"exchange",children:a}),o&&l.jsx(Un,{id:"country",children:l.jsxs("div",{className:"relative flex w-[1.2em] shrink-0 items-center",children:[l.jsx(dv,{countryCode:o}),l.jsx("div",{className:"absolute inset-0 border border-black/10 dark:border-0"})]})})]})},SH=({symbol:e,children:t,className:n,referrer:r})=>{const{inApp:s}=ao(),a=nn(),o=Py({href:`/finance/${e}`,inApp:s,queryParams:a}),{session:i}=je(),{trackEvent:c}=Ze(i),u=wH(),d=f.useCallback(()=>{u(),r&&c("finance link clicked",{referrer:r,targetPageType:Nm.ASSET_PAGE,symbol:e,destinationUrl:`/finance/${e}`})},[r,e,c,u]);return l.jsx(Dt,{href:o,className:z("py-sm px-md hover:bg-subtler block duration-quick",n),onClick:d,children:t})},O7e=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"perplexity-finance-uxr-prompt",defaultValue:e,extraAttributes:t,subjectType:"user_nextauth_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},L7e="https://perplexity.typeform.com/to/RVdImD2J",F7e=A.memo(function(){const{session:t}=je(),{isLargeScreen:n}=Ll(),{variation:r,loading:s}=O7e(!1),{shouldShow:a,setReachedImpressions:o}=nP({cueKey:FY,impressionsLimit:5,enabled:r&&!!t}),i=f.useCallback(()=>{o(),window.open(L7e,"_blank","noopener,noreferrer")},[o]);return!!t&&(r&&!s)&&n&&a?l.jsx(SP,{borderRadius:9,borderGradientStops:"oklch(var(--foreground-subtler-color)) 135deg, oklch(var(--default-color)) 180deg, oklch(var(--foreground-subtler-color)) 225deg",children:l.jsx(at,{size:"small",variant:"text",onClick:i,leadingIcon:D("message"),children:l.jsx(be,{defaultMessage:"Share your thoughts",id:"4esJxyhqCI"})})}):null}),U7e=A.memo(function({isFollowed:t,toggleFollow:n,iconOnly:r=!1,size:s="small",selectedButtonClassName:a,unselectedButtonClassName:o,tooltip:i,variant:c}){const u=Q(),{isMobileStyle:d}=Be();return l.jsx(Wt,{mode:"wait",children:t?l.jsx(ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.2,ease:rr},children:l.jsx(st,{variant:c??"primaryGhost",pill:!0,size:s,text:d||r?void 0:u.formatMessage({defaultMessage:"Following",id:"cPIKU2QdyN"}),onClick:n,extraCSS:a,toolTip:i,icon:D("star-filled")})},"confirmed"):l.jsx(ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.2,ease:rr},children:l.jsx(st,{pill:!0,variant:c,icon:D("plus"),size:s,text:d||r?void 0:u.formatMessage({defaultMessage:"Follow",id:"ieGrWod3CN"}),onClick:n,extraCSS:o,toolTip:i})},"follow")})}),B7e=Se.makeEphemeralQueryKey("/rest/homepage-widgets");Se.makeEphemeralQueryKey("/rest/homepage/weather");const H7e=async({watchlistType:e,identifier:t,reason:n})=>{try{const{error:r,response:s}=await ve.PUT("/rest/homepage-widgets/watchlist/subscription",n,{params:{query:{type:e,identifier:t??""}},headers:{"content-type":"application/json"}});if(r)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to add watchlist subscription",cause:r,status:s.status??0});return!0}catch(r){return Z.error(r),!1}},lQe="pplx.watchlist",_g=e=>Se.makeEphemeralQueryKey("watchlist",e,"subscriptions"),V7e=e=>Se.makeEphemeralQueryKey("watchlist",e,"addSubscription"),G7e=e=>Se.makeEphemeralQueryKey("watchlist",e,"removeSubscription"),cQe=e=>Se.makeEphemeralQueryKey("watchlist",e,"updateSubscription"),z7e=({watchlistType:e,queryClient:t,reason:n})=>{const r=_g(e);return on({mutationKey:V7e(e),mutationFn:async s=>H7e({watchlistType:e,reason:n,...s}),onMutate:async({identifier:s,description:a,image:o,title:i})=>{await t.cancelQueries({queryKey:r});const c=t.getQueryData(_g(e));return t.setQueryData(r,(u=[])=>{const d={identifier:s??"",description:a??"",image_url:o??"",title:i??"",subscribed:!0,order:Date.now()},m=u.filter(p=>p.identifier!==s);return[d,...m]}),{previousSubscriptions:c}},onError:(s,a,o)=>{Z.error("Error adding watchlist subscription",s),t.setQueryData(r,o?.previousSubscriptions)},onSuccess:()=>{t.invalidateQueries({queryKey:r})}})},q7e=async({watchlistType:e,identifier:t,reason:n})=>{try{const{error:r,response:s}=await ve.DELETE("/rest/homepage-widgets/watchlist/subscription",n,{params:{query:{type:e,identifier:t}},headers:{"content-type":"application/json"}});if(r)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to remove watchlist subscription",cause:r,status:s.status??0});return!0}catch(r){return Z.error(r),!1}},$7e=({watchlistType:e,queryClient:t,reason:n})=>{const r=_g(e);return on({mutationKey:G7e(e),mutationFn:async s=>q7e({watchlistType:e,reason:n,...s}),onSuccess:()=>{t.invalidateQueries({queryKey:r})},onMutate:async({identifier:s})=>{await t.cancelQueries({queryKey:r});const a=t.getQueryData(["watchlist",e]);return t.setQueryData(r,(o=[])=>o.filter(i=>i.identifier!==s)),{previousSubscriptions:a}},onError:(s,a,o)=>{Z.error("Error removing watchlist subscription",s),t.setQueryData(r,o?.previousSubscriptions)}})},W7e=async({watchlistType:e,reason:t})=>{try{const{error:n,data:r,response:s}=await ve.GET("/rest/homepage-widgets/watchlist/subscription",t,{params:{query:{type:e}},headers:{"content-type":"application/json"},numRetries:1});if(n)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to get watchlist subscriptions",cause:n,status:s.status??0});return r.results??[]}catch(n){return Z.error(n),[]}},K7e=({watchlistType:e,reason:t})=>{const n=wt(),r=_g(e);return gt({queryKey:r,queryFn:()=>W7e({watchlistType:e,reason:t}),staleTime:0,enabled:n})},Y7e=Pe(async()=>{const{LoginModal:e}=await W(async()=>{const{LoginModal:t}=await import("./LoginModal-D844be60.js");return{LoginModal:t}},__vite__mapDeps([48,2,3,5,1,6,7,8,9,10,11,12,13,49,14,15,16,17]));return{default:e}}),Q7e=({watchlistType:e,identifier:t,category:n,modalOrigin:r,loginPrompt:s,reason:a})=>{const{$t:o}=Q(),i=It(),c=wt(),{openModal:u}=Kt(),[d,m]=f.useState(!1),[p,h]=f.useState(!1),{data:g,isLoading:y}=K7e({watchlistType:e,reason:a}),{mutate:b}=z7e({watchlistType:e,queryClient:i,reason:a}),{mutate:x}=$7e({watchlistType:e,queryClient:i,reason:a}),_=f.useMemo(()=>{const C=w=>{const S=w.identifier===t;return n?S&&w.categories?.includes(n):S};return!!g?.some(C)},[g,t,n]),v=f.useCallback(C=>{const{invalidateOnSuccess:w=!0}=C??{};if(m(!1),h(!1),!c){o({defaultMessage:"Sign in to follow your interests",id:"ebRSvhaBXI"}),u(Y7e,{pitchMessage:{title:s},origin:r});return}_?(x({identifier:t}),h(!0)):(b({identifier:t}),m(!0)),w&&i.invalidateQueries({queryKey:B7e})},[o,b,t,_,c,s,r,u,i,x]);return f.useMemo(()=>({isFollowed:_,toggleFollow:v,showFollowToast:d,showUnfollowToast:p,setShowFollowToast:m,setShowUnfollowToast:h,isLoadingSubscriptions:y}),[_,y,d,p,v])},ui={type:"spring",stiffness:700,damping:50},ZA=A.memo(function({message:t,isVisible:n=!1,timeout:r,onSettingsClick:s,onTimeout:a=jr,icon:o,...i}){const[c,u]=f.useState(n),d=f.useRef(null),{$t:m}=Q();f.useEffect(()=>{u(n)},[n]);const p=f.useCallback(()=>{d.current&&clearTimeout(d.current)},[]),h=f.useCallback(y=>{y?.stopPropagation(),u(!1),a(),p()},[a,p]),g=r!=null&&r>0;return f.useEffect(()=>(n&&g&&(d.current=setTimeout(()=>{h()},r*1e3)),()=>{p()}),[c,r,n,a,h,p,g]),l.jsx(yu,{children:l.jsx(Wt,{children:c&&l.jsx(ze.div,{className:"right-toastHMargin top-toastVMargin fixed z-30 flex items-center justify-center",initial:{opacity:0,x:6},animate:{opacity:1,x:0},exit:{opacity:0,x:6},transition:ui,...i,children:l.jsxs(Y,{variant:"raised",className:"shadow-subtle gap-sm flex items-stretch rounded-xl border pl-[12px] dark:shadow-[0_4px_12px_rgba(0,0,0,0.5)]",children:[o&&l.jsx("div",{className:"p-sm bg-subtler dark:bg-subtle my-[12px] flex aspect-square items-center justify-center rounded-md",children:l.jsx(ye,{icon:o,className:"text-quiet",size:"md"})}),l.jsxs("div",{className:"flex flex-1 flex-row items-center justify-between",children:[l.jsx(B,{variant:"tiny",color:"default",className:"pl-sm max-w-[200px] shrink-0 pr-[12px]",children:t}),l.jsxs(Y,{className:"flex h-full flex-col items-stretch justify-center border-l",children:[l.jsx(pt,{size:"tiny",variant:"noHover",text:m({defaultMessage:"Settings",id:"D3idYvSLF9"}),onClick:s,extraCSS:"!px-[12px] flex-1 hover:opacity-60"}),l.jsx(Y,{className:"border-t"}),l.jsx(pt,{size:"tiny",variant:"noHover",text:m({defaultMessage:"Dismiss",id:"TDaF6JVgG6"}),onClick:h,extraCSS:"!px-[12px] flex-1 hover:opacity-60"})]})]})]})},"toast")})})}),JA=Pe(async()=>{const{WatchlistModal:e}=await W(async()=>{const{WatchlistModal:t}=await import("./WatchlistModal-C6GPcFrF.js");return{WatchlistModal:t}},__vite__mapDeps([409,3,2,12,1,9,5,7,8,6,13,14,15,16,17]));return{default:e}}),X7e=({followed:e,toggleFollow:t,isLoading:n})=>n?null:l.jsx(U7e,{isFollowed:e,toggleFollow:t,size:"small",variant:e?"primaryGhost":"border"}),EH=A.memo(function({symbol:t,button:n,onFollowToastTimeout:r}){const s="finance-watch-entity",{inApp:a}=ao(),{$t:o}=Q(),{isFollowed:i,toggleFollow:c,showFollowToast:u,showUnfollowToast:d,setShowFollowToast:m,setShowUnfollowToast:p,isLoadingSubscriptions:h}=Q7e({watchlistType:"FINANCE",identifier:t,modalOrigin:Ke.FINANCE_WATCHLIST,loginPrompt:"Sign in to manage your data",reason:s}),g=n||X7e,{openModal:y}=Kt(),b=f.useCallback(()=>{m(!1),r?.()},[r,m]),x=f.useCallback(()=>p(!1),[p]),_=f.useCallback(()=>{y(JA,{watchlistType:"FINANCE",origin:"toast"}),m(!1)},[y,m]),v=f.useCallback(()=>{y(JA,{watchlistType:"FINANCE",origin:"toast"}),p(!1)},[y,p]);return l.jsxs(l.Fragment,{children:[l.jsx(ZA,{message:o({defaultMessage:"Added {symbol} to your watchlist",id:"KBhWJYPNym"},{symbol:t}),isVisible:u,timeout:5,onTimeout:b,onSettingsClick:_,icon:D("star-filled")}),l.jsx(ZA,{message:o({defaultMessage:"Removed {symbol} from your watchlist",id:"q+PA0pNibu"},{symbol:t}),isVisible:d,onSettingsClick:v,timeout:5,onTimeout:x,icon:D("star-off")}),!a&&l.jsx(g,{isLoading:h,followed:i,toggleFollow:c})]})}),kH=({followed:e,toggleFollow:t,isLoading:n})=>{const r=Q(),{isMobileStyle:s}=Be(),a=r.formatMessage({defaultMessage:"Following",description:"Button label indicating the user is following a stock/asset in their watchlist",id:"hCeJnN8nCo"}),o=r.formatMessage({defaultMessage:"Follow",description:"Button label to add a stock/asset to the watchlist",id:"U6yKFg9l3u"});return n?null:s?l.jsx(at,{icon:e?D("star-filled"):D("star"),size:"small",variant:"text",onClick:t,"aria-label":e?a:o}):l.jsx(at,{leadingIcon:e?D("star-filled"):D("star"),size:"small",variant:"text",onClick:t,children:e?a:o})},uQe=A.memo(function({symbol:t,name:n,image:r,imageDark:s,exchange:a,country:o,children:i,colorScheme:c,rightChild:u}){const{isMobileStyle:d}=Be(),{inApp:m}=ao();mu("header");const[p,h]=f.useState(!1);f.useEffect(()=>{h(!1)},[t]);const g=f.useCallback(()=>{h(!0)},[]),y=t&&!m?l.jsxs("div",{className:"flex items-center gap-xs",children:[l.jsx(F7e,{}),l.jsx(EH,{symbol:t,button:kH,onFollowToastTimeout:g}),l.jsx(uv,{symbol:t,watchlistAddedForSymbol:p})]}):m&&t?l.jsx(uv,{symbol:t,buttonProps:{pill:!0}}):null;return l.jsxs(Y,{className:"gap-md flex min-w-0 flex-col",children:[l.jsxs(Y,{className:"gap-sm flex items-start justify-between",children:[l.jsxs("div",{className:"flex min-w-0 items-start justify-start gap-sm",children:[l.jsx(Am,{src:r??"",srcDark:s??"",symbol:t??"",className:"!size-[40px] shrink-0 mt-1",colorScheme:c}),l.jsx(wn,{content:n??"",disabled:!d,children:l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx(B,{variant:d?"section-title":"page-title",className:"min-w-0 leading-tight break-words",children:n}),l.jsx(B,{variant:"tinyMono",color:"light",children:l.jsx(Rm,{symbol:t,exchange:a,gap:"xs",country:o})})]})})]}),u!==void 0?u:y]}),i]})}),vg=A.memo(function({isScreenshotEnv:t}){const{$t:n}=Q();return l.jsxs("div",{className:z("pointer-events-none flex items-center whitespace-nowrap px-sm py-xs rounded-full shadow-[0_0_16px_8px_oklch(var(--background-base-color)/0.6)] dark:shadow-[0_0_16px_8px_oklch(var(--offset-color)/0.6)]",t?"bg-base":"bg-background/90 backdrop-blur-sm"),children:[l.jsx(B,{variant:"tiny",inline:!0,className:"mr-xs mt-px",children:n({defaultMessage:"Powered by",id:"U8QBHORZRD"})}),l.jsx(xi,{variant:"full",size:"small"})]})}),Zs=(e,t,n)=>{if(e==null||e===void 0)return null;const r=2;let s=Math.min(r,t.maxDecimals??r);const a=Math.min(r,t.maxDecimals??r);return e>1e5&&(s=1),e.toLocaleString(t.locale,{style:t.currency?"currency":"decimal",notation:"standard",currency:t.currency,minimumFractionDigits:s,maximumFractionDigits:a,...n})};function e6(e,t,n,r){return e==null||t==null?null:r({defaultMessage:"{low}-{high}",id:"sOdwcvTtKN"},{low:Zs(e,n),high:Zs(t,n)})}const t6=(e,t,n)=>e==null||e===void 0?null:e.toLocaleString(t.locale,{style:"decimal",notation:"standard",...n});function Z7e(e,t=6){if(e===0)return{minimumFractionDigits:0,maximumFractionDigits:1};let n=0,r=2;if(e!==0&&Math.abs(e)<1){let s=0,a=Math.abs(e);for(;a<1&&s<t;)a*=10,s++;n=Math.max(0,s-1),r=s}return{minimumFractionDigits:n,maximumFractionDigits:r}}const eb=(e,t,n)=>{if(e==null||e===void 0)return null;let{minimumFractionDigits:r,maximumFractionDigits:s}=Z7e(e,6);return r=r,s=s,r>s&&(s=r),e*100>.001&&(r=2,s=2),e===0?"":e.toLocaleString(t.locale,{style:"percent",...n,minimumFractionDigits:r,maximumFractionDigits:s})},J7e={previousClose:e=>Zs(e.d.previousClose,e),open:e=>Zs(e.d.open,e),dayRange:e=>e6(e.d.dayLow,e.d.dayHigh,e,e.$t),yearRange:e=>e6(e.d.yearLow,e.d.yearHigh,e,e.$t),eps:e=>Zs(e.d.eps,e),dayHigh:e=>Zs(e.d.dayHigh,e),dayLow:e=>Zs(e.d.dayLow,e),marketCap:e=>Zs(e.d.marketCap,e,{notation:"compact",minimumFractionDigits:2}),pe:e=>{const t=e.d.pe;return t&&t<0?"":t6(t,e,{minimumFractionDigits:2})},dividendYieldTTM:e=>eb(e.d.dividendYieldTTM,e),volume:e=>t6(e.d.volume,e,{maximumFractionDigits:2,minimumFractionDigits:2,notation:"compact"}),dollarVolume24h:e=>Zs(e.d.dollarVolume24h,e,{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2}),volumeChange24h:e=>eb(e.d.volumeChange24h,e),yearHigh:e=>Zs(e.d.yearHigh,e),yearLow:e=>Zs(e.d.yearLow,e),fundingRate:e=>eb(e.d.fundingRate?+e.d.fundingRate*100:null,e)};function e8e({quote:e,currency:t,locale:n,$t:r}){return(e.uiHints?.tableFields??[]).map(o=>{const i=J7e[o];if(!i)return null;const c=i({d:e,locale:n,currency:t,$t:r});return c==null?null:{value:c,label:o,id:o}}).filter(o=>o!==null)}const t8e=({dt:e,dd:t,id:n})=>{const{isMobileStyle:r}=Be(),{breakpoint:s}=Ll(),a=["md","sm"].includes(s)&&r;return l.jsxs("div",{className:"gap-x-sm py-xs px-sm md:p-sm bg-raised flex flex-col gap-y-0.5 whitespace-nowrap md:flex-row md:justify-between",children:[l.jsx("dt",{children:l.jsx(B,{variant:a?"micro":"small",color:"light",children:e})}),l.jsx("dd",{children:l.jsx(B,{variant:a?"tiny":"smallBold",children:t})})]},n)},n6=({children:e})=>l.jsx(Y,{variant:"background",children:e}),n8e=A.memo(function({entries:t,context:n}){const r=(3-t.length%3)%3,s=n==="thread",a=n==="canonical"||n==="thread";return l.jsx("div",{className:"scrollbar-subtle overflow-x-auto",children:l.jsxs(Y,{className:z("grid grid-cols-3 gap-px",s?"w-full":"min-w-max",a&&"border-x-0"),variant:"subtler",children:[t.map(({label:o,value:i})=>l.jsx(n6,{children:l.jsx(t8e,{dt:o,dd:i,id:o})},o)),Array.from({length:r}).map((o,i)=>l.jsx(n6,{},i))]})})}),r8e=Me({finance:{defaultMessage:"Finance",id:"Fm3M+yFIbr"},analysis:{defaultMessage:"Analysis",id:"VMIM8/fAKn"},companyOverview:{defaultMessage:"Overview",id:"9uOFF3L8kp"},balanceSheet:{defaultMessage:"Balance Sheet",id:"ak91fL/u+x"},incomeStatement:{defaultMessage:"Income Statement",id:"HFT+V86brH"},keyStats:{defaultMessage:"Key Stats",id:"0FPlBr741P"},cashFlow:{defaultMessage:"Cash Flow",id:"mtw9A2k000"},date:{defaultMessage:"Date",id:"P7PLVjLe4f"},marketSummary:{defaultMessage:"Market Summary",id:"/4s4TMc/a+"},price:{defaultMessage:"Price",id:"b1zuN9KTHI"},symbol:{defaultMessage:"Symbol",id:"3HepmQoEZ+"},value:{defaultMessage:"Value",id:"GufXy52FNI"},percentage:{defaultMessage:"Percentage",id:"HyMpO2UIBG"},currency:{defaultMessage:"Currency",id:"55hdQy4uHO"},open:{defaultMessage:"Open",id:"JfG49wNHKP"},dayHigh:{defaultMessage:"High",id:"AxMhQrcUDC"},dayLow:{defaultMessage:"Low",id:"477I0ggSYe"},marketCap:{defaultMessage:"Market Cap",id:"9Mp3OYduig"},pe:{defaultMessage:"P/E Ratio",id:"fWnwRImZ9W"},volume24h:{defaultMessage:"24H Volume",id:"w7Tm/B63El"},dollarVolume24h:{defaultMessage:"24H Volume",id:"w7Tm/B63El"},volumeChange24h:{defaultMessage:"24H Volume Change",id:"CndnNLlEs+"},fundingRate:{defaultMessage:"Funding Rate",id:"CB1174SKrI"},volume:{defaultMessage:"Volume",id:"y867VsgbzT"},yearHigh:{defaultMessage:"Year High",id:"yh2gWeU/Gz"},yearLow:{defaultMessage:"Year Low",id:"fZpEs5CIaC"},avgVolume:{defaultMessage:"Avg. Volume",id:"MDNqWO8yDU"},dayRange:{defaultMessage:"Day Range",id:"6VJrMyvXcR"},yearRange:{defaultMessage:"52W Range",id:"FkJo44zhH6"},eps:{defaultMessage:"EPS",id:"JncK2a8+G4"},dividendYieldTTM:{defaultMessage:"Dividend Yield",id:"P3CiJnt5+6"},dividendYielTTM:{defaultMessage:"Dividend Yield",id:"P3CiJnt5+6"},previousClose:{defaultMessage:"Prev Close",id:"0jUP9zUh5z"},priceComparison:{defaultMessage:"Price Comparison",id:"MFuchsfwj7"},stockPerformance:{defaultMessage:"Stock Performance",id:"qEQxp1ikMt"},companyFinancials:{defaultMessage:"{company} Financials",id:"gWNvqjwoWh"},"13FFilings":{defaultMessage:"13F Filings",id:"XzGhyAgjmS"},pricePerformance:{defaultMessage:"Price & Performance",id:"nCv3Ti2cp5"},peers:{defaultMessage:"Peers",id:"JjgJTAa2wL"},transcriptLogin:{defaultMessage:"Login to view transcripts from {quartr}",id:"xY8csKCosL"},newsAndMarketInsights:{defaultMessage:"Latest News",id:"BlFeZAX10O"},recentTranscripts:{defaultMessage:"Recent Transcripts",id:"tiSu9ozyS4"},earnings:{defaultMessage:"Earnings",id:"14sEVuq+Kb"},related:{defaultMessage:"Related",id:"KQsZBWlEw/"},topMovers:{defaultMessage:"Top Movers",id:"e+JmwAUicC"}}),s8e=(e,t)=>{if(!t)return"";const n=r8e[t];return n?e(n):""},a8e=A.memo(function({quote:t,context:n}){const{$t:r,locale:s}=Q(),a=f.useMemo(()=>t?e8e({quote:t,currency:t?.currency||void 0,locale:s,$t:r}).map(i=>({...i,label:s8e(r,i.label),value:i.value})):[],[t,r,s]);return mu("financial-profile",{skip:!a.length}),l.jsx(Y,{"data-testid":"financial-profile-box",variant:"subtle",noBorder:!0,className:z("overflow-hidden border-t border-subtlest",{"border-x-0":n==="canonical"||n==="thread","rounded-none":n==="thread","border-b rounded-b-xl":n!=="thread"}),children:l.jsx(n8e,{entries:a,context:n})})}),Tf=30,o8e=({isMobileStyle:e,threshold:t=700})=>{const n=f.useRef(null),[r,s]=f.useState("lg");return f.useEffect(()=>{const o=n.current;if(!o)return;const i=()=>{const u=o.clientWidth;s(u<t?"sm":"lg")};i();const c=new ResizeObserver(()=>{i()});return c.observe(o),()=>{c.disconnect()}},[t]),{variant:e?"sm":r,containerRef:n}};var fv=Math.PI,mv=2*fv,qi=1e-6,i8e=mv-qi;function pv(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Ss(){return new pv}pv.prototype=Ss.prototype={constructor:pv,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,s,a){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+s)+","+(this._y1=+a)},arcTo:function(e,t,n,r,s){e=+e,t=+t,n=+n,r=+r,s=+s;var a=this._x1,o=this._y1,i=n-e,c=r-t,u=a-e,d=o-t,m=u*u+d*d;if(s<0)throw new Error("negative radius: "+s);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(m>qi)if(!(Math.abs(d*i-c*u)>qi)||!s)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var p=n-a,h=r-o,g=i*i+c*c,y=p*p+h*h,b=Math.sqrt(g),x=Math.sqrt(m),_=s*Math.tan((fv-Math.acos((g+m-y)/(2*b*x)))/2),v=_/x,C=_/b;Math.abs(v-1)>qi&&(this._+="L"+(e+v*u)+","+(t+v*d)),this._+="A"+s+","+s+",0,0,"+ +(d*p>u*h)+","+(this._x1=e+C*i)+","+(this._y1=t+C*c)}},arc:function(e,t,n,r,s,a){e=+e,t=+t,n=+n,a=!!a;var o=n*Math.cos(r),i=n*Math.sin(r),c=e+o,u=t+i,d=1^a,m=a?r-s:s-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+c+","+u:(Math.abs(this._x1-c)>qi||Math.abs(this._y1-u)>qi)&&(this._+="L"+c+","+u),n&&(m<0&&(m=m%mv+mv),m>i8e?this._+="A"+n+","+n+",0,1,"+d+","+(e-o)+","+(t-i)+"A"+n+","+n+",0,1,"+d+","+(this._x1=c)+","+(this._y1=u):m>qi&&(this._+="A"+n+","+n+",0,"+ +(m>=fv)+","+d+","+(this._x1=e+n*Math.cos(s))+","+(this._y1=t+n*Math.sin(s))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function $t(e){return function(){return e}}var r6=Math.abs,Sr=Math.atan2,Vi=Math.cos,l8e=Math.max,tb=Math.min,ka=Math.sin,Cc=Math.sqrt,zr=1e-12,Af=Math.PI,Cg=Af/2,Ah=2*Af;function c8e(e){return e>1?0:e<-1?Af:Math.acos(e)}function s6(e){return e>=1?Cg:e<=-1?-Cg:Math.asin(e)}function u8e(e){return e.innerRadius}function d8e(e){return e.outerRadius}function f8e(e){return e.startAngle}function m8e(e){return e.endAngle}function p8e(e){return e&&e.padAngle}function h8e(e,t,n,r,s,a,o,i){var c=n-e,u=r-t,d=o-s,m=i-a,p=m*c-d*u;if(!(p*p<zr))return p=(d*(t-a)-m*(e-s))/p,[e+p*c,t+p*u]}function Ap(e,t,n,r,s,a,o){var i=e-n,c=t-r,u=(o?a:-a)/Cc(i*i+c*c),d=u*c,m=-u*i,p=e+d,h=t+m,g=n+d,y=r+m,b=(p+g)/2,x=(h+y)/2,_=g-p,v=y-h,C=_*_+v*v,w=s-a,S=p*y-g*h,E=(v<0?-1:1)*Cc(l8e(0,w*w*C-S*S)),T=(S*v-_*E)/C,k=(-S*_-v*E)/C,M=(S*v+_*E)/C,N=(-S*_+v*E)/C,P=T-b,O=k-x,L=M-b,H=N-x;return P*P+O*O>L*L+H*H&&(T=M,k=N),{cx:T,cy:k,x01:-d,y01:-m,x11:T*(s/w-1),y11:k*(s/w-1)}}function g8e(){var e=u8e,t=d8e,n=$t(0),r=null,s=f8e,a=m8e,o=p8e,i=null;function c(){var u,d,m=+e.apply(this,arguments),p=+t.apply(this,arguments),h=s.apply(this,arguments)-Cg,g=a.apply(this,arguments)-Cg,y=r6(g-h),b=g>h;if(i||(i=u=Ss()),p<m&&(d=p,p=m,m=d),!(p>zr))i.moveTo(0,0);else if(y>Ah-zr)i.moveTo(p*Vi(h),p*ka(h)),i.arc(0,0,p,h,g,!b),m>zr&&(i.moveTo(m*Vi(g),m*ka(g)),i.arc(0,0,m,g,h,b));else{var x=h,_=g,v=h,C=g,w=y,S=y,E=o.apply(this,arguments)/2,T=E>zr&&(r?+r.apply(this,arguments):Cc(m*m+p*p)),k=tb(r6(p-m)/2,+n.apply(this,arguments)),M=k,N=k,P,O;if(T>zr){var L=s6(T/m*ka(E)),H=s6(T/p*ka(E));(w-=L*2)>zr?(L*=b?1:-1,v+=L,C-=L):(w=0,v=C=(h+g)/2),(S-=H*2)>zr?(H*=b?1:-1,x+=H,_-=H):(S=0,x=_=(h+g)/2)}var R=p*Vi(x),I=p*ka(x),F=m*Vi(C),G=m*ka(C);if(k>zr){var j=p*Vi(_),$=p*ka(_),q=m*Vi(v),U=m*ka(v),X;if(y<Af&&(X=h8e(R,I,q,U,j,$,F,G))){var J=R-X[0],ne=I-X[1],ae=j-X[0],de=$-X[1],oe=1/ka(c8e((J*ae+ne*de)/(Cc(J*J+ne*ne)*Cc(ae*ae+de*de)))/2),le=Cc(X[0]*X[0]+X[1]*X[1]);M=tb(k,(m-le)/(oe-1)),N=tb(k,(p-le)/(oe+1))}}S>zr?N>zr?(P=Ap(q,U,R,I,p,N,b),O=Ap(j,$,F,G,p,N,b),i.moveTo(P.cx+P.x01,P.cy+P.y01),N<k?i.arc(P.cx,P.cy,N,Sr(P.y01,P.x01),Sr(O.y01,O.x01),!b):(i.arc(P.cx,P.cy,N,Sr(P.y01,P.x01),Sr(P.y11,P.x11),!b),i.arc(0,0,p,Sr(P.cy+P.y11,P.cx+P.x11),Sr(O.cy+O.y11,O.cx+O.x11),!b),i.arc(O.cx,O.cy,N,Sr(O.y11,O.x11),Sr(O.y01,O.x01),!b))):(i.moveTo(R,I),i.arc(0,0,p,x,_,!b)):i.moveTo(R,I),!(m>zr)||!(w>zr)?i.lineTo(F,G):M>zr?(P=Ap(F,G,j,$,m,-M,b),O=Ap(R,I,q,U,m,-M,b),i.lineTo(P.cx+P.x01,P.cy+P.y01),M<k?i.arc(P.cx,P.cy,M,Sr(P.y01,P.x01),Sr(O.y01,O.x01),!b):(i.arc(P.cx,P.cy,M,Sr(P.y01,P.x01),Sr(P.y11,P.x11),!b),i.arc(0,0,m,Sr(P.cy+P.y11,P.cx+P.x11),Sr(O.cy+O.y11,O.cx+O.x11),b),i.arc(O.cx,O.cy,M,Sr(O.y11,O.x11),Sr(O.y01,O.x01),!b))):i.arc(0,0,m,C,v,b)}if(i.closePath(),u)return i=null,u+""||null}return c.centroid=function(){var u=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,d=(+s.apply(this,arguments)+ +a.apply(this,arguments))/2-Af/2;return[Vi(d)*u,ka(d)*u]},c.innerRadius=function(u){return arguments.length?(e=typeof u=="function"?u:$t(+u),c):e},c.outerRadius=function(u){return arguments.length?(t=typeof u=="function"?u:$t(+u),c):t},c.cornerRadius=function(u){return arguments.length?(n=typeof u=="function"?u:$t(+u),c):n},c.padRadius=function(u){return arguments.length?(r=u==null?null:typeof u=="function"?u:$t(+u),c):r},c.startAngle=function(u){return arguments.length?(s=typeof u=="function"?u:$t(+u),c):s},c.endAngle=function(u){return arguments.length?(a=typeof u=="function"?u:$t(+u),c):a},c.padAngle=function(u){return arguments.length?(o=typeof u=="function"?u:$t(+u),c):o},c.context=function(u){return arguments.length?(i=u??null,c):i},c}function MH(e){this._context=e}MH.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Cl(e){return new MH(e)}function E3(e){return e[0]}function k3(e){return e[1]}function M3(){var e=E3,t=k3,n=$t(!0),r=null,s=Cl,a=null;function o(i){var c,u=i.length,d,m=!1,p;for(r==null&&(a=s(p=Ss())),c=0;c<=u;++c)!(c<u&&n(d=i[c],c,i))===m&&((m=!m)?a.lineStart():a.lineEnd()),m&&a.point(+e(d,c,i),+t(d,c,i));if(p)return a=null,p+""||null}return o.x=function(i){return arguments.length?(e=typeof i=="function"?i:$t(+i),o):e},o.y=function(i){return arguments.length?(t=typeof i=="function"?i:$t(+i),o):t},o.defined=function(i){return arguments.length?(n=typeof i=="function"?i:$t(!!i),o):n},o.curve=function(i){return arguments.length?(s=i,r!=null&&(a=s(r)),o):s},o.context=function(i){return arguments.length?(i==null?r=a=null:a=s(r=i),o):r},o}function y8e(){var e=E3,t=null,n=$t(0),r=k3,s=$t(!0),a=null,o=Cl,i=null;function c(d){var m,p,h,g=d.length,y,b=!1,x,_=new Array(g),v=new Array(g);for(a==null&&(i=o(x=Ss())),m=0;m<=g;++m){if(!(m<g&&s(y=d[m],m,d))===b)if(b=!b)p=m,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),h=m-1;h>=p;--h)i.point(_[h],v[h]);i.lineEnd(),i.areaEnd()}b&&(_[m]=+e(y,m,d),v[m]=+n(y,m,d),i.point(t?+t(y,m,d):_[m],r?+r(y,m,d):v[m]))}if(x)return i=null,x+""||null}function u(){return M3().defined(s).curve(o).context(a)}return c.x=function(d){return arguments.length?(e=typeof d=="function"?d:$t(+d),t=null,c):e},c.x0=function(d){return arguments.length?(e=typeof d=="function"?d:$t(+d),c):e},c.x1=function(d){return arguments.length?(t=d==null?null:typeof d=="function"?d:$t(+d),c):t},c.y=function(d){return arguments.length?(n=typeof d=="function"?d:$t(+d),r=null,c):n},c.y0=function(d){return arguments.length?(n=typeof d=="function"?d:$t(+d),c):n},c.y1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:$t(+d),c):r},c.lineX0=c.lineY0=function(){return u().x(e).y(n)},c.lineY1=function(){return u().x(e).y(r)},c.lineX1=function(){return u().x(t).y(n)},c.defined=function(d){return arguments.length?(s=typeof d=="function"?d:$t(!!d),c):s},c.curve=function(d){return arguments.length?(o=d,a!=null&&(i=o(a)),c):o},c.context=function(d){return arguments.length?(d==null?a=i=null:i=o(a=d),c):a},c}function x8e(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function b8e(e){return e}function _8e(){var e=b8e,t=x8e,n=null,r=$t(0),s=$t(Ah),a=$t(0);function o(i){var c,u=i.length,d,m,p=0,h=new Array(u),g=new Array(u),y=+r.apply(this,arguments),b=Math.min(Ah,Math.max(-Ah,s.apply(this,arguments)-y)),x,_=Math.min(Math.abs(b)/u,a.apply(this,arguments)),v=_*(b<0?-1:1),C;for(c=0;c<u;++c)(C=g[h[c]=c]=+e(i[c],c,i))>0&&(p+=C);for(t!=null?h.sort(function(w,S){return t(g[w],g[S])}):n!=null&&h.sort(function(w,S){return n(i[w],i[S])}),c=0,m=p?(b-u*v)/p:0;c<u;++c,y=x)d=h[c],C=g[d],x=y+(C>0?C*m:0)+v,g[d]={data:i[d],index:c,value:C,startAngle:y,endAngle:x,padAngle:_};return g}return o.value=function(i){return arguments.length?(e=typeof i=="function"?i:$t(+i),o):e},o.sortValues=function(i){return arguments.length?(t=i,n=null,o):t},o.sort=function(i){return arguments.length?(n=i,t=null,o):n},o.startAngle=function(i){return arguments.length?(r=typeof i=="function"?i:$t(+i),o):r},o.endAngle=function(i){return arguments.length?(s=typeof i=="function"?i:$t(+i),o):s},o.padAngle=function(i){return arguments.length?(a=typeof i=="function"?i:$t(+i),o):a},o}var v8e=AH(Cl);function TH(e){this._curve=e}TH.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};function AH(e){function t(n){return new TH(e(n))}return t._curve=e,t}function C8e(e){var t=e.curve;return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e.curve=function(n){return arguments.length?t(AH(n)):t()._curve},e}function w8e(){return C8e(M3().curve(v8e))}function Np(e,t){return[(t=+t)*Math.cos(e-=Math.PI/2),t*Math.sin(e)]}var hv=Array.prototype.slice;function S8e(e){return e.source}function E8e(e){return e.target}function T3(e){var t=S8e,n=E8e,r=E3,s=k3,a=null;function o(){var i,c=hv.call(arguments),u=t.apply(this,c),d=n.apply(this,c);if(a||(a=i=Ss()),e(a,+r.apply(this,(c[0]=u,c)),+s.apply(this,c),+r.apply(this,(c[0]=d,c)),+s.apply(this,c)),i)return a=null,i+""||null}return o.source=function(i){return arguments.length?(t=i,o):t},o.target=function(i){return arguments.length?(n=i,o):n},o.x=function(i){return arguments.length?(r=typeof i=="function"?i:$t(+i),o):r},o.y=function(i){return arguments.length?(s=typeof i=="function"?i:$t(+i),o):s},o.context=function(i){return arguments.length?(a=i??null,o):a},o}function k8e(e,t,n,r,s){e.moveTo(t,n),e.bezierCurveTo(t=(t+r)/2,n,t,s,r,s)}function M8e(e,t,n,r,s){e.moveTo(t,n),e.bezierCurveTo(t,n=(n+s)/2,r,n,r,s)}function T8e(e,t,n,r,s){var a=Np(t,n),o=Np(t,n=(n+s)/2),i=Np(r,n),c=Np(r,s);e.moveTo(a[0],a[1]),e.bezierCurveTo(o[0],o[1],i[0],i[1],c[0],c[1])}function A8e(){return T3(k8e)}function N8e(){return T3(M8e)}function R8e(){var e=T3(T8e);return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e}function a6(e){return e<0?-1:1}function o6(e,t,n){var r=e._x1-e._x0,s=t-e._x1,a=(e._y1-e._y0)/(r||s<0&&-0),o=(n-e._y1)/(s||r<0&&-0),i=(a*s+o*r)/(r+s);return(a6(a)+a6(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(i))||0}function i6(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function nb(e,t,n){var r=e._x0,s=e._y0,a=e._x1,o=e._y1,i=(a-r)/3;e._context.bezierCurveTo(r+i,s+i*t,a-i,o-i*n,a,o)}function wg(e){this._context=e}wg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:nb(this,this._t0,i6(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,nb(this,i6(this,n=o6(this,e,t)),n);break;default:nb(this,this._t0,n=o6(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};Object.create(wg.prototype).point=function(e,t){wg.prototype.point.call(this,t,e)};function D8e(e){return new wg(e)}function ou(e,t){if((o=e.length)>1)for(var n=1,r,s,a=e[t[0]],o,i=a.length;n<o;++n)for(s=a,a=e[t[n]],r=0;r<i;++r)a[r][1]+=a[r][0]=isNaN(s[r][1])?s[r][0]:s[r][1]}function iu(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function I8e(e,t){return e[t]}function A3(){var e=$t([]),t=iu,n=ou,r=I8e;function s(a){var o=e.apply(this,arguments),i,c=a.length,u=o.length,d=new Array(u),m;for(i=0;i<u;++i){for(var p=o[i],h=d[i]=new Array(c),g=0,y;g<c;++g)h[g]=y=[0,+r(a[g],p,g,a)],y.data=a[g];h.key=p}for(i=0,m=t(d);i<u;++i)d[m[i]].index=i;return n(d,m),d}return s.keys=function(a){return arguments.length?(e=typeof a=="function"?a:$t(hv.call(a)),s):e},s.value=function(a){return arguments.length?(r=typeof a=="function"?a:$t(+a),s):r},s.order=function(a){return arguments.length?(t=a==null?iu:typeof a=="function"?a:$t(hv.call(a)),s):t},s.offset=function(a){return arguments.length?(n=a??ou,s):n},s}function j8e(e,t){if((r=e.length)>0){for(var n,r,s=0,a=e[0].length,o;s<a;++s){for(o=n=0;n<r;++n)o+=e[n][s][1]||0;if(o)for(n=0;n<r;++n)e[n][s][1]/=o}ou(e,t)}}function P8e(e,t){if((c=e.length)>0)for(var n,r=0,s,a,o,i,c,u=e[t[0]].length;r<u;++r)for(o=i=0,n=0;n<c;++n)(a=(s=e[t[n]][r])[1]-s[0])>0?(s[0]=o,s[1]=o+=a):a<0?(s[1]=i,s[0]=i+=a):(s[0]=0,s[1]=a)}function O8e(e,t){if((s=e.length)>0){for(var n=0,r=e[t[0]],s,a=r.length;n<a;++n){for(var o=0,i=0;o<s;++o)i+=e[o][n][1]||0;r[n][1]+=r[n][0]=-i/2}ou(e,t)}}function L8e(e,t){if(!(!((o=e.length)>0)||!((a=(s=e[t[0]]).length)>0))){for(var n=0,r=1,s,a,o;r<a;++r){for(var i=0,c=0,u=0;i<o;++i){for(var d=e[t[i]],m=d[r][1]||0,p=d[r-1][1]||0,h=(m-p)/2,g=0;g<i;++g){var y=e[t[g]],b=y[r][1]||0,x=y[r-1][1]||0;h+=b-x}c+=m,u+=h*m}s[r-1][1]+=s[r-1][0]=n,c&&(n-=u/c)}s[r-1][1]+=s[r-1][0]=n,ou(e,t)}}function F8e(e){var t=e.map(U8e);return iu(e).sort(function(n,r){return t[n]-t[r]})}function U8e(e){for(var t=-1,n=0,r=e.length,s,a=-1/0;++t<r;)(s=+e[t][1])>a&&(a=s,n=t);return n}function NH(e){var t=e.map(RH);return iu(e).sort(function(n,r){return t[n]-t[r]})}function RH(e){for(var t=0,n=-1,r=e.length,s;++n<r;)(s=+e[n][1])&&(t+=s);return t}function B8e(e){return NH(e).reverse()}function H8e(e){var t=e.length,n,r,s=e.map(RH),a=F8e(e),o=0,i=0,c=[],u=[];for(n=0;n<t;++n)r=a[n],o<i?(o+=s[r],c.push(r)):(i+=s[r],u.push(r));return u.reverse().concat(c)}function V8e(e){return iu(e).reverse()}const N3=e=>"pageX"in e?{x:e.pageX,y:e.pageY}:{x:e.touches[0]?.pageX??0,y:e.touches[0]?.pageY??0},Fy=D8e,Uu="geometricPrecision",R3="pointer-events-none overflow-visible font-sans",DH=25,Qa=200,D3="relative isolate select-none touch-none touch-pan-down",wl="bg-transparent rounded-lg border hover:border-subtle duration-quick hover:bg-subtlest dark:hover:bg-subtlest backdrop-blur-sm bg-subtlest dark:bg-subtlest",di={duration:Qa/1e3,delay:Qa/1e3,ease:ai},G8e={opacity:0,transition:{duration:0,delay:0}},z8e={duration:Qa/1e3,ease:ai},q8e={opacity:0,transition:{duration:Qa/1e3,delay:0}},Sg={height:DH},IH=4,jH=3,Pn={blue:"oklch(var(--finance-positive-color))",red:"oklch(var(--finance-negative-color))",gray:"oklch(var(--foreground-quieter-color))",black:"oklch(var(--foreground-color))",transparent:"#00000000"},I3=16,PH=-5,$8e={fill:Pn.gray,fontSize:12,dy:`${PH}px`,textAnchor:"start",fontFamily:"var(--font-family-sans)"},gv=e=>z("transition-opacity duration-500",{"opacity-0":e}),W8e=({tick:e,history:t,yScale:n,xScale:r,xOffset:s,yOffset:a,yHeight:o,yWidth:i,yGet:c,baseline:u})=>{if(!t||t.length===0)return!1;const m=n(e)+a,p=m-o;if(Number.isFinite(u)){const g=n(u);if(g>=p&&g<=m)return!0}const h=s+i;for(let g=0;g<t.length;g++){const y=t[g],b=r(pn(y));if(!y||!b||b<s)continue;if(b>h)break;const x=n(c(y));if(x>=p&&x<=m)return!0}return!1},OH=({tick:e,history:t,yScale:n,xScale:r,yGet:s,baseline:a})=>({...$8e,opacity:W8e({tick:e,history:t,yScale:n,xScale:r,xOffset:I3+5,yOffset:PH,yHeight:16,yWidth:25,yGet:s,baseline:a})?.4:1}),j3={fill:Pn.gray,fontSize:12,textAnchor:"start",dx:"6px",fontFamily:"var(--font-family-sans)"},ni={POSITIVE:"positive",NEGATIVE:"negative",NEUTRAL:"neutral",TRANSPARENT:"transparent"},yv={[ni.POSITIVE]:"blue",[ni.NEGATIVE]:"red",[ni.NEUTRAL]:"gray",[ni.TRANSPARENT]:"transparent"},Eg=e=>e.date,LH=e=>new Date(e),pn=e=>LH(e.date),Da=e=>e.close,K8e=(e,t)=>{const n=new Date(t.toLocaleString("en-US",{timeZone:"UTC"}));return(new Date(t.toLocaleString("en-US",{timeZone:e})).getTime()-n.getTime())/(1e3*60)},Y8e=(e,t)=>new Date(e.getTime()+t*60*1e3).toISOString().slice(11,16),l6=(e,t)=>t?e.replace(/T\d{2}:\d{2}/,`T${t}`):e,Q8e=(e,t,n,r)=>{if(!e?.length)return;const s=Os(e,Eg);let a=t?.open??"",o=t?.close??"";const i=l6(s[0],a),c=l6(s[1],o);let u=s[0],d=s[1];return i<u&&(u=i),c>d&&(d=c),[new Date(u),new Date(d)]},X8e={lunch_break:{valence:ni.TRANSPARENT,backgroundColor:yv[ni.TRANSPARENT],backgroundOpacity:0,lineOpacity:0},pre_market:{backgroundOpacity:.5},after_hours:{backgroundOpacity:.5}},c6={lunch_break:V({defaultMessage:"Lunch Break",id:"tHK2Aeii37"}),pre_market:V({defaultMessage:"Pre-market",id:"8sf72hHG3K"}),after_hours:V({defaultMessage:"After-hours",id:"npRfgsisE7"})},P3=(e,t,n)=>{const r=Y8e(t,n);if(r)return e.find(({open:s,close:a})=>s<=a?r>=s&&r<a:r>=s||r<a)},Z8e=(e,t=0)=>{if(t===0||!e?.length)return e;const n=[...e];let r=0;for(let s=0;s<e.length;s++){const a=e[s].close;if(r+=a,s>=t){const i=e[s-t].close;r-=i}const o=s<t?s+1:t;s===0||s===e.length-1||(n[s]={...e[s],close:r/o})}return n},J8e=e=>e?.includes?.("00:00:00"),O3=(e,t,n)=>{if(!e)return null;const r=new Date(e),s=!J8e(e);return r.toLocaleString(t,{month:"short",day:"numeric",timeZone:n,minute:s?"2-digit":void 0,hour:s?"numeric":void 0,year:s?void 0:"numeric",timeZoneName:s?"short":void 0})},el=(e,t,n,r=2)=>new Intl.NumberFormat(n,{style:t?"currency":"decimal",currency:t??void 0,minimumFractionDigits:r,maximumFractionDigits:2}).format(e),e9e=Sm(e=>pn(e)).left,t9e=(e,t)=>{if("invert"in e)return e.invert(t);const n=e.step(),r=e.domain(),s=e.range()[0],a=Math.round((t-s)/n);return r[Math.max(0,Math.min(r.length-1,a))]};function L3(e,t,n){const r=Math.max(0,e),s=e9e(n,t9e(t,r),0);return{d:n[s]??n[n.length-1],index:s,x:r}}const FH=({ticks:e,xScale:t,width:n,formatter:r,marginLeft:s=0,marginRight:a=0})=>{const c=s,u=n-a,d=[];let m=-1/0,p=0;for(const h of e){const g=t(h)??0,b=r(h).length*7,x=g-b/2,_=g+b/2;if(x<c||_>u)continue;if(d.length===0){d.push(h),m=g,p=b;continue}const v=p/2+10+b/2;g-m>=v&&(d.push(h),m=g,p=b)}return d},F3=(e,t)=>{const[n,r]=t;return n===r?0:(e-n)/(r-n)*100},n9e=({prev:e,quote:t,prevValue:n,currValue:r,baseline:s,xScale:a})=>{const o=a(pn(e))??0,i=a(pn(t))??0,c=(s-n)/(r-n);return o+c*(i-o)},Rp=(e,t,n)=>{const r=e>=t?ni.POSITIVE:ni.NEGATIVE,s=n?X8e[n]:{};return{backgroundColor:yv[r],backgroundOpacity:1,lineColor:yv[r],lineOpacity:1,valence:r,...s}},r9e=({history:e,baseline:t,xScale:n,width:r,exchangeHoursAnnotations:s=_e,xMaskingSupported:a=!1,tzOffsetMins:o=0})=>{if(!e?.length)return[];const i=a?s:[],c=[];let u;for(let m=0;m<e.length;m++){const p=e[m],h=P3(i,pn(p),o);if(m===0){c.push({...Rp(Da(p),t,void 0),x:0,type:void 0}),u=h;continue}const g=e[m-1],y=Da(g),b=Da(p),x=u===h&&(y<t&&b>=t||y>=t&&b<t);if(x||u!==h){const v=x?n9e({prev:g,quote:p,prevValue:y,currValue:b,baseline:t,xScale:n}):n(pn(g))??0;c.push({...Rp(Da(g),t,u?.type),x:v,type:u?.type},{...Rp(Da(p),t,h?.type),x:v,type:h?.type})}u=h}const d=e[e.length-1];return c.push({...Rp(Da(d),t,void 0),x:r,type:void 0}),c},s9e=["1d","5d","1m","6m","ytd","1y","5y","max"],UH={"1d":"1D","5d":"5D","1m":"1M","6m":"6M",ytd:"YTD","1y":"1Y","3m":"3M","5y":"5Y",max:"MAX"},BH=e=>{if(!e.length)return 0;const t=new Date(e[0].date);return(new Date(e[e.length-1].date).getTime()-t.getTime())/(1e3*60*60*24)},U3=e=>BH(e)<=1,a9e=e=>{if(e.length<2)return!1;const t=new Set;for(const n of e){const r=n.date.split("T")[0];if(t.has(r))return!0;t.add(r)}return!1},o9e=(e,t)=>Math.ceil((new Date(e).getTime()-new Date(t).getTime())/(1e3*60*60*24)),B3=e=>e?.includes("~")??!1,i9e=e=>{const[t,n]=e.split("~");return t&&n?{type:"range",range:{start:t,end:n}}:{type:"period",period:t}},l9e=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"finance-screenshot-builder",defaultValue:e,extraAttributes:t,subjectType:"user_nextauth_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},c9e=Pe(async()=>{const{FinanceScreenshotBuilderModal:e}=await W(async()=>{const{FinanceScreenshotBuilderModal:t}=await import("./FinanceScreenshotBuilderModal-ByyGGf9n.js");return{FinanceScreenshotBuilderModal:t}},__vite__mapDeps([410,3,2,5,1,6,7,8,9,13,12,14,15,16,17]));return{default:e}},{loading:()=>l.jsx(Il,{})}),u9e=({quote:e,animationId:t,period:n})=>{const{openToast:r}=cn(),{openModal:s}=Kt(),{$t:a}=Q(),{isMobileStyle:o}=Be(),{variation:i}=l9e(!1),c=!!e&&!!t&&!!n,u=f.useCallback(()=>{try{if(!e||!t||!n){r({message:a({defaultMessage:"Chart data not available",id:"sIM31EEMjr"}),description:a({defaultMessage:"Please try again",id:"fHqssj/1KO"}),variant:"error",timeout:3});return}const d=i9e(n),m=d.type==="period"?d.period:null;s(c9e,{quote:e,period:m,symbol:t})}catch(d){Z.error("Failed to open screenshot modal",{error:d}),r({message:a({defaultMessage:"Failed to open screenshot modal",id:"xzxG52das8"}),description:a({defaultMessage:"Please try again",id:"fHqssj/1KO"}),variant:"error",timeout:3})}},[a,t,s,r,n,e]);return!i&&!c?null:l.jsx(wn,{content:a({defaultMessage:"Share as image",id:"NNAj+KDt/t"}),disabled:o,children:l.jsx("button",{"aria-label":a({defaultMessage:"Screenshot",id:"9a+SKtXKhe"}),onClick:u,className:z(wl,"flex items-center justify-center px-sm"),style:{minHeight:Tf,minWidth:Tf},children:l.jsx(B,{variant:"tiny",color:"light",className:"inline-flex",children:l.jsx(ut,{name:D("camera-down"),size:16})})})})};var rb={exports:{}},sb,u6;function d9e(){if(u6)return sb;u6=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return sb=e,sb}var ab,d6;function f9e(){if(d6)return ab;d6=1;var e=d9e();function t(){}function n(){}return n.resetWarningCache=t,ab=function(){function r(o,i,c,u,d,m){if(m!==e){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}r.isRequired=r;function s(){return r}var a={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:s,element:r,elementType:r,instanceOf:s,node:r,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:n,resetWarningCache:t};return a.PropTypes=a,a},ab}var f6;function H3(){return f6||(f6=1,rb.exports=f9e()()),rb.exports}var m9e=H3();const Je=ha(m9e);var p9e=["top","left","transform","className","children","innerRef"];function xv(){return xv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xv.apply(this,arguments)}function h9e(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function Ur(e){var t=e.top,n=t===void 0?0:t,r=e.left,s=r===void 0?0:r,a=e.transform,o=e.className,i=e.children,c=e.innerRef,u=h9e(e,p9e);return A.createElement("g",xv({ref:c,className:z("visx-group",o),transform:a||"translate("+s+", "+n+")"},u),i)}Ur.propTypes={top:Je.number,left:Je.number,transform:Je.string,className:Je.string,children:Je.node,innerRef:Je.oneOfType([Je.string,Je.func,Je.object])};const g9e=Object.freeze(Object.defineProperty({__proto__:null,Group:Ur},Symbol.toStringTag,{value:"Module"}));function zs(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}const m6=Symbol("implicit");function V3(){var e=new UT,t=[],n=[],r=m6;function s(a){let o=e.get(a);if(o===void 0){if(r!==m6)return r;e.set(a,o=t.push(a)-1)}return n[o%n.length]}return s.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new UT;for(const o of a)e.has(o)||e.set(o,t.push(o)-1);return s},s.range=function(a){return arguments.length?(n=Array.from(a),s):n.slice()},s.unknown=function(a){return arguments.length?(r=a,s):r},s.copy=function(){return V3(t,n).unknown(r)},zs.apply(s,arguments),s}function G3(){var e=V3().unknown(void 0),t=e.domain,n=e.range,r=0,s=1,a,o,i=!1,c=0,u=0,d=.5;delete e.unknown;function m(){var p=t().length,h=s<r,g=h?s:r,y=h?r:s;a=(y-g)/Math.max(1,p-c+u*2),i&&(a=Math.floor(a)),g+=(y-g-a*(p-c))*d,o=a*(1-c),i&&(g=Math.round(g),o=Math.round(o));var b=_we(p).map(function(x){return g+a*x});return n(h?b.reverse():b)}return e.domain=function(p){return arguments.length?(t(p),m()):t()},e.range=function(p){return arguments.length?([r,s]=p,r=+r,s=+s,m()):[r,s]},e.rangeRound=function(p){return[r,s]=p,r=+r,s=+s,i=!0,m()},e.bandwidth=function(){return o},e.step=function(){return a},e.round=function(p){return arguments.length?(i=!!p,m()):i},e.padding=function(p){return arguments.length?(c=Math.min(1,u=+p),m()):c},e.paddingInner=function(p){return arguments.length?(c=Math.min(1,p),m()):c},e.paddingOuter=function(p){return arguments.length?(u=+p,m()):u},e.align=function(p){return arguments.length?(d=Math.max(0,Math.min(1,p)),m()):d},e.copy=function(){return G3(t(),[r,s]).round(i).paddingInner(c).paddingOuter(u).align(d)},zs.apply(m(),arguments)}function HH(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return HH(t())},e}function y9e(){return HH(G3.apply(null,arguments).paddingInner(1))}function Bu(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Dm(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Di(){}var Sl=.7,lu=1/Sl,Rc="\\s*([+-]?\\d+)\\s*",Nf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Fa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",x9e=/^#([0-9a-f]{3,8})$/,b9e=new RegExp(`^rgb\\(${Rc},${Rc},${Rc}\\)$`),_9e=new RegExp(`^rgb\\(${Fa},${Fa},${Fa}\\)$`),v9e=new RegExp(`^rgba\\(${Rc},${Rc},${Rc},${Nf}\\)$`),C9e=new RegExp(`^rgba\\(${Fa},${Fa},${Fa},${Nf}\\)$`),w9e=new RegExp(`^hsl\\(${Nf},${Fa},${Fa}\\)$`),S9e=new RegExp(`^hsla\\(${Nf},${Fa},${Fa},${Nf}\\)$`),p6={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Bu(Di,Rf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:h6,formatHex:h6,formatHex8:E9e,formatHsl:k9e,formatRgb:g6,toString:g6});function h6(){return this.rgb().formatHex()}function E9e(){return this.rgb().formatHex8()}function k9e(){return VH(this).formatHsl()}function g6(){return this.rgb().formatRgb()}function Rf(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=x9e.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?y6(t):n===3?new fr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Dp(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Dp(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=b9e.exec(e))?new fr(t[1],t[2],t[3],1):(t=_9e.exec(e))?new fr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=v9e.exec(e))?Dp(t[1],t[2],t[3],t[4]):(t=C9e.exec(e))?Dp(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=w9e.exec(e))?_6(t[1],t[2]/100,t[3]/100,1):(t=S9e.exec(e))?_6(t[1],t[2]/100,t[3]/100,t[4]):p6.hasOwnProperty(e)?y6(p6[e]):e==="transparent"?new fr(NaN,NaN,NaN,0):null}function y6(e){return new fr(e>>16&255,e>>8&255,e&255,1)}function Dp(e,t,n,r){return r<=0&&(e=t=n=NaN),new fr(e,t,n,r)}function z3(e){return e instanceof Di||(e=Rf(e)),e?(e=e.rgb(),new fr(e.r,e.g,e.b,e.opacity)):new fr}function bv(e,t,n,r){return arguments.length===1?z3(e):new fr(e,t,n,r??1)}function fr(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Bu(fr,bv,Dm(Di,{brighter(e){return e=e==null?lu:Math.pow(lu,e),new fr(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Sl:Math.pow(Sl,e),new fr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new fr(ll(this.r),ll(this.g),ll(this.b),kg(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:x6,formatHex:x6,formatHex8:M9e,formatRgb:b6,toString:b6}));function x6(){return`#${tl(this.r)}${tl(this.g)}${tl(this.b)}`}function M9e(){return`#${tl(this.r)}${tl(this.g)}${tl(this.b)}${tl((isNaN(this.opacity)?1:this.opacity)*255)}`}function b6(){const e=kg(this.opacity);return`${e===1?"rgb(":"rgba("}${ll(this.r)}, ${ll(this.g)}, ${ll(this.b)}${e===1?")":`, ${e})`}`}function kg(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ll(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function tl(e){return e=ll(e),(e<16?"0":"")+e.toString(16)}function _6(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new aa(e,t,n,r)}function VH(e){if(e instanceof aa)return new aa(e.h,e.s,e.l,e.opacity);if(e instanceof Di||(e=Rf(e)),!e)return new aa;if(e instanceof aa)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,s=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,i=a-s,c=(a+s)/2;return i?(t===a?o=(n-r)/i+(n<r)*6:n===a?o=(r-t)/i+2:o=(t-n)/i+4,i/=c<.5?a+s:2-a-s,o*=60):i=c>0&&c<1?0:o,new aa(o,i,c,e.opacity)}function _v(e,t,n,r){return arguments.length===1?VH(e):new aa(e,t,n,r??1)}function aa(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Bu(aa,_v,Dm(Di,{brighter(e){return e=e==null?lu:Math.pow(lu,e),new aa(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Sl:Math.pow(Sl,e),new aa(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,s=2*n-r;return new fr(ob(e>=240?e-240:e+120,s,r),ob(e,s,r),ob(e<120?e+240:e-120,s,r),this.opacity)},clamp(){return new aa(v6(this.h),Ip(this.s),Ip(this.l),kg(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=kg(this.opacity);return`${e===1?"hsl(":"hsla("}${v6(this.h)}, ${Ip(this.s)*100}%, ${Ip(this.l)*100}%${e===1?")":`, ${e})`}`}}));function v6(e){return e=(e||0)%360,e<0?e+360:e}function Ip(e){return Math.max(0,Math.min(1,e||0))}function ob(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const GH=Math.PI/180,zH=180/Math.PI,Mg=18,qH=.96422,$H=1,WH=.82521,KH=4/29,Dc=6/29,YH=3*Dc*Dc,T9e=Dc*Dc*Dc;function QH(e){if(e instanceof Ua)return new Ua(e.l,e.a,e.b,e.opacity);if(e instanceof Co)return XH(e);e instanceof fr||(e=z3(e));var t=ub(e.r),n=ub(e.g),r=ub(e.b),s=ib((.2225045*t+.7168786*n+.0606169*r)/$H),a,o;return t===n&&n===r?a=o=s:(a=ib((.4360747*t+.3850649*n+.1430804*r)/qH),o=ib((.0139322*t+.0971045*n+.7141733*r)/WH)),new Ua(116*s-16,500*(a-s),200*(s-o),e.opacity)}function vv(e,t,n,r){return arguments.length===1?QH(e):new Ua(e,t,n,r??1)}function Ua(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}Bu(Ua,vv,Dm(Di,{brighter(e){return new Ua(this.l+Mg*(e??1),this.a,this.b,this.opacity)},darker(e){return new Ua(this.l-Mg*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=qH*lb(t),e=$H*lb(e),n=WH*lb(n),new fr(cb(3.1338561*t-1.6168667*e-.4906146*n),cb(-.9787684*t+1.9161415*e+.033454*n),cb(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function ib(e){return e>T9e?Math.pow(e,1/3):e/YH+KH}function lb(e){return e>Dc?e*e*e:YH*(e-KH)}function cb(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function ub(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function A9e(e){if(e instanceof Co)return new Co(e.h,e.c,e.l,e.opacity);if(e instanceof Ua||(e=QH(e)),e.a===0&&e.b===0)return new Co(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*zH;return new Co(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Cv(e,t,n,r){return arguments.length===1?A9e(e):new Co(e,t,n,r??1)}function Co(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function XH(e){if(isNaN(e.h))return new Ua(e.l,0,0,e.opacity);var t=e.h*GH;return new Ua(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Bu(Co,Cv,Dm(Di,{brighter(e){return new Co(this.h,this.c,this.l+Mg*(e??1),this.opacity)},darker(e){return new Co(this.h,this.c,this.l-Mg*(e??1),this.opacity)},rgb(){return XH(this).rgb()}}));var ZH=-.14861,q3=1.78277,$3=-.29227,Uy=-.90649,Df=1.97294,C6=Df*Uy,w6=Df*q3,S6=q3*$3-Uy*ZH;function N9e(e){if(e instanceof cl)return new cl(e.h,e.s,e.l,e.opacity);e instanceof fr||(e=z3(e));var t=e.r/255,n=e.g/255,r=e.b/255,s=(S6*r+C6*t-w6*n)/(S6+C6-w6),a=r-s,o=(Df*(n-s)-$3*a)/Uy,i=Math.sqrt(o*o+a*a)/(Df*s*(1-s)),c=i?Math.atan2(o,a)*zH-120:NaN;return new cl(c<0?c+360:c,i,s,e.opacity)}function wv(e,t,n,r){return arguments.length===1?N9e(e):new cl(e,t,n,r??1)}function cl(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Bu(cl,wv,Dm(Di,{brighter(e){return e=e==null?lu:Math.pow(lu,e),new cl(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Sl:Math.pow(Sl,e),new cl(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*GH,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),s=Math.sin(e);return new fr(255*(t+n*(ZH*r+q3*s)),255*(t+n*($3*r+Uy*s)),255*(t+n*(Df*r)),this.opacity)}}));const By=e=>()=>e;function JH(e,t){return function(n){return e+n*t}}function R9e(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function W3(e,t){var n=t-e;return n?JH(e,n>180||n<-180?n-360*Math.round(n/360):n):By(isNaN(e)?t:e)}function D9e(e){return(e=+e)==1?mr:function(t,n){return n-t?R9e(t,n,e):By(isNaN(t)?n:t)}}function mr(e,t){var n=t-e;return n?JH(e,n):By(isNaN(e)?t:e)}const Sv=(function e(t){var n=D9e(t);function r(s,a){var o=n((s=bv(s)).r,(a=bv(a)).r),i=n(s.g,a.g),c=n(s.b,a.b),u=mr(s.opacity,a.opacity);return function(d){return s.r=o(d),s.g=i(d),s.b=c(d),s.opacity=u(d),s+""}}return r.gamma=e,r})(1);function I9e(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),s;return function(a){for(s=0;s<n;++s)r[s]=e[s]*(1-a)+t[s]*a;return r}}function j9e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function P9e(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,s=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)s[o]=K3(e[o],t[o]);for(;o<n;++o)a[o]=t[o];return function(i){for(o=0;o<r;++o)a[o]=s[o](i);return a}}function O9e(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Tg(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function L9e(e,t){var n={},r={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?n[s]=K3(e[s],t[s]):r[s]=t[s];return function(a){for(s in n)r[s]=n[s](a);return r}}var Ev=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,db=new RegExp(Ev.source,"g");function F9e(e){return function(){return e}}function U9e(e){return function(t){return e(t)+""}}function B9e(e,t){var n=Ev.lastIndex=db.lastIndex=0,r,s,a,o=-1,i=[],c=[];for(e=e+"",t=t+"";(r=Ev.exec(e))&&(s=db.exec(t));)(a=s.index)>n&&(a=t.slice(n,a),i[o]?i[o]+=a:i[++o]=a),(r=r[0])===(s=s[0])?i[o]?i[o]+=s:i[++o]=s:(i[++o]=null,c.push({i:o,x:Tg(r,s)})),n=db.lastIndex;return n<t.length&&(a=t.slice(n),i[o]?i[o]+=a:i[++o]=a),i.length<2?c[0]?U9e(c[0].x):F9e(t):(t=c.length,function(u){for(var d=0,m;d<t;++d)i[(m=c[d]).i]=m.x(u);return i.join("")})}function K3(e,t){var n=typeof t,r;return t==null||n==="boolean"?By(t):(n==="number"?Tg:n==="string"?(r=Rf(t))?(t=r,Sv):B9e:t instanceof Rf?Sv:t instanceof Date?O9e:j9e(t)?I9e:Array.isArray(t)?P9e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?L9e:Tg)(e,t)}function eV(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function tV(e){return function(t,n){var r=e((t=_v(t)).h,(n=_v(n)).h),s=mr(t.s,n.s),a=mr(t.l,n.l),o=mr(t.opacity,n.opacity);return function(i){return t.h=r(i),t.s=s(i),t.l=a(i),t.opacity=o(i),t+""}}}const H9e=tV(W3);var V9e=tV(mr);function G9e(e,t){var n=mr((e=vv(e)).l,(t=vv(t)).l),r=mr(e.a,t.a),s=mr(e.b,t.b),a=mr(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=r(o),e.b=s(o),e.opacity=a(o),e+""}}function nV(e){return function(t,n){var r=e((t=Cv(t)).h,(n=Cv(n)).h),s=mr(t.c,n.c),a=mr(t.l,n.l),o=mr(t.opacity,n.opacity);return function(i){return t.h=r(i),t.c=s(i),t.l=a(i),t.opacity=o(i),t+""}}}const z9e=nV(W3);var q9e=nV(mr);function rV(e){return(function t(n){n=+n;function r(s,a){var o=e((s=wv(s)).h,(a=wv(a)).h),i=mr(s.s,a.s),c=mr(s.l,a.l),u=mr(s.opacity,a.opacity);return function(d){return s.h=o(d),s.s=i(d),s.l=c(Math.pow(d,n)),s.opacity=u(d),s+""}}return r.gamma=t,r})(1)}const $9e=rV(W3);var W9e=rV(mr);function K9e(e){return function(){return e}}function sV(e){return+e}var E6=[0,1];function Pa(e){return e}function kv(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:K9e(isNaN(t)?NaN:.5)}function Y9e(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function Q9e(e,t,n){var r=e[0],s=e[1],a=t[0],o=t[1];return s<r?(r=kv(s,r),a=n(o,a)):(r=kv(r,s),a=n(a,o)),function(i){return a(r(i))}}function X9e(e,t,n){var r=Math.min(e.length,t.length)-1,s=new Array(r),a=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)s[o]=kv(e[o],e[o+1]),a[o]=n(t[o],t[o+1]);return function(i){var c=Ou(e,i,1,r)-1;return a[c](s[c](i))}}function Im(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Hy(){var e=E6,t=E6,n=K3,r,s,a,o=Pa,i,c,u;function d(){var p=Math.min(e.length,t.length);return o!==Pa&&(o=Y9e(e[0],e[p-1])),i=p>2?X9e:Q9e,c=u=null,m}function m(p){return p==null||isNaN(p=+p)?a:(c||(c=i(e.map(r),t,n)))(r(o(p)))}return m.invert=function(p){return o(s((u||(u=i(t,e.map(r),Tg)))(p)))},m.domain=function(p){return arguments.length?(e=Array.from(p,sV),d()):e.slice()},m.range=function(p){return arguments.length?(t=Array.from(p),d()):t.slice()},m.rangeRound=function(p){return t=Array.from(p),n=eV,d()},m.clamp=function(p){return arguments.length?(o=p?!0:Pa,d()):o!==Pa},m.interpolate=function(p){return arguments.length?(n=p,d()):n},m.unknown=function(p){return arguments.length?(a=p,m):a},function(p,h){return r=p,s=h,d()}}function Y3(){return Hy()(Pa,Pa)}function Z9e(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Ag(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function cu(e){return e=Ag(Math.abs(e)),e?e[1]:NaN}function J9e(e,t){return function(n,r){for(var s=n.length,a=[],o=0,i=e[0],c=0;s>0&&i>0&&(c+i+1>r&&(i=Math.max(1,r-c)),a.push(n.substring(s-=i,s+i)),!((c+=i+1)>r));)i=e[o=(o+1)%e.length];return a.reverse().join(t)}}function eNe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var tNe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function If(e){if(!(t=tNe.exec(e)))throw new Error("invalid format: "+e);var t;return new Q3({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}If.prototype=Q3.prototype;function Q3(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Q3.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function nNe(e){e:for(var t=e.length,n=1,r=-1,s;n<t;++n)switch(e[n]){case".":r=s=n;break;case"0":r===0&&(r=n),s=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(s+1):e}var aV;function rNe(e,t){var n=Ag(e,t);if(!n)return e+"";var r=n[0],s=n[1],a=s-(aV=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Ag(e,Math.max(0,t+a-1))[0]}function k6(e,t){var n=Ag(e,t);if(!n)return e+"";var r=n[0],s=n[1];return s<0?"0."+new Array(-s).join("0")+r:r.length>s+1?r.slice(0,s+1)+"."+r.slice(s+1):r+new Array(s-r.length+2).join("0")}const M6={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Z9e,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>k6(e*100,t),r:k6,s:rNe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function T6(e){return e}var A6=Array.prototype.map,N6=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function sNe(e){var t=e.grouping===void 0||e.thousands===void 0?T6:J9e(A6.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?T6:eNe(A6.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",i=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(m){m=If(m);var p=m.fill,h=m.align,g=m.sign,y=m.symbol,b=m.zero,x=m.width,_=m.comma,v=m.precision,C=m.trim,w=m.type;w==="n"?(_=!0,w="g"):M6[w]||(v===void 0&&(v=12),C=!0,w="g"),(b||p==="0"&&h==="=")&&(b=!0,p="0",h="=");var S=y==="$"?n:y==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",E=y==="$"?r:/[%p]/.test(w)?o:"",T=M6[w],k=/[defgprs%]/.test(w);v=v===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function M(N){var P=S,O=E,L,H,R;if(w==="c")O=T(N)+O,N="";else{N=+N;var I=N<0||1/N<0;if(N=isNaN(N)?c:T(Math.abs(N),v),C&&(N=nNe(N)),I&&+N==0&&g!=="+"&&(I=!1),P=(I?g==="("?g:i:g==="-"||g==="("?"":g)+P,O=(w==="s"?N6[8+aV/3]:"")+O+(I&&g==="("?")":""),k){for(L=-1,H=N.length;++L<H;)if(R=N.charCodeAt(L),48>R||R>57){O=(R===46?s+N.slice(L+1):N.slice(L))+O,N=N.slice(0,L);break}}}_&&!b&&(N=t(N,1/0));var F=P.length+N.length+O.length,G=F<x?new Array(x-F+1).join(p):"";switch(_&&b&&(N=t(G+N,G.length?x-O.length:1/0),G=""),h){case"<":N=P+N+O+G;break;case"=":N=P+G+N+O;break;case"^":N=G.slice(0,F=G.length>>1)+P+N+O+G.slice(F);break;default:N=G+P+N+O;break}return a(N)}return M.toString=function(){return m+""},M}function d(m,p){var h=u((m=If(m),m.type="f",m)),g=Math.max(-8,Math.min(8,Math.floor(cu(p)/3)))*3,y=Math.pow(10,-g),b=N6[8+g/3];return function(x){return h(y*x)+b}}return{format:u,formatPrefix:d}}var jp,X3,oV;aNe({thousands:",",grouping:[3],currency:["$",""]});function aNe(e){return jp=sNe(e),X3=jp.format,oV=jp.formatPrefix,jp}function oNe(e){return Math.max(0,-cu(Math.abs(e)))}function iNe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(cu(t)/3)))*3-cu(Math.abs(e)))}function lNe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,cu(t)-cu(e))+1}function cNe(e,t,n,r){var s=X_(e,t,n),a;switch(r=If(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(a=iNe(s,o))&&(r.precision=a),oV(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=lNe(s,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=oNe(s))&&(r.precision=a-(r.type==="%")*2);break}}return X3(r)}function jm(e){var t=e.domain;return e.ticks=function(n){var r=t();return Q_(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var s=t();return cNe(s[0],s[s.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),s=0,a=r.length-1,o=r[s],i=r[a],c,u,d=10;for(i<o&&(u=o,o=i,i=u,u=s,s=a,a=u);d-- >0;){if(u=kU(o,i,n),u===c)return r[s]=o,r[a]=i,t(r);if(u>0)o=Math.floor(o/u)*u,i=Math.ceil(i/u)*u;else if(u<0)o=Math.ceil(o*u)/u,i=Math.floor(i*u)/u;else break;c=u}return e},e}function iV(){var e=Y3();return e.copy=function(){return Im(e,iV())},zs.apply(e,arguments),jm(e)}function lV(e,t){e=e.slice();var n=0,r=e.length-1,s=e[n],a=e[r],o;return a<s&&(o=n,n=r,r=o,o=s,s=a,a=o),e[n]=t.floor(s),e[r]=t.ceil(a),e}function R6(e){return Math.log(e)}function D6(e){return Math.exp(e)}function uNe(e){return-Math.log(-e)}function dNe(e){return-Math.exp(-e)}function fNe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function mNe(e){return e===10?fNe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function pNe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function I6(e){return(t,n)=>-e(-t,n)}function hNe(e){const t=e(R6,D6),n=t.domain;let r=10,s,a;function o(){return s=pNe(r),a=mNe(r),n()[0]<0?(s=I6(s),a=I6(a),e(uNe,dNe)):e(R6,D6),t}return t.base=function(i){return arguments.length?(r=+i,o()):r},t.domain=function(i){return arguments.length?(n(i),o()):n()},t.ticks=i=>{const c=n();let u=c[0],d=c[c.length-1];const m=d<u;m&&([u,d]=[d,u]);let p=s(u),h=s(d),g,y;const b=i==null?10:+i;let x=[];if(!(r%1)&&h-p<b){if(p=Math.floor(p),h=Math.ceil(h),u>0){for(;p<=h;++p)for(g=1;g<r;++g)if(y=p<0?g/a(-p):g*a(p),!(y<u)){if(y>d)break;x.push(y)}}else for(;p<=h;++p)for(g=r-1;g>=1;--g)if(y=p>0?g/a(-p):g*a(p),!(y<u)){if(y>d)break;x.push(y)}x.length*2<b&&(x=Q_(u,d,b))}else x=Q_(p,h,Math.min(h-p,b)).map(a);return m?x.reverse():x},t.tickFormat=(i,c)=>{if(i==null&&(i=10),c==null&&(c=r===10?"s":","),typeof c!="function"&&(!(r%1)&&(c=If(c)).precision==null&&(c.trim=!0),c=X3(c)),i===1/0)return c;const u=Math.max(1,r*i/t.ticks().length);return d=>{let m=d/a(Math.round(s(d)));return m*r<r-.5&&(m*=r),m<=u?c(d):""}},t.nice=()=>n(lV(n(),{floor:i=>a(Math.floor(s(i))),ceil:i=>a(Math.ceil(s(i)))})),t}function cV(){const e=hNe(Hy()).domain([1,10]);return e.copy=()=>Im(e,cV()).base(e.base()),zs.apply(e,arguments),e}function j6(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function P6(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function gNe(e){var t=1,n=e(j6(t),P6(t));return n.constant=function(r){return arguments.length?e(j6(t=+r),P6(t)):t},jm(n)}function uV(){var e=gNe(Hy());return e.copy=function(){return Im(e,uV()).constant(e.constant())},zs.apply(e,arguments)}function O6(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function yNe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function xNe(e){return e<0?-e*e:e*e}function bNe(e){var t=e(Pa,Pa),n=1;function r(){return n===1?e(Pa,Pa):n===.5?e(yNe,xNe):e(O6(n),O6(1/n))}return t.exponent=function(s){return arguments.length?(n=+s,r()):n},jm(t)}function Z3(){var e=bNe(Hy());return e.copy=function(){return Im(e,Z3()).exponent(e.exponent())},zs.apply(e,arguments),e}function _Ne(){return Z3.apply(null,arguments).exponent(.5)}function L6(e){return Math.sign(e)*e*e}function vNe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function dV(){var e=Y3(),t=[0,1],n=!1,r;function s(a){var o=vNe(e(a));return isNaN(o)?r:n?Math.round(o):o}return s.invert=function(a){return e.invert(L6(a))},s.domain=function(a){return arguments.length?(e.domain(a),s):e.domain()},s.range=function(a){return arguments.length?(e.range((t=Array.from(a,sV)).map(L6)),s):t.slice()},s.rangeRound=function(a){return s.range(a).round(!0)},s.round=function(a){return arguments.length?(n=!!a,s):n},s.clamp=function(a){return arguments.length?(e.clamp(a),s):e.clamp()},s.unknown=function(a){return arguments.length?(r=a,s):r},s.copy=function(){return dV(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},zs.apply(s,arguments),jm(s)}function fV(){var e=[],t=[],n=[],r;function s(){var o=0,i=Math.max(1,t.length);for(n=new Array(i-1);++o<i;)n[o-1]=bwe(e,o/i);return a}function a(o){return o==null||isNaN(o=+o)?r:t[Ou(n,o)]}return a.invertExtent=function(o){var i=t.indexOf(o);return i<0?[NaN,NaN]:[i>0?n[i-1]:e[0],i<n.length?n[i]:e[e.length-1]]},a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let i of o)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(Yd),s()},a.range=function(o){return arguments.length?(t=Array.from(o),s()):t.slice()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.quantiles=function(){return n.slice()},a.copy=function(){return fV().domain(e).range(t).unknown(r)},zs.apply(a,arguments)}function mV(){var e=0,t=1,n=1,r=[.5],s=[0,1],a;function o(c){return c!=null&&c<=c?s[Ou(r,c,0,n)]:a}function i(){var c=-1;for(r=new Array(n);++c<n;)r[c]=((c+1)*t-(c-n)*e)/(n+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,i()):[e,t]},o.range=function(c){return arguments.length?(n=(s=Array.from(c)).length-1,i()):s.slice()},o.invertExtent=function(c){var u=s.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,r[0]]:u>=n?[r[n-1],t]:[r[u-1],r[u]]},o.unknown=function(c){return arguments.length&&(a=c),o},o.thresholds=function(){return r.slice()},o.copy=function(){return mV().domain([e,t]).range(s).unknown(a)},zs.apply(jm(o),arguments)}function pV(){var e=[.5],t=[0,1],n,r=1;function s(a){return a!=null&&a<=a?t[Ou(e,a,0,r)]:n}return s.domain=function(a){return arguments.length?(e=Array.from(a),r=Math.min(e.length,t.length-1),s):e.slice()},s.range=function(a){return arguments.length?(t=Array.from(a),r=Math.min(e.length,t.length-1),s):t.slice()},s.invertExtent=function(a){var o=t.indexOf(a);return[e[o-1],e[o]]},s.unknown=function(a){return arguments.length?(n=a,s):n},s.copy=function(){return pV().domain(e).range(t).unknown(n)},zs.apply(s,arguments)}function CNe(e){return new Date(e)}function wNe(e){return e instanceof Date?+e:+new Date(+e)}function J3(e,t,n,r,s,a,o,i,c,u){var d=Y3(),m=d.invert,p=d.domain,h=u(".%L"),g=u(":%S"),y=u("%I:%M"),b=u("%I %p"),x=u("%a %d"),_=u("%b %d"),v=u("%B"),C=u("%Y");function w(S){return(c(S)<S?h:i(S)<S?g:o(S)<S?y:a(S)<S?b:r(S)<S?s(S)<S?x:_:n(S)<S?v:C)(S)}return d.invert=function(S){return new Date(m(S))},d.domain=function(S){return arguments.length?p(Array.from(S,wNe)):p().map(CNe)},d.ticks=function(S){var E=p();return e(E[0],E[E.length-1],S??10)},d.tickFormat=function(S,E){return E==null?w:u(E)},d.nice=function(S){var E=p();return(!S||typeof S.range!="function")&&(S=t(E[0],E[E.length-1],S??10)),S?p(lV(E,S)):d},d.copy=function(){return Im(d,J3(e,t,n,r,s,a,o,i,c,u))},d}function SNe(){return zs.apply(J3(wwe,Swe,pa,wm,vm,Pu,wy,vy,vo,Em).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function ENe(){return zs.apply(J3(vwe,Cwe,Ya,Ey,Cm,_m,Sy,Cy,vo,DU).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function kNe(e,t){t.domain&&("nice"in e||"quantiles"in e||"padding"in e,e.domain(t.domain))}function MNe(e,t){t.range&&("padding"in e,e.range(t.range))}function TNe(e,t){"align"in e&&"align"in t&&typeof t.align<"u"&&e.align(t.align)}function ANe(e,t){"base"in e&&"base"in t&&typeof t.base<"u"&&e.base(t.base)}function NNe(e,t){"clamp"in e&&"clamp"in t&&typeof t.clamp<"u"&&e.clamp(t.clamp)}function RNe(e,t){"constant"in e&&"constant"in t&&typeof t.constant<"u"&&e.constant(t.constant)}function DNe(e,t){"exponent"in e&&"exponent"in t&&typeof t.exponent<"u"&&e.exponent(t.exponent)}var F6={lab:G9e,hcl:z9e,"hcl-long":q9e,hsl:H9e,"hsl-long":V9e,cubehelix:$9e,"cubehelix-long":W9e,rgb:Sv};function INe(e){switch(e){case"lab":case"hcl":case"hcl-long":case"hsl":case"hsl-long":case"cubehelix":case"cubehelix-long":case"rgb":return F6[e]}var t=e.type,n=e.gamma,r=F6[t];return typeof n>"u"?r:r.gamma(n)}function jNe(e,t){if("interpolate"in t&&"interpolate"in e&&typeof t.interpolate<"u"){var n=INe(t.interpolate);e.interpolate(n)}}var PNe=new Date(Date.UTC(2020,1,2,3,4,5)),ONe="%Y-%m-%d %H:%M";function hV(e){var t=e.tickFormat(1,ONe)(PNe);return t==="2020-02-02 03:04"}var U6={day:Pu,hour:wy,minute:vy,month:wm,second:vo,week:vm,year:pa},B6={day:_m,hour:Sy,minute:Cy,month:Ey,second:vo,week:Cm,year:Ya};function LNe(e,t){if("nice"in t&&typeof t.nice<"u"&&"nice"in e){var n=t.nice;if(typeof n=="boolean")n&&e.nice();else if(typeof n=="number")e.nice(n);else{var r=e,s=hV(r);if(typeof n=="string")r.nice(s?B6[n]:U6[n]);else{var a=n.interval,o=n.step,i=(s?B6[a]:U6[a]).every(o);i!=null&&r.nice(i)}}}}function FNe(e,t){"padding"in e&&"padding"in t&&typeof t.padding<"u"&&e.padding(t.padding),"paddingInner"in e&&"paddingInner"in t&&typeof t.paddingInner<"u"&&e.paddingInner(t.paddingInner),"paddingOuter"in e&&"paddingOuter"in t&&typeof t.paddingOuter<"u"&&e.paddingOuter(t.paddingOuter)}function UNe(e,t){if(t.reverse){var n=e.range().slice().reverse();"padding"in e,e.range(n)}}function BNe(e,t){"round"in t&&typeof t.round<"u"&&(t.round&&"interpolate"in t&&typeof t.interpolate<"u"?console.warn("[visx/scale/applyRound] ignoring round: scale config contains round and interpolate. only applying interpolate. config:",t):"round"in e?e.round(t.round):"interpolate"in e&&t.round&&e.interpolate(eV))}function HNe(e,t){"unknown"in e&&"unknown"in t&&typeof t.unknown<"u"&&e.unknown(t.unknown)}function VNe(e,t){if("zero"in t&&t.zero===!0){var n=e.domain(),r=n[0],s=n[1],a=s<r,o=a?[s,r]:[r,s],i=o[0],c=o[1],u=[Math.min(0,i),Math.max(0,c)];e.domain(a?u.reverse():u)}}var gV=["domain","nice","zero","interpolate","round","range","reverse","align","base","clamp","constant","exponent","padding","unknown"],GNe={domain:kNe,nice:LNe,zero:VNe,interpolate:jNe,round:BNe,align:TNe,base:ANe,clamp:NNe,constant:RNe,exponent:DNe,padding:FNe,range:MNe,reverse:UNe,unknown:HNe};function Br(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=new Set(t),s=gV.filter(function(a){return r.has(a)});return function(o,i){return typeof i<"u"&&s.forEach(function(c){GNe[c](o,i)}),o}}var zNe=Br("domain","range","reverse","align","padding","round");function e5(e){return zNe(G3(),e)}var qNe=Br("domain","range","reverse","align","padding","round");function Pm(e){return qNe(y9e(),e)}var $Ne=Br("domain","range","reverse","clamp","interpolate","nice","round","zero");function So(e){return $Ne(iV(),e)}var WNe=Br("domain","range","clamp","nice","round","unknown");function KNe(e){return WNe(dV(),e)}var YNe=Br("domain","range","reverse","clamp","interpolate","nice","round");function Hu(e){return YNe(SNe(),e)}var QNe=Br("domain","range","reverse","clamp","interpolate","nice","round");function yV(e){return QNe(ENe(),e)}var XNe=Br("domain","range","reverse","base","clamp","interpolate","nice","round");function t5(e){return XNe(cV(),e)}var ZNe=Br("domain","range","reverse","clamp","exponent","interpolate","nice","round","zero");function n5(e){return ZNe(Z3(),e)}var JNe=Br("domain","range","reverse","unknown");function r5(e){return JNe(V3(),e)}var eRe=Br("domain","range","reverse","nice","zero");function xV(e){return eRe(mV(),e)}var tRe=Br("domain","range","reverse");function bV(e){return tRe(fV(),e)}var nRe=Br("domain","range","reverse","clamp","constant","nice","zero","round");function _V(e){return nRe(uV(),e)}var rRe=Br("domain","range","reverse");function vV(e){return rRe(pV(),e)}var sRe=Br("domain","range","reverse","clamp","interpolate","nice","round","zero");function CV(e){return sRe(_Ne(),e)}function aRe(e){if(typeof e<"u"&&"type"in e)switch(e.type){case"linear":return So(e);case"log":return t5(e);case"pow":return n5(e);case"sqrt":return CV(e);case"symlog":return _V(e);case"time":return Hu(e);case"utc":return yV(e);case"quantile":return bV(e);case"quantize":return xV(e);case"threshold":return vV(e);case"ordinal":return r5(e);case"point":return Pm(e);case"band":return e5(e)}return So(e)}var oRe=Br.apply(void 0,gV);function iRe(e,t){return oRe(e.copy(),t)}function lRe(e){return"paddingInner"in e?"band":"padding"in e?"point":"quantiles"in e?"quantile":"base"in e?"log":"exponent"in e?e.exponent()===.5?"sqrt":"pow":"constant"in e?"symlog":"clamp"in e?e.ticks()[0]instanceof Date?hV(e)?"utc":"time":"linear":"nice"in e?"quantize":"invertExtent"in e?"threshold":"ordinal"}function Om(e){if((typeof e=="function"||typeof e=="object"&&e)&&"valueOf"in e){var t=e.valueOf();if(typeof t=="number")return t}return e}function Vy(e,t){var n=e;return"ticks"in n?n.ticks(t):n.domain().filter(function(r,s,a){return t==null||a.length<=t||s%Math.round((a.length-1)/t)===0})}function wV(e){return e?.toString()}var cRe=new Set(["linear","pow","quantize","sqrt","symlog"]);function uRe(e){return cRe.has(e.type)}const dRe=Object.freeze(Object.defineProperty({__proto__:null,coerceNumber:Om,createScale:aRe,getTicks:Vy,inferScaleType:lRe,scaleBand:e5,scaleCanBeZeroed:uRe,scaleLinear:So,scaleLog:t5,scaleOrdinal:r5,scalePoint:Pm,scalePower:n5,scaleQuantile:bV,scaleQuantize:xV,scaleRadial:KNe,scaleSqrt:CV,scaleSymlog:_V,scaleThreshold:vV,scaleTime:Hu,scaleUtc:yV,toString:wV,updateScale:iRe},Symbol.toStringTag,{value:"Module"}));function Cn(e,t){e(t)}var Ng={ascending:NH,descending:B8e,insideout:H8e,none:iu,reverse:V8e},fRe=Object.keys(Ng);function Gy(e){return e&&Ng[e]||Ng.none}var Rg={expand:j8e,diverging:P8e,none:ou,silhouette:O8e,wiggle:L8e},mRe=Object.keys(Rg);function zy(e){return e&&Rg[e]||Rg.none}function s5(e){var t=e===void 0?{}:e,n=t.innerRadius,r=t.outerRadius,s=t.cornerRadius,a=t.startAngle,o=t.endAngle,i=t.padAngle,c=t.padRadius,u=g8e();return n!=null&&Cn(u.innerRadius,n),r!=null&&Cn(u.outerRadius,r),s!=null&&Cn(u.cornerRadius,s),a!=null&&Cn(u.startAngle,a),o!=null&&Cn(u.endAngle,o),i!=null&&Cn(u.padAngle,i),c!=null&&Cn(u.padRadius,c),u}function qy(e){var t=e===void 0?{}:e,n=t.x,r=t.x0,s=t.x1,a=t.y,o=t.y0,i=t.y1,c=t.defined,u=t.curve,d=y8e();return n&&Cn(d.x,n),r&&Cn(d.x0,r),s&&Cn(d.x1,s),a&&Cn(d.y,a),o&&Cn(d.y0,o),i&&Cn(d.y1,i),c&&d.defined(c),u&&d.curve(u),d}function Fo(e){var t=e===void 0?{}:e,n=t.x,r=t.y,s=t.defined,a=t.curve,o=M3();return n&&Cn(o.x,n),r&&Cn(o.y,r),s&&o.defined(s),a&&o.curve(a),o}function SV(e){var t=e===void 0?{}:e,n=t.startAngle,r=t.endAngle,s=t.padAngle,a=t.value,o=t.sort,i=t.sortValues,c=_8e();return(o===null||o!=null)&&c.sort(o),(i===null||i!=null)&&c.sortValues(i),a!=null&&c.value(a),s!=null&&Cn(c.padAngle,s),n!=null&&Cn(c.startAngle,n),r!=null&&Cn(c.endAngle,r),c}function EV(e){var t=e===void 0?{}:e,n=t.angle,r=t.radius,s=t.defined,a=t.curve,o=w8e();return n&&Cn(o.angle,n),r&&Cn(o.radius,r),s&&o.defined(s),a&&o.curve(a),o}function kV(e){var t=e.keys,n=e.value,r=e.order,s=e.offset,a=A3();return t&&a.keys(t),n&&Cn(a.value,n),r&&a.order(Gy(r)),s&&a.offset(zy(s)),a}var pRe=["className","data","innerRadius","outerRadius","cornerRadius","startAngle","endAngle","padAngle","padRadius","children","innerRef"];function Mv(){return Mv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Mv.apply(this,arguments)}function hRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function gRe(e){var t=e.className,n=e.data,r=e.innerRadius,s=e.outerRadius,a=e.cornerRadius,o=e.startAngle,i=e.endAngle,c=e.padAngle,u=e.padRadius,d=e.children,m=e.innerRef,p=hRe(e,pRe),h=s5({innerRadius:r,outerRadius:s,cornerRadius:a,startAngle:o,endAngle:i,padAngle:c,padRadius:u});return d?A.createElement(A.Fragment,null,d({path:h})):!n&&(o==null||i==null||r==null||s==null)?(console.warn("[@visx/shape/Arc]: expected data because one of startAngle, endAngle, innerRadius, outerRadius is undefined. Bailing."),null):A.createElement("path",Mv({ref:m,className:z("visx-arc",t),d:h(n)||""},p))}var yRe=["className","top","left","data","centroid","innerRadius","outerRadius","cornerRadius","startAngle","endAngle","padAngle","padRadius","pieSort","pieSortValues","pieValue","children","fill"];function Tv(){return Tv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Tv.apply(this,arguments)}function xRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function bRe(e){var t=e.className,n=e.top,r=e.left,s=e.data,a=s===void 0?[]:s,o=e.centroid,i=e.innerRadius,c=i===void 0?0:i,u=e.outerRadius,d=e.cornerRadius,m=e.startAngle,p=e.endAngle,h=e.padAngle,g=e.padRadius,y=e.pieSort,b=e.pieSortValues,x=e.pieValue,_=e.children,v=e.fill,C=v===void 0?"":v,w=xRe(e,yRe),S=s5({innerRadius:c,outerRadius:u,cornerRadius:d,padRadius:g}),E=SV({startAngle:m,endAngle:p,padAngle:h,value:x,sort:y,sortValues:b}),T=E(a);return _?A.createElement(A.Fragment,null,_({arcs:T,path:S,pie:E})):A.createElement(Ur,{className:"visx-pie-arcs-group",top:n,left:r},T.map(function(k,M){return A.createElement("g",{key:"pie-arc-"+M},A.createElement("path",Tv({className:z("visx-pie-arc",t),d:S(k)||"",fill:C==null||typeof C=="string"?C:C(k)},w)),o?.(S.centroid(k),k))}))}var _Re=["from","to","fill","className","innerRef"];function Av(){return Av=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Av.apply(this,arguments)}function vRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function $y(e){var t=e.from,n=t===void 0?{x:0,y:0}:t,r=e.to,s=r===void 0?{x:1,y:1}:r,a=e.fill,o=a===void 0?"transparent":a,i=e.className,c=e.innerRef,u=vRe(e,_Re),d=n.x===s.x||n.y===s.y;return A.createElement("line",Av({ref:c,className:z("visx-line",i),x1:n.x,y1:n.y,x2:s.x,y2:s.y,fill:o,shapeRendering:d?"crispEdges":"auto"},u))}var CRe=["children","data","x","y","fill","className","curve","innerRef","defined"];function Nv(){return Nv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Nv.apply(this,arguments)}function wRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function MV(e){var t=e.children,n=e.data,r=n===void 0?[]:n,s=e.x,a=e.y,o=e.fill,i=o===void 0?"transparent":o,c=e.className,u=e.curve,d=e.innerRef,m=e.defined,p=m===void 0?function(){return!0}:m,h=wRe(e,CRe),g=Fo({x:s,y:a,defined:p,curve:u});return t?A.createElement(A.Fragment,null,t({path:g})):A.createElement("path",Nv({ref:d,className:z("visx-linepath",c),d:g(r)||"",fill:i,strokeLinecap:"round"},h))}var SRe=["className","angle","radius","defined","curve","data","innerRef","children","fill"];function Rv(){return Rv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Rv.apply(this,arguments)}function ERe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function kRe(e){var t=e.className,n=e.angle,r=e.radius,s=e.defined,a=e.curve,o=e.data,i=o===void 0?[]:o,c=e.innerRef,u=e.children,d=e.fill,m=d===void 0?"transparent":d,p=ERe(e,SRe),h=EV({angle:n,radius:r,defined:s,curve:a});return u?A.createElement(A.Fragment,null,u({path:h})):A.createElement("path",Rv({ref:c,className:z("visx-line-radial",t),d:h(i)||"",fill:m},p))}var MRe=["children","x","x0","x1","y","y0","y1","data","defined","className","curve","innerRef"];function Dv(){return Dv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Dv.apply(this,arguments)}function TRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function ARe(e){var t=e.children,n=e.x,r=e.x0,s=e.x1,a=e.y,o=e.y0,i=e.y1,c=e.data,u=c===void 0?[]:c,d=e.defined,m=d===void 0?function(){return!0}:d,p=e.className,h=e.curve,g=e.innerRef,y=TRe(e,MRe),b=qy({x:n,x0:r,x1:s,y:a,y0:o,y1:i,defined:m,curve:h});return t?A.createElement(A.Fragment,null,t({path:b})):A.createElement("path",Dv({ref:g,className:z("visx-area",p),d:b(u)||""},y))}var NRe=["x","x0","x1","y","y1","y0","yScale","data","defined","className","curve","innerRef","children"];function Iv(){return Iv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Iv.apply(this,arguments)}function RRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function jf(e){var t=e.x,n=e.x0,r=e.x1,s=e.y,a=e.y1,o=e.y0,i=e.yScale,c=e.data,u=c===void 0?[]:c,d=e.defined,m=d===void 0?function(){return!0}:d,p=e.className,h=e.curve,g=e.innerRef,y=e.children,b=RRe(e,NRe),x=qy({x:t,x0:n,x1:r,defined:m,curve:h});return o==null?x.y0(i.range()[0]):Cn(x.y0,o),s&&!a&&Cn(x.y1,s),a&&!s&&Cn(x.y1,a),y?A.createElement(A.Fragment,null,y({path:x})):A.createElement("path",Iv({ref:g,className:z("visx-area-closed",p),d:x(u)||""},b))}var DRe=["className","top","left","keys","data","curve","defined","x","x0","x1","y0","y1","value","order","offset","color","children"];function jv(){return jv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jv.apply(this,arguments)}function IRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function TV(e){var t=e.className,n=e.top,r=e.left,s=e.keys,a=e.data,o=e.curve,i=e.defined,c=e.x,u=e.x0,d=e.x1,m=e.y0,p=e.y1,h=e.value,g=e.order,y=e.offset,b=e.color,x=e.children,_=IRe(e,DRe),v=kV({keys:s,value:h,order:g,offset:y}),C=qy({x:c,x0:u,x1:d,y0:m,y1:p,curve:o,defined:i}),w=v(a);return x?A.createElement(A.Fragment,null,x({stacks:w,path:C,stack:v})):A.createElement(Ur,{top:n,left:r},w.map(function(S,E){return A.createElement("path",jv({className:z("visx-stack",t),key:"stack-"+E+"-"+(S.key||""),d:C(S)||"",fill:b?.(S.key,E)},_))}))}var jRe=["className","top","left","keys","data","curve","defined","x","x0","x1","y0","y1","value","order","offset","color","children"];function Dg(){return Dg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Dg.apply(this,arguments)}function PRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function ORe(e){var t=e.className,n=e.top,r=e.left,s=e.keys,a=e.data,o=e.curve,i=e.defined,c=e.x,u=e.x0,d=e.x1,m=e.y0,p=e.y1,h=e.value,g=e.order,y=e.offset,b=e.color,x=e.children,_=PRe(e,jRe);return A.createElement(TV,Dg({className:t,top:n,left:r,keys:s,data:a,curve:o,defined:i,x:c,x0:u,x1:d,y0:m,y1:p,value:h,order:g,offset:y,color:b},_),x||function(v){var C=v.stacks,w=v.path;return C.map(function(S,E){return A.createElement("path",Dg({className:z("visx-area-stack",t),key:"area-stack-"+E+"-"+(S.key||""),d:w(S)||"",fill:b?.(S.key,E)},_))})})}var LRe=["className","innerRef"];function Pv(){return Pv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Pv.apply(this,arguments)}function FRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function Vu(e){var t=e.className,n=e.innerRef,r=FRe(e,LRe);return A.createElement("rect",Pv({ref:n,className:z("visx-bar",t)},r))}var URe=["children","className","innerRef","x","y","width","height","radius","all","top","bottom","left","right","topLeft","topRight","bottomLeft","bottomRight"];function Ov(){return Ov=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ov.apply(this,arguments)}function BRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function HRe(e){var t=e.all,n=e.bottom,r=e.bottomLeft,s=e.bottomRight,a=e.height,o=e.left,i=e.radius,c=e.right,u=e.top,d=e.topLeft,m=e.topRight,p=e.width,h=e.x,g=e.y;m=t||u||c||m,s=t||n||c||s,r=t||n||o||r,d=t||u||o||d,i=Math.max(1,Math.min(i,Math.min(p,a)/2));var y=2*i,b=("M"+(h+i)+","+g+" h"+(p-y)+`
 `+(m?"a"+i+","+i+" 0 0 1 "+i+","+i:"h"+i+"v"+i)+`
 v`+(a-y)+`
 `+(s?"a"+i+","+i+" 0 0 1 "+-i+","+i:"v"+i+"h"+-i)+`
 h`+(y-p)+`
 `+(r?"a"+i+","+i+" 0 0 1 "+-i+","+-i:"h"+-i+"v"+-i)+`
 v`+(y-a)+`
 `+(d?"a"+i+","+i+" 0 0 1 "+i+","+-i:"v"+-i+"h"+i)+`
z`).split(`
`).join("");return b}function VRe(e){var t=e.children,n=e.className,r=e.innerRef,s=e.x,a=e.y,o=e.width,i=e.height,c=e.radius,u=e.all,d=u===void 0?!1:u,m=e.top,p=m===void 0?!1:m,h=e.bottom,g=h===void 0?!1:h,y=e.left,b=y===void 0?!1:y,x=e.right,_=x===void 0?!1:x,v=e.topLeft,C=v===void 0?!1:v,w=e.topRight,S=w===void 0?!1:w,E=e.bottomLeft,T=E===void 0?!1:E,k=e.bottomRight,M=k===void 0?!1:k,N=BRe(e,URe),P=HRe({x:s,y:a,width:o,height:i,radius:c,all:d,top:p,bottom:g,left:b,right:_,topLeft:C,topRight:S,bottomLeft:T,bottomRight:M});return t?A.createElement(A.Fragment,null,t({path:P})):A.createElement("path",Ov({ref:r,className:z("visx-bar-rounded",n),d:P},N))}function Wy(e){if("bandwidth"in e)return e.bandwidth();var t=e.range(),n=e.domain();return Math.abs(t[t.length-1]-t[0])/n.length}var GRe=["data","className","top","left","x0","x0Scale","x1Scale","yScale","color","keys","height","children"];function Lv(){return Lv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Lv.apply(this,arguments)}function zRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function qRe(e){var t=e.data,n=e.className,r=e.top,s=e.left,a=e.x0,o=e.x0Scale,i=e.x1Scale,c=e.yScale,u=e.color,d=e.keys,m=e.height,p=e.children,h=zRe(e,GRe),g=Wy(i),y=t.map(function(b,x){return{index:x,x0:o(a(b)),bars:d.map(function(_,v){var C=b[_];return{index:v,key:_,value:C,width:g,x:i(_)||0,y:c(C)||0,color:u(_,v),height:m-(c(C)||0)}})}});return p?A.createElement(A.Fragment,null,p(y)):A.createElement(Ur,{className:z("visx-bar-group",n),top:r,left:s},y.map(function(b){return A.createElement(Ur,{key:"bar-group-"+b.index+"-"+b.x0,left:b.x0},b.bars.map(function(x){return A.createElement(Vu,Lv({key:"bar-group-bar-"+b.index+"-"+x.index+"-"+x.value+"-"+x.key,x:x.x,y:x.y,width:x.width,height:x.height,fill:x.color},h))}))}))}var $Re=["data","className","top","left","x","y0","y0Scale","y1Scale","xScale","color","keys","width","children"];function Fv(){return Fv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fv.apply(this,arguments)}function WRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function KRe(e){var t=e.data,n=e.className,r=e.top,s=e.left,a=e.x,o=a===void 0?function(){return 0}:a,i=e.y0,c=e.y0Scale,u=e.y1Scale,d=e.xScale,m=e.color,p=e.keys;e.width;var h=e.children,g=WRe(e,$Re),y=Wy(u),b=t.map(function(x,_){return{index:_,y0:c(i(x))||0,bars:p.map(function(v,C){var w=x[v];return{index:C,key:v,value:w,height:y,x:o(w)||0,y:u(v)||0,color:m(v,C),width:d(w)||0}})}});return h?A.createElement(A.Fragment,null,h(b)):A.createElement(Ur,{className:z("visx-bar-group-horizontal",n),top:r,left:s},b.map(function(x){return A.createElement(Ur,{key:"bar-group-"+x.index+"-"+x.y0,top:x.y0},x.bars.map(function(_){return A.createElement(Vu,Fv({key:"bar-group-bar-"+x.index+"-"+_.index+"-"+_.value+"-"+_.key,x:_.x,y:_.y,width:_.width,height:_.height,fill:_.color},g))}))}))}function qs(e){return typeof e?.x=="number"?e?.x:0}function $s(e){return typeof e?.y=="number"?e?.y:0}function Ws(e){return e?.source}function Ks(e){return e?.target}function AV(e){return e?.[0]}function NV(e){return e?.[1]}var YRe=["data","className","top","left","x","y0","y1","xScale","yScale","color","keys","value","order","offset","children"];function Uv(){return Uv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Uv.apply(this,arguments)}function QRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function XRe(e){var t=e.data,n=e.className,r=e.top,s=e.left,a=e.x,o=e.y0,i=o===void 0?AV:o,c=e.y1,u=c===void 0?NV:c,d=e.xScale,m=e.yScale,p=e.color,h=e.keys,g=e.value,y=e.order,b=e.offset,x=e.children,_=QRe(e,YRe),v=A3();h&&v.keys(h),g&&Cn(v.value,g),y&&v.order(Gy(y)),b&&v.offset(zy(b));var C=v(t),w=Wy(d),S=C.map(function(E,T){var k=E.key;return{index:T,key:k,bars:E.map(function(M,N){var P=(m(i(M))||0)-(m(u(M))||0),O=m(u(M)),L="bandwidth"in d?d(a(M.data)):Math.max((d(a(M.data))||0)-w/2);return{bar:M,key:k,index:N,height:P,width:w,x:L||0,y:O||0,color:p(E.key,N)}})}});return x?A.createElement(A.Fragment,null,x(S)):A.createElement(Ur,{className:z("visx-bar-stack",n),top:r,left:s},S.map(function(E){return E.bars.map(function(T){return A.createElement(Vu,Uv({key:"bar-stack-"+E.index+"-"+T.index,x:T.x,y:T.y,height:T.height,width:T.width,fill:T.color},_))})}))}var ZRe=["data","className","top","left","y","x0","x1","xScale","yScale","color","keys","value","order","offset","children"];function Bv(){return Bv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bv.apply(this,arguments)}function JRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function eDe(e){var t=e.data,n=e.className,r=e.top,s=e.left,a=e.y,o=e.x0,i=o===void 0?AV:o,c=e.x1,u=c===void 0?NV:c,d=e.xScale,m=e.yScale,p=e.color,h=e.keys,g=e.value,y=e.order,b=e.offset,x=e.children,_=JRe(e,ZRe),v=A3();h&&v.keys(h),g&&Cn(v.value,g),y&&v.order(Gy(y)),b&&v.offset(zy(b));var C=v(t),w=Wy(m),S=C.map(function(E,T){var k=E.key;return{index:T,key:k,bars:E.map(function(M,N){var P=(d(u(M))||0)-(d(i(M))||0),O=d(i(M)),L="bandwidth"in m?m(a(M.data)):Math.max((m(a(M.data))||0)-P/2);return{bar:M,key:k,index:N,height:w,width:P,x:O||0,y:L||0,color:p(E.key,N)}})}});return x?A.createElement(A.Fragment,null,x(S)):A.createElement(Ur,{className:z("visx-bar-stack-horizontal",n),top:r,left:s},S.map(function(E){return E.bars.map(function(T){return A.createElement(Vu,Bv({key:"bar-stack-"+E.index+"-"+T.index,x:T.x,y:T.y,height:T.height,width:T.width,fill:T.color},_))})}))}var RV=function(t){return Math.PI/180*t},tDe=["className","children","data","innerRef","path","x","y","source","target"];function Hv(){return Hv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Hv.apply(this,arguments)}function nDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function DV(e){var t=e.source,n=e.target,r=e.x,s=e.y;return function(a){var o=A8e();return o.x(r),o.y(s),o.source(t),o.target(n),o(a)}}function rDe(e){var t=e.className,n=e.children,r=e.data,s=e.innerRef,a=e.path,o=e.x,i=o===void 0?$s:o,c=e.y,u=c===void 0?qs:c,d=e.source,m=d===void 0?Ws:d,p=e.target,h=p===void 0?Ks:p,g=nDe(e,tDe),y=a||DV({source:m,target:h,x:i,y:u});return n?A.createElement(A.Fragment,null,n({path:y})):A.createElement("path",Hv({ref:s,className:z("visx-link visx-link-horizontal-diagonal",t),d:y(r)||""},g))}var sDe=["className","children","data","innerRef","path","x","y","source","target"];function Vv(){return Vv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Vv.apply(this,arguments)}function aDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function IV(e){var t=e.source,n=e.target,r=e.x,s=e.y;return function(a){var o=N8e();return o.x(r),o.y(s),o.source(t),o.target(n),o(a)}}function oDe(e){var t=e.className,n=e.children,r=e.data,s=e.innerRef,a=e.path,o=e.x,i=o===void 0?qs:o,c=e.y,u=c===void 0?$s:c,d=e.source,m=d===void 0?Ws:d,p=e.target,h=p===void 0?Ks:p,g=aDe(e,sDe),y=a||IV({source:m,target:h,x:i,y:u});return n?A.createElement(A.Fragment,null,n({path:y})):A.createElement("path",Vv({ref:s,className:z("visx-link visx-link-vertical-diagonal",t),d:y(r)||""},g))}var iDe=["className","children","data","innerRef","path","angle","radius","source","target"];function Gv(){return Gv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Gv.apply(this,arguments)}function lDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function jV(e){var t=e.source,n=e.target,r=e.angle,s=e.radius;return function(a){var o=R8e();return o.angle(r),o.radius(s),o.source(t),o.target(n),o(a)}}function cDe(e){var t=e.className,n=e.children,r=e.data,s=e.innerRef,a=e.path,o=e.angle,i=o===void 0?qs:o,c=e.radius,u=c===void 0?$s:c,d=e.source,m=d===void 0?Ws:d,p=e.target,h=p===void 0?Ks:p,g=lDe(e,iDe),y=a||jV({source:m,target:h,angle:i,radius:u});return n?A.createElement(A.Fragment,null,n({path:y})):A.createElement("path",Gv({ref:s,className:z("visx-link visx-link-radial-diagonal",t),d:y(r)||""},g))}var uDe=["className","children","data","innerRef","path","percent","x","y","source","target"];function zv(){return zv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zv.apply(this,arguments)}function dDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function PV(e){var t=e.source,n=e.target,r=e.x,s=e.y,a=e.percent;return function(o){var i=t(o),c=n(o),u=r(i),d=s(i),m=r(c),p=s(c),h=m-u,g=p-d,y=a*(h+g),b=a*(g-h),x=Ss();return x.moveTo(u,d),x.bezierCurveTo(u+y,d+b,m+b,p-y,m,p),x.toString()}}function fDe(e){var t=e.className,n=e.children,r=e.data,s=e.innerRef,a=e.path,o=e.percent,i=o===void 0?.2:o,c=e.x,u=c===void 0?$s:c,d=e.y,m=d===void 0?qs:d,p=e.source,h=p===void 0?Ws:p,g=e.target,y=g===void 0?Ks:g,b=dDe(e,uDe),x=a||PV({source:h,target:y,x:u,y:m,percent:i});return n?A.createElement(A.Fragment,null,n({path:x})):A.createElement("path",zv({ref:s,className:z("visx-link visx-link-horizontal-curve",t),d:x(r)||""},b))}var mDe=["className","children","data","innerRef","path","percent","x","y","source","target"];function qv(){return qv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qv.apply(this,arguments)}function pDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function OV(e){var t=e.source,n=e.target,r=e.x,s=e.y,a=e.percent;return function(o){var i=t(o),c=n(o),u=r(i),d=s(i),m=r(c),p=s(c),h=m-u,g=p-d,y=a*(h+g),b=a*(g-h),x=Ss();return x.moveTo(u,d),x.bezierCurveTo(u+y,d+b,m+b,p-y,m,p),x.toString()}}function hDe(e){var t=e.className,n=e.children,r=e.data,s=e.innerRef,a=e.path,o=e.percent,i=o===void 0?.2:o,c=e.x,u=c===void 0?qs:c,d=e.y,m=d===void 0?$s:d,p=e.source,h=p===void 0?Ws:p,g=e.target,y=g===void 0?Ks:g,b=pDe(e,mDe),x=a||OV({source:h,target:y,x:u,y:m,percent:i});return n?A.createElement(A.Fragment,null,n({path:x})):A.createElement("path",qv({ref:s,className:z("visx-link visx-link-vertical-curve",t),d:x(r)||""},b))}var gDe=["className","children","data","innerRef","path","percent","x","y","source","target"];function $v(){return $v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$v.apply(this,arguments)}function yDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function LV(e){var t=e.source,n=e.target,r=e.x,s=e.y,a=e.percent;return function(o){var i=t(o),c=n(o),u=r(i)-Math.PI/2,d=s(i),m=r(c)-Math.PI/2,p=s(c),h=Math.cos(u),g=Math.sin(u),y=Math.cos(m),b=Math.sin(m),x=d*h,_=d*g,v=p*y,C=p*b,w=v-x,S=C-_,E=a*(w+S),T=a*(S-w),k=Ss();return k.moveTo(x,_),k.bezierCurveTo(x+E,_+T,v+T,C-E,v,C),k.toString()}}function xDe(e){var t=e.className,n=e.children,r=e.data,s=e.innerRef,a=e.path,o=e.percent,i=o===void 0?.2:o,c=e.x,u=c===void 0?qs:c,d=e.y,m=d===void 0?$s:d,p=e.source,h=p===void 0?Ws:p,g=e.target,y=g===void 0?Ks:g,b=yDe(e,gDe),x=a||LV({source:h,target:y,x:u,y:m,percent:i});return n?A.createElement(A.Fragment,null,n({path:x})):A.createElement("path",$v({ref:s,className:z("visx-link visx-link-radial-curve",t),d:x(r)||""},b))}var bDe=["className","children","innerRef","data","path","x","y","source","target"];function Wv(){return Wv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Wv.apply(this,arguments)}function _De(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function FV(e){var t=e.source,n=e.target,r=e.x,s=e.y;return function(a){var o=t(a),i=n(a),c=r(o),u=s(o),d=r(i),m=s(i),p=Ss();return p.moveTo(c,u),p.lineTo(d,m),p.toString()}}function vDe(e){var t=e.className,n=e.children,r=e.innerRef,s=e.data,a=e.path,o=e.x,i=o===void 0?$s:o,c=e.y,u=c===void 0?qs:c,d=e.source,m=d===void 0?Ws:d,p=e.target,h=p===void 0?Ks:p,g=_De(e,bDe),y=a||FV({source:m,target:h,x:i,y:u});return n?A.createElement(A.Fragment,null,n({path:y})):A.createElement("path",Wv({ref:r,className:z("visx-link visx-link-horizontal-line",t),d:y(s)||""},g))}var CDe=["className","innerRef","data","path","x","y","source","target","children"];function Kv(){return Kv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Kv.apply(this,arguments)}function wDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function UV(e){var t=e.source,n=e.target,r=e.x,s=e.y;return function(a){var o=t(a),i=n(a),c=r(o),u=s(o),d=r(i),m=s(i),p=Ss();return p.moveTo(c,u),p.lineTo(d,m),p.toString()}}function SDe(e){var t=e.className,n=e.innerRef,r=e.data,s=e.path,a=e.x,o=a===void 0?qs:a,i=e.y,c=i===void 0?$s:i,u=e.source,d=u===void 0?Ws:u,m=e.target,p=m===void 0?Ks:m,h=e.children,g=wDe(e,CDe),y=s||UV({source:d,target:p,x:o,y:c});return h?A.createElement(A.Fragment,null,h({path:y})):A.createElement("path",Kv({ref:n,className:z("visx-link visx-link-vertical-line",t),d:y(r)||""},g))}var EDe=["className","innerRef","data","path","x","y","source","target","children"];function Yv(){return Yv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Yv.apply(this,arguments)}function kDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function BV(e){var t=e.source,n=e.target,r=e.x,s=e.y;return function(a){var o=t(a),i=n(a),c=r(o)-Math.PI/2,u=s(o),d=r(i)-Math.PI/2,m=s(i),p=Math.cos(c),h=Math.sin(c),g=Math.cos(d),y=Math.sin(d),b=Ss();return b.moveTo(u*p,u*h),b.lineTo(m*g,m*y),b.toString()}}function MDe(e){var t=e.className,n=e.innerRef,r=e.data,s=e.path,a=e.x,o=a===void 0?qs:a,i=e.y,c=i===void 0?$s:i,u=e.source,d=u===void 0?Ws:u,m=e.target,p=m===void 0?Ks:m,h=e.children,g=kDe(e,EDe),y=s||BV({source:d,target:p,x:o,y:c});return h?A.createElement(A.Fragment,null,h({path:y})):A.createElement("path",Yv({ref:n,className:z("visx-link visx-link-radial-line",t),d:y(r)||""},g))}var TDe=["className","innerRef","data","path","percent","x","y","source","target","children"];function Qv(){return Qv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Qv.apply(this,arguments)}function ADe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function HV(e){var t=e.source,n=e.target,r=e.x,s=e.y,a=e.percent;return function(o){var i=t(o),c=n(o),u=r(i),d=s(i),m=r(c),p=s(c),h=Ss();return h.moveTo(u,d),h.lineTo(u+(m-u)*a,d),h.lineTo(u+(m-u)*a,p),h.lineTo(m,p),h.toString()}}function NDe(e){var t=e.className,n=e.innerRef,r=e.data,s=e.path,a=e.percent,o=a===void 0?.5:a,i=e.x,c=i===void 0?$s:i,u=e.y,d=u===void 0?qs:u,m=e.source,p=m===void 0?Ws:m,h=e.target,g=h===void 0?Ks:h,y=e.children,b=ADe(e,TDe),x=s||HV({source:p,target:g,x:c,y:d,percent:o});return y?A.createElement(A.Fragment,null,y({path:x})):A.createElement("path",Qv({ref:n,className:z("visx-link visx-link-horizontal-step",t),d:x(r)||""},b))}var RDe=["className","innerRef","data","path","percent","x","y","source","target","children"];function Xv(){return Xv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Xv.apply(this,arguments)}function DDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function VV(e){var t=e.source,n=e.target,r=e.x,s=e.y,a=e.percent;return function(o){var i=t(o),c=n(o),u=r(i),d=s(i),m=r(c),p=s(c),h=Ss();return h.moveTo(u,d),h.lineTo(u,d+(p-d)*a),h.lineTo(m,d+(p-d)*a),h.lineTo(m,p),h.toString()}}function IDe(e){var t=e.className,n=e.innerRef,r=e.data,s=e.path,a=e.percent,o=a===void 0?.5:a,i=e.x,c=i===void 0?qs:i,u=e.y,d=u===void 0?$s:u,m=e.source,p=m===void 0?Ws:m,h=e.target,g=h===void 0?Ks:h,y=e.children,b=DDe(e,RDe),x=s||VV({source:p,target:g,x:c,y:d,percent:o});return y?A.createElement(A.Fragment,null,y({path:x})):A.createElement("path",Xv({ref:n,className:z("visx-link visx-link-vertical-step",t),d:x(r)||""},b))}var jDe=["className","innerRef","data","path","x","y","source","target","children"];function Zv(){return Zv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zv.apply(this,arguments)}function PDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function GV(e){var t=e.source,n=e.target,r=e.x,s=e.y;return function(a){var o=t(a),i=n(a),c=r(o),u=s(o),d=r(i),m=s(i),p=c-Math.PI/2,h=u,g=d-Math.PI/2,y=m,b=Math.cos(p),x=Math.sin(p),_=Math.cos(g),v=Math.sin(g),C=Math.abs(g-p)>Math.PI?g<=p:g>p;return`
      M`+h*b+","+h*x+`
      A`+h+","+h+",0,0,"+(C?1:0)+","+h*_+","+h*v+`
      L`+y*_+","+y*v+`
    `}}function ODe(e){var t=e.className,n=e.innerRef,r=e.data,s=e.path,a=e.x,o=a===void 0?qs:a,i=e.y,c=i===void 0?$s:i,u=e.source,d=u===void 0?Ws:u,m=e.target,p=m===void 0?Ks:m,h=e.children,g=PDe(e,jDe),y=s||GV({source:d,target:p,x:o,y:c});return h?A.createElement(A.Fragment,null,h({path:y})):A.createElement("path",Zv({ref:n,className:z("visx-link visx-link-radial-step",t),d:y(r)||""},g))}var LDe=["sides","size","center","rotate","className","children","innerRef","points"];function Jv(){return Jv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Jv.apply(this,arguments)}function FDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}var zV={x:0,y:0},qV=function(t){var n=t.sides,r=n===void 0?4:n,s=t.size,a=s===void 0?25:s,o=t.center,i=o===void 0?zV:o,c=t.rotate,u=c===void 0?0:c,d=t.side,m=360/r*d-u,p=RV(m);return{x:i.x+a*Math.cos(p),y:i.y+a*Math.sin(p)}},$V=function(t){var n=t.sides,r=t.size,s=t.center,a=t.rotate;return new Array(n).fill(0).map(function(o,i){return qV({sides:n,size:r,center:s,rotate:a,side:i})})};function UDe(e){var t=e.sides,n=t===void 0?4:t,r=e.size,s=r===void 0?25:r,a=e.center,o=a===void 0?zV:a,i=e.rotate,c=i===void 0?0:i,u=e.className,d=e.children,m=e.innerRef,p=e.points,h=FDe(e,LDe),g=p||$V({sides:n,size:s,center:o,rotate:c}).map(function(y){var b=y.x,x=y.y;return[b,x]});return d?A.createElement(A.Fragment,null,d({points:g})):A.createElement("polygon",Jv({ref:m,className:z("visx-polygon",u),points:g.join(" ")},h))}var BDe=["className","innerRef"];function eC(){return eC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},eC.apply(this,arguments)}function HDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function VDe(e){var t=e.className,n=e.innerRef,r=HDe(e,BDe);return A.createElement("circle",eC({ref:n,className:z("visx-circle",t)},r))}var H6="http://www.w3.org/2000/svg";function GDe(e){var t=document.getElementById(e);if(!t){var n=document.createElementNS(H6,"svg");n.setAttribute("aria-hidden","true"),n.style.opacity="0",n.style.width="0",n.style.height="0",n.style.position="absolute",n.style.top="-100%",n.style.left="-100%",n.style.pointerEvents="none",t=document.createElementNS(H6,"path"),t.setAttribute("id",e),n.appendChild(t),document.body.appendChild(n)}return t}var zDe="__visx_splitpath_svg_path_measurement_id",V6=function(){return!0};function qDe(e){var t=e.path,n=e.pointsInSegments,r=e.segmentation,s=r===void 0?"x":r,a=e.sampleRate,o=a===void 0?1:a;try{var i=GDe(zDe);i.setAttribute("d",t);var c=i.getTotalLength(),u=n.length,d=n.map(function(){return[]});if(s==="x"||s==="y")for(var m=n.map(function(O){var L;return(L=O.find(function(H){return typeof H[s]=="number"}))==null?void 0:L[s]}),p=i.getPointAtLength(0),h=i.getPointAtLength(c),g=h[s]>p[s],y=g?m.map(function(O){return typeof O>"u"?V6:function(L){return L>=O}}):m.map(function(O){return typeof O>"u"?V6:function(L){return L<=O}}),b=0,x=0;x<=c;x+=o){for(var _=i.getPointAtLength(x),v=_[s];b<u-1&&y[b+1](v);)b+=1;d[b].push(_)}else{var C=n.map(function(O){return O.length}),w=C.reduce(function(O,L){return O+L},0),S=c/Math.max(1,w-1),E=C.slice(0,u-1);E.unshift(0);for(var T=2;T<u;T+=1)E[T]+=E[T-1];for(var k=0;k<u;k+=1)E[k]*=S;for(var M=0,N=0;N<=c;N+=o){for(var P=i.getPointAtLength(N);M<u-1&&N>=E[M+1];)M+=1;d[M].push(P)}}return d}catch{return[]}}function tC(){return tC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tC.apply(this,arguments)}var $De=function(t){return t.x||0},WDe=function(t){return t.y||0};function WV(e){var t=e.children,n=e.className,r=e.curve,s=e.defined,a=e.segmentation,o=e.sampleRate,i=e.segments,c=e.x,u=e.y,d=e.styles,m=f.useMemo(function(){var g=typeof c=="number"||typeof c>"u"?function(){return c}:c,y=typeof u=="number"||typeof u>"u"?function(){return u}:u;return i.map(function(b){return b.map(function(x,_){return{x:g(x,_,b),y:y(x,_,b)}})})},[c,u,i]),p=f.useMemo(function(){var g=Fo({x:c,y:u,defined:s,curve:r});return g(i.flat())||""},[c,u,s,r,i]),h=f.useMemo(function(){return qDe({path:p,segmentation:a,pointsInSegments:m,sampleRate:o})},[p,a,m,o]);return A.createElement("g",null,h.map(function(g,y){return t?A.createElement(A.Fragment,{key:y},t({index:y,segment:g,styles:d[y]||d[y%d.length]})):A.createElement(MV,tC({key:y,className:n,data:g,x:$De,y:WDe},d[y]||d[y%d.length]))}))}WV.propTypes={segments:Je.arrayOf(Je.array).isRequired,styles:Je.array.isRequired,children:Je.func,className:Je.string};const KDe=Object.freeze(Object.defineProperty({__proto__:null,Arc:gRe,Area:ARe,AreaClosed:jf,AreaStack:ORe,Bar:Vu,BarGroup:qRe,BarGroupHorizontal:KRe,BarRounded:VRe,BarStack:XRe,BarStackHorizontal:eDe,Circle:VDe,Line:$y,LinePath:MV,LineRadial:kRe,LinkHorizontal:rDe,LinkHorizontalCurve:fDe,LinkHorizontalLine:vDe,LinkHorizontalStep:NDe,LinkRadial:cDe,LinkRadialCurve:xDe,LinkRadialLine:MDe,LinkRadialStep:ODe,LinkVertical:oDe,LinkVerticalCurve:hDe,LinkVerticalLine:SDe,LinkVerticalStep:IDe,Pie:bRe,Polygon:UDe,STACK_OFFSETS:Rg,STACK_OFFSET_NAMES:mRe,STACK_ORDERS:Ng,STACK_ORDER_NAMES:fRe,SplitLinePath:WV,Stack:TV,arc:s5,area:qy,degreesToRadians:RV,getPoint:qV,getPoints:$V,line:Fo,pathHorizontalCurve:PV,pathHorizontalDiagonal:DV,pathHorizontalLine:FV,pathHorizontalStep:HV,pathRadialCurve:LV,pathRadialDiagonal:jV,pathRadialLine:BV,pathRadialStep:GV,pathVerticalCurve:OV,pathVerticalDiagonal:IV,pathVerticalLine:UV,pathVerticalStep:VV,pie:SV,radialLine:EV,stack:kV,stackOffset:zy,stackOrder:Gy},Symbol.toStringTag,{value:"Module"}));var fb,G6;function YDe(){if(G6)return fb;G6=1,fb=e;function e(r,s,a){r instanceof RegExp&&(r=t(r,a)),s instanceof RegExp&&(s=t(s,a));var o=n(r,s,a);return o&&{start:o[0],end:o[1],pre:a.slice(0,o[0]),body:a.slice(o[0]+r.length,o[1]),post:a.slice(o[1]+s.length)}}function t(r,s){var a=s.match(r);return a?a[0]:null}e.range=n;function n(r,s,a){var o,i,c,u,d,m=a.indexOf(r),p=a.indexOf(s,m+1),h=m;if(m>=0&&p>0){for(o=[],c=a.length;h>=0&&!d;)h==m?(o.push(h),m=a.indexOf(r,h+1)):o.length==1?d=[o.pop(),p]:(i=o.pop(),i<c&&(c=i,u=p),p=a.indexOf(s,h+1)),h=m<p&&m>=0?m:p;o.length&&(d=[c,u])}return d}return fb}var mb,z6;function QDe(){if(z6)return mb;z6=1,mb=e;function e(r,s,a){r instanceof RegExp&&(r=t(r,a)),s instanceof RegExp&&(s=t(s,a));var o=n(r,s,a);return o&&{start:o[0],end:o[1],pre:a.slice(0,o[0]),body:a.slice(o[0]+r.length,o[1]),post:a.slice(o[1]+s.length)}}function t(r,s){var a=s.match(r);return a?a[0]:null}e.range=n;function n(r,s,a){var o,i,c,u,d,m=a.indexOf(r),p=a.indexOf(s,m+1),h=m;if(m>=0&&p>0){if(r===s)return[m,p];for(o=[],c=a.length;h>=0&&!d;)h==m?(o.push(h),m=a.indexOf(r,h+1)):o.length==1?d=[o.pop(),p]:(i=o.pop(),i<c&&(c=i,u=p),p=a.indexOf(s,h+1)),h=m<p&&m>=0?m:p;o.length&&(d=[c,u])}return d}return mb}var pb,q6;function XDe(){if(q6)return pb;q6=1;var e=QDe();pb=t;function t(s,a,o){var i=s;return n(s,a).reduce(function(c,u){return c.replace(u.functionIdentifier+"("+u.matches.body+")",r(u.matches.body,u.functionIdentifier,o,i,a))},s)}function n(s,a){var o=[],i=typeof a=="string"?new RegExp("\\b("+a+")\\("):a;do{var c=i.exec(s);if(!c)return o;if(c[1]===void 0)throw new Error("Missing the first couple of parenthesis to get the function identifier in "+a);var u=c[1],d=c.index,m=e("(",")",s.substring(d));if(!m||m.start!==c[0].length-1)throw new SyntaxError(u+"(): missing closing ')' in the value '"+s+"'");o.push({matches:m,functionIdentifier:u}),s=m.post}while(i.test(s));return o}function r(s,a,o,i,c){return o(t(s,c,o),a,i)}return pb}var hb,$6;function ZDe(){if($6)return hb;$6=1;var e=function(t){this.value=t};return e.math={isDegree:!0,acos:function(t){return e.math.isDegree?180/Math.PI*Math.acos(t):Math.acos(t)},add:function(t,n){return t+n},asin:function(t){return e.math.isDegree?180/Math.PI*Math.asin(t):Math.asin(t)},atan:function(t){return e.math.isDegree?180/Math.PI*Math.atan(t):Math.atan(t)},acosh:function(t){return Math.log(t+Math.sqrt(t*t-1))},asinh:function(t){return Math.log(t+Math.sqrt(t*t+1))},atanh:function(t){return Math.log((1+t)/(1-t))},C:function(t,n){var r=1,s=t-n,a=n;a<s&&(a=s,s=n);for(var o=a+1;o<=t;o++)r*=o;return r/e.math.fact(s)},changeSign:function(t){return-t},cos:function(t){return e.math.isDegree&&(t=e.math.toRadian(t)),Math.cos(t)},cosh:function(t){return(Math.pow(Math.E,t)+Math.pow(Math.E,-1*t))/2},div:function(t,n){return t/n},fact:function(t){if(t%1!==0)return"NaN";for(var n=1,r=2;r<=t;r++)n*=r;return n},inverse:function(t){return 1/t},log:function(t){return Math.log(t)/Math.log(10)},mod:function(t,n){return t%n},mul:function(t,n){return t*n},P:function(t,n){for(var r=1,s=Math.floor(t)-Math.floor(n)+1;s<=Math.floor(t);s++)r*=s;return r},Pi:function(t,n,r){for(var s=1,a=t;a<=n;a++)s*=Number(r.postfixEval({n:a}));return s},pow10x:function(t){for(var n=1;t--;)n*=10;return n},sigma:function(t,n,r){for(var s=0,a=t;a<=n;a++)s+=Number(r.postfixEval({n:a}));return s},sin:function(t){return e.math.isDegree&&(t=e.math.toRadian(t)),Math.sin(t)},sinh:function(t){return(Math.pow(Math.E,t)-Math.pow(Math.E,-1*t))/2},sub:function(t,n){return t-n},tan:function(t){return e.math.isDegree&&(t=e.math.toRadian(t)),Math.tan(t)},tanh:function(t){return e.sinha(t)/e.cosha(t)},toRadian:function(t){return t*Math.PI/180},and:function(t,n){return t&n}},e.Exception=function(t){this.message=t},hb=e,hb}var gb,W6;function JDe(){if(W6)return gb;W6=1;var e=ZDe();function t(_,v){for(var C=0;C<_.length;C++)_[C]+=v;return _}for(var n=[{token:"sin",show:"sin",type:0,value:e.math.sin},{token:"cos",show:"cos",type:0,value:e.math.cos},{token:"tan",show:"tan",type:0,value:e.math.tan},{token:"pi",show:"&pi;",type:3,value:"PI"},{token:"(",show:"(",type:4,value:"("},{token:")",show:")",type:5,value:")"},{token:"P",show:"P",type:10,value:e.math.P},{token:"C",show:"C",type:10,value:e.math.C},{token:" ",show:" ",type:14,value:" ".anchor},{token:"asin",show:"asin",type:0,value:e.math.asin},{token:"acos",show:"acos",type:0,value:e.math.acos},{token:"atan",show:"atan",type:0,value:e.math.atan},{token:"7",show:"7",type:1,value:"7"},{token:"8",show:"8",type:1,value:"8"},{token:"9",show:"9",type:1,value:"9"},{token:"int",show:"Int",type:0,value:Math.floor},{token:"cosh",show:"cosh",type:0,value:e.math.cosh},{token:"acosh",show:"acosh",type:0,value:e.math.acosh},{token:"ln",show:" ln",type:0,value:Math.log},{token:"^",show:"^",type:10,value:Math.pow},{token:"root",show:"root",type:0,value:Math.sqrt},{token:"4",show:"4",type:1,value:"4"},{token:"5",show:"5",type:1,value:"5"},{token:"6",show:"6",type:1,value:"6"},{token:"/",show:"&divide;",type:2,value:e.math.div},{token:"!",show:"!",type:7,value:e.math.fact},{token:"tanh",show:"tanh",type:0,value:e.math.tanh},{token:"atanh",show:"atanh",type:0,value:e.math.atanh},{token:"Mod",show:" Mod ",type:2,value:e.math.mod},{token:"1",show:"1",type:1,value:"1"},{token:"2",show:"2",type:1,value:"2"},{token:"3",show:"3",type:1,value:"3"},{token:"*",show:"&times;",type:2,value:e.math.mul},{token:"sinh",show:"sinh",type:0,value:e.math.sinh},{token:"asinh",show:"asinh",type:0,value:e.math.asinh},{token:"e",show:"e",type:3,value:"E"},{token:"log",show:" log",type:0,value:e.math.log},{token:"0",show:"0",type:1,value:"0"},{token:".",show:".",type:6,value:"."},{token:"+",show:"+",type:9,value:e.math.add},{token:"-",show:"-",type:9,value:e.math.sub},{token:",",show:",",type:11,value:","},{token:"Sigma",show:"&Sigma;",type:12,value:e.math.sigma},{token:"n",show:"n",type:13,value:"n"},{token:"Pi",show:"&Pi;",type:12,value:e.math.Pi},{token:"pow",show:"pow",type:8,value:Math.pow,numberOfArguments:2},{token:"&",show:"&",type:9,value:e.math.and}],r={0:11,1:0,2:3,3:0,4:0,5:0,6:0,7:11,8:11,9:1,10:10,11:0,12:11,13:0,14:-1,15:11},s=0;s<n.length;s++)n[s].precedence=r[n[s].type];var a={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,9:!0,12:!0,13:!0,14:!0,15:!0},o={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0,15:!0},i={0:!0,3:!0,4:!0,8:!0,12:!0,13:!0,15:!0},c={},u={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,12:!0,13:!0,15:!0},d={1:!0},m=[[],["1","2","3","7","8","9","4","5","6","+","-","*","/","(",")","^","!","P","C","e","0",".",",","n"," ","&"],["pi","ln","Pi"],["sin","cos","tan","Del","int","Mod","log","pow"],["asin","acos","atan","cosh","root","tanh","sinh"],["acosh","atanh","asinh","Sigma"]];function p(_,v,C,w){for(var S=0;S<w;S++)if(_[C+S]!==v[S])return!1;return!0}e.tokenTypes={FUNCTION_WITH_ONE_ARG:0,NUMBER:1,BINARY_OPERATOR_HIGH_PRECENDENCE:2,CONSTANT:3,OPENING_PARENTHESIS:4,CLOSING_PARENTHESIS:5,DECIMAL:6,POSTFIX_FUNCTION_WITH_ONE_ARG:7,FUNCTION_WITH_N_ARGS:8,BINARY_OPERATOR_LOW_PRECENDENCE:9,BINARY_OPERATOR_PERMUTATION:10,COMMA:11,EVALUATED_FUNCTION:12,EVALUATED_FUNCTION_PARAMETER:13,SPACE:14},e.addToken=function(_){for(var v=0;v<_.length;v++){var C=_[v].token.length,w=-1;_[v].type===e.tokenTypes.FUNCTION_WITH_N_ARGS&&_[v].numberOfArguments===void 0&&(_[v].numberOfArguments=2),m[C]=m[C]||[];for(var S=0;S<m[C].length;S++)if(_[v].token===m[C][S]){w=h(m[C][S],n);break}w===-1?(n.push(_[v]),_[v].precedence=r[_[v].type],m.length<=_[v].token.length&&(m[_[v].token.length]=[]),m[_[v].token.length].push(_[v].token)):(n[w]=_[v],_[v].precedence=r[_[v].type])}};function h(_,v){for(var C=0;C<v.length;C++)if(v[C].token===_)return C;return-1}function g(_){for(var v=[],C=_.length,w,S,E,T=0;T<C;T++)if(!(T<C-1&&_[T]===" "&&_[T+1]===" ")){for(w="",S=_.length-T>m.length-2?m.length-1:_.length-T;S>0;S--)if(m[S]!==void 0)for(E=0;E<m[S].length;E++)p(_,m[S][E],T,S)&&(w=m[S][E],E=m[S].length,S=0);if(T+=w.length-1,w==="")throw new e.Exception("Can't understand after "+_.slice(T));v.push(n[h(w,n)])}return v}var y={value:e.math.changeSign,type:0,pre:21,show:"-"},b={value:")",show:")",type:5,pre:0},x={value:"(",type:4,pre:0,show:"("};return e.lex=function(_,v){var C=[x],w=[],S=_,E=a,T=0,k=c,M="",N;typeof v<"u"&&e.addToken(v);var P={},O=g(S);for(N=0;N<O.length;N++){var L=O[N];if(L.type===14){if(N>0&&N<O.length-1&&O[N+1].type===1&&(O[N-1].type===1||O[N-1].type===6))throw new e.Exception("Unexpected Space");continue}var H=L.token,R=L.type,I=L.value,F=L.precedence,G=L.show,j=C[C.length-1],$;for($=w.length;$--&&w[$]===0;)if([0,2,3,4,5,9,11,12,13].indexOf(R)!==-1){if(E[R]!==!0)throw new e.Exception(H+" is not allowed after "+M);C.push(b),E=o,k=u,w.pop()}if(E[R]!==!0)throw new e.Exception(H+" is not allowed after "+M);if(k[R]===!0&&(R=2,I=e.math.mul,G="&times;",F=3,N=N-1),P={value:I,type:R,pre:F,show:G,numberOfArguments:L.numberOfArguments},R===0)E=a,k=c,t(w,2),C.push(P),O[N+1].type!==4&&(C.push(x),w.push(2));else if(R===1)j.type===1?(j.value+=I,t(w,1)):C.push(P),E=o,k=i;else if(R===2)E=a,k=c,t(w,2),C.push(P);else if(R===3)C.push(P),E=o,k=u;else if(R===4)t(w,1),T++,E=a,k=c,C.push(P);else if(R===5){if(!T)throw new e.Exception("Closing parenthesis are more than opening one, wait What!!!");T--,E=o,k=u,C.push(P),t(w,1)}else if(R===6){if(j.hasDec)throw new e.Exception("Two decimals are not allowed in one number");j.type!==1&&(j={value:0,type:1,pre:0},C.push(j)),E=d,t(w,1),k=c,j.value+=I,j.hasDec=!0}else R===7&&(E=o,k=u,t(w,1),C.push(P));R===8?(E=a,k=c,t(w,L.numberOfArguments+2),C.push(P),O[N+1].type!==4&&(C.push(x),w.push(L.numberOfArguments+2))):R===9?(j.type===9?j.value===e.math.add?(j.value=I,j.show=G,t(w,1)):j.value===e.math.sub&&G==="-"&&(j.value=e.math.add,j.show="+",t(w,1)):j.type!==5&&j.type!==7&&j.type!==1&&j.type!==3&&j.type!==13?H==="-"&&(E=a,k=c,t(w,2).push(2),C.push(y),C.push(x)):(C.push(P),t(w,2)),E=a,k=c):R===10?(E=a,k=c,t(w,2),C.push(P)):R===11?(E=a,k=c,C.push(P)):R===12?(E=a,k=c,t(w,6),C.push(P),O[N+1].type!==4&&(C.push(x),w.push(6))):R===13&&(E=o,k=u,C.push(P)),t(w,-1),M=H}for($=w.length;$--;)C.push(b);if(E[5]!==!0)throw new e.Exception("complete the expression");for(;T--;)C.push(b);return C.push(b),new e(C)},gb=e,gb}var yb,K6;function eIe(){if(K6)return yb;K6=1;var e=JDe();return e.prototype.toPostfix=function(){for(var t=[],n,r,s,a,o,i=[{value:"(",type:4,pre:0}],c=this.value,u=1;u<c.length;u++)if(c[u].type===1||c[u].type===3||c[u].type===13)c[u].type===1&&(c[u].value=Number(c[u].value)),t.push(c[u]);else if(c[u].type===4)i.push(c[u]);else if(c[u].type===5)for(;(r=i.pop()).type!==4;)t.push(r);else if(c[u].type===11){for(;(r=i.pop()).type!==4;)t.push(r);i.push(r)}else{n=c[u],a=n.pre,o=i[i.length-1],s=o.pre;var d=o.value=="Math.pow"&&n.value=="Math.pow";if(a>s)i.push(n);else{for(;s>=a&&!d||d&&a<s;)r=i.pop(),o=i[i.length-1],t.push(r),s=o.pre,d=n.value=="Math.pow"&&o.value=="Math.pow";i.push(n)}}return new e(t)},yb=e,yb}var xb,Y6;function tIe(){if(Y6)return xb;Y6=1;var e=eIe();return e.prototype.postfixEval=function(t){t=t||{},t.PI=Math.PI,t.E=Math.E;for(var n=[],r,s,a,o=this.value,i=typeof t.n<"u",c=0;c<o.length;c++)if(o[c].type===1)n.push({value:o[c].value,type:1});else if(o[c].type===3)n.push({value:t[o[c].value],type:1});else if(o[c].type===0)typeof n[n.length-1].type>"u"?n[n.length-1].value.push(o[c]):n[n.length-1].value=o[c].value(n[n.length-1].value);else if(o[c].type===7)typeof n[n.length-1].type>"u"?n[n.length-1].value.push(o[c]):n[n.length-1].value=o[c].value(n[n.length-1].value);else if(o[c].type===8){for(var u=[],d=0;d<o[c].numberOfArguments;d++)u.push(n.pop().value);n.push({type:1,value:o[c].value.apply(o[c],u.reverse())})}else o[c].type===10?(r=n.pop(),s=n.pop(),typeof s.type>"u"?(s.value=s.concat(r),s.value.push(o[c]),n.push(s)):typeof r.type>"u"?(r.unshift(s),r.push(o[c]),n.push(r)):n.push({type:1,value:o[c].value(s.value,r.value)})):o[c].type===2||o[c].type===9?(r=n.pop(),s=n.pop(),typeof s.type>"u"?(s=s.concat(r),s.push(o[c]),n.push(s)):typeof r.type>"u"?(r.unshift(s),r.push(o[c]),n.push(r)):n.push({type:1,value:o[c].value(s.value,r.value)})):o[c].type===12?(r=n.pop(),typeof r.type<"u"&&(r=[r]),s=n.pop(),a=n.pop(),n.push({type:1,value:o[c].value(a.value,s.value,new e(r))})):o[c].type===13&&(i?n.push({value:t[o[c].value],type:3}):n.push([o[c]]));if(n.length>1)throw new e.Exception("Uncaught Syntax error");return n[0].value>1e15?"Infinity":parseFloat(n[0].value.toFixed(15))},e.eval=function(t,n,r){return typeof n>"u"?this.lex(t).toPostfix().postfixEval():typeof r>"u"?typeof n.length<"u"?this.lex(t,n).toPostfix().postfixEval():this.lex(t).toPostfix().postfixEval(n):this.lex(t,n).toPostfix().postfixEval(r)},xb=e,xb}var bb,Q6;function nIe(){if(Q6)return bb;Q6=1;var e=tIe();return e.prototype.formulaEval=function(){for(var t,n,r,s=[],a=this.value,o=0;o<a.length;o++)a[o].type===1||a[o].type===3?s.push({value:a[o].type===3?a[o].show:a[o].value,type:1}):a[o].type===13?s.push({value:a[o].show,type:1}):a[o].type===0?s[s.length-1]={value:a[o].show+(a[o].show!="-"?"(":"")+s[s.length-1].value+(a[o].show!="-"?")":""),type:0}:a[o].type===7?s[s.length-1]={value:(s[s.length-1].type!=1?"(":"")+s[s.length-1].value+(s[s.length-1].type!=1?")":"")+a[o].show,type:7}:a[o].type===10?(t=s.pop(),n=s.pop(),a[o].show==="P"||a[o].show==="C"?s.push({value:"<sup>"+n.value+"</sup>"+a[o].show+"<sub>"+t.value+"</sub>",type:10}):s.push({value:(n.type!=1?"(":"")+n.value+(n.type!=1?")":"")+"<sup>"+t.value+"</sup>",type:1})):a[o].type===2||a[o].type===9?(t=s.pop(),n=s.pop(),s.push({value:(n.type!=1?"(":"")+n.value+(n.type!=1?")":"")+a[o].show+(t.type!=1?"(":"")+t.value+(t.type!=1?")":""),type:a[o].type})):a[o].type===12&&(t=s.pop(),n=s.pop(),r=s.pop(),s.push({value:a[o].show+"("+r.value+","+n.value+","+t.value+")",type:12}));return s[0].value},bb=e,bb}var _b,X6;function rIe(){if(X6)return _b;X6=1;var e=YDe(),t=XDe(),n=nIe(),r=100,s=/(\+|\-|\*|\\|[^a-z]|)(\s*)(\()/g,a;_b=o;function o(c,u){a=0,u=Math.pow(10,u===void 0?5:u),c=c.replace(/\n+/g," ");function d(p,h,g){if(a++>r)throw a=0,new Error("Call stack overflow for "+g);if(p==="")throw new Error(h+"(): '"+g+"' must contain a non-whitespace string");p=m(p,g);var y=i(p);if(y.length>1||p.indexOf("var(")>-1)return h+"("+p+")";var b=y[0]||"";b==="%"&&(p=p.replace(/\b[0-9\.]+%/g,function(v){return parseFloat(v.slice(0,-1))*.01}));var x=p.replace(new RegExp(b,"gi"),""),_;try{_=n.eval(x)}catch{return h+"("+p+")"}return b==="%"&&(_*=100),(h.length||b==="%")&&(_=Math.round(_*u)/u),_+=b,_}function m(p,h){p=p.replace(/((?:\-[a-z]+\-)?calc)/g,"");for(var g="",y=p,b;b=s.exec(y);){b[0].index>0&&(g+=y.substring(0,b[0].index));var x=e("(",")",y.substring([0].index));if(x.body==="")throw new Error("'"+p+"' must contain a non-whitespace string");var _=d(x.body,"",h);g+=x.pre+_,y=x.post}return g+y}return t(c,/((?:\-[a-z]+\-)?calc)\(/,d)}function i(c){for(var u=[],d=[],m=/[\.0-9]([%a-z]+)/gi,p=m.exec(c);p;)!p||!p[1]||(d.indexOf(p[1].toLowerCase())===-1&&(u.push(p[1]),d.push(p[1].toLowerCase())),p=m.exec(c));return u}return _b}var sIe=rIe();const vb=ha(sIe);var Cb,Z6;function aIe(){if(Z6)return Cb;Z6=1;var e=typeof gc=="object"&&gc&&gc.Object===Object&&gc;return Cb=e,Cb}var wb,J6;function a5(){if(J6)return wb;J6=1;var e=aIe(),t=typeof self=="object"&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return wb=n,wb}var Sb,e7;function KV(){if(e7)return Sb;e7=1;var e=a5(),t=e.Symbol;return Sb=t,Sb}var Eb,t7;function oIe(){if(t7)return Eb;t7=1;var e=KV(),t=Object.prototype,n=t.hasOwnProperty,r=t.toString,s=e?e.toStringTag:void 0;function a(o){var i=n.call(o,s),c=o[s];try{o[s]=void 0;var u=!0}catch{}var d=r.call(o);return u&&(i?o[s]=c:delete o[s]),d}return Eb=a,Eb}var kb,n7;function iIe(){if(n7)return kb;n7=1;var e=Object.prototype,t=e.toString;function n(r){return t.call(r)}return kb=n,kb}var Mb,r7;function lIe(){if(r7)return Mb;r7=1;var e=KV(),t=oIe(),n=iIe(),r="[object Null]",s="[object Undefined]",a=e?e.toStringTag:void 0;function o(i){return i==null?i===void 0?s:r:a&&a in Object(i)?t(i):n(i)}return Mb=o,Mb}var Tb,s7;function YV(){if(s7)return Tb;s7=1;function e(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}return Tb=e,Tb}var Ab,a7;function cIe(){if(a7)return Ab;a7=1;var e=lIe(),t=YV(),n="[object AsyncFunction]",r="[object Function]",s="[object GeneratorFunction]",a="[object Proxy]";function o(i){if(!t(i))return!1;var c=e(i);return c==r||c==s||c==n||c==a}return Ab=o,Ab}var Nb,o7;function uIe(){if(o7)return Nb;o7=1;var e=a5(),t=e["__core-js_shared__"];return Nb=t,Nb}var Rb,i7;function dIe(){if(i7)return Rb;i7=1;var e=uIe(),t=(function(){var r=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""})();function n(r){return!!t&&t in r}return Rb=n,Rb}var Db,l7;function fIe(){if(l7)return Db;l7=1;var e=Function.prototype,t=e.toString;function n(r){if(r!=null){try{return t.call(r)}catch{}try{return r+""}catch{}}return""}return Db=n,Db}var Ib,c7;function mIe(){if(c7)return Ib;c7=1;var e=cIe(),t=dIe(),n=YV(),r=fIe(),s=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,o=Function.prototype,i=Object.prototype,c=o.toString,u=i.hasOwnProperty,d=RegExp("^"+c.call(u).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function m(p){if(!n(p)||t(p))return!1;var h=e(p)?d:a;return h.test(r(p))}return Ib=m,Ib}var jb,u7;function pIe(){if(u7)return jb;u7=1;function e(t,n){return t?.[n]}return jb=e,jb}var Pb,d7;function QV(){if(d7)return Pb;d7=1;var e=mIe(),t=pIe();function n(r,s){var a=t(r,s);return e(a)?a:void 0}return Pb=n,Pb}var Ob,f7;function Ky(){if(f7)return Ob;f7=1;var e=QV(),t=e(Object,"create");return Ob=t,Ob}var Lb,m7;function hIe(){if(m7)return Lb;m7=1;var e=Ky();function t(){this.__data__=e?e(null):{},this.size=0}return Lb=t,Lb}var Fb,p7;function gIe(){if(p7)return Fb;p7=1;function e(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}return Fb=e,Fb}var Ub,h7;function yIe(){if(h7)return Ub;h7=1;var e=Ky(),t="__lodash_hash_undefined__",n=Object.prototype,r=n.hasOwnProperty;function s(a){var o=this.__data__;if(e){var i=o[a];return i===t?void 0:i}return r.call(o,a)?o[a]:void 0}return Ub=s,Ub}var Bb,g7;function xIe(){if(g7)return Bb;g7=1;var e=Ky(),t=Object.prototype,n=t.hasOwnProperty;function r(s){var a=this.__data__;return e?a[s]!==void 0:n.call(a,s)}return Bb=r,Bb}var Hb,y7;function bIe(){if(y7)return Hb;y7=1;var e=Ky(),t="__lodash_hash_undefined__";function n(r,s){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=e&&s===void 0?t:s,this}return Hb=n,Hb}var Vb,x7;function _Ie(){if(x7)return Vb;x7=1;var e=hIe(),t=gIe(),n=yIe(),r=xIe(),s=bIe();function a(o){var i=-1,c=o==null?0:o.length;for(this.clear();++i<c;){var u=o[i];this.set(u[0],u[1])}}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=n,a.prototype.has=r,a.prototype.set=s,Vb=a,Vb}var Gb,b7;function vIe(){if(b7)return Gb;b7=1;function e(){this.__data__=[],this.size=0}return Gb=e,Gb}var zb,_7;function CIe(){if(_7)return zb;_7=1;function e(t,n){return t===n||t!==t&&n!==n}return zb=e,zb}var qb,v7;function Yy(){if(v7)return qb;v7=1;var e=CIe();function t(n,r){for(var s=n.length;s--;)if(e(n[s][0],r))return s;return-1}return qb=t,qb}var $b,C7;function wIe(){if(C7)return $b;C7=1;var e=Yy(),t=Array.prototype,n=t.splice;function r(s){var a=this.__data__,o=e(a,s);if(o<0)return!1;var i=a.length-1;return o==i?a.pop():n.call(a,o,1),--this.size,!0}return $b=r,$b}var Wb,w7;function SIe(){if(w7)return Wb;w7=1;var e=Yy();function t(n){var r=this.__data__,s=e(r,n);return s<0?void 0:r[s][1]}return Wb=t,Wb}var Kb,S7;function EIe(){if(S7)return Kb;S7=1;var e=Yy();function t(n){return e(this.__data__,n)>-1}return Kb=t,Kb}var Yb,E7;function kIe(){if(E7)return Yb;E7=1;var e=Yy();function t(n,r){var s=this.__data__,a=e(s,n);return a<0?(++this.size,s.push([n,r])):s[a][1]=r,this}return Yb=t,Yb}var Qb,k7;function MIe(){if(k7)return Qb;k7=1;var e=vIe(),t=wIe(),n=SIe(),r=EIe(),s=kIe();function a(o){var i=-1,c=o==null?0:o.length;for(this.clear();++i<c;){var u=o[i];this.set(u[0],u[1])}}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=n,a.prototype.has=r,a.prototype.set=s,Qb=a,Qb}var Xb,M7;function TIe(){if(M7)return Xb;M7=1;var e=QV(),t=a5(),n=e(t,"Map");return Xb=n,Xb}var Zb,T7;function AIe(){if(T7)return Zb;T7=1;var e=_Ie(),t=MIe(),n=TIe();function r(){this.size=0,this.__data__={hash:new e,map:new(n||t),string:new e}}return Zb=r,Zb}var Jb,A7;function NIe(){if(A7)return Jb;A7=1;function e(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}return Jb=e,Jb}var e2,N7;function Qy(){if(N7)return e2;N7=1;var e=NIe();function t(n,r){var s=n.__data__;return e(r)?s[typeof r=="string"?"string":"hash"]:s.map}return e2=t,e2}var t2,R7;function RIe(){if(R7)return t2;R7=1;var e=Qy();function t(n){var r=e(this,n).delete(n);return this.size-=r?1:0,r}return t2=t,t2}var n2,D7;function DIe(){if(D7)return n2;D7=1;var e=Qy();function t(n){return e(this,n).get(n)}return n2=t,n2}var r2,I7;function IIe(){if(I7)return r2;I7=1;var e=Qy();function t(n){return e(this,n).has(n)}return r2=t,r2}var s2,j7;function jIe(){if(j7)return s2;j7=1;var e=Qy();function t(n,r){var s=e(this,n),a=s.size;return s.set(n,r),this.size+=s.size==a?0:1,this}return s2=t,s2}var a2,P7;function PIe(){if(P7)return a2;P7=1;var e=AIe(),t=RIe(),n=DIe(),r=IIe(),s=jIe();function a(o){var i=-1,c=o==null?0:o.length;for(this.clear();++i<c;){var u=o[i];this.set(u[0],u[1])}}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=n,a.prototype.has=r,a.prototype.set=s,a2=a,a2}var o2,O7;function OIe(){if(O7)return o2;O7=1;var e=PIe(),t="Expected a function";function n(r,s){if(typeof r!="function"||s!=null&&typeof s!="function")throw new TypeError(t);var a=function(){var o=arguments,i=s?s.apply(this,o):o[0],c=a.cache;if(c.has(i))return c.get(i);var u=r.apply(this,o);return a.cache=c.set(i,u)||c,u};return a.cache=new(n.Cache||e),a}return n.Cache=e,o2=n,o2}var LIe=OIe();const FIe=ha(LIe);var L7="__react_svg_text_measurement_id";function UIe(e,t){try{var n=document.getElementById(L7);if(!n){var r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("aria-hidden","true"),r.style.width="0",r.style.height="0",r.style.position="absolute",r.style.top="-100%",r.style.left="-100%",n=document.createElementNS("http://www.w3.org/2000/svg","text"),n.setAttribute("id",L7),r.appendChild(n),document.body.appendChild(r)}return Object.assign(n.style,t),n.textContent=e,n.getComputedTextLength()}catch{return null}}const nC=FIe(UIe,function(e,t){return e+"_"+JSON.stringify(t)});var BIe=["verticalAnchor","scaleToFit","angle","width","lineHeight","capHeight","children","style"];function HIe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}function i2(e){return typeof e=="number"}function F7(e){return typeof e=="number"&&Number.isFinite(e)||typeof e=="string"}function XV(e){var t=e.verticalAnchor,n=t===void 0?"end":t,r=e.scaleToFit,s=r===void 0?!1:r,a=e.angle,o=e.width,i=e.lineHeight,c=i===void 0?"1em":i,u=e.capHeight,d=u===void 0?"0.71em":u,m=e.children,p=e.style,h=HIe(e,BIe),g=h.x,y=g===void 0?0:g,b=h.y,x=b===void 0?0:b,_=!F7(y)||!F7(x),v=f.useMemo(function(){var k=m==null?[]:m.toString().split(/(?:(?!\u00A0+)\s+)/);return{wordsWithWidth:k.map(function(M){return{word:M,wordWidth:nC(M,p)||0}}),spaceWidth:nC("",p)||0}},[m,p]),C=v.wordsWithWidth,w=v.spaceWidth,S=f.useMemo(function(){return _?[]:o||s?C.reduce(function(k,M){var N=M.word,P=M.wordWidth,O=k[k.length-1];if(O&&(o==null||s||(O.width||0)+P+w<o))O.words.push(N),O.width=O.width||0,O.width+=P+w;else{var L={words:[N],width:P};k.push(L)}return k},[]):[{words:m==null?[]:m.toString().split(/(?:(?!\u00A0+)\s+)/)}]},[_,o,s,m,C,w]),E=f.useMemo(function(){var k=_?"":vb(n==="start"?"calc("+d+")":n==="middle"?"calc("+(S.length-1)/2+" * -"+c+" + ("+d+" / 2))":"calc("+(S.length-1)+" * -"+c+")");return k},[_,n,d,S.length,c]),T=f.useMemo(function(){var k=[];if(_)return"";if(i2(y)&&i2(x)&&i2(o)&&s&&S.length>0){var M=S[0].width||1,N=s==="shrink-only"?Math.min(o/M,1):o/M,P=N,O=y-N*y,L=x-P*x;k.push("matrix("+N+", 0, 0, "+P+", "+O+", "+L+")")}return a&&k.push("rotate("+a+", "+y+", "+x+")"),k.length>0?k.join(" "):""},[_,y,x,o,s,S,a]);return{wordsByLines:S,startDy:E,transform:T}}var VIe=["dx","dy","textAnchor","innerRef","innerTextRef","verticalAnchor","angle","lineHeight","scaleToFit","capHeight","width"];function rC(){return rC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rC.apply(null,arguments)}function GIe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}var zIe={overflow:"visible"};function Xy(e){var t=e.dx,n=t===void 0?0:t,r=e.dy,s=r===void 0?0:r,a=e.textAnchor,o=a===void 0?"start":a,i=e.innerRef,c=e.innerTextRef;e.verticalAnchor,e.angle;var u=e.lineHeight,d=u===void 0?"1em":u;e.scaleToFit,e.capHeight,e.width;var m=GIe(e,VIe),p=m.x,h=p===void 0?0:p,g=m.fontSize,y=XV(e),b=y.wordsByLines,x=y.startDy,_=y.transform;return A.createElement("svg",{ref:i,x:n,y:s,fontSize:g,style:zIe},b.length>0?A.createElement("text",rC({ref:c,transform:_},m,{textAnchor:o}),b.map(function(v,C){return A.createElement("tspan",{key:C,x:h,dy:C===0?x:d},v.words.join(" "))})):null)}const qIe=Object.freeze(Object.defineProperty({__proto__:null,Text:Xy,getStringWidth:nC,useText:XV},Symbol.toStringTag,{value:"Module"}));var us={top:"top",left:"left",bottom:"bottom"};function $Ie(e){var t=e.labelOffset,n=e.labelProps,r=e.orientation,s=e.range,a=e.tickLabelFontSize,o=e.tickLength,i=r===us.left||r===us.top?-1:1,c,u,d;if(r===us.top||r===us.bottom){var m=r===us.bottom&&typeof n.fontSize=="number"?n.fontSize:0;c=(Number(s[0])+Number(s[s.length-1]))/2,u=i*(o+t+a+m)}else c=i*((Number(s[0])+Number(s[s.length-1]))/2),u=-(o+t),d="rotate("+i*90+")";return{x:c,y:u,transform:d}}function ef(){return ef=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ef.apply(null,arguments)}function WIe(e){var t=e.hideTicks,n=e.horizontal,r=e.orientation,s=e.tickClassName,a=e.tickComponent,o=e.tickLabelProps,i=e.tickStroke,c=i===void 0?"#222":i,u=e.tickTransform,d=e.ticks,m=e.strokeWidth,p=e.tickLineProps;return d.map(function(h){var g,y=h.value,b=h.index,x=h.from,_=h.to,v=h.formattedValue,C=(g=o[b])!=null?g:{},w=Math.max(10,typeof C.fontSize=="number"&&C.fontSize||0),S=_.y+(n&&r!==us.top?w:0);return A.createElement(Ur,{key:"visx-tick-"+y+"-"+b,className:z("visx-axis-tick",s),transform:u},!t&&A.createElement($y,ef({from:x,to:_,stroke:c,strokeWidth:m,strokeLinecap:"square"},p)),a?a(ef({},C,{x:_.x,y:S,formattedValue:v})):A.createElement(Xy,ef({x:_.x,y:S},C),v))})}function tf(){return tf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tf.apply(null,arguments)}var U7={textAnchor:"middle",fontFamily:"Arial",fontSize:10,fill:"#222"};function KIe(e){var t=e.axisFromPoint,n=e.axisLineClassName,r=e.axisToPoint,s=e.hideAxisLine,a=e.hideTicks,o=e.horizontal,i=e.label,c=i===void 0?"":i,u=e.labelClassName,d=e.labelOffset,m=d===void 0?14:d,p=e.labelProps,h=e.orientation,g=h===void 0?us.bottom:h,y=e.scale,b=e.stroke,x=b===void 0?"#222":b,_=e.strokeDasharray,v=e.strokeWidth,C=v===void 0?1:v,w=e.tickClassName,S=e.tickComponent,E=e.tickLineProps,T=e.tickLabelProps,k=e.tickLength,M=k===void 0?8:k,N=e.tickStroke,P=N===void 0?"#222":N,O=e.tickTransform,L=e.ticks,H=e.ticksComponent,R=H===void 0?WIe:H,I=tf({},U7,p),F=tf({},U7,typeof T=="object"?T:null),G=L.map(function($){var q=$.value,U=$.index;return typeof T=="function"?T(q,U,L):F}),j=Math.max.apply(Math,[10].concat(G.map(function($){return typeof $.fontSize=="number"?$.fontSize:0})));return A.createElement(A.Fragment,null,R({hideTicks:a,horizontal:o,orientation:g,scale:y,tickClassName:w,tickComponent:S,tickLabelProps:G,tickStroke:P,tickTransform:O,ticks:L,strokeWidth:C,tickLineProps:E}),!s&&A.createElement($y,{className:z("visx-axis-line",n),from:t,to:r,stroke:x,strokeWidth:C,strokeDasharray:_}),c&&A.createElement(Xy,tf({className:z("visx-axis-label",u)},$Ie({labelOffset:m,labelProps:I,orientation:g,range:y.range(),tickLabelFontSize:j,tickLength:M}),I),c))}function YIe(e,t){t===void 0&&(t="center");var n=e;if(t!=="start"&&"bandwidth"in n){var r=n.bandwidth();return t==="center"&&(r/=2),n.round()&&(r=Math.round(r)),function(s){var a=n(s);return typeof a=="number"?a+r:a}}return e}function QIe(e){var t=e;return"tickFormat"in t?t.tickFormat():wV}var Xa=(function(){function e(n){var r=n.x,s=r===void 0?0:r,a=n.y,o=a===void 0?0:a;this.x=0,this.y=0,this.x=s,this.y=o}var t=e.prototype;return t.value=function(){return{x:this.x,y:this.y}},t.toArray=function(){return[this.x,this.y]},e})();function XIe(e,t){return new Xa({x:e.x+t.x,y:e.y+t.y})}function ZIe(e,t){return new Xa({x:e.x-t.x,y:e.y-t.y})}const JIe=Object.freeze(Object.defineProperty({__proto__:null,Point:Xa,subtractPoints:ZIe,sumPoints:XIe},Symbol.toStringTag,{value:"Module"}));function Pp(e,t){var n=e.x,r=e.y;return new Xa(t?{x:n,y:r}:{x:r,y:n})}function sC(){return sC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sC.apply(null,arguments)}var l2=0;function eje(e){return e===void 0&&(e=l2),typeof e=="number"?{start:e,end:e}:sC({start:l2,end:l2},e)}var tje=["children","axisClassName","hideAxisLine","hideTicks","hideZero","innerRef","left","numTicks","orientation","rangePadding","scale","tickFormat","tickLength","tickValues","top"];function aC(){return aC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},aC.apply(null,arguments)}function nje(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}function _i(e){var t=e.children,n=t===void 0?KIe:t,r=e.axisClassName,s=e.hideAxisLine,a=s===void 0?!1:s,o=e.hideTicks,i=o===void 0?!1:o,c=e.hideZero,u=c===void 0?!1:c,d=e.innerRef,m=e.left,p=m===void 0?0:m,h=e.numTicks,g=h===void 0?10:h,y=e.orientation,b=y===void 0?us.bottom:y,x=e.rangePadding,_=x===void 0?0:x,v=e.scale,C=e.tickFormat,w=e.tickLength,S=w===void 0?8:w,E=e.tickValues,T=e.top,k=T===void 0?0:T,M=nje(e,tje),N=C??QIe(v),P=b===us.left,O=b===us.top,L=O||b===us.bottom,H=YIe(v),R=P||O?-1:1,I=v.range(),F=eje(_),G=Pp({x:Number(I[0])+.5-F.start,y:0},L),j=Pp({x:Number(I[I.length-1])+.5+F.end,y:0},L),$=(E??Vy(v,g)).filter(function(U){return!u||U!==0&&U!=="0"}).map(function(U,X){return{value:U,index:X}}),q=$.map(function(U){var X=U.value,J=U.index,ne=Om(H(X));return{value:X,index:J,from:Pp({x:ne,y:0},L),to:Pp({x:ne,y:S*R},L),formattedValue:N(X,J,$)}});return A.createElement(Ur,{className:z("visx-axis",r),innerRef:d,top:k,left:p},n(aC({},M,{axisFromPoint:G,axisToPoint:j,hideAxisLine:a,hideTicks:i,hideZero:u,horizontal:L,numTicks:g,orientation:b,rangePadding:_,scale:v,tickFormat:N,tickLength:S,tickPosition:H,tickSign:R,ticks:q})))}var Op={},B7;function ZV(){if(B7)return Op;B7=1,Op.__esModule=!0,Op.default=o;var e=r(Uf()),t=r(Bf()),n=["from","to","fill","className","innerRef"];function r(i){return i&&i.__esModule?i:{default:i}}function s(){return s=Object.assign?Object.assign.bind():function(i){for(var c=1;c<arguments.length;c++){var u=arguments[c];for(var d in u)Object.prototype.hasOwnProperty.call(u,d)&&(i[d]=u[d])}return i},s.apply(this,arguments)}function a(i,c){if(i==null)return{};var u={},d=Object.keys(i),m,p;for(p=0;p<d.length;p++)m=d[p],!(c.indexOf(m)>=0)&&(u[m]=i[m]);return u}function o(i){var c=i.from,u=c===void 0?{x:0,y:0}:c,d=i.to,m=d===void 0?{x:1,y:1}:d,p=i.fill,h=p===void 0?"transparent":p,g=i.className,y=i.innerRef,b=a(i,n),x=u.x===m.x||u.y===m.y;return e.default.createElement("line",s({ref:y,className:(0,t.default)("visx-line",g),x1:u.x,y1:u.y,x2:m.x,y2:m.y,fill:h,shapeRendering:x?"crispEdges":"auto"},b))}return Op}var rje=ZV();const JV=ha(rje);function eG(e){return"bandwidth"in e?e.bandwidth():0}var sje=["top","left","scale","width","stroke","strokeWidth","strokeDasharray","className","children","numTicks","lineStyle","offset","tickValues"];function oC(){return oC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oC.apply(this,arguments)}function aje(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function ql(e){var t=e.top,n=t===void 0?0:t,r=e.left,s=r===void 0?0:r,a=e.scale,o=e.width,i=e.stroke,c=i===void 0?"#eaf0f6":i,u=e.strokeWidth,d=u===void 0?1:u,m=e.strokeDasharray,p=e.className,h=e.children,g=e.numTicks,y=g===void 0?10:g,b=e.lineStyle,x=e.offset,_=e.tickValues,v=aje(e,sje),C=_??Vy(a,y),w=(x??0)+eG(a)/2,S=C.map(function(E,T){var k,M=((k=Om(a(E)))!=null?k:0)+w;return{index:T,from:new Xa({x:0,y:M}),to:new Xa({x:o,y:M})}});return A.createElement(Ur,{className:z("visx-rows",p),top:n,left:s},h?h({lines:S}):S.map(function(E){var T=E.from,k=E.to,M=E.index;return A.createElement(JV,oC({key:"row-line-"+M,from:T,to:k,stroke:c,strokeWidth:d,strokeDasharray:m,style:b},v))}))}ql.propTypes={tickValues:Je.array,width:Je.number.isRequired};var oje=["top","left","scale","height","stroke","strokeWidth","strokeDasharray","className","numTicks","lineStyle","offset","tickValues","children"];function iC(){return iC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},iC.apply(this,arguments)}function ije(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function Zy(e){var t=e.top,n=t===void 0?0:t,r=e.left,s=r===void 0?0:r,a=e.scale,o=e.height,i=e.stroke,c=i===void 0?"#eaf0f6":i,u=e.strokeWidth,d=u===void 0?1:u,m=e.strokeDasharray,p=e.className,h=e.numTicks,g=h===void 0?10:h,y=e.lineStyle,b=e.offset,x=e.tickValues,_=e.children,v=ije(e,oje),C=x??Vy(a,g),w=(b??0)+eG(a)/2,S=C.map(function(E,T){var k,M=((k=Om(a(E)))!=null?k:0)+w;return{index:T,from:new Xa({x:M,y:0}),to:new Xa({x:M,y:o})}});return A.createElement(Ur,{className:z("visx-columns",p),top:n,left:s},_?_({lines:S}):S.map(function(E){var T=E.from,k=E.to,M=E.index;return A.createElement(JV,iC({key:"column-line-"+M,from:T,to:k,stroke:c,strokeWidth:d,strokeDasharray:m,style:y},v))}))}Zy.propTypes={tickValues:Je.array,height:Je.number.isRequired};const os=e=>e,lje=(e,t,n,r)=>`M${e},${t}h${n}v${r}h${-n}Z`,cje=(e,t,n)=>`M${e},${t}L${e},${n}`,uje=(e,t,n)=>`M${e},${t}L${n},${t}`,dje=({xScale:e,yScale:t,history:n})=>{const r=f.useMemo(()=>{if(n.length<2)return 4;let o=1/0;for(let i=0;i<n.length-1;i++){const c=e(pn(n[i]))??0,u=e(pn(n[i+1]))??0,d=Math.abs(u-c);o=Math.min(o,d)}return Math.max(.1,Math.min(o*.6,10))},[n,e]),s=f.useMemo(()=>{const o={blue:{wicks:[],bodies:[],dojis:[]},red:{wicks:[],bodies:[],dojis:[]},wickStrokeWidth:os(Math.max(.1,Math.min(r,1))),dojiStrokeWidth:os(Math.max(.5,Math.min(r*.3,1.5)))};return n.forEach(i=>{const c=os(e(pn(i))??0),u=os(t(i.high)??0),d=os(t(i.low)??0),m=os(t(i.open)??0),p=os(t(i.close)??0),h=i.close>=i.open?"blue":"red",g=o[h];g.wicks.push(cje(c,u,d));const y=os(Math.abs(p-m));y<1?g.dojis.push(uje(os(c-r/2),p,os(c+r/2))):g.bodies.push(lje(os(c-r/2),os(Math.min(m,p)),os(r),y))}),o},[n,e,t,r]),a=(o,i)=>{const c=Pn[o];return l.jsxs(l.Fragment,{children:[i.wicks.length&&l.jsx("path",{d:i.wicks.join(""),stroke:c,strokeWidth:s.wickStrokeWidth,opacity:.5,fill:"none"}),i.bodies.length&&l.jsx("path",{d:i.bodies.join(""),fill:c}),i.dojis.length&&l.jsx("path",{d:i.dojis.join(""),stroke:c,strokeWidth:s.dojiStrokeWidth,fill:"none"})]})};return l.jsxs("svg",{children:[a("blue",s.blue),a("red",s.red)]})},Lm=200,fje={top:24,right:8,bottom:24,left:16},mje="#1FB8CD",pje="#B4413C",hje=[mje,"#FFC185",pje,"#ECEBD5","#5D878F","#DB4545","#D2BA4C","#964325"],gje="#20808D",yje="#A84B2F",xje=[gje,yje,"#1B474D","#BCE2E7","#944454","#FFC553","#848456","#6E522B"],bje={tickColor:"#2F3031",axisColor:"#2F3031",textColor:"#aaaaaa",colorSchema:hje},_je={tickColor:"#D9D9D0",axisColor:"#D9D9D0",textColor:"#A0A0A0",colorSchema:xje},vje={time:e=>new Date(e),linear:e=>+e,band:e=>e,ordinal:e=>e,log:e=>+e,point:e=>e};function c2(e,t){if(!e)return r=>null;if(t===void 0)return r=>r[e];const n=vje[t]||(r=>r);return r=>n(r[e])}function ic(e,t){return typeof t=="function"?t(e):typeof t=="string"?t.replace("%s",e):e instanceof Date?ASe(e):String(e)}const ps={time:Hu,linear:So,band:e5,log:t5,point:Pm,ordinal:r5},H7=["band","ordinal","point"];function Cje({width:e,height:t,margin:n,hasAxis:r,maxYLabelWidth:s=0}){const a=n.left+(r?s+15:0),o=e-n.right-n.left,i=t-n.bottom,c=n.top,u=[a,o],d=[i,c],m=Math.max(0,o-a);return{innerHeight:Math.max(0,i-c),innerWidth:m,xRange:u,yRange:d}}function Jy(e){const{colorScheme:t}=Cs(),n=ro(),r=f.useMemo(()=>n?t==="dark":!1,[t,n]);return f.useMemo(()=>({...r?bje:_je,...e}),[r,e])}function ex(e){return f.useMemo(()=>e.data.map(n=>({__key:Math.random(),...n})),[e.data])}function tx({config:e}){const t=f.useMemo(()=>c2(e.x.accessor,e.x.scale),[e.x]),n=f.useMemo(()=>c2(e.y.accessor,e.y.scale),[e.y]),r=f.useMemo(()=>c2(e.z?.accessor,e.z?.scale),[e.z]);return f.useMemo(()=>({xGet:t,yGet:n,zGet:r}),[t,n,r])}function nx({config:e}){const t=f.useCallback(i=>ic(i,e.x.format),[e.x]),n=f.useCallback(i=>ic(i,e.y.format),[e.y]),r=f.useCallback(i=>ic(i,e.z?.format),[e.z]),s=f.useCallback(i=>ic(i,e.x.tooltipFormat??e.x.format),[e.x]),a=f.useCallback(i=>ic(i,e.y.tooltipFormat??e.y.format),[e.y]),o=f.useCallback(i=>ic(i,e.z?.tooltipFormat??e.z?.format),[e.z]);return f.useMemo(()=>({xFormat:t,yFormat:n,zFormat:r,xTooltipFormat:s,yTooltipFormat:a,zTooltipFormat:o}),[t,n,r,s,a,o])}function rx({width:e,height:t,margin:n,maxYLabelWidth:r,hasAxis:s}){return f.useMemo(()=>Cje({width:e,height:t,margin:n,maxYLabelWidth:r,hasAxis:s}),[e,t,n,r,s])}function o5({config:e,xGet:t,yGet:n,data:r,endTime:s,previousClose:a}){const o=f.useMemo(()=>{if(H7.includes(e.x.scale))return[...new Set(r.map(t))];const u=Os(r,t);return e.x.tickValues?Os([...e.x.tickValues,...u]):u},[e.x.tickValues,e.x.scale,r,t]),i=f.useMemo(()=>{if(H7.includes(e.y.scale))return[...new Set(r.map(n))];const d=[...Os(r,n)];a!==void 0&&d.push(a),e.y.tickValues&&d.push(...e.y.tickValues);const[m,p]=Os(d),g=(p-m)*.05;return[m-g,p+g]},[e.y.tickValues,e.y.scale,r,n,a]),c=f.useMemo(()=>{if(!s||!o||o.length<2||e.x.scale!=="time")return o;const[u,d]=o;return new Date(d).toDateString()!==s.toDateString()?o:Date.now()<s.getTime()&&d<s?[u,s]:o},[o,s,e.x.scale]);return f.useMemo(()=>({xDomain:c,yDomain:i}),[c,i])}function tG(e){const[t,n]=f.useState({width:0,height:0,resizing:!1});return f.useEffect(()=>{let r;const s=()=>{e.current&&(clearTimeout(r),n(a=>{const o=e.current?.offsetWidth??0,i=e.current?.offsetHeight??0,c=Math.round(a.width)!==Math.round(o);return{width:o,height:i,resizing:c}}),r=setTimeout(()=>{n(a=>({...a,resizing:!1}))},500))};return s(),window.addEventListener("resize",s),()=>{clearTimeout(r),window.removeEventListener("resize",s)}},[e]),t}const Ir=30,Ic=28,i5=({render:e,height:t=Lm,children:n})=>{const r=f.useRef(null),{width:s}=tG(r);return l.jsx("div",{style:{width:"100%",height:t},ref:r,className:"relative",children:l.jsx(Wt,{children:e&&l.jsx(ze.div,{className:"absolute",children:n(s,t)})})})},wje=({children:e,style:t})=>l.jsx(Y,{className:"p-sm pb-md flex h-full",children:l.jsx(Y,{className:"flex size-full items-center justify-center",variant:"raised",style:t,children:l.jsx(B,{variant:"small",color:"light",children:e})})}),nG=({children:e})=>l.jsx(wje,{style:{height:Lm,marginBottom:Ir},children:e}),rG=()=>l.jsx(nG,{children:l.jsx(be,{id:"iuY8kxCDQT",defaultMessage:"Something went wrong."})});function Sje(e){return!!e&&e instanceof Element}function Eje(e){return!!e&&(e instanceof SVGElement||"ownerSVGElement"in e)}function kje(e){return!!e&&"createSVGPoint"in e}function Mje(e){return!!e&&"getScreenCTM"in e}function Tje(e){return!!e&&"changedTouches"in e}function Aje(e){return!!e&&"clientX"in e}function Nje(e){return!!e&&(e instanceof Event||"nativeEvent"in e&&e.nativeEvent instanceof Event)}function nf(){return nf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nf.apply(this,arguments)}var u2={x:0,y:0};function Rje(e){if(!e)return nf({},u2);if(Tje(e))return e.changedTouches.length>0?{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}:nf({},u2);if(Aje(e))return{x:e.clientX,y:e.clientY};var t=e?.target,n=t&&"getBoundingClientRect"in t?t.getBoundingClientRect():null;return n?{x:n.x+n.width/2,y:n.y+n.height/2}:nf({},u2)}function V7(e,t){if(!e||!t)return null;var n=Rje(t),r=Eje(e)?e.ownerSVGElement:e,s=Mje(r)?r.getScreenCTM():null;if(kje(r)&&s){var a=r.createSVGPoint();return a.x=n.x,a.y=n.y,a=a.matrixTransform(s.inverse()),new Xa({x:a.x,y:a.y})}var o=e.getBoundingClientRect();return new Xa({x:n.x-o.left-e.clientLeft,y:n.y-o.top-e.clientTop})}function Fm(e,t){if(Sje(e)&&t)return V7(e,t);if(Nje(e)){var n=e,r=n.target;if(r)return V7(r,n)}return null}var Dje=["tooltipOpen"];function Ije(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}function Ig(){return Ig=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ig.apply(null,arguments)}function sx(e){var t=f.useState(Ig({tooltipOpen:!1},e)),n=t[0],r=t[1],s=f.useCallback(function(o){return r(typeof o=="function"?function(i){i.tooltipOpen;var c=Ije(i,Dje);return Ig({},o(c),{tooltipOpen:!0})}:{tooltipOpen:!0,tooltipLeft:o.tooltipLeft,tooltipTop:o.tooltipTop,tooltipData:o.tooltipData})},[r]),a=f.useCallback(function(){return r({tooltipOpen:!1,tooltipLeft:void 0,tooltipTop:void 0,tooltipData:void 0})},[r]);return{tooltipOpen:n.tooltipOpen,tooltipLeft:n.tooltipLeft,tooltipTop:n.tooltipTop,tooltipData:n.tooltipData,updateTooltip:r,showTooltip:s,hideTooltip:a}}var jje=["className","top","left","offsetLeft","offsetTop","style","children","unstyled","applyPositionStyle"];function jg(){return jg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jg.apply(null,arguments)}function Pje(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}var sG={position:"absolute",backgroundColor:"white",color:"#666666",padding:".3rem .5rem",borderRadius:"3px",fontSize:"14px",boxShadow:"0 1px 2px rgba(33,33,33,0.2)",lineHeight:"1em",pointerEvents:"none"},l5=A.forwardRef(function(e,t){var n=e.className,r=e.top,s=e.left,a=e.offsetLeft,o=a===void 0?10:a,i=e.offsetTop,c=i===void 0?10:i,u=e.style,d=u===void 0?sG:u,m=e.children,p=e.unstyled,h=p===void 0?!1:p,g=e.applyPositionStyle,y=g===void 0?!1:g,b=Pje(e,jje);return A.createElement("div",jg({ref:t,className:z("visx-tooltip",n),style:jg({top:r==null||c==null?r:r+c,left:s==null||o==null?s:s+o},y&&{position:"absolute"},!h&&d)},b),m)});l5.propTypes={children:Je.node,className:Je.string,left:Je.number,offsetLeft:Je.number,offsetTop:Je.number,top:Je.number,applyPositionStyle:Je.bool,unstyled:Je.bool};l5.displayName="Tooltip";function lC(){return lC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lC.apply(null,arguments)}function Oje(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,cC(e,t)}function cC(e,t){return cC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},cC(e,t)}var G7={top:0,right:0,bottom:0,left:0,width:0,height:0};function Lje(e){var t;return t=(function(n){function r(a){var o;return o=n.call(this,a)||this,o.state={rect:void 0,parentRect:void 0},o.nodeRef=A.createRef(),o.getRects=o.getRects.bind(o),o}Oje(r,n);var s=r.prototype;return s.componentDidMount=function(){var o,i=this;this.node=(o=this.nodeRef)!=null&&o.current?this.nodeRef.current:wq.findDOMNode(this),this.setState(function(){return i.getRects()})},s.getRects=function(){if(!this.node)return this.state;var o=this.node,i=o.parentNode,c=o.getBoundingClientRect?o.getBoundingClientRect():G7,u=i!=null&&i.getBoundingClientRect?i.getBoundingClientRect():G7;return{rect:c,parentRect:u}},s.render=function(){return A.createElement(e,lC({nodeRef:this.nodeRef,getRects:this.getRects},this.state,this.props))},r})(A.PureComponent),t.displayName="withBoundingRects("+(e.displayName||"")+")",t}var aG=f.createContext({isFlippedVertically:!1,isFlippedHorizontally:!1}),Fje=aG.Provider;aG.Consumer;var Uje=["children","getRects","left","offsetLeft","offsetTop","parentRect","rect","style","top","unstyled","nodeRef"];function Pg(){return Pg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Pg.apply(null,arguments)}function Bje(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}function oG(e){var t=e.children;e.getRects;var n=e.left,r=n===void 0?0:n,s=e.offsetLeft,a=s===void 0?10:s,o=e.offsetTop,i=o===void 0?10:o,c=e.parentRect,u=e.rect,d=e.style,m=d===void 0?sG:d,p=e.top,h=p===void 0?0:p,g=e.unstyled,y=g===void 0?!1:g,b=e.nodeRef,x=Bje(e,Uje),_,v=!1,C=!1;if(u&&c){var w=r,S=h;if(c.width){var E=w+a+u.width-c.width,T=u.width-w-a;v=E>0&&E>T}else{var k=w+a+u.width-window.innerWidth,M=u.width-w-a;v=k>0&&k>M}if(c.height){var N=S+i+u.height-c.height,P=u.height-S-i;C=N>0&&N>P}else C=S+i+u.height>window.innerHeight;w=v?w-u.width-a:w+a,S=C?S-u.height-i:S+i,w=Math.round(w),S=Math.round(S),_="translate("+w+"px, "+S+"px)"}return A.createElement(l5,Pg({ref:b,style:Pg({left:0,top:0,transform:_},!y&&m)},x),A.createElement(Fje,{value:{isFlippedVertically:!C,isFlippedHorizontally:!v}},t))}oG.propTypes={nodeRef:Je.oneOfType([Je.string,Je.func,Je.object])};const iG=Lje(oG),Hje="shadow-subtle transition-colors duration-500",c5=f.memo(function({marginTop:t,tooltipLeft:n=0,innerHeight:r,color:s,strokeWidth:a=1}){const o=f.useMemo(()=>({x:n,y:t}),[t,n]),i=f.useMemo(()=>({x:n,y:r+t}),[r,t,n]);return isNaN(o.x+i.x+o.y+i.y)?null:l.jsx("line",{x1:o.x,y1:o.y,x2:i.x,y2:i.y,stroke:s,strokeWidth:a,pointerEvents:"none",className:Hje})}),Vje={pointerEvents:"none",position:"absolute",overflow:"visible",zIndex:3},ax=({children:e,y:t,x:n,pill:r})=>l.jsx(iG,{left:n,top:t,style:Vje,children:l.jsx("div",{className:z("shadow-subtle relative border bg-base/75 backdrop-blur-sm overflow-hidden",{"rounded-full":r,"rounded-lg":!r}),children:e})}),Gje=({exchangeHoursAnnotations:e,data:t,xScale:n,xBounds:r,hidden:s,tzOffsetMins:a})=>{const{$t:o}=Q(),{tooltipData:i,hideTooltip:c,showTooltip:u}=sx(),d=f.useRef(null),m=f.useRef(s),p=f.useCallback((y,b)=>{const{d:x,x:_}=L3(y.local.x,n,t);if(!x)return;const v=P3(e,new Date(x.date),a),C=v?.type&&c6[v.type]?o(c6[v.type]):void 0,w=Math.min(Math.max(r[0],_),r[1]);u({tooltipData:{data:x,point:{touch:b,local:{x:w,y:y.local.y},global:y.global},annotation:C}})},[t,n,u,e,o,r,a]);m.current&&!s&&d.current&&p(d.current,!1),m.current=s;const h=f.useCallback(y=>{const b="touches"in y;y.stopPropagation();const x=Fm(y),_=N3(y);if(!x)return;const v={local:x,global:_};d.current=v,p(v,b)},[p]),g=f.useCallback(()=>{d.current=null,c()},[c]);return f.useMemo(()=>({tooltipData:s?void 0:i,hideTooltip:g,showTooltip:h}),[i,g,h,s])},lG=({currency:e,absoluteChange:t,relativeChange:n})=>{const{locale:r}=Q(),s=f.useMemo(()=>t===void 0?null:el(t,e,r),[t,e,r]),a=f.useMemo(()=>n===void 0?null:n.toLocaleString(r,{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2,signDisplay:"exceptZero"}),[n,r]),o=f.useMemo(()=>t?t>0?"positive":"negative":"light",[t]);return!t&&!n?null:l.jsx(Y,{className:"relative border-t",children:l.jsx(B,{variant:"tinyRegular",color:o,className:"px-sm py-xs whitespace-nowrap",children:l.jsx(be,{id:"TqEJGQaMg0",defaultMessage:"{absoluteChange} ({relativeChange})",values:{absoluteChange:s,relativeChange:a}})})})},zje=({x:e,y:t,close:n,date:r,annotation:s,absoluteChange:a,relativeChange:o,currency:i,exchangeTimezone:c})=>{const{locale:u}=Q();return l.jsxs(ax,{y:t,x:e,children:[l.jsxs(Y,{className:"py-sm relative px-[12px]",children:[l.jsx(B,{variant:"baseSemi",children:el(n,i,u)}),l.jsx(B,{variant:"tinyRegular",className:"whitespace-nowrap",color:"light",children:O3(r,u,c)}),l.jsx(B,{variant:"tinyRegular",color:"light",className:"whitespace-nowrap",children:s})]}),l.jsx(lG,{currency:i,absoluteChange:a,relativeChange:o})]})},_d=({label:e,children:t})=>l.jsxs(Y,{className:"gap-md flex justify-between",children:[l.jsx(B,{variant:"tinyRegular",color:"light",children:e}),l.jsx(B,{variant:"tinyRegular",className:"whitespace-nowrap",children:t})]}),qje=({currency:e,locale:t,exchangeTimezone:n,x:r,y:s,data:a,annotation:o,absoluteChange:i,relativeChange:c})=>{const{$t:u}=Q();return l.jsx(yu,{children:l.jsxs(ax,{y:s,x:r,children:[l.jsx(Y,{children:l.jsxs(Y,{className:"px-sm py-xs",variant:"subtle",children:[l.jsx(B,{variant:"tiny",className:"whitespace-nowrap",children:O3(a.date,t,n)}),o&&l.jsx(B,{variant:"micro",color:"light",className:"whitespace-nowrap",children:o})]})}),l.jsxs(Y,{className:"px-sm py-xs space-y-xs border-t",children:[l.jsx(_d,{label:u({defaultMessage:"Close",id:"rbrahOGMC3"}),children:el(a.close,e,t)}),l.jsx(_d,{label:u({defaultMessage:"Open",id:"JfG49wNHKP"}),children:el(a.open,e,t)}),l.jsx(_d,{label:u({defaultMessage:"High",id:"AxMhQrcUDC"}),children:el(a.high,e,t)}),l.jsx(_d,{label:u({defaultMessage:"Low",id:"477I0ggSYe"}),children:el(a.low,e,t)}),l.jsx(_d,{label:u({defaultMessage:"Volume",id:"y867VsgbzT"}),children:a.volume.toLocaleString(t,{style:"decimal",currency:e??void 0,minimumFractionDigits:0,maximumFractionDigits:0})})]}),l.jsx(lG,{currency:e,absoluteChange:i,relativeChange:c})]})})},$je=e=>e&&e<0?Pn.red:e&&e>0?Pn.blue:Pn.gray,z7=5,Wje=.002,q7=1,Kje=20,Yje=150,Lp={k:1,x:0},Qje=(e,t)=>(t-e.x)/e.k,cG=(e,t)=>{const r=t.range().map(s=>Qje(e,s)).map(s=>t.invert(s));return t.copy().domain(r)},uG=(e,t)=>{const r=t.range().map(s=>e.k*s+e.x);return t.copy().range(r)},dG=({enabled:e,width:t,id:n})=>{const[r,s]=f.useState(Lp),a=f.useRef(t);a.current=t;const[o,i]=f.useState(!1),c=f.useRef(null),u=f.useRef(null);f.useEffect(()=>{if(!e)return;const m=u.current;if(!m)return;const p=h=>{h.preventDefault(),h.stopPropagation();const g=Fm(m,h);if(!g)return;i(!0),c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{i(!1)},Yje);const y=Math.exp(-h.deltaY*Wje);s(b=>{const x=Math.max(q7,Math.min(Kje,b.k*y));if(x<=q7)return Lp;const _=g.x-(g.x-b.x)*(x/b.k),v=a.current*(1-x),C=Math.max(v,Math.min(0,_));return{k:x,x:C}})};return m.addEventListener("wheel",p,{passive:!1}),()=>{m.removeEventListener("wheel",p)}},[e]);const d=f.useCallback(()=>{s(Lp)},[]);return f.useEffect(()=>{s(Lp)},[n]),{transform:r,isActivelyZooming:o,containerRef:u,resetZoom:d}},Xje=({data:e,xScale:t,xGet:n,width:r})=>{const s=e.filter(c=>{const u=t(n(c));return u!==void 0&&u>=0&&u<=r});if(s.length<2)return{visibleData:s,visibleDays:BH(e)};const a=n(s[0]),i=(n(s[s.length-1]).getTime()-a.getTime())/(1e3*60*60*24);return{visibleData:s,visibleDays:i}},Zje=e=>{const t=e*.05;return Math.max(10,Math.min(t,100))},Um=(e,t,n)=>{const r=Zje(n),s=t(e);return s!==void 0&&s>=r&&s<=n-r},Jje=e=>{const t=e.match(/(\d{4})-(\d{2})-(\d{2})/);return t?t[0]:void 0},ePe=({history:e,xGet:t,width:n,xScale:r})=>{const s=[],a=new Set;return e.forEach(o=>{const i=t(o),c=i.getHours(),u=i.getMinutes(),m=[0,30].find(g=>u>=g-5&&u<=g+5);if(m===void 0)return;const h=`${`${i.getFullYear()}-${i.getMonth()}-${i.getDate()}`}-${c}-${m}`;if(!a.has(h)){const g=new Date(i);g.setMinutes(m,0,0),s.push({date:g,label:!0,line:Um(g,r,n)}),a.add(h)}}),s},tPe=({history:e,xGet:t,xGetUnparsed:n,width:r,xScale:s})=>{const a=[],o=new Set;return e.forEach(i=>{const c=t(i),u=Jje(n(i));u&&!o.has(u)&&(a.push({date:c,label:!0,line:Um(c,s,r)}),o.add(u))}),a};function nPe(e){const t=new Date(e.getFullYear(),e.getMonth(),1).getDay(),n=t===0?6:t-1;return Math.ceil((e.getDate()+n)/7)}const rPe=({history:e,xGet:t,width:n,xScale:r})=>{const s=[],a=new Set;return e.forEach(o=>{const i=t(o),c=i.getMonth(),u=nPe(i),d=`${c}-${u}`;a.has(d)||(s.push({date:i,label:!0,line:Um(i,r,n)}),a.add(d))}),s.filter((o,i,c)=>i?o.date.getTime()-c[i-1].date.getTime()>1e3*60*60*24*6:!0)},sPe=({history:e,xGet:t,width:n,xScale:r})=>{const s=[],a=new Set;return e.forEach(o=>{const i=t(o),c=i.getMonth(),d=`${i.getFullYear()}-${c}`;a.has(d)||(s.push({date:i,label:!0,line:Um(i,r,n)}),a.add(d))}),s},aPe=({history:e,xGet:t,width:n,xScale:r})=>{const s=[],a=new Set;return e.forEach(o=>{const i=t(o),c=i.getFullYear();a.has(c)||(s.push({date:i,label:!0,line:Um(i,r,n)}),a.add(c))}),s},oPe=e=>e<=1?ePe:e<=7?tPe:e<=45?rPe:e<=365?sPe:aPe,iPe=({ticks:e,maxTicks:t,xScale:n,width:r})=>{if(e.length<=t)return e;const s=r/(t*2),a=[];let o;for(const i of e){const c=n(i.date);c!==void 0&&(o===void 0||c-o>=s)&&(a.push(i),o=c)}return a},u5=(e,t)=>e.date.toLocaleDateString(e.locale,{timeZone:e.timezone??void 0,...t}),lPe=e=>{const t=e.date.getMinutes()!==0;return e.date.toLocaleTimeString(e.locale,{timeZone:e.timezone??void 0,hour:"numeric",minute:t?"numeric":void 0})},cPe=e=>lPe(e),uPe=e=>u5(e,{month:"short",day:"numeric"}),dPe=e=>u5(e,{month:"short"}),fPe=e=>u5(e,{year:"numeric"}),mPe=({days:e})=>e<=1?cPe:e<=62?uPe:e<=365?dPe:fPe,fG=({history:e,xGet:t,xGetUnparsed:n,timezone:r,locale:s,width:a,xScale:o})=>{const{visibleDays:i}=f.useMemo(()=>Xje({data:e,xScale:o,xGet:t,width:a}),[e,o,t,a]),c=f.useMemo(()=>mPe({days:i}),[i]),u=f.useMemo(()=>U3(e),[e]),d=f.useMemo(()=>{if(u)return;const b=oPe(i)({history:e,xGet:t,xGetUnparsed:n,locale:s,xScale:o,width:a});if(b)return iPe({ticks:b,maxTicks:z7,xScale:o,width:a})},[e,t,n,s,o,a,i,u]),m=f.useMemo(()=>{const y=d?.filter(x=>x.label).map(x=>x.date);if(!y?.length)return;const b=FH({ticks:y,xScale:o,width:a,formatter:x=>c({date:x,locale:s,timezone:r}),marginLeft:25,marginRight:70});return b.length?b:void 0},[d,o,a,c,s,r]),p=f.useMemo(()=>{const y=d?.filter(b=>b.line).map(b=>b.date);return y?.length?y:void 0},[d]),h=f.useCallback(y=>c({date:y,locale:s,timezone:r}),[c,s,r]);return{xTickLabels:m,xTickFormatter:h,xTickLines:p,xTickCount:m?void 0:z7}},pPe={US:"US"},hPe=Bt("FinanceIndexContext",{country:pPe.US,setCountry:()=>{},enabled:!1}),gPe=()=>{const e=f.useContext(hPe);if(!e)throw new Error("useFinanceCountry must be used within a FinanceCountryProvider");return e},yPe=e=>e===0?"":e>0?"+":"-",d5=e=>e===0?"light":e>0?"finance-positive":"finance-negative",xPe=e=>e?e==="tinyMono"||e==="smallMono"||e==="smallCaps":!1,ox=A.memo(function({change:t,variant:n="small",includeIcon:r=!1,className:s,background:a=!0,mono:o,hover:i=!1,format:c,suffix:u,animated:d,color:m}){const p=f.useMemo(()=>c||{style:"percent",minimumFractionDigits:2},[c]),h=o??xPe(n),g=m??d5(t);return l.jsxs(B,{as:"span",variant:n,color:g,className:z("transition-background-color flex shrink-0 grow-0 items-center justify-center gap-[0.1em] rounded text-center duration-200 ease-in-out",{"font-mono":h},{"bg-finance-positive/10":t>0&&a,"bg-finance-negative/10":t<0&&a,"bg-subtle":t===0&&a,"px-[0.6em] py-[0.15em]":a,"!pl-[0.3em]":a&&r,"!py-0 !pb-px":n==="micro","hover:bg-finance-positive/20 hover:text-finance-positive":i&&t>0&&a,"hover:bg-finance-negative/20 hover:text-finance-negative":i&&t<0&&a,"hover:bg-subtle":i&&t===0&&a},s),children:[l.jsx("span",{className:z("inline-flex",{"-mt-px":h}),children:r?l.jsx(ye,{icon:t===0?D("minus"):D("arrow-right"),className:z("inline-flex size-[1.2em] transition-transform duration-500 ease-in-out",{"!mt-px":h,"rotate-45":t<0,"-rotate-45":t>0})}):l.jsx("span",{className:h?"font-mono":"",children:yPe(t)})}),l.jsx("span",{className:z("whitespace-nowrap",{"font-mono":h}),children:l.jsx(w3,{value:Math.abs(t)/100,format:p,suffix:u,animated:d})})]})}),$7=(e,t)=>["finance-autosuggest",e,t],W7=async({query:e,reason:t,country:n})=>{try{const{data:r,error:s,response:a}=await ve.GET("/rest/autosuggest/finance/list-autosuggest",t,{params:{query:{query:e,country:n}},timeoutMs:0});if(s)throw new Ue("API_CLIENTS_ERROR",{cause:s,status:a.status??0});return r.results??_e}catch(r){return Z.error(r),[]}},bPe="recent-tickers:2",_Pe=5,vPe=e=>{if(typeof window>"u")return[];try{const t=yt.getItem(e);return t?JSON.parse(t):[]}catch{return[]}},K7=(e,t)=>{if(!(typeof window>"u"))try{yt.setItem(e,JSON.stringify(t))}catch{}},CPe=({storageKey:e,maxItems:t,getUniqueId:n})=>{const[r,s]=f.useState([]);f.useEffect(()=>{s(vPe(e))},[e]);const a=f.useCallback(i=>{s(c=>{const u=n(i),d=c.filter(p=>n(p)!==u),m=[i,...d].slice(0,t);return K7(e,m),m})},[e,t,n]),o=f.useCallback(()=>{s([]),K7(e,[])},[e]);return f.useMemo(()=>({recentItems:r,addRecentItem:a,clearRecentItems:o}),[r,a,o])},f5=()=>{const{recentItems:e,addRecentItem:t,clearRecentItems:n}=CPe({storageKey:bPe,maxItems:_Pe,getUniqueId:r=>r.symbol});return{recentTickers:e,addRecentTicker:t,clearRecentTickers:n}},m5=({isOpen:e,onClose:t,refs:n})=>{f.useEffect(()=>{if(!e)return;const r=a=>{n.some(i=>i.current?.contains(a.target))||t()},s=a=>{a.key==="Escape"&&t()};return document.addEventListener("mousedown",r,!0),document.addEventListener("keydown",s,!0),()=>{document.removeEventListener("mousedown",r,!0),document.removeEventListener("keydown",s,!0)}},[e,t,n])},wPe=({value:e,isFocused:t,defaultSuggestions:n=_e,reason:r})=>{const{country:s}=gPe(),a=It(),{data:o,isLoading:i}=gt({queryKey:$7(e,s),queryFn:()=>W7({query:e,reason:r,country:s}),staleTime:0,enabled:t}),c=f.useMemo(()=>n?.length&&e===""?"suggestions":o?.length&&e===""?"trending":"search",[n,e,o?.length]),{$t:u}=Q(),d=f.useMemo(()=>{if(c==="suggestions")return u({defaultMessage:"Suggested",id:"a0lFbMbzyl"});if(c==="trending")return u({defaultMessage:"Trending",id:"ll/ufR0/ED"})},[c,u]),m=f.useMemo(()=>{if(c==="suggestions")return n;const p=o?.filter(h=>h.category==="ticker");return p?p.map(h=>({symbol:h.query??"",name:h.description??"",image:h.image??"",darkImage:h.image_dark??"",url:h.url??"",exchange:h.metadata?.price_info?.exchange??"",country:h.metadata?.price_info?.exchangeCountry??"",currency:h.metadata?.price_info?.currency??"",change:h.metadata?.price_info?.change??void 0,currentPrice:h.metadata?.price_info?.currentPrice??void 0,changesPercentage:h.metadata?.price_info?.changePercentage??void 0})):[]},[o,n,c]);return f.useEffect(()=>{a.prefetchQuery({queryKey:$7("",s),queryFn:()=>W7({query:"",reason:r,country:s}),staleTime:0})},[a,s,r]),{suggestions:m?.length?m:[],isLoadingSuggestions:i,mode:c,title:d}},SPe=({focusedIndex:e,setFocusedIndex:t,onSelect:n})=>f.useCallback((s,a)=>{s.key==="ArrowDown"?(s.preventDefault(),t(e===null?0:Math.min(e+1,a.length-1))):s.key==="ArrowUp"?(s.preventDefault(),t(e===null?0:Math.max(e-1,0))):s.key==="Enter"&&e!==null&&(s.preventDefault(),n(a[e]))},[e,t,n]),mG=({onClick:e,defaultSuggestions:t=_e,reason:n="finance-navigational-searchbar",onAssetSelect:r}={})=>{const[s,a]=f.useState(!1),[o,i]=f.useState(""),[c,u]=f.useState(null),{inApp:d}=ao(),m=hn();f.useEffect(()=>u(null),[o]);const{suggestions:p,isLoadingSuggestions:h,mode:g,title:y}=wPe({value:o,isFocused:s,defaultSuggestions:t,reason:n}),b=f.useCallback(w=>{const S=Py({href:w?.url,inApp:d,queryParams:null});S&&m.push(S)},[m,d]),x=e??b,_=f.useCallback(()=>{a(!1),u(null)},[]),v=f.useCallback(w=>{x(w),_(),i(""),w&&r?.(w)},[x,_,r]),C=SPe({focusedIndex:c,setFocusedIndex:u,onSelect:v});return{isFocused:s,value:o,focusedIndex:c,isLoadingSuggestions:h,suggestions:p,mode:g,title:y,setIsFocused:a,setValue:i,setFocusedIndex:u,handleKeyDown:C,openAsset:v,closeSearch:_}};f.memo(function(){const{recentTickers:t,addRecentTicker:n,clearRecentTickers:r}=f5(),s=mG({onAssetSelect:n}),{$t:a}=Q(),o=f.useRef(null),{isMobileStyle:i}=Be(),{inApp:c}=ao(),u=f.useMemo(()=>t.length&&s.value===""?t:[],[t,s.value]),d=f.useCallback(p=>{s.handleKeyDown(p,[...u,...s.suggestions])},[s,u]),m=f.useRef(null);return m5({isOpen:s.isFocused,onClose:()=>s.setIsFocused(!1),refs:[m]}),l.jsxs("div",{ref:m,className:"flex flex-col justify-center relative md:w-full md:max-w-[360px] relative",children:[s.isFocused&&i&&l.jsx("div",{className:z("fixed bottom-0 inset-x-0 bg-black/50",{"top-headerHeight":i&&!c,"top-0":c}),onClick:s.closeSearch}),l.jsx(Y,{variant:"background",className:z("relative -mx-md px-md md:pb-0 md:px-0 md:mx-0",{"py-px":c}),children:l.jsx(xs,{type:"search",placeholder:a(i?{defaultMessage:"Search tickers...",id:"na0wZ6TycW"}:{defaultMessage:"Search for stocks, crypto, and more...",id:"sX/a414S1y"}),isMobileUserAgent:!1,onFocus:()=>s.setIsFocused(!0),onChange:s.setValue,onKeyDown:d,className:"h-9 w-full !py-0",ref:o})}),s.isFocused&&l.jsx("div",{className:z("z-50",{"fixed inset-x-0":i,"top-[var(--header-height)]":i&&!c,"top-9 translate-y-three":c,"absolute left-1/2 top-full mt-2 min-w-[500px] -translate-x-1/2":!i}),children:l.jsx(MPe,{title:s.title,isLoadingSuggestions:s.isLoadingSuggestions,recentTickers:u,suggestions:s.suggestions,value:s.value,focusedIndex:s.focusedIndex,setIsFocused:s.setIsFocused,setValue:s.setValue,openAsset:s.openAsset,trailing:l.jsx(kPe,{onClick:r})})})]})});const EPe=f.memo(function({defaultSuggestions:t=_e,onClick:n}){const{addRecentTicker:r}=f5(),s=mG({onClick:n,defaultSuggestions:t,onAssetSelect:r}),a=f.useRef(null);f.useEffect(()=>{a.current&&a.current.focus()},[]);const o=f.useCallback(c=>{(c.key==="ArrowDown"||c.key==="ArrowUp"||c.key==="Enter")&&s.handleKeyDown(c,s.suggestions)},[s]),{$t:i}=Q();return l.jsxs(l.Fragment,{children:[l.jsx(Y,{className:"p-sm w-full",children:l.jsx(xs,{type:"search",placeholder:i({defaultMessage:"Search tickers...",id:"na0wZ6TycW"}),isMobileUserAgent:!1,onFocus:()=>s.setIsFocused(!0),onChange:s.setValue,onKeyDown:o,ref:a})}),l.jsx(Y,{className:"w-full",children:s.isLoadingSuggestions?l.jsx("div",{className:"p-md flex items-center justify-center opacity-50",children:l.jsx(To,{size:14})}):s.suggestions.length===0?l.jsx(B,{variant:"small",color:"light",className:"p-md",textCenter:!0,children:i({defaultMessage:"No results",id:"jHJmjfxD4s"})}):s.suggestions.map((c,u)=>l.jsx(pG,{ticker:c,openAsset:s.openAsset,isFocused:s.focusedIndex===u,setIsFocused:s.setIsFocused,setValue:s.setValue},c.symbol+"suggestion"))})]})}),kPe=f.memo(function({onClick:t}){const{$t:n}=Q(),r=f.useCallback(s=>{s.stopPropagation(),t()},[t]);return l.jsx("div",{className:"flex h-0 items-center",children:l.jsx(pt,{icon:D("x"),size:"tiny",pill:!0,onClick:r,extraCSS:"-mr-sm opacity-50 hover:opacity-100",toolTip:n({defaultMessage:"Clear recents",id:"4k9F3xn5kg"})})})}),MPe=f.memo(function({title:t,isLoadingSuggestions:n,recentTickers:r,suggestions:s,value:a,focusedIndex:o,setIsFocused:i,setValue:c,openAsset:u,trailing:d}){const{$t:m}=Q(),{inApp:p}=ao(),h=s&&s.length>0,g=s?.length===0&&a!=="",y=r.length>0&&a==="";return!(h||y)&&!n?null:l.jsx(Y,{variant:"raised",className:z("relative flex flex-col overflow-hidden rounded-b-xl shadow-md md:rounded-xl md:border md:shadow-xl",{"-mt-one":p}),children:n?l.jsx("div",{className:"p-md flex items-center justify-center opacity-50",children:l.jsx(To,{size:14})}):g?l.jsx(B,{variant:"small",color:"light",className:"p-md",textCenter:!0,children:m({defaultMessage:"No results",id:"jHJmjfxD4s"})}):l.jsxs(l.Fragment,{children:[y&&l.jsxs(l.Fragment,{children:[l.jsx(Y7,{title:m({defaultMessage:"Recent",id:"iXpep1vGVo"}),trailing:d}),l.jsx("div",{className:"gap-xs p-sm flex flex-wrap",children:r.map((x,_)=>l.jsx(TPe,{ticker:x,openAsset:u,isFocused:o===_,setIsFocused:i,setValue:c},`${x.symbol}-recent`))})]}),t?l.jsx(Y7,{title:t}):l.jsx(Y,{className:"border-b"}),s.map((x,_)=>l.jsx(pG,{ticker:x,openAsset:u,isFocused:o===_+r.length,setIsFocused:i,setValue:c},x.symbol+"suggestion"))]})})}),Y7=f.memo(function({title:t,trailing:n}){return l.jsxs("div",{className:"bg-subtler gap-sm px-md py-sm flex items-center justify-between",children:[l.jsx(B,{variant:"tinyRegular",color:"light",children:t}),n]})}),TPe=f.memo(function({ticker:t,isFocused:n,openAsset:r}){return l.jsxs(Y,{className:"pl-xs pr-sm group relative inline-flex cursor-pointer overflow-hidden rounded-full border py-0.5",as:"button",onClick:()=>r(t),children:[l.jsx(Y,{className:z("absolute inset-0 rounded-full opacity-0 group-hover:opacity-100",n&&"opacity-100"),variant:"subtler"}),l.jsxs("div",{className:"gap-xs relative flex max-w-[200px] items-center",children:[l.jsx(e3,{watchlistType:"FINANCE",image:t.image,imageDark:t.darkImage,alt:t.name,imageClassName:"!size-4 overflow-hidden rounded-sm"}),l.jsx(B,{variant:"tiny",className:"truncate",children:t.name}),l.jsx(B,{variant:"tinyMono",color:"light",className:"shrink-0",children:t.symbol})]})]})}),pG=f.memo(function({ticker:t,isFocused:n,openAsset:r}){const{addRecentTicker:s}=f5(),{session:a}=je(),{trackEvent:o}=Ze(a),i=f.useCallback(()=>{s(t),r(t),o("finance link clicked",{referrer:Ly.SEARCH_AUTOSUGGEST,targetPageType:Nm.ASSET_PAGE,symbol:t.symbol,destinationUrl:t.url})},[s,t,r,o]);return l.jsxs(Y,{className:"gap-sm px-md py-sm group relative flex w-full cursor-pointer appearance-none items-center justify-between border-b text-left last:border-b-0",onClick:i,as:"button",children:[l.jsx(Y,{className:z("absolute inset-0 opacity-0 group-hover:opacity-100",n&&"opacity-100"),variant:"subtler"}),l.jsxs("div",{className:"gap-md relative flex w-full items-center justify-between",children:[l.jsxs("div",{className:"gap-sm flex min-w-0 items-center",children:[l.jsx(e3,{watchlistType:"FINANCE",image:t.image,imageDark:t.darkImage,alt:t.name,className:"shrink-0 overflow-hidden rounded"}),l.jsxs("div",{className:"min-w-0 max-w-[200px]",children:[l.jsx(B,{variant:"smallBold",className:"truncate",children:t.name}),l.jsx(B,{variant:"tinyMono",color:"light",children:l.jsx(Rm,{symbol:t.symbol,exchange:t.exchange,country:t.country})})]})]}),l.jsxs("div",{className:"gap-sm flex items-center",children:[t.currentPrice&&t.currency?l.jsx(B,{variant:"tinyMono",color:"light",children:t.currentPrice.toLocaleString("en-US",{style:"currency",currency:t.currency})}):null,t.changesPercentage?l.jsx(ox,{change:t.changesPercentage,variant:"tinyMono",includeIcon:!0}):null,l.jsx(ye,{icon:D("chevron-right"),size:"sm",className:"text-quiet -mr-xs"})]})]})]})});function Q7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function APe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Q7(Object(n),!0).forEach(function(r){NPe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function rf(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?rf=function(t){return typeof t}:rf=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rf(e)}function NPe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Og(){return Og=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Og.apply(this,arguments)}function RPe(e,t){if(e){if(typeof e=="string")return X7(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return X7(e,t)}}function X7(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hG(e,t){var n=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=RPe(e))||t){n&&(e=n);var r=0,s=function(){};return{s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(c){throw c},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,i;return{s:function(){n=n.call(e)},n:function(){var c=n.next();return a=c.done,c},e:function(c){o=!0,i=c},f:function(){try{!a&&n.return!=null&&n.return()}finally{if(o)throw i}}}}function DPe(e,t){var n=[],r=[];function s(a,o){if(a.length===1)n.push(a[0]),r.push(a[0]);else{for(var i=Array(a.length-1),c=0;c<i.length;c++)c===0&&n.push(a[0]),c===i.length-1&&r.push(a[c+1]),i[c]=[(1-o)*a[c][0]+o*a[c+1][0],(1-o)*a[c][1]+o*a[c+1][1]];s(i,o)}}return e.length&&s(e,t),{left:n,right:r.reverse()}}function IPe(e){var t={};return e.length===4&&(t.x2=e[2][0],t.y2=e[2][1]),e.length>=3&&(t.x1=e[1][0],t.y1=e[1][1]),t.x=e[e.length-1][0],t.y=e[e.length-1][1],e.length===4?t.type="C":e.length===3?t.type="Q":t.type="L",t}function jPe(e,t){t=t||2;for(var n=[],r=e,s=1/t,a=0;a<t-1;a++){var o=s/(1-s*a),i=DPe(r,o);n.push(i.left),r=i.right}return n.push(r),n}function PPe(e,t,n){var r=[[e.x,e.y]];return t.x1!=null&&r.push([t.x1,t.y1]),t.x2!=null&&r.push([t.x2,t.y2]),r.push([t.x,t.y]),jPe(r,n).map(IPe)}var OPe=/[MLCSTQAHVZmlcstqahv]|-?[\d.e+-]+/g,jc={M:["x","y"],L:["x","y"],H:["x"],V:["y"],C:["x1","y1","x2","y2","x","y"],S:["x2","y2","x","y"],Q:["x1","y1","x","y"],T:["x","y"],A:["rx","ry","xAxisRotation","largeArcFlag","sweepFlag","x","y"],Z:[]};Object.keys(jc).forEach(function(e){jc[e.toLowerCase()]=jc[e]});function uC(e,t){for(var n=Array(e),r=0;r<e;r++)n[r]=t;return n}function LPe(e){return"".concat(e.type).concat(jc[e.type].map(function(t){return e[t]}).join(","))}function FPe(e,t){var n={x1:"x",y1:"y",x2:"x",y2:"y"},r=["xAxisRotation","largeArcFlag","sweepFlag"];if(e.type!==t.type&&t.type.toUpperCase()!=="M"){var s={};Object.keys(t).forEach(function(a){var o=t[a],i=e[a];i===void 0&&(r.includes(a)?i=o:(i===void 0&&n[a]&&(i=e[n[a]]),i===void 0&&(i=0))),s[a]=i}),s.type=t.type,e=s}return e}function UPe(e,t,n){var r=[];if(t.type==="L"||t.type==="Q"||t.type==="C")r=r.concat(PPe(e,t,n));else{var s=Og({},e);s.type==="M"&&(s.type="L"),r=r.concat(uC(n-1).map(function(){return s})),r.push(t)}return r}function Z7(e,t,n){var r=e.length-1,s=t.length-1,a=r/s,o=uC(s).reduce(function(c,u,d){var m=Math.floor(a*d);if(n&&m<e.length-1&&n(e[m],e[m+1])){var p=a*d%1<.5;c[m]&&(p?m>0?m-=1:m<e.length-1&&(m+=1):m<e.length-1?m+=1:m>0&&(m-=1))}return c[m]=(c[m]||0)+1,c},[]),i=o.reduce(function(c,u,d){if(d===e.length-1){var m=uC(u,Og({},e[e.length-1]));return m[0].type==="M"&&m.forEach(function(p){p.type="L"}),c.concat(m)}return c.concat(UPe(e[d],e[d+1],u))},[]);return i.unshift(e[0]),i}function J7(e){for(var t=(e||"").match(OPe)||[],n=[],r,s,a=0;a<t.length;++a)if(r=jc[t[a]],r){s={type:t[a]};for(var o=0;o<r.length;++o)s[r[o]]=+t[a+o+1];a+=r.length,n.push(s)}return n}function BPe(e,t,n){var r=e==null?[]:e.slice(),s=t==null?[]:t.slice(),a=rf(n)==="object"?n:{excludeSegment:n,snapEndsToInput:!0},o=a.excludeSegment,i=a.snapEndsToInput;if(!r.length&&!s.length)return function(){return[]};var c=(r.length===0||r[r.length-1].type==="Z")&&(s.length===0||s[s.length-1].type==="Z");r.length>0&&r[r.length-1].type==="Z"&&r.pop(),s.length>0&&s[s.length-1].type==="Z"&&s.pop(),r.length?s.length||s.push(r[0]):r.push(s[0]);var u=Math.abs(s.length-r.length);u!==0&&(s.length>r.length?r=Z7(r,s,o):s.length<r.length&&(s=Z7(s,r,o))),r=r.map(function(m,p){return FPe(m,s[p])});var d=r.map(function(m){return APe({},m)});return c&&(d.push({type:"Z"}),r.push({type:"Z"})),function(p){if(p===1&&i)return t??[];if(p===0)return r;for(var h=0;h<d.length;++h){var g=r[h],y=s[h],b=d[h],x=hG(jc[b.type]),_;try{for(x.s();!(_=x.n()).done;){var v=_.value;b[v]=(1-p)*g[v]+p*y[v],(v==="largeArcFlag"||v==="sweepFlag")&&(b[v]=Math.round(b[v]))}}catch(C){x.e(C)}finally{x.f()}}return d}}function HPe(e,t,n){var r=J7(e),s=J7(t),a=rf(n)==="object"?n:{excludeSegment:n,snapEndsToInput:!0},o=a.excludeSegment,i=a.snapEndsToInput;if(!r.length&&!s.length)return function(){return""};var c=BPe(r,s,{excludeSegment:o,snapEndsToInput:i});return function(d){if(d===1&&i)return t??"";var m=c(d),p="",h=hG(m),g;try{for(h.s();!(g=h.n()).done;){var y=g.value;p+=LPe(y)}}catch(b){h.e(b)}finally{h.f()}return p}}const ix=(e,t=!0,n=200)=>{const r=f.useRef(e),s=f.useRef(e),[a,o]=WS(()=>({t:1,config:{duration:n},easing:Ay}));return s.current!==e&&(r.current=s.current,s.current=e,o.start({from:{t:0},to:{t:1},immediate:!t,config:{duration:n}})),a.t.to(i=>HPe(r.current,s.current)(i))};var gG="Toggle",yG=f.forwardRef((e,t)=>{const{pressed:n,defaultPressed:r,onPressedChange:s,...a}=e,[o,i]=Ml({prop:n,onChange:s,defaultProp:r??!1,caller:gG});return l.jsx(Hn.button,{type:"button","aria-pressed":o,"data-state":o?"on":"off","data-disabled":e.disabled?"":void 0,...a,ref:t,onClick:qn(e.onClick,()=>{e.disabled||i(!o)})})});yG.displayName=gG;var Ii="ToggleGroup",[xG]=pu(Ii,[xu]),bG=xu(),p5=A.forwardRef((e,t)=>{const{type:n,...r}=e;if(n==="single"){const s=r;return l.jsx(VPe,{...s,ref:t})}if(n==="multiple"){const s=r;return l.jsx(GPe,{...s,ref:t})}throw new Error(`Missing prop \`type\` expected on \`${Ii}\``)});p5.displayName=Ii;var[_G,vG]=xG(Ii),VPe=A.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:s=()=>{},...a}=e,[o,i]=Ml({prop:n,defaultProp:r??"",onChange:s,caller:Ii});return l.jsx(_G,{scope:e.__scopeToggleGroup,type:"single",value:A.useMemo(()=>o?[o]:[],[o]),onItemActivate:i,onItemDeactivate:A.useCallback(()=>i(""),[i]),children:l.jsx(CG,{...a,ref:t})})}),GPe=A.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:s=()=>{},...a}=e,[o,i]=Ml({prop:n,defaultProp:r??[],onChange:s,caller:Ii}),c=A.useCallback(d=>i((m=[])=>[...m,d]),[i]),u=A.useCallback(d=>i((m=[])=>m.filter(p=>p!==d)),[i]);return l.jsx(_G,{scope:e.__scopeToggleGroup,type:"multiple",value:o,onItemActivate:c,onItemDeactivate:u,children:l.jsx(CG,{...a,ref:t})})});p5.displayName=Ii;var[zPe,qPe]=xG(Ii),CG=A.forwardRef((e,t)=>{const{__scopeToggleGroup:n,disabled:r=!1,rovingFocus:s=!0,orientation:a,dir:o,loop:i=!0,...c}=e,u=bG(n),d=qC(o),m={role:"group",dir:d,...c};return l.jsx(zPe,{scope:n,rovingFocus:s,disabled:r,children:s?l.jsx(WC,{asChild:!0,...u,orientation:a,dir:d,loop:i,children:l.jsx(Hn.div,{...m,ref:t})}):l.jsx(Hn.div,{...m,ref:t})})}),Lg="ToggleGroupItem",wG=A.forwardRef((e,t)=>{const n=vG(Lg,e.__scopeToggleGroup),r=qPe(Lg,e.__scopeToggleGroup),s=bG(e.__scopeToggleGroup),a=n.value.includes(e.value),o=r.disabled||e.disabled,i={...e,pressed:a,disabled:o},c=A.useRef(null);return r.rovingFocus?l.jsx($C,{asChild:!0,...s,focusable:!o,active:a,ref:c,children:l.jsx(e8,{...i,ref:t})}):l.jsx(e8,{...i,ref:t})});wG.displayName=Lg;var e8=A.forwardRef((e,t)=>{const{__scopeToggleGroup:n,value:r,...s}=e,a=vG(Lg,n),o={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},i=a.type==="single"?o:void 0;return l.jsx(yG,{...i,...s,ref:t,onPressedChange:c=>{c?a.onItemActivate(r):a.onItemDeactivate(r)}})}),$Pe=p5,WPe=wG;const KPe=({value:e,onChange:t,id:n,children:r,boxProps:s,className:a=""})=>{const o=i=>{i&&t(i)};return l.jsx(SG.Provider,{value:{activeValue:e},children:l.jsx(e0,{id:n,children:l.jsx($Pe,{onValueChange:o,type:"single",value:e,asChild:!0,children:l.jsx(ze.div,{layout:!0,layoutRoot:!0,children:l.jsx(Y,{className:z("border-subtler p-two flex rounded-lg border",a),...s,children:r})})})})})},YPe=({value:e,icon:t,className:n="",children:r,disabled:s=!1,style:a,onClick:o})=>{const i="relative text-quiet hover:text-foreground data-[state=on]:text-foreground flex h-[32px] min-w-[32px] p-sm items-center justify-center duration-150 active:scale-95",c=f.useContext(SG);return l.jsx(WPe,{asChild:!0,value:e,disabled:s,children:l.jsxs("button",{className:z(i,{"cursor-not-allowed":s},n),disabled:s,style:a,onClick:o,children:[l.jsxs("span",{className:z("gap-xs relative z-[2] flex",{"opacity-50":s}),children:[Array.isArray(t)?t.map((u,d)=>l.jsx(_n,{icon:u,size:"small"},d)):t?l.jsx(_n,{icon:t,size:"small"}):null,r]}),c.activeValue===e&&l.jsx(ze.div,{layout:!0,layoutId:"toggle",className:"absolute inset-0 z-[1]",transition:{duration:.15,ease:Ay},children:l.jsx("div",{className:"absolute inset-0 rounded-md bg-subtle"})})]})})},SG=Bt("ToggleGroupContext",{activeValue:""}),QPe=KPe,XPe=YPe,Ba={Root:QPe,Item:XPe},ZPe=[0,5,10,25,50,100,200],dC=Me({advanced:{defaultMessage:"Advanced",id:"3Rx6Qo1x+1"},sma:{defaultMessage:"Simple Moving Average",id:"6Az5TSZOco"},period:{defaultMessage:"Period",id:"jCNpELHqTA"},off:{defaultMessage:"Off",id:"OvzONl52rs"}}),JPe=(e,t)=>{if(!e?.length||t<=0)return[];const n=[];let r=0;for(let s=0;s<e.length;s++){const a=e[s];if(!a)continue;const o=a.close;if(r+=o,s>=t){const i=e[s-t]?.close;i&&(r-=i)}if(s>=t-1){const i=s<t?s+1:t;n.push({date:a.date,value:r/i})}}return n},eOe=()=>{const[e,t]=f.useState(0);return{sma:{period:e,setPeriod:t}}},tOe=f.memo(function({history:t,xScale:n,yScale:r,indicators:s}){const a=s?.sma?.period??0,o=a>0,i=f.useMemo(()=>JPe(t,a),[t,a]),c=f.useMemo(()=>Fo().defined(m=>Sc(m.value)).x(m=>{const p=new Date(m.date);return n(p)??0}).y(m=>r(m.value)??0).curve(Fy),[n,r]),u=f.useMemo(()=>c(i)??void 0,[c,i]),d=ix(u??"",!0,Qa);return o?l.jsx(ze.g,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:Qa/1e3,ease:"easeInOut"},children:l.jsx(Jr.path,{d,fill:"none",stroke:Pn.gray,strokeWidth:1.5,strokeDasharray:"none",shapeRendering:Uu,style:{vectorEffect:"non-scaling-stroke"}})}):null}),t8="flex flex-col p-sm gap-md",nOe=f.memo(function({children:t}){const{$t:n}=Q(),[r,s]=f.useState(!1),a=f.useRef(null),o=f.useRef(null),i=f.useRef(null),{isMediumScreen:c}=Ll();m5({isOpen:r,onClose:()=>s(!1),refs:[a,o,i]});const u=l.jsx(wn,{content:n(dC.advanced),disabled:r,children:l.jsx("button",{ref:a,onClick:()=>s(d=>!d),className:z(wl,"px-sm group h-full bg-transparent transition-transform"),children:l.jsx(B,{variant:"tiny",color:"light",className:"gap-xs flex items-center pt-px",children:l.jsx(ut,{name:D("dots-vertical"),className:"size-4"})})})});return c?l.jsxs("div",{ref:i,className:"relative",children:[u,r&&l.jsx(Y,{className:"z-100 absolute left-0 top-full mt-2 overflow-hidden rounded-xl border shadow-md",children:l.jsx("div",{className:z("bg-base",t8),children:t})})]}):l.jsxs(l.Fragment,{children:[u,r&&l.jsx(yu,{children:l.jsxs("div",{ref:o,className:"bg-base border-subtlest shadow-overlay fixed inset-x-0 top-0 z-50 flex flex-col overflow-hidden rounded-b-xl border-x border-b",children:[l.jsx("div",{className:"flex items-center p-md",children:l.jsx("button",{onClick:()=>s(!1),children:l.jsx(ut,{name:D("arrow-left"),className:"text-quiet size-5"})})}),l.jsx(Y,{className:z("flex-1 overflow-auto p-sm",t8),children:t})]})})]})}),rOe=f.memo(function({history:t,indicators:n}){const{sma:r}=n,{$t:s}=Q(),a=t?.length??0,o=ZPe.map(c=>({value:c,label:c===0?s(dC.off):c.toString(),disabled:c>0&&a<c})),i=f.useCallback(c=>{r.setPeriod(+c)},[r]);return l.jsxs("div",{children:[l.jsx(B,{variant:"smallBold",className:"pb-sm px-xs",children:s(dC.sma)}),l.jsx(Y,{children:l.jsx(Ba.Root,{value:r.period.toString(),onChange:i,id:"sma",className:"flex items-center w-fit",children:o.map(c=>l.jsx(Ba.Item,{value:String(c.value),disabled:c.disabled,children:l.jsx(B,{variant:"tiny",color:r.period===c.value?"default":"light",className:"whitespace-nowrap",children:c.label})},c.value))})})]})}),sOe=f.memo(function({setFullscreen:t,fullscreen:n}){const{$t:r}=Q();return n?null:l.jsx(wn,{content:r({defaultMessage:"Fullscreen",id:"zvKOAuzJQK"}),children:l.jsx("button",{onClick:()=>t(!n),style:{minHeight:DH},className:z(wl,"flex items-center justify-center px-sm h-full"),children:l.jsx(B,{variant:"tiny",color:"light",className:"inline-flex",children:l.jsx(ut,{name:D(n?"arrows-diagonal-minimize":"arrows-diagonal"),size:16})})})})}),aOe=e=>Math.round(e*.12),Fp=e=>e?.type?1:0,oOe=({exchangeHoursAnnotations:e,xScale:t,width:n,xMaskingSupported:r,tzOffsetMins:s,history:a})=>{const o=r?e:[],i=[],c="invert"in t,u=c?n:a.length,d=h=>{if(c)return{x:h,date:t.invert(h)};const g=a[h];return{x:t(pn(g))??0,date:pn(g)}};let m,p;for(let h=0;h<u;h++){const g=d(h),y=P3(o,g.date,s);if(h===0){i.push({x:0,backgroundOpacity:Fp(y)}),m=y,p=g.x;continue}if(m!==y){const b=p??g.x;i.push({x:b,backgroundOpacity:Fp(m)},{x:b,backgroundOpacity:Fp(y)})}m=y,p=g.x}return m&&i.push({x:n,backgroundOpacity:Fp(m)}),i.length<=1?[]:i},iOe=({l:e,id:t,animationId:n,history:r,baseline:s,stops:a,yScale:o,style:i,xDomainData:c,height:u,marginBottom:d})=>{const m=f.useMemo(()=>{const h=o(s),g=e(r);return g?`${g} L ${c[1]},${h} L ${c[0]},${h} Z`:""},[e,r,o,s,c]),p=f.useMemo(()=>{const h=o.domain(),g=h[1]-h[0],y=(h[1]-s)/g*100,b=(u-d)/u*100;return y*(b/100)},[o,s,u,d]);return l.jsxs(l.Fragment,{children:[l.jsxs("defs",{children:[l.jsx("linearGradient",{id:`ticker-area-color-gradient-${t}`,x1:"0%",y1:"0%",x2:"100%",y2:"0%",colorInterpolation:"linearRGB",spreadMethod:"pad",children:a.map((h,g)=>l.jsx("stop",{offset:`${F3(h.x,c)}%`,stopColor:Pn[h.backgroundColor],stopOpacity:h.backgroundOpacity},g))}),l.jsxs("linearGradient",{id:`ticker-area-opacity-gradient-${t}`,x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[l.jsx("stop",{offset:"0%",stopColor:"white",stopOpacity:"0.3"}),l.jsx("stop",{offset:`${Math.max(0,p-20)}%`,stopColor:"white",stopOpacity:"0.1"}),l.jsx("stop",{offset:`${p}%`,stopColor:"white",stopOpacity:"0.00"}),l.jsx("stop",{offset:`${Math.min(100,p+20)}%`,stopColor:"white",stopOpacity:"0.1"}),l.jsx("stop",{offset:"100%",stopColor:"white",stopOpacity:"0.3"})]}),l.jsx("mask",{id:`ticker-area-mask-${t}`,children:l.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#ticker-area-opacity-gradient-${t})`})})]}),l.jsx(Wt,{mode:"wait",children:l.jsx(ze.g,{mask:`url(#ticker-area-mask-${t})`,animate:{opacity:1},initial:{opacity:0},transition:di,children:l.jsx("path",{d:m,fill:`url(#ticker-area-color-gradient-${t})`,stroke:"none",shapeRendering:Uu,style:{mixBlendMode:"multiply",...i}})},n)})]})},lOe=({l:e,history:t,stops:n,xDomainData:r,id:s,disableAnimation:a})=>{const o=f.useMemo(()=>e(t),[e,t]),i=ix(o,!a,Qa);return l.jsxs(l.Fragment,{children:[l.jsx("defs",{children:l.jsx("linearGradient",{id:`ticker-line-gradient-${s}`,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:n.map((c,u)=>l.jsx("stop",{offset:`${F3(c.x,r)}%`,stopColor:Pn[c.backgroundColor],stopOpacity:c.lineOpacity},u))})}),l.jsx(Jr.path,{d:i,stroke:n?.length?`url(#ticker-line-gradient-${s})`:Pn.blue,strokeWidth:1.75,fill:"none",shapeRendering:Uu})]})},cOe=({id:e,stops:t,height:n,opacity:r,size:s,style:a,xBounds:o})=>l.jsxs("g",{children:[l.jsxs("defs",{children:[l.jsx("pattern",{id:`ticker-after-hours-dot-grid-${e}`,patternUnits:"userSpaceOnUse",width:s,height:s,children:l.jsx("circle",{cx:s/2,cy:s/2,r:s*.12,fill:Pn.gray,opacity:r})}),l.jsx("linearGradient",{id:`ticker-after-hours-mask-gradient-${e}`,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:t.map((i,c)=>l.jsx("stop",{offset:`${F3(i.x,o)}%`,stopColor:"white",stopOpacity:i.backgroundOpacity},c))}),l.jsx("mask",{id:`ticker-after-hours-mask-${e}`,children:l.jsx("rect",{x:0,y:"0",width:o[1],height:n,fill:`url(#ticker-after-hours-mask-gradient-${e})`})})]}),l.jsx("rect",{x:0,y:"0",style:a,width:o[1],height:n,fill:`url(#ticker-after-hours-dot-grid-${e})`,mask:`url(#ticker-after-hours-mask-${e})`})]}),uOe=e=>e>=20&&e<=40?.95:e>500?.5:.8,dOe=f.memo(function({top:t,height:n,data:r,xScale:s}){const a=f.useMemo(()=>{const u=Math.max(...r.map(d=>d.volume));return n5({exponent:.4,domain:[0,u],range:[0,n]})},[r,n]),o=f.useMemo(()=>{if(r.length<2)return 1;let u=1/0;for(let d=1;d<r.length;d++){const m=s(pn(r[d-1]))??0,p=s(pn(r[d]))??0,h=Math.abs(p-m);h>0&&(u=Math.min(u,h))}return u===1/0?1:u*uOe(r.length)},[r,s]),{positivePath:i,negativePath:c}=f.useMemo(()=>{const u=[],d=[],m=t+n;for(const p of r){if(p.volume===0)continue;const h=(s(pn(p))??0)-o/2,g=a(p.volume),y=m-g,x=p.close-p.open>=0,_=`M ${h} ${m} L ${h} ${y} L ${h+o} ${y} L ${h+o} ${m} Z`;x?u.push(_):d.push(_)}return{positivePath:u.join(" "),negativePath:d.join(" ")}},[r,s,o,a,t,n]);return l.jsxs("g",{children:[i&&l.jsx("path",{d:i,fill:Pn.blue,opacity:.75}),c&&l.jsx("path",{d:c,fill:Pn.red,opacity:.75})]})}),fOe=({baseline:e,history:t,yScale:n,chartWidth:r,children:s})=>{const a=f.useMemo(()=>{const i=n(e),c=10,u=25,d=20,m=t.slice(-Math.max(3,Math.floor(t.length*.1))),p=m.reduce((b,x)=>b+n(Da(x)),0)/m.length,h=Math.abs(p-i),y=!(i<u+d)&&(h>=c?!0:p>i);return{opacity:1,top:i,left:r-10,transform:`translate(-100%, ${y?"-100%":"0"})`}},[e,t,n,r]),o=f.useMemo(()=>({...a,opacity:0}),[a]);return r<25?null:l.jsx(ze.div,{className:"pointer-events-none absolute z-50",initial:o,animate:a,transition:{duration:.5,ease:"easeInOut"},children:s})},mOe=(e,t,n,r)=>{const[s,a]=f.useState(null),o=f.useCallback(()=>{e?.point.local.x&&a(e.point.local.x)},[e?.point.local.x]),i=f.useCallback(()=>{a(null)},[]),c=f.useMemo(()=>s===null?null:L3(s,t,n).d,[t,n,s]),u=f.useMemo(()=>{if(!c||!e)return null;const[b,x]=[e.data,c].sort((_,v)=>v.date.localeCompare(_.date));return{absolute:b.close-x.close,relative:(b.close-x.close)/x.close}},[c,e]),d=f.useMemo(()=>t.range()[1],[t]),m=f.useMemo(()=>!s||!c?null:t(pn(c)),[t,c,s]),p=f.useMemo(()=>!s||!c||!e?null:t(pn(e.data))??d,[t,c,s,e,d]),h=f.useMemo(()=>!c||!e||!s?`M 0 0 L ${d} 0 L ${d} ${r} L 0 ${r} Z`:`M ${m} 0 L ${p} 0 L ${p} ${r} L ${m} ${r} Z`,[c,e,s,r,m,p,d]),g="finance-chart-clip-path",y=f.useMemo(()=>({clipPath:`url(#${g})`}),[g]);return{id:g,path:h,style:y,animate:!s,absoluteChange:u?.absolute,relativeChange:u?.relative,handleMouseDown:o,handleMouseUp:i,leftX:m,rightX:p}},pOe=({id:e,path:t})=>l.jsx("defs",{children:l.jsx("clipPath",{id:e,children:l.jsx(Jr.path,{d:t})})}),hOe=f.memo(function({id:t,symbol:n,exchangeTimezone:r,exchangeHours:s,currency:a,history:o,previousClose:i,width:c,height:u,exchangeHoursAnnotations:d=_e,uiHints:m,technical:p,candlestick:h,indicators:g,watermark:y,zoomable:b,isCrypto:x}){const{locale:_,$t:v}=Q(),C=f.useMemo(()=>o.toSorted((Ae,He)=>Ae.date.localeCompare(He.date)),[o]),w=aOe(u),S=f.useMemo(()=>U3(C),[C]),E=`${n}-${m?.currentPeriod}-${m?.currentInterval}`,{transform:T,isActivelyZooming:k,containerRef:M}=dG({enabled:!!b,width:c,id:E}),N=f.useMemo(()=>a9e(C),[C]),P=f.useMemo(()=>new Set(m?.historyAnomalies??[]),[m?.historyAnomalies]),O=f.useMemo(()=>C.filter(Ae=>!P.has(Ae.date)),[C,P]),L=f.useMemo(()=>Z8e(O,m?.historyMovingAverageWindow??0),[O,m?.historyMovingAverageWindow]),H=f.useMemo(()=>{const Ae=Q8e(C,s);return Hu({domain:Ae,range:[0,c]})},[C,c,s]),R=f.useMemo(()=>Pm({domain:C.map(pn),range:[0,c]}),[C,c]),I=f.useMemo(()=>S?cG(T,H):uG(T,R),[T,H,R,S]),F=f.useMemo(()=>Os(C,pn).map(Ae=>I(Ae)),[I,C]),G=f.useMemo(()=>[0,c],[c]),j=f.useMemo(()=>{if(h){const Ae=O.map(rt=>rt.low),He=O.map(rt=>rt.high);return[Math.min(...Ae),Math.max(...He)]}return Os(O,Da)},[O,h]),$=i??0,q=f.useMemo(()=>{let Ae=j[0],He=j[1];$&&(Ae=Math.min(Ae,$),He=Math.max(He,$));const rt=He-Ae;return Ae-=rt*.05,He+=rt*.05,So({nice:!1,domain:[Ae,He],range:p?[u-Ir-w,Ic]:[u-Ir,Ic]})},[u,$,j,p,w]),U=f.useMemo(()=>Fo().x(Ae=>I(pn(Ae))??0).y(Ae=>q(Da(Ae))??0).curve(Fy),[I,q]),X=N&&!!d.length,J=f.useMemo(()=>K8e(r??"UTC",new Date),[r]),{tooltipData:ne,hideTooltip:ae,showTooltip:de}=Gje({data:C,exchangeHoursAnnotations:d,xScale:I,xBounds:F,hidden:k,tzOffsetMins:J}),{handleMouseDown:oe,handleMouseUp:le,leftX:se,rightX:re,...he}=mOe(ne,I,C,u),ie=$je(he.absoluteChange),ue=f.useCallback(()=>{le(),ae()},[le,ae]),{isMobileStyle:ce}=Be(),me=ce?jH:IH,pe=f.useMemo(()=>q.ticks(me),[q,me]),{xTickLabels:xe,xTickFormatter:Oe,xTickLines:Te,xTickCount:we}=fG({history:C,xGet:pn,xGetUnparsed:Eg,timezone:r,locale:_,xScale:I,width:c,zoom:T.k}),ke=f.useMemo(()=>oOe({xMaskingSupported:X,xScale:I,width:c,exchangeHoursAnnotations:d??[],tzOffsetMins:J,history:C}),[X,I,c,d,J,C]),Fe=f.useMemo(()=>r9e({xMaskingSupported:X,history:L,baseline:$,xScale:I,width:c,exchangeHoursAnnotations:d??[],tzOffsetMins:J}),[X,L,$,I,c,d,J]),ot=f.useCallback(Ae=>OH({tick:Ae,history:L,yScale:q,xScale:I,yGet:Da,baseline:$}),[L,q,I,$]),ge=f.useMemo(()=>!ke.length,[ke]),Ce=f.useMemo(()=>x?V({defaultMessage:"24h ago: {price}",id:"mSeez9Kv3Q"}):V({defaultMessage:"Prev close: {price}",id:"ZjNVXgqGKh"}),[x]);return l.jsxs("div",{ref:M,className:D3,onMouseDown:oe,onMouseMove:de,onMouseLeave:ue,onMouseOut:ue,onMouseUp:le,onTouchStart:de,onTouchMove:de,onTouchEnd:ue,onTouchCancel:ue,children:[l.jsxs("svg",{height:u,width:c,className:R3,children:[l.jsx(Wt,{initial:!1,mode:"wait",children:ge&&l.jsxs(ze.g,{initial:{opacity:0},animate:{opacity:1},transition:di,children:[l.jsx(ql,{tickValues:pe,scale:q,width:c,stroke:Pn.gray,strokeWidth:1,opacity:.1,className:"transition-all duration-1000"}),l.jsx(Zy,{scale:I,opacity:.1,height:u*2,stroke:Pn.gray,style:{transform:`translateY(-${u}px)`},numTicks:we,strokeWidth:1,tickValues:Te})]},E)}),l.jsx(pOe,{id:he.id,path:he.path}),!h&&l.jsx(iOe,{l:U,id:n,animationId:E,history:L,baseline:$,stops:Fe,yScale:q,style:he.style,xDomainData:F,height:u,marginBottom:Ir}),l.jsx(Wt,{mode:"wait",children:l.jsxs(ze.g,{initial:{opacity:0},exit:G8e,animate:{opacity:1},transition:di,children:[l.jsx(cOe,{id:t,stops:ke,height:u*3,style:{transform:`translateY(-${u*3/2}px)`},width:c,opacity:.33,size:5,xBounds:G}),l.jsx("g",{opacity:ne?0:1,className:gv(!!ne),children:l.jsx(_i,{scale:q,hideTicks:!0,hideAxisLine:!0,numTicks:me,left:I3,orientation:"right",tickLabelProps:ot})}),p&&l.jsx(dOe,{top:u-w-Ir,height:w,data:O,xScale:I}),l.jsx(_i,{scale:I,hideAxisLine:!0,hideTicks:!0,numTicks:we,tickValues:xe,tickFormat:Oe,orientation:"bottom",top:u-Ir,tickLabelProps:j3})]},E)}),!h&&l.jsx(lOe,{l:U,id:n,history:L,baseline:$,stops:Fe,xDomainData:F,disableAnimation:k}),l.jsx(Wt,{mode:"wait",children:h&&l.jsx(ze.g,{initial:{opacity:0},exit:q8e,animate:{opacity:1},transition:z8e,children:l.jsx(dje,{xScale:I,yScale:q,history:O})},E)}),l.jsx(Wt,{children:l.jsx(EG,{width:c,yScale:q,baseline:$})}),l.jsx(Wt,{children:l.jsx(tOe,{history:C,xScale:I,yScale:q,indicators:g})}),ne&&l.jsx(c5,{marginTop:-u,tooltipLeft:ne.point.local.x,innerHeight:u*3,color:ie})]}),l.jsx(Wt,{children:S&&l.jsx(fOe,{baseline:$,history:C,yScale:q,chartWidth:c,children:l.jsx("div",{className:z("m-sm bg-base shadow-subtle overflow-hidden rounded-full border backdrop-blur-sm",gv(!!ne)),children:l.jsx("div",{className:"px-sm py-xs bg-subtle relative p-0",children:l.jsx(B,{variant:"micro",color:"light",className:"relative whitespace-nowrap",children:v(Ce,{price:el($,a,_)})})})})})}),l.jsx(Wt,{children:Sc(se)&&Sc(re)&&l.jsx(ze.div,{animate:{opacity:1},exit:{opacity:0},transition:{duration:.15,ease:"easeInOut"},className:"pointer-events-none absolute inset-0",style:{left:re>se?se:re,right:c-(re>se?re:se),top:-u,bottom:-u},children:l.jsx(ze.div,{className:"bg-inverse absolute inset-0 rounded-md opacity-5"})})}),y&&l.jsx("div",{className:"absolute -top-md right-sm z-[2] pointer-events-none",children:y}),ne&&!p&&l.jsx(zje,{x:ne.point.local.x,y:ne.point.touch?-Ir:ne.point.local.y,annotation:ne.annotation,close:ne.data.close,date:ne.data.date,absoluteChange:he.absoluteChange,relativeChange:he.relativeChange,currency:a,exchangeTimezone:r??void 0}),ne&&p&&l.jsx(qje,{x:ne.point.global.x,y:ne.point.global.y,annotation:ne.annotation,data:ne.data,currency:a,locale:_,exchangeTimezone:r??void 0,absoluteChange:he.absoluteChange,relativeChange:he.relativeChange})]})}),EG=f.memo(function({width:t,yScale:n,baseline:r}){return l.jsx(ze.line,{stroke:Pn.gray,initial:{opacity:0},transition:{duration:Qa/1e3,ease:"easeInOut"},animate:{opacity:1,x1:0,x2:t,y1:n(r??0),y2:n(r??0)},exit:{opacity:0},strokeDasharray:"4 4",strokeWidth:.8,shapeRendering:Uu})}),kG=f.memo(function({id:t,quote:n,technical:r,candlestick:s,indicators:a,watermark:o,height:i=Lm,zoomable:c=!0}){return l.jsx(ar,{fallback:rG,children:l.jsx(i5,{height:i,render:!!n,children:u=>!n||u<100||!n.history?.length?null:l.jsx(hOe,{id:t,symbol:n.symbol,currency:n.currency,history:n.history,previousClose:n.historicalPreviousClose??void 0,exchangeHours:n.exchangeHours,exchangeTimezone:n.exchangeTimezone,exchangeHoursAnnotations:n.exchangeHoursAnnotations,width:u,height:i,uiHints:n.uiHints,technical:r,candlestick:s,indicators:a,watermark:o,zoomable:c,isCrypto:n.isCrypto})})})}),MG=["oklch(var(--hydra-450))","oklch(var(--terra-450))","oklch(var(--dalmasca-400))","oklch(var(--kuja-450))","oklch(var(--rosa-450))","oklch(var(--costa-400))","oklch(var(--jenova-450))","oklch(var(--limsa-450))","oklch(var(--gridania-450))"],TG=["oklch(var(--hydra-350))","oklch(var(--terra-350))","oklch(var(--dalmasca-300))","oklch(var(--kuja-350))","oklch(var(--rosa-350))","oklch(var(--costa-300))","oklch(var(--jenova-250))","oklch(var(--limsa-350))","oklch(var(--gridania-350))"],gOe=(e,t)=>{const n=t?TG:MG;return n[e%n.length]??"oklch(var(--super-color))"},AG=()=>{const{colorScheme:e}=Cs();return f.useMemo(()=>e==="dark"?TG:MG,[e])},sf=(e,t)=>t[e%t.length]??"oklch(var(--super-color))",yOe=4,Nh=e=>e.changesPercentage,xOe=({d:e,disableAnimation:t})=>{const n=ix(e??"",!t,Qa);return e?l.jsx(Jr.path,{strokeWidth:1.75,fill:"none",shapeRendering:Uu,d:n}):null},bOe=({data:e,yScale:t})=>e?.map(n=>l.jsx(_Oe,{x:n.x,yv:n.yv,color:n.quote.color,yScale:t,r:yOe},n.quote.symbol)),_Oe=({x:e,yv:t,color:n,yScale:r,r:s})=>l.jsx("circle",{cx:e,cy:r(t),r:s,fill:n}),vOe=({data:e,timeZone:t,locale:n,x:r})=>{const s=f.useMemo(()=>e.reduce((o,i)=>Math.abs(i.x-r)<Math.abs(o.x-r)?i:o,e[0]),[e,r]),a=f.useMemo(()=>{if(!s)return null;const o=s.date;return o?O3(o,n,t??void 0):null},[s,n,t]);return l.jsx(B,{variant:"tinyRegular",color:"light",className:"px-sm py-xs",children:a})},COe=(e,t)=>{const n={color:e.color,symbol:e.symbol,name:e.name,exchange:e.exchange,currency:e.currency,image:e.image,imageDark:e.imageDark,exchangeTimezone:e.exchangeTimezone};return t?{quote:{...n,price:t.close,historicalChange:t.close-(e.historicalPreviousClose??0),historicalPercentChange:t.changesPercentage*100},date:t.date}:{quote:{...n,price:e.price,historicalChange:e.historicalChange??0,historicalPercentChange:e.historicalPercentChange??0},date:null}},wOe=({data:e,dataMovingAverage:t,xScale:n,xBounds:r,setHoveredComparisons:s,hidden:a})=>{const{tooltipData:o,hideTooltip:i,showTooltip:c}=sx(),u=A.useRef(null),d=A.useRef(a),m=f.useCallback((g,y)=>{const b=Math.min(Math.max(r[0],g.local.x),r[1]),x=t.map((_,v)=>{const C=L3(b,n,_.history),w=e[v].history[Math.min(C.index,e[v].history.length-1)],S=COe(e[v],w);return{date:S.date,quote:S.quote,x:n(pn(C.d))??0,yv:Nh(C.d)}});x.every(_=>_.x)&&(s(x.map(_=>_.quote)),c({tooltipData:{data:x,point:{local:{x:g.local.x,y:y?-Ir:g.local.y},global:g.global}}}))},[e,t,n,c,r,s]);d.current&&!a&&u.current&&m(u.current,!1),d.current=a;const p=f.useCallback(g=>{const y="touches"in g,b=Fm(g);if(!b)return;const x=N3(g),_={local:b,global:x};u.current=_,m(_,y)},[m]),h=f.useCallback(()=>{u.current=null,i(),s([])},[i,s]);return f.useMemo(()=>({tooltipData:a?void 0:o,hideTooltip:h,showTooltip:p}),[o,h,p,a])},SOe=e=>{if(e.length===0)return!0;const t=e[0].map(pn);for(let n=1;n<e.length;++n){const r=e[n];if(r?.length!==t.length)return!1;for(let s=0;s<t.length-1;++s)if(pn(r[s]).getTime()!==t[s].getTime())return!1}return!0},EOe=(e,t)=>t?(e-t)/t:0,n8=e=>{const t=e.historicalPreviousClose||e.history[0].close,n=e.history.map(r=>({...r,changesPercentage:EOe(r.close,t),change:r.close-t}));return{...e,history:n}},kOe=(e,t)=>!e||e===t?1:.2,MOe=({quotes:e,width:t,height:n,setHoveredComparisons:r,focused:s,watermark:a,zoomable:o})=>{const{locale:i}=Q(),{isMobileStyle:c}=Be(),u=c?jH:IH,d=e?.[0]?.exchangeTimezone,m=f.useMemo(()=>e.map(n8),[e]),p=f.useMemo(()=>e.map(q=>n8(q)),[e]),h=f.useMemo(()=>p.flatMap(q=>q.history).sort((q,U)=>pn(q).getTime()-pn(U).getTime()),[p]),g=f.useMemo(()=>So({nice:!1,domain:Os(m.flatMap(q=>q.history),Nh),range:[n-Ir,Ic]}),[n,m]),y=f.useMemo(()=>SOe(m.map(q=>q.history)),[m]),b=f.useMemo(()=>U3(h),[h]),x=e.map(q=>q.symbol).join("-"),{transform:_,isActivelyZooming:v,containerRef:C}=dG({enabled:!!o,width:t,id:x}),w=f.useMemo(()=>Hu({domain:Os(h,pn),range:[0,t]}),[t,h]),S=f.useMemo(()=>Pm({domain:Array.from(new Set(h.map(Eg))).sort().map(LH),range:[0,t]}),[t,h]),E=f.useMemo(()=>b||!y?cG(_,w):uG(_,S),[_,w,S,y,b]),{xTickLabels:T,xTickFormatter:k,xTickLines:M,xTickCount:N}=fG({history:h,xGet:pn,xGetUnparsed:Eg,timezone:d,locale:i,xScale:E,width:t,zoom:_.k}),P=AG(),O=f.useMemo(()=>Fo().x(q=>E(pn(q))??0).y(q=>g(Nh(q))??0).curve(Fy),[E,g]),L=f.useMemo(()=>p.map((q,U)=>({path:O(q.history),color:sf(U,P),quote:q})),[p,O,P]),H=f.useMemo(()=>g.ticks(u).filter(q=>q!==0),[g,u]),R=f.useMemo(()=>[0,t],[t]),{tooltipData:I,hideTooltip:F,showTooltip:G}=wOe({data:m,dataMovingAverage:p,xScale:E,xBounds:R,setHoveredComparisons:r,hidden:v}),j=f.useCallback(q=>q.toLocaleString(i,{style:"percent"}),[i]),$=f.useCallback(q=>{const U=p.map(X=>OH({tick:q,history:X.history,yScale:g,xScale:E,yGet:Nh}));return U.find(X=>X.opacity<1)??U[0]},[p,g,E]);return l.jsxs("div",{ref:C,className:D3,onMouseMove:G,onMouseLeave:F,onMouseOut:F,onTouchStart:G,onTouchMove:G,onTouchEnd:F,onTouchCancel:F,children:[l.jsxs("svg",{height:n,width:t,className:R3,children:[l.jsx(Wt,{initial:!1,mode:"wait",children:l.jsxs(ze.g,{initial:{opacity:0},animate:{opacity:1},transition:di,children:[l.jsx("g",{opacity:I?0:1,className:gv(!!I),children:l.jsx(_i,{scale:g,hideTicks:!0,hideAxisLine:!0,numTicks:u,tickFormat:j,left:I3,orientation:"right",tickLabelProps:$})}),l.jsx(_i,{scale:E,hideAxisLine:!0,hideTicks:!0,numTicks:N,tickValues:T,tickFormat:k,orientation:"bottom",top:n-Ir,tickLabelProps:j3}),l.jsx(ql,{tickValues:H,scale:g,width:t,stroke:Pn.gray,strokeWidth:1,opacity:.1,className:"transition-all duration-1000"}),l.jsx(Zy,{scale:E,opacity:.1,height:n*2,stroke:Pn.gray,style:{transform:`translateY(-${n}px)`},numTicks:N,strokeWidth:1,tickValues:M})]},x)}),l.jsx(Wt,{children:L.map((q,U)=>l.jsx(ze.g,{initial:{opacity:0,transition:di},exit:{opacity:0,transition:di},animate:{stroke:q.color,opacity:kOe(s,q.quote.symbol),transition:{delay:0,duration:.25}},children:l.jsx(xOe,{d:q.path,disableAnimation:v})},U))}),l.jsx(Wt,{children:l.jsx(EG,{width:t,yScale:g})}),I&&l.jsx(c5,{marginTop:-n,tooltipLeft:I.point.local.x,innerHeight:n*3,color:Pn.gray}),l.jsx(bOe,{data:I?.data,yScale:g})]}),a&&l.jsx("div",{className:"absolute -top-md right-sm z-[2]",children:a}),I&&l.jsx(ax,{x:I.point.local.x,y:I.point.local.y,pill:!0,children:l.jsx(vOe,{data:I.data,timeZone:d,x:I.point.local.x,locale:i})})]})},TOe=f.memo(function({quotes:t,focused:n,height:r,setHoveredComparisons:s,watermark:a}){return t.every(o=>o?.history?.length)?l.jsx(ar,{fallback:rG,children:l.jsx(i5,{height:r,render:!!t?.length,children:(o,i)=>!t?.length||o<100?null:l.jsx(MOe,{quotes:t,width:o,height:i,focused:n,setHoveredComparisons:s,watermark:a,zoomable:!0})})}):l.jsx(nG,{children:l.jsxs(Y,{className:"flex flex-col items-center justify-center",children:[l.jsx("span",{children:l.jsx(be,{id:"nUBkUnVNSR",defaultMessage:"Not enough data to display comparison."})}),l.jsx("span",{children:l.jsx(be,{id:"pSEgxhrGLz",defaultMessage:"Please try another time period."})})]})})}),AOe=({root:e,quote:t,removeComparison:n,setFocused:r,className:s,href:a})=>{const o=f.useCallback(()=>{r(t.symbol)},[r,t.symbol]),i=f.useCallback(()=>{r(null)},[r]),c=f.useCallback(p=>{p.preventDefault(),p.stopPropagation(),i(),n?.(t.symbol)},[n,t.symbol,i]),{session:u}=je(),{trackEvent:d}=Ze(u),m=f.useCallback(()=>{d("finance link clicked",{referrer:Ly.CHART_COMPARISON,targetPageType:Nm.ASSET_PAGE,symbol:t.symbol,destinationUrl:a})},[t.symbol,a,d]);return l.jsxs(Oy,{href:a,className:z("hover:bg-subtler flex items-center justify-start duration-150",{"bg-subtlest":e},s),onMouseEnter:o,onMouseLeave:i,onClick:m,children:[l.jsx(Y,{className:"w-xs my-xs ml-xs shrink-0 self-stretch rounded-full",style:{background:t.color}}),l.jsxs(Y,{className:"p-sm py-xs gap-sm md:gap-md flex w-full items-center justify-between",children:[l.jsxs(Y,{className:z("gap-sm duration-quick grid w-full items-center transition-opacity [grid-template-columns:2fr_1fr_1fr] md:[grid-template-columns:5fr_1fr_1fr_1fr]",{"pointer-events-none opacity-0":t.loading}),children:[l.jsxs(Y,{className:"gap-sm flex items-center",children:[l.jsx(Am,{symbol:t.symbol??"",src:t.image??"",srcDark:t.imageDark??""}),l.jsxs(Y,{children:[l.jsx(B,{variant:"smallBold",lineClamp:1,className:"text-ellipsis",children:t.name??t.symbol}),l.jsx(B,{variant:"tinyMono",color:"light",children:l.jsx(Rm,{symbol:t.symbol,exchange:t.exchange})})]})]}),l.jsx("span",{children:Sc(t.price)&&l.jsx(Mf,{variant:"small",price:t.price??0,currency:t.currency,animated:!1,className:"text-right"})}),l.jsx("span",{className:"hidden text-center md:block",children:Sc(t.historicalChange)&&l.jsx(Mf,{variant:"small",price:t.historicalChange??0,currency:t.currency,animated:!1,sign:!0,color:d5(t.historicalChange??0)})}),l.jsx("span",{children:Sc(t.historicalPercentChange)&&l.jsx(ox,{change:t.historicalPercentChange??0,variant:"tiny",includeIcon:!0,mono:!1,animated:!1})})]}),!!n&&l.jsx(Y,{className:z("flex items-center justify-end active:scale-95",{"pointer-events-none invisible":e}),children:l.jsx(st,{onClick:c,variant:"border",icon:D("x"),pill:!0,size:"tiny"},t.symbol)})]})]})},NOe=f.memo(function({comparisons:t,removeComparison:n,setFocused:r,root:s}){const a=f.useCallback(()=>{r(null)},[r]),o=f.useCallback(i=>{const c=[i.symbol,...t.map(u=>u.symbol).filter(u=>u!==i.symbol)];return`/finance/${i.symbol}?comparing=${c.join(",")}`},[t]);return l.jsx(Y,{className:"m-0 flex flex-col overflow-hidden p-0",onMouseLeave:a,children:t.map((i,c)=>l.jsx(AOe,{quote:i,root:c===(s??0),removeComparison:n,setFocused:r,href:o(i)},`${i.symbol}-${c===(s??0)}`))})}),ROe=({id:e,candlestick:t,setCandlestick:n})=>l.jsxs(Ba.Root,{className:wl,value:t?"candlestick":"line",onChange:r=>{n(r==="candlestick")},id:`candlestick-toggle-${e}`,children:[l.jsx(Ba.Item,{style:Sg,value:"line",children:l.jsx(ut,{name:D("chart-line"),size:16})}),l.jsx(Ba.Item,{style:Sg,value:"candlestick",children:l.jsx(ut,{name:D("chart-candle"),size:16})})]}),h5=A.memo(function({isOpen:t,children:n,placement:r,hoverOpen:s=!1,disabled:a=!1,onOpen:o,onClose:i,content:c,contentWidth:u="360px",isMobileStyle:d,boxProps:m,canOutsideClickClose:p,removeScroll:h,modalTitleContent:g,modalRenderCloseButton:y=!0,ref:b,...x}){const[_,v]=f.useState(!1),C=f.useMemo(()=>t!==void 0,[t]),w=f.useMemo(()=>C?t:_,[C,t,_]),S=f.useCallback(()=>{!w&&!a&&(o?.(),C||v(!0))},[a,C,o,w]),E=f.useCallback(()=>{w&&!a&&(i?.(),C||v(!1))},[a,C,i,w]);f.useImperativeHandle(b,()=>({dismiss:E}),[E]);const T=f.useMemo(()=>({width:u??void 0}),[u]),k=f.useMemo(()=>l.jsx(Y,{style:T,...m,children:c}),[T,m,c]),M=f.useMemo(()=>({canOutsideClickClose:p??!0,removeScroll:h}),[p,h]);return d?l.jsxs(l.Fragment,{children:[l.jsx(IN,{variant:"bottom-left-sheet",actionList:_e,isOpen:w,onClose:E,titleContent:g,renderCloseButton:y,children:c}),l.jsx("span",{onClick:S,children:n})]}):l.jsx(DN,{isOpen:w,hoverOpen:s,placement:r,onClose:E,onOpen:S,overlayProps:M,content:k,hasInteractiveContent:!0,...x,children:n})}),r8=f.memo(function({setRange:t,range:n,onApply:r}){const{$t:s}=Q(),a=f.useMemo(()=>({after:new Date}),[]),o=f.useMemo(()=>n?.from??new Date,[n]),i=f.useCallback(()=>{t(void 0)},[t]);return l.jsxs(Y,{className:"flex flex-col w-fit",children:[l.jsx(JF,{captionLayout:"dropdown",disabled:a,defaultMonth:o,onSelect:t,selected:n,mode:"range",className:"w-fit"}),l.jsxs(Y,{className:"gap-sm flex justify-end px-md pb-sm",children:[l.jsx(at,{size:"tiny",onClick:i,variant:"secondary",children:s({id:"jm/spnRSn+",defaultMessage:"Reset"})}),l.jsx(at,{size:"tiny",fullWidth:!0,onClick:r,disabled:!n?.from,variant:n?.from?"primary":"secondary",children:s({id:"EWw/tKINJT",defaultMessage:"Apply"})})]})]})});function DOe({id:e,periods:t,period:n,setPeriod:r,variant:s,calendar:a=!1}){const[o,i]=f.useState(!1),[c,u]=f.useState(!1),[d,m]=f.useState(void 0),p=f.useMemo(()=>t.find(_=>_.value===n),[t,n]),{$t:h}=Q(),g=f.useCallback(()=>{if(d?.from){const _=d?.to??d.from;r(`${sk(d.from)}~${sk(_)}`),u(!1),i(!1)}},[d,r]),y=f.useCallback(_=>{_.stopPropagation(),u(v=>!v)},[]),b=f.useCallback(()=>{u(!1)},[]),x=f.useCallback(()=>{u(!0)},[]);return s==="sm"?l.jsx(Y,{className:z(wl,"flex items-center"),variant:"transparent",style:{minHeight:Tf},children:l.jsxs(Qe,{isOpen:o,onToggle:i,maxHeightPx:500,triggerElement:l.jsxs(B,{variant:"tiny",color:"light",className:"gap-xs flex items-center h-full pl-sm pr-xs cursor-pointer",children:[p?.text??h({id:"Sjo1P44FYy",defaultMessage:"Custom"}),l.jsx(ut,{name:D("chevron-down"),size:16})]}),children:[t.map(({value:_,text:v})=>l.jsx(Qe.Item,{onSelect:()=>{r(_),i(!1)},children:v},_)),a&&l.jsx(Qe,{isOpen:c,onToggle:u,triggerElement:l.jsx(Qe.Button,{variant:"text",size:"small",children:h({id:"Sjo1P44FYy",defaultMessage:"Custom"})}),children:l.jsx(Y,{className:"flex justify-center items-start h-full",style:{minHeight:350},children:l.jsx(r8,{setRange:m,range:d,onApply:g})})})]})}):l.jsxs(Ba.Root,{value:n,className:wl,id:`${e}-periods`,onChange:_=>{_&&r(_)},children:[t.map(({value:_,text:v})=>l.jsx(Ba.Item,{value:_,style:Sg,children:l.jsx(B,{variant:"tiny",color:n===_?"default":"light",className:"translate-y-px visRefresh2026Fonts:translate-y-0 whitespace-nowrap duration-150",children:v})},_)),a&&l.jsx(Ba.Item,{value:B3(n)?n:"",onClick:y,style:Sg,children:l.jsx(h5,{isOpen:c,onClose:b,onOpen:x,isMobileStyle:!1,contentWidth:"auto",avoidCollisions:!0,placement:"top",sideOffset:15,childrenClassName:"inline-flex",content:l.jsx(r8,{setRange:m,range:d,onApply:g}),children:l.jsx(ut,{name:D("calendar"),size:16,className:z({"text-super":c})})})})]})}const g5=f.memo(DOe),IOe=f.memo(function({peers:t,addComparison:n}){const{$t:r}=Q(),[s,a]=f.useState(!1),{isMobileStyle:o}=Be(),i=f.useRef(null),c=f.useRef(null),u=f.useRef(null);m5({isOpen:s,onClose:()=>a(!1),refs:o?[i,c]:[u]});const d=f.useMemo(()=>t.map(g=>g)?.slice(0,5),[t]),m=f.useCallback(g=>{g&&(n({symbol:g.symbol,name:g.name,image:g.image,imageDark:g.darkImage,exchange:g.exchange,price:g.currentPrice,currency:g.currency,historicalChange:g.change,historicalPercentChange:g.changesPercentage}),a(!1))},[n]),p=l.jsx("button",{ref:i,onClick:()=>a(g=>!g),className:z(wl,"px-sm group h-full bg-transparent transition-transform"),children:l.jsxs(B,{variant:"tiny",color:"light",className:"gap-xs flex items-center pt-px duration-200 ease-out group-active:scale-95",children:[r({defaultMessage:"Compare",id:"493J7RI1tF"}),l.jsx(ut,{name:D("chevron-down"),className:"size-3"})]})}),h=l.jsx(EPe,{defaultSuggestions:d,onClick:m});return o?l.jsxs(l.Fragment,{children:[p,s&&l.jsx(yu,{children:l.jsxs("div",{ref:c,className:"bg-base border-subtlest shadow-overlay fixed inset-x-0 top-0 z-50 flex flex-col overflow-hidden rounded-b-xl border-x border-b",children:[l.jsx("div",{className:"flex flex-shrink-0 items-center justify-start",children:l.jsx("button",{className:"p-md",onClick:()=>a(!1),children:l.jsx(ut,{name:D("arrow-left"),className:"text-quiet size-5"})})}),l.jsx(Y,{className:"flex-1 overflow-auto",children:h})]})})]}):l.jsxs("div",{ref:u,className:"relative",children:[p,s&&l.jsx(Y,{className:"z-100 absolute left-0 top-full mt-2 w-[360px] overflow-hidden rounded-xl border shadow-md",children:l.jsx("div",{className:"bg-base",children:h})})]})});A.memo(function({children:t}){return l.jsx(ar,{fallback:null,children:l.jsx("div",{className:"h-full empty:hidden",children:t})})});A.memo(function({children:t,className:n}){return l.jsx("div",{className:z("mt-lg pb-lg flex flex-col gap-lg",n),children:t})});A.memo(function({children:t,className:n}){return l.jsx(B,{variant:"smallBold",className:z("pb-sm px-sm",n),children:t})});const jOe=A.memo(function({children:t,className:n,variant:r}){return l.jsx(Xn,{variant:r,className:z("py-sm",n),children:t})}),POe="-my-sm gap-x-sm grid w-full grid-cols-[1fr_min-content_min-content]";A.memo(function(t){const{isLoading:n,isStale:r,movers:s,skinny:a,approxItemCount:o,itemProps:i,referrer:c}=t;return l.jsx(jOe,{className:z("overflow-hidden duration-150",{"opacity-50":n}),children:l.jsx(ze.div,{className:z(POe,{"pointer-events-none invisible":n}),initial:{opacity:0},animate:{opacity:r?.5:1},exit:{opacity:0},transition:{duration:.5},"aria-hidden":n,children:n?l.jsx(OOe,{size:o??5,...t}):s?.map(u=>f.createElement(NG,{...i,key:u.symbol,symbol:u.symbol,price:u.price,exchange:u.exchange??void 0,currency:u.currency??void 0,name:u.name??"",changesPercentage:u.changesPercentage,skinty:a,useImage:!a,image:u.image??void 0,imageDark:u.imageDark??void 0,referrer:c}))},"top-mover")})});const NG=e=>e.skinty?l.jsx(FOe,{...e}):l.jsx(LOe,{...e}),OOe=({size:e,...t})=>[...Array(e).fill(null)].map((n,r)=>l.jsx(NG,{...t,symbol:"NVDA",price:110,currency:"USD",name:"XXX",changesPercentage:110,exchange:"XX",useImage:!t.skinny,skinty:t.skinny},r)),LOe=e=>l.jsx(SH,{symbol:e.symbol,referrer:e.referrer,className:"col-span-3 flex min-w-0",children:l.jsx(UOe,{...e})});function FOe({symbol:e,name:t,price:n,currency:r,changesPercentage:s,trailingComponent:a,referrer:o}){return l.jsxs(SH,{symbol:e,referrer:o,className:"col-span-3 grid grid-cols-subgrid",children:[l.jsx(S3,{name:t,variant:"small"}),l.jsx(Mf,{price:n,currency:r}),l.jsxs("div",{className:"gap-sm flex items-center",children:[l.jsx(y5,{changesPercentage:s,includeIcon:!0,variant:"tiny",className:"w-full"}),a&&a({symbol:e})]})]})}const y5=A.memo(function({changesPercentage:t,background:n,variant:r,includeIcon:s=!1,className:a,suffix:o,animated:i}){return l.jsx(ox,{change:t,variant:r,includeIcon:s,background:n,mono:!1,suffix:o,className:a,animated:i})}),UOe=A.memo(function({symbol:t,price:n,currency:r,name:s,changesPercentage:a,useImage:o=!0,exchange:i,image:c,imageDark:u,trailingComponent:d,className:m}){return l.jsxs("div",{className:z("gap-sm flex w-full min-w-0 items-center",{"-ml-xs":!!o},m),children:[o&&l.jsx(Am,{symbol:t,src:c??"",srcDark:u,size:"lg"}),l.jsxs(Y,{className:"flex min-w-0 flex-1 flex-col",children:[l.jsxs(Y,{className:"gap-md flex min-w-0 items-end justify-between",children:[l.jsx(S3,{name:s}),l.jsx(Mf,{price:n,currency:r,className:"leading-snug"})]}),l.jsxs(Y,{className:"gap-sm flex items-start justify-between text-right",children:[l.jsx(B,{variant:"tinyMono",className:"whitespace-nowrap leading-snug",color:"light",children:l.jsx(Rm,{symbol:t,exchange:i})}),l.jsx(y5,{changesPercentage:a,background:!1,animated:!1,className:"leading-tight"})]})]}),d&&d({symbol:t})]})}),Rh={operatingActivities:"Operating Activities",netIncome:"Net Income",depreciationAndAmortization:"Dep. & Amort.",deferredIncomeTax:"Deferred Tax",stockBasedCompensation:"Stock-Based Comp.",changeInWorkingCapital:"Change in WC",otherNonCashItems:"Other Non-Cash",netCashProvidedByOperatingActivities:"Operating Cash Flow",investingActivities:"Investing Activities",investmentsInPropertyPlantAndEquipment:"PP&E Inv.",acquisitionsNet:"Net Acquisitions",purchasesOfInvestments:"Inv. Purchases",salesMaturitiesOfInvestments:"Inv. Sales/Matur.",otherInvestingActivites:"Other Inv. Act.",netCashUsedForInvestingActivites:"Investing Cash Flow",financingActivities:"Financing Activities",debtRepayment:"Debt Repay.",commonStockIssued:"Stock Issued",commonStockRepurchased:"Stock Repurch.",dividendsPaid:"Dividends Paid",otherFinancingActivites:"Other Fin. Act.",netCashUsedProvidedByFinancingActivities:"Financing Cash Flow",effectOfForexChangesOnCash:"Forex Effect",netChangeInCash:"Net Chg. in Cash",supplementalInformation:"Supplemental Information",operatingCashFlow:"Operating Cash Flow",capitalExpenditure:"Capital Expenditures",cashAtBeginningOfPeriod:"Beg. Cash",cashAtEndOfPeriod:"End Cash",freeCashFlow:"Free Cash Flow"},Ma={revenue:"Revenue",revenueGrowth:"% Growth",costOfRevenue:"Cost of Goods Sold",grossProfit:"Gross Profit",grossProfitRatio:"% Margin",researchAndDevelopmentExpenses:"R&D Expenses",generalAndAdministrativeExpenses:"G&A Expenses",sellingGeneralAndAdministrativeExpenses:"SG&A Expenses",sellingAndMarketingExpenses:"Sales & Mktg Exp.",otherExpenses:"Other Operating Expenses",operatingExpenses:"Operating Expenses",operatingIncome:"Operating Income",operatingIncomeRatio:"% Margin",totalOtherIncomeExpensesNet:"Other Income/Exp. Net",incomeBeforeTax:"Pre-Tax Income",incomeTaxExpense:"Tax Expense",netIncome:"Net Income",netIncomeRatio:"% Margin",eps:"EPS",epsGrowth:"% Growth",epsDiluted:"EPS Diluted",weightedAverageSharesOutstanding:"Weighted Avg Shares Out",weightedAverageSharesOutstandingDiluted:"Weighted Avg Shares Out Dil",supplementalInformation:"Supplemental Information",interestIncome:"Interest Income",interestExpense:"Interest Expense",depreciationAndAmortization:"Depreciation & Amortization",ebitda:"EBITDA",ebitdaRatio:"% Margin"},BOe={assets:"Assets",cashAndCashEquivalents:"Cash & Equivalents",shortTermInvestments:"Short-Term Investments",netReceivables:"Receivables",inventory:"Inventory",otherCurrentAssets:"Other Curr. Assets",totalCurrentAssets:"Total Curr. Assets",propertyPlantEquipmentNet:"Property Plant & Equip (Net)",goodwill:"Goodwill",intangibleAssets:"Intangibles",longTermInvestments:"Long-Term Investments",taxAssets:"Tax Assets",otherNonCurrentAssets:"Other NC Assets",totalNonCurrentAssets:"Total NC Assets",otherAssets:"Other Assets",totalAssets:"Total Assets",liabilities:"Liabilities",accountsPayables:"Payables",shortTermDebt:"Short-Term Debt",taxPayables:"Tax Payable",deferredRevenue:"Def. Revenue",otherCurrentLiabilities:"Other Curr. Liab.",totalCurrentLiabilities:"Total Curr. Liab.",longTermDebt:"LT Debt",deferredRevenueNonCurrent:"Def. Rev. NC",deferredTaxLiabilitiesNonCurrent:"Def. Tax Liab. NC",otherNonCurrentLiabilities:"Other NC Liab.",totalNonCurrentLiabilities:"Total NC Liab.",otherLiabilities:"Other Liab.",capitalLeaseObligations:"Cap. Leases",totalLiabilities:"Total Liab.",equity:"Equity",preferredStock:"Pref. Stock",commonStock:"Common Stock",retainedEarnings:"Ret. Earnings",accumulatedOtherComprehensiveIncomeLoss:"AOCI",otherStockholdersEquity:"Other Equity",totalEquity:"Total Equity",supplementalInformation:"Supplemental Information",minorityInterest:"Min. Interest",totalLiabilitiesAndTotalEquity:"Total Liab. & Tot. Equity",totalInvestments:"Total Inventory",totalDebt:"Total Debt",netDebt:"Net Debt"},HOe={marketCapitalization:"Market Cap",minusCashAndCashEquivalents:"- Cash",addTotalDebt:"+ Debt",enterpriseValue:"Enterprise Value",revenue:Ma.revenue,revenueGrowth:Ma.revenueGrowth,grossProfit:Ma.grossProfit,grossProfitRatio:Ma.grossProfitRatio,ebitda:Ma.ebitda,ebitdaRatio:Ma.ebitdaRatio,netIncome:Ma.netIncome,netIncomeRatio:Ma.netIncomeRatio,epsDiluted:Ma.epsDiluted,epsDilutedGrowth:"% Growth",netCashProvidedByOperatingActivities:Rh.netCashProvidedByOperatingActivities,capitalExpenditure:Rh.capitalExpenditure,freeCashFlow:Rh.freeCashFlow},Pf=new Set(["grossProfitRatio","revenueGrowth","ebitdaRatio","operatingIncomeRatio","incomeBeforeTaxRatio","netIncomeRatio","epsGrowth","epsDilutedGrowth"]),VOe=new Set(["eps","epsDiluted","weightedAverageSharesOutstanding","weightedAverageSharesOutstandingDiluted"]);[...Pf];[...Pf],[...Pf];const GOe=new Set([...Object.keys(BOe),...Object.keys(Ma),...Object.keys(Rh),...Object.keys(HOe)].filter(e=>!Pf.has(e)&&!VOe.has(e)));[...GOe];({...Object.fromEntries([...Pf].map(e=>[e,1]))});function s8(e,t){const n=new Date(e),r=new Date(t);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()&&n.getDate()===r.getDate()}function zOe(e,t){return t&&B3(t)&&e?.length?{startDate:e[0].date,endDate:e[e.length-1].date}:t!=="1d"&&e?.length?{startDate:e[0].date,endDate:e[e.length-1].date}:{startDate:void 0,endDate:void 0}}const RG=({price:e,currency:t,change:n,percentChange:r,children:s,className:a,variant:o})=>{const i=f.useMemo(()=>({style:t?"currency":"decimal",currency:t??void 0,minimumFractionDigits:2,maximumFractionDigits:2}),[t]),c=o==="sm",u=c?"tiny":"base";return l.jsxs(Y,{className:z("flex w-full flex-col",a),children:[l.jsxs(Y,{className:"gap-sm flex w-full items-center justify-start",children:[l.jsx(B,{variant:c?"baseSemi":"entry-title-200",className:"m-0 p-0",children:l.jsx(w3,{value:e,format:i,animated:!0})}),l.jsxs(Y,{className:"gap-xs flex items-center",children:[!c&&l.jsx(Mf,{price:n??0,currency:t,sign:!0,variant:u,animated:!0,color:d5(n??0)}),l.jsx(y5,{animated:!0,changesPercentage:r??0,variant:u,background:!1,includeIcon:!0})]})]}),l.jsx(Y,{className:"gap-sm flex items-center justify-start",children:s})]})},DG="flex items-center gap-xs truncate min-w-0",qOe=A.memo(function({price:t,currency:n,change:r,percentChange:s,timestamp:a,open:o,closes:i,timezone:c,variant:u,period:d,startDate:m,endDate:p}){const{$t:h,locale:g}=Q(),y=f.useMemo(()=>{const b=B3(d);if(d!=="1d"&&m&&p){const _=new Date(m),v=new Date(!b&&a?a*1e3:p),C=L=>L.toLocaleDateString(g,{month:"short",day:"numeric",year:"numeric",timeZone:c}),w=L=>L.toLocaleString(g,{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",second:u==="lg"?"2-digit":void 0,timeZoneName:"short",timeZone:c}),S=b&&s8(m,p),E=C(_),T=a?new Date(a*1e3):null,k=b&&T&&s8(v,T),M=k&&T?T:v,N=!i||o,P=L=>b&&!k?C(L):N?w(L):C(L);if(b&&S)return k?P(M):E;const O=P(M);return h({defaultMessage:"{startDate}  {endDate}",id:"5Rl2zbDuSl"},{startDate:E,endDate:O})}const x=a?new Date(a*1e3).toLocaleTimeString(g,{hour:"numeric",minute:"2-digit",day:"numeric",month:"short",second:u==="lg"?"2-digit":void 0,timeZoneName:"short",timeZone:c}):null;if(u==="sm"){if(!o&&i&&a){const v=new Date(a*1e3).toLocaleDateString(g,{month:"short",day:"numeric",timeZone:c});return h({defaultMessage:"At close: {date}",id:"9BKLglSBhn"},{date:v})}return x}return o&&i?h({defaultMessage:"Regular session: {time}",id:"rfeIMcMmh2"},{time:x}):!o&&i?h({defaultMessage:"At close: {time}",id:"Fib7mn4gfB"},{time:x}):x},[a,g,o,h,i,c,u,d,m,p]);return l.jsx(RG,{price:t,currency:n,change:r,percentChange:s,variant:u,children:l.jsx(B,{variant:"tinyRegular",color:"light",className:DG,children:y})})}),$Oe=A.memo(function({price:t,currency:n,change:r,percentChange:s,timestamp:a,timezone:o,variant:i,afterHoursType:c}){const{$t:u,locale:d}=Q(),{isMobileStyle:m}=Be(),p=new Date(a*1e3).toLocaleTimeString(d,{hour:"numeric",minute:"2-digit",second:m?void 0:"2-digit",day:"numeric",month:"short",timeZoneName:m?void 0:"short",timeZone:o}),h=f.useMemo(()=>{const b=c==="pre_market"?V({defaultMessage:"Pre-market: {time}",id:"ok47wYkpHy"}):V({defaultMessage:"After-hours: {time}",id:"e87RdWfWOJ"});return u(b,{time:p})},[c,p,u]),g=f.useMemo(()=>{if(i==="sm"){const y=c==="pre_market",b=new Date(a*1e3).toLocaleTimeString(d,{hour:"numeric",minute:"2-digit",timeZone:o}),x=y?V({defaultMessage:"Pre-market: {time}",id:"ok47wYkpHy"}):V({defaultMessage:"After-hours: {time}",id:"e87RdWfWOJ"});return u(x,{time:b})}return null},[i,c,a,d,o,u]);return l.jsx(RG,{price:t,currency:n,change:r,percentChange:s,variant:i,children:l.jsx(B,{variant:"tinyRegular",color:"light",className:DG,children:i==="sm"?g:h})})}),a8=({children:e,grow:t=!0,className:n})=>l.jsx(Y,{className:z("px-md py-sm",t?"flex-1":"w-full",n),children:e}),WOe=A.memo(function({quote:t,period:n,context:r="canonical"}){const s=!!t.afterHoursPrice&&n==="1d";mu("mini-graphs");const{isMobileStyle:a}=Be(),o=a&&s?"sm":"lg",i=f.useMemo(()=>zOe(t.history,n),[t.history,n]),c=f.useMemo(()=>l.jsx(qOe,{variant:o,price:t.price,currency:t.currency,change:t.historicalChange,percentChange:t.historicalPercentChange,period:n??void 0,timestamp:t.timestamp,open:t.isMarketOpen,closes:t.exchange!=="CRYPTO",timezone:t.exchangeTimezone??void 0,startDate:i.startDate,endDate:i.endDate}),[t,o,n,i]),u=f.useMemo(()=>l.jsx($Oe,{price:t.afterHoursPrice,change:t.afterHoursChange,percentChange:t.afterHoursPercentChange,timestamp:t.afterHoursTimestamp,currency:t.currency,timezone:t.exchangeTimezone??void 0,variant:o,afterHoursType:t.afterHoursType??null}),[t,o]);return l.jsx(Y,{variant:"raised",className:z("relative",r==="thread"?"border-t rounded-none":"border-x border-b-0 border-t rounded-b-none rounded-t-xl"),children:l.jsxs(Y,{className:"flex",children:[l.jsx(a8,{grow:s,className:s?"border-r border-subtlest":void 0,children:c}),s&&l.jsx(a8,{grow:!0,children:u})]})})}),KOe=Me({"1min":{defaultMessage:"1 min",id:"D2/3tXpws9"},"5min":{defaultMessage:"5 min",id:"TVHUbnv1cj"},"15min":{defaultMessage:"15 min",id:"OOAN7GDaOG"},"30min":{defaultMessage:"30 min",id:"z+jvO3E6rw"},"1hour":{defaultMessage:"1 hour",id:"68LTymxJcs"},"4hour":{defaultMessage:"4 hours",id:"SiO/3GrQZY"},"1day":{defaultMessage:"1 day",id:"+7PjfVlUMl"},"1week":{defaultMessage:"1 week",id:"LTNKL8T1Dn"},"1month":{defaultMessage:"1 month",id:"p1dNdsvErg"}}),YOe=f.memo(function({availableIntervals:t,currentInterval:n,setInterval:r}){const{$t:s}=Q(),a=f.useCallback(o=>{r(o)},[r]);return!t?.length||!n?null:l.jsxs("div",{children:[l.jsx(B,{variant:"smallBold",className:"pb-sm px-xs",children:s({defaultMessage:"Price Interval",id:"okQNyMzaX6"})}),l.jsx(Y,{children:l.jsx(Ba.Root,{value:n,onChange:a,className:"flex items-center w-fit",id:"interval",children:t.map(o=>l.jsx(Ba.Item,{value:o,children:l.jsx(B,{variant:"tiny",color:n===o?"default":"light",className:"whitespace-nowrap",children:s(KOe[o])})},o))})})]})});function QOe(e,t){return Se.makeEphemeralQueryKey("finance/peers",e,t)}async function XOe({symbol:e,headers:t,index:n}){const{data:r,error:s,response:a}=await ve.GET("/rest/finance/peers/{market_identifier}",Ty,{params:{path:{market_identifier:e},query:{with_index:n}},headers:t,timeoutMs:ky,numRetries:My});if(s)throw new Ue("API_CLIENTS_ERROR",{cause:s,status:a.status??0});return r}const ZOe=[],JOe=7,eLe=s9e.map(e=>({text:UH[e],value:e})),IG=e=>{const[t,n]=e.split("~");return t&&n?{type:"range",range:{start:t,end:n}}:{type:"period",period:t}},tLe=({symbol:e,period:t,interval:n})=>({prefix:"finance/chart",symbol:e,historyPeriod:t,withHistory:!0,historyAfterHours:["1d","5d","1m"].includes(t),historyRedirect:!0,historyInterval:n,withUiHints:!0}),nLe=(e,t,n,r)=>{const s=f.useRef(new Set),a=!n,o=It();f.useEffect(()=>{s.current.has(e)||!a||r?.length},[e,a,r,o,t])},rLe=(e,t,n,r)=>{const s=f.useMemo(()=>r3(tLe({symbol:e,period:n,interval:r})),[n,r,e]),a=gt({queryKey:s,queryFn:async()=>{const o=IG(n);if(o.type==="range"){const c=await _l({symbol:e,historyPeriod:void 0,historyStartDate:o.range.start,historyEndDate:o.range.end,historyInterval:r,historyRedirect:!0,withHistory:!0,historyAfterHours:Math.abs(o9e(o.range.start,o.range.end))<30});return{quote:c,interval:c?.uiHints?.currentInterval??null,period:c?.uiHints?.currentPeriod??n,pendingPeriod:void 0}}const i=await _l({symbol:e,historyPeriod:o.period,withHistory:!0,historyAfterHours:["1d","5d","1m"].includes(o.period),historyRedirect:!0,historyInterval:r,withUiHints:!0,historyStartDate:void 0,historyEndDate:void 0});return{quote:i,interval:i?.uiHints?.currentInterval??r,period:i?.uiHints?.currentPeriod??n,pendingPeriod:void 0}},refetchInterval:o=>{const i=o.state.data?.quote?.uiHints?.refetchIntervalSecs??t?.uiHints?.refetchIntervalSecs;return i?i*1e3:5e3},staleTime:1/0,placeholderData:o=>{if(o)return{...o,interval:r??o.interval,period:o.period??n,pendingPeriod:n};if(t)return{quote:t,interval:r,period:t?.uiHints?.currentPeriod??n,pendingPeriod:void 0}}});return nLe(e,n,a.isLoading,a.data?.quote?.uiHints?.availablePeriods),{isLoading:a.isLoading||a.isPlaceholderData,quote:a.data?.quote??null,interval:a.data?.interval??null,period:a.data?.period??null,pendingPeriod:a.data?.pendingPeriod}},sLe=(e,t,n,r)=>{const s=It(),a=gt({queryKey:Se.makeEphemeralQueryKey("finance/comparison",t,...e),queryFn:async()=>{const o=IG(t),i=e.map(async d=>{if(o.type==="range")return await s.ensureQueryData({queryKey:Se.makeEphemeralQueryKey("finance/history",d,o.range.start,o.range.end),queryFn:()=>_l({symbol:d,historyPeriod:void 0,historyStartDate:o.range.start,historyEndDate:o.range.end,historyAfterHours:!1,historyRedirect:!1,withUiHints:!0,withHistory:!0}),staleTime:3e4});const m={prefix:"finance/comparison",symbol:d,historyPeriod:o.period,withHistory:!0,historyRedirect:!1,historyAfterHours:!1};return await s.ensureQueryData({queryKey:r3(m),queryFn:()=>_l(m),staleTime:3e4})});return{quotes:(await Promise.all(i))?.filter(d=>!!d)?.map((d,m)=>({...d,color:sf(m,r)}))??[],period:t,pendingPeriod:void 0}},placeholderData:o=>{if(o)return{...o,period:o.period??t,pendingPeriod:t}},refetchInterval:3e4,enabled:n});return{isLoading:a.isLoading,quotes:a.data?.quotes??ZOe,period:a.data?.period??null,pendingPeriod:a.data?.pendingPeriod??void 0}},aLe=e=>{const t=sr(),n=Mo(t),r=nn();f.useEffect(()=>{t&&n&&t!==n&&!r?.get("comparing")&&e([])},[t,n,r,e])},oLe=(e,t,n,r)=>{const s=nn(),a=hn(),o=f.useCallback(w=>{const S=new URLSearchParams(window.location.search);S.set("comparing",w.join(",")),a.replace(`?${S.toString()}`)},[a]),[i,c]=f.useState(s?.get("comparing")?.split(",")??r??[]),u=f.useMemo(()=>[e,...i.filter(w=>w!==e)],[i,e]),d=u.length>1,[m,p]=f.useState({}),h=f.useCallback(w=>{w.symbol&&c(S=>{const E=[...new Set([e,...S,w.symbol])];return E.length>JOe&&E.splice(-2,1),o(E),p(T=>({...Object.fromEntries(Object.entries(T).filter(([k])=>E.includes(k))),[w.symbol]:w})),E})},[c,p,e,o]),g=f.useCallback(w=>{c(S=>{const E=S.filter(T=>T!==w);return o(E),E}),p(S=>{const E={...S};return delete E[w],E})},[c,p,o]),y=f.useCallback(()=>{c([])},[]);aLe(c);const b=sLe(u,t,d,n),{comparisonQuotes:x,setHoveredComparisons:_}=lLe(u,b.quotes,m,n),v=iLe(e,u);return{peers:f.useMemo(()=>v.data.filter(w=>!u.includes(w.symbol)),[v.data,u]),isComparing:d,quotes:b.quotes,comparisonQuotesLoading:b.isLoading,comparisonQuotes:x,setHoveredComparisons:_,addComparison:h,removeComparison:g,resetComparisons:y,period:b.period,pendingPeriod:b.pendingPeriod}},iLe=(e,t)=>{const{data:n,isLoading:r,isPlaceholderData:s}=gt({queryKey:QOe(e,!0),queryFn:()=>XOe({symbol:e,index:!0}),placeholderData:Ja}),a=f.useMemo(()=>n?.filter(o=>!t.some(i=>i===o.symbol)&&o.symbol!==e)??[],[n,t,e]);return f.useMemo(()=>({data:a,isLoading:r||s}),[a,r,s])},lLe=(e,t,n,r)=>{const[s,a]=f.useState([]),o=f.useMemo(()=>e.map((d,m)=>{const p=t.find(g=>g.symbol===d)??n[d];return p?{symbol:p.symbol,name:p.name,image:p.image,imageDark:p.imageDark,exchange:p.exchange,currency:p.currency||void 0,price:p.price,exchangeTimezone:p.exchangeTimezone,historicalChange:p.historicalChange,historicalPercentChange:p.historicalPercentChange,color:sf(m,r)}:{symbol:d,loading:!0,color:sf(m,r)}}),[e,t,n,r]),i=f.useMemo(()=>s.map((u,d)=>({...u,color:sf(d,r)})),[s,r]),c=i.length>0?i:o;return f.useMemo(()=>({comparisonQuotes:c,setHoveredComparisons:a}),[c,a])},jG=(e,t)=>f.useMemo(()=>{const n=e?.length?e:eLe.map(s=>s.value);return(t?n.filter(s=>s!=="5d"):n).map(s=>({text:UH[s],value:s}))},[e,t]),cLe=({children:e,context:t})=>l.jsx(Y,{noBorder:!0,className:z("overflow-hidden border-t border-subtlest",t==="thread"?"rounded-none":"border-b rounded-b-xl"),children:e}),o8=({symbol:e,comparisons:t,initialQuote:n,fullscreen:r,setFullscreen:s,chartHeight:a=225,zoomable:o=!0,context:i="canonical"})=>{const{isMobileStyle:c}=Be(),u=nn(),d=u?.get("period"),m=u?.get("interval"),[p,h]=f.useState(m??n?.uiHints?.currentInterval??null),[g,y]=f.useState(d??n?.uiHints?.currentPeriod??"1d"),[b,x]=f.useState(null),[_,v]=f.useState(!1),C=c?null:b,w=AG(),S=rLe(e,n,g,p),E=oLe(e,g,w,t),T=!_&&E.isComparing,k=jG(S.quote?.uiHints?.availablePeriods,E.isComparing),M=eOe(),{variant:N,containerRef:P}=o8e({isMobileStyle:c});return S.quote?l.jsxs(Y,{className:"flex flex-col",children:[l.jsx(WOe,{quote:S.quote,period:T?E.period:S.period,context:i}),l.jsxs(Y,{variant:"raised",className:z("relative",i==="thread"?"border-y rounded-none":z("border-x border-t rounded-t-none rounded-b-xl",r&&"border-b")),children:[l.jsxs(Y,{className:"gap-y-sm relative flex flex-col justify-between",children:[l.jsxs(uLe,{isLoading:S.isLoading,children:[!T&&l.jsx(kG,{id:`history-chart-${e}`,quote:S.quote,technical:!0,height:a,candlestick:_,indicators:M,watermark:l.jsx(vg,{}),zoomable:o}),T&&l.jsx(TOe,{quotes:E.quotes,focused:C,height:a,setHoveredComparisons:E.setHoveredComparisons,watermark:l.jsx(vg,{})})]}),l.jsxs(Y,{ref:P,className:"z-1 p-sm absolute inset-x-0 top-0 flex justify-between items-stretch",children:[l.jsxs(Y,{className:"gap-sm flex flex-start",children:[l.jsx(g5,{id:e,periods:k,period:T?E.pendingPeriod??E.period:S.pendingPeriod??S.period,setPeriod:y,calendar:!0,variant:N}),l.jsx(ROe,{id:e,candlestick:_,setCandlestick:v}),!_&&l.jsx(IOe,{peers:E.peers,addComparison:E.addComparison}),!T&&l.jsxs(nOe,{children:[l.jsx(YOe,{setInterval:h,availableIntervals:S.quote?.uiHints?.availableIntervals,currentInterval:S.interval}),l.jsx(rOe,{history:S.quote.history,indicators:M})]})]}),l.jsxs("div",{className:"gap-sm flex items-center justify-center",children:[!T&&l.jsx(u9e,{quote:S.quote,animationId:e,period:T?E.period:S.period}),s&&!c&&l.jsx(sOe,{setFullscreen:s,fullscreen:r})]})]})]}),T&&l.jsx(cLe,{context:i,children:l.jsx(NOe,{comparisons:E.comparisonQuotes,removeComparison:E.removeComparison,setFocused:x})}),!T&&!r&&l.jsx(a8e,{quote:S.quote,context:i})]})]}):null},uLe=A.memo(function({children:t,isLoading:n}){return l.jsx(ze.div,{initial:{opacity:1},animate:{opacity:n?.5:1},transition:{duration:.5,delay:.5},style:{paddingTop:Tf+16+20},className:"relative overflow-hidden",children:t})}),dLe={variant:"secondary",size:"small"},PG=({quote:e})=>{const{session:t}=je(),{trackEvent:n}=Ze(t),r=f.useCallback(()=>{n("finance link clicked",{referrer:Ly.SEARCH_WIDGET,targetPageType:Nm.ASSET_PAGE,symbol:e.symbol,destinationUrl:`/finance/${e.symbol}`})},[n,e.symbol]);return e?l.jsx(Dt,{href:`/finance/${e.symbol}`,className:"gap-md hover:bg-subtler p-sm -mx-sm flex cursor-pointer items-center rounded-md transition-all active:scale-95 min-w-0",onClick:r,children:l.jsxs(Y,{className:"gap-sm flex items-center min-w-0 flex-1",children:[l.jsx(Am,{symbol:e.symbol,src:e.image??"",srcDark:e.imageDark??"",className:"shrink-0"}),l.jsxs(Y,{className:"min-w-0 flex-1",children:[l.jsx(Y,{className:"gap-sm flex items-center min-w-0",children:l.jsx(S3,{name:e.name})}),l.jsx(B,{variant:"tinyMono",color:"light",className:"truncate",children:l.jsx(Rm,{symbol:e.symbol,exchange:e.exchange,country:e.exchangeCountry})})]})]})}):null},fLe=({quotes:e})=>l.jsx(Y,{className:"scrollbar-none overflow-x-auto flex-1 min-w-0",children:l.jsx(Y,{className:"gap-md flex items-center min-w-0",children:e.map(t=>l.jsx(PG,{quote:t},t.symbol))})}),i8=({href:e,symbol:t})=>{const{isMobileStyle:n}=Be(),{$t:r}=Q(),{session:s}=je(),{trackEvent:a}=Ze(s),o=f.useCallback(()=>{a("finance link clicked",{referrer:Ly.SEARCH_WIDGET,targetPageType:Nm.ASSET_PAGE,symbol:t,destinationUrl:e})},[a,t,e]);return l.jsx(Y,{className:"gap-sm flex items-center justify-center",children:l.jsx(st,{variant:"primaryGhost",chevron:!0,chevronIcon:D("chevron-right"),text:r({defaultMessage:"Deep Dive on {pplxFinance}",id:"QX457HdJyA"},{pplxFinance:"Perplexity Finance"}),size:"small",href:e,onClick:o,fullWidth:n})})},l8=({children:e})=>l.jsx(Y,{className:"gap-sm shadow-subtle flex flex-col rounded-xl border",variant:"background",children:e}),mLe=A.memo(function({quotes:t}){const n=t[0],r=f.useMemo(()=>t.slice(1).map(a=>a.symbol),[t]);if(!n)return null;const s=n.symbol;return r?.length?l.jsxs(l8,{children:[l.jsx("div",{className:"gap-sm px-md pt-sm flex items-center justify-between",children:l.jsx(fLe,{quotes:t})}),l.jsx(o8,{symbol:s,comparisons:r,chartHeight:Lm,context:"thread"}),l.jsx(Y,{className:"px-sm pb-sm",children:l.jsx(i8,{href:`/finance/${n?.symbol}?comparing=${r.join(",")}`,symbol:s})})]}):l.jsxs(l8,{children:[l.jsxs(Y,{className:"px-md pt-sm flex items-start justify-between gap-sm min-w-0",children:[l.jsx("div",{className:"flex min-w-0 flex-1",children:l.jsx(PG,{quote:n})}),l.jsxs(Y,{className:"gap-xs flex items-center shrink-0",children:[l.jsx(EH,{symbol:s,button:kH}),l.jsx(uv,{symbol:s,buttonProps:dLe})]})]}),l.jsx(o8,{symbol:s,initialQuote:n,chartHeight:225,zoomable:!1,context:"thread"}),l.jsx(Y,{className:"px-sm pb-sm",children:l.jsx(i8,{href:`/finance/${n?.symbol}`,symbol:s})})]})}),c8=new Set,OG=A.memo(function({data:t}){const{result:{backend_uuid:n,mode:r}}=Pt(),s=im(),a=FC();return f.useEffect(()=>{const o=t.data?.length||t.data_v2?.length;!n||!o||c8.has(n)||(s("web.frontend.finance_widgets_render_time",{widgetType:"finance",widgetName:t.data_v2?.length?"stock_v2":"stock_v1",queryMode:r,widgetSize:"full"}),c8.add(n))},[t.data,t.data_v2,n,r,s,a]),t.data_v2?.length?l.jsx(ar,{fallback:null,onError:o=>Z.error("FinanceWidget failed to render",{cause:o}),children:l.jsx(ss,{widgetType:"finance",widgetName:"stock_v2",children:l.jsx(mLe,{quotes:t.data_v2})})}):null}),pLe=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"news-ui",defaultValue:e,extraAttributes:t,subjectType:"visitor_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},LG=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"news-tab",defaultValue:e,extraAttributes:t,subjectType:"visitor_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},hLe="w-[166px]",gLe=A.memo(function({variant:t,onTrackEvent:n,href:r,fullWidth:s,showBorder:a,title:o,isAttachment:i,domainName:c,publishedDate:u,thumbnailUrl:d,articlePreview:m,className:p}){const{$t:h}=Q(),g=f.useMemo(()=>({color:"light"}),[]);return t=="desktop"||t=="desktop-large"?l.jsx(V5,{href:r,rel:"noopener",onTrackEvent:n,className:z("group",p,{"col-span-full":s,"row-span-3":t=="desktop-large"}),children:l.jsx("div",{className:z({"pb-md border-subtlest border-b":a,"h-full border-box":t=="desktop-large"}),children:l.jsxs("div",{className:z("gap-md flex h-24 flex-row",{"flex-col h-full":t=="desktop-large"}),children:[l.jsxs("div",{className:z("flex flex-1 flex-col min-w-0",{"order-2":t=="desktop-large"}),children:[l.jsx(B,{variant:t=="desktop-large"?"base":"small",lineClamp:3,className:"group-hover:!text-super transition-colors duration-200 font-medium visRefresh2026Fonts:font-editorial visRefresh2026Fonts:!leading-normal visRefresh2026Fonts:!tracking-normal",children:o}),m&&t=="desktop-large"&&l.jsx(B,{lineClamp:3,className:"mt-xs",variant:"small",children:m}),l.jsxs("div",{className:"flex items-center mt-auto",children:[l.jsx(gl,{variant:"tinyRegular",color:"light",url:r,isAttachment:i,source:c,className:"leading-normal"}),l.jsxs(B,{variant:"tiny",color:"light",className:"flex shrink-0 truncate",children:[l.jsx("span",{children:""}),l.jsx(ug,{recentlyUpdatedLabel:h({defaultMessage:"just now",id:"I90sbWU03C"}),timestamp:u,timestampProps:g,includeIcon:!1})]})]})]}),d&&l.jsx(u8,{src:d,alt:"",className:z("aspect-[4/3] w-32 shrink-0",{"order-1 w-full !aspect-[2/1]":t=="desktop-large"})})]})})}):l.jsx(V5,{href:r,rel:"noopener",onTrackEvent:n,children:l.jsxs(Xn,{className:z("flex h-full cursor-pointer flex-col gap-2 rounded-lg p-1","border",`${hLe} flex-shrink-0`),children:[d&&l.jsx(u8,{src:d,alt:"",className:"h-32 w-full"}),l.jsx(Y,{className:"flex min-h-[60px] flex-1 flex-col justify-between p-2 pt-1",children:l.jsxs(Y,{className:"flex flex-1 flex-col",children:[l.jsx(B,{lineClamp:3,variant:"small",children:o}),l.jsx("div",{className:"mt-auto py-2",children:l.jsx(B,{variant:"tiny",color:"light",className:"gap-x-xs flex",children:l.jsx(ug,{recentlyUpdatedLabel:h({defaultMessage:"just now",id:"I90sbWU03C"}),timestamp:u,timestampProps:g,includeIcon:!1})})}),l.jsx(gl,{variant:"tinyRegular",color:"light",url:r,isAttachment:i,source:c})]})})]})})}),u8=A.memo(function({src:t,alt:n,className:r}){const[s,a]=f.useState(!1);return l.jsx(Y,{className:z("relative overflow-hidden rounded-md",r,{hidden:s}),children:s?null:l.jsx("img",{src:t,alt:n,className:"size-full object-cover",loading:"lazy",onError:()=>a(!0)})})}),FG=({widgetType:e,widgetName:t,hasData:n,metricName:r})=>{const{result:{mode:s}}=Pt(),a=yE();f.useEffect(()=>{if(!n)return;const o=r??`web.frontend.${e}_widget_render_time`;a(o,{widgetType:e,widgetName:t,queryMode:s})},[n,e,t,r,s,a])},fC=e=>e.meta_data,yLe=Pe(async()=>{const{CitationListModal:e}=await W(async()=>{const{CitationListModal:t}=await import("./CitationListModal-4_bfX56k.js");return{CitationListModal:t}},__vite__mapDeps([411,2,3,5,1,412,6,7,8,9,15,34,35,36,13,12,14,16,17]));return{default:e}}),xLe=12,bLe=new Array(3).fill(null),_Le="w-[166px]",vLe=A.memo(function({showSkeletonUnits:t,results:n,entryUUID:r,frontendContextUUID:s,contextUUID:a}){const{isMobileStyle:o}=Be(),{openModal:i}=Kt(),{session:c}=je(),{trackEvent:u}=Ze(c),{$t:d}=Q(),{variation:m}=LG(!1),{setActiveThreadTab:p,handleTabScrollBehavior:h}=Oo();FG({widgetType:"news",widgetName:"news",hasData:n.length>0});const g=f.useCallback(()=>{u("clicked news results see more",{entryUUID:r,frontendContextUUID:s,contextUUID:a}),i(yLe,{webResults:n,citationType:"articles"})},[i,n,u,r,s,a]),y=f.useCallback(()=>{u("clicked news results see more",{entryUUID:r,frontendContextUUID:s,contextUUID:a}),h("news"),p("news")},[u,r,s,a,h,p]),b=f.useMemo(()=>[...n.filter(_=>{const v=fC(_);return v?.images&&v.images.length>0}),...n.filter(_=>{const v=fC(_);return!v?.images||v.images.length===0})],[n]),x=f.useMemo(()=>b.length===3?2:Math.min(4,b.length),[b]);return o?l.jsxs(Y,{className:z("gap-sm","-mx-pageHorizontalPadding px-pageHorizontalPadding scrollbar-none grid auto-cols-max grid-flow-col overflow-x-auto"),children:[b.slice(0,xLe).map((_,v)=>l.jsx(d8,{result:_,idx:v,variant:"mobile",entryUUID:r,frontendContextUUID:s,contextUUID:a},`${_.url}-${_.timestamp}`)),t&&bLe.map((_,v)=>l.jsx(Y,{variant:"subtler",className:`h-16 ${_Le} flex-shrink-0 rounded-lg`},v))]}):l.jsxs("div",{className:"gap-sm flex flex-col",children:[l.jsxs("div",{className:"gap-x-xl gap-y-md mb-md relative grid grid-cols-2",children:[b.slice(0,x).map((_,v)=>l.jsx(d8,{result:_,idx:v,variant:"desktop",showBorder:v<x-2&&x>2,entryUUID:r,frontendContextUUID:s,contextUUID:a},`${_.url}-${_.timestamp}`)),x>1&&l.jsx("div",{className:"border-subtlest absolute inset-y-0 left-1/2 w-0 border-l"})]}),l.jsx(LO,{onClick:m?y:g,label:d({defaultMessage:"See more news",id:"2MUZ4GQuje"})})]})}),d8=A.memo(function({result:t,idx:n,variant:r,showBorder:s,fullWidth:a,entryUUID:o,frontendContextUUID:i,contextUUID:c}){const{session:u}=je(),{trackEvent:d,trackEventOnce:m}=Ze(u),p=FO({trackEvent:d,entryUUID:o,frontendContextUUID:i,contextUUID:c}),h=fC(t);f.useEffect(()=>{m("news source viewed",{url:t.url??"",title:t.name??"",position:n,entryUUID:o,frontendContextUUID:i,contextUUID:c,domain_name:h?.domain_name})},[m,t.url,t.name,h?.domain_name,n,o,i,c]);const g=f.useMemo(()=>()=>{p("news source clicked",{citation_url:t.url??"",citation_index:n})},[t,p,n]),y=h?.images?.[0];return l.jsx(gLe,{variant:r,onTrackEvent:g,href:t.url??"",fullWidth:a,showBorder:s,title:t.name??"",isAttachment:t.is_attachment??!1,domainName:h?.domain_name??"",publishedDate:h?.published_date??"",thumbnailUrl:y??""})}),CLe={about:D("user"),born:D("calendar-event"),age:D("calendar-event"),died:D("calendar-event"),parents:D("users-group"),siblings:D("users-group"),children:D("baby-carriage"),spouse:D("heart"),spouses:D("heart"),education:D("school"),educated_at:D("school"),net_worth:D("cash-banknote"),ratings:D("star"),directed_by:D("movie"),starring:D("user"),watch_on:D("player-play"),treatment:D("medicine-syrup"),symptoms:D("clipboard-heart"),specialists:D("stethoscope")};function wLe(e){return e&&CLe[e]||null}const f8={EXTERNAL_LINK_TYPE_UNSPECIFIED:D("external-link"),PRIMARY:D("external-link"),WIKIPEDIA:D("brand-wikipedia"),X:D("brand-x"),INSTAGRAM:D("brand-instagram"),TIKTOK:D("brand-tiktok"),YOUTUBE:D("brand-youtube"),FACEBOOK:D("brand-facebook"),MAYOCLINIC:D("building"),IMDB:D("brand-windows")};function m8(e){return e?f8[e]:f8.EXTERNAL_LINK_TYPE_UNSPECIFIED}const UG=Bt("PanelContext",{menuItems:void 0}),Gu=()=>{const e=f.useContext(UG);if(!e)throw new Error("usePanel must be used within PanelContext");return e},In=({children:e,menuItems:t,variant:n,className:r})=>l.jsx(ar,{fallback:null,children:l.jsx(UG.Provider,{value:{menuItems:t},children:n==="noChrome"?l.jsx(Y,{className:r,children:e}):l.jsx(Xn,{shadow:!0,className:z(r,"p-md"),children:e})})}),SLe=({menuItems:e,buttonClass:t,placement:n})=>{const{isMobileStyle:r}=Be();return e.length<=0?null:l.jsx(bu,{items:e,isMobileStyle:r,placement:n,children:l.jsx(pt,{size:"tiny",pill:!0,icon:D("dots"),extraCSS:t})})},ELe=({title:e,href:t,subtitle:n,image_url:r,links:s,children:a,entryUUID:o,data:i})=>{const{session:c}=je(),{trackEvent:u}=Ze(c),d=f.useCallback(m=>{u("knowledge card link clicked",{label:"social media",socialMediaType:m.type,value:m.url??"",entryUUID:o,type:i?.type??"",name:i?.title??"",id:i?.source_url??""})},[i?.source_url,i?.title,i?.type,o,u]);return l.jsx(Y,{className:"gap-sm flex w-full justify-between",children:l.jsxs("div",{className:"gap-md flex grow items-start",children:[r?l.jsx("div",{className:"flex-none",children:l.jsx(to,{imageClassName:"size-[120px] object-cover object-top",rounded:"md",src:r,alt:e,includeLightBoxModal:!1})}):null,l.jsxs("div",{className:"flex h-full grow flex-col",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"gap-sm mb-two flex items-start",children:[l.jsx(B,{variant:"section-title",className:"flex-1",children:t?l.jsx(Dt,{href:t,target:"_blank",className:"hover:text-super flex-1 duration-150",children:e}):e}),a]}),n&&l.jsx(B,{variant:"small",className:"mb-sm mr-sm text-pretty",children:n})]}),s&&s.length>0&&l.jsx("div",{className:"gap-sm flex flex-wrap",children:s.map(m=>l.jsx(kLe,{link:m,solo:s.length===1,handleLinkClick:d},m.type))})]})]})})},kLe=A.memo(function({link:t,solo:n,handleLinkClick:r}){const s=f.useCallback(()=>r(t),[r,t]);return n?l.jsx(st,{icon:m8(t.type),text:t.title,textClassName:"font-normal ml-2xs text-quiet ",size:"tiny",href:t.url,target:"_blank",onClick:s},t.url):l.jsx(st,{icon:m8(t.type),size:"tiny",href:t.url,target:"_blank",onClick:s},t.type)}),MLe=({name:e,title:t,value:n})=>{const r=wLe(e);return l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"gap-sm flex min-w-[120px]",children:[r&&l.jsx(B,{variant:"smallBold",color:"light",className:"w-5",children:l.jsx(ye,{icon:r,size:"sm"})}),l.jsx(B,{variant:"smallBold",color:"light",children:t})]}),l.jsx(B,{variant:"small",children:n})]})},TLe=({children:e})=>l.jsx(Y,{className:"pt-sm px-md border-t",children:e});In.Title=ELe;In.Item=MLe;In.Menu=SLe;In.Footer=TLe;const ALe=A.memo(function({graphData:t}){const[n,r]=f.useState(!1),s=t.url??"",a=t.name??"",o=f.useCallback(()=>r(!1),[]);return l.jsxs("div",{className:"flex justify-center",children:[l.jsx("img",{src:s,alt:a,className:"max-h-[50vh] overflow-hidden rounded align-middle",onClick:()=>r(!0)}),l.jsx(NLe,{isOpen:n,onClose:o,alt:a,src:s})]})}),NLe=A.memo(function({isOpen:t,onClose:n,alt:r,src:s}){const a=f.useCallback(()=>n(!1),[n]);return l.jsxs(IN,{onClose:a,isOpen:t,variant:"hide-chrome",disableAnimation:!1,children:[l.jsx("div",{className:"flex place-content-center",onClick:()=>n(!1),children:l.jsx("div",{className:"gap-xs p-md md:p-xl flex flex-col items-center justify-between",children:l.jsx("div",{className:"grow",children:l.jsx("img",{alt:r,src:s,className:"max-h-[50vh]"})})})}),l.jsx(st,{onClick:a,icon:D("x"),extraCSS:"!fixed top-md right-md shadow-sm",size:"small",pill:!0,ariaLabel:"Close"})]})}),RLe=A.memo(function({graphData:t}){return l.jsxs(In,{className:"gap-md bg-subtler p-md flex flex-col rounded-md text-center",children:[l.jsx(In.Title,{title:t.name??"",subtitle:""}),l.jsx(ALe,{graphData:t})]})}),DLe=A.memo(function(t){const{data:n}=t,{menuItems:r}=Gu();return n?.result==null?null:l.jsx(ss,{widgetType:"calculator",widgetName:"calculator",children:l.jsx(Y,{className:"flex",children:l.jsxs("div",{className:"flex w-full items-center",children:[l.jsx(B,{color:"light",variant:"smallBold",children:l.jsx(ye,{className:"mt-two text-2xl leading-none",icon:D("calculator"),size:"sm"})}),l.jsx(B,{children:l.jsx(Y,{className:"pl-md font-mono text-2xl",children:IW(n.result)})}),r&&r.length>0&&l.jsx("div",{className:"flex grow items-start justify-end",children:l.jsx(In.Menu,{menuItems:r})})]})})})});function Ro(e){return Array.isArray?Array.isArray(e):VG(e)==="[object Array]"}function ILe(e){if(typeof e=="string")return e;let t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function jLe(e){return e==null?"":ILe(e)}function Oa(e){return typeof e=="string"}function BG(e){return typeof e=="number"}function PLe(e){return e===!0||e===!1||OLe(e)&&VG(e)=="[object Boolean]"}function HG(e){return typeof e=="object"}function OLe(e){return HG(e)&&e!==null}function cs(e){return e!=null}function d2(e){return!e.trim().length}function VG(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const LLe="Incorrect 'index' type",FLe=e=>`Invalid value for key ${e}`,ULe=e=>`Pattern length exceeds max of ${e}.`,BLe=e=>`Missing ${e} property in key`,HLe=e=>`Property 'weight' in key '${e}' must be a positive integer`,p8=Object.prototype.hasOwnProperty;class VLe{constructor(t){this._keys=[],this._keyMap={};let n=0;t.forEach(r=>{let s=GG(r);this._keys.push(s),this._keyMap[s.id]=s,n+=s.weight}),this._keys.forEach(r=>{r.weight/=n})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function GG(e){let t=null,n=null,r=null,s=1,a=null;if(Oa(e)||Ro(e))r=e,t=h8(e),n=mC(e);else{if(!p8.call(e,"name"))throw new Error(BLe("name"));const o=e.name;if(r=o,p8.call(e,"weight")&&(s=e.weight,s<=0))throw new Error(HLe(o));t=h8(o),n=mC(o),a=e.getFn}return{path:t,id:n,weight:s,src:r,getFn:a}}function h8(e){return Ro(e)?e:e.split(".")}function mC(e){return Ro(e)?e.join("."):e}function GLe(e,t){let n=[],r=!1;const s=(a,o,i)=>{if(cs(a))if(!o[i])n.push(a);else{let c=o[i];const u=a[c];if(!cs(u))return;if(i===o.length-1&&(Oa(u)||BG(u)||PLe(u)))n.push(jLe(u));else if(Ro(u)){r=!0;for(let d=0,m=u.length;d<m;d+=1)s(u[d],o,i+1)}else o.length&&s(u,o,i+1)}};return s(e,Oa(t)?t.split("."):t,0),r?n:n[0]}const zLe={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},qLe={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1},$Le={location:0,threshold:.6,distance:100},WLe={useExtendedSearch:!1,getFn:GLe,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var vt={...qLe,...zLe,...$Le,...WLe};const KLe=/[^ ]+/g;function YLe(e=1,t=3){const n=new Map,r=Math.pow(10,t);return{get(s){const a=s.match(KLe).length;if(n.has(a))return n.get(a);const o=1/Math.pow(a,.5*e),i=parseFloat(Math.round(o*r)/r);return n.set(a,i),i},clear(){n.clear()}}}class x5{constructor({getFn:t=vt.getFn,fieldNormWeight:n=vt.fieldNormWeight}={}){this.norm=YLe(n,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((n,r)=>{this._keysMap[n.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Oa(this.docs[0])?this.docs.forEach((t,n)=>{this._addString(t,n)}):this.docs.forEach((t,n)=>{this._addObject(t,n)}),this.norm.clear())}add(t){const n=this.size();Oa(t)?this._addString(t,n):this._addObject(t,n)}removeAt(t){this.records.splice(t,1);for(let n=t,r=this.size();n<r;n+=1)this.records[n].i-=1}getValueForItemAtKeyId(t,n){return t[this._keysMap[n]]}size(){return this.records.length}_addString(t,n){if(!cs(t)||d2(t))return;let r={v:t,i:n,n:this.norm.get(t)};this.records.push(r)}_addObject(t,n){let r={i:n,$:{}};this.keys.forEach((s,a)=>{let o=s.getFn?s.getFn(t):this.getFn(t,s.path);if(cs(o)){if(Ro(o)){let i=[];const c=[{nestedArrIndex:-1,value:o}];for(;c.length;){const{nestedArrIndex:u,value:d}=c.pop();if(cs(d))if(Oa(d)&&!d2(d)){let m={v:d,i:u,n:this.norm.get(d)};i.push(m)}else Ro(d)&&d.forEach((m,p)=>{c.push({nestedArrIndex:p,value:m})})}r.$[a]=i}else if(Oa(o)&&!d2(o)){let i={v:o,n:this.norm.get(o)};r.$[a]=i}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function zG(e,t,{getFn:n=vt.getFn,fieldNormWeight:r=vt.fieldNormWeight}={}){const s=new x5({getFn:n,fieldNormWeight:r});return s.setKeys(e.map(GG)),s.setSources(t),s.create(),s}function QLe(e,{getFn:t=vt.getFn,fieldNormWeight:n=vt.fieldNormWeight}={}){const{keys:r,records:s}=e,a=new x5({getFn:t,fieldNormWeight:n});return a.setKeys(r),a.setIndexRecords(s),a}function Up(e,{errors:t=0,currentLocation:n=0,expectedLocation:r=0,distance:s=vt.distance,ignoreLocation:a=vt.ignoreLocation}={}){const o=t/e.length;if(a)return o;const i=Math.abs(r-n);return s?o+i/s:i?1:o}function XLe(e=[],t=vt.minMatchCharLength){let n=[],r=-1,s=-1,a=0;for(let o=e.length;a<o;a+=1){let i=e[a];i&&r===-1?r=a:!i&&r!==-1&&(s=a-1,s-r+1>=t&&n.push([r,s]),r=-1)}return e[a-1]&&a-r>=t&&n.push([r,a-1]),n}const Yi=32;function ZLe(e,t,n,{location:r=vt.location,distance:s=vt.distance,threshold:a=vt.threshold,findAllMatches:o=vt.findAllMatches,minMatchCharLength:i=vt.minMatchCharLength,includeMatches:c=vt.includeMatches,ignoreLocation:u=vt.ignoreLocation}={}){if(t.length>Yi)throw new Error(ULe(Yi));const d=t.length,m=e.length,p=Math.max(0,Math.min(r,m));let h=a,g=p;const y=i>1||c,b=y?Array(m):[];let x;for(;(x=e.indexOf(t,g))>-1;){let E=Up(t,{currentLocation:x,expectedLocation:p,distance:s,ignoreLocation:u});if(h=Math.min(E,h),g=x+d,y){let T=0;for(;T<d;)b[x+T]=1,T+=1}}g=-1;let _=[],v=1,C=d+m;const w=1<<d-1;for(let E=0;E<d;E+=1){let T=0,k=C;for(;T<k;)Up(t,{errors:E,currentLocation:p+k,expectedLocation:p,distance:s,ignoreLocation:u})<=h?T=k:C=k,k=Math.floor((C-T)/2+T);C=k;let M=Math.max(1,p-k+1),N=o?m:Math.min(p+k,m)+d,P=Array(N+2);P[N+1]=(1<<E)-1;for(let L=N;L>=M;L-=1){let H=L-1,R=n[e.charAt(H)];if(y&&(b[H]=+!!R),P[L]=(P[L+1]<<1|1)&R,E&&(P[L]|=(_[L+1]|_[L])<<1|1|_[L+1]),P[L]&w&&(v=Up(t,{errors:E,currentLocation:H,expectedLocation:p,distance:s,ignoreLocation:u}),v<=h)){if(h=v,g=H,g<=p)break;M=Math.max(1,2*p-g)}}if(Up(t,{errors:E+1,currentLocation:p,expectedLocation:p,distance:s,ignoreLocation:u})>h)break;_=P}const S={isMatch:g>=0,score:Math.max(.001,v)};if(y){const E=XLe(b,i);E.length?c&&(S.indices=E):S.isMatch=!1}return S}function JLe(e){let t={};for(let n=0,r=e.length;n<r;n+=1){const s=e.charAt(n);t[s]=(t[s]||0)|1<<r-n-1}return t}class qG{constructor(t,{location:n=vt.location,threshold:r=vt.threshold,distance:s=vt.distance,includeMatches:a=vt.includeMatches,findAllMatches:o=vt.findAllMatches,minMatchCharLength:i=vt.minMatchCharLength,isCaseSensitive:c=vt.isCaseSensitive,ignoreLocation:u=vt.ignoreLocation}={}){if(this.options={location:n,threshold:r,distance:s,includeMatches:a,findAllMatches:o,minMatchCharLength:i,isCaseSensitive:c,ignoreLocation:u},this.pattern=c?t:t.toLowerCase(),this.chunks=[],!this.pattern.length)return;const d=(p,h)=>{this.chunks.push({pattern:p,alphabet:JLe(p),startIndex:h})},m=this.pattern.length;if(m>Yi){let p=0;const h=m%Yi,g=m-h;for(;p<g;)d(this.pattern.substr(p,Yi),p),p+=Yi;if(h){const y=m-Yi;d(this.pattern.substr(y),y)}}else d(this.pattern,0)}searchIn(t){const{isCaseSensitive:n,includeMatches:r}=this.options;if(n||(t=t.toLowerCase()),this.pattern===t){let g={isMatch:!0,score:0};return r&&(g.indices=[[0,t.length-1]]),g}const{location:s,distance:a,threshold:o,findAllMatches:i,minMatchCharLength:c,ignoreLocation:u}=this.options;let d=[],m=0,p=!1;this.chunks.forEach(({pattern:g,alphabet:y,startIndex:b})=>{const{isMatch:x,score:_,indices:v}=ZLe(t,g,y,{location:s+b,distance:a,threshold:o,findAllMatches:i,minMatchCharLength:c,includeMatches:r,ignoreLocation:u});x&&(p=!0),m+=_,x&&v&&(d=[...d,...v])});let h={isMatch:p,score:p?m/this.chunks.length:1};return p&&r&&(h.indices=d),h}}class ji{constructor(t){this.pattern=t}static isMultiMatch(t){return g8(t,this.multiRegex)}static isSingleMatch(t){return g8(t,this.singleRegex)}search(){}}function g8(e,t){const n=e.match(t);return n?n[1]:null}class eFe extends ji{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const n=t===this.pattern;return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class tFe extends ji{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const r=t.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,t.length-1]}}}class nFe extends ji{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const n=t.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class rFe extends ji{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const n=!t.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}}class sFe extends ji{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const n=t.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}class aFe extends ji{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const n=!t.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}}class $G extends ji{constructor(t,{location:n=vt.location,threshold:r=vt.threshold,distance:s=vt.distance,includeMatches:a=vt.includeMatches,findAllMatches:o=vt.findAllMatches,minMatchCharLength:i=vt.minMatchCharLength,isCaseSensitive:c=vt.isCaseSensitive,ignoreLocation:u=vt.ignoreLocation}={}){super(t),this._bitapSearch=new qG(t,{location:n,threshold:r,distance:s,includeMatches:a,findAllMatches:o,minMatchCharLength:i,isCaseSensitive:c,ignoreLocation:u})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class WG extends ji{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let n=0,r;const s=[],a=this.pattern.length;for(;(r=t.indexOf(this.pattern,n))>-1;)n=r+a,s.push([r,n-1]);const o=!!s.length;return{isMatch:o,score:o?0:1,indices:s}}}const pC=[eFe,WG,nFe,rFe,aFe,sFe,tFe,$G],y8=pC.length,oFe=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,iFe="|";function lFe(e,t={}){return e.split(iFe).map(n=>{let r=n.trim().split(oFe).filter(a=>a&&!!a.trim()),s=[];for(let a=0,o=r.length;a<o;a+=1){const i=r[a];let c=!1,u=-1;for(;!c&&++u<y8;){const d=pC[u];let m=d.isMultiMatch(i);m&&(s.push(new d(m,t)),c=!0)}if(!c)for(u=-1;++u<y8;){const d=pC[u];let m=d.isSingleMatch(i);if(m){s.push(new d(m,t));break}}}return s})}const cFe=new Set([$G.type,WG.type]);class uFe{constructor(t,{isCaseSensitive:n=vt.isCaseSensitive,includeMatches:r=vt.includeMatches,minMatchCharLength:s=vt.minMatchCharLength,ignoreLocation:a=vt.ignoreLocation,findAllMatches:o=vt.findAllMatches,location:i=vt.location,threshold:c=vt.threshold,distance:u=vt.distance}={}){this.query=null,this.options={isCaseSensitive:n,includeMatches:r,minMatchCharLength:s,findAllMatches:o,ignoreLocation:a,location:i,threshold:c,distance:u},this.pattern=n?t:t.toLowerCase(),this.query=lFe(this.pattern,this.options)}static condition(t,n){return n.useExtendedSearch}searchIn(t){const n=this.query;if(!n)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:s}=this.options;t=s?t:t.toLowerCase();let a=0,o=[],i=0;for(let c=0,u=n.length;c<u;c+=1){const d=n[c];o.length=0,a=0;for(let m=0,p=d.length;m<p;m+=1){const h=d[m],{isMatch:g,indices:y,score:b}=h.search(t);if(g){if(a+=1,i+=b,r){const x=h.constructor.type;cFe.has(x)?o=[...o,...y]:o.push(y)}}else{i=0,a=0,o.length=0;break}}if(a){let m={isMatch:!0,score:i/a};return r&&(m.indices=o),m}}return{isMatch:!1,score:1}}}const hC=[];function dFe(...e){hC.push(...e)}function gC(e,t){for(let n=0,r=hC.length;n<r;n+=1){let s=hC[n];if(s.condition(e,t))return new s(e,t)}return new qG(e,t)}const Fg={AND:"$and",OR:"$or"},yC={PATH:"$path",PATTERN:"$val"},xC=e=>!!(e[Fg.AND]||e[Fg.OR]),fFe=e=>!!e[yC.PATH],mFe=e=>!Ro(e)&&HG(e)&&!xC(e),x8=e=>({[Fg.AND]:Object.keys(e).map(t=>({[t]:e[t]}))});function KG(e,t,{auto:n=!0}={}){const r=s=>{let a=Object.keys(s);const o=fFe(s);if(!o&&a.length>1&&!xC(s))return r(x8(s));if(mFe(s)){const c=o?s[yC.PATH]:a[0],u=o?s[yC.PATTERN]:s[c];if(!Oa(u))throw new Error(FLe(c));const d={keyId:mC(c),pattern:u};return n&&(d.searcher=gC(u,t)),d}let i={children:[],operator:a[0]};return a.forEach(c=>{const u=s[c];Ro(u)&&u.forEach(d=>{i.children.push(r(d))})}),i};return xC(e)||(e=x8(e)),r(e)}function pFe(e,{ignoreFieldNorm:t=vt.ignoreFieldNorm}){e.forEach(n=>{let r=1;n.matches.forEach(({key:s,norm:a,score:o})=>{const i=s?s.weight:null;r*=Math.pow(o===0&&i?Number.EPSILON:o,(i||1)*(t?1:a))}),n.score=r})}function hFe(e,t){const n=e.matches;t.matches=[],cs(n)&&n.forEach(r=>{if(!cs(r.indices)||!r.indices.length)return;const{indices:s,value:a}=r;let o={indices:s,value:a};r.key&&(o.key=r.key.src),r.idx>-1&&(o.refIndex=r.idx),t.matches.push(o)})}function gFe(e,t){t.score=e.score}function yFe(e,t,{includeMatches:n=vt.includeMatches,includeScore:r=vt.includeScore}={}){const s=[];return n&&s.push(hFe),r&&s.push(gFe),e.map(a=>{const{idx:o}=a,i={item:t[o],refIndex:o};return s.length&&s.forEach(c=>{c(a,i)}),i})}class zu{constructor(t,n={},r){this.options={...vt,...n},this.options.useExtendedSearch,this._keyStore=new VLe(this.options.keys),this.setCollection(t,r)}setCollection(t,n){if(this._docs=t,n&&!(n instanceof x5))throw new Error(LLe);this._myIndex=n||zG(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){cs(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const n=[];for(let r=0,s=this._docs.length;r<s;r+=1){const a=this._docs[r];t(a,r)&&(this.removeAt(r),r-=1,s-=1,n.push(a))}return n}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:n=-1}={}){const{includeMatches:r,includeScore:s,shouldSort:a,sortFn:o,ignoreFieldNorm:i}=this.options;let c=Oa(t)?Oa(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return pFe(c,{ignoreFieldNorm:i}),a&&c.sort(o),BG(n)&&n>-1&&(c=c.slice(0,n)),yFe(c,this._docs,{includeMatches:r,includeScore:s})}_searchStringList(t){const n=gC(t,this.options),{records:r}=this._myIndex,s=[];return r.forEach(({v:a,i:o,n:i})=>{if(!cs(a))return;const{isMatch:c,score:u,indices:d}=n.searchIn(a);c&&s.push({item:a,idx:o,matches:[{score:u,value:a,norm:i,indices:d}]})}),s}_searchLogical(t){const n=KG(t,this.options),r=(i,c,u)=>{if(!i.children){const{keyId:m,searcher:p}=i,h=this._findMatches({key:this._keyStore.get(m),value:this._myIndex.getValueForItemAtKeyId(c,m),searcher:p});return h&&h.length?[{idx:u,item:c,matches:h}]:[]}const d=[];for(let m=0,p=i.children.length;m<p;m+=1){const h=i.children[m],g=r(h,c,u);if(g.length)d.push(...g);else if(i.operator===Fg.AND)return[]}return d},s=this._myIndex.records,a={},o=[];return s.forEach(({$:i,i:c})=>{if(cs(i)){let u=r(n,i,c);u.length&&(a[c]||(a[c]={idx:c,item:i,matches:[]},o.push(a[c])),u.forEach(({matches:d})=>{a[c].matches.push(...d)}))}}),o}_searchObjectList(t){const n=gC(t,this.options),{keys:r,records:s}=this._myIndex,a=[];return s.forEach(({$:o,i})=>{if(!cs(o))return;let c=[];r.forEach((u,d)=>{c.push(...this._findMatches({key:u,value:o[d],searcher:n}))}),c.length&&a.push({idx:i,item:o,matches:c})}),a}_findMatches({key:t,value:n,searcher:r}){if(!cs(n))return[];let s=[];if(Ro(n))n.forEach(({v:a,i:o,n:i})=>{if(!cs(a))return;const{isMatch:c,score:u,indices:d}=r.searchIn(a);c&&s.push({score:u,key:t,value:a,idx:o,norm:i,indices:d})});else{const{v:a,n:o}=n,{isMatch:i,score:c,indices:u}=r.searchIn(a);i&&s.push({score:c,key:t,value:a,norm:o,indices:u})}return s}}zu.version="7.0.0";zu.createIndex=zG;zu.parseIndex=QLe;zu.config=vt;zu.parseQuery=KG;dFe(uFe);const xFe=f.memo(function({symbol:t,watermark:n}){const[r,s]=f.useState("1d"),a=Be(),o={prefix:"finance/currency",symbol:t,historyPeriod:r,withHistory:!0,historyAfterHours:!1,historyRedirect:!1,withUiHints:!0},{data:i,isLoading:c}=gt({queryKey:r3(o),queryFn:async()=>({quote:await _l(o),period:r}),refetchInterval:d=>{const m=d.state.data?.quote?.uiHints?.refetchIntervalSecs;return m?m*1e3:5e3},staleTime:1/0,placeholderData:Ja}),u=jG(i?.quote?.uiHints?.availablePeriods,!1);return!c&&!i?.quote?.history?.length?null:l.jsxs(Y,{className:"gap-md flex flex-col overflow-hidden border-t relative ",children:[l.jsx(Y,{className:"px-md pt-sm flex z-10",children:l.jsx(g5,{id:t,periods:u,period:r,setPeriod:s,variant:a?"sm":"lg",calendar:!1})}),l.jsx(kG,{id:`currency-chart-${t}`,quote:i?.quote,watermark:n,zoomable:!1})]})}),bFe=(e,t,n)=>Se.makeEphemeralQueryKey("finance/currency-exchange",e,t,n);async function _Fe({sourceCurrency:e,targetCurrency:t,amount:n=1,headers:r}){const{data:s,error:a,response:o}=await ve.GET("/rest/finance/currency-exchange",Ty,{params:{query:{source_currency:e,target_currency:t,amount:n}},headers:r,timeoutMs:ky,numRetries:My,shouldNotAddSourceVersionQueryParams:n3});if(a)throw new Ue("API_CLIENTS_ERROR",{cause:a,status:o.status??0});return s}const bC=[{currencyCode:"AED",type:"fiat",currency:V({defaultMessage:"United Arab Emirates dirham",id:"u/noLkGMVn"}),countryCode:"AE",symbol:"."},{currencyCode:"AFN",type:"fiat",currency:V({defaultMessage:"Afghan afghani",id:"HbCn83pcga"}),countryCode:"AF",symbol:""},{currencyCode:"ALL",type:"fiat",currency:V({defaultMessage:"Albanian lek",id:"/il1Hf7GWO"}),countryCode:"AL",symbol:"L"},{currencyCode:"AMD",type:"fiat",currency:V({defaultMessage:"Armenian dram",id:"Sab4a7TKLH"}),countryCode:"AM",symbol:""},{currencyCode:"ARS",type:"fiat",currency:V({defaultMessage:"Argentine peso",id:"52+/SFD8VZ"}),countryCode:"AR",symbol:"$"},{currencyCode:"AUD",type:"fiat",currency:V({defaultMessage:"Australian dollar",id:"iWILeLEVYR"}),countryCode:"AU",symbol:"$"},{currencyCode:"AWG",type:"fiat",currency:V({defaultMessage:"Aruban florin",id:"BEGfukujzF"}),countryCode:"AW",symbol:""},{currencyCode:"BAM",type:"fiat",currency:V({defaultMessage:"Bosnia and Herzegovina convertible mark",id:"b09sYvQVre"}),countryCode:"BA",symbol:"KM"},{currencyCode:"BBD",type:"fiat",currency:V({defaultMessage:"Barbadian dollar",id:"VlWuwU66Ue"}),countryCode:"BB",symbol:"$"},{currencyCode:"BDT",type:"fiat",currency:V({defaultMessage:"Bangladeshi taka",id:"nzdEshqHWS"}),countryCode:"BD",symbol:""},{currencyCode:"BGN",type:"fiat",currency:V({defaultMessage:"Bulgarian lev",id:"IDTjXBqV4N"}),countryCode:"BG",symbol:""},{currencyCode:"BHD",type:"fiat",currency:V({defaultMessage:"Bahraini dinar",id:"eq8qHJx0kM"}),countryCode:"BH",symbol:".."},{currencyCode:"BIF",type:"fiat",currency:V({defaultMessage:"Burundian franc",id:"o/KpEtmYi4"}),countryCode:"BI",symbol:"FBu"},{currencyCode:"BMD",type:"fiat",currency:V({defaultMessage:"Bermudian dollar",id:"kO0KeiZ+IN"}),countryCode:"BM",symbol:"$"},{currencyCode:"BND",type:"fiat",currency:V({defaultMessage:"Brunei dollar",id:"GRkirfzc48"}),countryCode:"BN",symbol:"$"},{currencyCode:"BOB",type:"fiat",currency:V({defaultMessage:"Bolivian boliviano",id:"l7UUEAhjL1"}),countryCode:"BO",symbol:"Bs."},{currencyCode:"BRL",type:"fiat",currency:V({defaultMessage:"Brazilian real",id:"x+BZGn5rek"}),countryCode:"BR",symbol:"R$"},{currencyCode:"BSD",type:"fiat",currency:V({defaultMessage:"Bahamian dollar",id:"u9nfam/El1"}),countryCode:"BS",symbol:"$"},{currencyCode:"BTN",type:"fiat",currency:V({defaultMessage:"Bhutanese ngultrum",id:"EbzIZvY2C3"}),countryCode:"BT",symbol:"Nu."},{currencyCode:"BWP",type:"fiat",currency:V({defaultMessage:"Botswana pula",id:"TvRjxCQudG"}),countryCode:"BW",symbol:"P"},{currencyCode:"BZD",type:"fiat",currency:V({defaultMessage:"Belize dollar",id:"tnMfFVDwiX"}),countryCode:"BZ",symbol:"$"},{currencyCode:"CAD",type:"fiat",currency:V({defaultMessage:"Canadian dollar",id:"L4ftYFzYiG"}),countryCode:"CA",symbol:"$"},{currencyCode:"CDF",type:"fiat",currency:V({defaultMessage:"Congolese franc",id:"6DNXExdai2"}),countryCode:"CD",symbol:"FC"},{currencyCode:"CHF",type:"fiat",currency:V({defaultMessage:"Swiss franc",id:"113zTX3mKi"}),countryCode:"CH",symbol:"Fr."},{currencyCode:"CLP",type:"fiat",currency:V({defaultMessage:"Chilean peso",id:"tLhKy6Swhn"}),countryCode:"CL",symbol:"$"},{currencyCode:"CNH",type:"fiat",currency:V({defaultMessage:"Chinese yuan (offshore)",id:"wAShedQ5+o"}),countryCode:"CN",symbol:""},{currencyCode:"CNY",type:"fiat",currency:V({defaultMessage:"Chinese yuan",id:"/sleu+8FUs"}),countryCode:"CN",symbol:""},{currencyCode:"COP",type:"fiat",currency:V({defaultMessage:"Colombian peso",id:"KR2NhLe6wO"}),countryCode:"CO",symbol:"$"},{currencyCode:"CRC",type:"fiat",currency:V({defaultMessage:"Costa Rican coln",id:"OLgF3rrfev"}),countryCode:"CR",symbol:""},{currencyCode:"CUP",type:"fiat",currency:V({defaultMessage:"Cuban peso",id:"ua/JslQGFc"}),countryCode:"CU",symbol:"$"},{currencyCode:"CVE",type:"fiat",currency:V({defaultMessage:"Cape Verdean escudo",id:"gg39Xd9NoM"}),countryCode:"CV",symbol:"$"},{currencyCode:"CYP",type:"fiat",currency:V({defaultMessage:"Cypriot pound",id:"xJn7heFKbn"}),countryCode:"CY",symbol:""},{currencyCode:"CZK",type:"fiat",currency:V({defaultMessage:"Czech koruna",id:"xpMdKvcamT"}),countryCode:"CZ",symbol:"K"},{currencyCode:"DJF",type:"fiat",currency:V({defaultMessage:"Djiboutian franc",id:"WtP9AoFz2A"}),countryCode:"DJ",symbol:"Fdj"},{currencyCode:"DKK",type:"fiat",currency:V({defaultMessage:"Danish krone",id:"Xy5G3y8jOw"}),countryCode:"DK",symbol:"kr"},{currencyCode:"DOP",type:"fiat",currency:V({defaultMessage:"Dominican peso",id:"2i/KFaPpw5"}),countryCode:"DO",symbol:"RD$"},{currencyCode:"DZD",type:"fiat",currency:V({defaultMessage:"Algerian dinar",id:"6sTpFM3olk"}),countryCode:"DZ",symbol:""},{currencyCode:"EGP",type:"fiat",currency:V({defaultMessage:"Egyptian pound",id:"PxOcvtceh8"}),countryCode:"EG",symbol:""},{currencyCode:"ETB",type:"fiat",currency:V({defaultMessage:"Ethiopian birr",id:"6VjP5tvzWg"}),countryCode:"ET",symbol:"Br"},{currencyCode:"EUR",type:"fiat",currency:V({defaultMessage:"Euro",id:"Zz6d8XMgGD"}),countryCode:"EU",symbol:""},{currencyCode:"FJD",type:"fiat",currency:V({defaultMessage:"Fijian dollar",id:"w33lAGgTZS"}),countryCode:"FJ",symbol:"$"},{currencyCode:"GBP",type:"fiat",currency:V({defaultMessage:"Pound sterling",id:"uU25lEI6GM"}),countryCode:"GB",symbol:""},{currencyCode:"GEL",type:"fiat",currency:V({defaultMessage:"Georgian lari",id:"m4gS106RpO"}),countryCode:"GE",symbol:""},{currencyCode:"GHS",type:"fiat",currency:V({defaultMessage:"Ghanaian cedi",id:"2k7sXvkoLP"}),countryCode:"GH",symbol:""},{currencyCode:"GMD",type:"fiat",currency:V({defaultMessage:"Gambian dalasi",id:"zT8nD3rOKp"}),countryCode:"GM",symbol:"D"},{currencyCode:"GNF",type:"fiat",currency:V({defaultMessage:"Guinean franc",id:"kZk7wkuU9a"}),countryCode:"GN",symbol:"FG"},{currencyCode:"GTQ",type:"fiat",currency:V({defaultMessage:"Guatemalan quetzal",id:"0eSFsz1h5U"}),countryCode:"GT",symbol:"Q"},{currencyCode:"GYD",type:"fiat",currency:V({defaultMessage:"Guyanese dollar",id:"pvTNSDiMVb"}),countryCode:"GY",symbol:"$"},{currencyCode:"HKD",type:"fiat",currency:V({defaultMessage:"Hong Kong dollar",id:"tSeK2eAo7a"}),countryCode:"HK",symbol:"$"},{currencyCode:"HNL",type:"fiat",currency:V({defaultMessage:"Honduran lempira",id:"u1All4YZ/M"}),countryCode:"HN",symbol:"L"},{currencyCode:"HRK",type:"fiat",currency:V({defaultMessage:"Croatian kuna",id:"m4/bILMdtE"}),countryCode:"HR",symbol:"kn"},{currencyCode:"HTG",type:"fiat",currency:V({defaultMessage:"Haitian gourde",id:"fYPjhPHJw5"}),countryCode:"HT",symbol:"G"},{currencyCode:"HUF",type:"fiat",currency:V({defaultMessage:"Hungarian forint",id:"Bhl6SxOjG0"}),countryCode:"HU",symbol:"Ft"},{currencyCode:"IDR",type:"fiat",currency:V({defaultMessage:"Indonesian rupiah",id:"JnQBDoCEpL"}),countryCode:"ID",symbol:"Rp"},{currencyCode:"ILS",type:"fiat",currency:V({defaultMessage:"Israeli new shekel",id:"IxD6vfIMsj"}),countryCode:"IL",symbol:""},{currencyCode:"INR",type:"fiat",currency:V({defaultMessage:"Indian rupee",id:"XnsufP9pQC"}),countryCode:"IN",symbol:""},{currencyCode:"IQD",type:"fiat",currency:V({defaultMessage:"Iraqi dinar",id:"rmzi7U/4iu"}),countryCode:"IQ",symbol:"."},{currencyCode:"ISK",type:"fiat",currency:V({defaultMessage:"Icelandic krna",id:"+QCFy0sZgh"}),countryCode:"IS",symbol:"kr"},{currencyCode:"JMD",type:"fiat",currency:V({defaultMessage:"Jamaican dollar",id:"EkOwDtWSVs"}),countryCode:"JM",symbol:"J$"},{currencyCode:"JOD",type:"fiat",currency:V({defaultMessage:"Jordanian dinar",id:"B2GvyCUDsS"}),countryCode:"JO",symbol:"."},{currencyCode:"JPY",type:"fiat",currency:V({defaultMessage:"Japanese yen",id:"2PiQsV1fPp"}),countryCode:"JP",symbol:""},{currencyCode:"KES",type:"fiat",currency:V({defaultMessage:"Kenyan shilling",id:"JIjYrchwhv"}),countryCode:"KE",symbol:"KSh"},{currencyCode:"KHR",type:"fiat",currency:V({defaultMessage:"Cambodian riel",id:"KCKOEaCtcY"}),countryCode:"KH",symbol:""},{currencyCode:"KMF",type:"fiat",currency:V({defaultMessage:"Comorian franc",id:"WV9ZQdQeR+"}),countryCode:"KM",symbol:"CF"},{currencyCode:"KRW",type:"fiat",currency:V({defaultMessage:"South Korean won",id:"EiHQBnRax2"}),countryCode:"KR",symbol:""},{currencyCode:"KWD",type:"fiat",currency:V({defaultMessage:"Kuwaiti dinar",id:"fkOQdpZmRV"}),countryCode:"KW",symbol:"."},{currencyCode:"KYD",type:"fiat",currency:V({defaultMessage:"Cayman Islands dollar",id:"RsdrXusNMV"}),countryCode:"KY",symbol:"$"},{currencyCode:"KZT",type:"fiat",currency:V({defaultMessage:"Kazakhstani tenge",id:"2qtVTeGWCE"}),countryCode:"KZ",symbol:""},{currencyCode:"LAK",type:"fiat",currency:V({defaultMessage:"Lao kip",id:"Fgzd1G5Yfn"}),countryCode:"LA",symbol:""},{currencyCode:"LBP",type:"fiat",currency:V({defaultMessage:"Lebanese pound",id:"FGzeEqNQzF"}),countryCode:"LB",symbol:"."},{currencyCode:"LKR",type:"fiat",currency:V({defaultMessage:"Sri Lankan rupee",id:"a4/joWlRVu"}),countryCode:"LK",symbol:"Rs"},{currencyCode:"LRD",type:"fiat",currency:V({defaultMessage:"Liberian dollar",id:"FI1z5I01J6"}),countryCode:"LR",symbol:"$"},{currencyCode:"LSL",type:"fiat",currency:V({defaultMessage:"Lesotho loti",id:"csvFpR0QuR"}),countryCode:"LS",symbol:"L"},{currencyCode:"LTL",type:"fiat",currency:V({defaultMessage:"Lithuanian litas",id:"0eziwi9562"}),countryCode:"LT",symbol:"Lt"},{currencyCode:"LYD",type:"fiat",currency:V({defaultMessage:"Libyan dinar",id:"MHH+Pd33wK"}),countryCode:"LY",symbol:"."},{currencyCode:"MAD",type:"fiat",currency:V({defaultMessage:"Moroccan dirham",id:"ECYUhp5Zzw"}),countryCode:"MA",symbol:".."},{currencyCode:"MDL",type:"fiat",currency:V({defaultMessage:"Moldovan leu",id:"b0q4AtgUSW"}),countryCode:"MD",symbol:"L"},{currencyCode:"MGA",type:"fiat",currency:V({defaultMessage:"Malagasy ariary",id:"7X6Af0dVLl"}),countryCode:"MG",symbol:"Ar"},{currencyCode:"MKD",type:"fiat",currency:V({defaultMessage:"Macedonian denar",id:"RCCw/rBMD7"}),countryCode:"MK",symbol:""},{currencyCode:"MMK",type:"fiat",currency:V({defaultMessage:"Burmese kyat",id:"09O/caoUOd"}),countryCode:"MM",symbol:"K"},{currencyCode:"MOP",type:"fiat",currency:V({defaultMessage:"Macanese pataca",id:"WSCDGHnfAP"}),countryCode:"MO",symbol:"P"},{currencyCode:"MUR",type:"fiat",currency:V({defaultMessage:"Mauritian rupee",id:"B7EPhc2k1/"}),countryCode:"MU",symbol:""},{currencyCode:"MVR",type:"fiat",currency:V({defaultMessage:"Maldivian rufiyaa",id:"WKep/6FHLO"}),countryCode:"MV",symbol:"Rf"},{currencyCode:"MWK",type:"fiat",currency:V({defaultMessage:"Malawian kwacha",id:"0QSRp0Tfcl"}),countryCode:"MW",symbol:"MK"},{currencyCode:"MXN",type:"fiat",currency:V({defaultMessage:"Mexican peso",id:"cAJvdQ+v2Y"}),countryCode:"MX",symbol:"$"},{currencyCode:"MXV",type:"fiat",currency:V({defaultMessage:"Mexican Unidad de Inversion (UDI)",id:"pJjurDaC1J"}),countryCode:"MX",symbol:"UDI"},{currencyCode:"MYR",type:"fiat",currency:V({defaultMessage:"Malaysian ringgit",id:"BJOmmIMKBn"}),countryCode:"MY",symbol:"RM"},{currencyCode:"MZN",type:"fiat",currency:V({defaultMessage:"Mozambican metical",id:"KVoUcWYwrs"}),countryCode:"MZ",symbol:"MT"},{currencyCode:"NAD",type:"fiat",currency:V({defaultMessage:"Namibian dollar",id:"ofXViiQOEO"}),countryCode:"NA",symbol:"$"},{currencyCode:"NGN",type:"fiat",currency:V({defaultMessage:"Nigerian naira",id:"YtrB6By6fQ"}),countryCode:"NG",symbol:""},{currencyCode:"NIO",type:"fiat",currency:V({defaultMessage:"Nicaraguan crdoba",id:"NJJMgSKcDP"}),countryCode:"NI",symbol:"C$"},{currencyCode:"NOK",type:"fiat",currency:V({defaultMessage:"Norwegian krone",id:"X7p/vNj1w0"}),countryCode:"NO",symbol:"kr"},{currencyCode:"NPR",type:"fiat",currency:V({defaultMessage:"Nepalese rupee",id:"KpP5Ur9yKv"}),countryCode:"NP",symbol:""},{currencyCode:"NZD",type:"fiat",currency:V({defaultMessage:"New Zealand dollar",id:"uoVYggIiS7"}),countryCode:"NZ",symbol:"$"},{currencyCode:"OMR",type:"fiat",currency:V({defaultMessage:"Omani rial",id:"YuZlkmlwz6"}),countryCode:"OM",symbol:".."},{currencyCode:"PAB",type:"fiat",currency:V({defaultMessage:"Panamanian balboa",id:"WsXJoQA7BU"}),countryCode:"PA",symbol:"B/."},{currencyCode:"PEN",type:"fiat",currency:V({defaultMessage:"Peruvian sol",id:"Gzey/zBCdq"}),countryCode:"PE",symbol:"S/."},{currencyCode:"PGK",type:"fiat",currency:V({defaultMessage:"Papua New Guinean kina",id:"1odcdptMV2"}),countryCode:"PG",symbol:"K"},{currencyCode:"PHP",type:"fiat",currency:V({defaultMessage:"Philippine peso",id:"Ze94/Fib/J"}),countryCode:"PH",symbol:""},{currencyCode:"PKR",type:"fiat",currency:V({defaultMessage:"Pakistani rupee",id:"xg2ovH8pDh"}),countryCode:"PK",symbol:""},{currencyCode:"PLN",type:"fiat",currency:V({defaultMessage:"Polish zoty",id:"5nGZooUDXi"}),countryCode:"PL",symbol:"z"},{currencyCode:"PYG",type:"fiat",currency:V({defaultMessage:"Paraguayan guaran",id:"faGTF61Eyw"}),countryCode:"PY",symbol:""},{currencyCode:"QAR",type:"fiat",currency:V({defaultMessage:"Qatari riyal",id:"DuHEQnjrPb"}),countryCode:"QA",symbol:"."},{currencyCode:"RON",type:"fiat",currency:V({defaultMessage:"Romanian leu",id:"lXgl4aKBP3"}),countryCode:"RO",symbol:"lei"},{currencyCode:"RSD",type:"fiat",currency:V({defaultMessage:"Serbian dinar",id:"giqvsRUiA5"}),countryCode:"RS",symbol:"."},{currencyCode:"RUB",type:"fiat",currency:V({defaultMessage:"Russian ruble",id:"4U+m5Kd694"}),countryCode:"RU",symbol:""},{currencyCode:"RWF",type:"fiat",currency:V({defaultMessage:"Rwandan franc",id:"URbs3Tt0On"}),countryCode:"RW",symbol:"FRw"},{currencyCode:"SAR",type:"fiat",currency:V({defaultMessage:"Saudi riyal",id:"p6D2TLqko8"}),countryCode:"SA",symbol:"."},{currencyCode:"SCR",type:"fiat",currency:V({defaultMessage:"Seychellois rupee",id:"V7Ju6HZQJK"}),countryCode:"SC",symbol:""},{currencyCode:"SDG",type:"fiat",currency:V({defaultMessage:"Sudanese pound",id:"FsgRxw4tdm"}),countryCode:"SD",symbol:".."},{currencyCode:"SEK",type:"fiat",currency:V({defaultMessage:"Swedish krona",id:"WoyUwT/z0X"}),countryCode:"SE",symbol:"kr"},{currencyCode:"SGD",type:"fiat",currency:V({defaultMessage:"Singapore dollar",id:"SCjBmFU+PM"}),countryCode:"SG",symbol:"$"},{currencyCode:"SHP",type:"fiat",currency:V({defaultMessage:"Saint Helena pound",id:"XZdS6/MxwW"}),countryCode:"SH",symbol:""},{currencyCode:"SLL",type:"fiat",currency:V({defaultMessage:"Sierra Leonean leone",id:"DFZ4yqf1EG"}),countryCode:"SL",symbol:"Le"},{currencyCode:"SOS",type:"fiat",currency:V({defaultMessage:"Somali shilling",id:"e7cANdrF41"}),countryCode:"SO",symbol:"Sh.So."},{currencyCode:"SVC",type:"fiat",currency:V({defaultMessage:"Salvadoran coln",id:"A2mT13SXuX"}),countryCode:"SV",symbol:""},{currencyCode:"SZL",type:"fiat",currency:V({defaultMessage:"Swazi lilangeni",id:"+kNQR2VJjT"}),countryCode:"SZ",symbol:"E"},{currencyCode:"THB",type:"fiat",currency:V({defaultMessage:"Thai baht",id:"Yz36aOmXMd"}),countryCode:"TH",symbol:""},{currencyCode:"TJS",type:"fiat",currency:V({defaultMessage:"Tajikistani somoni",id:"G3q+8He+TZ"}),countryCode:"TJ",symbol:"M"},{currencyCode:"TMT",type:"fiat",currency:V({defaultMessage:"Turkmenistan manat",id:"iV0j+gxDPN"}),countryCode:"TM",symbol:"m"},{currencyCode:"TND",type:"fiat",currency:V({defaultMessage:"Tunisian dinar",id:"l6iU1LyMSk"}),countryCode:"TN",symbol:"."},{currencyCode:"TRY",type:"fiat",currency:V({defaultMessage:"Turkish lira",id:"hQ9m98Llgt"}),countryCode:"TR",symbol:""},{currencyCode:"TTD",type:"fiat",currency:V({defaultMessage:"Trinidad and Tobago dollar",id:"Op/jRg7//J"}),countryCode:"TT",symbol:"TT$"},{currencyCode:"TWD",type:"fiat",currency:V({defaultMessage:"New Taiwan dollar",id:"yAeWHzFY54"}),countryCode:"TW",symbol:"NT$"},{currencyCode:"TZS",type:"fiat",currency:V({defaultMessage:"Tanzanian shilling",id:"7YNH90CDt1"}),countryCode:"TZ",symbol:"TSh"},{currencyCode:"UAH",type:"fiat",currency:V({defaultMessage:"Ukrainian hryvnia",id:"HCy2dyACi0"}),countryCode:"UA",symbol:""},{currencyCode:"UGX",type:"fiat",currency:V({defaultMessage:"Ugandan shilling",id:"P5STuJcFRi"}),countryCode:"UG",symbol:"USh"},{currencyCode:"USD",type:"fiat",currency:V({defaultMessage:"United States dollar",id:"BPRJDRwXU1"}),countryCode:"US",symbol:"$"},{currencyCode:"UYU",type:"fiat",currency:V({defaultMessage:"Uruguayan peso",id:"HtXUCx6BL1"}),countryCode:"UY",symbol:"$U"},{currencyCode:"UZS",type:"fiat",currency:V({defaultMessage:"Uzbekistani som",id:"lv4m0Kbuw1"}),countryCode:"UZ",symbol:"so'm"},{currencyCode:"VND",type:"fiat",currency:V({defaultMessage:"Vietnamese ng",id:"We/RqEPpOp"}),countryCode:"VN",symbol:""},{currencyCode:"XAF",type:"fiat",currency:V({defaultMessage:"Central African CFA franc",id:"fZwFESvHCw"}),countryCode:"CF",symbol:"FCFA"},{currencyCode:"XAG",type:"commodity",currency:V({defaultMessage:"Silver (troy ounce)",id:"XVTnv5Liuj"}),countryCode:"ZZ",symbol:"XAG"},{currencyCode:"XAU",type:"commodity",currency:V({defaultMessage:"Gold (troy ounce)",id:"s3i6lUYb/y"}),countryCode:"ZZ",symbol:"XAU"},{currencyCode:"XCD",type:"fiat",currency:V({defaultMessage:"East Caribbean dollar",id:"pXF3HmkspQ"}),countryCode:"AG",symbol:"$"},{currencyCode:"XDR",type:"fiat",currency:V({defaultMessage:"Special drawing rights",id:"X4eXXVN7wq"}),countryCode:"ZZ",symbol:"SDR"},{currencyCode:"XOF",type:"fiat",currency:V({defaultMessage:"West African CFA franc",id:"cezzLNBm20"}),countryCode:"SN",symbol:"CFA"},{currencyCode:"XPF",type:"fiat",currency:V({defaultMessage:"CFP franc",id:"txe+aX9vvZ"}),countryCode:"PF",symbol:""},{currencyCode:"YER",type:"fiat",currency:V({defaultMessage:"Yemeni rial",id:"lRXRuW4arm"}),countryCode:"YE",symbol:""},{currencyCode:"ZAC",type:"fiat",currency:V({defaultMessage:"South African rand (financial)",id:"GsJykrhxvK"}),countryCode:"ZA",symbol:"R"},{currencyCode:"ZAR",type:"fiat",currency:V({defaultMessage:"South African rand",id:"MbU2//IGEL"}),countryCode:"ZA",symbol:"R"},{currencyCode:"ZMW",type:"fiat",currency:V({defaultMessage:"Zambian kwacha",id:"ZJnHTLBz2v"}),countryCode:"ZM",symbol:"ZK"},{currencyCode:"BTC",type:"crypto",currency:V({defaultMessage:"Bitcoin",id:"RkW5weBw8q"}),symbol:""},{currencyCode:"ETH",type:"crypto",currency:V({defaultMessage:"Ethereum",id:"ohE0sWxJfP"}),symbol:""},{currencyCode:"XRP",type:"crypto",currency:V({defaultMessage:"XRP",id:"rwHxdc9N83"}),symbol:"XRP"},{currencyCode:"BNB",type:"crypto",currency:V({defaultMessage:"BNB",id:"+x/JA+cbSg"}),symbol:"BNB"},{currencyCode:"USDT",type:"crypto",currency:V({defaultMessage:"Tether",id:"G17JtC1DRO"}),symbol:"USDT"},{currencyCode:"SOL",type:"crypto",currency:V({defaultMessage:"Solana",id:"RmbsLR1XI9"}),symbol:"SOL"},{currencyCode:"HYPE",type:"crypto",currency:V({defaultMessage:"HYPE",id:"sRJuK+IQu7"}),symbol:"HYPE"},{currencyCode:"STETH",type:"crypto",currency:V({defaultMessage:"stETH",id:"VNvqEhRv0o"}),symbol:"stETH"},{currencyCode:"WTRX",type:"crypto",currency:V({defaultMessage:"Wrapped TRX",id:"hi8IgS7Vvh"}),symbol:"WTRX"},{currencyCode:"DOGE",type:"crypto",currency:V({defaultMessage:"Dogecoin",id:"Q4KOhNgUFl"}),symbol:"DOGE"},{currencyCode:"ADA",type:"crypto",currency:V({defaultMessage:"Cardano",id:"Zk+zRo7Vav"}),symbol:"ADA"},{currencyCode:"TRX",type:"crypto",currency:V({defaultMessage:"TRON",id:"fLtNc/n43W"}),symbol:"TRX"},{currencyCode:"USDC",type:"crypto",currency:V({defaultMessage:"USD Coin",id:"tPc0IbLJq0"}),symbol:"USDC"},{currencyCode:"WBTC",type:"crypto",currency:V({defaultMessage:"Wrapped Bitcoin",id:"AO1Xrr+Cwk"}),symbol:"WBTC"},{currencyCode:"WSTETH",type:"crypto",currency:V({defaultMessage:"Wrapped stETH",id:"Fg7h7ipjGE"}),symbol:"wstETH"},{currencyCode:"EDLC",type:"crypto",currency:V({defaultMessage:"EDLC",id:"FplbXN+574"}),symbol:"EDLC"},{currencyCode:"LINK",type:"crypto",currency:V({defaultMessage:"Chainlink",id:"d/A799ZTa/"}),symbol:"LINK"},{currencyCode:"AIC",type:"crypto",currency:V({defaultMessage:"AIC",id:"RSOIsb9pEC"}),symbol:"AIC"},{currencyCode:"XLM",type:"crypto",currency:V({defaultMessage:"Stellar",id:"+uYwRW10Bd"}),symbol:"XLM"},{currencyCode:"WETH",type:"crypto",currency:V({defaultMessage:"Wrapped Ether",id:"s8UwDT+8t2"}),symbol:"WETH"},{currencyCode:"BCH",type:"crypto",currency:V({defaultMessage:"Bitcoin Cash",id:"hLt+wzROTK"}),symbol:"BCH"},{currencyCode:"UST",type:"crypto",currency:V({defaultMessage:"TerraUSD",id:"wot2OPkJDe"}),symbol:"UST"},{currencyCode:"AVAX",type:"crypto",currency:V({defaultMessage:"Avalanche",id:"C9K+TI7R4G"}),symbol:"AVAX"},{currencyCode:"SUI",type:"crypto",currency:V({defaultMessage:"Sui",id:"CvmoCbTblr"}),symbol:"SUI"},{currencyCode:"LTC",type:"crypto",currency:V({defaultMessage:"Litecoin",id:"oyKw8Dr6hh"}),symbol:"LTC"},{currencyCode:"TON",type:"crypto",currency:V({defaultMessage:"Toncoin",id:"V2AxdWxVB/"}),symbol:"TON"},{currencyCode:"HBAR",type:"crypto",currency:V({defaultMessage:"Hedera",id:"yLSpOa++/L"}),symbol:"HBAR"},{currencyCode:"WHBAR",type:"crypto",currency:V({defaultMessage:"Wrapped HBAR",id:"rfimaaddr1"}),symbol:"WHBAR"},{currencyCode:"UNI",type:"crypto",currency:V({defaultMessage:"Uniswap",id:"hincAkLfxR"}),symbol:"UNI"},{currencyCode:"BTCB",type:"crypto",currency:V({defaultMessage:"Bitcoin BEP2",id:"T7D16Bt6JS"}),symbol:"BTCB"},{currencyCode:"OKB",type:"crypto",currency:V({defaultMessage:"OKB",id:"6ZLe/X3P+I"}),symbol:"OKB"},{currencyCode:"SHIB",type:"crypto",currency:V({defaultMessage:"Shiba Inu",id:"dwuQAuovNP"}),symbol:"SHIB"},{currencyCode:"USDS",type:"crypto",currency:V({defaultMessage:"StableUSD",id:"DAzSEb0LeA"}),symbol:"USDS"},{currencyCode:"WBT",type:"crypto",currency:V({defaultMessage:"WhiteBIT Coin",id:"Lj9Zp416rG"}),symbol:"WBT"},{currencyCode:"BGB",type:"crypto",currency:V({defaultMessage:"Bitget Token",id:"OEQgkmdE1O"}),symbol:"BGB"},{currencyCode:"DAI",type:"crypto",currency:V({defaultMessage:"Dai",id:"7g+Z6oltsB"}),symbol:"DAI"},{currencyCode:"DOT",type:"crypto",currency:V({defaultMessage:"Polkadot",id:"iS7ue2zjn0"}),symbol:"DOT"},{currencyCode:"XMR",type:"crypto",currency:V({defaultMessage:"Monero",id:"RydJABkA4a"}),symbol:"XMR"},{currencyCode:"MNT",type:"crypto",currency:V({defaultMessage:"MNT",id:"90qNZszLR/"}),symbol:"MNT"},{currencyCode:"PEPE",type:"crypto",currency:V({defaultMessage:"Pepe",id:"x9wJbmzZhn"}),symbol:"PEPE"},{currencyCode:"AAVE",type:"crypto",currency:V({defaultMessage:"Aave",id:"kFjzNltaTL"}),symbol:"AAVE"},{currencyCode:"CRO",type:"crypto",currency:V({defaultMessage:"Cronos",id:"2cg8W1gIo3"}),symbol:"CRO"},{currencyCode:"ETC",type:"crypto",currency:V({defaultMessage:"Ethereum Classic",id:"Bv9Xkw6kNg"}),symbol:"ETC"},{currencyCode:"FD",type:"crypto",currency:V({defaultMessage:"FD",id:"+Q62UIi/LA"}),symbol:"FD"},{currencyCode:"TUSD",type:"crypto",currency:V({defaultMessage:"TrueUSD",id:"whDnhXYdIe"}),symbol:"TUSD"},{currencyCode:"NEAR",type:"crypto",currency:V({defaultMessage:"NEAR Protocol",id:"E9RsfkMwMk"}),symbol:"NEAR"},{currencyCode:"METAGAMES",type:"crypto",currency:V({defaultMessage:"MetaGames",id:"C0GGroVhnP"}),symbol:"METAGAMES"},{currencyCode:"TAO",type:"crypto",currency:V({defaultMessage:"Bittensor",id:"6+C0Ut5hKl"}),symbol:"TAO"},{currencyCode:"ICP",type:"crypto",currency:V({defaultMessage:"Internet Computer",id:"q9uyMXlX+M"}),symbol:"ICP"},{currencyCode:"GT",type:"crypto",currency:V({defaultMessage:"GateToken",id:"dSGfpIcmmI"}),symbol:"GT"},{currencyCode:"RETH",type:"crypto",currency:V({defaultMessage:"Rocket Pool ETH",id:"pg4o1kZ2d4"}),symbol:"rETH"},{currencyCode:"MRS",type:"crypto",currency:V({defaultMessage:"MRS",id:"CABw3watNU"}),symbol:"MRS"},{currencyCode:"APT",type:"crypto",currency:V({defaultMessage:"Aptos",id:"/U15UItsIY"}),symbol:"APT"},{currencyCode:"KAS",type:"crypto",currency:V({defaultMessage:"Kaspa",id:"1MwSSUoCwu"}),symbol:"KAS"},{currencyCode:"ALGO",type:"crypto",currency:V({defaultMessage:"Algorand",id:"TijDBb1K3w"}),symbol:"ALGO"},{currencyCode:"PENGU",type:"crypto",currency:V({defaultMessage:"PENGU",id:"esTSdYyjL9"}),symbol:"PENGU"},{currencyCode:"VET",type:"crypto",currency:V({defaultMessage:"VeChain",id:"o3b918Uwm9"}),symbol:"VET"},{currencyCode:"OTRUMP",type:"crypto",currency:V({defaultMessage:"OTRUMP",id:"dwjxu1ZNrs"}),symbol:"OTRUMP"},{currencyCode:"ARB",type:"crypto",currency:V({defaultMessage:"Arbitrum",id:"2qF6KBPwqc"}),symbol:"ARB"},{currencyCode:"LUNA1",type:"crypto",currency:V({defaultMessage:"Terra (LUNA1)",id:"g5JtKAkJm/"}),symbol:"LUNA1"},{currencyCode:"MKR",type:"crypto",currency:V({defaultMessage:"Maker",id:"iVoUggHR7n"}),symbol:"MKR"},{currencyCode:"QNT",type:"crypto",currency:V({defaultMessage:"Quant",id:"kZiBtRgPXK"}),symbol:"QNT"},{currencyCode:"BONK",type:"crypto",currency:V({defaultMessage:"BONK",id:"/WOyXrLUEt"}),symbol:"BONK"},{currencyCode:"ATOM",type:"crypto",currency:V({defaultMessage:"Cosmos",id:"VfvhDOBZSq"}),symbol:"ATOM"},{currencyCode:"FTN",type:"crypto",currency:V({defaultMessage:"FTN",id:"+BtHlnfKBJ"}),symbol:"FTN"},{currencyCode:"KCS",type:"crypto",currency:V({defaultMessage:"KuCoin Token",id:"J6x8n/y945"}),symbol:"KCS"},{currencyCode:"RNDR",type:"crypto",currency:V({defaultMessage:"Render",id:"fI33PYpQj/"}),symbol:"RNDR"},{currencyCode:"BNX",type:"crypto",currency:V({defaultMessage:"BNX",id:"/mzOvKP3DB"}),symbol:"BNX"},{currencyCode:"FIL",type:"crypto",currency:V({defaultMessage:"Filecoin",id:"O60m1dM5+I"}),symbol:"FIL"},{currencyCode:"WBNB",type:"crypto",currency:V({defaultMessage:"Wrapped BNB",id:"6oPoIEcEKM"}),symbol:"WBNB"},{currencyCode:"DUCK",type:"crypto",currency:V({defaultMessage:"DUCK",id:"Wy2n2zHjyn"}),symbol:"DUCK"},{currencyCode:"ONDO",type:"crypto",currency:V({defaultMessage:"Ondo",id:"Mdh4nCMVFp"}),symbol:"ONDO"},{currencyCode:"EZETH",type:"crypto",currency:V({defaultMessage:"EZETH",id:"GquMfdHRpr"}),symbol:"EZETH"},{currencyCode:"DHN",type:"crypto",currency:V({defaultMessage:"DHN",id:"3DBrwMVTuR"}),symbol:"DHN"},{currencyCode:"SPX",type:"crypto",currency:V({defaultMessage:"SPX",id:"78Gbn14660"}),symbol:"SPX"},{currencyCode:"XDC",type:"crypto",currency:V({defaultMessage:"XDC Network",id:"f4v54xCFpd"}),symbol:"XDC"},{currencyCode:"ENA",type:"crypto",currency:V({defaultMessage:"ENA",id:"G6NRdu/3/f"}),symbol:"ENA"},{currencyCode:"SOLVBTCBBN",type:"crypto",currency:V({defaultMessage:"SOLVBTCBBN",id:"U+VGyLBIbO"}),symbol:"SOLVBTCBBN"},{currencyCode:"LDO",type:"crypto",currency:V({defaultMessage:"Lido DAO",id:"Hm40klV7dx"}),symbol:"LDO"},{currencyCode:"INJ",type:"crypto",currency:V({defaultMessage:"Injective",id:"Zy5gqTZCK/"}),symbol:"INJ"},{currencyCode:"USD0",type:"crypto",currency:V({defaultMessage:"USD0",id:"I8k7Is+SUX"}),symbol:"USD0"},{currencyCode:"FLR",type:"crypto",currency:V({defaultMessage:"Flare",id:"EuWzA+LwQr"}),symbol:"FLR"},{currencyCode:"PY",type:"crypto",currency:V({defaultMessage:"PY",id:"2WmUk53rca"}),symbol:"PY"},{currencyCode:"SEI",type:"crypto",currency:V({defaultMessage:"Sei",id:"uIVFPKXueM"}),symbol:"SEI"},{currencyCode:"MSOL",type:"crypto",currency:V({defaultMessage:"Marinade Staked SOL",id:"Sgo9VGem0+"}),symbol:"mSOL"},{currencyCode:"CRV",type:"crypto",currency:V({defaultMessage:"Curve DAO Token",id:"hv2sTxuyJY"}),symbol:"CRV"},{currencyCode:"FTM",type:"crypto",currency:V({defaultMessage:"Fantom",id:"FdV4Gc/fz2"}),symbol:"FTM"},{currencyCode:"FLOKI",type:"crypto",currency:V({defaultMessage:"FLOKI",id:"d2sPiyXVq8"}),symbol:"FLOKI"},{currencyCode:"CMETH",type:"crypto",currency:V({defaultMessage:"CMETH",id:"ZXQlnD2obl"}),symbol:"CMETH"},{currencyCode:"SLISBNB",type:"crypto",currency:V({defaultMessage:"SLISBNB",id:"wqx7ZL4lbr"}),symbol:"SLISBNB"},{currencyCode:"FARTCOIN",type:"crypto",currency:V({defaultMessage:"FARTCOIN",id:"qFlNIb5L+O"}),symbol:"FARTCOIN"},{currencyCode:"EETH",type:"crypto",currency:V({defaultMessage:"eETH",id:"tCrC5owpVn"}),symbol:"eETH"},{currencyCode:"KAIA",type:"crypto",currency:V({defaultMessage:"KAIA",id:"fDXZE/gzgq"}),symbol:"KAIA"},{currencyCode:"GRT",type:"crypto",currency:V({defaultMessage:"The Graph",id:"oFrVNds2cX"}),symbol:"GRT"},{currencyCode:"IMX",type:"crypto",currency:V({defaultMessage:"Immutable",id:"+0mthqqK1s"}),symbol:"IMX"},{currencyCode:"WIF",type:"crypto",currency:V({defaultMessage:"WIF",id:"tK0cRtUi/S"}),symbol:"WIF"},{currencyCode:"RAY",type:"crypto",currency:V({defaultMessage:"Raydium",id:"pSdm2ZTXHD"}),symbol:"RAY"},{currencyCode:"OP",type:"crypto",currency:V({defaultMessage:"Optimism",id:"ghDrrz64nC"}),symbol:"OP"},{currencyCode:"XAUT",type:"crypto",currency:V({defaultMessage:"Tether Gold",id:"pobzwuxAfg"}),symbol:"XAUT"},{currencyCode:"PENDLE",type:"crypto",currency:V({defaultMessage:"Pendle",id:"z8diWExCd3"}),symbol:"PENDLE"}],lc=(e,t)=>{if(!e)return"";const n=new Intl.NumberFormat(t,{useGrouping:!0,minimumFractionDigits:0,maximumFractionDigits:100}),r=e.endsWith("."),s=e.split("."),a=s[0]||"0",o=s[1]||"",i=parseFloat(e);if(isNaN(i))return"";let u=n.format(parseFloat(a));return s.length>1?u+="."+o:r&&(u+="."),u},vFe=A.memo(function({value:t,onChange:n,placeholder:r="0",disabled:s=!1,className:a="",min:o,max:i,step:c=1}){const u=f.useRef(null),{locale:d}=Q(),[m,p]=f.useState(lc(t,d)),h=f.useCallback(x=>x.replace(/,/g,""),[]),g=f.useCallback(x=>{const _=x.target.value,v=h(_),C=x.target.selectionStart||0;if(v===""||/^\d*\.?\d*$/.test(v)&&!/e/i.test(_)){const w=lc(v,d);p(w),n(v),requestAnimationFrame(()=>{if(u.current){const S=_.substring(0,C),E=h(S);let T=0,k=0;const M=E.replace(".","").length,N=E.includes(".")&&E.endsWith(".");for(let P=0;P<w.length;P++){const O=w[P];if(O==="."){if(N&&T===M){k=P+1;break}}else if(O!==","&&(T++,!N&&T===M)){k=P+1;break}}u.current.setSelectionRange(k,k)}})}},[h,n,d]),y=f.useCallback(x=>{const _=u.current;if(!_||(x.metaKey||x.ctrlKey)&&(x.key==="z"||x.key==="Z"))return;const{selectionStart:v,selectionEnd:C,value:w}=_;if(x.key==="ArrowUp"||x.key==="ArrowDown"){x.preventDefault();const S=parseFloat(h(t))||0,E=x.key==="ArrowUp"?c:-c;let T=S+E;o!==void 0&&T<o&&(T=o),i!==void 0&&T>i&&(T=i);const k=T.toString(),M=lc(k,d);p(M),n(k);return}if(x.key==="Backspace"&&v===C){if(v===null)return;if(w[v-1]===","){x.preventDefault();const E=w.substring(0,v-1),T=w.substring(v),k=E[E.length-1];if(k&&/\d/.test(k)){const M=E.slice(0,-1)+T,N=h(M),P=lc(N,d);p(P),n(N),setTimeout(()=>{const O=P.length-h(T).length;_.setSelectionRange(O,O)},0)}}}},[h,n,t,c,o,i,d]),b=f.useCallback(x=>{x.preventDefault();const _=x.clipboardData.getData("text"),v=h(_);if(/^\d*\.?\d*$/.test(v)&&!/e/i.test(_)){const C=lc(v,d);p(C),n(v)}},[h,n,d]);return A.useEffect(()=>{const x=lc(t,d);p(x)},[t,d]),l.jsx("input",{ref:u,type:"text",value:m,onChange:g,onKeyDown:y,onPaste:b,placeholder:r,disabled:s,className:a,inputMode:"decimal"})}),b8=e=>bC.find(t=>t.currencyCode===e),Bp=e=>e>1?parseFloat(e.toFixed(2)):parseFloat(e.toPrecision(2)),CFe=A.memo(function(t){const{data:n}=t,{source_currency:r,target_currency:s,source_amount:a,converted_amount:o,exchange_rate:i}=n,c=!0,{menuItems:u}=Gu(),[d,m]=f.useState(a),[p,h]=f.useState(Bp(o)),[g,y]=f.useState(r),[b,x]=f.useState(s),[_,v]=f.useState(i),{colorScheme:C}=Cs(),w=C==="dark",{$t:S}=Q(),E=`${g}${b}`,{data:T,isLoading:k,error:M}=gt({queryKey:bFe(g,b,d),queryFn:()=>_Fe({sourceCurrency:g,targetCurrency:b,amount:d}),enabled:!!g&&!!b&&d>0}),N=f.useRef(T?.source_currency),P=f.useRef(T?.target_currency),O=f.useRef(T?.exchange_rate),L=f.useRef(T?.source_img),H=f.useRef(T?.source_img_dark),R=f.useRef(T?.target_img),I=f.useRef(T?.target_img_dark);f.useEffect(()=>{T&&(T?.source_currency!==N.current||T?.target_currency!==P.current)&&(h(Bp(T.converted_amount)),N.current=T.source_currency,P.current=T.target_currency),T&&T.exchange_rate!==O.current&&(v(T.exchange_rate),O.current=T.exchange_rate),T&&T.source_img!==L.current&&(L.current=T.source_img),T&&T.source_img_dark!==H.current&&(H.current=T.source_img_dark),T&&T.target_img!==R.current&&(R.current=T.target_img),T&&T.target_img_dark!==I.current&&(I.current=T.target_img_dark)},[T]);const F=b8(g),G=b8(b);return l.jsx(ss,{widgetType:"finance",widgetName:"currency_exchange",children:l.jsx("div",{className:"gap-sm pb-sm flex flex-col overflow-visible",children:l.jsxs(Xn,{shadow:!0,className:"w-full overflow-hidden",children:[l.jsxs(Y,{variant:"subtler",className:"grid w-full grid-cols-1 gap-px md:grid-cols-2",children:[l.jsxs(Y,{variant:"raised",className:"p-md pb-sm gap-sm flex w-full flex-col",children:[l.jsx("div",{className:"flex-1",children:l.jsxs(B,{variant:"entry-title-200",className:"flex font-mono !text-2xl",children:[l.jsx("span",{className:"text-quieter",children:F?.symbol}),l.jsx(v8,{value:d.toString(),error:!!M,onChange:j=>{const $=parseFloat(j);m($),$>0?h(Bp($*_)):h(0)}})]})}),l.jsxs("div",{className:"gap-md flex items-center",children:[l.jsx(_8,{onSelect:j=>y(j),currency:F?S(F.currency):g,icon:F&&F.type==="crypto"?l.jsx(Y,{variant:"subtler",className:"size-full overflow-hidden rounded-full",children:(w?H.current:L.current)&&l.jsx("img",{src:w?H.current??"":L.current??"",alt:S(F.currency),className:"size-full object-contain"})}):F&&F.type==="commodity"?l.jsx(Y,{className:z("size-full rounded-full",{"!bg-[gold]":F?.currencyCode==="XAU","!bg-[silver]":F?.currencyCode==="XAG"})}):l.jsx(dv,{className:"size-full object-contain",countryCode:F?.countryCode})}),l.jsx("div",{className:"ml-auto grid grid-cols-1 grid-rows-1 items-center",children:l.jsxs(Wt,{children:[k&&l.jsx(ze.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:ui,className:"col-start-1 row-start-1 ml-auto",children:l.jsx(B,{color:"ultraLight",children:l.jsx(To,{size:12})})},"loading"),!k&&M&&l.jsx(ze.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:ui,className:"col-start-1 row-start-1 ml-auto",children:l.jsx(B,{color:"light",variant:"small",children:S({defaultMessage:"Not supported",id:"+FiyOTaUCW"})})},"error")]})})]})]}),l.jsxs(Y,{variant:"raised",className:z("p-md pb-sm gap-md flex w-full flex-col",{"!gap-sm":c}),children:[l.jsx("div",{className:"flex-1",children:l.jsxs(B,{variant:"entry-title-200",color:"default",className:"flex font-mono !text-2xl",children:[l.jsx("span",{className:"text-quieter",children:G?.symbol}),l.jsx(v8,{value:p.toString(),error:!!M,onChange:j=>{const $=parseFloat(j);h($),$>0?m(Bp($/_)):m(0)}})]})}),l.jsxs("div",{className:"gap-md flex items-center",children:[l.jsx(_8,{onSelect:j=>x(j),currency:G?S(G.currency):b,icon:G&&G.type==="crypto"?l.jsx(Y,{variant:"subtler",className:"size-full overflow-hidden rounded-full",children:(w?I.current:R.current)&&l.jsx("img",{src:w?I.current??"":R.current??"",alt:S(G.currency),className:"size-full object-contain"})}):G&&G.type==="commodity"?l.jsx(Y,{className:z("size-full rounded-full",{"!bg-[gold]":G?.currencyCode==="XAU","!bg-[silver]":G?.currencyCode==="XAG"})}):l.jsx(dv,{className:"size-full object-contain",countryCode:G?.countryCode})}),u&&u.length>0&&l.jsx("div",{className:"ml-auto",children:l.jsx(In.Menu,{menuItems:u})})]})]})]}),l.jsx(xFe,{symbol:E,watermark:l.jsx(vg,{})})]})})})}),_8=A.memo(function({currency:t,icon:n,onSelect:r}){const{$t:s}=Q(),{isMobileStyle:a}=Be(),[o,i]=f.useState(""),c=f.useMemo(()=>["CNY","EUR","GBP","JPY","USD","BTC","ETH"].map(b=>bC.find(x=>x.currencyCode===b)),[]),u=f.useMemo(()=>{const y=bC.map(b=>({...b,localizedCurrency:s(b.currency)}));return new zu(y,{keys:["localizedCurrency","currencyCode","countryCode"],threshold:.3})},[s]),d=f.useMemo(()=>u.search(o)??[],[u,o]),m=f.useMemo(()=>c.map(y=>({type:"default",text:y?.currencyCode?s(y.currency):"",onClick:()=>{y?.currencyCode&&(r(y.currencyCode),i(""))}})),[c,r,s]),p=f.useMemo(()=>d.map(y=>({type:"default",text:s(y.item?.currency)??"",onClick:()=>{y?.item?.currencyCode&&(r(y.item?.currencyCode),i(""))}})),[d,r,s]),h=f.useMemo(()=>[{type:"default",text:s({defaultMessage:"No results",id:"jHJmjfxD4s"}),disabled:!0}],[s]),g=f.useMemo(()=>l.jsx(xs,{autoFocus:!0,className:z({"!-mx-xs":a,"!px-xs py-sm mb-xs border-none !bg-transparent shadow-none outline-none focus:!ring-0":!a}),isMobileUserAgent:a,placeholder:s({defaultMessage:"Search currencies...",id:"fDMc8k+hJQ"}),value:o,onChange:y=>i(y),disable1pass:!0}),[a,o,s]);return l.jsx(bu,{alwaysShowChildren:!0,placement:"bottom-start",showFooterOnMobile:!0,items:o.length>0?p.length>0?p:h:m,isMobileStyle:a,wrapperClassName:"flex",header:g,footer:a&&g,children:l.jsx(pt,{chevron:!0,noPadding:!0,extraCSS:"!px-sm -ml-sm",leadingComponent:l.jsx("div",{className:"mr-0.5 size-5",children:n}),variant:"primary",size:"small",text:t})})}),v8=A.memo(function({value:t,onChange:n,error:r}){return r?l.jsx("span",{className:"!text-quieter",children:"---"}):l.jsx(vFe,{className:z("placeholder:text-quieter w-full overflow-hidden bg-transparent transition-colors duration-200 [appearance:textfield] focus:outline-none [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",{"!text-quieter":r}),value:t??"",disabled:r,placeholder:"0",onChange:n,min:0})}),Hp=e=>e?new Date(e):void 0,wFe=e=>({departureTime:new Date(e.departure_time),arrivalTime:new Date(e.arrival_time),actualDepartureTime:Hp(e.actual_departure_time),actualArrivalTime:Hp(e.actual_arrival_time),estimatedDepartureTime:Hp(e.estimated_departure_time),estimatedArrivalTime:Hp(e.estimated_arrival_time)}),SFe=e=>!!(e.actualArrivalTime&&e.actualArrivalTime>e.arrivalTime||e.estimatedArrivalTime&&e.estimatedArrivalTime>e.arrivalTime),EFe=e=>{if(e.length===0)return[];if(e.length===1)return[[e[0]]];const t=[...e].sort((a,o)=>new Date(a.departure_time).getTime()-new Date(o.departure_time).getTime()),n=[],r=t[0];if(!r)return[];let s=[r];for(let a=1;a<t.length;a++){const o=t[a-1],i=t[a];!o||!i||(o.arrival_airport===i.departure_airport?s.push(i):(n.push(s),s=[i]))}return n.length>0&&s.length==n[n.length-1]?.length&&n.push(s),n},Id=(e,t,n)=>{const r=qW({start:e,end:t}),s=r.days||0,a=r.hours||0,o=r.minutes||0;return s>0?a===0&&o===0?n({id:"sSynIO3ThU",defaultMessage:"{days}d"},{days:s}):o===0?n({id:"10cSZzeWte",defaultMessage:"{days}d {hours}h"},{days:s,hours:a}):n({id:"OWk1HjddEb",defaultMessage:"{days}d {hours}h {minutes}m"},{days:s,hours:a,minutes:o.toString().padStart(2,"0")}):a===0?n({id:"VvfhE21OJI",defaultMessage:"{minutes}m"},{minutes:o}):o===0?n({id:"unuVj1l7KW",defaultMessage:"{hours}h"},{hours:a}):n({id:"0Yp4jJ7rzm",defaultMessage:"{hours}h {minutes}m"},{hours:a,minutes:o.toString().padStart(2,"0")})},kFe=A.memo(function({flightMetadata:t,departureTime:n,arrivalTime:r,actualDepartureTime:s,actualArrivalTime:a,estimatedDepartureTime:o,estimatedArrivalTime:i,delayed:c=!1,rightContent:u}){const{$t:d}=Q(),m=f.useMemo(()=>new Date,[]),{cancelled:p,diverted:h,status:g,flight_number:y,departure_city:b,departure_airport:x,arrival_airport:_,arrival_city:v}=t,C=s||o||n,w=a||i||r,S=f.useMemo(()=>Id(m,C,d),[m,C,d]),E=f.useMemo(()=>Id(C,m,d),[m,C,d]),T=f.useMemo(()=>Id(w,m,d),[m,w,d]),k=f.useMemo(()=>Id(m,w,d),[m,w,d]),M=C<=m,N=w<=m,P=f.useMemo(()=>N?d({id:"mtuHNb+mRc",defaultMessage:"Arrived {time} ago"},{time:T}):M?d({id:"b6q320RasU",defaultMessage:"Departed {time} ago"},{time:E}):d({id:"/JLglYfuNX",defaultMessage:"Departing in {time}"},{time:S}),[M,N,S,E,T,d]),O=f.useMemo(()=>p?d({id:"3wsVWFbC1x",defaultMessage:"Cancelled"}):h?d({id:"/N1ZeWQc8B",defaultMessage:"Diverted"}):g,[p,h,d,g]);return l.jsxs("div",{className:"gap-sm flex flex-col justify-between sm:flex-row",children:[l.jsxs("div",{children:[l.jsx(B,{variant:"section-title",children:l.jsx(be,{id:"NO1syjIYJS",defaultMessage:"{flightNumber} - {departureCity} ({departureAirport}) to {arrivalCity} ({arrivalAirport})",values:{flightNumber:y,departureCity:b,departureAirport:x,arrivalAirport:_,arrivalCity:v}})}),l.jsx("div",{className:"gap-sm flex flex-row",children:l.jsxs(Ao,{className:"gap-xs flex flex-row flex-wrap",children:[!p&&l.jsx(Un,{id:"relative-departure-time",children:l.jsx(B,{variant:"smallBold",color:"light",children:P})}),M&&!N&&!p&&l.jsx(Un,{id:"relative-arrival-time",children:l.jsx(B,{variant:"smallBold",color:"light",children:l.jsx(be,{id:"z8jWKRSOak",defaultMessage:"Arriving in {time}",values:{time:k}})})}),l.jsx(Un,{id:"status",children:l.jsx(B,{variant:"smallBold",color:p||h||c?"negative":"super",children:O})})]})})]}),u]})}),Vp={initial:{opacity:0,filter:"blur(2px)"},animate:{opacity:1,filter:"blur(0px)"},exit:{opacity:0,filter:"blur(2px)"},transition:{duration:.5,ease:ai}},YG=A.memo(function({children:t,animationKey:n,...r}){return l.jsx(Wt,{mode:"popLayout",initial:!1,children:l.jsx(ze.div,{initial:Vp.initial,animate:Vp.animate,exit:Vp.exit,transition:Vp.transition,children:l.jsx(B,{...r,children:t})},n)})}),MFe=A.memo(function({terminal:t,gate:n,alignEnd:r}){const{$t:s}=Q();return l.jsxs("div",{className:z("gap-lg flex w-full flex-row",r&&"justify-end"),children:[l.jsx(C8,{label:s({id:"GAHVEi8lHA",defaultMessage:"Terminal"}),value:t??"-"}),l.jsx(C8,{label:s({id:"W+gH70jajX",defaultMessage:"Gate"}),value:n??"-"})]})}),C8=A.memo(function({label:t,value:n}){return l.jsxs("div",{children:[l.jsx(B,{variant:"tinyMono",color:"light",children:t}),l.jsx(YG,{animationKey:n,variant:"entry-title-200",children:n})]})}),Gp={initial:{opacity:0,height:0,filter:"blur(2px)"},animate:{opacity:1,height:"auto",filter:"blur(0px)"},exit:{opacity:0,height:0,filter:"blur(2px)"},transition:{duration:.3,ease:rr}},w8=A.memo(function({time:t,actualTime:n,estimatedTime:r,timezone:s,terminal:a,gate:o,variant:i="departure",delayed:c=!1,cancelled:u=!1}){const{locale:d,$t:m}=Q(),p=f.useMemo(()=>m(i==="departure"?{id:"BtqAemWTLK",defaultMessage:"Departure"}:{id:"WOIPGxfmZn",defaultMessage:"Arrival"}),[i,m]),h=i==="arrival",g=f.useMemo(()=>{const _=n||r;return _&&_.getTime()===t.getTime()?null:_},[n,r,t]),y=f.useMemo(()=>t.toLocaleTimeString(d,{hour:"numeric",minute:"2-digit",timeZone:s}),[t,s,d]),b=f.useMemo(()=>g?.toLocaleTimeString(d,{hour:"numeric",minute:"2-digit",timeZone:s}),[g,s,d]),x=f.useMemo(()=>t.toLocaleDateString(d,{weekday:"short",month:"short",day:"numeric",timeZone:s}),[t,s,d]);return l.jsxs("div",{className:"gap-md col-span-3 flex min-w-0 flex-col justify-between",children:[l.jsxs("div",{className:z("gap-sm flex flex-col",h&&"items-end"),children:[l.jsxs(B,{variant:"tinyMono",color:"default",className:"gap-sm flex flex-row whitespace-nowrap",children:[p,l.jsxs("span",{children:[" | ",x]})]}),l.jsxs("div",{className:z("flex flex-col",h&&"items-end"),children:[l.jsx(YG,{animationKey:y,as:"span",variant:"entry-title-200",color:c?"negative":"super",className:z("-translate-y-px !font-mono transition-colors duration-500",u&&"text-quiet line-through"),children:g?b:y}),l.jsx(Wt,{initial:!1,children:g&&l.jsx(ze.div,{initial:Gp.initial,animate:Gp.animate,exit:Gp.exit,transition:Gp.transition,className:"overflow-hidden",children:l.jsx(B,{as:"span",variant:g?"small":"entry-title-200",color:"super",className:z("-translate-y-px !font-mono",g&&"!text-quiet line-through"),children:y})})})]})]}),l.jsx(MFe,{terminal:a,gate:o,alignEnd:h})]})}),TFe=ze(Y),AFe=A.memo(function({progress:t,departureTime:n,arrivalTime:r,delayed:s,cancelled:a,departureAirport:o,arrivalAirport:i}){const{$t:c}=Q(),u=f.useMemo(()=>Id(n,r,c),[n,r,c]),d=f.useMemo(()=>t===void 0||a?0:Math.max(0,Math.min(100,t)),[t,a]),{left:m,width:p}=f.useMemo(()=>({left:`${d}%`,width:`${d}%`}),[d]),h=f.useMemo(()=>({left:0}),[]),g=f.useMemo(()=>({duration:2,ease:rr,delay:.5}),[]),y=f.useMemo(()=>({left:m,opacity:1,scale:1}),[m]),b=f.useMemo(()=>({...h,opacity:0,scale:1.2,top:"50%",translateX:"-50%",translateY:"-50%"}),[h]),x=f.useMemo(()=>({width:p}),[p]);return l.jsx("div",{className:"px-xs order-last col-span-6 flex flex-col items-center justify-center sm:order-[unset] sm:px-0",children:l.jsxs("div",{className:"gap-md flex w-full flex-col items-center",children:[l.jsxs("div",{className:"gap-xs gap-x-2xl flex flex-row",children:[l.jsx(B,{variant:"entry-title-200",color:"default",className:"mr-md",children:o}),l.jsx(B,{variant:"tinyMono",color:"light",lineClamp:1,className:"whitespace-nowrap",children:u}),l.jsx(B,{variant:"entry-title-200",color:"default",className:"ml-md",children:i})]}),l.jsxs("div",{className:"relative flex w-full flex-1 items-center",children:[l.jsx("div",{className:"bg-inverse/10 relative h-0.5 w-full overflow-hidden rounded-full",children:l.jsx(ze.div,{className:"!bg-inverse/50 absolute inset-y-0 left-0 transition-colors duration-500",initial:h,animate:x,transition:g})}),l.jsx(TFe,{variant:"raised",className:"absolute left-0 flex aspect-square w-6 items-center justify-center",initial:b,animate:y,transition:g,children:l.jsx(ye,{className:z("text-quiet transition-colors duration-500",t&&t>0&&!s&&"!text-super",s&&"!text-negative",a&&"!text-quiet"),icon:D("plane")})})]})]})})}),NFe=A.memo(function({departureTime:t,arrivalTime:n,actualDepartureTime:r,actualArrivalTime:s,estimatedDepartureTime:a,estimatedArrivalTime:o,flightMetadata:i,delayed:c=!1}){const{cancelled:u,departure_airport:d,arrival_airport:m,departure_timezone:p,arrival_timezone:h,terminal:g,gate:y,arrival_terminal:b,arrival_gate:x,progress_percent:_}=i;return l.jsxs(Xn,{className:"p-md gap-md grid w-full grid-cols-2 overflow-hidden shadow-sm sm:grid-cols-12",children:[l.jsx(w8,{variant:"departure",time:t,actualTime:r,estimatedTime:a,timezone:p,terminal:g,gate:y,delayed:c,cancelled:u}),l.jsx(AFe,{departureTime:t,arrivalTime:n,progress:_,delayed:c,cancelled:u,departureAirport:d,arrivalAirport:m}),l.jsx(w8,{variant:"arrival",time:n,actualTime:s,estimatedTime:o,timezone:h,terminal:b,gate:x,delayed:c,cancelled:u})]})}),RFe=A.memo(function({flights:t,selectedFlight:n,setSelectedFlight:r}){const{locale:s,$t:a}=Q(),{isMobileStyle:o}=Be(),{formatDate:i}=Q(),c=f.useCallback(m=>{const p=new Date(m.departure_time),h=I2(p,m.departure_timezone);let g;if(g=i(p,{dateStyle:"short"}),t.filter(b=>{if(b.departure_timezone!==m.departure_timezone)return!1;const x=I2(new Date(b.departure_time),b.departure_timezone);return x.year===h.year&&x.month===h.month&&x.date===h.date}).length>1){const b=p.toLocaleTimeString(s,{hour:"numeric",minute:"2-digit"});g=a({id:"Fr3TxQz4BU",defaultMessage:"{dateString} - {timeString}"},{dateString:g,timeString:b})}return g},[s,t,a,i]),u=f.useMemo(()=>t.map(m=>({type:"default",text:c(m),value:m.flight_aware_id,onClick:()=>r(m),active:m.flight_aware_id===n?.flight_aware_id})),[t,c,r,n?.flight_aware_id]),d=f.useMemo(()=>n?c(n):"",[n,c]);return l.jsx("div",{children:l.jsx(bu,{items:u,isMobileStyle:o,children:l.jsx(st,{variant:"border",text:d,chevron:!0,pill:!0})})})}),DFe=A.memo(function({data:t}){const n=f.useMemo(()=>EFe(t.data.flights),[t.data.flights]),r=f.useMemo(()=>{const c=new Date().getTime();if(n.length===0)return 0;let u=0,d=1/0;return n.forEach((m,p)=>{m.forEach(h=>{const g=new Date(h.departure_time).getTime(),y=Math.abs(g-c);y<d&&(d=y,u=p)})}),u},[n]),[s,a]=f.useState(r),o=n[s],i=f.useMemo(()=>{if(n.length<2)return null;const c=n.map(u=>u[0]).filter(u=>!!u);return l.jsx(RFe,{flights:c,selectedFlight:o?.[0],setSelectedFlight:u=>{const d=n.findIndex(m=>m[0]?.flight_aware_id===u?.flight_aware_id);d!==-1&&a(d)}})},[n,o]);return!o||o.length===0?null:l.jsx(In,{"data-testid":"flight-status-widget",className:"w-full",variant:"noChrome",children:l.jsx(ss,{widgetType:"flight",widgetName:"flight_status",children:l.jsx("div",{className:"gap-md flex flex-col",children:o.map((c,u)=>{const d=wFe(c),m=SFe(d),p=u===0?i:null;return l.jsxs("div",{className:"gap-sm flex flex-col",children:[l.jsx(kFe,{flightMetadata:c,departureTime:d.departureTime,arrivalTime:d.arrivalTime,actualDepartureTime:d.actualDepartureTime,actualArrivalTime:d.actualArrivalTime,estimatedDepartureTime:d.estimatedDepartureTime,estimatedArrivalTime:d.estimatedArrivalTime,delayed:m,rightContent:p}),l.jsx(NFe,{departureTime:d.departureTime,arrivalTime:d.arrivalTime,actualDepartureTime:d.actualDepartureTime,actualArrivalTime:d.actualArrivalTime,estimatedDepartureTime:d.estimatedDepartureTime,estimatedArrivalTime:d.estimatedArrivalTime,flightMetadata:c,delayed:m})]},c.flight_aware_id)})})})})}),IFe=A.memo(function({data:{title:t,text:n,image_url:r,canonical_pages:s}}){const{isMobileStyle:a}=Be();return l.jsx(Dt,{href:s[0]?.url_web,children:l.jsxs(Xn,{shadow:!0,className:"p-sm relative flex items-center md:p-[12px]",bgHover:"subtle",children:[l.jsxs(Y,{className:"md:gap-md flex flex-1 items-center gap-[12px]",children:[r&&l.jsx("img",{alt:"",className:"max-h-[65px] rounded-md",src:r}),l.jsxs("div",{className:"mr-sm w-full",children:[t&&l.jsxs(B,{className:"text-pretty",variant:a?"smallBold":"baseSemi",children:[t,l.jsx(ye,{icon:D("chevron-right"),className:"text-quiet ml-0.5 inline-flex -translate-y-px md:hidden",size:"sm"})]}),n&&l.jsx(B,{variant:a?"tinyRegular":"small",color:"light",className:"mt-0.5 text-pretty md:mt-0",children:n})]})]}),l.jsx(ye,{icon:D("chevron-right"),className:"text-quiet hidden md:block",size:"md"})]})})}),jFe=Pe(async()=>{const{HealthOnboardingWidget:e}=await W(async()=>{const{HealthOnboardingWidget:t}=await import("./HealthOnboardingWidget-CffHUyMh.js").then(n=>n.H);return{HealthOnboardingWidget:t}},__vite__mapDeps([413,2,3,5,1,6,7,8,9,414,15,13,12]));return{default:e}},{loading:()=>null,restricted:!0}),PFe=e=>{switch(e){case"HEALTH_ASSISTANT_ONBOARDING_WIDGET":return l.jsx(jFe,{});default:return null}},OFe=A.memo(function({widgetData:t}){const n=f.useMemo(()=>PFe(t.onboarding_widget_block_type),[t.onboarding_widget_block_type]);return n?l.jsx(ar,{fallback:null,children:l.jsx(ss,{widgetType:"onboarding",widgetName:t.onboarding_widget_block_type,children:n})}):null}),LFe=Pe(async()=>{const{CitationListModal:e}=await W(async()=>{const{CitationListModal:t}=await import("./CitationListModal-4_bfX56k.js");return{CitationListModal:t}},__vite__mapDeps([411,2,3,5,1,412,6,7,8,9,15,34,35,36,13,12,14,16,17]));return{default:e}}),FFe=A.memo(function({webResults:t,size:n="tiny",pill:r=!1,text:s,onViewAllClick:a,selected:o,variant:i="text"}){const{openModal:c}=Kt(),u=f.useCallback(()=>{a?a():c(LFe,{webResults:t})},[a,c,t]),d=f.useMemo(()=>[...t].sort((p,h)=>{const g=xo(p),y=xo(h);return g&&!y?-1:!g&&y?1:0}),[t]),m=f.useMemo(()=>d.map(p=>{const h=em(p),g=p.meta_data;return{url:p.url??"",isAttachment:p.is_attachment??!1,source:typeof g?.citation_domain_name=="string"?g.citation_domain_name:void 0,brandedVisual:h?.visual}}),[d]);return l.jsx("div",{className:z("rounded-full",{"bg-subtle":o}),children:l.jsx(at,{variant:i,size:n,onClick:u,pill:r,children:l.jsxs("div",{className:"text-quiet font-normal gap-x-sm flex flex-row -ml-0.5",children:[l.jsx(PE,{sources:m,count:Math.min(m.length,3)}),s??l.jsx(be,{id:"WrpI57Uej/",defaultMessage:"{count, plural, one {# source} other {# sources}}",values:{count:t.length}})]})})})}),UFe=A.memo(function({sources:t,size:n="tiny",pill:r=!1,text:s,variant:a}){const o=f.useMemo(()=>{if(!t||t.length===0)return[];if(typeof t[0]=="string")return Array.from(new Set(t)).map(d=>({url:d,name:d,snippet:""}));const i=t,c=new Map;for(const u of i)c.has(u.url)||c.set(u.url,u);return Array.from(c.values()).map(u=>({url:u.url,name:u.title||u.url,snippet:u.snippet||""}))},[t]);return l.jsx(FFe,{webResults:o,size:n,pill:r,text:s,variant:a})}),S8=250;function BFe(e,t,n){const r=(t??"light")==="dark",s=e.filter(c=>!c.closedTime),a=e.filter(c=>!!c.closedTime).sort((c,u)=>{const d=c.closedTime?new Date(c.closedTime).getTime():0;return(u.closedTime?new Date(u.closedTime).getTime():0)-d}),o=[...s,...a].map((c,u)=>({...c,color:gOe(u,r)})),i=o.filter(n);return{unifiedMarkets:o,chartMarkets:i}}function HFe(e){return e&&e.length>0?new Set(e.map(t=>t.id)):void 0}const VFe=.001,E8=A.memo(function({change:t,variant:n="active",resolvedDate:r=null,resolvedOutcome:s="positive"}){const{locale:a}=Q();let o=t;if(n==="resolved"){const i=r?new Date(r).toLocaleDateString(a,{month:"short",day:"numeric"}):void 0;return l.jsx(Y,{className:"flex w-full items-center justify-center",children:i&&l.jsx(B,{as:"span",variant:"tiny",color:"light",className:"flex w-full items-center justify-center rounded bg-subtle px-[0.6em] py-[0.15em] font-mono",children:l.jsx("span",{className:"whitespace-nowrap",children:i})})})}return(t===null||Math.abs(t)<VFe)&&(o=0),l.jsx(Y,{className:"flex w-full items-center justify-center",children:l.jsx(ox,{change:(o??0)*100,variant:"tiny",includeIcon:!0,mono:!1,format:{style:"percent",minimumFractionDigits:1,maximumFractionDigits:1,signDisplay:"never"},className:"w-full"})})}),GFe=A.memo(function({marketCount:t,provider:n,href:r,visibleMarketsCount:s}){const{$t:a}=Q(),{isMobileStyle:o}=Be(),i=NI(n),c=s&&t>s?a({defaultMessage:"+{count} on {provider}",id:"aqcKaqAMBB"},{count:t-s,provider:i}):o||t<=2?i:a({defaultMessage:"View on {provider}",id:"x+8tBD0Kpk"},{provider:i});return l.jsx(Al,{href:r,target:"_blank",rel:"noopener",variant:"text",size:"tiny",children:l.jsx(B,{variant:"tinyRegular",color:"light",children:c})})}),zFe=["1h","6h","1d","1w","1m","max"],qFe={"1h":V({id:"Ifw0lcjnAL",defaultMessage:"1H"}),"6h":V({id:"YkLVNm/W6Q",defaultMessage:"6H"}),"1d":V({id:"aTX7LJbdI3",defaultMessage:"1D"}),"1w":V({id:"6bJGds1heu",defaultMessage:"1W"}),"1m":V({id:"1uz/I31pXU",defaultMessage:"1M"}),max:V({id:"peV3nrWw/A",defaultMessage:"MAX"})},$Fe=A.memo(function({endDate:t}){const{isMobileStyle:n}=Be(),{$t:r,locale:s}=Q(),a=new Date(t)<new Date,o=new Date(t).toLocaleString(s,{month:n?"numeric":"short",day:"numeric",hour:"numeric",minute:n?"2-digit":"numeric",year:"numeric",timeZoneName:n?void 0:"short"});return l.jsx("span",{children:a?r({defaultMessage:"Ended {date}",id:"JlzC3Uzxn5"},{date:o}):r({defaultMessage:"Ends {date}",id:"JQlKi/m/bV"},{date:o})})}),WFe=A.memo(function({title:t,image:n,volume:r,currency:s,endDate:a}){const{locale:o,$t:i}=Q(),{isMobileStyle:c}=Be();return l.jsx(Y,{className:"gap-md flex flex-col",children:l.jsxs(Y,{className:"gap-sm flex items-start",children:[n&&l.jsx("img",{src:n,alt:t,className:"bg-subtler aspect-square size-10 shrink-0 rounded-md object-cover mt-xs"}),l.jsxs(Y,{className:"min-w-0 flex-1",children:[l.jsx(B,{variant:c?"section-title":"page-title",className:"min-w-0 leading-tight",children:t}),l.jsxs(Y,{className:"mt-xs flex flex-col items-stretch gap-xs md:flex-row md:gap-sm",children:[l.jsxs(B,{variant:"tinyRegular",color:"light",className:"gap-xs flex items-center",children:[l.jsx(ut,{name:D("coins"),className:"size-4"}),i({defaultMessage:"{volume} vol.",id:"fBnaWW/3DX"},{volume:r.toLocaleString(o,{style:s?"currency":void 0,currency:s??void 0,notation:"compact"})})]}),l.jsxs(B,{variant:"tinyRegular",color:"light",className:"gap-xs flex items-center",children:[l.jsx(ut,{name:D("clock"),className:"size-4"}),l.jsx($Fe,{endDate:a})]})]})]})]})})}),KFe=A.memo(function({market:t,useColor:n=!1,showDot:r=!0,compactPadding:s=!1,className:a,showOutcomeName:o=!1}){const{locale:i}=Q(),c=!!t.closedTime,u=c&&t.outcomes?t.outcomes[t.outcomePrices.indexOf(Math.max(...t.outcomePrices))]:void 0,d=t.probability<.001?"<0.1%":t.probability.toLocaleString(i,{style:"percent",minimumFractionDigits:1,maximumFractionDigits:1}),m=Math.sqrt(t.probability),p=o&&t.outcomes?.length===2&&!c?`${t.question} (${t.outcomes[0]})`:t.question;return l.jsxs(Y,{className:z("grid grid-cols-[minmax(0,1fr)_auto_56px] items-center gap-x-sm border-b border-subtlest py-sm",s?"px-md":"px-sm",a),children:[l.jsxs("div",{className:"flex items-center gap-sm",children:[r&&l.jsx("span",{className:z("size-2 shrink-0 rounded-full",{"border border-subtle":!n}),style:n?{backgroundColor:t.color}:void 0}),l.jsx(B,{variant:"small",color:t.emphasized?"super":s?"light":"default",className:"min-w-0 break-words",children:p})]}),l.jsx("div",{className:"flex items-center justify-end gap-xs",children:c?l.jsxs(l.Fragment,{children:[u&&l.jsx(B,{variant:"small",color:"default",children:u}),l.jsx(ut,{name:D(u?.toLowerCase()==="no"?"x":"check"),size:16,className:z("shrink-0",u?.toLowerCase()==="no"?"text-caution dark:text-rosa":"text-super")})]}):l.jsx(B,{variant:"smallBold",className:"whitespace-nowrap font-mono",style:{color:`color-mix(in oklch, oklch(var(--foreground-color)) ${m*100}%, oklch(var(--foreground-quiet-color)))`},children:d})}),l.jsx("div",{className:"flex items-center justify-center",children:c?l.jsx(E8,{change:null,variant:"resolved",resolvedDate:t.closedTime}):l.jsx(E8,{change:t.change,variant:"active"})})]})}),YFe=A.memo(function({updatedAt:t,useCompact:n=!1}){const r=Q(),{$t:s}=r,{isMobileStyle:a}=Be(),o=f.useMemo(()=>mF(r,new Date(t),{style:"short",numeric:"auto"})||s({defaultMessage:"Now",id:"tgvES0v2HS"}),[t,r,s]);return l.jsxs(B,{variant:"tinyRegular",color:"light",className:"flex items-center gap-xs min-w-0",children:[(a||n)&&l.jsx(ut,{name:D("clock"),className:"size-3 shrink-0"}),l.jsx("span",{className:"truncate",children:a||n?o:s({defaultMessage:"Updated {date}",id:"vbMp1ubkut"},{date:o})})]})});A.memo(function({volume:t,currency:n,compact:r=!1,hideIcon:s=!1}){const{locale:a,$t:o}=Q(),{isMobileStyle:i}=Be();return l.jsxs(B,{variant:"tinyRegular",color:"light",className:"gap-xs flex items-center",children:[!s&&l.jsx(ut,{name:D("coins"),className:"size-4"}),o({defaultMessage:"{volume} vol.",id:"fBnaWW/3DX"},{volume:t.toLocaleString(a,{style:n?"currency":void 0,currency:n??void 0,notation:r||i?"compact":void 0})})]})});const QFe=A.memo(function({markets:t,chartMarketIds:n,initialDisplayCount:r=5}){const[s,a]=f.useState(!1),{$t:o}=Q(),{isMobileStyle:i}=Be(),c=t.length>r,u=f.useMemo(()=>{if(s)return t;const p=t.find(g=>g.emphasized);return(p?t.indexOf(p):-1)<r||!p?t.slice(0,r):t.slice(0,r-1).concat([p])},[t,s,r]),d=s?o({id:"GZo7vgc3wE",defaultMessage:"See less"}):o({id:"yRf8D7UY6g",defaultMessage:"See {count} more"},{count:t.length-r}),m=t.length===1;return l.jsxs(Y,{className:"-mx-md flex flex-col pt-0",children:[u.map(p=>l.jsx(KFe,{market:p,useColor:n?.has(p.id)??!1,showOutcomeName:m},p.id)),c&&l.jsx(l.Fragment,{children:i?l.jsx(Y,{className:"mx-md my-sm",children:l.jsx(at,{fullWidth:!0,size:"tiny",onClick:()=>a(!s),variant:"secondary",children:d})}):l.jsx(Y,{className:"ml-sm mt-xs flex justify-start",children:l.jsx(at,{size:"tiny",onClick:()=>a(!s),variant:"text",children:d})})})]})});A.memo(function({commentary:t,sourceUrls:n,variant:r="small",className:s}){return l.jsxs(Y,{className:"gap-sm flex flex-col items-start",children:[l.jsx(B,{variant:r,className:s,children:t}),n&&n.length>0&&l.jsx(UFe,{sources:n,size:"tiny",pill:!0,variant:"secondary"})]})});const k8=50,XFe=(e,t,n)=>{const r=new Date(e),s=new Date(t),a=r.getFullYear()===s.getFullYear()&&r.getMonth()===s.getMonth()&&r.getDate()===s.getDate(),o=r.getFullYear()===s.getFullYear()&&r.getMonth()===s.getMonth(),i=r.getFullYear()===s.getFullYear();return a?c=>{const u=c.getMinutes()!==0;return c.toLocaleTimeString(n,{hour:"numeric",minute:u?"numeric":void 0})}:o?c=>c.toLocaleDateString(n,{month:"short",day:"numeric",hour:"numeric"}):i?c=>c.toLocaleDateString(n,{month:"short",day:"numeric"}):c=>c.toLocaleDateString(n,{year:"numeric",month:"short"})},ZFe=({x:e,y:t,color:n,r=4,animationId:s})=>l.jsxs("g",{children:[l.jsx(ze.circle,{cx:e,cy:t,r,fill:"none",stroke:n,strokeWidth:2,initial:{r,opacity:1},animate:{r:r*4,opacity:0},transition:{duration:1.5,ease:"easeOut"},style:{pointerEvents:"none"}},`${s}`),l.jsx("circle",{cx:e,cy:t,r,fill:n,stroke:"oklch(var(--background-color))",strokeWidth:2,style:{pointerEvents:"none"}})]}),JFe=({data:e,animationId:t})=>e.map(n=>l.jsx(ZFe,{x:n.x,y:n.y,color:n.market.color,animationId:t},n.market.question)),eUe=({data:e,locale:t,decimalPlaces:n=3})=>{const r=Math.max(0,n-2),s=e[0]?.timestamp,a=f.useMemo(()=>s?new Date(s).toLocaleDateString(t,{month:"short",day:"numeric",hour:"numeric",minute:"numeric"}):null,[s,t]),o=e.length===1;return l.jsxs(Y,{className:"space-y-xs px-sm py-xs",children:[l.jsx(B,{variant:"tinyRegular",color:"light",children:a}),e.map(i=>{const c=o&&i.market.outcomes?.length===2?i.market.outcomes[0]:i.market.question;return l.jsxs(Y,{className:"gap-xs flex items-center",children:[l.jsx("div",{className:"size-2 rounded-full",style:{backgroundColor:i.market.color}}),l.jsxs(B,{variant:"tinyRegular",color:"default",children:[c,":"," ",i.data.probability.toLocaleString(t,{style:"percent",minimumFractionDigits:r,maximumFractionDigits:r})]})]},i.market.question)})]})},tUe=Sm(e=>new Date(e.timestamp)).left,nUe=(e,t,n)=>{if(!n?.length)return{d:null,index:0,x:e};const r=t.invert(e),s=Math.max(0,Math.min(tUe(n,r),n.length-1)),a=n[s-1],o=n[s];let i=Math.max(0,s-1);if(a&&o){const u=Math.abs(t(new Date(o.timestamp))-e),d=Math.abs(t(new Date(a.timestamp))-e);u<d&&(i=s)}const c=n[i];return{d:c,index:i,x:t(new Date(c.timestamp))}},rUe=({markets:e,xScale:t,yScale:n,xBounds:r})=>{const{tooltipData:s,hideTooltip:a,showTooltip:o}=sx(),i=f.useCallback(c=>{const u=Fm(c);if(!u)return;const d=N3(c),m=Math.min(Math.max(r[0],u.x),r[1]),p=e.map(h=>{if(!h.history)return null;const g=nUe(m,t,h.history);return g.d?{market:h,data:g.d,x:t(new Date(g.d.timestamp))??0,y:n(g.d.probability),timestamp:g.d.timestamp}:null}).filter(h=>h!==null);p.length&&o({tooltipData:{hits:p,point:{local:{x:u.x,y:Math.max(0,u.y-Ir)},global:d}}})},[e,t,n,o,r]);return f.useMemo(()=>({tooltipData:s,hideTooltip:a,showTooltip:i}),[s,a,i])},sUe=({l:e,history:t,color:n})=>{const r=f.useMemo(()=>e(t),[e,t]),s=ix(r,!0,Qa);return l.jsx(Jr.path,{d:s,stroke:n,strokeWidth:1.75,fill:"none",shapeRendering:Uu})},aUe=A.memo(function({markets:t,width:n,height:r,updatedAt:s,uiHints:a}){const{locale:o}=Q(),i=f.useMemo(()=>Hu({domain:Os(t.flatMap(T=>T.history??[]),T=>new Date(T.timestamp)),range:[0,n-k8]}),[t,n]),c=f.useMemo(()=>{const T=a?.lowerBound,k=a?.upperBound;if(T!=null&&k!==void 0&&k!==null)return So({domain:[T,k],range:[r-Ir,Ic]});const M=t.flatMap(R=>(R.history??[]).map(I=>I.probability));if(!M.length)return So({domain:[0,1],range:[r-Ir,Ic]});const[N,P]=Os(M),O=(P-N)*.1,L=Math.max(0,N-O),H=Math.min(1,P+O);return So({domain:[L,H],range:[r-Ir,Ic]})},[t,r,a]),u=f.useMemo(()=>Fo().x(T=>i(new Date(T.timestamp))).y(T=>c(T.probability)).curve(Fy),[i,c]),d=f.useMemo(()=>c.ticks(5).length>6?c.ticks(4).length>6?c.ticks(4).slice(1,-1):c.ticks(4):c.ticks(5),[c]),m=f.useMemo(()=>i.ticks(5),[i]),p=f.useMemo(()=>{const T=t.flatMap(P=>P.history??[]);if(!T.length)return P=>P.toLocaleDateString(o);const k=new Date(T[0].timestamp),M=new Date(T[T.length-1].timestamp),N=XFe(k,M,o);return P=>N(P)},[t,o]),h=f.useMemo(()=>FH({ticks:m,xScale:i,width:n,formatter:T=>p(T),marginRight:k8}),[m,i,n,p]),g=f.useCallback(()=>({fill:Pn.gray,fontSize:12,dy:"-5px",textAnchor:"end",fontFamily:"var(--font-family-sans)"}),[]),y=T=>{const k=T.toString(),M=k.indexOf(".");return M===-1?0:k.length-M-1},b=f.useCallback(T=>{const k=Math.max(...d.map(N=>y(N))),M=Math.max(0,k-2);return T.toLocaleString(o,{style:"percent",maximumFractionDigits:M,minimumFractionDigits:M})},[o,d]),x=f.useMemo(()=>`prediction-market-${t[0]?.question??"chart"}`,[t]),_=f.useMemo(()=>[0,n],[n]),{tooltipData:v,hideTooltip:C,showTooltip:w}=rUe({markets:t,xScale:i,yScale:c,xBounds:_}),S=f.useMemo(()=>v?v.hits:t.map(T=>{const k=T.history?.[T.history.length-1];return k?{market:T,data:k,x:i(new Date(k.timestamp))??0,y:c(k.probability),timestamp:k.timestamp}:null}).filter(T=>T!==null),[v,t,i,c]),E=f.useMemo(()=>{const T=t.flatMap(k=>(k.history??[]).map(M=>M.probability));return T.length?T.reduce((k,M)=>Math.max(k,y(M)),0):2},[t]);return l.jsxs("div",{className:D3,onMouseMove:w,onMouseLeave:C,onTouchStart:w,onTouchMove:w,onTouchEnd:C,children:[l.jsxs("svg",{height:r,width:n,className:R3,children:[l.jsx(Wt,{initial:!1,mode:"wait",children:l.jsxs(ze.g,{initial:{opacity:0},animate:{opacity:1},transition:di,children:[l.jsx(ql,{tickValues:d,scale:c,width:n,stroke:Pn.gray,strokeWidth:1,opacity:.1,className:"transition-all duration-1000"}),l.jsx(Zy,{scale:i,opacity:.1,height:r*2,stroke:Pn.gray,style:{transform:`translateY(-${r}px)`},tickValues:h,strokeWidth:1})]},x)}),l.jsx(Wt,{mode:"wait",children:l.jsxs(ze.g,{initial:{opacity:0},exit:{opacity:0,transition:{duration:0,delay:0}},animate:{opacity:1},transition:di,children:[l.jsx(_i,{scale:c,hideTicks:!0,hideAxisLine:!0,tickValues:d,left:n,orientation:"left",tickFormat:b,tickLabelProps:g}),l.jsx(_i,{scale:i,hideAxisLine:!0,hideTicks:!0,tickValues:h,tickFormat:p,orientation:"bottom",top:r-Ir,tickLabelProps:j3})]},x)}),t.map(T=>l.jsx(sUe,{l:u,history:T.history,color:T.color},T.question)),l.jsx(Wt,{children:v&&l.jsx(c5,{marginTop:-r,tooltipLeft:v.point.local.x,innerHeight:r*3,color:Pn.gray})}),l.jsx(JFe,{data:S,animationId:s})]}),v&&l.jsx(yu,{children:l.jsx(ax,{x:v.point.global.x,y:v.point.global.y,children:l.jsx(eUe,{data:v.hits,locale:o,decimalPlaces:E})})})]})}),oUe=A.memo(function({eventId:t,event:n,chartMarkets:r,periods:s,period:a,setPeriod:o}){const{isMobileStyle:i}=Be();return!r||r.length===0?null:l.jsxs(Y,{className:"gap-y-sm relative flex flex-col justify-between overflow-hidden border-b",children:[l.jsx(Y,{className:"z-[2] p-sm absolute inset-x-0 top-0 flex items-center justify-start",children:l.jsx(g5,{id:`prediction-market-${t}`,periods:s,period:a,setPeriod:o,variant:i?"sm":"lg"})}),l.jsx("div",{className:"absolute top-sm right-sm z-[2]",children:l.jsx(vg,{})}),l.jsx("div",{style:{paddingTop:Tf+16+20},className:"relative z-[1]",children:l.jsx(i5,{height:S8,render:!!n,children:c=>!c||c<100?null:l.jsx(aUe,{period:a,updatedAt:n.updatedDate,markets:r,width:c,height:S8,uiHints:n.uiHints})})})]})}),iUe=({eventId:e,historyPeriod:t,marketsSort:n,withCommentary:r,emphasizedMarketIds:s})=>Se.makeEphemeralQueryKey("finance/prediction-markets/quote",e,t,n,r,s);async function lUe({eventId:e,historyPeriod:t,marketsSort:n="probability",withCommentary:r,emphasizedMarketIds:s}){const a=await ve.GET("/rest/finance/prediction-markets/quote/{event_id}",Ty,{params:{path:{event_id:e},query:{history_period:t,markets_sort:n,with_commentary:r,emphasized_market_ids:s}},timeoutMs:ky,numRetries:My,shouldNotAddSourceVersionQueryParams:n3});if(a.error)throw new Error("Failed to fetch polymarket quote",{cause:a.error});return a.data}const M8=({href:e,eventId:t})=>{const{isMobileStyle:n}=Be(),{$t:r}=Q(),{session:s}=je(),{trackEvent:a}=Ze(s),o=f.useCallback(()=>{a("predictions link clicked",{referrer:I7e.PREDICTIONS_WIDGET,targetPageType:j7e.ASSET_PAGE,eventId:t,destinationUrl:e})},[a,t,e]);return l.jsx(Y,{className:"gap-sm flex items-center justify-center",children:l.jsx(st,{variant:"primaryGhost",chevron:!0,chevronIcon:D("chevron-right"),text:r({defaultMessage:"Deep Dive on {pplxFinance}",id:"QX457HdJyA"},{pplxFinance:"Perplexity Finance"}),size:"small",href:e,onClick:o,fullWidth:n})})},cUe=({event:e})=>{const{isMobileStyle:t}=Be();return t&&e.uiHints?.canonicalPage?.urlWeb?l.jsx(M8,{href:e.uiHints.canonicalPage.urlWeb,eventId:e.id}):l.jsxs(Y,{className:"gap-xs pt-sm flex items-baseline justify-between",children:[l.jsx(YFe,{updatedAt:e.updatedDate}),!!e.uiHints?.canonicalPage?.urlWeb&&l.jsx(M8,{href:e.uiHints.canonicalPage.urlWeb,eventId:e.id}),l.jsx(GFe,{href:e.eventUrl,marketCount:e.markets?.length??0,provider:e.provider})]})},uUe=A.memo(function({eventId:t,eventData:n}){const[r,s]=f.useState("max"),{$t:a}=Q(),o=f.useMemo(()=>n?.uiHints?.emphasizedMarketIds??[],[n?.uiHints?.emphasizedMarketIds]),i={eventId:t,historyPeriod:r,marketsSort:"probability",emphasizedMarketIds:o},{data:c}=gt({queryKey:iUe(i),queryFn:()=>lUe(i),enabled:!!t,refetchInterval:h=>{const g=h.state.data,y=n?.uiHints?.refetchIntervalSecs??g?.uiHints?.refetchIntervalSecs;return y?y*1e3:!1},refetchIntervalInBackground:!1,placeholderData:h=>h||n,staleTime:0}),{colorScheme:u}=Cs(),{unifiedMarkets:d,chartMarkets:m}=f.useMemo(()=>c?.markets?BFe(c.markets,u,h=>!h.closedTime&&!!(h.history&&h.history.length>0)):{unifiedMarkets:void 0,chartMarkets:void 0},[c?.markets,u]),p=f.useMemo(()=>(c?.uiHints?.periods??zFe).map(h=>({value:h,text:a(qFe[h])})),[c?.uiHints?.periods,a]);return!c||!d?null:l.jsxs(Y,{className:"rounded-xl border",variant:"raised",children:[l.jsx(Y,{className:"px-md py-sm",children:l.jsx(WFe,{title:c.title,image:c.icon,volume:c.volume,currency:c.currency,endDate:c.endDate})}),l.jsx(oUe,{eventId:t,event:c,chartMarkets:m,periods:p,period:r,setPeriod:s}),l.jsxs(Y,{className:"px-md pb-sm pt-0",children:[d&&d.length>0&&l.jsx(QFe,{markets:d,chartMarketIds:HFe(m)}),l.jsx(cUe,{event:c})]})]})}),dUe=A.memo(function({data:t}){return l.jsx(LW,{fallback:null,children:l.jsx(ss,{widgetType:"predictions",widgetName:"prediction_market",children:l.jsx(uUe,{eventId:t.id,eventData:t})})})}),QG=Bt("ScrollToWidgetContext",{selectedWidgetId:void 0,scrollToWidget:()=>{},entityRefs:{}}),XG=()=>{const e=f.useContext(QG);if(!e)throw new Error("useScrollToWidget must be used within ScrollToWidgetContext");return e},fUe=A.memo(function({children:t,entities:n}){const[r,s]=f.useState({}),[a,o]=f.useState(void 0),{scrollContainerRef:i}=xa(),c=f.useRef(null);f.useEffect(()=>()=>{s({})},[]),f.useEffect(()=>{s(d=>{const m=d;let p=!1;return n?.map(h=>{const g=ry(h);if(!g)return;if(g.object==="ShopifyWidget"){const b=g.id;if(!r[b]){p=!0;const x=f.createRef();m[b]=x}}}),p?m:d})},[n,r]);const u=d=>{c.current&&clearTimeout(c.current);const m=r[d]?.current;if(m&&i?.current){const h=m.getBoundingClientRect().top+i.current?.scrollTop-200;i?.current?.scrollTo({top:h,behavior:"smooth"})}o(d),c.current=setTimeout(()=>{o(void 0)},2e3)};return l.jsx(QG.Provider,{value:{selectedWidgetId:a,scrollToWidget:u,entityRefs:r},children:t})}),ZG=Bt("EntityContext",{entityId:"",menuItems:void 0,variant:void 0}),Bm=()=>{const e=f.useContext(ZG);if(!e)throw new Error("useEntity must be used within EntityContext");return e},mUe=({children:e,id:t,menuItems:n,className:r,entityVariant:s})=>l.jsx(ZG.Provider,{value:{entityId:t,menuItems:n,variant:s},children:l.jsx(Xn,{variant:s==="hide-chrome"?"transparent":void 0,className:z("group/card flex flex-col",{"p-md":s!=="hide-chrome"},r),children:e})}),pUe=({className:e,...t})=>l.jsx(Y,{className:z("gap-sm md:gap-md relative flex flex-col rounded-lg md:flex-row",e),...t}),hUe=({primaryButtonText:e,onPrimaryButtonClick:t,listNumber:n,className:r,children:s,...a})=>l.jsxs("div",{className:z("relative md:w-[calc(30%_-_8px)]",r),...a,children:[l.jsxs("div",{className:"gap-md flex h-full flex-col justify-between",children:[s,e&&t&&l.jsx("div",{className:"flex flex-col items-stretch md:max-w-[160px]",children:l.jsx(st,{text:e,variant:"primary",onClick:t,pill:!0,size:"small"})})]}),typeof n=="number"&&l.jsx(B,{variant:"smallCaps",color:"light",className:"border-subtler bg-base absolute -left-1.5 -top-1.5 flex size-5 shrink-0 items-center justify-center rounded-full border shadow-sm",children:n})]}),gUe=({className:e,buttonProps:t,secondaryButtonProps:n,trailingComponent:r,children:s,...a})=>{const{menuItems:o}=Bm();return l.jsx("div",{className:z("flex min-w-0 flex-1 flex-col",e),...a,children:l.jsxs("div",{className:"gap-sm md:gap-md flex flex-1 flex-col justify-between rounded-lg",children:[l.jsx("div",{className:"gap-xs flex flex-col justify-between",children:l.jsx("div",{className:"gap-xs my-sm relative flex flex-col md:mt-0",children:s})}),(t||n)&&l.jsxs("div",{className:"gap-sm flex w-full items-center",children:[t&&l.jsx(st,{variant:"primary",pill:!0,size:"small",...t,extraCSS:`${t.extraCSS} w-full max-w-[160px]`}),n&&l.jsx(st,{variant:"border",pill:!0,size:"small",...n,extraCSS:`${n.extraCSS}`}),r,o&&o.length>0&&l.jsx("div",{className:"duration-150 group-hover/card:opacity-100 md:opacity-0",children:l.jsx(In.Menu,{menuItems:o,placement:"bottom-start"})})]})]})})},yUe=({title:e,onTitleClick:t,className:n,variant:r})=>{const{selectedWidgetId:s}=XG(),{entityId:a}=Bm(),{isMobileStyle:o}=Be();return l.jsx("div",{onClick:()=>t?.(),className:n,children:l.jsx(B,{variant:r??(o?"section-title":"entry-title"),lineClamp:3,className:z("!leading-tight md:text-2xl",{"duration-fast cursor-pointer hover:opacity-70":!!t}),children:l.jsx("span",{className:z("duration-normal rounded-md",{"bg-super/10":s===a}),children:e})})})},xUe=({loading:e,className:t,onClick:n,trailingText:r})=>{const{$t:s}=Q();return l.jsxs(Y,{className:z("group relative flex h-12 items-center",{"opacity-50":e,"cursor-pointer":!e},t),onClick:e?void 0:n,children:[!e&&l.jsx(Y,{variant:"subtle",className:"inset-y-xs absolute -inset-x-3 rounded-md opacity-0 duration-150 group-hover:opacity-100"}),l.jsxs("div",{className:"relative w-full",children:[l.jsxs("div",{className:z("gap-md relative flex w-full items-center justify-between",{"opacity-0":e}),children:[l.jsx(B,{variant:"smallBold",color:"light",children:s({defaultMessage:"View More",id:"QQSdHPJWXu"})}),l.jsxs(B,{variant:"tiny",color:"light",className:"gap-sm flex items-center",children:[r,l.jsx(ye,{icon:D("chevron-right"),size:"xs"})]})]}),e&&l.jsxs("div",{className:"absolute inset-0 flex items-center justify-between",children:[l.jsx(Y,{className:"h-2 w-[100px] rounded-full",variant:"subtle"}),l.jsx(ye,{icon:D("chevron-right"),className:"text-quietest",size:"sm"})]})]})]})},bUe=({title:e,className:t,children:n,trailingContent:r,defaultExpanded:s=!1})=>{const[a,o]=f.useState(!s);return l.jsxs(Y,{className:t,children:[l.jsxs("div",{onClick:()=>o(!a),className:"group relative flex h-12 cursor-pointer select-none items-center justify-between",children:[l.jsx(Y,{variant:"subtle",className:"inset-y-xs absolute -inset-x-3 rounded-md opacity-0 duration-150 group-hover:opacity-100"}),l.jsx(B,{variant:"smallBold",color:"light",className:"relative shrink-0 whitespace-nowrap",children:e}),l.jsxs("div",{className:"gap-md relative flex min-w-0 items-center",children:[r&&l.jsx("div",{className:"gap-xs flex min-w-0 items-stretch ml-4",children:r}),l.jsx(ye,{icon:D("chevron-down"),className:z("text-foreground relative shrink-0 opacity-50",{"rotate-180":!a}),size:"sm"})]})]}),l.jsx(ba,{transition:{ease:HN(.16,1,.3,1),duration:.2},initial:!1,children:!a&&l.jsx(bs,{transition:{duration:.1},exit:{y:-5,opacity:0},animate:{y:0,opacity:1},initial:{y:-5,opacity:0},children:l.jsx("div",{className:"pb-4",children:n})})})]})},dQe=mUe,fQe=pUe,mQe=yUe,T8=bUe,pQe=hUe,hQe=gUe,gQe=xUe,yQe=A.memo(function({inFlight:t,chooseIfReason:n,chooseIfLeadInCopy:r,pros:s,cons:a,className:o,viewState:i="collapsed",id:c,showBuyIf:u=!0}){const d=!n&&t;return l.jsx(Tr,{active:d,className:z("relative",o),children:l.jsx(ba,{children:l.jsx(bs,{children:l.jsxs("div",{className:"gap-sm mt-md relative flex flex-col rounded-md md:mx-0",children:[u&&l.jsx(_Ue,{reason:n,leadInCopy:r,loading:d}),l.jsx(tz,{pros:s??_e,cons:a??_e,loading:d,viewState:i,id:c})]})})})})}),_Ue=A.memo(function({reason:t,leadInCopy:n,loading:r,textVariant:s="base"}){const{variant:a}=Bm();return!t&&!r?null:l.jsx("div",{className:"flex items-start gap-[12px] rounded-md md:items-center",children:l.jsx("div",{className:"w-full",children:r?l.jsxs("div",{className:"gap-sm pb-sm flex flex-col",children:[l.jsx(Y,{variant:a==="hide-chrome"?"subtler":"subtle",className:"h-2 w-full rounded-full"}),l.jsx(Y,{variant:a==="hide-chrome"?"subtler":"subtle",className:"h-2 rounded-full"}),l.jsx(Y,{variant:a==="hide-chrome"?"subtler":"subtle",className:"h-2 w-1/2 rounded-full"})]}):l.jsxs(B,{variant:s,children:[l.jsx("span",{className:"font-medium",children:n})," ",t]})})})}),JG=3,ez=2,tz=A.memo(function({pros:t,cons:n,loading:r,className:s,viewState:a="collapsed",id:o,scrollOnMobile:i=!0}){return!r&&t.length===0&&n.length===0?null:l.jsx("div",{className:s,children:a==="collapsed"?l.jsx(CUe,{loading:r,pros:t,cons:n,id:o,scrollOnMobile:i}):l.jsx(wUe,{loading:r,pros:t,cons:n})})}),vUe=A.memo(function({children:t,loading:n,scrollOnMobile:r=!0}){const{isMobileStyle:s}=Be(),{variant:a}=Bm();return s&&r?l.jsx("div",{className:"-mx-md",children:l.jsx(zf,{orientation:"horizontal",showScrollIndicator:!1,children:l.jsx("div",{className:"flex",children:l.jsx("ul",{className:"gap-sm px-md flex shrink-0",children:t})})})}):l.jsx("ul",{className:z("flex flex-wrap",{"gap-0":a==="dense-card"&&!n,"gap-sm":a!=="dense-card"||n}),children:t})}),CUe=A.memo(function({loading:t,pros:n,cons:r,id:s,scrollOnMobile:a=!0}){return l.jsx(vUe,{loading:t,scrollOnMobile:a,children:l.jsx(Wt,{initial:!1,children:l.jsx(e0,{children:t?Array.from({length:3}).map((o,i)=>l.jsx(f2,{asPlaceholder:!0,text:"",type:"con",label:"",id:s},i)):l.jsxs(l.Fragment,{children:[n.map(o=>l.jsx(f2,{text:o.description,type:"pro",label:o.label,id:s},o.label+s)).slice(0,JG),r.map(o=>l.jsx(f2,{text:o.description,type:"con",label:o.label,id:s},o.label+s)).slice(0,ez)]})})})})}),wUe=A.memo(function({loading:t,pros:n,cons:r}){return l.jsx("div",{className:"-mx-6",children:l.jsx(zf,{orientation:"horizontal",showScrollIndicator:!1,children:l.jsx("ul",{className:"gap-sm flex px-6",children:t?Array.from({length:3}).map((s,a)=>l.jsx(SUe,{},a)):l.jsxs(l.Fragment,{children:[n.map(s=>l.jsx(A8,{text:s.description,type:"pro",label:s.label},s.label)).slice(0,JG),r.map(s=>l.jsx(A8,{text:s.description,type:"con",label:s.label},s.label)).slice(0,ez)]})})})})}),f2=A.memo(function({text:t,label:n,type:r,asPlaceholder:s,id:a}){const{session:o}=je(),{trackEvent:i}=Ze(o),{variant:c}=Bm(),u=()=>{s||i("shopping pro con hover",{type:r,label:n})},d={initial:{opacity:0,x:-3},animate:{opacity:1,x:0}},m=f.useMemo(()=>l.jsx("div",{className:"p-sm pointer-events-none translate-y-0",children:l.jsx(B,{variant:"small",children:t})}),[t]);return l.jsx(ze.li,{variants:d,initial:"initial",animate:"animate",transition:{duration:.1,ease:lf},className:z("group inline-flex shrink-0 cursor-default rounded-full duration-150",{"gap-xs":c!=="dense-card","gap-sm":c==="dense-card","hover:bg-subtler":!s,"border-subtlest border duration-150":!s&&c!=="dense-card","!border-transparent !bg-transparent":s}),onMouseEnter:u,children:l.jsx(h5,{hoverOpen:!0,placement:"bottom-start",contentWidth:"200px",removeScroll:!1,content:m,isMobileStyle:!1,delayTime:1,disabled:s,hasInteractiveContent:!1,childrenClassName:"inline-flex",children:l.jsxs("div",{className:z("p-xs relative inline-flex items-center pr-[10px]",{"bg-subtler dark:bg-subtle":s,"h-[26px] rounded-full":s,"gap-2xs":c==="dense-card","gap-xs":c!=="dense-card"}),children:[l.jsx("div",{className:z("size-md flex shrink-0 items-center justify-center rounded-full",{"text-super":r==="pro"},{"text-quiet":r==="con"},{"bg-transparent":s}),children:l.jsx(B,{variant:"tiny",color:r==="pro"?"super":"light",className:"inline-flex",children:l.jsx(ye,{className:s?"opacity-0":"",icon:r==="pro"?D("check"):D("x"),size:"xs"})})}),s?l.jsx(B,{variant:"tiny",className:"w-10 shrink-0",children:""}):l.jsx(B,{variant:"tiny",color:"light",children:l.jsx("span",{className:z({"text-super":r==="pro"}),children:n})})]})})},n+a)}),SUe=A.memo(function(){return l.jsx(Y,{className:"p-sm h-[136px] w-[200px] rounded-md",variant:"subtler"})}),A8=A.memo(function({text:t,label:n,type:r}){return l.jsxs(Y,{className:"p-sm w-[200px] rounded-md",variant:"subtler",children:[l.jsxs("div",{className:"mb-2xs gap-xs flex items-center",children:[l.jsx(Y,{variant:r==="pro"?"super":"textColor",className:z("size-md flex shrink-0 items-center justify-center rounded-full",{"opacity-50":r==="con"}),children:l.jsx(ye,{icon:r==="pro"?D("check"):D("x"),className:"text-inverse shrink-0",size:"xs"})}),l.jsx(B,{variant:"smallBold",color:r==="pro"?"super":"light",children:n})]}),l.jsx(B,{variant:"small",color:"light",children:t})]})}),EUe={label:"",textColor:"",backgroundColor:"",gradientColor:"",high:null,low:null,fairBounds:null},nz=(e,t)=>{const{$t:n}=Q(),r=f.useMemo(()=>({low:{translation:n({defaultMessage:"This price is <span>low</span>",id:"4Q8ifhmVtL"},{span:u=>l.jsx("span",{className:"text-positive",children:u})}),textColor:"!text-positive",backgroundColor:"bg-positive",gradientColor:"bg-gradient-to-r from-positive to-transparent"},fair:{translation:n({defaultMessage:"This price is <span>fair</span>",id:"jXTaDslyVl"},{span:u=>l.jsx("span",{className:"text-attention",children:u})}),textColor:"!text-attention",backgroundColor:"bg-attention",gradientColor:"bg-gradient-to-r from-transparent via-attention to-transparent"},high:{translation:n({defaultMessage:"This price is <span>high</span>",id:"whb9bUkCNc"},{span:u=>l.jsx("span",{className:"text-negative",children:u})}),textColor:"!text-negative",backgroundColor:"bg-negative",gradientColor:"bg-gradient-to-l from-negative to-transparent"}}),[n]),s=f.useMemo(()=>e?e.flatMap(u=>{const d=(u.offers??[]).map(p=>p.price).filter(p=>p!==void 0);return d.length===0?[]:[Math.min(...d)]}):[],[e]),a=f.useMemo(()=>t!=null?[...s,t]:s,[s,t]),o=f.useMemo(()=>a.length>0?Math.min(...a):null,[a]),i=f.useMemo(()=>a.length>0?Math.max(...a):null,[a]),c=f.useMemo(()=>{if(!i||!o||!t)return null;const d=(i-o)*.33,m=o+d,p=i-d;return{low:m,high:p}},[i,o,t]);return f.useMemo(()=>{if(!c||!t)return EUe;const u=t<c.low?"low":t>c.high?"high":"fair",d=r[u];return{label:d.translation,textColor:d.textColor,backgroundColor:d.backgroundColor,gradientColor:d.gradientColor,high:i,low:o,fairBounds:c}},[c,t,r,i,o])},kUe=e=>{if(e===null)return{positionStyle:{left:"50%",right:"auto",transform:"translateX(-50%)"},labelClasses:"justify-center",indicatorClasses:"-translate-x-1/2"};const t=e<5,n=e>95;return t?{positionStyle:{left:"0%",right:"auto",transform:"none"},labelClasses:"justify-start",indicatorClasses:""}:n?{positionStyle:{left:"auto",right:"0%",transform:"none"},labelClasses:"justify-end",indicatorClasses:""}:{positionStyle:{left:`${e}%`,right:"auto",transform:"translateX(-50%)"},labelClasses:"justify-center",indicatorClasses:"-translate-x-1/2"}},MUe=e=>{if(!e||e.length===0)return"";const t=new Set,n=e.filter(o=>{if(!o.url)return!1;const i=ys(o.url);return t.has(i)?!1:(t.add(i),!0)});if(!n.length)return"";const r=n[0];if(!r||!r.url)return"";const s=ys(r.url).replace(/\.[^.]*$/,""),a=n.length-1;return a>0?`${s}, +${a}`:s},TUe=({price:e,products:t})=>{const{high:n,low:r,textColor:s,backgroundColor:a,gradientColor:o}=nz(t,e),i=f.useMemo(()=>{if(!r||!n||!e)return null;const m=n-r;return(e-r)/m*100},[e,r,n]),{positionStyle:c,labelClasses:u,indicatorClasses:d}=f.useMemo(()=>kUe(i),[i]);return l.jsx("div",{className:"pt-xl pb-lg flex",children:l.jsxs("div",{className:"relative flex h-1.5 w-full items-center",children:[l.jsx("div",{className:"absolute inset-0 rounded-full bg-subtlest"}),l.jsx("div",{className:z("absolute inset-0 rounded-full",o)}),l.jsx("div",{className:z("absolute z-10 flex bottom-1/2",u),style:c,children:l.jsxs("div",{className:"px-sm relative mb-4 mx-0 inline-flex rounded-full py-0.5",children:[l.jsx(B,{variant:"smallBold",className:z("whitespace-nowrap",s),children:e?.toLocaleString("en-US",{style:"currency",currency:"USD",trailingZeroDisplay:"stripIfInteger"})}),l.jsx("div",{className:z("absolute inset-0 rounded-full opacity-10",a)})]})}),l.jsx("div",{className:z("absolute z-10 flex justify-center",d),style:c,children:l.jsx(Y,{variant:"background",className:"size-4 shrink-0 rounded-full",children:l.jsx(Y,{variant:"underlay",className:"size-full rounded-full",children:l.jsx(Y,{variant:"subtler",className:"p-three size-full rounded-full",children:l.jsx("div",{className:z("size-full rounded-full",a)})})})})})]})})},N8=3,AUe=f.memo(function({sortedProductsByPrice:t,price:n}){const[r,s]=f.useState(!1),a=f.useCallback(()=>{s(c=>!c)},[]),{$t:o}=Q(),i=f.useMemo(()=>t?.slice(0,r?void 0:N8),[t,r]);return l.jsxs("div",{className:"gap-sm flex flex-col mt-sm",children:[i?.map((c,u)=>l.jsx(NUe,{product:c,originalProductPrice:n},`${c.title}-${u}`)),t&&t.length>N8?l.jsx(at,{variant:"secondary",onClick:a,size:"small",children:o(r?{defaultMessage:"View less",id:"EVFai9MfkN"}:{defaultMessage:"View all",id:"pFK6bJU0EM"})}):null]})}),NUe=f.memo(function({product:t,originalProductPrice:n}){const r=f.useMemo(()=>t.offers?.[0]??void 0,[t]),s=r?.price?r.price.toLocaleString("en-US",{style:"currency",currency:"USD"}):null,a=f.useMemo(()=>r?.merchant_name??Vf(r?.url??""),[r]);if(!t.offers?.length||!r)return null;const o=r.price!==void 0&&n!==void 0&&r.price<n;return l.jsx(Dt,{href:r.url,target:"_blank",rel:"noopener nofollow",children:l.jsx(Xn,{className:"p-[12px] rounded-xl border border-subtlest shadow-lg hover:shadow-xl hover:bg-subtler transition-all duration-200",variant:"background",children:l.jsxs("div",{className:"md:gap-md flex h-full items-center justify-between gap-[12px]",children:[t.images?.[0]?.src?l.jsx(to,{src:t.images[0].src,alt:t.title,width:64,height:64}):null,l.jsxs("div",{className:"gap-xs flex min-w-0 w-full flex-col items-start",children:[l.jsx(B,{variant:"smallBold",lineClamp:2,className:"leading-tight",children:t.title}),l.jsx("div",{className:"min-w-0 max-w-full shrink overflow-hidden",children:l.jsx(B,{variant:"small",color:"light",className:"truncate",children:a})})]}),s?l.jsx("div",{className:"flex shrink-0",children:l.jsx(B,{variant:"smallBold",color:o?"positive":"light",className:"whitespace-nowrap text-right leading-tight",children:s})}):null]})})})}),R8=f.memo(function({webResults:t}){const n=f.useMemo(()=>MUe(t),[t]);return n?l.jsx(B,{variant:"small",color:"light",className:"truncate",children:n}):null}),_C={summary:"",review_quality_score:0,pros_detailed:[],cons_detailed:[],pros:[],cons:[],key_features:[],buy_if:"",review_search_results:[]},RUe=(e,t,n,r)=>{if(e.backend_uuid!==t)return e;const s=e.blocks||[],a=[...s];let o=!1;const i=(p,h=_C)=>p.url===n?{...p,review_summary:{...h,...r}}:p,c=s.findIndex(p=>p.shopping_mode_block);if(c>=0){const p=s[c],h=p?.shopping_mode_block;if(h?.shopping_widgets){const g=h.shopping_widgets.map(y=>i(y,y.review_summary));a[c]={...p,shopping_mode_block:{...h,shopping_widgets:g}},o=!0}}const u=s.findIndex(p=>p.inline_entity_block?.shopping_preview_block);if(u>=0){const p=s[u],h=p?.inline_entity_block?.shopping_preview_block;if(h&&h.shopping_widgets){const g=h.shopping_widgets.map(y=>i(y,y.review_summary));a[u]={...p,inline_entity_block:{...p.inline_entity_block,shopping_preview_block:{...h,shopping_widgets:g}}},o=!0}}const d=s.findIndex(p=>p.entity_list_block?.entities?.some(h=>h.shopping_block));if(d>=0){const p=s[d],h=p?.entity_list_block;if(h?.entities){const g={...h,entities:h.entities.map(y=>y.shopping_block&&y.shopping_block.url===n?{...y,shopping_block:i(y.shopping_block,y.shopping_block.review_summary)}:y)};a[d]={...p,entity_list_block:g},o=!0}}const m=s.reduce((p,h,g)=>(h.entity_group_block?.entities?.some(y=>y.shopping_block&&y.shopping_block.url===n)&&p.push(g),p),[]);for(const p of m){const h=s[p],g=h?.entity_group_block;if(g?.entities){const y=g.entities.map(b=>b.shopping_block&&b.shopping_block.url===n?{...b,shopping_block:i(b.shopping_block,b.shopping_block.review_summary)}:b);a[p]={...h,entity_group_block:{...g,entities:y}},o=!0}}return o?{...e,blocks:a}:e},m2=e=>["shoppingReviewSummary",e],DUe=({shouldMutateStore:e=!0,reason:t})=>{const n=PR(),r=It(),{mutateAsync:s,isPending:a,error:o,data:i}=on({mutationFn:async c=>{const u=r.getQueryData(m2(c.url));if(u)return u;let d=_C,m="PENDING",p="";try{await ve.SSE("/rest/sse/shopping_review_summary",t,{params:c,handlers:{message:g=>{m=g.status??m,p=g.id??p,g.blocks?.[0]?.shopping_block&&(d=g.blocks?.[0]?.shopping_block),r.setQueryData(m2(c.url),y=>y?{...y,status:m,id:p,review_summary:{...y.review_summary||_C,...d}}:{review_summary:d,status:m,id:p}),e&&n(c.entry_uuid,y=>RUe(y,c.entry_uuid,p,d))}}})}catch{}const h={review_summary:d,status:m,id:p};return r.setQueryData(m2(c.url),h),h}});return f.useMemo(()=>({generateShoppingReviewSummary:s,reviewSummary:i?.review_summary,isPending:a,error:o}),[i?.review_summary,o,s,a])},IUe=({block:e})=>{const{product_name:t="",product_price:n,product_brand:r="",product_url:s="",compare_at_price:a,products:o}=e,{result:{backend_uuid:i}}=Pt(),{$t:c}=Q(),{label:u}=nz(o,n),{reviewSummary:d,generateShoppingReviewSummary:m,isPending:p}=DUe({reason:"price-comparison-inline-card"});f.useEffect(()=>{!t||!s||m({product_name:t,merchant_name:r,url:s,price:n?.toString()??"",description:"",entry_uuid:i??""})},[t,r,s,i,m,n]);const h=f.useMemo(()=>o?.map(g=>({name:g.title??"",url:g.offers?.[0]?.url??"",snippet:"",timestamp:"",meta_data:void 0,is_attachment:!1,is_image:!1,is_code_interpreter:!1,is_knowledge_card:!1,is_navigational:!1,is_focused_web:!1,is_client_context:!1,is_widget:!1,sitelinks:[],inline_entity_id:""}))??_e,[o]);return l.jsx("div",{className:"gap-md flex flex-col",children:l.jsx(Xn,{variant:"underlay",className:"rounded-2xl",children:l.jsxs("div",{className:"m-md mb-0",children:[l.jsxs("div",{className:"gap-md flex flex-col",children:[l.jsx(Al,{href:s,target:"_blank",children:l.jsx(B,{as:"span",variant:"baseSemi",lineClamp:2,className:"leading-tight",children:t})}),u?l.jsx(B,{variant:"smallBold",children:u}):null]}),n&&u?l.jsx(TUe,{price:n,products:o}):null,o&&o.length>0?l.jsx(T8,{title:c({defaultMessage:"See similar products",id:"RZk98Mstcl"}),defaultExpanded:!0,trailingContent:l.jsx(R8,{webResults:h}),children:l.jsx(AUe,{sortedProductsByPrice:o,price:n})}):null,d?l.jsx(T8,{title:c({defaultMessage:"Reviews",id:"dUxyza4PYQ"}),trailingContent:l.jsx(R8,{webResults:d.review_search_results}),children:l.jsxs("div",{className:"gap-sm mt-xs flex flex-col",children:[l.jsx(B,{variant:"small",children:d.summary}),l.jsx(tz,{pros:d.pros_detailed??[],cons:d.cons_detailed??[],loading:p,id:s,scrollOnMobile:!1})]})}):null]})})})},Ha={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},rz=Object.create(null);for(const e in Ha)Object.hasOwn(Ha,e)&&(rz[Ha[e]]=e);const tr={to:{},get:{}};tr.get=function(e){const t=e.slice(0,3).toLowerCase();let n,r;switch(t){case"hsl":{n=tr.get.hsl(e),r="hsl";break}case"hwb":{n=tr.get.hwb(e),r="hwb";break}default:{n=tr.get.rgb(e),r="rgb";break}}return n?{model:r,value:n}:null};tr.get.rgb=function(e){if(!e)return null;const t=/^#([a-f\d]{3,4})$/i,n=/^#([a-f\d]{6})([a-f\d]{2})?$/i,r=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|/]\s*([+-]?[\d.]+)(%?)\s*)?\)$/,s=/^rgba?\(\s*([+-]?[\d.]+)%\s*,?\s*([+-]?[\d.]+)%\s*,?\s*([+-]?[\d.]+)%\s*(?:[,|/]\s*([+-]?[\d.]+)(%?)\s*)?\)$/,a=/^(\w+)$/;let o=[0,0,0,1],i,c,u;if(i=e.match(n)){for(u=i[2],i=i[1],c=0;c<3;c++){const d=c*2;o[c]=Number.parseInt(i.slice(d,d+2),16)}u&&(o[3]=Number.parseInt(u,16)/255)}else if(i=e.match(t)){for(i=i[1],u=i[3],c=0;c<3;c++)o[c]=Number.parseInt(i[c]+i[c],16);u&&(o[3]=Number.parseInt(u+u,16)/255)}else if(i=e.match(r)){for(c=0;c<3;c++)o[c]=Number.parseInt(i[c+1],10);i[4]&&(o[3]=i[5]?Number.parseFloat(i[4])*.01:Number.parseFloat(i[4]))}else if(i=e.match(s)){for(c=0;c<3;c++)o[c]=Math.round(Number.parseFloat(i[c+1])*2.55);i[4]&&(o[3]=i[5]?Number.parseFloat(i[4])*.01:Number.parseFloat(i[4]))}else return(i=e.match(a))?i[1]==="transparent"?[0,0,0,0]:Object.hasOwn(Ha,i[1])?(o=Ha[i[1]],o[3]=1,o):null:null;for(c=0;c<3;c++)o[c]=fi(o[c],0,255);return o[3]=fi(o[3],0,1),o};tr.get.hsl=function(e){if(!e)return null;const t=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d.]+)%\s*,?\s*([+-]?[\d.]+)%\s*(?:[,|/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,n=e.match(t);if(n){const r=Number.parseFloat(n[4]),s=(Number.parseFloat(n[1])%360+360)%360,a=fi(Number.parseFloat(n[2]),0,100),o=fi(Number.parseFloat(n[3]),0,100),i=fi(Number.isNaN(r)?1:r,0,1);return[s,a,o,i]}return null};tr.get.hwb=function(e){if(!e)return null;const t=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d.]+)%\s*,\s*([+-]?[\d.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,n=e.match(t);if(n){const r=Number.parseFloat(n[4]),s=(Number.parseFloat(n[1])%360+360)%360,a=fi(Number.parseFloat(n[2]),0,100),o=fi(Number.parseFloat(n[3]),0,100),i=fi(Number.isNaN(r)?1:r,0,1);return[s,a,o,i]}return null};tr.to.hex=function(...e){return"#"+zp(e[0])+zp(e[1])+zp(e[2])+(e[3]<1?zp(Math.round(e[3]*255)):"")};tr.to.rgb=function(...e){return e.length<4||e[3]===1?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"};tr.to.rgb.percent=function(...e){const t=Math.round(e[0]/255*100),n=Math.round(e[1]/255*100),r=Math.round(e[2]/255*100);return e.length<4||e[3]===1?"rgb("+t+"%, "+n+"%, "+r+"%)":"rgba("+t+"%, "+n+"%, "+r+"%, "+e[3]+")"};tr.to.hsl=function(...e){return e.length<4||e[3]===1?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"};tr.to.hwb=function(...e){let t="";return e.length>=4&&e[3]!==1&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"};tr.to.keyword=function(...e){return rz[e.slice(0,3)]};function fi(e,t,n){return Math.min(Math.max(t,e),n)}function zp(e){const t=Math.round(e).toString(16).toUpperCase();return t.length<2?"0"+t:t}const sz={};for(const e of Object.keys(Ha))sz[Ha[e]]=e;const qe={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},oklab:{channels:3,labels:["okl","oka","okb"]},lch:{channels:3,labels:"lch"},oklch:{channels:3,labels:["okl","okc","okh"]},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}},Eo=(6/29)**3;function Pc(e){const t=e>.0031308?1.055*e**.4166666666666667-.055:e*12.92;return Math.min(Math.max(0,t),1)}function Oc(e){return e>.04045?((e+.055)/1.055)**2.4:e/12.92}for(const e of Object.keys(qe)){if(!("channels"in qe[e]))throw new Error("missing channels property: "+e);if(!("labels"in qe[e]))throw new Error("missing channel labels property: "+e);if(qe[e].labels.length!==qe[e].channels)throw new Error("channel and label counts mismatch: "+e);const{channels:t,labels:n}=qe[e];delete qe[e].channels,delete qe[e].labels,Object.defineProperty(qe[e],"channels",{value:t}),Object.defineProperty(qe[e],"labels",{value:n})}qe.rgb.hsl=function(e){const t=e[0]/255,n=e[1]/255,r=e[2]/255,s=Math.min(t,n,r),a=Math.max(t,n,r),o=a-s;let i,c;switch(a){case s:{i=0;break}case t:{i=(n-r)/o;break}case n:{i=2+(r-t)/o;break}case r:{i=4+(t-n)/o;break}}i=Math.min(i*60,360),i<0&&(i+=360);const u=(s+a)/2;return a===s?c=0:u<=.5?c=o/(a+s):c=o/(2-a-s),[i,c*100,u*100]};qe.rgb.hsv=function(e){let t,n,r,s,a;const o=e[0]/255,i=e[1]/255,c=e[2]/255,u=Math.max(o,i,c),d=u-Math.min(o,i,c),m=function(p){return(u-p)/6/d+1/2};if(d===0)s=0,a=0;else{switch(a=d/u,t=m(o),n=m(i),r=m(c),u){case o:{s=r-n;break}case i:{s=1/3+t-r;break}case c:{s=2/3+n-t;break}}s<0?s+=1:s>1&&(s-=1)}return[s*360,a*100,u*100]};qe.rgb.hwb=function(e){const t=e[0],n=e[1];let r=e[2];const s=qe.rgb.hsl(e)[0],a=1/255*Math.min(t,Math.min(n,r));return r=1-1/255*Math.max(t,Math.max(n,r)),[s,a*100,r*100]};qe.rgb.oklab=function(e){const t=Oc(e[0]/255),n=Oc(e[1]/255),r=Oc(e[2]/255),s=Math.cbrt(.4122214708*t+.5363325363*n+.0514459929*r),a=Math.cbrt(.2119034982*t+.6806995451*n+.1073969566*r),o=Math.cbrt(.0883024619*t+.2817188376*n+.6299787005*r),i=.2104542553*s+.793617785*a-.0040720468*o,c=1.9779984951*s-2.428592205*a+.4505937099*o,u=.0259040371*s+.7827717662*a-.808675766*o;return[i*100,c*100,u*100]};qe.rgb.cmyk=function(e){const t=e[0]/255,n=e[1]/255,r=e[2]/255,s=Math.min(1-t,1-n,1-r),a=(1-t-s)/(1-s)||0,o=(1-n-s)/(1-s)||0,i=(1-r-s)/(1-s)||0;return[a*100,o*100,i*100,s*100]};function jUe(e,t){return(e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]-t[2])**2}qe.rgb.keyword=function(e){const t=sz[e];if(t)return t;let n=Number.POSITIVE_INFINITY,r;for(const s of Object.keys(Ha)){const a=Ha[s],o=jUe(e,a);o<n&&(n=o,r=s)}return r};qe.keyword.rgb=function(e){return Ha[e]};qe.rgb.xyz=function(e){const t=Oc(e[0]/255),n=Oc(e[1]/255),r=Oc(e[2]/255),s=t*.4124564+n*.3575761+r*.1804375,a=t*.2126729+n*.7151522+r*.072175,o=t*.0193339+n*.119192+r*.9503041;return[s*100,a*100,o*100]};qe.rgb.lab=function(e){const t=qe.rgb.xyz(e);let n=t[0],r=t[1],s=t[2];n/=95.047,r/=100,s/=108.883,n=n>Eo?n**(1/3):7.787*n+16/116,r=r>Eo?r**(1/3):7.787*r+16/116,s=s>Eo?s**(1/3):7.787*s+16/116;const a=116*r-16,o=500*(n-r),i=200*(r-s);return[a,o,i]};qe.hsl.rgb=function(e){const t=e[0]/360,n=e[1]/100,r=e[2]/100;let s,a;if(n===0)return a=r*255,[a,a,a];const o=r<.5?r*(1+n):r+n-r*n,i=2*r-o,c=[0,0,0];for(let u=0;u<3;u++)s=t+1/3*-(u-1),s<0&&s++,s>1&&s--,6*s<1?a=i+(o-i)*6*s:2*s<1?a=o:3*s<2?a=i+(o-i)*(2/3-s)*6:a=i,c[u]=a*255;return c};qe.hsl.hsv=function(e){const t=e[0];let n=e[1]/100,r=e[2]/100,s=n;const a=Math.max(r,.01);r*=2,n*=r<=1?r:2-r,s*=a<=1?a:2-a;const o=(r+n)/2,i=r===0?2*s/(a+s):2*n/(r+n);return[t,i*100,o*100]};qe.hsv.rgb=function(e){const t=e[0]/60,n=e[1]/100;let r=e[2]/100;const s=Math.floor(t)%6,a=t-Math.floor(t),o=255*r*(1-n),i=255*r*(1-n*a),c=255*r*(1-n*(1-a));switch(r*=255,s){case 0:return[r,c,o];case 1:return[i,r,o];case 2:return[o,r,c];case 3:return[o,i,r];case 4:return[c,o,r];case 5:return[r,o,i]}};qe.hsv.hsl=function(e){const t=e[0],n=e[1]/100,r=e[2]/100,s=Math.max(r,.01);let a,o;o=(2-n)*r;const i=(2-n)*s;return a=n*s,a/=i<=1?i:2-i,a=a||0,o/=2,[t,a*100,o*100]};qe.hwb.rgb=function(e){const t=e[0]/360;let n=e[1]/100,r=e[2]/100;const s=n+r;let a;s>1&&(n/=s,r/=s);const o=Math.floor(6*t),i=1-r;a=6*t-o,(o&1)!==0&&(a=1-a);const c=n+a*(i-n);let u,d,m;switch(o){default:case 6:case 0:{u=i,d=c,m=n;break}case 1:{u=c,d=i,m=n;break}case 2:{u=n,d=i,m=c;break}case 3:{u=n,d=c,m=i;break}case 4:{u=c,d=n,m=i;break}case 5:{u=i,d=n,m=c;break}}return[u*255,d*255,m*255]};qe.cmyk.rgb=function(e){const t=e[0]/100,n=e[1]/100,r=e[2]/100,s=e[3]/100,a=1-Math.min(1,t*(1-s)+s),o=1-Math.min(1,n*(1-s)+s),i=1-Math.min(1,r*(1-s)+s);return[a*255,o*255,i*255]};qe.xyz.rgb=function(e){const t=e[0]/100,n=e[1]/100,r=e[2]/100;let s,a,o;return s=t*3.2404542+n*-1.5371385+r*-.4985314,a=t*-.969266+n*1.8760108+r*.041556,o=t*.0556434+n*-.2040259+r*1.0572252,s=Pc(s),a=Pc(a),o=Pc(o),[s*255,a*255,o*255]};qe.xyz.lab=function(e){let t=e[0],n=e[1],r=e[2];t/=95.047,n/=100,r/=108.883,t=t>Eo?t**(1/3):7.787*t+16/116,n=n>Eo?n**(1/3):7.787*n+16/116,r=r>Eo?r**(1/3):7.787*r+16/116;const s=116*n-16,a=500*(t-n),o=200*(n-r);return[s,a,o]};qe.xyz.oklab=function(e){const t=e[0]/100,n=e[1]/100,r=e[2]/100,s=Math.cbrt(.8189330101*t+.3618667424*n-.1288597137*r),a=Math.cbrt(.0329845436*t+.9293118715*n+.0361456387*r),o=Math.cbrt(.0482003018*t+.2643662691*n+.633851707*r),i=.2104542553*s+.793617785*a-.0040720468*o,c=1.9779984951*s-2.428592205*a+.4505937099*o,u=.0259040371*s+.7827717662*a-.808675766*o;return[i*100,c*100,u*100]};qe.oklab.oklch=function(e){return qe.lab.lch(e)};qe.oklab.xyz=function(e){const t=e[0]/100,n=e[1]/100,r=e[2]/100,s=(.999999998*t+.396337792*n+.215803758*r)**3,a=(1.000000008*t-.105561342*n-.063854175*r)**3,o=(1.000000055*t-.089484182*n-1.291485538*r)**3,i=1.227013851*s-.55779998*a+.281256149*o,c=-.040580178*s+1.11225687*a-.071676679*o,u=-.076381285*s-.421481978*a+1.58616322*o;return[i*100,c*100,u*100]};qe.oklab.rgb=function(e){const t=e[0]/100,n=e[1]/100,r=e[2]/100,s=(t+.3963377774*n+.2158037573*r)**3,a=(t-.1055613458*n-.0638541728*r)**3,o=(t-.0894841775*n-1.291485548*r)**3,i=Pc(4.0767416621*s-3.3077115913*a+.2309699292*o),c=Pc(-1.2684380046*s+2.6097574011*a-.3413193965*o),u=Pc(-.0041960863*s-.7034186147*a+1.707614701*o);return[i*255,c*255,u*255]};qe.oklch.oklab=function(e){return qe.lch.lab(e)};qe.lab.xyz=function(e){const t=e[0],n=e[1],r=e[2];let s,a,o;a=(t+16)/116,s=n/500+a,o=a-r/200;const i=a**3,c=s**3,u=o**3;return a=i>Eo?i:(a-16/116)/7.787,s=c>Eo?c:(s-16/116)/7.787,o=u>Eo?u:(o-16/116)/7.787,s*=95.047,a*=100,o*=108.883,[s,a,o]};qe.lab.lch=function(e){const t=e[0],n=e[1],r=e[2];let s;s=Math.atan2(r,n)*360/2/Math.PI,s<0&&(s+=360);const o=Math.sqrt(n*n+r*r);return[t,o,s]};qe.lch.lab=function(e){const t=e[0],n=e[1],s=e[2]/360*2*Math.PI,a=n*Math.cos(s),o=n*Math.sin(s);return[t,a,o]};qe.rgb.ansi16=function(e,t=null){const[n,r,s]=e;let a=t===null?qe.rgb.hsv(e)[2]:t;if(a=Math.round(a/50),a===0)return 30;let o=30+(Math.round(s/255)<<2|Math.round(r/255)<<1|Math.round(n/255));return a===2&&(o+=60),o};qe.hsv.ansi16=function(e){return qe.rgb.ansi16(qe.hsv.rgb(e),e[2])};qe.rgb.ansi256=function(e){const t=e[0],n=e[1],r=e[2];return t>>4===n>>4&&n>>4===r>>4?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(r/255*5)};qe.ansi16.rgb=function(e){e=e[0];let t=e%10;if(t===0||t===7)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];const n=(Math.trunc(e>50)+1)*.5,r=(t&1)*n*255,s=(t>>1&1)*n*255,a=(t>>2&1)*n*255;return[r,s,a]};qe.ansi256.rgb=function(e){if(e=e[0],e>=232){const a=(e-232)*10+8;return[a,a,a]}e-=16;let t;const n=Math.floor(e/36)/5*255,r=Math.floor((t=e%36)/6)/5*255,s=t%6/5*255;return[n,r,s]};qe.rgb.hex=function(e){const n=(((Math.round(e[0])&255)<<16)+((Math.round(e[1])&255)<<8)+(Math.round(e[2])&255)).toString(16).toUpperCase();return"000000".slice(n.length)+n};qe.hex.rgb=function(e){const t=e.toString(16).match(/[a-f\d]{6}|[a-f\d]{3}/i);if(!t)return[0,0,0];let n=t[0];t[0].length===3&&(n=[...n].map(i=>i+i).join(""));const r=Number.parseInt(n,16),s=r>>16&255,a=r>>8&255,o=r&255;return[s,a,o]};qe.rgb.hcg=function(e){const t=e[0]/255,n=e[1]/255,r=e[2]/255,s=Math.max(Math.max(t,n),r),a=Math.min(Math.min(t,n),r),o=s-a;let i;const c=o<1?a/(1-o):0;return o<=0?i=0:s===t?i=(n-r)/o%6:s===n?i=2+(r-t)/o:i=4+(t-n)/o,i/=6,i%=1,[i*360,o*100,c*100]};qe.hsl.hcg=function(e){const t=e[1]/100,n=e[2]/100,r=n<.5?2*t*n:2*t*(1-n);let s=0;return r<1&&(s=(n-.5*r)/(1-r)),[e[0],r*100,s*100]};qe.hsv.hcg=function(e){const t=e[1]/100,n=e[2]/100,r=t*n;let s=0;return r<1&&(s=(n-r)/(1-r)),[e[0],r*100,s*100]};qe.hcg.rgb=function(e){const t=e[0]/360,n=e[1]/100,r=e[2]/100;if(n===0)return[r*255,r*255,r*255];const s=[0,0,0],a=t%1*6,o=a%1,i=1-o;let c=0;switch(Math.floor(a)){case 0:{s[0]=1,s[1]=o,s[2]=0;break}case 1:{s[0]=i,s[1]=1,s[2]=0;break}case 2:{s[0]=0,s[1]=1,s[2]=o;break}case 3:{s[0]=0,s[1]=i,s[2]=1;break}case 4:{s[0]=o,s[1]=0,s[2]=1;break}default:s[0]=1,s[1]=0,s[2]=i}return c=(1-n)*r,[(n*s[0]+c)*255,(n*s[1]+c)*255,(n*s[2]+c)*255]};qe.hcg.hsv=function(e){const t=e[1]/100,n=e[2]/100,r=t+n*(1-t);let s=0;return r>0&&(s=t/r),[e[0],s*100,r*100]};qe.hcg.hsl=function(e){const t=e[1]/100,r=e[2]/100*(1-t)+.5*t;let s=0;return r>0&&r<.5?s=t/(2*r):r>=.5&&r<1&&(s=t/(2*(1-r))),[e[0],s*100,r*100]};qe.hcg.hwb=function(e){const t=e[1]/100,n=e[2]/100,r=t+n*(1-t);return[e[0],(r-t)*100,(1-r)*100]};qe.hwb.hcg=function(e){const t=e[1]/100,r=1-e[2]/100,s=r-t;let a=0;return s<1&&(a=(r-s)/(1-s)),[e[0],s*100,a*100]};qe.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]};qe.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]};qe.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]};qe.gray.hsl=function(e){return[0,0,e[0]]};qe.gray.hsv=qe.gray.hsl;qe.gray.hwb=function(e){return[0,100,e[0]]};qe.gray.cmyk=function(e){return[0,0,0,e[0]]};qe.gray.lab=function(e){return[e[0],0,0]};qe.gray.hex=function(e){const t=Math.round(e[0]/100*255)&255,r=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".slice(r.length)+r};qe.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]};function PUe(){const e={},t=Object.keys(qe);for(let{length:n}=t,r=0;r<n;r++)e[t[r]]={distance:-1,parent:null};return e}function OUe(e){const t=PUe(),n=[e];for(t[e].distance=0;n.length>0;){const r=n.pop(),s=Object.keys(qe[r]);for(let{length:a}=s,o=0;o<a;o++){const i=s[o],c=t[i];c.distance===-1&&(c.distance=t[r].distance+1,c.parent=r,n.unshift(i))}}return t}function LUe(e,t){return function(n){return t(e(n))}}function FUe(e,t){const n=[t[e].parent,e];let r=qe[t[e].parent][e],s=t[e].parent;for(;t[s].parent;)n.unshift(t[s].parent),r=LUe(qe[t[s].parent][s],r),s=t[s].parent;return r.conversion=n,r}function UUe(e){const t=OUe(e),n={},r=Object.keys(t);for(let{length:s}=r,a=0;a<s;a++){const o=r[a];t[o].parent!==null&&(n[o]=FUe(o,t))}return n}const dr={},BUe=Object.keys(qe);function HUe(e){const t=function(...n){const r=n[0];return r==null?r:(r.length>1&&(n=r),e(n))};return"conversion"in e&&(t.conversion=e.conversion),t}function VUe(e){const t=function(...n){const r=n[0];if(r==null)return r;r.length>1&&(n=r);const s=e(n);if(typeof s=="object")for(let{length:a}=s,o=0;o<a;o++)s[o]=Math.round(s[o]);return s};return"conversion"in e&&(t.conversion=e.conversion),t}for(const e of BUe){dr[e]={},Object.defineProperty(dr[e],"channels",{value:qe[e].channels}),Object.defineProperty(dr[e],"labels",{value:qe[e].labels});const t=UUe(e),n=Object.keys(t);for(const r of n){const s=t[r];dr[e][r]=VUe(s),dr[e][r].raw=HUe(s)}}const az=["keyword","gray","hex"],vC={};for(const e of Object.keys(dr))vC[[...dr[e].labels].sort().join("")]=e;const CC={};function Dn(e,t){if(!(this instanceof Dn))return new Dn(e,t);if(t&&t in az&&(t=null),t&&!(t in dr))throw new Error("Unknown model: "+t);let n,r;if(e==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof Dn)this.model=e.model,this.color=[...e.color],this.valpha=e.valpha;else if(typeof e=="string"){const s=tr.get(e);if(s===null)throw new Error("Unable to parse color from string: "+e);this.model=s.model,r=dr[this.model].channels,this.color=s.value.slice(0,r),this.valpha=typeof s.value[r]=="number"?s.value[r]:1}else if(e.length>0){this.model=t||"rgb",r=dr[this.model].channels;const s=Array.prototype.slice.call(e,0,r);this.color=wC(s,r),this.valpha=typeof e[r]=="number"?e[r]:1}else if(typeof e=="number")this.model="rgb",this.color=[e>>16&255,e>>8&255,e&255],this.valpha=1;else{this.valpha=1;const s=Object.keys(e);"alpha"in e&&(s.splice(s.indexOf("alpha"),1),this.valpha=typeof e.alpha=="number"?e.alpha:0);const a=s.sort().join("");if(!(a in vC))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=vC[a];const{labels:o}=dr[this.model],i=[];for(n=0;n<o.length;n++)i.push(e[o[n]]);this.color=wC(i)}if(CC[this.model])for(r=dr[this.model].channels,n=0;n<r;n++){const s=CC[this.model][n];s&&(this.color[n]=s(this.color[n]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}Dn.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(e){let t=this.model in tr.to?this:this.rgb();t=t.round(typeof e=="number"?e:1);const n=t.valpha===1?t.color:[...t.color,this.valpha];return tr.to[t.model](...n)},percentString(e){const t=this.rgb().round(typeof e=="number"?e:1),n=t.valpha===1?t.color:[...t.color,this.valpha];return tr.to.rgb.percent(...n)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){const e={},{channels:t}=dr[this.model],{labels:n}=dr[this.model];for(let r=0;r<t;r++)e[n[r]]=this.color[r];return this.valpha!==1&&(e.alpha=this.valpha),e},unitArray(){const e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,this.valpha!==1&&e.push(this.valpha),e},unitObject(){const e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,this.valpha!==1&&(e.alpha=this.valpha),e},round(e){return e=Math.max(e||0,0),new Dn([...this.color.map(zUe(e)),this.valpha],this.model)},alpha(e){return e!==void 0?new Dn([...this.color,Math.max(0,Math.min(1,e))],this.model):this.valpha},red:Ln("rgb",0,Jn(255)),green:Ln("rgb",1,Jn(255)),blue:Ln("rgb",2,Jn(255)),hue:Ln(["hsl","hsv","hsl","hwb","hcg"],0,e=>(e%360+360)%360),saturationl:Ln("hsl",1,Jn(100)),lightness:Ln("hsl",2,Jn(100)),saturationv:Ln("hsv",1,Jn(100)),value:Ln("hsv",2,Jn(100)),chroma:Ln("hcg",1,Jn(100)),gray:Ln("hcg",2,Jn(100)),white:Ln("hwb",1,Jn(100)),wblack:Ln("hwb",2,Jn(100)),cyan:Ln("cmyk",0,Jn(100)),magenta:Ln("cmyk",1,Jn(100)),yellow:Ln("cmyk",2,Jn(100)),black:Ln("cmyk",3,Jn(100)),x:Ln("xyz",0,Jn(95.047)),y:Ln("xyz",1,Jn(100)),z:Ln("xyz",2,Jn(108.833)),l:Ln("lab",0,Jn(100)),a:Ln("lab",1),b:Ln("lab",2),keyword(e){return e!==void 0?new Dn(e):dr[this.model].keyword(this.color)},hex(e){return e!==void 0?new Dn(e):tr.to.hex(...this.rgb().round().color)},hexa(e){if(e!==void 0)return new Dn(e);const t=this.rgb().round().color;let n=Math.round(this.valpha*255).toString(16).toUpperCase();return n.length===1&&(n="0"+n),tr.to.hex(...t)+n},rgbNumber(){const e=this.rgb().color;return(e[0]&255)<<16|(e[1]&255)<<8|e[2]&255},luminosity(){const e=this.rgb().color,t=[];for(const[n,r]of e.entries()){const s=r/255;t[n]=s<=.04045?s/12.92:((s+.055)/1.055)**2.4}return .2126*t[0]+.7152*t[1]+.0722*t[2]},contrast(e){const t=this.luminosity(),n=e.luminosity();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)},level(e){const t=this.contrast(e);return t>=7?"AAA":t>=4.5?"AA":""},isDark(){const e=this.rgb().color;return(e[0]*2126+e[1]*7152+e[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){const e=this.rgb();for(let t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten(e){const t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken(e){const t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate(e){const t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate(e){const t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten(e){const t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken(e){const t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale(){const e=this.rgb().color,t=e[0]*.3+e[1]*.59+e[2]*.11;return Dn.rgb(t,t,t)},fade(e){return this.alpha(this.valpha-this.valpha*e)},opaquer(e){return this.alpha(this.valpha+this.valpha*e)},rotate(e){const t=this.hsl();let n=t.color[0];return n=(n+e)%360,n=n<0?360+n:n,t.color[0]=n,t},mix(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);const n=e.rgb(),r=this.rgb(),s=t===void 0?.5:t,a=2*s-1,o=n.alpha()-r.alpha(),i=((a*o===-1?a:(a+o)/(1+a*o))+1)/2,c=1-i;return Dn.rgb(i*n.red()+c*r.red(),i*n.green()+c*r.green(),i*n.blue()+c*r.blue(),n.alpha()*s+r.alpha()*(1-s))}};for(const e of Object.keys(dr)){if(az.includes(e))continue;const{channels:t}=dr[e];Dn.prototype[e]=function(...n){return this.model===e?new Dn(this):n.length>0?new Dn(n,e):new Dn([...qUe(dr[this.model][e].raw(this.color)),this.valpha],e)},Dn[e]=function(...n){let r=n[0];return typeof r=="number"&&(r=wC(n,t)),new Dn(r,e)}}function GUe(e,t){return Number(e.toFixed(t))}function zUe(e){return function(t){return GUe(t,e)}}function Ln(e,t,n){e=Array.isArray(e)?e:[e];for(const r of e)(CC[r]||=[])[t]=n;return e=e[0],function(r){let s;return r!==void 0?(n&&(r=n(r)),s=this[e](),s.color[t]=r,s):(s=this[e]().color[t],n&&(s=n(s)),s)}}function Jn(e){return function(t){return Math.max(0,Math.min(e,t))}}function qUe(e){return Array.isArray(e)?e:[e]}function wC(e,t){for(let n=0;n<t;n++)typeof e[n]!="number"&&(e[n]=0);return e}const $Ue=f.memo(function({className:t,innerClassName:n,gridClassName:r,children:s,fadeOut:a,dotClassName:o,highlightClassName:i,animate:c=!0,gridSize:u=22,count:d=20,style:m}){const[p,{width:h,height:g}]=Ni(),[y,b]=f.useState([]),[x,_]=f.useState(0),[v,C]=f.useState(0),w=f.useRef(null),S=f.useRef(new Set),E=f.useCallback(()=>{const k=Math.floor(Math.random()*x)+1,M=Math.floor(Math.random()*v)+1,N=`${k}-${M}`;if(S.current.has(N))return;const P={col:k,row:M,id:N,duration:Math.floor(Math.random()*1001)+1e3,isSuper:Math.floor(Math.random()*5)%5===0};b(O=>{const L=[P,...O];if(L.length>d){const H=L.pop();H&&S.current.delete(H.id)}return S.current.add(N),L})},[x,v,d]);f.useEffect(()=>{if(c)return w.current=setInterval(E,100),()=>{w.current&&clearInterval(w.current)}},[E,c]),f.useEffect(()=>{_(Math.floor(h/u)),C(Math.floor(g/u))},[h,g,u]);const T=a?{maskImage:"radial-gradient(black, transparent)"}:void 0;return l.jsxs("div",{className:z("bg-base dotGridContainer pointer-events-none relative isolate",t),ref:p,style:m,children:[l.jsxs("div",{className:"absolute inset-0 overflow-hidden",style:T,children:[l.jsx("div",{className:z("dotHighlightGrid bg-inverse/20 absolute inset-0",i),children:y.map(k=>l.jsx(WUe,{item:k,className:o},k.id))}),l.jsx("div",{className:z("dotGrid absolute inset-0",r)})]}),l.jsx("div",{className:z("relative",n),children:s})]})}),WUe=f.memo(function({item:t,className:n}){return l.jsx("div",{className:z("gridDot text-foreground",n,{highlight:t.isSuper}),style:{gridColumn:t.col,gridRow:t.row,animationDuration:`${t.duration}ms`}})}),Hm=A.memo(function({size:t="default",className:n,includeDot:r}){const{$t:s}=Q(),{isMobileStyle:a}=Be();return l.jsx("div",{className:z("flex shrink-0 items-center justify-center",n),children:l.jsxs(B,{variant:t==="tiny"||a?"micro":"tiny",color:"super",className:z("bg-superBG pt-three flex shrink-0 items-center rounded-full py-0.5 tracking-wider",{"px-2.5":t==="default","pl-2":t==="default"&&r,"px-2":t==="small","px-1.5":t==="tiny"}),children:[r&&l.jsxs("span",{className:"grid",children:[l.jsx("span",{className:"bg-super mr-1 size-1.5 rounded-full",style:{gridArea:"1/-1"}}),l.jsx("span",{className:"bg-super mr-1 size-1.5 animate-ping rounded-full",style:{gridArea:"1/-1"}})]}),s({defaultMessage:"Live",id:"Dn82ALx/+V"}).toUpperCase()]})})}),KUe={large:"size-2.5",default:"size-1.5"},YUe={super:"bg-super",positive:"bg-positive",negative:"bg-negative"};A.memo(function({className:t,color:n="super",size:r="default"}){const s=YUe[n],a=KUe[r];return l.jsxs("span",{className:z("relative block",a,t),children:[l.jsx("span",{className:z(s,"absolute inset-0 rounded-full")}),l.jsx("span",{className:z(s,"absolute inset-0 animate-ping rounded-full")})]})});const QUe=["West First Round","East First Round","Western Conference Semifinals","Eastern Conference Semifinals","Western Conference Finals","Eastern Conference Finals","NBA Finals"],oz=e=>QUe.includes(e);function XUe(e,t){return t.find(n=>String(n.teamId)===String(e))}const ZUe=e=>{switch(e){case"nba":case"wnba":case"ncaam":case"ncaaw":case"mlb":case"atp":case"wta":case"championsleague":case"laliga":case"ligue1":case"epl":case"bundesliga":return"/static/images/sports/nba/logos/nba-logo-generic.png";case"nfl":return"/static/images/sports/nfl/logos/nfl-logo-generic.png";case"ipl":case"cricket":case"icc":return"/static/images/sports/cricket/logos/cricket-logo-generic.png";default:return""}},JUe="#64645F";function eBe(e,t,n){const r={teamId:e,logo:ZUe(n),color:JUe};return XUe(e,t)??r}var vd={},D8;function Vm(){if(D8)return vd;D8=1,vd.__esModule=!0,vd.default=void 0;var e={top:"top",left:"left",right:"right",bottom:"bottom"};return vd.default=e,vd}var tBe=Vm();const nBe=ha(tBe);function qp(e,t,n,r,s){var a;switch(e){case"center":return s;case"min":return n??0;case"max":return r??0;case"outside":default:return(a=(t??0)<s?n:r)!=null?a:0}}function I8(e){var t=e.from,n=e.to;return{fromX:t.x,toX:n.x,fromY:t.y,toY:n.y,opacity:1}}function iz(e){var t=e.scale,n=e.animateXOrY,r=e.animationTrajectory,s=r===void 0?"outside":r,a=n==="x";return f.useMemo(function(){var o=t.range().map(Om),i=o[0],c=o[1],u=c!=null&&i!=null&&c<i,d=u?[c,i]:[i,c],m=d[0],p=d[1],h=c!=null&&i!=null?Math.abs(c-i):0,g=(m??0)+h/2,y=s;!a&&s==="min"&&(y="max"),!a&&s==="max"&&(y="min");var b=function(_){var v=_.from,C=_.to;return{fromX:a?qp(y,v.x,m,p,g):v.x,toX:a?qp(y,v.x,m,p,g):C.x,fromY:a?v.y:qp(y,v.y,m,p,g),toY:a?C.y:qp(y,v.y,m,p,g),opacity:0}};return{from:b,leave:b,enter:I8,update:I8}},[t,a,s])}function af(){return af=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},af.apply(null,arguments)}function rBe(e){var t=e.hideTicks,n=e.horizontal,r=e.orientation,s=e.scale,a=e.tickClassName,o=e.tickComponent,i=e.tickLabelProps,c=e.tickStroke,u=c===void 0?"#222":c,d=e.tickTransform,m=e.ticks,p=e.tickLineProps,h=e.animationTrajectory,g=rm(m,af({},iz({scale:s,animateXOrY:n?"x":"y",animationTrajectory:h}),{keys:function(b){return"tick-"+b.value+"-"+b.index}}));return A.createElement(A.Fragment,null,g(function(y,b,x,_){var v,C,w=y.fromX,S=y.toX,E=y.fromY,T=y.toY,k=y.opacity,M=x.key,N=(v=(C=i[_])!=null?C:i[0])!=null?v:{};return b==null||M==null?null:A.createElement(Jr.g,{key:M,className:z("visx-axis-tick",a),transform:d},!t&&A.createElement(Jr.line,af({x1:w,x2:S,y1:E,y2:T,stroke:u,strokeLinecap:"square",strokeOpacity:k},p)),A.createElement(Jr.g,{key:_,transform:Oj([S,T],function(P,O){var L;return"translate("+P+","+(O+(r===nBe.bottom&&typeof N.fontSize=="number"?(L=N.fontSize)!=null?L:10:0))+")"}),opacity:k},o?o(af({},N,{x:S,y:T,formattedValue:b?.formattedValue})):A.createElement(Xy,N,b?.formattedValue)))}))}var $p={};const b5=Hf(g9e),_5=Hf(dRe);var Wp={};const lz=Hf(KDe),cz=Hf(qIe);var Kp={},j8;function sBe(){if(j8)return Kp;j8=1,Kp.__esModule=!0,Kp.default=n;var e=t(Vm());function t(r){return r&&r.__esModule?r:{default:r}}function n(r){var s=r.labelOffset,a=r.labelProps,o=r.orientation,i=r.range,c=r.tickLabelFontSize,u=r.tickLength,d=o===e.default.left||o===e.default.top?-1:1,m,p,h;if(o===e.default.top||o===e.default.bottom){var g=o===e.default.bottom&&typeof a.fontSize=="number"?a.fontSize:0;m=(Number(i[0])+Number(i[i.length-1]))/2,p=d*(u+s+c+g)}else m=d*((Number(i[0])+Number(i[i.length-1]))/2),p=-(u+s),h="rotate("+d*90+")";return{x:m,y:p,transform:h}}return Kp}var Yp={},P8;function aBe(){if(P8)return Yp;P8=1,Yp.__esModule=!0,Yp.default=c;var e=o(Uf()),t=o(Bf()),n=lz,r=b5,s=cz,a=o(Vm());function o(u){return u&&u.__esModule?u:{default:u}}function i(){return i=Object.assign?Object.assign.bind():function(u){for(var d=1;d<arguments.length;d++){var m=arguments[d];for(var p in m)({}).hasOwnProperty.call(m,p)&&(u[p]=m[p])}return u},i.apply(null,arguments)}function c(u){var d=u.hideTicks,m=u.horizontal,p=u.orientation,h=u.tickClassName,g=u.tickComponent,y=u.tickLabelProps,b=u.tickStroke,x=b===void 0?"#222":b,_=u.tickTransform,v=u.ticks,C=u.strokeWidth,w=u.tickLineProps;return v.map(function(S){var E,T=S.value,k=S.index,M=S.from,N=S.to,P=S.formattedValue,O=(E=y[k])!=null?E:{},L=Math.max(10,typeof O.fontSize=="number"&&O.fontSize||0),H=N.y+(m&&p!==a.default.top?L:0);return e.default.createElement(r.Group,{key:"visx-tick-"+T+"-"+k,className:(0,t.default)("visx-axis-tick",h),transform:_},!d&&e.default.createElement(n.Line,i({from:M,to:N,stroke:x,strokeWidth:C,strokeLinecap:"square"},w)),g?g(i({},O,{x:N.x,y:H,formattedValue:P})):e.default.createElement(s.Text,i({x:N.x,y:H},O),P))})}return Yp}var O8;function oBe(){if(O8)return Wp;O8=1,Wp.__esModule=!0,Wp.default=d;var e=i(Uf()),t=i(Bf()),n=lz,r=cz,s=i(sBe()),a=i(Vm()),o=i(aBe());function i(m){return m&&m.__esModule?m:{default:m}}function c(){return c=Object.assign?Object.assign.bind():function(m){for(var p=1;p<arguments.length;p++){var h=arguments[p];for(var g in h)({}).hasOwnProperty.call(h,g)&&(m[g]=h[g])}return m},c.apply(null,arguments)}var u={textAnchor:"middle",fontFamily:"Arial",fontSize:10,fill:"#222"};function d(m){var p=m.axisFromPoint,h=m.axisLineClassName,g=m.axisToPoint,y=m.hideAxisLine,b=m.hideTicks,x=m.horizontal,_=m.label,v=_===void 0?"":_,C=m.labelClassName,w=m.labelOffset,S=w===void 0?14:w,E=m.labelProps,T=m.orientation,k=T===void 0?a.default.bottom:T,M=m.scale,N=m.stroke,P=N===void 0?"#222":N,O=m.strokeDasharray,L=m.strokeWidth,H=L===void 0?1:L,R=m.tickClassName,I=m.tickComponent,F=m.tickLineProps,G=m.tickLabelProps,j=m.tickLength,$=j===void 0?8:j,q=m.tickStroke,U=q===void 0?"#222":q,X=m.tickTransform,J=m.ticks,ne=m.ticksComponent,ae=ne===void 0?o.default:ne,de=c({},u,E),oe=c({},u,typeof G=="object"?G:null),le=J.map(function(re){var he=re.value,ie=re.index;return typeof G=="function"?G(he,ie,J):oe}),se=Math.max.apply(Math,[10].concat(le.map(function(re){return typeof re.fontSize=="number"?re.fontSize:0})));return e.default.createElement(e.default.Fragment,null,ae({hideTicks:b,horizontal:x,orientation:k,scale:M,tickClassName:R,tickComponent:I,tickLabelProps:le,tickStroke:U,tickTransform:X,ticks:J,strokeWidth:H,tickLineProps:F}),!y&&e.default.createElement(n.Line,{className:(0,t.default)("visx-axis-line",h),from:p,to:g,stroke:P,strokeWidth:H,strokeDasharray:O}),v&&e.default.createElement(r.Text,c({className:(0,t.default)("visx-axis-label",C)},(0,s.default)({labelOffset:S,labelProps:de,orientation:k,range:M.range(),tickLabelFontSize:se,tickLength:$}),de),v))}return Wp}var Qp={},L8;function iBe(){if(L8)return Qp;L8=1,Qp.__esModule=!0,Qp.default=e;function e(t,n){n===void 0&&(n="center");var r=t;if(n!=="start"&&"bandwidth"in r){var s=r.bandwidth();return n==="center"&&(s/=2),r.round()&&(s=Math.round(s)),function(a){var o=r(a);return typeof o=="number"?o+s:o}}return t}return Qp}var Xp={},F8;function lBe(){if(F8)return Xp;F8=1,Xp.__esModule=!0,Xp.default=t;var e=_5;function t(n){var r=n;return"tickFormat"in r?r.tickFormat():e.toString}return Xp}var Zp={};const uz=Hf(JIe);var U8;function cBe(){if(U8)return Zp;U8=1,Zp.__esModule=!0,Zp.default=t;var e=uz;function t(n,r){var s=n.x,a=n.y;return new e.Point(r?{x:s,y:a}:{x:a,y:s})}return Zp}var cc={},B8;function uBe(){if(B8)return cc;B8=1,cc.__esModule=!0,cc.default=n,cc.defaultAxisRangePadding=void 0;function e(){return e=Object.assign?Object.assign.bind():function(r){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var o in a)({}).hasOwnProperty.call(a,o)&&(r[o]=a[o])}return r},e.apply(null,arguments)}var t=cc.defaultAxisRangePadding=0;function n(r){return r===void 0&&(r=t),typeof r=="number"?{start:r,end:r}:e({start:t,end:t},r)}return cc}var H8;function dBe(){if(H8)return $p;H8=1,$p.__esModule=!0,$p.default=g,m(H3());var e=m(Uf()),t=m(Bf()),n=b5,r=_5,s=m(oBe()),a=m(iBe()),o=m(lBe()),i=m(cBe()),c=m(Vm()),u=m(uBe()),d=["children","axisClassName","hideAxisLine","hideTicks","hideZero","innerRef","left","numTicks","orientation","rangePadding","scale","tickFormat","tickLength","tickValues","top"];function m(y){return y&&y.__esModule?y:{default:y}}function p(){return p=Object.assign?Object.assign.bind():function(y){for(var b=1;b<arguments.length;b++){var x=arguments[b];for(var _ in x)({}).hasOwnProperty.call(x,_)&&(y[_]=x[_])}return y},p.apply(null,arguments)}function h(y,b){if(y==null)return{};var x={};for(var _ in y)if({}.hasOwnProperty.call(y,_)){if(b.includes(_))continue;x[_]=y[_]}return x}function g(y){var b=y.children,x=b===void 0?s.default:b,_=y.axisClassName,v=y.hideAxisLine,C=v===void 0?!1:v,w=y.hideTicks,S=w===void 0?!1:w,E=y.hideZero,T=E===void 0?!1:E,k=y.innerRef,M=y.left,N=M===void 0?0:M,P=y.numTicks,O=P===void 0?10:P,L=y.orientation,H=L===void 0?c.default.bottom:L,R=y.rangePadding,I=R===void 0?0:R,F=y.scale,G=y.tickFormat,j=y.tickLength,$=j===void 0?8:j,q=y.tickValues,U=y.top,X=U===void 0?0:U,J=h(y,d),ne=G??(0,o.default)(F),ae=H===c.default.left,de=H===c.default.top,oe=de||H===c.default.bottom,le=(0,a.default)(F),se=ae||de?-1:1,re=F.range(),he=(0,u.default)(I),ie=(0,i.default)({x:Number(re[0])+.5-he.start,y:0},oe),ue=(0,i.default)({x:Number(re[re.length-1])+.5+he.end,y:0},oe),ce=(q??(0,r.getTicks)(F,O)).filter(function(pe){return!T||pe!==0&&pe!=="0"}).map(function(pe,xe){return{value:pe,index:xe}}),me=ce.map(function(pe){var xe=pe.value,Oe=pe.index,Te=(0,r.coerceNumber)(le(xe));return{value:xe,index:Oe,from:(0,i.default)({x:Te,y:0},oe),to:(0,i.default)({x:Te,y:$*se},oe),formattedValue:ne(xe,Oe,ce)}});return e.default.createElement(n.Group,{className:(0,t.default)("visx-axis",_),innerRef:k,top:X,left:N},x(p({},J,{axisFromPoint:ie,axisToPoint:ue,hideAxisLine:C,hideTicks:S,hideZero:T,horizontal:oe,numTicks:O,orientation:H,rangePadding:I,scale:F,tickFormat:ne,tickLength:$,tickPosition:le,tickSign:se,ticks:me})))}return $p}var fBe=dBe();const mBe=ha(fBe);var pBe=["animationTrajectory","tickComponent"];function Ug(){return Ug=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ug.apply(null,arguments)}function hBe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}function gBe(e){var t=e.animationTrajectory,n=e.tickComponent,r=hBe(e,pBe),s=f.useMemo(function(){return(function(o){return A.createElement(rBe,Ug({},o,{tickComponent:n,animationTrajectory:t}))})},[t,n]);return A.createElement(mBe,Ug({},r,{ticksComponent:s}))}var Jp={},eh={},V8;function yBe(){if(V8)return eh;V8=1,eh.__esModule=!0,eh.default=e;function e(t){return"bandwidth"in t?t.bandwidth():0}return eh}var G8;function xBe(){if(G8)return Jp;G8=1,Jp.__esModule=!0,Jp.default=p;var e=u(H3()),t=u(Uf()),n=u(Bf()),r=u(ZV()),s=b5,a=uz,o=_5,i=u(yBe()),c=["top","left","scale","width","stroke","strokeWidth","strokeDasharray","className","children","numTicks","lineStyle","offset","tickValues"];function u(h){return h&&h.__esModule?h:{default:h}}function d(){return d=Object.assign?Object.assign.bind():function(h){for(var g=1;g<arguments.length;g++){var y=arguments[g];for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(h[b]=y[b])}return h},d.apply(this,arguments)}function m(h,g){if(h==null)return{};var y={},b=Object.keys(h),x,_;for(_=0;_<b.length;_++)x=b[_],!(g.indexOf(x)>=0)&&(y[x]=h[x]);return y}function p(h){var g=h.top,y=g===void 0?0:g,b=h.left,x=b===void 0?0:b,_=h.scale,v=h.width,C=h.stroke,w=C===void 0?"#eaf0f6":C,S=h.strokeWidth,E=S===void 0?1:S,T=h.strokeDasharray,k=h.className,M=h.children,N=h.numTicks,P=N===void 0?10:N,O=h.lineStyle,L=h.offset,H=h.tickValues,R=m(h,c),I=H??(0,o.getTicks)(_,P),F=(L??0)+(0,i.default)(_)/2,G=I.map(function(j,$){var q,U=((q=(0,o.coerceNumber)(_(j)))!=null?q:0)+F;return{index:$,from:new a.Point({x:0,y:U}),to:new a.Point({x:v,y:U})}});return t.default.createElement(s.Group,{className:(0,n.default)("visx-rows",k),top:y,left:x},M?M({lines:G}):G.map(function(j){var $=j.from,q=j.to,U=j.index;return t.default.createElement(r.default,d({key:"row-line-"+U,from:$,to:q,stroke:w,strokeWidth:E,strokeDasharray:T,style:O},R))}))}return p.propTypes={tickValues:e.default.array,width:e.default.number.isRequired},Jp}var bBe=xBe();const _Be=ha(bBe);var vBe=["scale","lines","animationTrajectory","animateXOrY","lineKey","lineStyle"];function Bg(){return Bg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bg.apply(null,arguments)}function CBe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}function dz(e){var t=e.scale,n=e.lines,r=e.animationTrajectory,s=e.animateXOrY,a=e.lineKey,o=e.lineStyle,i=CBe(e,vBe),c=rm(n,Bg({},iz({scale:t,animateXOrY:s,animationTrajectory:r}),{key:a}));return A.createElement(A.Fragment,null,c(function(u,d,m){var p=u.fromX,h=u.toX,g=u.fromY,y=u.toY,b=u.opacity,x=m.key;return A.createElement(Jr.line,Bg({key:x,x1:p,x2:h,y1:g,y2:y,strokeOpacity:b,style:o},i))}))}dz.propTypes={lineKey:Je.func.isRequired};var wBe=["scale","width","numTicks","tickValues","offset","className","animationTrajectory","top","left"];function SC(){return SC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},SC.apply(null,arguments)}function SBe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}function fz(e){var t=e.scale,n=e.width,r=e.numTicks,s=e.tickValues,a=e.offset,o=e.className,i=e.animationTrajectory,c=e.top,u=e.left,d=SBe(e,wBe);return A.createElement(_Be,{scale:t,width:n,numTicks:r,tickValues:s,className:o,top:c,left:u,offset:a},function(m){var p=m.lines;return A.createElement(dz,SC({scale:t,lines:p,animationTrajectory:i,animateXOrY:"y",lineKey:function(g){var y,b;return"row-"+((y=g==null||(b=g.from)==null?void 0:b.y)!=null?y:"")+"-"+g.index}},d))})}function z8({ref:e}){const t=e.current,[n,r,s]=f.useMemo(()=>{if(t){const a=t.querySelectorAll(".visx-axis-tick"),o=Array.from(a).map(i=>{const{width:c,height:u}=i.getBBox();return[c,u]});if(o.length){const i=Math.max(...o.map(u=>u[0])),c=Math.max(...o.map(u=>u[1]));return[i,c,o.length*i]}}return[0,0,0]},[t]);return f.useMemo(()=>({minRequiredWidth:s,maxLabelWidth:n,maxLabelHeight:r}),[r,n,s])}function lx(){const e=f.useRef(null),{maxLabelWidth:t,minRequiredWidth:n}=z8({ref:e}),r=f.useRef(null),{maxLabelWidth:s}=z8({ref:r});return f.useMemo(()=>({xAxisRef:e,yAxisRef:r,maxXLabelWidth:t,maxYLabelWidth:s,minXRequiredWidth:n}),[t,s,n])}const q8=40,p2=e=>typeof e=="number";function cx({config:e,innerWidth:t,innerHeight:n,maxXLabelWidth:r}){let s=Math.floor(t/(r+q8));p2(e?.x?.numTicks)&&p2(s)&&(s=Math.min(s,e.x.numTicks)),r||(s=void 0);let a=Math.floor(n/q8);return p2(e?.y?.numTicks)&&(a=Math.min(a,e.y.numTicks)),{xTiltTicks:!1,xNumTicks:s,yNumTicks:a}}const mz="fill-quiet font-mono text-xs font-bold truncate max-w-[100px]",$8="fill-quiet text-xs font-semibold font-sans",EBe=(e,t,n)=>n?{transform:"rotate(-10deg)",transformOrigin:`${e}px ${t}px`,textAnchor:"end"}:{textAnchor:"middle"};function kBe(e){const{shouldTilt:t,x:n,y:r,formattedValue:s,style:a,className:o,...i}=e;return l.jsx("text",{...i,x:n,y:r,dy:"2px",className:z(mz,o),style:{...a,...EBe(n,r,t)},children:s})}const ux=A.memo(function(t){const{margin:n,height:r,width:s,xScale:a,yScale:o,xFormat:i,yFormat:c,yNumTicks:u,xNumTicks:d,xTickValues:m,yTickValues:p,xTiltTicks:h,animated:g,tickColor:y,axisColor:b,xAxisRef:x,yAxisRef:_,xAxisLabel:v,yAxisLabel:C,gridDashed:w=!1,gridStrokeWidth:S=.5}=t,E=ro(),T=g?gBe:_i,k=g?fz:ql,M=f.useCallback(P=>l.jsx(kBe,{...P,shouldTilt:h}),[h]),N=f.useMemo(()=>({className:mz,textAnchor:"start",dx:"0.75em",dy:"-0.25em"}),[]);return l.jsxs(l.Fragment,{children:[l.jsx(_i,{orientation:us.bottom,top:r-n.bottom,scale:a,stroke:b,hideAxisLine:!0,label:v,labelClassName:$8,tickFormat:i,numTicks:d,tickStroke:y,innerRef:x,tickValues:m,tickComponent:M,axisClassName:"select-none"}),l.jsx(T,{orientation:us.left,left:n.left,hideAxisLine:!0,label:C,labelOffset:7.5,labelClassName:$8,scale:o,tickFormat:c,stroke:b,tickStroke:y,hideTicks:!0,innerRef:_,tickLabelProps:N,numTicks:u,tickValues:p,axisClassName:"select-none"}),E&&l.jsx(k,{left:n.left,scale:o,width:s-n.right-n.left*2,strokeDasharray:w?"8,4":void 0,stroke:b,strokeWidth:S,numTicks:u})]})}),MBe=A.memo(function({color:t}){return l.jsx("div",{className:"size-[14px] rounded-full",style:{backgroundColor:t}})}),dx=A.memo(function({entries:t}){return l.jsx("ol",{className:"my-sm gap-x-md gap-y-xs flex flex-wrap",children:t.map(({key:n,color:r})=>l.jsxs("li",{className:"gap-xs fade-in flex items-center transition-all duration-200",children:[l.jsx(MBe,{color:r}),l.jsx(B,{variant:"tiny",color:"light",children:String(n)})]},String(n)))})}),fx=A.memo(function({width:t,height:n,children:r,ref:s}){const a=f.useMemo(()=>({position:"relative",height:n,overflow:"visible"}),[n]);return l.jsx(Y,{style:a,children:l.jsx("svg",{width:t,ref:s,height:n,style:{position:"absolute",left:0,top:0,overflow:"visible"},children:r})})});function W8(e){return function(){return e}}function TBe(e){return e[0]}function ABe(e){return e[1]}function Hg(){this._=null}function mx(e){e.U=e.C=e.L=e.R=e.P=e.N=null}Hg.prototype={constructor:Hg,insert:function(e,t){var n,r,s;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=K8(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)r=n.U,n===r.L?(s=r.R,s&&s.C?(n.C=s.C=!1,r.C=!0,e=r):(e===n.R&&(Cd(this,n),e=n,n=e.U),n.C=!1,r.C=!0,wd(this,r))):(s=r.L,s&&s.C?(n.C=s.C=!1,r.C=!0,e=r):(e===n.L&&(wd(this,n),e=n,n=e.U),n.C=!1,r.C=!0,Cd(this,r))),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t=e.U,n,r=e.L,s=e.R,a,o;if(r?s?a=K8(s):a=r:a=s,t?t.L===e?t.L=a:t.R=a:this._=a,r&&s?(o=a.C,a.C=e.C,a.L=r,r.U=a,a!==s?(t=a.U,a.U=e.U,e=a.R,t.L=e,a.R=s,s.U=a):(a.U=t,t=a,e=a.R)):(o=e.C,e=a),e&&(e.U=t),!o){if(e&&e.C){e.C=!1;return}do{if(e===this._)break;if(e===t.L){if(n=t.R,n.C&&(n.C=!1,t.C=!0,Cd(this,t),n=t.R),n.L&&n.L.C||n.R&&n.R.C){(!n.R||!n.R.C)&&(n.L.C=!1,n.C=!0,wd(this,n),n=t.R),n.C=t.C,t.C=n.R.C=!1,Cd(this,t),e=this._;break}}else if(n=t.L,n.C&&(n.C=!1,t.C=!0,wd(this,t),n=t.L),n.L&&n.L.C||n.R&&n.R.C){(!n.L||!n.L.C)&&(n.R.C=!1,n.C=!0,Cd(this,n),n=t.L),n.C=t.C,t.C=n.L.C=!1,wd(this,t),e=this._;break}n.C=!0,e=t,t=t.U}while(!e.C);e&&(e.C=!1)}}};function Cd(e,t){var n=t,r=t.R,s=n.U;s?s.L===n?s.L=r:s.R=r:e._=r,r.U=s,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function wd(e,t){var n=t,r=t.L,s=n.U;s?s.L===n?s.L=r:s.R=r:e._=r,r.U=s,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function K8(e){for(;e.L;)e=e.L;return e}function jd(e,t,n,r){var s=[null,null],a=kr.push(s)-1;return s.left=e,s.right=t,n&&Vg(s,e,t,n),r&&Vg(s,t,e,r),ds[e.index].halfedges.push(a),ds[t.index].halfedges.push(a),s}function Sd(e,t,n){var r=[t,n];return r.left=e,r}function Vg(e,t,n,r){!e[0]&&!e[1]?(e[0]=r,e.left=t,e.right=n):e.left===n?e[1]=r:e[0]=r}function NBe(e,t,n,r,s){var a=e[0],o=e[1],i=a[0],c=a[1],u=o[0],d=o[1],m=0,p=1,h=u-i,g=d-c,y;if(y=t-i,!(!h&&y>0)){if(y/=h,h<0){if(y<m)return;y<p&&(p=y)}else if(h>0){if(y>p)return;y>m&&(m=y)}if(y=r-i,!(!h&&y<0)){if(y/=h,h<0){if(y>p)return;y>m&&(m=y)}else if(h>0){if(y<m)return;y<p&&(p=y)}if(y=n-c,!(!g&&y>0)){if(y/=g,g<0){if(y<m)return;y<p&&(p=y)}else if(g>0){if(y>p)return;y>m&&(m=y)}if(y=s-c,!(!g&&y<0)){if(y/=g,g<0){if(y>p)return;y>m&&(m=y)}else if(g>0){if(y<m)return;y<p&&(p=y)}return!(m>0)&&!(p<1)||(m>0&&(e[0]=[i+m*h,c+m*g]),p<1&&(e[1]=[i+p*h,c+p*g])),!0}}}}}function RBe(e,t,n,r,s){var a=e[1];if(a)return!0;var o=e[0],i=e.left,c=e.right,u=i[0],d=i[1],m=c[0],p=c[1],h=(u+m)/2,g=(d+p)/2,y,b;if(p===d){if(h<t||h>=r)return;if(u>m){if(!o)o=[h,n];else if(o[1]>=s)return;a=[h,s]}else{if(!o)o=[h,s];else if(o[1]<n)return;a=[h,n]}}else if(y=(u-m)/(p-d),b=g-y*h,y<-1||y>1)if(u>m){if(!o)o=[(n-b)/y,n];else if(o[1]>=s)return;a=[(s-b)/y,s]}else{if(!o)o=[(s-b)/y,s];else if(o[1]<n)return;a=[(n-b)/y,n]}else if(d<p){if(!o)o=[t,y*t+b];else if(o[0]>=r)return;a=[r,y*r+b]}else{if(!o)o=[r,y*r+b];else if(o[0]<t)return;a=[t,y*t+b]}return e[0]=o,e[1]=a,!0}function DBe(e,t,n,r){for(var s=kr.length,a;s--;)(!RBe(a=kr[s],e,t,n,r)||!NBe(a,e,t,n,r)||!(Math.abs(a[0][0]-a[1][0])>fn||Math.abs(a[0][1]-a[1][1])>fn))&&delete kr[s]}function IBe(e){return ds[e.index]={site:e,halfedges:[]}}function jBe(e,t){var n=e.site,r=t.left,s=t.right;return n===s&&(s=r,r=n),s?Math.atan2(s[1]-r[1],s[0]-r[0]):(n===r?(r=t[1],s=t[0]):(r=t[0],s=t[1]),Math.atan2(r[0]-s[0],s[1]-r[1]))}function pz(e,t){return t[+(t.left!==e.site)]}function PBe(e,t){return t[+(t.left===e.site)]}function OBe(){for(var e=0,t=ds.length,n,r,s,a;e<t;++e)if((n=ds[e])&&(a=(r=n.halfedges).length)){var o=new Array(a),i=new Array(a);for(s=0;s<a;++s)o[s]=s,i[s]=jBe(n,kr[r[s]]);for(o.sort(function(c,u){return i[u]-i[c]}),s=0;s<a;++s)i[s]=r[o[s]];for(s=0;s<a;++s)r[s]=i[s]}}function LBe(e,t,n,r){var s=ds.length,a,o,i,c,u,d,m,p,h,g,y,b,x=!0;for(a=0;a<s;++a)if(o=ds[a]){for(i=o.site,u=o.halfedges,c=u.length;c--;)kr[u[c]]||u.splice(c,1);for(c=0,d=u.length;c<d;)g=PBe(o,kr[u[c]]),y=g[0],b=g[1],m=pz(o,kr[u[++c%d]]),p=m[0],h=m[1],(Math.abs(y-p)>fn||Math.abs(b-h)>fn)&&(u.splice(c,0,kr.push(Sd(i,g,Math.abs(y-e)<fn&&r-b>fn?[e,Math.abs(p-e)<fn?h:r]:Math.abs(b-r)<fn&&n-y>fn?[Math.abs(h-r)<fn?p:n,r]:Math.abs(y-n)<fn&&b-t>fn?[n,Math.abs(p-n)<fn?h:t]:Math.abs(b-t)<fn&&y-e>fn?[Math.abs(h-t)<fn?p:e,t]:null))-1),++d);d&&(x=!1)}if(x){var _,v,C,w=1/0;for(a=0,x=null;a<s;++a)(o=ds[a])&&(i=o.site,_=i[0]-e,v=i[1]-t,C=_*_+v*v,C<w&&(w=C,x=o));if(x){var S=[e,t],E=[e,r],T=[n,r],k=[n,t];x.halfedges.push(kr.push(Sd(i=x.site,S,E))-1,kr.push(Sd(i,E,T))-1,kr.push(Sd(i,T,k))-1,kr.push(Sd(i,k,S))-1)}}for(a=0;a<s;++a)(o=ds[a])&&(o.halfedges.length||delete ds[a])}var hz=[],v5;function FBe(){mx(this),this.x=this.y=this.arc=this.site=this.cy=null}function wc(e){var t=e.P,n=e.N;if(!(!t||!n)){var r=t.site,s=e.site,a=n.site;if(r!==a){var o=s[0],i=s[1],c=r[0]-o,u=r[1]-i,d=a[0]-o,m=a[1]-i,p=2*(c*m-u*d);if(!(p>=-1e-12)){var h=c*c+u*u,g=d*d+m*m,y=(m*h-u*g)/p,b=(c*g-d*h)/p,x=hz.pop()||new FBe;x.arc=e,x.site=s,x.x=y+o,x.y=(x.cy=b+i)+Math.sqrt(y*y+b*b),e.circle=x;for(var _=null,v=Of._;v;)if(x.y<v.y||x.y===v.y&&x.x<=v.x)if(v.L)v=v.L;else{_=v.P;break}else if(v.R)v=v.R;else{_=v;break}Of.insert(_,x),_||(v5=x)}}}}function Lc(e){var t=e.circle;t&&(t.P||(v5=t.N),Of.remove(t),hz.push(t),mx(t),e.circle=null)}var gz=[];function UBe(){mx(this),this.edge=this.site=this.circle=null}function Y8(e){var t=gz.pop()||new UBe;return t.site=e,t}function h2(e){Lc(e),Fc.remove(e),gz.push(e),mx(e)}function BBe(e){var t=e.circle,n=t.x,r=t.cy,s=[n,r],a=e.P,o=e.N,i=[e];h2(e);for(var c=a;c.circle&&Math.abs(n-c.circle.x)<fn&&Math.abs(r-c.circle.cy)<fn;)a=c.P,i.unshift(c),h2(c),c=a;i.unshift(c),Lc(c);for(var u=o;u.circle&&Math.abs(n-u.circle.x)<fn&&Math.abs(r-u.circle.cy)<fn;)o=u.N,i.push(u),h2(u),u=o;i.push(u),Lc(u);var d=i.length,m;for(m=1;m<d;++m)u=i[m],c=i[m-1],Vg(u.edge,c.site,u.site,s);c=i[0],u=i[d-1],u.edge=jd(c.site,u.site,null,s),wc(c),wc(u)}function HBe(e){for(var t=e[0],n=e[1],r,s,a,o,i=Fc._;i;)if(a=yz(i,n)-t,a>fn)i=i.L;else if(o=t-VBe(i,n),o>fn){if(!i.R){r=i;break}i=i.R}else{a>-fn?(r=i.P,s=i):o>-fn?(r=i,s=i.N):r=s=i;break}IBe(e);var c=Y8(e);if(Fc.insert(r,c),!(!r&&!s)){if(r===s){Lc(r),s=Y8(r.site),Fc.insert(c,s),c.edge=s.edge=jd(r.site,c.site),wc(r),wc(s);return}if(!s){c.edge=jd(r.site,c.site);return}Lc(r),Lc(s);var u=r.site,d=u[0],m=u[1],p=e[0]-d,h=e[1]-m,g=s.site,y=g[0]-d,b=g[1]-m,x=2*(p*b-h*y),_=p*p+h*h,v=y*y+b*b,C=[(b*_-h*v)/x+d,(p*v-y*_)/x+m];Vg(s.edge,u,g,C),c.edge=jd(u,e,null,C),s.edge=jd(e,g,null,C),wc(r),wc(s)}}function yz(e,t){var n=e.site,r=n[0],s=n[1],a=s-t;if(!a)return r;var o=e.P;if(!o)return-1/0;n=o.site;var i=n[0],c=n[1],u=c-t;if(!u)return i;var d=i-r,m=1/a-1/u,p=d/u;return m?(-p+Math.sqrt(p*p-2*m*(d*d/(-2*u)-c+u/2+s-a/2)))/m+r:(r+i)/2}function VBe(e,t){var n=e.N;if(n)return yz(n,t);var r=e.site;return r[1]===t?r[0]:1/0}var fn=1e-6,Fc,ds,Of,kr;function GBe(e,t,n){return(e[0]-n[0])*(t[1]-e[1])-(e[0]-t[0])*(n[1]-e[1])}function zBe(e,t){return t[1]-e[1]||t[0]-e[0]}function EC(e,t){var n=e.sort(zBe).pop(),r,s,a;for(kr=[],ds=new Array(e.length),Fc=new Hg,Of=new Hg;;)if(a=v5,n&&(!a||n[1]<a.y||n[1]===a.y&&n[0]<a.x))(n[0]!==r||n[1]!==s)&&(HBe(n),r=n[0],s=n[1]),n=e.pop();else if(a)BBe(a.arc);else break;if(OBe(),t){var o=+t[0][0],i=+t[0][1],c=+t[1][0],u=+t[1][1];DBe(o,i,c,u),LBe(o,i,c,u)}this.edges=kr,this.cells=ds,Fc=Of=kr=ds=null}EC.prototype={constructor:EC,polygons:function(){var e=this.edges;return this.cells.map(function(t){var n=t.halfedges.map(function(r){return pz(t,e[r])});return n.data=t.site.data,n})},triangles:function(){var e=[],t=this.edges;return this.cells.forEach(function(n,r){if(i=(a=n.halfedges).length)for(var s=n.site,a,o=-1,i,c,u=t[a[i-1]],d=u.left===s?u.right:u.left;++o<i;)c=d,u=t[a[o]],d=u.left===s?u.right:u.left,c&&d&&r<c.index&&r<d.index&&GBe(s,c,d)<0&&e.push([s.data,c.data,d.data])}),e},links:function(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function(e,t,n){for(var r=this,s,a=r._found||0,o=r.cells.length,i;!(i=r.cells[a]);)if(++a>=o)return null;var c=e-i.site[0],u=t-i.site[1],d=c*c+u*u;do i=r.cells[s=a],a=null,i.halfedges.forEach(function(m){var p=r.edges[m],h=p.left;if(!((h===i.site||!h)&&!(h=p.right))){var g=e-h[0],y=t-h[1],b=g*g+y*y;b<d&&(d=b,a=h.index)}});while(a!==null);return r._found=s,n==null||d<=n*n?i.site:null}};function qBe(){var e=TBe,t=ABe,n=null;function r(s){return new EC(s.map(function(a,o){var i=[Math.round(e(a,o,s)/fn)*fn,Math.round(t(a,o,s)/fn)*fn];return i.index=o,i.data=a,i}),n)}return r.polygons=function(s){return r(s).polygons()},r.links=function(s){return r(s).links()},r.triangles=function(s){return r(s).triangles()},r.x=function(s){return arguments.length?(e=typeof s=="function"?s:W8(+s),r):e},r.y=function(s){return arguments.length?(t=typeof s=="function"?s:W8(+s),r):t},r.extent=function(s){return arguments.length?(n=s==null?null:[[+s[0][0],+s[0][1]],[+s[1][0],+s[1][1]]],r):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},r.size=function(s){return arguments.length?(n=s==null?null:[[0,0],[+s[0],+s[1]]],r):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},r}var th=1;function $Be(e){var t=e.width,n=t===void 0?0:t,r=e.height,s=r===void 0?0:r,a=e.x,o=e.y,i=qBe();return a&&i.x(a),o&&i.y(o),i.extent([[-th,-th],[n+th,s+th]]),i}function px({data:e,innerHeight:t,innerWidth:n,xScale:r,yScale:s,xGet:a,yGet:o,voronoiRadius:i=void 0}){const{showTooltip:c,hideTooltip:u,tooltipData:d}=sx(),m=f.useMemo(()=>$Be({width:n,height:t,x:g=>r(a(g)),y:g=>s(o(g))})(e),[e,n,t,r,s,a,o]),p=f.useCallback(h=>{const{x:g,y}=Fm(h)??{x:0,y:0},b=m.find(g,y,i);if(!b)return u();c({tooltipData:{localPoint:{x:g,y},voronoiSite:b}})},[c,u,m,i]);return f.useMemo(()=>({showTooltip:c,hideTooltip:u,handleTooltip:p,tooltipData:d}),[p,u,c,d])}const hx=A.memo(function({margin:t,height:n,width:r,tooltipHandle:s,tooltipHide:a,maxYLabelWidth:o}){const c=f.useCallback(()=>a(),[a]);return l.jsx(Vu,{x:t.left+o-2.5,y:t.top,width:r-t.right-t.left*2-o+2.5*2,height:n-t.bottom-t.top,fill:"transparent",onTouchStart:s,onTouchMove:s,onMouseMove:s,onMouseLeave:c})}),Gg=A.memo(function({cx:t,cy:n,color:r,r:s=3}){return l.jsx("circle",{cx:t,cy:n,r:s,fill:r,stroke:r,strokeWidth:1})}),Lf=A.memo(function({marginTop:t,tooltipLeft:n=0,innerHeight:r,color:s,strokeWidth:a=1,dotted:o=!1}){const i=f.useMemo(()=>({x:n,y:t}),[t,n]),c=f.useMemo(()=>({x:n,y:r+t}),[r,t,n]);return l.jsx("g",{children:l.jsx($y,{from:i,to:c,stroke:s,strokeWidth:a,strokeDasharray:o?"4 4":void 0,pointerEvents:"none",className:"animate-in fade-in duration-300"})})}),g2=e=>e,WBe=A.memo(function({entry:t,xFormat:n=g2,yFormat:r=g2,zFormat:s=g2,xGet:a,yGet:o,zGet:i}){const c=[{value:n(a(t))},{value:r(o(t))}];i&&c.unshift({value:s(i(t))});const u=c.filter(d=>d.value);return l.jsx(Y,{children:u.map(({value:d},m)=>l.jsx(B,{variant:"tiny",className:"py-two",children:String(d)},m))})}),KBe=A.memo(function({tooltipTop:t=0,tooltipLeft:n=0,children:r}){const s=f.useMemo(()=>({position:"absolute",pointerEvents:"none"}),[]);return l.jsx(iG,{top:t,left:n,style:s,children:l.jsx(Y,{variant:"background",className:"p-sm dark:border-inverse rounded-md border shadow-sm",children:r})})}),gx=A.memo(function({tooltipTop:t,tooltipLeft:n,entry:r,data:s,config:a,UserToolTip:o,xFormat:i,yFormat:c,zFormat:u,zGet:d,xGet:m,yGet:p}){return l.jsx(KBe,{tooltipTop:t,tooltipLeft:n,children:o?l.jsx(o,{entry:r,config:a,data:s}):l.jsx(WBe,{entry:r,config:a,xFormat:i,yFormat:c,zFormat:u,zGet:d,xGet:m,yGet:p})})}),uc=0,YBe=A.memo(function(t){const{width:n,height:r,margin:s,config:a,tooltip:o,colors:i,axes:c=!0}=t,{colorSchema:u,axisColor:d,tickColor:m}=Jy(i),p=ro(),h=ex({data:t.data}),{xAxisRef:g,yAxisRef:y,maxYLabelWidth:b,maxXLabelWidth:x,minXRequiredWidth:_}=lx(),{innerHeight:v,innerWidth:C,xRange:w,yRange:S}=rx({width:n,height:r,margin:s,maxYLabelWidth:b,hasAxis:c}),{xNumTicks:E,yNumTicks:T,xTiltTicks:k}=cx({config:a,innerWidth:C,innerHeight:v,maxXLabelWidth:x}),{xGet:M,yGet:N,zGet:P}=tx({config:a}),{xFormat:O,yFormat:L,xTooltipFormat:H,yTooltipFormat:R,zTooltipFormat:I}=nx({config:a}),F=f.useMemo(()=>{if(!a?.z?.accessor)return[{key:"default",data:h}];const ie=a.z.accessor,ue=cf(h,ce=>String(ce[ie]));return Object.entries(ue).map(([ce,me])=>({key:ce,data:me}))},[h,a.z]),G=F.length>1,j=G?F.map(({key:ie})=>ie):h.map(M),$=ps.band({range:w,domain:j,padding:.4}),q=[...new Set(h.map(M))],U=ps.band({range:[0,$.bandwidth()],domain:q,padding:.1}),X=f.useMemo(()=>{const[ie,ue]=Os(h,N),ce=Math.min(uc,ie),me=Math.max(uc,ue);return[ce,me]},[h,N]),J=f.useMemo(()=>ps.linear({range:S,domain:X}),[S,X]),ne=ps.ordinal({range:u.slice(0,q.length),domain:G?q:j}),{tooltipData:ae,hideTooltip:de,handleTooltip:oe}=px({data:h,innerHeight:v,innerWidth:C,xScale:G?U:$,yScale:J,xGet:M,yGet:N}),se=f.useCallback(({localPoint:ie})=>{const ue=G?U:$,ce=ue.bandwidth(),me=(ue.step()-ce)/4;if(isNaN(ie?.x??NaN)||isNaN(ie?.y??NaN))return null;const pe=ie?.x,xe=ie?.y;return h.reduce((Oe,Te)=>{let we=ue(M(Te))||0;const ke=J(N(Te)),Fe=Math.abs(ke-J(0));return G&&(we+=$(Te.z)||0),we!==void 0&&ke!==void 0&&pe>=we-me&&pe<=we+ce+me&&xe>=ke-Fe&&xe<=ke+Fe?{x:we,y:ke,data:Te}:Oe},null)},[h,$,M,J,N,G,U])({localPoint:ae?.localPoint}),re=f.useMemo(()=>({marginLeft:s.left,marginRight:s.right}),[s.left,s.right]),he=f.useMemo(()=>[uc],[]);return l.jsxs(Y,{className:"relative",children:[G&&q.length>1&&l.jsx(Y,{style:re,children:l.jsx(dx,{entries:q.map(ie=>({key:ie,color:ne(ie)}))})}),l.jsxs(fx,{width:n,height:r,children:[l.jsx(ux,{xScale:$,yScale:J,xFormat:O,yFormat:L,width:n,height:r,margin:s,yNumTicks:T,xNumTicks:E,yTickValues:a.y.tickValues,xTickValues:a.x.tickValues,xAxisLabel:a.x.label,yAxisLabel:a.y.label,animated:!0,tickColor:m,axisColor:d,xAxisRef:g,yAxisRef:y,xTiltTicks:k}),p&&l.jsx(fz,{left:s.left,scale:J,width:n-s.right-s.left*2,stroke:d,tickValues:he,strokeWidth:2}),F.map(({key:ie,data:ue})=>l.jsx(Ur,{left:$(ie),children:ue.map((ce,me)=>{const pe=G?U:$;return l.jsx(ze.rect,{rx:2,ry:2,x:pe(M(ce)),width:pe.bandwidth(),fill:ne(G?me:ie),initial:{y:J(uc),height:0,opacity:0},animate:{y:J(Math.max(uc,N(ce))),height:Math.abs(J(N(ce))-J(uc)),opacity:1},transition:{duration:.5,ease:"easeInOut"}},me)})},ie)),l.jsx(hx,{margin:s,tooltipHandle:oe,tooltipHide:de,height:r,width:n,maxYLabelWidth:b})]}),se&&ae&&l.jsx(gx,{UserToolTip:o,tooltipTop:ae?.localPoint?.y,tooltipLeft:ae?.localPoint?.x,entry:se.data,data:h,config:a,xFormat:H,yFormat:R,zFormat:I,zGet:P,xGet:M,yGet:N})]})});var QBe=["children","id","from","to","x1","y1","x2","y2","fromOffset","fromOpacity","toOffset","toOpacity","rotate","transform","vertical"];function kC(){return kC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},kC.apply(this,arguments)}function XBe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function C5(e){var t=e.children,n=e.id,r=e.from,s=e.to,a=e.x1,o=e.y1,i=e.x2,c=e.y2,u=e.fromOffset,d=u===void 0?"0%":u,m=e.fromOpacity,p=m===void 0?1:m,h=e.toOffset,g=h===void 0?"100%":h,y=e.toOpacity,b=y===void 0?1:y,x=e.rotate,_=e.transform,v=e.vertical,C=v===void 0?!0:v,w=XBe(e,QBe),S=a,E=i,T=o,k=c;return C&&!S&&!E&&!T&&!k&&(S="0",E="0",T="0",k="1"),A.createElement("defs",null,A.createElement("linearGradient",kC({id:n,x1:S,y1:T,x2:E,y2:k,gradientTransform:x?"rotate("+x+")":_},w),!!t&&t,!t&&A.createElement("stop",{offset:d,stopColor:r,stopOpacity:p}),!t&&A.createElement("stop",{offset:g,stopColor:s,stopOpacity:b})))}C5.propTypes={id:Je.string.isRequired,from:Je.string,to:Je.string,x1:Je.oneOfType([Je.string,Je.number]),x2:Je.oneOfType([Je.string,Je.number]),y1:Je.oneOfType([Je.string,Je.number]),y2:Je.oneOfType([Je.string,Je.number]),fromOffset:Je.oneOfType([Je.string,Je.number]),fromOpacity:Je.oneOfType([Je.string,Je.number]),toOffset:Je.oneOfType([Je.string,Je.number]),toOpacity:Je.oneOfType([Je.string,Je.number]),rotate:Je.oneOfType([Je.string,Je.number]),transform:Je.string,children:Je.node,vertical:Je.bool};function ZBe({xScale:e,xPosition:t}){const n=e.domain(),[r,s]=e.range(),a=(s-r)/(n.length-1),o=Math.min(Math.max(Math.round((t-r)/a),0),n.length-1);return n[o]}function JBe({tooltipData:e,config:t,groups:n,xScale:r,xGet:s}){const a=t.z?.accessor?e?.voronoiSite?.data?.[t.z?.accessor]:"",o=f.useMemo(()=>[...(n.find(({key:m})=>m===a)||n[0])?.d||[]].sort((m,p)=>s(m)-s(p)),[a,n,s]),i=e?.localPoint.x,c=f.useMemo(()=>o.map(s),[o,s]);return f.useMemo(()=>{if(i==null)return;if("invert"in r){const p=r.invert(i),h=Ou(c,p);if(h<=0)return o[0];if(h>=c.length)return o[c.length-1];const g=o[h-1],y=o[h];return Math.abs(s(g)-p)<Math.abs(s(y)-p)?g:y}const d=ZBe({xScale:r,xPosition:i}),m=o.find(p=>String(s(p))===String(d));return m||o.reduce((p,h)=>Math.abs(s(h)-d)<Math.abs(s(p)-d)?h:p,o[0])},[i,r,o,s,c])}const eHe=A.memo(function(t){const{$t:n}=Q(),{width:r,height:s,margin:a={top:0,right:0,bottom:0,left:0},config:o,tooltip:i,axes:c=!0,colors:u,animate:d=!0,includeLegend:m=!0,endTime:p,previousClose:h,exchangeName:g,showLastPoint:y=!1,children:b}=t,[x,_]=f.useState(null),v=ex({data:t.data}),C=f.useRef(new Set),{colorSchema:w,tickColor:S,axisColor:E,textColor:T}=Jy(u),{colorScheme:k}=Cs(),M=k==="dark",{xAxisRef:N,yAxisRef:P,maxYLabelWidth:O,maxXLabelWidth:L,minXRequiredWidth:H}=lx(),{xGet:R,yGet:I,zGet:F}=tx({config:o}),{xFormat:G,yFormat:j,xTooltipFormat:$,yTooltipFormat:q,zTooltipFormat:U}=nx({config:o}),{xDomain:X,yDomain:J}=o5({config:o,data:v,xGet:R,yGet:I,endTime:p,previousClose:h}),{innerHeight:ne,innerWidth:ae,xRange:de,yRange:oe}=rx({width:r,height:s,margin:a,maxYLabelWidth:O,hasAxis:c}),{xNumTicks:le,yNumTicks:se,xTiltTicks:re}=cx({config:o,innerWidth:ae,innerHeight:ne,maxXLabelWidth:L}),{scale:he}=o.x,{scale:ie}=o.y,ue=f.useMemo(()=>ps[he]({range:[de[0],L?de[1]-L/2:de[1]],domain:X}),[he,de,X,L]),ce=f.useMemo(()=>{const We=ie==="log";return ps[ie]({range:oe,domain:J,base:We?2:void 0,nice:!We,round:!0})},[ie,oe,J]),me=f.useMemo(()=>{if(!o.z?.accessor)return[{key:"",d:v}];const We=o.z.accessor,it=cf(v,Ee=>String(Ee[We]));return Object.entries(it).map(([Ee,et])=>({key:Ee,d:et}))},[v,o?.z?.accessor]),pe=f.useMemo(()=>{if(me.length<=1)return null;const We=new Map;return me.forEach(Ee=>{Ee.d.forEach(et=>{const xt=R(et);We.set(xt,et)})}),Array.from(We.values()).sort((Ee,et)=>R(Ee)-R(et))},[me,R]),{tooltipData:xe,hideTooltip:Oe,handleTooltip:Te}=px({data:v,innerHeight:ne,innerWidth:ae,xScale:ue,yScale:ce,xGet:R,yGet:I}),we=JBe({tooltipData:xe,config:o,groups:me,xScale:ue,xGet:R}),ke=f.useMemo(()=>!y||!me.length||!me[0].d.length?null:me[0].d.at(-1),[me,y]),Fe=f.useMemo(()=>Fo().x(We=>ue(R(We))).y(We=>ce(I(We))).curve(Cl),[ue,ce,R,I]),ot=f.useMemo(()=>ps.ordinal({domain:me.map(({key:We})=>We),range:w}),[w,me]),ge=f.useCallback(()=>{xe&&_(we||null)},[xe,we]),Ce=f.useCallback(()=>{_(null)},[]),Ae=f.useMemo(()=>{const We={};if(!x||!we||!me.length)return We;const it=R(x),Ee=R(we),[et,xt]=it<Ee?[it,Ee]:[Ee,it],Ut=ir=>{const br=o.z?.accessor?ir[o.z.accessor]:me[0].key,lt=me.find(({key:mt})=>mt===br);return lt?lt.d.filter(mt=>{const At=R(mt);return At>=et&&At<=xt}):[]},Tt=o.z?.accessor?x[o.z.accessor]:me[0].key;We[Tt]=Ut(x);const gn=o.z?.accessor?we[o.z.accessor]:me[0].key;return Tt!==gn&&(We[gn]=Ut(we)),We},[x,we,me,R,o.z?.accessor]),He=f.useMemo(()=>{const We=Ae[o.z?.accessor?x?.[o.z.accessor]:me[0]?.key]||[],it=Ae[o.z?.accessor?we?.[o.z.accessor]:me[0]?.key]||[],Ee=[...We,...it],et=new Map;return Ee.forEach(Ut=>{et.set(R(Ut),Ut)}),Array.from(et.values()).sort((Ut,Tt)=>R(Ut)-R(Tt))},[Ae,o.z?.accessor,x,we,me,R]),rt=f.useMemo(()=>({marginLeft:a.left,marginRight:a.right}),[a.left,a.right]),Ft=f.useMemo(()=>[h],[h]),Qt=f.useCallback(We=>ue(R(We))??0,[ue,R]),Ye=f.useCallback(We=>ce(I(We))??0,[ce,I]);return l.jsxs(Y,{children:[o.z&&me?.length>1&&m&&l.jsx(Y,{style:rt,children:l.jsx(dx,{entries:me.map(({key:We})=>({key:We,color:ot(We)}))})}),l.jsxs(Y,{className:"relative",onMouseDown:ge,onMouseUp:Ce,onMouseLeave:Ce,children:[l.jsxs(fx,{width:r,height:s,children:[c&&l.jsx(ux,{width:r,height:s,margin:a,xScale:ue,yScale:ce,xFormat:G,yFormat:j,yNumTicks:se,xNumTicks:le,yTickValues:o.y.tickValues,xTickValues:o.x.tickValues,tickColor:S,axisColor:E,xAxisRef:N,yAxisRef:P,xTiltTicks:re,xAxisLabel:o.x.label,yAxisLabel:o.y.label}),b&&b({xScale:ue,yScale:ce,xGet:R,yGet:I}),h&&l.jsx("text",{x:r-a.right-10,y:ce(h)-5,fill:T,fontSize:12,className:"font-mono",textAnchor:"end",children:g==="CRYPTO"?n({defaultMessage:"Prev day: {value}",id:"7i8MvDtMyq"},{value:typeof o.y.format=="function"?o.y.format(h):h}):n({defaultMessage:"Prev close: {value}",id:"uRPxTu0cgj"},{value:typeof o.y.format=="function"?o.y.format(h):h})}),h&&l.jsx(ql,{left:a.left,scale:ce,width:r-a.right-a.left*2,stroke:T,tickValues:Ft,strokeWidth:2,strokeDasharray:"2,6",opacity:M?.6:1}),we&&l.jsx(Lf,{marginTop:a.top,tooltipLeft:ue(R(we)),innerHeight:ne,color:E,strokeWidth:1}),x&&l.jsx(Lf,{marginTop:a.top,tooltipLeft:ue(R(x)),innerHeight:ne,color:E,strokeWidth:1}),pe&&me.length>1&&me[1]?.key&&l.jsx(ze.path,{d:Fe(pe),stroke:ot(me[1].key),strokeWidth:1.5,fill:"none",shapeRendering:"geometricPrecision",initial:d?{pathLength:d?0:1,opacity:d?0:1}:void 0,animate:d?{pathLength:1,opacity:1}:void 0,transition:d?{duration:.8,ease:ai}:void 0}),me.map(({d:We,key:it},Ee)=>{const et=C.current.has(it),xt=et||!d?{initial:void 0,animate:{pathLength:1,opacity:1}}:{initial:{pathLength:d?0:1,opacity:d?0:1},animate:{pathLength:1,opacity:1},transition:{duration:.8,ease:ai,delay:Ee/me.length}};return et||C.current.add(it),l.jsx(ze.path,{d:Fe(We),stroke:ot(it),strokeWidth:2,fill:"none",shapeRendering:"geometricPrecision",...xt},it)}),(we||ke)&&l.jsxs(ze.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:0,delay:.8},children:[l.jsx(Gg,{cx:ue(R(we||ke)),cy:ce(I(we||ke)),color:ot(o.z?.accessor?(we||ke)?.[o.z.accessor]:""),r:5}),x&&we&&l.jsxs(l.Fragment,{children:[l.jsx(Gg,{cx:ue(R(x)),cy:ce(I(x)),color:ot(o.z?.accessor?x[o.z.accessor]:""),r:5}),He.length>1&&l.jsx(jf,{data:He,x:Qt,y:Ye,fill:ot(me[0].key),fillOpacity:.2,stroke:"none",yScale:ce,curve:Cl})]})]}),(me.length===1||me.length===2)&&me.map(({d:We,key:it},Ee)=>{const et=ot(it);return l.jsx(ze.g,{initial:d?{opacity:0,clipPath:"inset(0% 100% 0% 0%)"}:void 0,animate:d?{opacity:1,clipPath:"inset(0% 0% 0% 0%)"}:void 0,transition:d?{duration:.8,ease:ai,delay:Ee/me.length}:void 0,children:!x&&(me.length===1||Ee===0)&&l.jsxs(l.Fragment,{children:[l.jsx(C5,{from:`${et}22`,to:`${et}00`,id:it}),l.jsx(jf,{data:We,x:Qt,y:Ye,strokeWidth:0,yScale:ce,fill:`url('#${it}')`},it)]})},it)}),l.jsx(hx,{margin:a,tooltipHandle:Te,tooltipHide:Oe,height:s,width:r,maxYLabelWidth:O})]}),we&&xe&&l.jsx(gx,{tooltipTop:xe.localPoint.y,tooltipLeft:xe.localPoint.x,entry:we,UserToolTip:i?We=>l.jsx(i,{...We,comparisonEntry:x||void 0}):void 0,data:v,config:o,xFormat:$,yFormat:q,zFormat:U,zGet:F,xGet:R,yGet:I})]})]})});function tHe({xScale:e,xPosition:t}){const n=e.domain(),[r,s]=e.range(),a=(s-r)/(n.length-1),o=Math.min(Math.max(Math.round((t-r)/a),0),n.length-1);return n[o]}function nHe({tooltipData:e,config:t,groups:n,xScale:r,xGet:s}){const a=t.z?.accessor?e?.voronoiSite?.data?.[t.z?.accessor]:"",o=f.useMemo(()=>[...(n.find(({key:d})=>d===a)||n[0])?.d||[]].sort((d,m)=>s(d)-s(m)),[a,n,s]),i=e?.localPoint.x;return f.useMemo(()=>{if(!i)return;if("invert"in r){const m=r.invert(i),p=Ou(o.map(s),m);return o?.[p-1]}const u=tHe({xScale:r,xPosition:i});return o.find(m=>String(s(m))===String(u))},[i,r,o,s])}const rHe=A.memo(function(t){const{$t:n}=Q(),{enableComparison:r=!0,width:s,height:a,margin:o={top:0,right:0,bottom:0,left:0},config:i,tooltip:c,axes:u=!0,colors:d,animate:m=!0,includeLegend:p=!0,endTime:h,previousClose:g,exchangeName:y,showLastPoint:b=!1,children:x}=t,[_,v]=f.useState(null),C=ex({data:t.data}),w=ro(),{colorSchema:S,tickColor:E,axisColor:T,textColor:k}=Jy(d),{colorScheme:M}=Cs(),N=f.useMemo(()=>w?M==="dark":!1,[M,w]),{xAxisRef:P,yAxisRef:O,maxYLabelWidth:L,maxXLabelWidth:H,minXRequiredWidth:R}=lx(),{xGet:I,yGet:F,zGet:G}=tx({config:i}),{xFormat:j,yFormat:$,xTooltipFormat:q,yTooltipFormat:U,zTooltipFormat:X}=nx({config:i}),{xDomain:J,yDomain:ne}=o5({config:i,data:C,xGet:I,yGet:F,endTime:h,previousClose:g}),{innerHeight:ae,innerWidth:de,xRange:oe,yRange:le}=rx({width:s,height:a,margin:o,maxYLabelWidth:L,hasAxis:u}),{xNumTicks:se,yNumTicks:re,xTiltTicks:he}=cx({config:i,innerWidth:de,innerHeight:ae,maxXLabelWidth:H}),ie=i.x.scale,ue=f.useMemo(()=>ps[ie]({range:[oe[0],H?oe[1]-H/2:oe[1]],domain:J}),[ie,oe,J,H]),ce=i.y.scale,me=f.useMemo(()=>{const Ye=ce==="log";return ps[ce]({range:le,domain:ne,base:Ye?2:void 0,nice:!Ye,round:!0})},[ce,le,ne]),pe=f.useMemo(()=>{if(!i.z?.accessor)return[{key:"",d:C}];const Ye=i.z.accessor,We=cf(C,it=>String(it[Ye]));return Object.entries(We).map(([it,Ee])=>({key:it,d:Ee}))},[C,i?.z?.accessor]),{tooltipData:xe,hideTooltip:Oe,handleTooltip:Te}=px({data:C,innerHeight:ae,innerWidth:de,xScale:ue,yScale:me,xGet:I,yGet:F}),we=nHe({tooltipData:xe,config:i,groups:pe,xScale:ue,xGet:I}),ke=f.useMemo(()=>!b||!pe.length||!pe[0].d.length?null:pe[0].d.at(-1),[pe,b]),Fe=f.useMemo(()=>Fo().x(Ye=>ue(I(Ye))).y(Ye=>me(F(Ye))).curve(Cl),[ue,me,I,F]),ot=f.useMemo(()=>ps.ordinal({range:S}),[S]),ge=f.useCallback(()=>{!xe||!r||v(we||null)},[r,xe,we]),Ce=f.useCallback(()=>{r&&v(null)},[r]),Ae=f.useMemo(()=>{if(!_||!we||!pe.length)return[];const Ye=pe[0],We=I(_),it=I(we),[Ee,et]=We<it?[We,it]:[it,We];return Ye.d.filter(xt=>{const Ut=I(xt);return Ut>=Ee&&Ut<=et})},[_,we,pe,I]),He=f.useMemo(()=>({marginLeft:o.left,marginRight:o.right}),[o.left,o.right]),rt=f.useCallback(Ye=>ue(I(Ye))??0,[ue,I]),Ft=f.useCallback(Ye=>me(F(Ye))??0,[me,F]),Qt=f.useMemo(()=>[g],[g]);return l.jsxs(Y,{children:[i.z&&pe?.length>1&&p&&l.jsx(Y,{style:He,children:l.jsx(dx,{entries:pe.map(({key:Ye})=>({key:Ye,color:ot(Ye)}))})}),l.jsxs(Y,{className:"relative",onMouseDown:ge,onMouseUp:Ce,onMouseLeave:Ce,children:[l.jsxs(fx,{width:s,height:a,children:[u&&l.jsx(ux,{width:s,height:a,margin:o,xScale:ue,yScale:me,xFormat:j,yFormat:$,yNumTicks:re,xNumTicks:se,yTickValues:i.y.tickValues,xTickValues:i.x.tickValues,tickColor:E,axisColor:T,xAxisRef:P,yAxisRef:O,xTiltTicks:he,xAxisLabel:i.x.label,yAxisLabel:i.y.label}),x&&x({xScale:ue,yScale:me,xGet:I,yGet:F}),g&&l.jsx("text",{x:s-o.right-10,y:me(g)-5,fill:k,fontSize:12,className:"font-mono",textAnchor:"end",children:y==="CRYPTO"?n({defaultMessage:"Prev day: {value}",id:"7i8MvDtMyq"},{value:typeof i.y.format=="function"?i.y.format(g):g}):n({defaultMessage:"Prev close: {value}",id:"uRPxTu0cgj"},{value:typeof i.y.format=="function"?i.y.format(g):g})}),g&&l.jsx(ql,{left:o.left,scale:me,width:s-o.right-o.left*2,stroke:k,tickValues:Qt,strokeWidth:2,strokeDasharray:"2,6",opacity:N?.6:1}),we&&l.jsx(Lf,{marginTop:o.top,tooltipLeft:ue(I(we)),innerHeight:ae,color:T,strokeWidth:1}),_&&l.jsx(Lf,{marginTop:o.top,tooltipLeft:ue(I(_)),innerHeight:ae,color:T,strokeWidth:1}),(we||ke)&&l.jsxs(ze.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:0,delay:.8},children:[l.jsx(Gg,{cx:ue(I(we||ke)),cy:me(F(we||ke)),color:ot(i.z?.accessor?(we||ke)?.[i.z.accessor]:""),r:5}),_&&we&&Ae.length>0&&l.jsxs(l.Fragment,{children:[l.jsx(Gg,{cx:ue(I(_)),cy:me(F(_)),color:ot(i.z?.accessor?_[i.z.accessor]:""),r:5}),l.jsx(jf,{data:Ae,x:rt,y:Ft,fill:ot(i.z?.accessor?_[i.z.accessor]:""),fillOpacity:.2,stroke:"none",yScale:me,curve:Cl})]})]}),pe.length===1&&pe.map(({d:Ye,key:We},it)=>{const Ee=ot(We);return l.jsx(ze.g,{initial:m?{opacity:0,clipPath:"inset(0% 100% 0% 0%)"}:void 0,animate:m?{opacity:1,clipPath:"inset(0% 0% 0% 0%)"}:void 0,transition:m?{duration:.8,ease:"easeInOut",delay:it/pe.length}:void 0,children:!_&&l.jsxs(l.Fragment,{children:[l.jsx(C5,{from:`${Ee}22`,to:`${Ee}00`,id:We}),l.jsx(jf,{data:Ye,x:rt,y:Ft,strokeWidth:0,yScale:me,fill:`url('#${We}')`},We)]})},We)}),pe.map(({d:Ye,key:We},it)=>l.jsx(ze.path,{d:Fe(Ye),stroke:ot(We),strokeWidth:2,fill:"none",shapeRendering:"geometricPrecision",initial:m?{pathLength:0,opacity:0}:void 0,animate:m?{pathLength:1,opacity:1}:void 0,transition:m?{duration:.8,ease:"easeInOut",delay:it/pe.length}:void 0},We)),l.jsx(hx,{margin:o,tooltipHandle:Te,tooltipHide:Oe,height:a,width:s,maxYLabelWidth:L})]}),we&&xe&&l.jsx(gx,{tooltipTop:xe.localPoint.y,tooltipLeft:xe.localPoint.x,entry:we,UserToolTip:c?Ye=>l.jsx(c,{...Ye,comparisonEntry:_||void 0}):void 0,data:C,config:i,xFormat:q,yFormat:U,zFormat:X,zGet:G,xGet:I,yGet:F})]})]})}),sHe=A.memo(function(t){const{width:n,height:r,margin:s,config:a,tooltip:o,colors:i,axes:c=!0}=t,u=3,d=ex({data:t.data}),{colorSchema:m,tickColor:p,axisColor:h}=Jy(i),{xAxisRef:g,yAxisRef:y,maxYLabelWidth:b,maxXLabelWidth:x,minXRequiredWidth:_}=lx(),{innerHeight:v,innerWidth:C,xRange:w,yRange:S}=rx({width:n,height:r,margin:s,maxYLabelWidth:b,hasAxis:c}),{xNumTicks:E,yNumTicks:T,xTiltTicks:k}=cx({config:a,innerWidth:C,innerHeight:v,maxXLabelWidth:x}),{xGet:M,yGet:N,zGet:P}=tx({config:a}),{xFormat:O,yFormat:L,xTooltipFormat:H,yTooltipFormat:R,zTooltipFormat:I}=nx({config:a}),{xDomain:F,yDomain:G}=o5({data:d,config:a,xGet:M,yGet:N}),{scale:j}=a.x,$=f.useMemo(()=>ps[j]({range:w,domain:F}),[j,w,F]),{scale:q}=a.y,U=f.useMemo(()=>ps[q]({range:S,domain:G,nice:!0,round:!0}),[q,S,G]),{tooltipData:X,handleTooltip:J,hideTooltip:ne}=px({data:d,innerHeight:v,innerWidth:C,xScale:$,yScale:U,xGet:M,yGet:N,voronoiRadius:u*2}),ae=f.useMemo(()=>ps.ordinal({range:m}),[m]),de=f.useMemo(()=>{if(!a.z?.accessor)return[];const se=new Set([]);return d.forEach(re=>se.add(re[a?.z?.accessor])),Array.from(se)},[d,a.z]),oe=X?.voronoiSite,le=f.useMemo(()=>({marginLeft:s.left,marginRight:s.right}),[s.left,s.right]);return l.jsxs(Y,{children:[de.length>1&&l.jsx(Y,{style:le,children:l.jsx(dx,{entries:de.map(se=>({key:se,color:ae(se)}))})}),l.jsxs(Y,{className:"relative",children:[l.jsxs(fx,{width:n,height:r,children:[l.jsx(ux,{xScale:$,yScale:U,xFormat:O,yFormat:L,width:n,height:r,margin:s,yTickValues:a.y.tickValues,xTickValues:a.x.tickValues,tickColor:p,axisColor:h,xAxisRef:g,yAxisRef:y,yNumTicks:T,xNumTicks:E,xTiltTicks:k}),oe&&l.jsx(Lf,{marginTop:s.top,tooltipLeft:oe[0],innerHeight:v,color:h}),l.jsx("g",{children:d.map((se,re)=>{const he=oe?.data?.__key==se.__key,ie=a.z?.accessor?ae(se[a.z.accessor]):ae("");return l.jsx(ze.circle,{"data-hint":`${M(se)}: ${N(se)}`,cx:$(M(se)),cy:U(N(se)),r:u,strokeWidth:u/2,stroke:ie,fill:he?"transparent":ie,initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,ease:"easeInOut",delay:re/d.length}},se.__key)})}),l.jsx(hx,{margin:s,tooltipHandle:J,tooltipHide:ne,height:r,width:n,maxYLabelWidth:b})]}),oe&&l.jsx(gx,{tooltipTop:oe?.[1],tooltipLeft:oe?.[0],UserToolTip:o,entry:oe.data,data:d,config:a,xFormat:H,yFormat:R,zFormat:I,zGet:P,xGet:M,yGet:N})]})]})});function aHe(e){const{type:t,config:n,width:r,data:s,height:a,margin:o,tooltip:i,axes:c,colors:u,animate:d,includeLegend:m,endTime:p,previousClose:h,exchangeName:g,showLastPoint:y,children:b,enableComparison:x}=e;return t==="line"?l.jsx(rHe,{data:s,config:n,width:r,height:a,margin:o,tooltip:i,axes:c,colors:u,animate:d,includeLegend:m,endTime:p,previousClose:h,exchangeName:g,showLastPoint:y,enableComparison:x,children:b}):t==="bar"?l.jsx(YBe,{data:s,config:n,width:r,height:a,margin:o,tooltip:i,colors:u,includeLegend:m}):t==="scatter"?l.jsx(sHe,{data:s,config:n,width:r,height:a,margin:o,tooltip:i,colors:u,includeLegend:m}):t==="compositeLine"?l.jsx(eHe,{data:s,config:n,width:r,height:a,margin:o,tooltip:i,axes:c,colors:u,animate:d,includeLegend:m,endTime:p,previousClose:h,exchangeName:g,showLastPoint:y,children:b}):null}A.memo(function({type:t,config:n,data:r,tooltip:s,height:a=Lm,margin:o=fje,axes:i,className:c,colors:u,includeLegend:d,endTime:m,previousClose:p,exchangeName:h,showLastPoint:g,animate:y,children:b,enableComparison:x}){const _=f.useRef(null),{width:v}=tG(_);return l.jsx("div",{ref:_,className:c,children:l.jsx(aHe,{type:t,data:r,config:n,width:v,height:a,margin:o,tooltip:s,axes:i,colors:u,includeLegend:d,endTime:m,previousClose:p,exchangeName:h,showLastPoint:g,animate:y,enableComparison:x,children:b})})});const xz=(e,t)=>{const n="#f7f1f2",r="#1f2121";return e?oHe(e,Dn(t?r:n),t):Dn(n)},oHe=(e,t,n,r=3)=>{if(!e)return Dn(t);let s=Dn(e),a=0,o=0;for(;s.contrast(Dn(t))<r&&(s=n?iHe(s,a):lHe(s,a),a+=.01,o++,!(o>20)););return s};function iHe(e,t){const n=e.lightness();return e.lightness(n+(100-n)*t)}function lHe(e,t){const n=e.lightness();return e.lightness(n-n*t)}const cHe=({event:e})=>{const t=e.event.status==="live",n=e.event.extra.pitch_outcome,r=n?.count?.outs??0,s=n?.count?.balls??0,a=n?.count?.strikes??0,o=n?.runners,i=n?.count,c=n?.type!=="half_over"&&r!==3&&s!==4&&a!==3;return t?l.jsxs("div",{className:"mt-lg md:mt-md flex flex-col items-center gap-0",children:[l.jsx(uHe,{runners:o}),l.jsx(dHe,{outs:r}),l.jsx(fHe,{count:i,show:c})]}):null},uHe=({runners:e})=>{const t=e?.filter(n=>!n.out).map(n=>n.ending_base);return l.jsx("div",{style:{transformStyle:"preserve-3d",perspective:"1000px"},className:"inline-flex",children:l.jsx("div",{style:{transform:"rotateX(45deg)"},children:l.jsxs("div",{className:"gap-three grid rotate-45 grid-cols-2 grid-rows-2",children:[l.jsx(y2,{active:t?.includes(2)??!1}),l.jsx(y2,{active:t?.includes(1)??!1}),l.jsx(y2,{active:t?.includes(3)??!1})]})})})},y2=({active:e})=>l.jsx("div",{className:z("size-3 duration-150 md:size-4",e?"bg-super":"bg-inverse/25")}),dHe=({outs:e})=>l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(x2,{filled:e>=1}),l.jsx(x2,{filled:e>=2}),l.jsx(x2,{filled:e>=3})]}),x2=({filled:e})=>l.jsx("div",{className:z("relative size-1 rounded-full duration-150",e?"bg-inverse":"bg-inverse/25"),children:e&&l.jsx("div",{className:"bg-inverse repeat-1 absolute inset-0 animate-ping rounded-full"})}),fHe=({count:e,show:t})=>{const n=e?.balls??0,r=e?.strikes??0,s=n===0&&r===0;return l.jsx(B,{variant:"micro",color:s?"ultraLight":"light",className:z("mt-1 duration-150",t?"opacity-100":"opacity-0"),children:l.jsx("span",{className:"font-mono",children:t?`${n}-${r}`:l.jsx(l.Fragment,{children:""})})})};function mHe({children:e,className:t}){return l.jsx(B,{variant:"micro",className:z("py-xs !font-mono uppercase",t),color:"light",children:e})}const yx=({className:e,textCenter:t,finalText:n})=>{const{$t:r}=Q(),{isMobileStyle:s}=Be();return l.jsx("div",{className:z("flex items-center justify-center",e),children:l.jsx(B,{variant:s?"micro":"tiny",color:"light",className:"bg-subtler dark:bg-subtle pt-three rounded-full px-2.5 py-0.5",textCenter:t,children:n?n.toUpperCase():r({defaultMessage:"Final",id:"6/JzkWi0di"}).toUpperCase()})})},bz=({className:e,textCenter:t=!1})=>{const{$t:n}=Q(),{isMobileStyle:r}=Be();return l.jsx("div",{className:z("flex items-center justify-center",e),children:l.jsx(B,{variant:r?"micro":"tiny",color:"light",className:"bg-subtler dark:bg-subtle pt-three rounded-full px-2.5 py-0.5",textCenter:t,children:n({defaultMessage:"Upcoming",id:"6/aEFZbs2i"}).toUpperCase()})})};A.memo(function({attributions:t}){const{$t:n}=Q(),r=t.join("  ");return l.jsxs(Y,{className:"mt-md pt-md pb-lg flex flex-col gap-1 border-t",children:[l.jsx(B,{variant:"smallBold",color:"light",textCenter:!0,children:r}),l.jsx(B,{variant:"small",color:"light",textCenter:!0,children:n({defaultMessage:"{perplexity} is not affiliated with, endorsed by, or sponsored by any sports leagues or teams. All trademarks, team names, logos, and player images are the property of their respective owners. The content provided on this page is for informational purposes only and is intended to help users follow sports news and updates.",id:"M0PBu8vKH2"},{perplexity:"Perplexity"})})]})});const pHe=A.memo(function({children:t,innerRef:n,canScrollLeft:r,canScrollRight:s,fadeOut:a}){return l.jsx("div",{className:"gap-md flex w-full flex-col overflow-hidden",children:l.jsx(zf,{orientation:"horizontal",viewportRef:n,showScrollIndicator:!1,className:z("relative",{"mask-fade-l-12":r&&!s&&a,"mask-fade-r-12":s&&!r&&a,"mask-fade-h-12":r&&s&&a}),children:l.jsx("div",{className:"p-md pt-0",children:t})})})});A.memo(function({title:t,subtitle:n,children:r,scrollable:s,fadeOut:a,trailing:o,titleClassName:i}){const c=f.useRef(null),[u,d]=f.useState(!1),[m,p]=f.useState(!1),h=f.useCallback(()=>{c.current?.scrollTo({left:c.current.scrollLeft-c.current.clientWidth,behavior:"smooth"})},[c]),g=f.useCallback(()=>{c.current?.scrollTo({left:c.current.scrollLeft+c.current.clientWidth,behavior:"smooth"})},[c]),y=f.useCallback(()=>{c.current&&(d(c.current.scrollLeft>0),p(c.current.scrollLeft+c.current.clientWidth+10<c.current.scrollWidth&&c.current.scrollWidth>c.current.clientWidth))},[c]);return f.useEffect(()=>{const b=c.current;return b?.addEventListener("scroll",y),()=>{b?.removeEventListener("scroll",y)}},[y,c]),f.useEffect(()=>{const b=new ResizeObserver(y);return b.observe(window.document.body),()=>{b.disconnect()}},[y,c]),f.useEffect(()=>{y()},[y]),l.jsxs(Y,{className:"gap-md flex flex-col",children:[l.jsxs(hHe,{title:t,subtitle:n,className:i,children:[o,s&&l.jsxs("div",{className:"-mr-sm flex items-center",children:[l.jsx(pt,{icon:D("chevron-left"),size:"small",onClick:h,disabled:!u,variant:u?void 0:"noHover"}),l.jsx(pt,{icon:D("chevron-right"),size:"small",onClick:g,disabled:!m,variant:m?void 0:"noHover"})]})]}),s?l.jsx(pHe,{innerRef:c,canScrollLeft:u,canScrollRight:m,fadeOut:a,children:r}):l.jsx("div",{ref:c,className:"gap-md px-md pb-md flex flex-col",children:r})]})});const hHe=A.memo(function({children:t,title:n,subtitle:r,className:s}){return l.jsxs(Y,{className:z("gap-md px-md py-sm flex items-center justify-between border-b",s),children:[l.jsxs(Y,{className:"flex items-center justify-between",children:[n&&l.jsx(B,{variant:"baseSemi",children:n}),r&&l.jsx(B,{variant:"smallCaps",color:"light",children:r})]}),t]})}),gHe={tiny:"size-[16px]",small:"size-[24px]",medium:"size-[32px]",large:"xl:size-[64px] size-[50px]"},yHe={tiny:"p-[0.5px]",small:"p-[0.5px]",medium:"p-[0.5px]",large:"p-[0.5px]"},xHe={tiny:"border-[1px]",small:"border-[1px]",medium:"border-[2px]",large:"border-[4px]"},xx=f.memo(function({includeStripe:t=!0,includeShadow:n=!1,className:r,includeBackground:s=!1,size:a="large",logo:o,color:i,...c}){const u=f.useMemo(()=>{let d=gHe[a];return s&&(d+=` ${yHe[a]}`),d},[s,a]);return l.jsx("div",{className:z(u,{"shadow-subtle":n&&s,"border-subtlest rounded-full border bg-white dark:border-transparent":s},r),...c,children:l.jsx("div",{className:z("rounded-inherit relative flex size-full items-center justify-center",{[xHe[a]]:t&&s}),style:{borderColor:s?i:void 0},children:l.jsx("img",{src:o,alt:"",width:s?"70%":"100%",height:"auto"})})})});function bHe(e,t){if(t!=="upcoming"||e<new Date)return!1;const n=new Date;return Math.abs(+e-+n)<1e3*60*60*24}function _He(e,t){return f.useMemo(()=>t?xz(Dn(e),t==="dark").toString():e,[e,t])}const _z=({isRed:e,className:t})=>l.jsx("svg",{width:"16",height:"19",viewBox:"0 0 16 19",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:z("shrink-0",t),children:l.jsx("rect",{x:"4.29248",y:"0.726685",width:"12",height:"15",rx:"2",transform:"rotate(14.6454 4.29248 0.726685)",fill:e?"#EB4E45":"#f6c825"})});f.memo(function({plays:t,onViewAll:n,playsToRender:r=1/0,reverse:s=!0,brands:a,inModal:o=!1,league:i}){const{$t:c}=Q(),u=s?[...Object.keys(t)].reverse():Object.keys(t),d=f.useMemo(()=>{let m=r;return l.jsxs(Y,{children:[u.map(p=>{let h=0;const g=t[p]?.length??0;return m<=0?null:(m<g?(h=m,m=0):(h=g,m-=g),l.jsx(vHe,{plays:t[p]??_e,playsToRender:h,period:p,reverse:s,brands:a,league:i},p))}),!o&&n&&l.jsx("div",{className:"-mx-sm py-sm flex items-center justify-center",children:l.jsx(pt,{variant:"super",chevron:!0,chevronIcon:D("chevron-right"),text:c({defaultMessage:"View All",id:"wbcwKddwLa"}),fullWidth:!0,size:"small",onClick:n})})]})},[t,r,s,o,n,c,u,a,i]);return o?d:l.jsx(ba,{className:"relative isolate",mode:"popLayout",transition:{duration:.2,ease:rr},children:l.jsx(bs,{children:d})})});function vHe({plays:e,playsToRender:t,period:n,reverse:r,brands:s,league:a}){const o=f.useMemo(()=>r?[...e].reverse():e,[e,r]),i=ro();return l.jsxs(Y,{children:[t>0&&l.jsx(Y,{variant:"subtle",className:"-mx-md px-md py-sm sticky top-0 z-10 flex items-center justify-between",children:l.jsx(B,{variant:"smallCaps",color:"light",children:n})}),l.jsx(e0,{children:l.jsx(ze.div,{layout:!0,layoutRoot:!0,children:o.slice(0,t).map(c=>l.jsx(CHe,{play:c,brands:s,parentHasMounted:i,league:a},c.id))})})]})}const CHe=f.memo(function({play:t,brands:n,parentHasMounted:r,league:s}){const{$t:a}=Q(),o=f.useRef(!r),i=eBe(t.contestantId,n,s),{colorScheme:c}=Cs(),u=_He(i.color,c)?.toString()??i.color;return l.jsxs(ze.div,{className:"-mx-md border-subtlest p-md relative border-b",initial:o.current?void 0:{opacity:0},animate:o.current?void 0:{opacity:1},transition:{layout:{duration:.2,ease:rr},opacity:{duration:.2,ease:lf}},layout:"position",children:[l.jsx("div",{className:"left-xs inset-y-xs absolute w-1 rounded-full opacity-50",style:{backgroundColor:u}}),!o.current&&l.jsx(ze.div,{className:"bg-super/15 absolute inset-0",initial:{opacity:1},animate:{opacity:0},transition:{duration:1,ease:lf,delay:.2}}),l.jsxs("div",{className:"gap-md relative flex items-center",children:[l.jsx(xx,{logo:i.logo,color:i.color,size:"small",includeStripe:!1}),l.jsxs("div",{className:"gap-sm flex flex-1 flex-row items-center",children:[l.jsxs("div",{className:"gap-md flex items-baseline",children:[l.jsx(B,{variant:"tiny",color:"light",className:"whitespace-nowrap",children:t.periodId[1]==="PENALTIES"?`${a({defaultMessage:"PK",id:"mG6A02k2Ar"})} ${t.timeMin}`:`${t.timeMin}'`}),l.jsx(B,{variant:"small",children:t.commentary_text})]}),wHe(t)&&l.jsx(_z,{isRed:SHe(t)==="red"})]})]})]})}),wHe=e=>e.typeId[0]===17,SHe=e=>{const t=e.commentary_text.toLowerCase();return t.includes("second yellow card")||t.includes("red card")?"red":t.includes("yellow card")?"yellow":null},EHe=({event:e})=>{const n=[...e.matchStats?.contestantStats.map(r=>{const s=r.goal_events.map(o=>({type:"goal",event:o})),a=r.red_card_events.map(o=>({type:"red_card",event:o}));return[...s,...a]})??[]].map(r=>r.sort((s,a)=>s.event[0]-a.event[0]));return!n||n.length===0?null:l.jsx("div",{className:"gap-md p-md grid grid-cols-2",children:n.map((r,s)=>l.jsx(kHe,{events:r,position:s===0?"left":"right"},s))})},kHe=({events:e,position:t})=>l.jsx("div",{className:z("gap-xs flex flex-col",{"items-start":t==="left","items-end":t==="right"}),children:e.map((n,r)=>l.jsx(MHe,{event:n,position:t},r))}),MHe=({event:e,position:t})=>l.jsxs("div",{className:"gap-xs flex items-center",children:[l.jsxs(B,{variant:"tiny",className:z("flex items-center gap-1",{"flex-row-reverse":t==="right"}),children:[l.jsx(THe,{event:e})," ",e.event[1]]}),l.jsxs(B,{variant:"tiny",color:"light",children:[e.event[0],"'"]})]}),THe=({event:e})=>e.type!=="goal"?l.jsx(_z,{isRed:!0,className:"size-md inline-block"}):l.jsx("div",{className:"size-md inline-block",children:""}),AHe=A.memo(function(){return l.jsx("div",{})}),Q8=new Set,NHe=e=>e.status==="live"||e.status==="upcoming";function RHe({widget:e}){const{isMobileStyle:t}=Be(),{result:{backend_uuid:n,mode:r}}=Pt(),s=im();if(f.useEffect(()=>{!n||!e||!e?.events?.length||Q8.has(n)||(s("web.frontend.sports_widget_render_time",{widgetType:"sports",widgetSubType:e.object,league:e.league,queryMode:r}),Q8.add(n))},[n,e?.events?.length,r,e,s]),!e?.events?.length)return null;const a=e.canonical_pages?.[0]?.url_web,o=e.events.at(0),i=!t&&(o&&NHe(o)||e.events.length<5),c=e.league??"nba";return l.jsx(ar,{fallback:AHe,children:l.jsx(ss,{widgetType:"sports",widgetName:e.object,children:({widgetSelected:u})=>l.jsx(vz,{canonicalPageLink:a,children:l.jsx(LHe,{events:e.events,showHero:i,widgetSelected:u,league:c})})})})}const vz=({children:e,canonicalPageLink:t})=>{const{$t:n}=Q();return l.jsxs(Y,{variant:"raised",className:"shadow-subtle overflow-hidden rounded-xl border",children:[e,t?l.jsx(Dt,{href:t,children:l.jsxs(B,{variant:"smallBold",className:"p-sm border-subtlest flex items-center justify-center gap-0.5 border-t text-center duration-150 hover:opacity-75",color:"super",children:[n({defaultMessage:"View More",id:"QQSdHPJWXu"}),l.jsx(ut,{name:D("chevron-right"),size:18})]})}):null]})},Cz=({initialData:e,refetch:t=!1,reason:n})=>gt({initialData:e,queryKey:Se.makeEphemeralQueryKey("sports/events/widget",e.id),queryFn:async()=>{if(!e.refetch_url)return e;const r=await n$({urlPath:e.refetch_url,timeoutMs:0,reason:n});if(!r.ok)throw Z.error("Failed to fetch sport event",{url:e.refetch_url,status:r.status,statusText:r.statusText}),new Error(`Failed to fetch sport event ${r.status} ${r.statusText}`);return await r.json()},refetchInterval:r=>r.state.data?.refetch_url?r.state.data?.refetch_interval_secs*1e3:!1,enabled:!!e.refetch_url&&t}),DHe=({event:e,onClick:t,eventCount:n,league:r})=>{const{$t:s}=Q(),{data:a}=Cz({initialData:e,refetch:!0,reason:"sports-event-row"}),o=wz(),i=r==="nba"&&oz(a.title[0]??""),c=Mz(a.team_1,a.team_2),u=i?c:null,d=f.useMemo(()=>[{title:a.team_1.title,score:a.team_1.text,subscore:a.team_1.sub_text,image:a.team_1.img,emphasized:a.team_1.won,period:a.period_text},{title:a.team_2.title,score:a.team_2.text,subscore:a.team_2.sub_text,image:a.team_2.img,emphasized:a.team_2.won,period:a.period_text}],[a]);return l.jsx(kz,{href:a.url?.url_web,onClick:()=>t(a.url?.url_web),children:l.jsx(BHe,{title:a.status==="live"?"LIVE":o(a.datetime,a.datetime_tba,a.datetime_end),isLive:a.status==="live",items:d,period:Sz(a.period_text,a.period_time,r,{halftime:s({defaultMessage:"Halftime",id:"iC0AL294Dr"})})??null,eventCount:n,subtitle:u??void 0},a.id)})},IHe=({events:e,onClick:t,league:n})=>l.jsx("div",{className:z("bg-subtlest grid grid-cols-1 rounded-b-lg md:grid-cols-2",{"lg:grid-cols-3":e.length>2}),children:e.map(r=>l.jsx(DHe,{event:r,onClick:t,eventCount:e.length,league:n},r.id))}),jHe=e=>{const{locale:t}=Q();return e?new Date(e).toLocaleTimeString(t,{hour:"numeric",minute:"numeric",timeZoneName:"short"}):""},PHe=e=>e.join("  "),wz=({includeTime:e=!0}={})=>{const{$t:t}=Q(),{locale:n}=Q();return f.useCallback((r,s,a)=>{if(a){if(!r&&s)return t({defaultMessage:"TBA",id:"ZfAWFLTzx/"});if(!r)return"";const m=new Date(r),p=new Date(a),h=m.getFullYear();if(!(h===new Date().getFullYear())){const C=m.toLocaleDateString(n,{month:"short"}),w=p.toLocaleDateString(n,{month:"short"}),S=m.getDate(),E=p.getDate();return C===w?`${C} ${S}-${E}, ${h}`:`${C} ${S}-${w} ${E}, ${h}`}const y=m.toLocaleDateString(n,{month:"short"}),b=p.toLocaleDateString(n,{month:"short"}),x=m.getDate(),_=p.getDate();let v;if(y===b?v=`${y} ${x}-${_}`:v=`${y} ${x}-${b} ${_}`,e){const C=s?"TBA":m.toLocaleTimeString(n,{hour:"numeric",minute:"numeric",timeZoneName:"short"});return`${v}, ${C}`}return v}if(!r&&s)return t({defaultMessage:"TBA",id:"ZfAWFLTzx/"});if(!r)return"";const o=new Date(r),i=r&&s,c=o.toLocaleTimeString(n,{hour:"numeric",minute:"numeric",timeZoneName:"short"});if(Wye(o))return e?`${t({defaultMessage:"Today",id:"zWgbGgjUUg"})}, ${c}`:t({defaultMessage:"Today",id:"zWgbGgjUUg"});if(Yye(o))return e?`${t({defaultMessage:"Yesterday",id:"6dIxDP1C8c"})}, ${c}`:t({defaultMessage:"Yesterday",id:"6dIxDP1C8c"});if(fF(o))return e?`${t({defaultMessage:"Tomorrow",id:"MtrTNyxuSU"})}, ${c}`:t({defaultMessage:"Tomorrow",id:"MtrTNyxuSU"});if(o.getFullYear()!==new Date().getFullYear())return new Date(o).toLocaleDateString(n,{month:"short",day:"numeric",year:"numeric"});const u=o.toLocaleDateString(n,{month:"short",day:"numeric"});if(!e)return u;const d=i?"TBA":o.toLocaleTimeString(n,{hour:"numeric",minute:"numeric",timeZoneName:"short"});return`${u}, ${d}`},[n,t,e])},Sz=(e,t,n,r)=>{if(n==="mlb")return OHe(e);if(!e||typeof t?.seconds!="number"&&typeof t?.minutes!="number")return e;if(e==="Halftime")return r.halftime;const s=t?.seconds?.toString().padStart(2,"0")??"00",a=t?.minutes??0;return`${e} ${a}:${s}`},OHe=e=>e?.replace("Top","").replace("Bot",""),LHe=({events:e,showHero:t,widgetSelected:n,league:r})=>{const s=f.useMemo(()=>t?e.slice(1):e,[e,t]),{data:a}=Cz({initialData:e[0],refetch:t,reason:"sports-widget-dense"});return l.jsxs(Y,{children:[t&&l.jsxs(kz,{href:a?.url?.url_web,onClick:()=>{n(a?.url?.url_web)},children:[l.jsx(FHe,{event:a,includeBorder:s.length>0,league:r,statusExtra:a&&r==="mlb"&&a.status==="live"?l.jsx(cHe,{event:{event:a}}):null}),r==="championsleague"&&a&&l.jsx(EHe,{event:{event:a,brands:[],candlestickData:null,matchEvents:null,matchStats:a.extra?.match_stats??null,eventExtra:null}})]}),l.jsx(IHe,{events:s,onClick:n,league:r})]})},Ez=()=>l.jsx("span",{className:"text-quietest",children:""}),kz=({children:e,href:t,onClick:n})=>t?l.jsx(Dt,{href:t,className:"group/link group",onClick:n,children:e}):l.jsx("div",{className:"group",onClick:n,children:e}),Mz=(e,t)=>{const{$t:n}=Q(),r=e.subtitle?.split("-"),s=t.subtitle?.split("-"),a=ko(r)?+r[0]:null,o=ko(s)?+s[0]:null,i=4;if(a===null||o===null)return null;const c=a>o?e.abbreviation:t.abbreviation,u=a>o?a:o,d=a>o?o:a;return a>=i||o>=i?n({defaultMessage:"{leadingTeam} Wins {leadingScore}-{trailingScore}",id:"T1UC+k87MZ"},{leadingTeam:c,leadingScore:u,trailingScore:d}):a===o?n({defaultMessage:"Series Tied {team1Record}-{team2Record}",id:"Liahhq+hIg"},{team1Record:a,team2Record:o}):n({defaultMessage:"{leadingTeam} Leads {leadingScore}-{trailingScore}",id:"oO28OWtTlZ"},{leadingTeam:c,leadingScore:u,trailingScore:d})},FHe=({event:e,includeBorder:t=!1,className:n,league:r,scoreExtra:s,statusExtra:a,displayBranding:o=!0})=>{const{$t:i}=Q(),c=e.team_1.title,u=e.team_2.title,d=e.team_1.text,m=e.team_1.sub_text,p=e.team_2.text,h=e.team_2.sub_text,g=r==="nba"&&oz(e.title[0]??""),y=Mz(e.team_1,e.team_2),b=g?y:null,x=wz({includeTime:!1}),_=jHe(e.datetime),v=e.datetime_tba?i({defaultMessage:"TBA",id:"ZfAWFLTzx/"}):_,C=PHe(e.title),{colorScheme:w}=Cs(),S=Sz(e.period_text,e.period_time,r,{halftime:i({defaultMessage:"Halftime",id:"iC0AL294Dr"})}),E=e.team_1.won||e.team_2.won,T=f.useMemo(()=>{let k;return E?o?(e.team_1.won?k=e.team_1.color:k=e.team_2.color,xz(k?Dn(k):null,w==="dark")):"#1FB8CD":null},[e.team_1.won,e.team_1.color,e.team_2.color,w,E,o]);return l.jsxs(Y,{className:z(n,"rounded-inherit relative",{"border-b":t}),children:[E&&l.jsx("div",{className:"rounded-inherit pointer-events-none absolute inset-0 overflow-hidden",style:{color:T?.toString(),maskImage:e.team_1.won?"linear-gradient(to left, transparent 60%, black)":"linear-gradient(to right, transparent 60%, black)"},children:l.jsx($Ue,{className:"-inset-xl rounded-inherit !absolute ![--dog-bg-highlight:currentColor]",dotClassName:"!text-[currentColor]",highlightClassName:"!bg-black/5 dark:!bg-white/5"})}),l.jsx("div",{className:"px-md gap-sm relative flex items-start justify-between pt-[12px]",children:l.jsxs(B,{variant:"tiny",color:"light",children:[C,b&&" "+b]})}),l.jsxs("div",{className:"p-md md:px-lg md:py-md gap-sm relative grid grid-cols-[1fr_auto_1fr] items-center justify-start md:justify-between md:gap-[12px]",children:[l.jsxs("div",{className:"gap-md flex flex-col-reverse items-center justify-start md:flex-row md:justify-start md:gap-[12px]",children:[l.jsx(J8,{record:e.team_1.subtitle,name:c,logo:o?e.team_1.img:null}),l.jsx("div",{className:"md:mx-auto",children:l.jsx(X8,{position:"leading",score:d,subscore:m,isWinner:e.team_1.won,hasWinner:E,scoreExtra:s,team:e.team_1,teamIdx:0,league:r})})]}),l.jsxs("div",{className:"gap-sm flex flex-col items-center",children:[l.jsx(UHe,{status:e.status,date:x(e.datetime,e.datetime_tba,e.datetime_end),time:v,isUpcoming:e.datetime?bHe(new Date(e.datetime),e.status):void 0,period:S??null}),a]}),l.jsxs("div",{className:"gap-md flex flex-col-reverse items-center justify-start md:flex-row-reverse md:gap-[12px]",children:[l.jsx(J8,{record:e.team_2.subtitle,name:u,logo:o?e.team_2.img:null}),l.jsx("div",{className:"md:mx-auto",children:l.jsx(X8,{score:p,subscore:h,position:"trailing",isWinner:e.team_2.won,hasWinner:E,scoreExtra:s,team:e.team_2,teamIdx:1,league:r})})]})]}),e.live_text&&l.jsx("div",{className:"bg-subtlest px-md relative py-[12px]",children:l.jsxs(B,{variant:"tiny",color:"light",lineClamp:1,className:"gap-sm flex items-start md:items-center",children:[l.jsx(ut,{name:D("broadcast"),size:16,className:"opacity-80 md:-translate-y-px"}),e.live_text]})}),E&&l.jsx("div",{className:"rounded-inherit pointer-events-none absolute inset-0 opacity-20 mix-blend-multiply dark:opacity-60 dark:mix-blend-soft-light",style:{backgroundColor:T?.toString(),maskImage:e.team_1.won?"linear-gradient(to left, transparent 60%, black)":"linear-gradient(to right, transparent 60%, black)"}}),!t&&E&&l.jsx("div",{className:"pointer-events-none absolute -inset-px rounded-[12px] border opacity-40",style:{borderColor:T?.toString(),maskImage:e.team_1.won?"linear-gradient(to left, transparent 60%, black)":"linear-gradient(to right, transparent 60%, black)"}}),!t&&E&&l.jsx("div",{className:"pointer-events-none absolute -inset-px rounded-[13px] border opacity-20 dark:opacity-40",style:{borderColor:T?.toString(),maskImage:e.team_1.won?"linear-gradient(to left, transparent 60%, black)":"linear-gradient(to right, transparent 60%, black)"}})]})},X8=({score:e,subscore:t,position:n,emptyPlaceholder:r=l.jsx(Ez,{}),isWinner:s,hasWinner:a,scoreExtra:o,team:i,teamIdx:c,league:u})=>{const{isMobileStyle:d}=Be(),m=u==="ipl"||u==="cricket"||u==="icc"||u==="atp"||u==="wta";return l.jsxs("div",{className:z("md:gap-xs flex flex-col items-center justify-center",{"items-start":n==="leading","items-end":n==="trailing","opacity-50":a&&!s}),children:[l.jsxs(B,{variant:d?m?"section-title":"display":"section-title",className:"gap-xs md:gap-sm flex items-center sm:!text-2xl lg:!text-3xl",children:[s&&n==="trailing"&&l.jsx(Z8,{className:"size-3 rotate-180 md:size-4"}),l.jsxs("span",{className:"font-mono",children:[o&&l.jsx("span",{className:"mr-xs",children:o(i,c)}),e??r]}),s&&n==="leading"&&l.jsx(Z8,{className:"size-2.5 md:size-4"})]}),t&&l.jsx(B,{variant:"tiny",color:"light",children:l.jsx("span",{className:"font-mono",children:t})})]})},Z8=({className:e})=>l.jsx("svg",{width:"6",viewBox:"0 0 18 35",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,children:l.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18 0.322327L0.822266 17.5L18 34.6777V0.322327Z",className:"fill-foreground"})}),J8=({name:e,logo:t,record:n})=>e?l.jsxs("div",{className:"gap-sm flex flex-col items-center justify-between md:gap-0",children:[t&&l.jsx(xx,{logo:t,color:"#000000"}),l.jsx(B,{variant:"baseSemi",children:e}),n&&l.jsx(B,{variant:"tiny",color:"light",children:l.jsx("span",{className:"font-mono",children:n})})]}):null,UHe=({status:e,date:t,time:n,isUpcoming:r,variant:s="stacked",period:a})=>{const o=e==="live",i=e==="final",{isMobileStyle:c}=Be();return l.jsx("div",{className:z("gap-sm flex",{"flex-row items-center":s==="row","flex-col items-center justify-center":s==="stacked"}),children:o?l.jsxs("div",{className:"gap-sm flex flex-col items-center",children:[l.jsx(Hm,{size:c?"small":"default",includeDot:!0}),a&&l.jsx(B,{variant:"tiny",color:"light",children:a})]}):l.jsxs("div",{className:z("gap-xs flex",{"flex-col":s==="stacked","flex-row items-center":s==="row"}),children:[r&&l.jsx(bz,{textCenter:!0,className:"mb-1 hidden md:block"}),i&&l.jsx(yx,{textCenter:!0,className:"-mt-0.5 md:mb-1 md:mt-0 md:block"}),l.jsx(B,{variant:"tiny",color:"light",className:"w-full whitespace-nowrap",textCenter:!0,children:t}),n&&!i&&l.jsx(B,{variant:"tiny",color:"light",className:"w-full whitespace-nowrap",textCenter:!0,children:n})]})})},BHe=({items:e,title:t,subtitle:n,isLive:r,period:s,eventCount:a})=>{const o=e.some(d=>d.emphasized),{isMobileStyle:i}=Be(),{isLargeScreen:c,isMediumScreen:u}=Ll();return l.jsx(Y,{variant:"raised",className:z("px-md h-full py-[12px]",{"border-b border-r-0 group-last:border-b-0 group-even:border-r-0":i,"border-b group-odd:border-r":u&&!c,"group-[&:nth-child(2n):nth-last-child(-n+3)~a]:border-b-0":u&&!c&&a>2,"border-b border-r group-[&:nth-child(3n)]:border-r-0":c,"group-[&:nth-child(3n):nth-last-child(-n+4)~a]:border-b-0":c&&a>3,"!border-b-0":c&&a<=3||u&&!c&&a<=2}),children:l.jsxs("div",{className:"gap-sm flex size-full flex-col items-start justify-between duration-150 group-hover/link:opacity-75",children:[r?l.jsxs("div",{className:"gap-sm flex items-center",children:[l.jsx(Hm,{size:"small",className:"-ml-1"}),s&&l.jsx(B,{variant:"tiny",color:"super",children:s})]}):t?l.jsx(B,{variant:"tinyRegular",color:"light",children:t}):null,l.jsx("div",{className:"w-full",children:e.map((d,m)=>l.jsx(HHe,{item:d,anyEmphasized:o},d.title+m))}),n&&l.jsx(B,{variant:"tinyRegular",color:"light",children:n})]})})},HHe=({item:e,anyEmphasized:t})=>{const n=f.useMemo(()=>e.score?e.subscore?`${e.score} ${e.subscore}`:e.score:l.jsx(Ez,{}),[e.score,e.subscore]);return l.jsxs(Y,{className:"flex w-full items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[e.image&&l.jsx("img",{src:e.image,alt:e.title,className:"size-[24px]"}),l.jsx(B,{variant:e.emphasized?"smallBold":"small",color:t&&!e.emphasized?"light":"default",children:e.title})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[e.emphasized&&l.jsx(ut,{name:D("trophy"),size:14,className:"text-super -translate-y-half"}),l.jsx(B,{variant:e.emphasized?"smallBold":"small",color:t&&!e.emphasized?"light":"default",children:n})]})]})},VHe=A.memo(function(){return l.jsx("div",{children:"Error loading individual event widget."})}),e9=new Set,GHe=({children:e,canonicalPageLink:t})=>{const{$t:n}=Q();return l.jsxs(Y,{variant:"raised",className:"shadow-subtle overflow-hidden rounded-xl border",children:[e,t?l.jsx(Dt,{href:t,children:l.jsxs(B,{variant:"smallBold",className:"p-sm border-subtlest flex items-center justify-center gap-0.5 border-t text-center duration-150 hover:opacity-75",color:"super",children:[n({defaultMessage:"View More",id:"QQSdHPJWXu"}),l.jsx(ut,{name:D("chevron-right"),size:18})]})}):null]})},zHe=(e,t)=>{if(!e)return"";try{return new Date(e).toLocaleDateString(t,{month:"short",day:"numeric"})}catch{return""}},qHe=(e,t)=>{if(!e)return"";try{return new Date(e).toLocaleTimeString(t,{hour:"numeric",minute:"2-digit",hour12:!0}).replace(/^0+/,"")}catch{return""}},Tz=({competitor:e})=>l.jsxs(Y,{className:"gap-sm border-subtlest px-md py-sm flex items-center border-b last:border-b-0",children:[l.jsx(B,{className:"w-4",textCenter:!0,children:e.rank}),l.jsxs("div",{className:"gap-sm flex grow items-center",children:[e.primary_img_url?l.jsx(xx,{logo:e.primary_img_url,color:"transparent",size:"small",className:"shrink-0"}):l.jsx(Y,{className:"flex h-5 w-8 shrink-0 items-center justify-center rounded-sm bg-[#44403c] text-xs",children:e.abbreviation}),l.jsxs("div",{className:"flex grow flex-col",children:[l.jsx(B,{variant:"smallBold",children:e.title}),l.jsxs(B,{variant:"tiny",color:"light",children:[e.metadata[0]," "]})]})]}),l.jsxs(Y,{className:"flex flex-col items-end text-right",children:[l.jsx(B,{variant:"smallBold",children:e.metadata[1]}),l.jsx(B,{variant:"tiny",color:"light",children:e.metadata[2]})]})]},e.id),$He=({event:e,league:t})=>{const{locale:n}=Q(),r=e.subtitle,{$t:s}=Q(),a=qHe(e.datetime,n),o=e.datetime?$W(new Date(e.datetime))?s({defaultMessage:"Today",id:"zWgbGgjUUg"}):fF(new Date(e.datetime))?s({defaultMessage:"Tomorrow",id:"MtrTNyxuSU"}):new Date(e.datetime).toLocaleDateString(n,{weekday:"short",month:"short",day:"numeric"}):"";return l.jsxs(Y,{className:"flex flex-col",children:[l.jsxs(Y,{className:"p-md border-subtler flex items-end justify-between border-b",children:[l.jsxs(Y,{className:"flex flex-col",children:[l.jsx(B,{variant:"baseSemi",children:e.title.join(" ")}),l.jsxs(B,{variant:"small",color:"light",children:[t.toUpperCase(),r&&`${r}`]})]}),l.jsxs("div",{className:"flex flex-col items-end",children:[l.jsx(B,{variant:"small",children:o}),l.jsx(B,{variant:"small",color:"light",children:a})]})]}),e.image_url&&l.jsx(Y,{className:"aspect-video w-full overflow-hidden rounded-lg bg-[#292524]",children:l.jsx(to,{src:e.image_url,alt:`${e.title.join(" ")} circuit map`,className:"size-full object-contain"})}),l.jsx(Y,{className:"gap-xs p-md flex flex-col",children:e.metadata?.map((i,c)=>l.jsxs(Y,{className:"flex justify-between",children:[l.jsx(B,{className:"text-sm",color:"light",children:i[0]}),l.jsx(B,{className:"text-sm",children:i[1]})]},c))})]})},WHe=({event:e,league:t})=>{const{locale:n}=Q(),r=zHe(e.datetime,n),s=e.competitors.slice(0,3),a=e.subtitle;return l.jsxs(Y,{className:"flex flex-col",children:[l.jsxs(Y,{className:"border-subtler px-md py-sm gap-md flex items-center justify-between border-b",children:[l.jsxs("div",{children:[l.jsx(B,{variant:"baseSemi",className:"flex justify-between",children:l.jsx("span",{children:e.title.join(" ")})}),l.jsxs(B,{variant:"small",color:"light",children:[t.toUpperCase(),a&&`${a}`]})]}),l.jsxs("div",{className:"gap-sm flex items-center",children:[l.jsx(B,{variant:"small",color:"light",children:r}),l.jsx(yx,{})]})]}),l.jsx(Y,{className:"flex flex-col",children:s.map(o=>l.jsx(Tz,{competitor:o},o.id))})]})},KHe=({event:e,league:t})=>{const n=e.competitors.slice(0,3),r=e.subtitle;return l.jsxs(Y,{className:"flex flex-col",children:[l.jsxs(Y,{className:"border-subtler px-md py-sm gap-md flex items-center justify-between border-b",children:[l.jsxs("div",{children:[l.jsx(B,{variant:"baseSemi",className:"flex justify-between",children:l.jsx("span",{children:e.title.join(" ")})}),l.jsx("div",{children:l.jsxs(B,{variant:"small",color:"light",children:[t.toUpperCase(),r&&`${r}`]})})]}),l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(Hm,{includeDot:!0}),e.period_text&&l.jsx(B,{color:"light",variant:"small",children:e.period_text})]})]}),l.jsx(Y,{className:"flex flex-col",children:n.map(s=>l.jsx(Tz,{competitor:s},s.id))})]})},YHe=({event:e,league:t})=>{switch(e.status){case"upcoming":return l.jsx($He,{event:e,league:t});case"live":return l.jsx(KHe,{event:e,league:t});case"final":return l.jsx(WHe,{event:e,league:t});default:return null}};function QHe({widgetData:e}){const{result:{backend_uuid:t,mode:n}}=Pt(),r=im(),s=f.useMemo(()=>e?.event,[e]),a=f.useMemo(()=>e?.league,[e]);if(f.useEffect(()=>{!t||!e||!s||e9.has(t)||(r("web.frontend.sports_widget_render_time",{widgetType:"sports",widgetSubType:e.object,league:e.league,queryMode:n}),e9.add(t))},[t,s,n,e,r]),!e||!s)return null;const o=e.canonical_page?.url_web,i=`indv-event-${s.id??"unknown"}`;return l.jsx(ar,{fallback:VHe,children:l.jsx(ss,{widgetType:"sports",widgetName:i,children:({})=>l.jsx(GHe,{canonicalPageLink:o,children:l.jsx(YHe,{event:s,league:a})})})})}const XHe=A.memo(function(){return l.jsx("div",{children:"Error loading individual schedule widget."})}),t9=new Set,ZHe=({children:e,canonicalPageLink:t})=>{const{$t:n}=Q();return l.jsxs(Y,{variant:"raised",className:"shadow-subtle overflow-hidden rounded-xl border",children:[e,t?l.jsx(Dt,{href:t,children:l.jsxs(B,{variant:"smallBold",className:"p-sm border-subtlest flex items-center justify-center gap-0.5 border-t text-center duration-150 hover:opacity-75",color:"super",children:[n({defaultMessage:"View More",id:"QQSdHPJWXu"}),l.jsx(ut,{name:D("chevron-right"),size:18})]})}):null]})},JHe=(e,t,n)=>{if(!e)return t.replace(/^(0)(\d:[0-5]\d\s+[AP]M)$/,"$2");try{return new Date(e).toLocaleTimeString(n,{hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"}).replace(/^0+/,"")}catch{return t.replace(/^(0)(\d:[0-5]\d\s+[AP]M)$/,"$2")}},b2=({event:e,isFinal:t,isLive:n})=>{const{locale:r}=Q(),s=e.metadata?.[0],a=e.metadata?.[1]??"",o=JHe(e.datetime,a,r),{isMobileStyle:i}=Be(),c=!!e.url?.url_web,u=l.jsxs(l.Fragment,{children:[l.jsxs(Y,{className:"p-md col-span-3 grid grid-cols-subgrid items-center md:col-span-4",children:[l.jsx(Y,{className:"flex flex-col items-start",children:l.jsx(tVe,{date:e.datetime??""})}),l.jsxs(Y,{className:"gap-xs flex flex-col md:gap-0",children:[l.jsx(B,{variant:"baseSemi",className:"text-base leading-snug",children:e.title.join(" ")}),s&&l.jsxs(B,{variant:i?"tiny":"small",className:"mt-0 pt-0",color:"light",children:[!t&&!n&&l.jsxs(l.Fragment,{children:[o,"  "]}),s]})]}),l.jsx("div",{className:"hidden md:block",children:e.live_text&&l.jsx(B,{variant:"small",className:"text-right",children:e.live_text})}),l.jsx("div",{children:t?l.jsx(yx,{}):n?l.jsx(Hm,{includeDot:!0}):null})]}),l.jsx("div",{className:"p-md -mt-sm col-span-2 col-start-2 pl-0 pt-0 md:hidden",children:e.live_text&&l.jsx(B,{variant:"tiny",className:"border-subtlest p-xs px-sm rounded border",color:"light",children:e.live_text})})]}),d="col-span-3 grid grid-cols-subgrid border-b border-subtlest last:border-b-0 md:col-span-4";return c?l.jsx(Dt,{href:e.url?.url_web??"",className:z(d,"hover:bg-subtler duration-150"),children:u}):l.jsx(Y,{className:d,children:u})};function eVe({widgetData:e}){const{result:{backend_uuid:t,mode:n}}=Pt(),r=im(),s=f.useMemo(()=>e?.events??[],[e]);if(f.useEffect(()=>{!t||!e||!s?.length||t9.has(t)||(r("web.frontend.sports_widget_render_time",{widgetType:"sports",widgetSubType:e.object,league:e.league,queryMode:n}),t9.add(t))},[t,e,s,n,r]),!e||!s||s.length===0)return null;const a=e.canonical_page?.url_web,o=`indv-schedule-${e.league??"unknown"}`;return l.jsx(ar,{fallback:XHe,children:l.jsx(ss,{widgetType:"sports",widgetName:o,children:({})=>l.jsx(ZHe,{canonicalPageLink:a,children:l.jsx(Y,{className:"gap-x-md grid grid-cols-[min-content,1fr,min-content] md:grid-cols-[min-content,1fr,1fr,min-content]",children:s.map(i=>{switch(i.status){case"upcoming":return l.jsx(b2,{event:i},i.id);case"live":return l.jsx(b2,{event:i,isLive:!0},i.id);case"final":return l.jsx(b2,{event:i,isFinal:!0},i.id);default:return null}})})})})})}const tVe=({date:e})=>{const{locale:t}=Q(),n=new Date(e).toLocaleDateString(t,{day:"numeric"}),r=new Date(e).toLocaleDateString(t,{month:"short"}),{isMobileStyle:s}=Be();return l.jsxs("div",{className:"dark:bg-subtle bg-subtler py-xs flex w-full flex-col items-center justify-center rounded-lg px-0.5 md:p-[6px]",children:[l.jsx(B,{className:"px-sm -mb-0.5 rounded-full",variant:"tinyRegular",color:"light",textCenter:!0,children:r}),l.jsx(B,{className:"px-sm -mb-1",variant:s?"baseSemi":"section-title",textCenter:!0,children:n})]})},Az=({headshotImageUrl:e,flagUrl:t,name:n,isCompositeFlag:r})=>!e&&!t?null:l.jsxs("div",{className:"relative size-6 shrink-0 rounded md:size-8",children:[l.jsx("img",{src:e??t,alt:n,className:z("rounded-inherit relative size-full shrink-0",{"object-contain":r,"object-cover":!r})}),!r&&l.jsx("div",{className:"rounded-inherit absolute inset-0 border border-black/10 dark:border-white/10"}),e&&l.jsxs("div",{className:"ml-xs ring-raised absolute right-[90%] top-[90%] size-3 shrink-0 -translate-y-1/2 translate-x-1/2 rounded-full ring-2 md:size-4",children:[l.jsx("img",{src:t,alt:n,className:"rounded-inherit relative size-full shrink-0 object-cover"}),l.jsx("div",{className:"rounded-inherit absolute inset-0 border border-black/10 dark:border-white/10"})]})]}),nVe=e=>{for(const t of e)for(const n of t.cells)if(n.extra?.is_current_round)return n.column_id;return null},rVe=({value:e,variant:t="red"})=>{if(!e)return null;const n=t==="subtle";return l.jsx(Y,{variant:t,className:"inline-flex h-5 items-center whitespace-nowrap rounded px-[6px] py-px",children:l.jsx(B,{variant:"micro",className:z("translate-y-half tracking-wider",{uppercase:!n}),children:e})})},nh=(e,t)=>{const n=e.display_value??e.value??"",r=t.font_weight==="bold"?"smallBold":"small",s=e.extra;return l.jsx(B,{variant:r,className:s?.is_current_round?"font-bold":"",children:n})},sVe={pos_golf:(e,t)=>{const n=e.display_value??e.value??"",r=t.font_weight==="bold"?"smallBold":"small";return e.extra?.show_trophy?l.jsx("div",{className:"flex items-center justify-center",children:l.jsx(ye,{icon:D("trophy"),size:"md",className:"text-super"})}):l.jsx(B,{variant:r,color:"light",children:n})},golfer_golf:(e,t)=>{const n=String(e.display_value??""),r=e.image_url??void 0,s=e.value,a=e.sub_text,o=t.font_weight==="bold"?"smallBold":"small";return l.jsxs("div",{className:"md:gap-md gap-sm flex items-center",children:[l.jsx(Az,{headshotImageUrl:r,flagUrl:s,name:n}),l.jsxs("div",{children:[l.jsx(B,{variant:o,children:n}),a&&l.jsx(B,{variant:"tiny",color:"light",children:e.sub_text})]})]})},status_golf:e=>{const t=e.display_value??e.value??"",r=/am|pm/i.test(String(t))?"subtle":"red";return l.jsx(rVe,{value:t,variant:r})},total_golf:(e,t)=>{const n=e.display_value??e.value??"E",r=typeof e.value=="number"?e.value:0,s=t.font_weight==="bold"?"smallBold":"small";let a="default";return r<0?a="positive":r>0&&(a="negative"),l.jsx(B,{variant:s,color:a,children:n})},r1:nh,r2:nh,r3:nh,r4:nh},aVe={status_golf:()=>null},oVe=({result:e})=>{let t="",n=null;return e==="W"?(t="bg-[#059669] text-white",n=D("check")):e==="D"?(t="bg-[#64748b] text-white",n=D("minus")):e==="L"&&(t="bg-[#e11d48] text-white",n=D("x")),l.jsx("div",{className:z("flex size-4 items-center justify-center rounded-full",t),children:n&&l.jsx(ut,{name:n,size:12})})},iVe=({form:e})=>{const t=String(e).replace(/\s/g,"");return l.jsx("div",{className:"flex gap-0.5",children:t.split("").map((n,r)=>l.jsx(oVe,{result:n},r))})},lVe=({value:e})=>{const t=e.includes(""),n=e.includes(""),r=e==="-",s=e.replace(/[^0-9]/g,"");return l.jsxs("div",{className:"flex items-center justify-center gap-0.5",children:[l.jsx(ye,{icon:t?D("caret-up-filled"):n?D("caret-down-filled"):D("minus"),size:"sm",className:z("scale-90",{"text-quietest":r,"text-positive":t,"text-negative":n})}),!r&&l.jsx(B,{variant:"tinyMono",color:t?"positive":"negative",className:"w-[2ch] shrink-0 text-left",children:s})]})},cVe={form:e=>{const t=e.display_value??e.value??"";return l.jsx(iVe,{form:String(t)})},movement:e=>{const t=e.display_value??e.value??"";return l.jsx(lVe,{value:String(t)})}},Nz={...cVe,...sVe},uVe={...aVe},Rz=(e="left")=>{switch(e){case"center":return"text-center";case"right":return"text-right";case"left":default:return"text-left"}},dVe=(e=!1)=>e?"w-full":"w-0",_2=(e="normal",t)=>{if(t==="pos")return"smallCaps";switch(e){case"bold":return"smallBold";case"normal":default:return"small"}},fVe=(e="")=>e==="pos"?"light":"default",mVe=({cell:e,column:t,columns:n,rows:r,columnRenderers:s=Nz})=>{const{inApp:a}=ao();if(!e)return l.jsx("td",{className:"md:px-md p-sm"});let o;const i=t.column_type??"text",c=e.display_value??e.value??"-";t.column_id&&s[t.column_id]?o=s[t.column_id]?.(e,t,{columns:n,rows:r}):(i==="entity"||i==="image")&&e.image_url?o=l.jsxs("div",{className:"md:gap-md gap-sm flex items-center",children:[l.jsx(xx,{logo:e.image_url,color:"transparent",size:"small",className:"shrink-0"}),l.jsxs("div",{children:[l.jsx(B,{variant:_2(t.font_weight??"normal",t.column_id),children:c}),i==="entity"&&e.sub_text&&l.jsx(B,{variant:"tiny",color:"light",children:e.sub_text})]})]}):i==="entity"&&!e.image_url?o=l.jsxs("div",{children:[l.jsx(B,{variant:_2(t.font_weight??"normal",t.column_id),children:c}),e.sub_text&&l.jsx(B,{variant:"tiny",color:"light",children:e.sub_text})]}):o=l.jsx(B,{variant:_2(t.font_weight??"normal",t.column_id),color:fVe(t.column_id),children:c});const u=z("md:pl-md pl-sm last:px-sm md:last:px-md py-sm align-middle",Rz(t.alignment),dVe(t.should_fill_width));return e.canonical_page?l.jsx("td",{className:u,children:l.jsx(Oy,{href:a?e.canonical_page.url_app:e.canonical_page.url_web,className:"block",children:o})}):l.jsx("td",{className:u,children:o})},pVe=({row:e,rows:t,columns:n,columnRenderers:r})=>{if(e.section_header)return l.jsx(Y,{as:"tr",children:l.jsx(Y,{as:"td",colSpan:n.length,className:"pl-sm md:pl-md py-sm",children:l.jsx(Y,{variant:"superLight",className:"inline-flex h-5 items-center rounded px-[6px] py-px",children:l.jsx(B,{variant:"micro",className:"translate-y-half uppercase tracking-wider",children:e.section_header})})})});const s=new Map(e.cells.map(a=>[a.column_id,a]));return l.jsx("tr",{className:"border-subtlest border-b last:border-b-0",children:n.map(a=>l.jsx(mVe,{cell:s.get(a.column_id),column:a,columns:n,rows:t,columnRenderers:r},a.column_id))})},hVe=({table:e,variant:t="subtler",title:n,className:r,noWrapTitle:s=!1,onGroupClick:a,columnRenderers:o,headerRenderers:i})=>{const[c,u]=f.useState(e?.groups?.[0]?.group_id??""),[d,m]=f.useState(!1),{$t:p}=Q();if(mu("standings"),!e||!e.groups?.length)return null;const h=n??e.title??"Standings",g=e.groups.find(w=>w.group_id===c),y=e.groups.length>1;if(!g)return null;const b=d?g.rows:g.rows.slice(0,10),x=nVe(g.rows),_={...Nz,...o},v={...uVe,...i};x&&!v[x]&&(v[x]=w=>l.jsx(Y,{variant:"super",className:"inline-flex h-5 items-center rounded px-[6px] py-px",children:l.jsx(B,{variant:"micro",className:"translate-y-half uppercase tracking-wider",children:w.header_label})}));const C=w=>{u(w),a?.(w)};return l.jsx(Xn,{className:r,header:l.jsxs("div",{className:"md:pl-md gap-sm sm:gap-md flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[l.jsx(B,{variant:"baseSemi",className:z(s?"flex-shrink-0":void 0,"max-sm:pl-sm"),children:h}),y?l.jsx("div",{className:"mb-sm min-w-0",children:l.jsx(Qe,{triggerElement:l.jsx(Qe.Button,{size:"small","aria-label":p({defaultMessage:"Select group",id:"BfB0R+7lom"}),children:g.title??g.group_id}),children:l.jsx(Qe.RadioGroup,{value:c,onValueChange:C,closeOnSelect:!0,children:e.groups.map(w=>l.jsx(Qe.RadioItem,{value:w.group_id,children:w.title??w.group_id},w.group_id))})})}):l.jsx("div",{className:"invisible min-h-10"})]}),children:l.jsxs("div",{className:"rounded-inherit",children:[l.jsx("div",{className:"rounded-t-inherit overflow-hidden",children:l.jsx(zf,{orientation:"horizontal",children:l.jsxs("table",{className:"w-full table-auto border-collapse",children:[l.jsx(Y,{as:"thead",variant:t==="raised"?"raisedOffset":"subtle",children:l.jsx("tr",{children:g.columns.map(w=>{const S=v[w.column_id],E=S?S(w):w.header_label;return l.jsx("th",{className:z("md:pl-md pl-sm last:px-sm md:last:px-md py-xs whitespace-nowrap align-middle",Rz(w.alignment)),children:E?l.jsx(mHe,{className:z({"w-[200px] md:w-auto":w.should_fill_width}),children:E}):null},w.column_id)})})}),l.jsx("tbody",{children:b.map(w=>l.jsx(pVe,{row:w,rows:g.rows,columns:g.columns,columnRenderers:_},w.row_id))})]})})}),g.rows.length>10&&l.jsx(Y,{className:"p-xs border-t",children:l.jsx(pt,{text:p(d?{id:"UOYN/MXiOT",defaultMessage:"View Less"}:{id:"wbcwKddwLa",defaultMessage:"View All"}),size:"small",fullWidth:!0,onClick:()=>m(w=>!w)})})]},g.group_id)})},gVe=A.memo(function(){return l.jsx("div",{children:"Error loading standings widget."})}),yVe=new Set,xVe=({children:e,canonicalPageLink:t})=>{const{$t:n}=Q();return l.jsxs(Y,{variant:"raised",className:"shadow-subtle overflow-hidden rounded-xl border",children:[e,t?l.jsx(Dt,{href:t,children:l.jsxs(B,{variant:"smallBold",className:"p-sm border-subtlest flex items-center justify-center gap-0.5 border-t text-center duration-150 hover:opacity-75",color:"super",children:[n({defaultMessage:"View More",id:"QQSdHPJWXu"}),l.jsx(ut,{name:D("chevron-right"),size:18})]})}):null]})};function bVe({widgetData:e}){const{result:{backend_uuid:t,mode:n}}=Pt(),r=im(),s=f.useMemo(()=>e?.standings_table?e.standings_table:null,[e]);if(f.useEffect(()=>{!t||!e||!s||yVe.has(t)||r("web.frontend.sports_widget_render_time",{widgetType:"sports",widgetSubType:e.object,league:e.league,queryMode:n})},[t,s,n,e,r]),!e||!s)return null;const a=e.canonical_pages?.[0]?.url_web,o=`standings-${s.table_id??"unknown"}`;return l.jsx(ar,{fallback:gVe,children:l.jsx(ss,{widgetType:"sports",widgetName:o,children:({})=>l.jsx(xVe,{canonicalPageLink:a,children:l.jsx(hVe,{table:s,variant:"raised",className:"!rounded-none border-0"})})})})}const _Ve={staleTime:0,refetchOnWindowFocus:!0,refetchOnMount:!0,refetchOnReconnect:!0},vVe=({event:e,team1:t,team2:n,isLive:r})=>{const s=e.datetime&&new Date(e.datetime)>new Date,a=r?t.sub_text:null,o=r?n.sub_text:null,{isMobileStyle:i}=Be(),c=f.useMemo(()=>e?.stat_columns?.map(d=>({team1:{score:d.team_1_text,scoreSuper:d.team_1_super_text,emphasis:d.team_1_emphasis,super:!1},team2:{score:d.team_2_text,scoreSuper:d.team_2_super_text,emphasis:d.team_2_emphasis,super:!1}})),[e?.stat_columns]),u=f.useMemo(()=>r?[...c??[],{team1:{score:t.text,scoreSuper:null,emphasis:!1,super:!0},team2:{score:n.text,scoreSuper:null,emphasis:!1,super:!0}}]:c,[c,r,t.text,n.text]);return s?l.jsxs("div",{className:"gap-sm pr-sm flex h-full flex-col justify-around",children:[l.jsx(B,{variant:"base",color:"ultraLight",className:"opacity-50",children:""}),l.jsx(B,{variant:"base",color:"ultraLight",className:"opacity-50",children:""})]}):c?l.jsxs("div",{className:z("gap-x-md grid h-16 auto-cols-auto grid-flow-col",{"gap-x-sm":i}),children:[u?.map((d,m)=>l.jsxs("div",{className:"gap-sm grid h-full grid-cols-subgrid",children:[l.jsx("div",{className:"flex items-center",children:l.jsxs(B,{variant:i?"smallBold":"section-title",className:"min-w-[2ch] !font-mono leading-none",color:d.team1.super&&d.team1.score?"super":d.team1.emphasis?"default":"ultraLight",textCenter:!0,children:[d.team1.score??"",d.team1.scoreSuper&&l.jsx("sup",{className:"-translate-y-sm text-2xs !font-mono tracking-tight",children:d.team1.scoreSuper})]})}),l.jsx("div",{className:"flex items-center",children:l.jsxs(B,{variant:i?"smallBold":"section-title",className:"min-w-[2ch] !font-mono leading-none",color:d.team2.super&&d.team2.score?"super":d.team2.emphasis?"default":"ultraLight",textCenter:!0,children:[d.team2.score??"",d.team2.scoreSuper&&l.jsx("sup",{className:"-translate-y-sm text-2xs !font-mono tracking-tight",children:d.team2.scoreSuper})]})})]},m)),(a||o)&&l.jsxs("div",{className:"gap-sm grid h-full grid-cols-subgrid place-items-center",children:[l.jsx(n9,{score:a}),l.jsx(n9,{score:o})]})]}):null},n9=({score:e})=>{const{isMobileStyle:t}=Be();return l.jsx(Y,{variant:"superLight",className:z("px-xs flex w-full items-center justify-center rounded py-0.5",{"opacity-0":!e}),children:l.jsx(B,{variant:t?"smallBold":"section-title",color:"super",className:"flex min-w-[2ch] items-center justify-center",children:l.jsx("span",{className:"font-mono",children:e??""})})})},CVe=({children:e,className:t})=>l.jsx(ze.div,{layout:!0,layoutRoot:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{ease:rr,duration:.5},className:z("p-sm isolate flex-col items-end md:flex",t),children:l.jsx("ul",{className:"-mb-xs flex w-full flex-col items-start",children:l.jsx(e0,{id:"index",children:e})})}),wVe=A.memo(function({extraCss:t}){return l.jsx(Y,{className:`h-[12px] w-[60px] rounded-full ${t}`,variant:"subtler"})}),SVe=({widgetData:e,onClick:t,highlighted:n,idx:r})=>l.jsxs("div",{className:"gap-xs pt-sm ml-6 flex items-center",onClick:t.bind(null,e.id),children:[l.jsx(B,{className:z("border-subtler bg-base relative -top-px inline-flex size-4 shrink-0 scale-[.85] items-center justify-center rounded-full border shadow-sm duration-150",{"border-foreground bg-inverse !text-inverse opacity-70":n}),variant:"smallCaps",color:"light",children:r+1}),l.jsx(B,{variant:"tiny",color:n?void 0:"light",lineClamp:1,className:z("cursor-pointer opacity-80 duration-150 hover:!opacity-100",{"!opacity-100":n}),children:e.name})]}),EVe=({highlighted:e,scrollTopOffset:t,scrollThumbHeight:n,widgets:r,loading:s})=>l.jsxs("div",{className:z("bg-base w-two absolute inset-y-0 left-0 z-[2] rounded-full",{"opacity-0 delay-1000":!e}),children:[l.jsx("div",{className:z("absolute inset-0 overflow-hidden duration-150",{"opacity-0":r.length===0||!e,"opacity-1":r.length>0}),children:l.jsx("div",{className:z("absolute left-0 top-0 w-full rounded-full",{"bg-inverse/70":s},{"bg-inverse":!s}),style:{top:`min(${t}%, calc(100% - 8px - ${n}%))`,height:n+"%"}})}),l.jsx("div",{className:"bg-inverse/10 absolute inset-0 rounded-full"})]}),Dz=(e,t,n=100)=>{const s=e.getBoundingClientRect().top,a=t.clientHeight/2;return s-a<=n},kVe=({title:e,onClick:t,idx:n,onWidgetClick:r,highlighted:s=!1,isStaged:a,loading:o,id:i,widgets:c=_e,ref:u,testId:d})=>{const m=s&&!o,[p,h]=f.useState(0),[g,y]=f.useState(0),[b,x]=f.useState(""),_=2,{entityRefs:v}=XG(),{scrollContainerRef:C}=xa(),w=f.useRef(null),S=f.useCallback(()=>{const k=u?.current;if(k){const M=k.getBoundingClientRect().height,N=k.getBoundingClientRect().top;h(Math.max((1-(M+N)/M)*100,0))}},[u]),E=f.useMemo(()=>PC(()=>{let k=[];Object.keys(v).map(M=>{v[M]?.current&&C?.current&&Dz(v[M]?.current,C.current)&&(k=[...k,M])}),x(k[k.length-1]??"")},100),[x,v,C]);f.useEffect(()=>{const k=C.current;if(k)return c&&c.length>=_&&s?(k.addEventListener("scroll",E),k.addEventListener("scroll",S)):(k.removeEventListener("scroll",E),k.removeEventListener("scroll",S)),()=>{k.removeEventListener("scroll",E),k.removeEventListener("scroll",S)}},[s,E,S,c,C]),f.useEffect(()=>{const k=u?.current;if(w.current&&(w.current.disconnect(),w.current=null),k?.nodeType===Node.ELEMENT_NODE){const M=new ResizeObserver(([N])=>{if(N&&ko(N.borderBoxSize)){const{blockSize:P}=N.borderBoxSize[0];y(window.innerHeight/P*100)}});M.observe(k),w.current=M}return()=>{w.current?.disconnect(),w.current=null}},[u,n]);const T=f.useMemo(()=>c.length>=_&&l.jsx("span",{className:"ml-xs inline-flex",children:l.jsx(ye,{icon:D("chevron-down"),size:"xs"})}),[c.length,_]);return l.jsxs(Tr,{as:"li",active:o,speed:"slow",className:"group relative flex select-none flex-col",children:[l.jsx(ba,{mode:"popLayout",initial:!0,children:l.jsx(bs,{children:a&&!e?l.jsx("div",{className:"ml-md flex h-[20px] items-center",children:l.jsx(wVe,{extraCss:"!w-[100px] !h-[10px]"})}):l.jsxs("div",{children:[l.jsx("div",{onClick:t.bind(null,n),"data-testid":d,children:l.jsxs(B,{variant:"small",color:m?"default":a?"ultraLight":"light",lineClamp:2,className:z("gap-xs pl-md cursor-pointer opacity-80 duration-150 group-hover:opacity-100",{"font-[450] !opacity-100":m}),children:[e,T]})}),s&&!a&&c.length>=_&&l.jsx(ze.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0,transition:{delay:.15}},exit:{opacity:0,y:-4},className:"pb-1",children:c.map((k,M)=>{const N=k.meta_data;return N.object==="ShopifyWidget"?l.jsx(SVe,{widgetData:N,onClick:r,idx:M,highlighted:!o&&b===N.id},N.id):null})},e)]})},a&&!e?"placeholder":e)}),l.jsx("div",{className:"h-sm text-inverse relative z-[5] inline-flex w-full",children:l.jsx("svg",{width:"2",height:"10",viewBox:"0 0 2 10",fill:"none",className:"inline-flex",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{d:"M2 0C2 0.552284 1.55228 1 1 1C0.447716 1 0 0.552284 0 0V10C0 9.44772 0.447716 9 1 9C1.55228 9 2 9.44772 2 10V0Z",fill:"currentColor"})})}),o&&l.jsx("div",{className:"w-two absolute inset-y-0 left-0 z-[4] animate-pulse rounded-full",children:l.jsx("div",{className:"bg-inverse absolute inset-0 opacity-10"})}),l.jsx("div",{className:z("bg-base w-two absolute inset-y-0 left-0 z-[3] opacity-0 duration-150",{"!opacity-100":a})}),c.length>=_&&l.jsx(EVe,{highlighted:s,scrollTopOffset:p,scrollThumbHeight:g,widgets:c,loading:o??!1}),s&&l.jsx(ze.div,{layoutId:"layout"+i,transition:{ease:rr,duration:.3},className:z("bg-inverse w-two absolute inset-y-0 left-0 z-[1] rounded-full",{"!bg-inverse/70":a||o},{"opacity-0 delay-100":c.length>=_})}),l.jsx("div",{className:"bg-inverse w-two absolute inset-y-0 left-0 z-[1] rounded-full opacity-10 duration-150"})]})},MVe=({items:e,sectionRefs:t,onItemClick:n,onWidgetClick:r,className:s,id:a})=>{const[o,i]=f.useState(0),c=h=>{r?.(h)},{scrollContainerRef:u}=xa(),d=h=>{n(h)},m=f.useMemo(()=>PC(()=>{if(!u?.current)return;const h=u.current;if((h?.scrollTop??0)===0){i(0);return}if(p_(h)){i(e.length-1);return}let y=[];Array.from({length:Object.keys(t).length}).map((b,x)=>{const _=t?.[x]?.current;_&&Dz(_,h,0)&&(y=[...y,x])}),i(y[y.length-1]??0)},100),[t,i,e.length,u]),p=f.useCallback(()=>{m()},[m]);return f.useEffect(()=>{const h=u?.current;return h?.addEventListener("scroll",p),()=>{h?.removeEventListener("scroll",p)}},[p,u]),l.jsx(CVe,{className:s,children:e.filter(h=>h.show).map((h,g)=>l.jsx(kVe,{title:h.title,onClick:d,onWidgetClick:c,idx:g,loading:h.loading,highlighted:g===o,isStaged:h.staged,id:a,testId:h.testId,widgets:h.widgets,ref:t[g]},h.id))})};A.memo(function(){return l.jsx("div",{})});A.memo(function({children:t,entries:n,className:r,showMenu:s=!0,header:a,footer:o,variant:i="default",id:c}){const{isMobileStyle:u}=Be();return l.jsxs("div",{className:z(r,"mx-md mb-md max-w-threadWidth gap-x-lg md:mx-lg relative md:grid",{"grid-cols-4":i==="default","grid-cols-3":i==="twoThirds"}),children:[l.jsx("div",{className:z("space-y-md pt-md",{"col-span-3":i==="default","col-span-2":i==="twoThirds"}),children:t}),l.jsx("div",{className:z("relative",{"col-span-1 col-start-4":i==="default","col-span-1":i==="twoThirds"}),children:s&&!u&&l.jsxs("div",{className:"sticky top-0",children:[a&&l.jsx("div",{children:a}),l.jsx(TVe,{entries:n,id:c}),o&&l.jsx("div",{children:o})]})})]})});const TVe=A.memo(function({entries:t,id:n}){const{scrollContainerRef:r}=xa();A.useEffect(()=>{const i=window.location.hash.slice(1);if(i){const c=t.find(u=>u.id===i);c?.ref.current&&r9(c.ref.current,!1,r.current)}},[t,r]);const s=f.useMemo(()=>Object.fromEntries(t.filter(i=>i.show).map((i,c)=>[c,i.ref])),[t]),a=f.useMemo(()=>t.map(i=>({title:i.title,id:i.id,loading:!1,show:i.show??!0})).filter(i=>i.show),[t]),o=f.useCallback(i=>{s[i]?.current&&r9(s[i].current,!0,r.current)},[s,r]);return l.jsx(MVe,{className:"pt-md",items:a,sectionRefs:s,onItemClick:o,id:`menu-list-${n}`})});function r9(e,t=!0,n){const r=parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--header-height"))||50,s=parseFloat(window.getComputedStyle(e).marginTop),{top:a}=e.getBoundingClientRect();if(!n)return;const o=a+n.scrollTop-r-s;n.scrollTo({top:o,behavior:t?"smooth":"auto"})}const AVe=A.memo(function({query:t,children:n,nofollow:r=!0,sources:s,...a}){const o=`/search/new?q=${encodeURIComponent(t)}${s?`&sources=${s.join(",")}`:""}`,i=f.useCallback(()=>N7e({query:t}),[t]);return l.jsx(Dt,{href:A7e()?void 0:o,rel:r?"nofollow":void 0,onClick:i,...a,children:n})});function NVe(e,t){return e==null?1:t==null?-1:e==null&&t==null?0:!isNaN(Number(e))&&!isNaN(Number(t))?Number(e)-Number(t):String(e).localeCompare(String(t))}const RVe=({children:e,...t})=>l.jsx("table",{...t,children:e}),DVe=({children:e,...t})=>l.jsx("tr",{...t,children:e}),IVe=({children:e,index:t,id:n,data:r,...s})=>l.jsx("td",{...s,children:l.jsx(B,{variant:"tiny",className:z({"font-normal":t}),children:e})}),jVe=({SortButton:e,children:t})=>l.jsx("th",{className:"py-sm pr-sm text-left align-text-top outline-none",children:l.jsxs(Y,{className:"group relative flex items-center justify-between",children:[l.jsx(B,{variant:"tiny",color:"light",children:t}),e]})}),PVe=A.memo(function({name:t,setSortDescriptor:n}){return l.jsx("button",{className:"right-sm absolute opacity-0 transition-opacity duration-200 group-hover:opacity-100",onClick:()=>{n(r=>({...r,column:t,reverse:!r.reverse}))},children:l.jsx(B,{variant:"tiny",color:"super",children:l.jsx(ye,{icon:D("arrows-vertical"),size:"xs"})})})}),OVe=A.memo(function({collapsed:t,setCollapsed:n,viewMoreText:r,viewLessText:s}){const a=f.useCallback(()=>{n(o=>!o)},[n]);return l.jsx(Y,{className:"pb-sm",children:l.jsx(st,{pill:!0,variant:"border",size:"tiny",chevron:!0,chevronIcon:t?D("chevron-down"):D("chevron-up"),text:t?r:s,onClick:a})})}),s9="focus-visible:outline-super focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-0",xQe=A.memo(function(t){const{data:n,columns:r,compareFunction:s,RowCell:a,HeaderCell:o,Row:i,Table:c,limit:u}=t,[d,m]=f.useState({column:void 0,reverse:!1}),p=n.at(0),h=f.useMemo(()=>r??Object.keys(p??{}).map(C=>({name:C})),[p,r]),g=s??NVe,y=f.useMemo(()=>{const C=n.map(w=>({data:w,key:w.key??Math.random().toString(36).substring(7)}));return d.column&&C.sort((w,S)=>g(w.data[d.column],S.data[d.column])*(d.reverse?-1:1)),C.slice(0,u||C.length)},[n,u,d,g]),b=o??jVe,x=c??RVe,_=i??DVe,v=a??IVe;return l.jsx("div",{className:"overflow-x-auto",children:l.jsxs(x,{className:"w-full border-collapse",children:[l.jsx("thead",{children:l.jsx(_,{id:"_header",children:h.map((C,w)=>l.jsx(LVe,{index:w,HeaderCell:b,setSortDescriptor:m,...C},C.name))})}),l.jsx("tbody",{children:y.map(C=>l.jsx(_,{id:C.key,className:z("group",s9,"border-subtlest border-t border-dashed !outline-none first:border-solid"),children:h.map(({name:w},S)=>l.jsx(v,{id:w,index:S,data:C.data,className:z("pr-sm align-text-top last:pr-0",s9,'group-data-[selected="true"]:first:border-l-super py-sm group-data-[selected="true"]:border-super group-data-[selected="true"]:bg-super/10 group-data-[selected="true"]:first:pl-xs group-data-[selected="true"]:last:pr-xs dark:group-data-[selected="true"]:bg-super/10 rounded-sm outline-none transition-all duration-300 ease-in-out group-data-[selected="true"]:first:border-l-2 group-data-[selected="true"]:last:border-r-2'),children:String(C.data[w])},w))},C.key))})]})})}),LVe=A.memo(function({index:t,HeaderCell:n,setSortDescriptor:r,...s}){const a=f.useMemo(()=>l.jsx(PVe,{name:s.name,setSortDescriptor:r}),[s.name,r]);return l.jsx(n,{index:t,id:s.name,data:s,SortButton:a,children:s.label??s.name},s.name)}),FVe=Pe(async()=>{const{CitationListModal:e}=await W(async()=>{const{CitationListModal:t}=await import("./CitationListModal-4_bfX56k.js");return{CitationListModal:t}},__vite__mapDeps([411,2,3,5,1,412,6,7,8,9,15,34,35,36,13,12,14,16,17]));return{default:e}}),MC=3,TC=A.memo(function({children:t}){return l.jsx(B,{variant:"tinyRegular",color:"light",children:l.jsx("time",{className:"text-nowrap",children:t})})}),UVe=A.memo(function({source:t,includeRootLink:n=!0}){const{$t:r}=Q(),{session:s}=je(),{trackEvent:a}=Ze(s),o=f.useMemo(()=>({onClick(){a("click citation",{source:"hoverCard",citation_url:t.url})}}),[t.url,a]),i=f.useMemo(()=>({color:"light"}),[]);return l.jsx(j_,{timestampComponent:t.timestamp?l.jsx(ug,{recentlyUpdatedLabel:r({defaultMessage:"just now",id:"I90sbWU03C"}),timestamp:t.timestamp,timestampProps:i,children:r({defaultMessage:"Updated",id:"xrk6zgu9jU"})}):null,linkProps:o,result:t,children:l.jsx(BVe,{url:n?t.url:void 0,children:l.jsx(Bl,{label:`${t.id}`,className:"mb-xs"})})})}),BVe=({children:e,url:t,ref:n,...r})=>t!==void 0?l.jsx(Dt,{href:t,target:"_blank",rel:"noopener nofollow",ref:n,...r,children:e}):l.jsx("span",{ref:n,...r,children:e}),HVe=(e,t)=>{if(!e)return"";const n=new Date(e),r=new Date;return Math.abs(+n-+r)<1e3*60*60*24?new Intl.RelativeTimeFormat(t,{localeMatcher:"best fit",numeric:"auto",style:"long"}).format(0,"day"):n.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})},VVe=A.memo(function({post:t}){const{locale:n}=Q(),{isMobileStyle:r}=Be(),s=f.useMemo(()=>t.timestamp?HVe(t.timestamp,n):"",[t.timestamp,n]);return l.jsx(Y,{children:l.jsx(AVe,{query:t.headline,nofollow:!0,children:l.jsxs("span",{className:"group/post pb-xs cursor-pointer",children:[l.jsxs(B,{variant:r?"smallBold":"baseSemi",className:"mb-xs gap-sm flex items-baseline justify-between",children:[l.jsx("span",{className:"leading-snug duration-150",children:t.headline}),l.jsxs("div",{className:"flex translate-x-1 items-center gap-0.5",children:[t.timestamp&&!r&&l.jsx(Y,{className:"gap-sm capitalize",children:l.jsx(TC,{children:s})}),l.jsx(ye,{icon:D("chevron-right"),size:"sm",className:"text-quiet group-hover/post:text-foreground translate-y-1 opacity-75 duration-150 md:translate-y-0"})]})]}),l.jsxs(B,{variant:r?"small":"base",className:"text-pretty leading-tight",children:[l.jsx("span",{className:"opacity-75",children:t.text}),l.jsx("span",{className:"ml-xs inline-flex",children:t.sources.map((a,o)=>l.jsx("span",{className:"mr-xs",children:l.jsx(UVe,{source:a,includeRootLink:!1},a.id)},o))})]}),t.timestamp&&r&&l.jsxs(Y,{className:"mt-sm gap-xs flex items-center capitalize",children:[l.jsx(ut,{name:D("clock"),className:"text-quiet opacity-80",size:16}),l.jsx(TC,{children:s})]})]})})})});A.memo(function({created:t,posts:n,title:r,variant:s}){const{$t:a}=Q(),[o,i]=f.useState(!0),{openModal:c}=Kt(),{locale:u}=Q(),[d,m]=f.useState(Date.now());f.useEffect(()=>{const x=setInterval(()=>m(Date.now()),15e3);return()=>clearInterval(x)},[]);const p=ro(),h=f.useMemo(()=>{if(!t||!p)return"";const x=Date.parse(t),_=d-x;let v=_/6e4,C="days";v<1?(v=_/1e3,C="seconds"):v<60?(v=_/6e4,C="minutes"):v<1440?(v=_/36e5,C="hours"):(v=_/864e5,C="days"),v=-Math.abs(Math.floor(v));const w=new Intl.RelativeTimeFormat(u,{localeMatcher:"best fit",numeric:"auto",style:"short"});return a({defaultMessage:"Updated {time}",id:"0aJxT29U/1"},{time:w.format(v,C)})},[t,d,a,u,p]),g=f.useMemo(()=>{if(!n?.length)return[];const x=n.flatMap(_=>_.sources).map(_=>[_.id,_]);return Object.values(Object.fromEntries(x))},[n]),y=f.useMemo(()=>g.map(x=>({url:x.url})).filter(x=>!!x.url),[g]),b=f.useCallback(()=>{c(FVe,{webResults:g})},[c,g]);return l.jsxs("div",{children:[l.jsxs(Y,{className:z("gap-xs px-md py-sm flex flex-wrap items-center justify-between",{"border-b":s!=="raised"}),children:[l.jsxs(B,{variant:"baseSemi",color:n.length>0?"super":"ultraLight",className:"gap-sm flex items-center",as:"h2",children:[l.jsx(qVe,{animate:n.length>0}),l.jsx("span",{children:r??a({defaultMessage:"What's Happening",id:"wVxgwE2ray"})})]}),l.jsx(TC,{children:h})]}),l.jsxs(Y,{variant:s,className:z({"rounded-xl border":s==="raised"}),children:[l.jsx(ba,{transition:{ease:rr,duration:.2},children:l.jsx(bs,{children:n.length===0?l.jsx(GVe,{}):l.jsx("ul",{className:"pb-md grid",children:n.slice(0,o?MC:n.length).map((x,_)=>l.jsx(ze.li,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0},transition:{y:{ease:rr,duration:.2}},className:"mx-md border-subtlest py-md block border-b last:border-b-0 last:pb-0",children:l.jsx(VVe,{post:x},_)},x.headline))})})}),n.length>0&&l.jsxs(l.Fragment,{children:[n.length>MC&&l.jsx(Y,{className:"px-md",children:l.jsx(OVe,{collapsed:o,setCollapsed:i,viewMoreText:a({defaultMessage:"View More",id:"QQSdHPJWXu"}),viewLessText:a({defaultMessage:"View Less",id:"UOYN/MXiOT"})})}),l.jsx("div",{className:"pb-md pl-md",children:l.jsxs(Y,{as:"button",bgHover:"subtle",className:"gap-sm px-sm inline-flex items-center rounded-full border py-1.5",onClick:b,children:[l.jsx(PE,{sources:y,count:4}),l.jsxs(B,{variant:"tiny",color:"light",children:[g.length," Sources"]})]})})]})]})]})});const GVe=()=>l.jsx(Tr,{className:"px-md",children:l.jsx("div",{className:"divide-y",style:{maskImage:"linear-gradient(to bottom, black 50%, transparent)"},children:Array.from({length:MC}).map((e,t)=>l.jsx(zVe,{},t))})}),zVe=()=>l.jsxs(Y,{className:"gap-sm py-md flex flex-col",children:[l.jsx(Y,{className:"mb-sm h-2 w-4/5 rounded-full",variant:"subtle"}),l.jsx(Y,{className:"h-2 w-3/5 rounded-full",variant:"subtle"}),l.jsx(Y,{className:"h-2 w-3/5 rounded-full",variant:"subtle"}),l.jsx(Y,{className:"h-2 w-2/5 rounded-full",variant:"subtle"})]}),rh=(e,t)=>t?{initial:{opacity:0},animate:{opacity:1},transition:{duration:1,repeat:1/0,repeatDelay:5,ease:lf,delay:e}}:{opacity:1},qVe=({animate:e})=>l.jsx("svg",{viewBox:"0 0 576 512",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-super inline-block h-[1em] overflow-visible align-[-0.125em]",children:l.jsxs("g",{children:[l.jsx(ze.path,{d:"M99.8 69.4C110 77.8 111.4 93 103 103.2C68.6 144.7 48 197.9 48 256C48 314.1 68.6 367.3 103 408.8C111.4 419 110 434.1 99.8 442.6C89.6 451.1 74.5 449.6 66 439.4C24.8 389.6 0 325.7 0 256C0 186.3 24.8 122.4 66 72.6C74.4 62.4 89.6 61 99.8 69.4ZM476.3 69.4C486.5 61 501.6 62.4 510.1 72.6C551.3 122.4 576.1 186.4 576.1 256C576.1 325.6 551.3 389.6 510.1 439.4C501.7 449.6 486.5 451 476.3 442.6C466.1 434.2 464.7 419 473.1 408.8C507.4 367.3 528.1 314.1 528.1 256C528.1 197.9 507.5 144.7 473.1 103.2C464.7 93 466.1 77.9 476.3 69.4Z",fill:"currentColor",...rh(.3,e)}),l.jsx(ze.path,{...rh(.15,e),d:"M160 256C160 226.4 170 199.2 186.9 177.5C195 167 193.2 151.9 182.7 143.8C172.2 135.7 157.1 137.5 149 148C125.8 177.8 112 215.3 112 256C112 296.7 125.8 334.2 149 364C157.2 374.5 172.2 376.4 182.7 368.2C193.2 360 195 345 186.9 334.5C170 312.8 160 285.6 160 256Z",fill:"currentColor"}),l.jsx(ze.path,{...rh(.15,e),d:"M464 256C464 215.3 450.2 177.8 427 148C418.8 137.5 403.8 135.6 393.3 143.8C382.8 152 381 167 389.1 177.5C406 199.2 416 226.4 416 256C416 285.6 406 312.8 389.1 334.5C381 345 382.8 360.1 393.3 368.2C403.8 376.3 418.9 374.5 427 364C450.2 334.2 464 296.7 464 256Z",fill:"currentColor"}),l.jsx(ze.path,{...rh(0,e),d:"M259.716 227.716C252.214 235.217 248 245.391 248 256C248 266.609 252.214 276.783 259.716 284.284C267.217 291.786 277.391 296 288 296C298.609 296 308.783 291.786 316.284 284.284C323.786 276.783 328 266.609 328 256C328 245.391 323.786 235.217 316.284 227.716C308.783 220.214 298.609 216 288 216C277.391 216 267.217 220.214 259.716 227.716Z",fill:"currentColor"})]})});A.memo(function({children:t,maxFaces:n=3,showMore:r=!0,clickable:s=!1,size:a="medium",onAvatarClick:o,backgroundClass:i}){const c=A.Children.count(t);return l.jsxs(Y,{onClick:s?o:void 0,bgHover:s?"subtler":void 0,className:z("group flex items-center",{"p-xs cursor-pointer rounded-full transition-all":s}),children:[A.Children.map(t,(u,d)=>d<n?l.jsx(Y,{variant:"background",className:z("rounded-full group-hover:bg-transparent",{"relative transition-all duration-200 ease-in-out":d!==0,"p-two group-hover:-ml-xs -ml-[10px]":d!==0&&a==="small","p-two group-hover:-ml-sm -ml-[16px]":d!==0&&a==="medium"},i),children:l.jsx("div",{children:u})},d):null),r&&c>n&&l.jsx(Y,{children:l.jsxs(B,{variant:"smallCaps",color:"light",className:"px-xs",children:["+",c-n]})})]})});const $Ve=e=>!!e.extra.team_1_competitor_types?.map(n=>n.type).includes("team"),WVe=({event:e,subtitles:t,headshots:n})=>{const{locale:r}=Q(),s=f.useMemo(()=>{if(!e.datetime)return null;const m=new Date(e.datetime);return isNaN(m.getTime())?null:m.toLocaleTimeString(r,{hour:"numeric",minute:"numeric",hour12:!0})},[e.datetime,r]),a=e.status==="live",o=e.status==="final",i=e.datetime&&new Date(e.datetime)>new Date,c=e.team_1.won||e.team_2.won,{isMobileStyle:u}=Be(),d=$Ve(e);return l.jsxs(Y,{className:"group relative",children:[l.jsx(Y,{className:"bg-subtler duration-quick absolute inset-0 opacity-0 transition-opacity group-hover:opacity-50",variant:"subtle"}),l.jsxs(Oy,{href:`/sports/atp/events/${e.id}`,className:z("p-md gap-y-md relative grid w-full flex-col",{"gap-y-sm":u}),children:[l.jsxs("div",{className:"gap-md flex items-center justify-between",children:[l.jsx(B,{variant:u?"tinyRegular":"small",color:"light",children:e.title[0]}),i?l.jsxs("div",{className:"gap-sm flex items-center",children:[l.jsx(B,{variant:u?"tinyRegular":"small",color:"light",children:s}),l.jsx(bz,{className:"-mr-0.5"})]}):a?l.jsx(Hm,{className:"-mr-0.5",includeDot:!0}):o&&l.jsx(yx,{className:"-mr-0.5"})]}),l.jsxs(Y,{className:"gap-lg flex w-full items-center",children:[l.jsx("div",{className:"gap-sm flex flex-1",children:l.jsxs("div",{className:z("flex flex-1 flex-col gap-[12px]",{"gap-sm":u}),children:[l.jsx(a9,{team:e.team_1,headshotImageUrl:n?.team1??null,anyWinner:c,subtitle:t?.team1,isDoubles:d,serving:e.team_1.emphasis,isLive:a}),l.jsx(a9,{team:e.team_2,headshotImageUrl:n?.team2??null,anyWinner:c,subtitle:t?.team2,isDoubles:d,serving:e.team_2.emphasis,isLive:a})]})}),l.jsx("div",{className:"flex h-full items-center justify-end",children:l.jsx(vVe,{event:e,team1:e.team_1,team2:e.team_2,isLive:a})})]})]})]})},a9=({team:e,headshotImageUrl:t,anyWinner:n,subtitle:r,isDoubles:s,serving:a,isLive:o})=>{const i=e.won,{isMobileStyle:c}=Be();return l.jsxs("div",{className:z("gap-sm flex items-center",{"opacity-30 grayscale":n&&!i}),children:[l.jsx(Az,{headshotImageUrl:t??void 0,flagUrl:e.img??void 0,name:e.title??"",isCompositeFlag:s}),l.jsxs("div",{children:[l.jsxs(B,{variant:c?"smallBold":"baseSemi",className:"gap-xs flex items-center",children:[e.title,i&&l.jsx(Y,{variant:"superLight",className:"p-xs ml-auto inline-flex aspect-square rounded-full",children:l.jsx(ut,{name:D("trophy"),size:12,className:"text-super"})}),a&&o&&l.jsx(ye,{icon:D("ball-tennis"),size:14,className:"text-super"})]}),typeof r=="string"?l.jsx(B,{variant:"micro",color:"light",className:"-mt-0.5",children:r}):r]})]})},KVe=async e=>{if(!e)return null;const{data:t,error:n,response:r}=await ve.POST("/rest/sports/{league}/widget","sports-widget",{body:e});if(n)throw new Ue("API_CLIENTS_ERROR",{cause:n,details:e,status:r.status??0});return t},YVe=({data:e})=>{const{data:t}=gt({..._Ve,queryKey:Se.makeEphemeralQueryKey("/sports/widget",e.events.map(r=>r.id).join(",")),queryFn:()=>KVe(e.debug_fn_args),placeholderData:Ja,refetchInterval:3e4}),n=t||e;return n?.object!==e.object?null:l.jsx(vz,{canonicalPageLink:n?.canonical_pages?.[0]?.url_web,children:l.jsx("div",{className:"divide-y overflow-hidden",children:n?.events?.map(r=>l.jsx(WVe,{event:r},r.id))})})},sh=A.memo(function({data:t}){return Va(t).with({object:"SportsEventsWidget"},n=>n.league==="atp"||n.league==="wta"?l.jsx(YVe,{data:n}):l.jsx(RHe,{widget:n})).with({object:"SportsStandingsWidget"},n=>l.jsx(bVe,{widgetData:n})).with({object:"SportsIndvScheduleWidget"},n=>l.jsx(eVe,{widgetData:n})).with({object:"SportsIndvEventsWidget"},n=>l.jsx(QHe,{widgetData:n})).exhaustive()});A.memo(function({isOpened:t,onOpen:n,onClose:r,onEdit:s}){const a=Q(),o=hn(),{isMobileStyle:i}=Be(),c=f.useMemo(()=>[{type:"default",text:a.formatMessage({defaultMessage:"Edit",id:"wEQDC6Wv3/"}),onClick:s,testId:"task-widget-edit"},{type:"default",text:a.formatMessage({defaultMessage:"View Tasks",id:"L3nFsHqlqm"}),rightElement:l.jsx("div",{className:"flex items-center",children:l.jsx(ut,{name:D("chevron-right"),size:16})}),onClick:()=>{o.push("/account/tasks")},testId:"task-widget-view-tasks"}],[a,s,o]);return l.jsx(bu,{placement:"bottom-start",items:c,onOpen:n,onClose:r,isMobileStyle:i,children:l.jsx(pt,{size:"tiny",icon:D("dots-vertical"),extraCSS:z("",{"!text-foreground !bg-subtle":t})})})});const QVe=async({taskId:e,headers:t,reason:n})=>{const{data:r,error:s,response:a}=await ve.GET("/rest/tasks/{task_id}",n,{params:{path:{task_id:e}},timeoutMs:Ct(),numRetries:wi,headers:t});if(s)throw new Ue("API_CLIENTS_ERROR",{message:"Failed to get user task",cause:s,status:a.status??0});return r?.task?hCe(r.task):null},o9=oP,AC=()=>l.jsx("div",{className:"flex flex-1 items-center justify-end opacity-50",children:l.jsx(ye,{icon:D("arrow-up-right"),size:"sm"})}),XVe={Enterprise:{trailingComponent:l.jsx(AC,{})},APILearnMore:{trailingComponent:l.jsx(AC,{})},Tasks:{href:`${o9}/tasks`},Shortcuts:{href:`${o9}/shortcuts`}};l.jsx(AC,{});const ZVe=Pe(async()=>{const{FinanceAlertModal:e}=await W(async()=>{const{FinanceAlertModal:t}=await import("./FinanceAlertModal-DkAOOJtP.js");return{FinanceAlertModal:t}},__vite__mapDeps([415,2,3,5,1,7,8,6,9,12,13,14,15,16,17]));return{default:e}}),JVe=Pe(async()=>await W(()=>import("./TaskModal-CZD7FuAm.js"),__vite__mapDeps([416,2,3,5,1,69,6,7,8,9,13,12,14,15,16,17]))),eGe=()=>l.jsxs(Tr,{className:"flex w-full items-center justify-between gap-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"bg-subtle size-4 shrink-0 rounded"}),l.jsx("div",{className:"bg-subtle h-4 w-32 rounded"})]}),l.jsx("div",{className:"bg-subtle h-4 w-20 rounded"})]}),tGe=A.memo(function({data:t}){const{$t:n}=Q(),{suggested_prompt:r,suggested_schedule:s,widget_uuid:a}=t,{openModal:o}=Kt(),i=Vs(),c=f.useMemo(()=>({id:a,title:"",prompt:r,schedule:s?jT(s):vr(),searchModel:i}),[r,s,a,i]),u=Xt(),d=f.useCallback(()=>{u.openTab({url:`${window.location.origin}${XVe.Tasks.href}`})},[u]),[m,p]=f.useState(!1),[h,g]=f.useState(null),[y,b]=f.useState(!1);f.useEffect(()=>{if(!h)return;const E=setTimeout(()=>{g(null)},2e3);return()=>clearTimeout(E)},[h]);const x=Q(),{data:_,isLoading:v}=gt({queryKey:_P(a),queryFn:()=>QVe({taskId:a,reason:"task-widget"})});f.useCallback(()=>{_?.type==="ALERT"&&_?.subscription?o(ZVe,{task:_,symbol:_.subscription.event_entity}):o(JVe,{source:"task_widget",prefill:_?void 0:c,initial:_??void 0,onSuccess:E=>{g(E),b(!1)}})},[_,o,c]),f.useMemo(()=>{if(!_)return null;if(_.type==="ALERT"&&_.subscription)return C0e({..._.subscription,event_type:_.subscription.event_type},x);const E=jT(_.scheduleInfo);return{kind:iCe(E.kind,x),friendly:aCe(E,x),isRecurring:E.kind!=="ONCE"}},[_,x]);const C=f.useMemo(()=>{if(!_)return"";if(_.type==="ALERT"&&_.subscription){const{subscription:E}=_,T=E.event_entity||"",k=E.event_type==="STOCK_PRICE_TARGET",M=E.event_type==="STOCK_PRICE_MOVEMENT";if(k){const N=E.value_upper_bound||E.value_lower_bound;if(N)return`${T} reaches $${N}`}else if(M){const N=E.value_upper_bound||0,P=E.value_lower_bound||0,O=N>0,L=P<0;if(O&&L)return`${T} moves ${N}%`;if(O)return`${T} rises ${N}%`;if(L)return`${T} falls ${Math.abs(P)}%`}return`Price alert for ${T}`}return _.prompt},[_]);f.useMemo(()=>{if(!h)return null;const E=h==="created"?l.jsx(be,{defaultMessage:"Task created",id:"991WgJt61N"}):h==="updated"?l.jsx(be,{defaultMessage:"Task updated",id:"sQGGdcVjgL"}):h==="deleted"?l.jsx(be,{defaultMessage:"Task deleted",id:"kGP3l1jr/4"}):h==="paused"?l.jsx(be,{defaultMessage:"Task paused",id:"Ryhxeg2OIZ"}):l.jsx(be,{defaultMessage:"Task resumed",id:"fqAqWnF85q"});return l.jsx(ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.2,ease:rr},children:l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(ut,{name:D("circle-check-filled"),className:"text-super",size:16}),l.jsx(B,{variant:"small",color:"super",className:"truncate",children:E})]})},"confirmed")},[h]);const w=f.useCallback(()=>{b(!1)},[]),S=f.useCallback(()=>b(!0),[]);return f.useMemo(()=>n({defaultMessage:"Task",id:"0wJ7N+noSq"}),[n]),f.useMemo(()=>l.jsx(ut,{name:D("plus"),size:12}),[]),f.useCallback(()=>{p(!0)},[]),f.useCallback(()=>{p(!1)},[]),l.jsx(ss,{widgetType:"task",widgetName:"task",children:l.jsx("div",{className:"bg-subtler border-subtlest p-md group relative flex h-14 items-center justify-between gap-2 rounded-xl border transition-transform duration-200 hover:scale-[1.01] hover:transform",onMouseEnter:S,onMouseLeave:w,children:l.jsx(Wt,{mode:"wait",children:v?l.jsx(eGe,{}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex min-w-0 shrink items-center gap-2",children:[l.jsx("div",{className:"bg-subtle flex size-8 items-center justify-center rounded-lg",children:_?.type==="ALERT"&&_?.subscription?l.jsx(ut,{name:D("trending-up"),size:16,className:"text-quiet shrink-0"}):l.jsx(ut,{name:D("clock"),size:16,className:"text-quiet shrink-0"})}),l.jsx("div",{className:"flex w-full min-w-0 flex-col items-start",children:_?l.jsx(B,{variant:"small",color:"default",className:"w-full truncate",children:C}):l.jsxs(l.Fragment,{children:[l.jsx(B,{variant:"small",color:"default",className:"w-full truncate",children:r}),l.jsx(B,{variant:"tinyRegular",color:"light",className:"truncate",children:l.jsx(be,{defaultMessage:"Create a task to get this sent automatically.",id:"1AmBIpC9N9"})})]})})]}),l.jsx(pt,{size:"tiny",icon:D("edit"),onClick:d})]})})})})}),nGe=A.memo(function(t){const{data:n}=t,{menuItems:r}=Gu();return l.jsx(ss,{widgetType:"time",widgetName:"time",children:l.jsxs(Y,{className:"flex w-full",children:[l.jsx(B,{children:l.jsx(Y,{className:"mr-md pr-md border-r font-mono text-4xl",children:n.time})}),l.jsxs("div",{children:[l.jsx(B,{variant:"smallBold",children:n.date}),l.jsx(B,{variant:"small",color:"light",children:n.location?`${n.location}`:null})]}),r&&r.length>0&&l.jsx("div",{className:"-mr-sm -mt-sm flex grow justify-end",children:l.jsx("div",{children:l.jsx(In.Menu,{menuItems:r})})})]})})}),rGe=A.memo(function(t){const{data:n}=t,{duration_seconds:r}=n,{menuItems:s}=Gu(),{result:a}=Pt(),o=a?.uuid,i=f.useMemo(()=>`timer_widget_state_${o}_${r}`,[o,r]),[c,u]=f.useState(!1),[d,m]=f.useState(!1),[p,h]=f.useState(null),[g,y]=f.useState(r*1e3),[b,x]=f.useState(!0),[_,v]=f.useState(!1),C=f.useRef(void 0),w=f.useRef(void 0),S=f.useRef(!1),E=f.useRef(null);f.useEffect(()=>{if(!o)return;const H=yt.getItem(i);if(H)try{const R=JSON.parse(H),I=Date.now();if(R.status==="expired"){m(!0),y(0),h(null);return}if(R.pausedAt&&R.remainingMillis!==void 0)u(!0),y(R.remainingMillis),h(null);else if(R.endTime){const F=R.endTime-I;if(F>0)h(R.endTime),y(F),u(!1);else{y(0),h(null),m(!0);const G={status:"expired",endTime:0,remainingMillis:0};yt.setItem(i,JSON.stringify(G))}}}catch{yt.removeItem(i)}else{const R=Date.now()+r*1e3;h(R),u(!1)}},[i,r,o]),f.useEffect(()=>{if(!o||d)return;const H=c?{status:"paused",endTime:0,pausedAt:Date.now(),remainingMillis:g}:{status:"running",endTime:p||Date.now()+g};yt.setItem(i,JSON.stringify(H))},[g,c,p,i,d,o]);const T=f.useCallback(()=>{if(S.current||d)return;S.current=!0,y(0),h(null),m(!0),v(!0);const H={status:"expired",endTime:0,remainingMillis:0};yt.setItem(i,JSON.stringify(H)),!b&&E.current&&E.current.play().catch(()=>{})},[i,d,b]),k=f.useCallback(()=>{if(!c&&p){const H=Date.now(),R=p-H;R>0?(y(R),C.current=requestAnimationFrame(k)):T()}},[c,p,T]);f.useEffect(()=>{if(!c&&p&&g>0&&!d){C.current=requestAnimationFrame(k);const H=p-Date.now();H>0&&(w.current=window.setTimeout(T,H))}return()=>{C.current&&cancelAnimationFrame(C.current),w.current&&clearTimeout(w.current)}},[c,p,g,d,k,T]),f.useEffect(()=>{const H=()=>{if(!document.hidden&&!c&&p){const R=Date.now(),I=p-R;I>0?y(I):T()}};return document.addEventListener("visibilitychange",H),()=>{document.removeEventListener("visibilitychange",H)}},[c,p,T]);const M=f.useCallback(()=>{if(!d)if(c){const H=Date.now()+g;h(H),u(!1)}else u(!0),h(null)},[d,c,g]),N=f.useCallback(()=>{C.current&&(cancelAnimationFrame(C.current),C.current=void 0),w.current&&(clearTimeout(w.current),w.current=void 0),S.current=!1;const H=Date.now()+r*1e3;m(!1),u(!1),y(r*1e3),h(H)},[r]),P=f.useCallback(()=>{x(H=>!H)},[]),O=f.useCallback(()=>{v(!1),E.current&&(E.current.pause(),E.current.currentTime=0)},[]),L=f.useMemo(()=>{const H=Math.ceil(g/1e3),R=Math.floor(H/3600),I=Math.floor(H%3600/60),F=Math.floor(H%60),G=I.toString().padStart(2,"0"),j=F.toString().padStart(2,"0");return R>0?`${R}:${G}:${j}`:`${G}:${j}`},[g]);return l.jsx(ss,{widgetType:"timer",widgetName:"timer",children:l.jsxs(Y,{className:z("relative flex transition-all duration-200",{"hover:scale-[1.01]":_}),children:[_&&l.jsxs(l.Fragment,{children:[l.jsx("button",{className:"-m-md absolute inset-0 z-20 cursor-pointer rounded-xl",onClick:O,title:"Click anywhere to stop alarm","aria-label":"Stop alarm"}),l.jsx("div",{className:"-m-md to-attention/20 from-negative/20 absolute inset-0 animate-pulse rounded-xl bg-gradient-to-br"})]}),l.jsxs("div",{className:"relative z-10 flex w-full items-center",children:[l.jsxs(Y,{className:"gap-sm flex items-center",children:[l.jsx(st,{variant:"primaryGhost",size:"small",onClick:M,icon:c?D("player-play-filled"):D("player-pause-filled"),disabled:d,pill:!0}),l.jsx(st,{variant:"primaryGhost",size:"small",onClick:N,icon:D("rotate-clockwise"),"aria-label":"Restart timer",disabled:_,pill:!0})]}),l.jsx(B,{className:"flex-1",children:l.jsx(Y,{className:`pl-lg font-mono text-2xl ${_?"text-negative":""}`,children:L})}),l.jsxs("div",{className:"gap-sm flex items-center",children:[l.jsx(eE,{cueKey:`timer-unmute-${o}`,title:"Tap to unmute",enabled:b&&!d,side:"top",children:l.jsx(st,{variant:"primaryGhost",size:"small",onClick:P,icon:b?D("custom-product-volume-muted"):D("custom-product-volume"),disabled:d,pill:!0})}),s&&s.length>0&&l.jsx(In.Menu,{menuItems:s})]})]}),l.jsx("audio",{ref:E,src:"https://r2cdn.perplexity.ai/Hole_In_One.wav?v=1",preload:"auto",style:{display:"none"},loop:!0})]})})});function sGe(){const[e,t]=f.useState(!1),n=c0(),r=f.useCallback(s=>{Ci(Ek,s.toString()),t(s)},[t]);return f.useEffect(()=>{const s=_s(Ek);t(s==="true"||s===void 0&&n!=="US")},[n]),f.useMemo(()=>({prefersMetric:e,setPrefersMetric:r}),[e,r])}const aGe=130,oGe=A.memo(function({day:t,icon:n,high:r,low:s,selected:a}){return l.jsxs("div",{className:"relative col-span-1",children:[a&&l.jsx(ze.div,{layoutId:"selected-forecast-item",className:"-inset-sm absolute right-0",transition:ui,children:l.jsx("div",{className:"absolute inset-0 rounded-md bg-white opacity-10"})}),l.jsxs("div",{className:"relative flex flex-col items-start",children:[l.jsx(B,{color:"white",children:l.jsx(ye,{icon:n,size:"xl",className:"mb-xs -ml-two"})}),l.jsx(B,{variant:"smallBold",color:"white",children:t}),l.jsxs("div",{className:"mt-xs gap-x-xs flex",children:[l.jsx(B,{variant:"smallCaps",color:"white",className:"gap-x-two flex",children:l.jsxs("span",{children:[r,""]})}),l.jsx(B,{variant:"smallCaps",color:"white",className:"gap-x-two flex opacity-75",children:l.jsxs("span",{children:[s,""]})})]})]})]})}),v2=f.memo(function({width:t,variant:n}){const[r,s]=f.useState(!1),a=n==="hail"?20:n==="normal"?25:40,o=400,i=n==="hail"?1:20,c=n==="hail"?3:n==="normal"?30:80,u=100,d=n==="hail"?.8:.5,m=n==="hail"?.3:.1,p=ZC();return f.useEffect(()=>{s(!0)},[]),!r||p?null:l.jsx("div",{className:"absolute inset-0",children:Array.from({length:a}).map((h,g)=>{const y=Math.floor(Math.random()*(t-1)),b=Math.floor(Math.random()*(c-i+1))+i,x=Math.floor(Math.random()*(u+1)),_=Math.random()*(d-m)+m,v=Math.floor(Math.random()*o)+1,C=n==="hail"?b:1;return l.jsx("div",{className:"absolute inset-y-0",style:{left:y},children:l.jsx("div",{style:{opacity:_,animationDuration:o+x+"ms",animationDelay:-v+"ms",animationTimingFunction:"linear"},className:"animation-weather-rain absolute inset-y-0 will-change-transform",children:l.jsx("div",{style:{width:C,height:b,opacity:_,maskImage:n!=="hail"?"linear-gradient(to bottom, transparent, black, transparent)":void 0},className:"absolute transform-gpu rounded-full bg-white"})})},g)})})}),i9=f.memo(function({width:t,height:n,variant:r}){const[s,a]=f.useState(!1),o=r==="normal"?50:80,i=r==="normal"?2e3:1e3,c=1,u=8,d=r==="normal"?1500:800,m=.5,p=.1,h=2,g=ZC();return f.useEffect(()=>{a(!0)},[]),!s||g?null:l.jsxs("div",{className:"absolute inset-0",children:[l.jsx("div",{className:z("absolute inset-x-0 bottom-0 translate-y-[80%] bg-white opacity-20 blur-sm",{"rounded-m blur-xs -left-xl -right-xl h-lg":r==="heavy"},{"h-md rounded-[50%]":r==="normal"})}),l.jsx(Wt,{children:Array.from({length:o}).map((y,b)=>{const x=Math.floor(Math.random()*(t-1)),_=Math.floor(Math.random()*(u-c+1))+c,v=Math.floor(Math.random()*(d+1)),C=Math.floor(Math.random()*h)+1,w=Math.random()*(m-p)+p,S=Math.floor(Math.random()*i)+1;return l.jsx(ze.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:3},style:{left:x,top:0,height:n},className:"absolute",children:l.jsx("div",{style:{animationDuration:i+v+"ms",animationTimingFunction:"linear",animationDelay:-S+"ms",opacity:w},className:"absolute rounded-full bg-white animation-weather-snow",children:l.jsx("div",{style:{width:_,height:_,animationDuration:"inherit",maskImage:"radial-gradient(black 20%, transparent)"},className:z("absolute rounded-full bg-white",C===1&&"animation-weather-snow-wave")})})},b)})})]})}),iGe=f.memo(function({width:t,height:n,context:r}){const[s,a]=f.useState(!1),o=70,i=2,c=1,u=2,d=500,m=1e3,p=.5,h=.2,g=ZC();return f.useEffect(()=>{a(!0)},[]),!s||g?null:l.jsxs("div",{className:"absolute inset-0",children:[l.jsx(Wt,{children:Array.from({length:o}).map((y,b)=>{const x=Math.floor(Math.random()*(t-1)),_=Math.floor(Math.random()*(n-1)),v=Math.floor(Math.random()*(i-c+1))+c,C=Math.floor(Math.random()*u)+1,w=Math.floor(Math.random()*(d+1)),S=Math.floor(Math.random()*(m+1)),E=Math.random()*(p-h)+h;return l.jsx(ze.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:3},style:{left:x,top:_},className:"absolute",children:l.jsx("div",{style:{width:v,height:v,animationDuration:5e3+w+"ms",animationDelay:S+"ms",opacity:E},className:z("absolute rounded-full bg-white",{"animation-weather-star-twinkle":C===1})})},b)})}),l.jsx("div",{className:z("w-lg absolute left-0 h-px bg-white","animation-weather-star-shoot",{"context-ntp":r==="ntp"})})]})}),lGe=["clear-day","clear-night","partly-cloudy-day","partly-cloudy-night","cloudy-day","cloudy-night","patchy-rain-possible-day","patchy-rain-possible-night","possible-thunder-day","possible-thunder-night","overcast","fog","snow","sleet","patchy-freezing-drizzle","heavy-snow","blizzard","drizzle","hail","light-shower","heavy-rain","lightning-rain","lightning-snow"],cGe=A.memo(function({variant:t,context:n,className:r}){const s=f.useCallback(g=>{switch(g){case"clear-day":default:return["#FF813A","#FFC700","#1F84CD"];case"partly-cloudy-day":return["#8E8E8E","#D5D5D5","#1F84CD"];case"partly-cloudy-night":return["#8E8E8E","#6A6A6A","#0B1B39"];case"cloudy-day":case"overcast":case"patchy-rain-possible-day":case"patchy-freezing-drizzle":case"drizzle":case"light-shower":case"heavy-rain":case"blizzard":case"heavy-snow":case"sleet":case"snow":case"fog":case"possible-thunder-day":case"hail":case"lightning-rain":case"lightning-snow":return["#B8B8B8","#8791AB","#486289"];case"cloudy-night":case"possible-thunder-night":case"patchy-rain-possible-night":return["#222938","#3E475A","#1B2230"];case"clear-night":return["#44344A","#091937","#091937"]}},[]),a=f.useCallback(g=>{switch(g){default:return null;case"partly-cloudy-night":case"cloudy-night":case"possible-thunder-night":case"clear-night":return"stars";case"light-shower":case"sleet":case"drizzle":case"patchy-rain-possible-night":case"patchy-rain-possible-day":case"patchy-freezing-drizzle":case"lightning-rain":return"rain";case"hail":return"rain-hail";case"heavy-rain":return"rain-heavy";case"snow":return"snow";case"heavy-snow":case"blizzard":case"lightning-snow":return"snow-heavy"}},[]),o=s(t),[i,c,u]=o,[d,{width:m,height:p}]=Ni(),h=n==="ntp"?null:a(t);return l.jsxs("div",{style:{backgroundColor:u},className:z("absolute inset-0 overflow-hidden rounded-xl shadow-md",r),children:[l.jsx("div",{className:"-inset-xl absolute translate-y-1/4 rounded-[50%] opacity-75",style:{backgroundColor:c}}),l.jsx("div",{className:"-inset-xl absolute translate-y-[60%] rounded-[50%] opacity-75",style:{backgroundColor:i}}),l.jsx("div",{className:"rounded-inherit absolute inset-0 overflow-hidden",style:{backdropFilter:"blur(40px)",WebkitBackdropFilter:"blur(40px)"}}),l.jsx("div",{className:"absolute inset-0",ref:d,children:h==="stars"?l.jsx(iGe,{height:p,width:m,context:n}):h==="rain"?l.jsx(v2,{height:p,width:m,variant:"normal"}):h==="rain-heavy"?l.jsx(v2,{height:p,width:m,variant:"heavy"}):h==="snow"?l.jsx(i9,{height:p,width:m,variant:"normal"}):h==="snow-heavy"?l.jsx(i9,{height:p,width:m,variant:"heavy"}):h==="rain-hail"?l.jsx(v2,{height:p,width:m,variant:"hail"}):null}),l.jsx("div",{className:"rounded-inherit absolute inset-0 border border-transparent"})]})}),l9={"clear-day":D("custom-weather-sun"),"clear-night":D("custom-weather-moon-stars"),"partly-cloudy-day":D("custom-weather-cloud-sun"),"partly-cloudy-night":D("custom-weather-cloud-moon"),"cloudy-day":D("custom-weather-cloud-sun"),"cloudy-night":D("custom-weather-cloud-moon"),"patchy-rain-possible-day":D("custom-weather-cloud-sun-rain"),"patchy-rain-possible-night":D("custom-weather-cloud-moon-rain"),"possible-thunder-day":D("custom-weather-cloud-bolt-sun"),"possible-thunder-night":D("custom-weather-cloud-bolt-moon"),overcast:D("custom-weather-clouds"),fog:D("custom-weather-cloud-fog"),snow:D("custom-weather-snowflake"),sleet:D("custom-weather-cloud-sleet"),"patchy-freezing-drizzle":D("custom-weather-snowflake-droplets"),"heavy-snow":D("custom-weather-cloud-snow"),blizzard:D("custom-weather-snow-blowing"),drizzle:D("custom-weather-cloud-drizzle"),hail:D("custom-weather-cloud-hail"),"light-shower":D("custom-weather-cloud-showers"),"heavy-rain":D("custom-weather-cloud-showers-heavy"),"lightning-rain":D("custom-weather-cloud-bolt"),"lightning-snow":D("custom-weather-cloud-bolt")},uGe=Pe(async()=>{const{HourlyTemperature:e}=await W(async()=>{const{HourlyTemperature:t}=await import("./HourlyTemperature-UbN4UZMf.js");return{HourlyTemperature:t}},__vite__mapDeps([417,2,3,5,1,15,7,8,13,12,9,6,14,16,17]));return{default:e}},{loading:()=>l.jsx("div",{style:{height:aGe}})}),dGe=Pe(async()=>{const{LocationPermissionModal:e}=await W(async()=>{const{LocationPermissionModal:t}=await import("./LocationPermissionModal-D1sgKLhz.js");return{LocationPermissionModal:t}},__vite__mapDeps([418,2,3,5,1,6,7,8,9,13,12,14,15,16,17]));return{default:e}}),fGe=A.memo(function(t){const{$t:n}=Q(),{prefersMetric:r,setPrefersMetric:s}=sGe(),a=r,[o,i]=f.useState(0),[c,u]=f.useState(!1),d=t,{menuItems:m}=Gu(),{openModal:p}=Kt(),{permissionState:h}=tS(),{submitQuery:g}=ya(),{session:y}=je(),{trackEvent:b}=Ze(y),{locale:x}=Q(),{value:_}=VC({flag:"weather-provider",defaultValue:"weatherapi",subjectType:"visitor_id"}),v=f.useCallback(()=>{b("precise location modal opened",{origin:"weather_widget"}),p(dGe,{onPermissionGranted:O=>{u(!1);const L=wo();g({rawQuery:"weather",copilotOverride:!1,attachments:[],collection:null,newFrontendContextUUID:L,promptSource:"device_location_request",querySource:"device_location_request",deviceLocation:{latitude:O.coords.latitude,longitude:O.coords.longitude},shouldRedirectToBackendUUID:!0})},origin:"weather_widget"})},[b,p,g]);f.useEffect(()=>{h!==void 0&&h!=="granted"&&u(!0)},[h]);const C=f.useCallback(()=>{window.open(d.url||"https://www.accuweather.com/","_blank")},[d.url]);if(!d||!d.current||!d.location)return null;const{current:w,location:S,forecast:E}=d,T=E[0],k=w.condition?.icon,M=r$(lGe,k)?l9[k]:D("custom-weather-sun"),N="col-span-1",P=o===0?w.condition?.icon||"clear-day":E[o]?.icon||"clear-day";return l.jsx(ss,{widgetType:"weather",widgetName:"weather_forecast",children:l.jsxs(Y,{className:"p-md relative select-none",children:[l.jsx(Wt,{initial:!1,mode:"popLayout",children:l.jsx(ze.div,{className:"absolute inset-0",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{duration:.3,delay:.3,ease:ai}},transition:{opacity:{duration:.2,ease:ai}},children:l.jsx(cGe,{variant:P})},P)}),l.jsxs(Y,{className:"gap-md relative flex flex-col drop-shadow-sm",children:[l.jsxs("div",{className:"gap-x-xl flex",children:[l.jsx(Y,{className:N,children:l.jsx("div",{className:"flex h-full items-center",children:l.jsxs(B,{className:"gap-x-md flex items-center",color:"white",children:[l.jsx(ye,{icon:M,size:40,className:"-mt-xs -ml-two"}),l.jsxs("div",{className:"flex items-baseline",children:[l.jsx("div",{className:"font-mono text-4xl",children:l.jsx(Kd,{value:a?w.temp_c??0:w.temp_f??0,suffix:""})}),l.jsxs("div",{className:"ml-xs mt-two flex gap-px",children:[l.jsx("button",{onClick:()=>s(!1),className:"cursor-pointer appearance-none",children:l.jsx(B,{color:"white",className:a?"opacity-60":void 0,children:l.jsx("div",{className:"font-mono",children:"F"})})}),l.jsx("button",{onClick:()=>s(!0),className:"ml-xs cursor-pointer appearance-none",children:l.jsx(B,{color:"white",className:a?void 0:"opacity-60",children:l.jsx("div",{className:"font-mono",children:"C"})})})]})]})]})})}),l.jsxs(Y,{className:N,children:[w.condition&&l.jsx(B,{variant:"section-title",className:"mb-1 leading-tight",color:"white",children:w.condition.text}),l.jsxs("div",{className:"gap-x-xs flex",children:[l.jsx(B,{variant:"smallCaps",color:"white",children:l.jsx(Kd,{value:a?T?.maxtemp_c??0:T?.maxtemp_f??0,suffix:""})}),l.jsx(B,{variant:"smallCaps",className:"flex opacity-70",color:"white",children:l.jsx(Kd,{value:a?T?.mintemp_c??0:T?.mintemp_f??0,suffix:""})})]})]})]}),l.jsxs("div",{className:"gap-sm flex",children:[l.jsxs(Y,{className:"flex flex-col items-start justify-center",children:[l.jsx("div",{className:"gap-sm relative flex items-center",children:l.jsxs(Ao,{className:"gap-xs text-xs text-white",children:[l.jsx(Un,{id:"location-name",children:l.jsxs(B,{variant:"smallBold",className:"text-right",color:"white",children:[S.name,S.is_usa?S.region?`, ${S.region}`:"":`, ${S.country}`]})}),c&&l.jsx(Un,{id:"precise",children:l.jsx(pt,{onClick:v,size:"small",extraCSS:"!text-white hover:underline hover:opacity-100 !p-0 !h-0 decoration-white/50 decoration-offset-[4px] opacity-70 !font-normal",pill:!0,variant:"noBackground",text:n({defaultMessage:"Use precise location",id:"Si49wMl5CP"})})})]})}),S.localtime&&l.jsx(B,{variant:"tinyRegular",color:"white",className:"opacity-75",children:jW(S.localtime,x)})]}),m&&m?.length>0&&l.jsx("div",{className:"absolute right-0 top-0",children:l.jsx(In.Menu,{buttonClass:"!text-white opacity-40 hover:opacity-100 hover:!bg-white/10",menuItems:m})})]})]}),l.jsx(Y,{className:"mt-xl relative grid grid-cols-3 gap-x-4 gap-y-6 drop-shadow-sm md:grid-cols-6",children:E.map((O,L)=>l.jsx("button",{onClick:()=>i(L),className:L!==o?"duration-150 hover:opacity-70 active:scale-[0.98]":"",children:l.jsx(oGe,{day:PW(O.dow??"",x),high:(a?O.maxtemp_c:O.maxtemp_f)??0,low:(a?O.mintemp_c:O.mintemp_f)??0,icon:l9[O.icon],selected:o===L})},L))}),l.jsx(Y,{className:"mt-sm",children:l.jsx(uGe,{forecast:E,activeDay:o,isMetric:a})}),_==="accuweather"&&l.jsx(Y,{className:"mt-lg flex cursor-pointer justify-end",onClick:C,children:l.jsxs(B,{variant:"micro",color:"white",className:"mt-xs gap-xs -mb-sm -mr-xs flex items-center opacity-65 hover:opacity-40",children:["The AccuWeather",l.jsx("sup",{className:"-ml-xs",children:""})," Forecast",l.jsx(ye,{icon:D("arrow-up-right"),size:"xs"})]})})]})})}),mGe=()=>null,pGe=Pe(()=>W(()=>import("./index-DN6-kW0Y.js"),__vite__mapDeps([419,2,3,5,1,6,7,8,9,13,12,14,15,16,17])),{loading:()=>l.jsx(mGe,{})}),hGe=A.memo(function({widgetData:t,menuItems:n}){const r=ry(t);return r?Va(r).with({object:"CalculatorWidget"},s=>l.jsx(In,{menuItems:n,children:l.jsx(DLe,{...s})})).with({object:"FinanceWidget"},s=>l.jsx(In,{menuItems:n,variant:"noChrome",children:l.jsx(OG,{data:s})})).with({object:"CrunchbaseWidget"},s=>l.jsx(In,{menuItems:n,variant:"noChrome",children:l.jsx(pGe,{...s})})).with({object:"PlaceWidget"},()=>null).with({object:"ShopifyWidget"},()=>null).with({object:"JobsWidget"},()=>null).with({object:"TimeWidget"},s=>l.jsx(In,{menuItems:n,children:l.jsx(nGe,{...s})})).with({object:"TimerWidget"},s=>l.jsx(In,{menuItems:n,children:l.jsx(rGe,{...s})})).with({object:"CurrencyExchangeWidget"},s=>l.jsx(In,{menuItems:n,className:"overflow-hidden !p-0",variant:"noChrome",children:l.jsx(CFe,{...s})})).with({object:"PredictionMarketWidget"},s=>l.jsx(dUe,{...s})).with({object:"WeatherWidget"},s=>l.jsx(In,{menuItems:n,variant:"noChrome",children:l.jsx(fGe,{...s})})).with({object:"SportsEventsWidget"},s=>l.jsx(sh,{data:s})).with({object:"SportsIndvScheduleWidget"},s=>l.jsx(sh,{data:s})).with({object:"SportsStandingsWidget"},s=>l.jsx(sh,{data:s})).with({object:"SportsIndvEventsWidget"},s=>l.jsx(sh,{data:s})).with({object:"FlightStatusWidget"},s=>l.jsx(DFe,{data:s})).with({object:"PriceComparisonWidget"},s=>l.jsx(IUe,{block:s})).with({object:"TaskWidget"},s=>l.jsx(tGe,{data:s})).with({object:"GenericFallbackWidget"},s=>l.jsx(IFe,{...s})).with({object:"GenericOnboardingWidget"},s=>l.jsx(OFe,{widgetData:s})).otherwise(()=>(Z.warn(new Error(`No PanelComponent found for livePanelType: ${r.object}`),{widgetData:t}),null)):null}),gGe=A.memo(function({name:t,title:n,values:r,onEntityClick:s}){const{inFlight:a}=Ht(),o=f.useCallback(u=>{a||s(u)},[a,s]),i=z("underline-offset-2 cursor-pointer decoration-subtler hover:text-super hover:decoration-super group transition-colors duration-200 ease-in-out",{underline:!a}),c=f.useCallback(({content:u,href:d})=>{const m=d||(u.startsWith("http://")||u.startsWith("https://")?u:`https://${u}`);return l.jsxs(Dt,{href:m,target:"_blank",rel:"noopener",className:i,children:[u,l.jsx(B,{className:"ml-xs inline",color:"light",variant:"tiny",children:l.jsx(ye,{icon:D("external-link"),size:"xs"})})]})},[i]);return l.jsx(In.Item,{name:t,title:n,value:r.map((u,d)=>l.jsx(yGe,{attributeValue:u,index:d,totalValues:r.length,entityStyling:i,handleEntityClick:o,renderLink:c},`${u.id}-${d}`))},t)}),yGe=A.memo(function({attributeValue:t,index:n,totalValues:r,entityStyling:s,handleEntityClick:a,renderLink:o}){const i=f.useMemo(()=>()=>l.jsx("div",{children:t.value}),[t.value]),c=f.useCallback(()=>a(t.value??""),[t.value,a]),u=f.useMemo(()=>l.jsxs(ar,{fallback:i,children:[t.value&&l.jsx(l.Fragment,{children:t.clickable_entity?l.jsx("span",{className:s,onClick:c,children:t.value}):t.value}),t.detail&&l.jsxs("span",{className:"text-quiet ml-1",children:["(",t.source?o({content:t.detail,href:t.source}):t.detail,")"]})]}),[t.clickable_entity,t.detail,t.source,t.value,s,i,c,o]);return l.jsxs("span",{children:[u,n<r-1&&", "]})}),c9=0,xGe=A.memo(function({data:t,isReadonly:n,submit:r,entryUUID:s}){const{$t:a}=Q(),{title:o,subtitle:i,attributes:c,image_url:u,source_url:d}=t,{session:m}=je(),{trackEvent:p}=Ze(m),{firstResult:h}=Ht(),g=h?.frontend_context_uuid,y=hn(),b=c.length,[x,_]=f.useState(b),v=x===b,C=c.length>2,{menuItems:w}=Gu(),S=f.useCallback(()=>{p("click toggle on knowledge card",{newState:v?"collapsed":"expanded",entryUUID:s??"",type:t.type??"",id:t.source_url??"",name:t.title??""}),_(P=>P===c9?b:c9)},[p,v,b,s,t]),[E,{height:T}]=Ni(),k=n,M=wo(),N=f.useCallback(P=>{if(p("knowledge card link clicked",{entryUUID:s??"",type:t.type??"",id:t.source_url??"",name:t.title??"",label:"attributes",value:P}),r({fork:k,rawQuery:P,collection:null,newFrontendContextUUID:k?M:null,existingFrontendContextUUID:k?void 0:g,promptSource:"user",querySource:"entity_link"}),k){const O=new URLSearchParams({q:P,newFrontendContextUUID:M}),L=new URL(window.location.href);L.pathname="search/new",L.search=O.toString();const H=L.toString();y.push(H)}},[r,k,M,g,y,s,t,p]);return f.useEffect(()=>{p("knowledge card shown",{entryUUID:s??"",type:t.type??"",id:t.source_url??"",name:t.title??""})},[]),l.jsx("div",{className:"relative",children:l.jsx(ze.div,{animate:T>0?{height:T}:{},transition:{type:"spring",bounce:.2,duration:.2},className:"overflow-hidden",children:l.jsxs("div",{ref:E,className:"gap-md relative flex flex-col",children:[l.jsx("div",{className:"flex items-end justify-between",children:l.jsx(In.Title,{title:o,subtitle:i,image_url:u,href:d,links:t.links,entryUUID:s??"",data:t,children:l.jsx("div",{className:"flex items-start",children:l.jsx("div",{className:"gap-sm flex items-center",children:w&&w?.length>0&&l.jsx(In.Menu,{menuItems:w,buttonClass:"opacity-0 pointer-events-none"})})})})}),v&&l.jsx("div",{className:"gap-sm border-subtlest pt-md md:gap-x-md grid grid-cols-[auto,1fr] border-t",children:c.slice(0,x).map(P=>l.jsx(gGe,{name:P.key??"",title:P.title??"",values:P.values??[],onEntityClick:N},P.key))}),l.jsx("div",{children:C&&l.jsx("div",{className:"flex justify-end",children:l.jsx(st,{variant:"border",fullWidth:!0,text:a(v?{defaultMessage:"Less",id:"mFYgAXM/x4"}:{defaultMessage:"More",id:"I5NMJ8llIi"}),size:"tiny",pill:!0,onClick:S,icon:v?D("chevron-up"):D("chevron-down"),extraCSS:"pl-xs w-[76px]"})})})]})})})});function bGe(e){if(!e||!e.card_type)return null;const{primaryLink:t,otherLinks:n}=(e.links??[]).reduce((s,a)=>(a.type==="PRIMARY"&&!s.primaryLink?s.primaryLink=a:s.otherLinks.push(a),s),{primaryLink:null,otherLinks:[]}),r=e?.media_items?.[0]?.image??e?.image_urls?.[0]??"";return{source_url:t?.url??"",image_url:r,title:e?.title??"",subtitle:e.description??"",attributes:e.attributes??[],type:e.card_type,links:n}}const _Ge=A.memo(function({knowledgePanelData:t,isReadonly:n,submit:r,menuItems:s,entryUUID:a,className:o}){const i=f.useMemo(()=>t?bGe(t):null,[t]);return i?l.jsx(In,{menuItems:s,className:o,children:l.jsx(xGe,{data:i,submit:r,isReadonly:n,entryUUID:a??""})}):null}),vGe=A.memo(function({data:t,submit:n,isReadonly:r=!1,menuItems:s,entryUUID:a}){return l.jsxs(l.Fragment,{children:[!Kk(t)&&G2(t)&&l.jsx(hGe,{widgetData:t,menuItems:s??_e}),gte(t)&&l.jsx(_Ge,{knowledgePanelData:t,summaryData:null,submit:n,isReadonly:r,menuItems:s??_e,entryUUID:a??""}),Kk(t)&&l.jsx(RLe,{graphData:t})]})}),bx=()=>{const{firstResult:e}=Ht(),t=e?.status,n=e?.privacy_state,r=Mi(),{isIncognitoLocal:s}=cD();return f.useMemo(()=>t?!r&&t!=="PENDING"||!!n&&(s&&n!=="INCOGNITO"||!s&&n==="INCOGNITO"):!1,[s,n,r,t])},CGe=25,Dh="text-super",NC=A.memo(function({rating:t,className:n,reviewCount:r,size:s="xs",textVariant:a="small",reviewTextVariant:o="small",reviewTextColor:i="light",variant:c,showCount:u=!0,minReviewCount:d=CGe,showRatingLabel:m=!0,ratingPosition:p="after",url:h,color:g="default"}){const y=Math.floor(t),b=t%1===0?0:1,x=5-y-b;if(t===0||!r||r<d)return null;const _=m&&l.jsx(B,{variant:a,className:"group-hover/link:text-super relative font-medium leading-none",color:g,children:l.jsx(ak,{value:t,maximumFractionDigits:1})}),v=l.jsxs("div",{className:"flex items-center",children:[c==="truncated"?l.jsx(ye,{icon:D("star-filled"),size:s,className:z(Dh,"-translate-y-px")}):Array.from({length:y}).map((S,E)=>l.jsx(ye,{icon:D("star-filled"),size:s,className:Dh},`rating-star-full-${E}`)),c!=="truncated"&&Array.from({length:b}).map((S,E)=>l.jsx(wGe,{fraction:t%1,size:s},`rating-star-half-${E}`)),c!=="truncated"&&Array.from({length:x}).map((S,E)=>l.jsx("span",{className:"inline-flex opacity-20",children:l.jsx(ye,{icon:D("star-filled"),size:s,className:Dh})},`rating-star-empty-${E}`))]}),C=r&&r>0&&u&&l.jsxs(B,{variant:o,color:i,className:"group-hover/link:text-super relative leading-none",children:["(",l.jsx(ak,{value:r}),")"]}),w=l.jsxs("div",{className:z("gap-xs flex items-center",n),children:[p==="before"&&_,v,p==="after"&&_,C]});return h?l.jsx(Dt,{href:h,target:"_blank",className:"group/link",children:w}):w}),wGe=A.memo(function({fraction:t,size:n}){return l.jsxs("div",{className:"isolate inline-grid grid-cols-1 grid-rows-1",children:[l.jsx("span",{className:"text-foreground relative col-start-1 row-start-1 inline-flex items-center opacity-30",children:l.jsx("span",{className:"inline-flex",children:l.jsx(ye,{icon:D("star-filled"),size:n})})}),l.jsx("span",{className:"relative col-start-1 row-start-1 inline-flex items-center",children:l.jsx("span",{className:z(Dh,"inline-flex overflow-hidden"),style:{width:t*100+"%"},children:l.jsx(ye,{icon:D("star-filled"),size:n,className:"shrink-0"})})})]})}),SGe=f.createContext(null);function EGe(e,t){const n=Array.isArray(e)?e[0]:e?e.x:0,r=Array.isArray(e)?e[1]:e?e.y:0,s=Array.isArray(t)?t[0]:t?t.x:0,a=Array.isArray(t)?t[1]:t?t.y:0;return n===s&&r===a}function yo(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!yo(e[n],t[n]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n)if(!t.hasOwnProperty(s)||!yo(e[s],t[s]))return!1;return!0}return!1}function kGe(e){const t=e.clone();return t.pixelsToGLUnits=e.pixelsToGLUnits,t}function u9(e,t){if(!e.getProjection)return;const n=e.getProjection(),r=t.getProjection();yo(n,r)||t.setProjection(n)}function d9(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function f9(e,t){const n=t.viewState||t;let r=!1;if("zoom"in n){const s=e.zoom;e.zoom=n.zoom,r=r||s!==e.zoom}if("bearing"in n){const s=e.bearing;e.bearing=n.bearing,r=r||s!==e.bearing}if("pitch"in n){const s=e.pitch;e.pitch=n.pitch,r=r||s!==e.pitch}if(n.padding&&!e.isPaddingEqual(n.padding)&&(r=!0,e.padding=n.padding),"longitude"in n&&"latitude"in n){const s=e.center;e.center=new s.constructor(n.longitude,n.latitude),r=r||s!==e.center}return r}const MGe=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function m9(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const r of e.layers)t[r.id]=r;const n=e.layers.map(r=>{let s=null;"interactive"in r&&(s=Object.assign({},r),delete s.interactive);const a=t[r.ref];if(a){s=s||Object.assign({},r),delete s.ref;for(const o of MGe)o in a&&(s[o]=a[o])}return s||r});return{...e,layers:n}}var p9={};const h9={version:8,sources:{},layers:[]},g9={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},C2={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},y9={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},TGe=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],AGe=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class uu{constructor(t,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=s=>{const a=this.props[y9[s.type]];a?a(s):s.type==="error"&&console.error(s.error)},this._onPointerEvent=s=>{(s.type==="mousemove"||s.type==="mouseout")&&this._updateHover(s);const a=this.props[g9[s.type]];a&&(this.props.interactiveLayerIds&&s.type!=="mouseover"&&s.type!=="mouseout"&&(s.features=this._hoveredFeatures||this._queryRenderedFeatures(s.point)),a(s),delete s.features)},this._onCameraEvent=s=>{if(!this._internalUpdate){const a=this.props[C2[s.type]];a&&a(s)}s.type in this._deferredEvents&&(this._deferredEvents[s.type]=!1)},this._MapClass=t,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(t){const n=this.props;this.props=t;const r=this._updateSettings(t,n);r&&this._createShadowTransform(this._map);const s=this._updateSize(t),a=this._updateViewState(t,!0);this._updateStyle(t,n),this._updateStyleComponents(t,n),this._updateHandlers(t,n),(r||s||a&&!this._map.isMoving())&&this.redraw()}static reuse(t,n){const r=uu.savedMaps.pop();if(!r)return null;const s=r.map,a=s.getContainer();for(n.className=a.className;a.childNodes.length>0;)n.appendChild(a.childNodes[0]);s._container=n,r.setProps({...t,styleDiffing:!1}),s.resize();const{initialViewState:o}=t;return o&&(o.bounds?s.fitBounds(o.bounds,{...o.fitBoundsOptions,duration:0}):r._updateViewState(o,!1)),s.isStyleLoaded()?s.fire("load"):s.once("styledata",()=>s.fire("load")),s._update(),r}_initialize(t){const{props:n}=this,{mapStyle:r=h9}=n,s={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||NGe()||null,container:t,style:m9(r)},a=s.initialViewState||s.viewState||s;if(Object.assign(s,{center:[a.longitude||0,a.latitude||0],zoom:a.zoom||0,pitch:a.pitch||0,bearing:a.bearing||0}),n.gl){const d=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=d,n.gl)}const o=new this._MapClass(s);a.padding&&o.setPadding(a.padding),n.cursor&&(o.getCanvas().style.cursor=n.cursor),this._createShadowTransform(o);const i=o._render;o._render=d=>{this._inRender=!0,i.call(o,d),this._inRender=!1};const c=o._renderTaskQueue.run;o._renderTaskQueue.run=d=>{c.call(o._renderTaskQueue,d),this._onBeforeRepaint()},o.on("render",()=>this._onAfterRepaint());const u=o.fire;o.fire=this._fireEvent.bind(this,u),o.on("resize",()=>{this._renderTransform.resize(o.transform.width,o.transform.height)}),o.on("styledata",()=>{this._updateStyleComponents(this.props,{}),u9(o.transform,this._renderTransform)}),o.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const d in g9)o.on(d,this._onPointerEvent);for(const d in C2)o.on(d,this._onCameraEvent);for(const d in y9)o.on(d,this._onEvent);this._map=o}recycle(){this.map.getContainer().querySelector("[mapboxgl-children]")?.remove(),uu.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;!this._inRender&&t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_createShadowTransform(t){const n=kGe(t.transform);t.painter.transform=n,this._renderTransform=n}_updateSize(t){const{viewState:n}=t;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(t,n){if(this._internalUpdate)return!1;const r=this._map,s=this._renderTransform,{zoom:a,pitch:o,bearing:i}=s,c=r.isMoving();c&&(s.cameraElevationReference="sea");const u=f9(s,{...d9(r.transform),...t});if(c&&(s.cameraElevationReference="ground"),u&&n){const d=this._deferredEvents;d.move=!0,d.zoom||(d.zoom=a!==s.zoom),d.rotate||(d.rotate=i!==s.bearing),d.pitch||(d.pitch=o!==s.pitch)}return c||f9(r.transform,t),u}_updateSettings(t,n){const r=this._map;let s=!1;for(const a of TGe)a in t&&!yo(t[a],n[a])&&(s=!0,r[`set${a[0].toUpperCase()}${a.slice(1)}`]?.call(r,t[a]));return s}_updateStyle(t,n){if(t.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==n.mapStyle){const{mapStyle:r=h9,styleDiffing:s=!0}=t,a={diff:s};return"localIdeographFontFamily"in t&&(a.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(m9(r),a),!0}return!1}_updateStyleComponents(t,n){const r=this._map;let s=!1;return r.isStyleLoaded()&&("light"in t&&r.setLight&&!yo(t.light,n.light)&&(s=!0,r.setLight(t.light)),"fog"in t&&r.setFog&&!yo(t.fog,n.fog)&&(s=!0,r.setFog(t.fog)),"terrain"in t&&r.setTerrain&&!yo(t.terrain,n.terrain)&&(!t.terrain||r.getSource(t.terrain.source))&&(s=!0,r.setTerrain(t.terrain))),s}_updateHandlers(t,n){const r=this._map;let s=!1;for(const a of AGe){const o=t[a]??!0,i=n[a]??!0;yo(o,i)||(s=!0,o?r[a].enable(o):r[a].disable())}return s}_queryRenderedFeatures(t){const n=this._map,r=n.transform,{interactiveLayerIds:s=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(t,{layers:s.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(t){const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const s=t.type,a=this._hoveredFeatures?.length>0,o=this._queryRenderedFeatures(t.point),i=o.length>0;!i&&a&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=o,i&&!a&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=s}else this._hoveredFeatures=null}_fireEvent(t,n,r){const s=this._map,a=s.transform,o=typeof n=="string"?n:n.type;return o==="move"&&this._updateViewState(this.props,!1),o in C2&&(typeof n=="object"&&(n.viewState=d9(a)),this._map.isMoving())?(s.transform=this._renderTransform,t.call(s,n,r),s.transform=a,s):(t.call(s,n,r),s)}_onBeforeRepaint(){const t=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&t.fire(r);this._internalUpdate=!1;const n=this._map.transform;t.transform=this._renderTransform,this._onAfterRepaint=()=>{u9(this._renderTransform,n),t.transform=n}}}uu.savedMaps=[];function NGe(){let e=null;if(typeof location<"u"){const t=/access_token=([^&\/]*)/.exec(location.search);e=t&&t[1]}try{e=e||p9.MapboxAccessToken}catch{}try{e=e||p9.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return e}const RGe=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function DGe(e){if(!e)return null;const t=e.map,n={getMap:()=>t,getCenter:()=>e.transform.center,getZoom:()=>e.transform.zoom,getBearing:()=>e.transform.bearing,getPitch:()=>e.transform.pitch,getPadding:()=>e.transform.padding,getBounds:()=>e.transform.getBounds(),project:r=>{const s=t.transform;t.transform=e.transform;const a=t.project(r);return t.transform=s,a},unproject:r=>{const s=t.transform;t.transform=e.transform;const a=t.unproject(r);return t.transform=s,a},queryTerrainElevation:(r,s)=>{const a=t.transform;t.transform=e.transform;const o=t.queryTerrainElevation(r,s);return t.transform=a,o},queryRenderedFeatures:(r,s)=>{const a=t.transform;t.transform=e.transform;const o=t.queryRenderedFeatures(r,s);return t.transform=a,o}};for(const r of IGe(t))!(r in n)&&!RGe.includes(r)&&(n[r]=t[r].bind(t));return n}function IGe(e){const t=new Set;let n=e;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof e[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&t.add(r);n=Object.getPrototypeOf(n)}return Array.from(t)}const jGe=typeof document<"u"?f.useLayoutEffect:f.useEffect,PGe=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function OGe(e,t){for(const r of PGe)r in t&&(e[r]=t[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=t;n&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"&&e.setRTLTextPlugin(n,r=>{r&&console.error(r)},!0)}const _x=f.createContext(null);function LGe(e,t){const n=f.useContext(SGe),[r,s]=f.useState(null),a=f.useRef(),{current:o}=f.useRef({mapLib:null,map:null});f.useEffect(()=>{const u=e.mapLib;let d=!0,m;return Promise.resolve(u||W(()=>import("./mapbox-gl-D_rkT3p_.js").then(p=>p.m),__vite__mapDeps([16,3,17]))).then(p=>{if(!d)return;if(!p)throw new Error("Invalid mapLib");const h="Map"in p?p:p.default;if(!h.Map)throw new Error("Invalid mapLib");if(OGe(h,e),!h.supported||h.supported(e))e.reuseMaps&&(m=uu.reuse(e,a.current)),m||(m=new uu(h.Map,e,a.current)),o.map=DGe(m),o.mapLib=h,s(m),n?.onMapMount(o.map,e.id);else throw new Error("Map is not supported by this browser")}).catch(p=>{const{onError:h}=e;h?h({type:"error",target:null,error:p}):console.error(p)}),()=>{d=!1,m&&(n?.onMapUnmount(e.id),e.reuseMaps?m.recycle():m.destroy())}},[]),jGe(()=>{r&&r.setProps(e)}),f.useImperativeHandle(t,()=>o.map,[r]);const i=f.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),c={height:"100%"};return f.createElement("div",{id:e.id,ref:a,style:i},r&&f.createElement(_x.Provider,{value:o},f.createElement("div",{"mapboxgl-children":"",style:c},e.children)))}const FGe=f.forwardRef(LGe),UGe=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function $l(e,t){if(!e||!t)return;const n=e.style;for(const r in t){const s=t[r];Number.isFinite(s)&&!UGe.test(r)?n[r]=`${s}px`:n[r]=s}}const BGe=f.memo(f.forwardRef((e,t)=>{const{map:n,mapLib:r}=f.useContext(_x),s=f.useRef({props:e});s.current.props=e;const a=f.useMemo(()=>{let y=!1;f.Children.forEach(e.children,_=>{_&&(y=!0)});const b={...e,element:y?document.createElement("div"):null},x=new r.Marker(b);return x.setLngLat([e.longitude,e.latitude]),x.getElement().addEventListener("click",_=>{s.current.props.onClick?.({type:"click",target:x,originalEvent:_})}),x.on("dragstart",_=>{const v=_;v.lngLat=a.getLngLat(),s.current.props.onDragStart?.(v)}),x.on("drag",_=>{const v=_;v.lngLat=a.getLngLat(),s.current.props.onDrag?.(v)}),x.on("dragend",_=>{const v=_;v.lngLat=a.getLngLat(),s.current.props.onDragEnd?.(v)}),x},[]);f.useEffect(()=>(a.addTo(n.getMap()),()=>{a.remove()}),[]);const{longitude:o,latitude:i,offset:c,style:u,draggable:d=!1,popup:m=null,rotation:p=0,rotationAlignment:h="auto",pitchAlignment:g="auto"}=e;return f.useEffect(()=>{$l(a.getElement(),u)},[u]),f.useImperativeHandle(t,()=>a,[]),(a.getLngLat().lng!==o||a.getLngLat().lat!==i)&&a.setLngLat([o,i]),c&&!EGe(a.getOffset(),c)&&a.setOffset(c),a.isDraggable()!==d&&a.setDraggable(d),a.getRotation()!==p&&a.setRotation(p),a.getRotationAlignment()!==h&&a.setRotationAlignment(h),a.getPitchAlignment()!==g&&a.setPitchAlignment(g),a.getPopup()!==m&&a.setPopup(m),jC.createPortal(e.children,a.getElement())}));function x9(e){return new Set(e?e.trim().split(/\s+/):[])}f.memo(f.forwardRef((e,t)=>{const{map:n,mapLib:r}=f.useContext(_x),s=f.useMemo(()=>document.createElement("div"),[]),a=f.useRef({props:e});a.current.props=e;const o=f.useMemo(()=>{const i={...e},c=new r.Popup(i);return c.setLngLat([e.longitude,e.latitude]),c.once("open",u=>{a.current.props.onOpen?.(u)}),c},[]);if(f.useEffect(()=>{const i=c=>{a.current.props.onClose?.(c)};return o.on("close",i),o.setDOMContent(s).addTo(n.getMap()),()=>{o.off("close",i),o.isOpen()&&o.remove()}},[]),f.useEffect(()=>{$l(o.getElement(),e.style)},[e.style]),f.useImperativeHandle(t,()=>o,[]),o.isOpen()&&((o.getLngLat().lng!==e.longitude||o.getLngLat().lat!==e.latitude)&&o.setLngLat([e.longitude,e.latitude]),e.offset&&!yo(o.options.offset,e.offset)&&o.setOffset(e.offset),(o.options.anchor!==e.anchor||o.options.maxWidth!==e.maxWidth)&&(o.options.anchor=e.anchor,o.setMaxWidth(e.maxWidth)),o.options.className!==e.className)){const i=x9(o.options.className),c=x9(e.className);for(const u of i)c.has(u)||o.removeClassName(u);for(const u of c)i.has(u)||o.addClassName(u);o.options.className=e.className}return jC.createPortal(e.children,s)}));function Gm(e,t,n,r){const s=f.useContext(_x),a=f.useMemo(()=>e(s),[]);return f.useEffect(()=>{const o=t,i=null,c=typeof t=="function"?t:null,{map:u}=s;return u.hasControl(a)||(u.addControl(a,o?.position),i&&i(s)),()=>{c&&c(s),u.hasControl(a)&&u.removeControl(a)}},[]),a}function HGe(e){const t=Gm(({mapLib:n})=>new n.AttributionControl(e),{position:e.position});return f.useEffect(()=>{$l(t._container,e.style)},[e.style]),null}f.memo(HGe);function VGe(e){const t=Gm(({mapLib:n})=>new n.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return f.useEffect(()=>{$l(t._controlContainer,e.style)},[e.style]),null}f.memo(VGe);function GGe(e,t){const n=f.useRef({props:e}),r=Gm(({mapLib:s})=>{const a=new s.GeolocateControl(e),o=a._setupUI.bind(a);return a._setupUI=i=>{a._container.hasChildNodes()||o(i)},a.on("geolocate",i=>{n.current.props.onGeolocate?.(i)}),a.on("error",i=>{n.current.props.onError?.(i)}),a.on("outofmaxbounds",i=>{n.current.props.onOutOfMaxBounds?.(i)}),a.on("trackuserlocationstart",i=>{n.current.props.onTrackUserLocationStart?.(i)}),a.on("trackuserlocationend",i=>{n.current.props.onTrackUserLocationEnd?.(i)}),a},{position:e.position});return n.current.props=e,f.useImperativeHandle(t,()=>r,[]),f.useEffect(()=>{$l(r._container,e.style)},[e.style]),null}f.memo(f.forwardRef(GGe));function zGe(e){const t=Gm(({mapLib:n})=>new n.NavigationControl(e),{position:e.position});return f.useEffect(()=>{$l(t._container,e.style)},[e.style]),null}const qGe=f.memo(zGe);function $Ge(e){const t=Gm(({mapLib:a})=>new a.ScaleControl(e),{position:e.position}),n=f.useRef(e),r=n.current;n.current=e;const{style:s}=e;return e.maxWidth!==void 0&&e.maxWidth!==r.maxWidth&&(t.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==r.unit&&t.setUnit(e.unit),f.useEffect(()=>{$l(t._container,s)},[s]),null}f.memo($Ge);A.memo(function(t){const{$t:n}=Q(),{isLoading:r,onClick:s,...a}=t;return l.jsx(Y,{className:"right-sm top-sm absolute z-30 rounded-full border-2",children:l.jsx(st,{pill:!0,size:"tiny",variant:"inverted",icon:D("current-location"),isLoading:r,text:n(r?{defaultMessage:"Searching...",id:"NNQzoiiDEK"}:{defaultMessage:"Search here",id:"Yi0/yIKDMQ"}),onClick:s,...a})})});const WGe=A.memo(function(){return l.jsx("svg",{className:"h-auto w-full",fill:"none",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 4635.92 708.22",children:l.jsx("path",{d:"M4806.79,746.44a25,25,0,1,0,25,25A25,25,0,0,0,4806.79,746.44Zm0,46.08a21.08,21.08,0,1,1,21.08-21.07A21.09,21.09,0,0,1,4806.79,792.52Zm8.12-25.33c0-4.55-3.25-7.25-8-7.25h-8v22.77h3.94v-8.26h4.26l4.13,8.26h4.23L4811,773.6A6.59,6.59,0,0,0,4814.91,767.19Zm-8.16,3.78h-3.87v-7.55h3.87c2.63,0,4.23,1.33,4.23,3.77S4809.38,771,4806.75,771ZM569.17,605.31a97.95,97.95,0,1,1-97.94-97.94A97.94,97.94,0,0,1,569.17,605.31Zm552.18,0a97.95,97.95,0,1,1-97.95-97.94A97.95,97.95,0,0,1,1121.35,605.31ZM1099,304.09C998.87,235.77,878,195.89,747.32,195.89a619.47,619.47,0,0,0-351,108.2H195.89l90.17,98.12a274.9,274.9,0,0,0-89.89,203.66c0,152.19,123.38,275.57,275.57,275.57A274.54,274.54,0,0,0,659,808l88.34,96.12L835.66,808a274.54,274.54,0,0,0,187.23,73.4c152.19,0,275.68-123.38,275.68-275.57a274.9,274.9,0,0,0-89.89-203.66l90.17-98.12ZM471.74,792.36c-103,0-186.49-83.49-186.49-186.49s83.5-186.49,186.49-186.49,186.5,83.49,186.5,186.49S574.74,792.36,471.74,792.36ZM747.37,600.5c0-122.73-89.26-228-207-273.06a538.15,538.15,0,0,1,413.93,0C836.62,372.49,747.37,477.78,747.37,600.5Zm462,5.37c0,103-83.5,186.49-186.49,186.49s-186.5-83.49-186.5-186.49,83.5-186.49,186.5-186.49S1209.38,502.87,1209.38,605.87Zm654.11-173.45h43.37v85.84h-50.75c-39.09,0-64.17,19.18-64.17,58.28V792.36h-92.78V432.42h92.78V492.9C1800.05,450.12,1829.56,432.42,1863.49,432.42Zm186.35-85.59a56.06,56.06,0,0,1-112.12,0c0-31.72,24.34-56.8,56.06-56.8S2049.84,315.11,2049.84,346.83Zm-102.33,85.59H2040V792.36h-92.53Zm347.35-6.08a179,179,0,0,0-109.22,36.52V432.42h-92.52V898h92.52V761.92a179,179,0,0,0,109.22,36.52c102.76,0,186-83.3,186-186.05S2397.62,426.34,2294.86,426.34Zm-8.15,287.12a101.07,101.07,0,1,1,101.07-101.07A101.07,101.07,0,0,1,2286.71,713.46Zm1890.57-34.8c0,69.4-59.54,119.78-141.57,119.78-85.12,0-144.57-51.57-144.57-125.42v-2h90.54v2c0,30.82,22,51.53,54.78,51.53,31.42,0,52.53-15.33,52.53-38.14,0-21.61-14.61-33.69-53.89-44.56l-51.71-14.1c-54.34-14.71-85.5-50.12-85.5-97.14,0-60.42,57-104.27,135.57-104.27,79.3,0,132.58,43.88,132.58,109.21v2.05h-85.3v-2.05c0-22.18-20.77-39.55-47.28-39.55-27.84,0-47.28,12.78-47.28,31.09,0,18.76,13.84,29.66,49.36,38.91l54,14.81C4162.05,600.16,4177.28,644.7,4177.28,678.66Zm-1368-215.8A179,179,0,0,0,2700,426.34c-102.76,0-186.05,83.3-186.05,186.05S2597.26,798.44,2700,798.44a179,179,0,0,0,109.22-36.52v30.44h92.52V432.42h-92.52Zm0,149.54a101.07,101.07,0,1,1-101.07-101.08A101.08,101.08,0,0,1,2809.24,612.4ZM3236,462.86a179,179,0,0,0-109.22-36.52c-102.75,0-186.05,83.3-186.05,186.05s83.3,186.05,186.05,186.05A179,179,0,0,0,3236,761.92v30.44h92.53V304.3H3236Zm-101.06,250.6A101.07,101.07,0,1,1,3236,612.39,101.07,101.07,0,0,1,3134.89,713.46Zm623.34-281h92.53V792.36h-92.53Zm102.33-85.59a56.06,56.06,0,1,1-112.12,0c0-31.72,24.34-56.8,56.06-56.8S3860.56,315.11,3860.56,346.83Zm530.71,79.51c-102.75,0-186.05,83.3-186.05,186.05s83.3,186.05,186.05,186.05,186-83.3,186-186.05S4494,426.34,4391.27,426.34Zm0,287.12a101.07,101.07,0,1,1,101.07-101.07A101.06,101.06,0,0,1,4391.27,713.46ZM1744.55,386.87H1613.14V792.36h-92.22V386.87H1389.51V304.3h355Zm1877.76,45.55h97.21L3595.31,792.36H3484L3360.47,432.42h97.2L3540,693.79Zm1162.19,0h43.37v85.84h-50.75c-39.09,0-64.18,19.18-64.18,58.28V792.36h-92.77V432.42h92.77V492.9C4721.06,450.12,4750.57,432.42,4784.5,432.42Z",transform:"translate(-195.89 -195.89)",fill:"currentColor"})})}),KGe=A.memo(function(){return l.jsxs("svg",{className:"h-auto w-full",viewBox:"0 0 1000 385",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("path",{d:"M806.495 227.151L822.764 223.392C823.106 223.313 823.671 223.183 824.361 222.96C828.85 221.753 832.697 218.849 835.091 214.862C837.485 210.874 838.241 206.113 837.198 201.582C837.175 201.482 837.153 201.388 837.13 201.289C836.596 199.117 835.66 197.065 834.37 195.239C832.547 192.926 830.291 190.991 827.728 189.542C824.711 187.82 821.553 186.358 818.289 185.171L800.452 178.659C790.441 174.937 780.432 171.309 770.328 167.771C763.776 165.439 758.224 163.393 753.4 161.901C752.49 161.62 751.485 161.34 750.669 161.058C744.837 159.271 740.739 158.53 737.272 158.505C734.956 158.42 732.649 158.841 730.511 159.738C728.283 160.699 726.282 162.119 724.639 163.906C723.822 164.835 723.054 165.806 722.337 166.815C721.665 167.843 721.049 168.907 720.491 170.001C719.876 171.174 719.348 172.391 718.911 173.642C715.6 183.428 713.951 193.7 714.032 204.029C714.091 213.368 714.342 225.354 719.475 233.479C720.712 235.564 722.372 237.366 724.348 238.769C728.004 241.294 731.7 241.627 735.544 241.904C741.289 242.316 746.855 240.905 752.403 239.623L806.45 227.135L806.495 227.151Z",fill:"currentColor"}),l.jsx("path",{d:"M987.995 140.779C983.553 131.457 977.581 122.947 970.328 115.601C969.39 114.669 968.385 113.806 967.321 113.02C966.339 112.283 965.318 111.598 964.264 110.967C963.18 110.373 962.065 109.837 960.924 109.362C958.668 108.476 956.25 108.077 953.829 108.19C951.513 108.322 949.254 108.956 947.207 110.049C944.105 111.591 940.748 114.07 936.283 118.221C935.666 118.834 934.891 119.525 934.195 120.177C930.511 123.641 926.413 127.911 921.536 132.883C914.002 140.497 906.583 148.152 899.21 155.89L886.017 169.571C883.601 172.071 881.401 174.771 879.441 177.643C877.771 180.07 876.59 182.799 875.963 185.678C875.6 187.886 875.653 190.142 876.12 192.329C876.143 192.429 876.164 192.523 876.187 192.622C877.229 197.154 879.988 201.103 883.883 203.637C887.778 206.172 892.505 207.094 897.068 206.211C897.791 206.106 898.352 205.982 898.693 205.898L969.033 189.646C974.576 188.365 980.202 187.191 985.182 184.3C988.522 182.363 991.699 180.443 993.878 176.569C995.043 174.441 995.748 172.092 995.948 169.675C997.027 160.089 992.021 149.202 987.995 140.779Z",fill:"currentColor"}),l.jsx("path",{d:"M862.1 170.358C867.197 163.955 867.184 154.41 867.64 146.607C869.174 120.536 870.79 94.4619 872.07 68.3766C872.56 58.4962 873.624 48.7498 873.036 38.7944C872.552 30.5816 872.492 21.1521 867.307 14.4122C858.154 2.52688 838.636 3.50371 825.319 5.34732C821.239 5.91358 817.153 6.6749 813.099 7.64807C809.045 8.62124 805.033 9.6841 801.108 10.9412C788.329 15.127 770.365 22.8103 767.323 37.5341C765.608 45.858 769.672 54.3727 772.824 61.9691C776.645 71.1774 781.865 79.4721 786.622 88.1401C799.198 111.024 812.008 133.765 824.782 156.53C828.597 163.326 832.755 171.933 840.135 175.454C840.623 175.667 841.121 175.856 841.628 176.018C844.937 177.272 848.545 177.513 851.993 176.712C852.201 176.664 852.405 176.617 852.608 176.57C855.792 175.704 858.675 173.973 860.937 171.568C861.345 171.185 861.734 170.782 862.1 170.358Z",fill:"currentColor"}),l.jsx("path",{d:"M855.997 240.155C854.008 237.355 851.184 235.258 847.931 234.162C844.677 233.065 841.16 233.027 837.881 234.051C837.111 234.307 836.361 234.618 835.636 234.983C834.515 235.554 833.445 236.221 832.439 236.976C829.507 239.148 827.039 241.97 824.791 244.8C824.221 245.522 823.7 246.483 823.022 247.1L811.708 262.663C805.295 271.382 798.971 280.123 792.7 289.003C788.608 294.735 785.068 299.576 782.273 303.859C781.743 304.666 781.193 305.567 780.689 306.284C777.338 311.469 775.441 315.252 774.467 318.622C773.735 320.862 773.503 323.234 773.788 325.572C774.1 328.008 774.92 330.35 776.195 332.447C776.873 333.499 777.604 334.516 778.385 335.495C779.196 336.436 780.058 337.332 780.966 338.18C781.936 339.105 782.973 339.957 784.07 340.729C791.879 346.162 800.428 350.066 809.421 353.083C816.904 355.567 824.682 357.053 832.555 357.504C833.894 357.572 835.237 357.543 836.572 357.417C837.809 357.309 839.04 357.136 840.26 356.9C841.479 356.615 842.681 356.266 843.863 355.853C846.162 354.993 848.255 353.66 850.008 351.94C851.667 350.279 852.944 348.276 853.749 346.07C855.057 342.81 855.917 338.671 856.483 332.526C856.532 331.652 856.657 330.604 856.744 329.644C857.19 324.545 857.395 318.556 857.723 311.514C858.276 300.685 858.71 289.903 859.053 279.09C859.053 279.09 859.782 259.875 859.78 259.865C859.946 255.437 859.81 250.53 858.582 246.121C858.042 244.008 857.17 241.994 855.997 240.155V240.155Z",fill:"currentColor"}),l.jsx("path",{d:"M983.707 270.24C981.346 267.651 978 265.069 972.722 261.878C971.961 261.453 971.068 260.886 970.244 260.392C965.85 257.749 960.557 254.969 954.374 251.611C944.876 246.396 935.372 241.312 925.778 236.271L908.825 227.28C907.946 227.024 907.053 226.389 906.225 225.989C902.968 224.432 899.516 222.978 895.932 222.311C894.697 222.074 893.444 221.944 892.186 221.923C891.375 221.913 890.565 221.962 889.761 222.07C886.371 222.595 883.234 224.178 880.795 226.591C878.356 229.005 876.74 232.128 876.178 235.513C875.919 237.667 875.998 239.847 876.411 241.976C877.24 246.487 879.254 250.95 881.338 254.858L890.391 271.824C895.428 281.394 900.526 290.907 905.752 300.391C909.123 306.578 911.929 311.871 914.557 316.26C915.055 317.085 915.62 317.974 916.046 318.738C919.245 324.013 921.815 327.333 924.421 329.715C926.109 331.345 928.132 332.586 930.349 333.351C932.68 334.124 935.146 334.398 937.59 334.155C938.832 334.008 940.066 333.795 941.286 333.516C942.488 333.193 943.672 332.808 944.833 332.362C946.087 331.889 947.305 331.327 948.478 330.678C955.36 326.82 961.703 322.07 967.345 316.552C974.112 309.894 980.093 302.633 984.745 294.321C985.392 293.145 985.952 291.924 986.422 290.667C986.86 289.504 987.24 288.319 987.558 287.118C987.834 285.896 988.045 284.662 988.191 283.418C988.422 280.977 988.138 278.514 987.358 276.19C986.591 273.963 985.345 271.932 983.707 270.24V270.24Z",fill:"currentColor"}),l.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M400.03 105.19C400.03 91.2089 411.42 79.7877 425.167 79.7877C438.717 79.7877 449.714 91.2089 450.303 105.387V303.682C450.303 317.663 438.913 329.084 425.167 329.084C411.027 329.084 400.03 317.663 400.03 303.682V105.19ZM376.657 227.672C376.461 231.61 375.479 238.896 370.373 244.213C364.874 249.923 357.412 251.302 353.092 251.302C335.123 251.4 317.155 251.45 299.187 251.499C281.218 251.548 263.248 251.597 245.279 251.696C246.85 256.619 249.992 264.101 257.062 270.994C261.382 275.129 265.506 277.492 267.273 278.476C269.434 279.855 276.896 283.793 286.126 283.793C295.945 283.793 304.586 280.642 313.03 276.31L313.736 275.945C319.604 272.904 325.66 269.766 332.079 268.631C338.363 267.646 345.04 268.827 349.949 273.16C355.841 278.279 358.197 285.762 356.037 293.442C353.484 302.106 346.218 309.589 338.559 314.118C334.239 316.678 329.526 318.844 324.813 320.617C318.725 322.783 312.441 324.358 306.157 325.343C299.872 326.327 293.392 326.721 286.911 326.524H286.911C283.769 326.524 280.431 326.524 277.092 326.13C273.558 325.736 270.023 324.949 266.684 324.161C261.186 322.98 256.08 321.207 250.974 318.844C246.064 316.678 241.155 313.921 236.638 310.771C232.121 307.62 227.997 303.879 224.07 299.94C220.338 296.002 216.804 291.67 213.662 286.944C203.057 270.797 198.147 250.908 199.129 231.61C199.915 212.706 206.199 193.802 217.589 178.443C218.823 176.519 220.247 174.883 221.596 173.333C222.18 172.663 222.75 172.008 223.284 171.354C237.35 154.158 256.142 148.716 263.894 146.471L264.328 146.345C286.519 140.044 304.978 144.179 312.441 146.345C316.172 147.33 337.185 153.828 353.484 171.354C354.27 172.141 356.43 174.701 359.179 178.443C369.505 192.508 373.066 205.605 374.272 210.042L374.301 210.146C375.479 214.478 376.657 220.386 376.657 227.672ZM261.382 195.181C249.992 204.436 246.85 216.251 246.064 219.992H331.686C330.901 216.448 327.562 204.436 316.172 195.181C304.586 185.925 292.41 185.335 288.679 185.335C284.948 185.335 272.772 185.925 261.382 195.181ZM586.98 142.998C564.593 142.998 544.169 153.041 529.637 169.385V168.794C529.048 155.6 518.05 144.967 504.696 144.967C490.753 144.967 479.56 156.191 479.56 170.172V359.409C479.56 373.391 490.753 384.615 504.696 384.615C518.64 384.615 529.833 373.391 529.833 359.409V352.123V300.334C544.365 316.482 564.593 326.721 587.176 326.721C632.147 326.721 668.674 285.959 668.674 235.155C668.478 184.35 631.951 142.998 586.98 142.998ZM575.983 285.566C550.453 285.566 529.637 263.314 529.637 235.549C529.637 207.586 550.257 185.335 575.983 185.335C601.512 185.335 622.328 207.586 622.328 235.549C622.132 263.314 601.512 285.566 575.983 285.566ZM161.425 248.348L153.177 266.464C149.446 274.341 145.715 282.415 142.18 290.488C141.052 292.966 139.916 295.494 138.764 298.057C123.068 332.981 104.44 374.43 63.8242 383.236C44.1861 387.568 14.5327 381.661 3.5354 363.15C-7.4619 344.443 8.83767 322.979 29.8504 327.902C33.1646 328.641 36.4235 330.266 39.7101 331.904C45.187 334.635 50.7406 337.404 56.7545 336.173C62.4495 335.188 65.9844 331.053 70.5011 325.736C76.7853 318.45 79.5346 310.771 80.7129 306.242C80.6147 306.045 80.5165 305.798 80.4183 305.552C80.3201 305.306 80.2219 305.06 80.1237 304.863C75.0117 295.326 70.5473 286.8 66.8178 279.677C64.3868 275.034 62.2681 270.987 60.4857 267.646C56.8287 260.714 54.0662 255.473 51.918 251.398C45.6449 239.497 44.609 237.532 41.8296 232.398C35.7418 220.78 29.2612 209.555 22.5843 198.331C15.3182 186.122 7.85577 172.535 13.9436 158.16C18.8531 146.542 31.4214 140.634 43.4006 144.376C56.0403 148.212 61.6377 160.239 66.8724 171.487C67.8188 173.52 68.7534 175.528 69.7156 177.458C78.16 194.196 86.4079 210.934 94.6559 227.672C95.382 229.336 96.4917 231.605 97.8402 234.362C99.0447 236.824 100.44 239.676 101.922 242.834C102.697 244.475 103.434 246.002 104.101 247.382C104.954 249.149 105.691 250.676 106.242 251.892C110.072 242.342 113.95 232.841 117.829 223.34C121.707 213.839 125.586 204.337 129.415 194.787C129.522 194.253 130.436 192.216 131.813 189.145C132.977 186.549 134.473 183.215 136.092 179.427C136.64 178.133 137.191 176.79 137.755 175.417C142.856 162.995 148.988 148.06 162.604 143.982C172.423 141.028 183.42 144.967 189.115 153.237C192.061 157.372 193.239 162.098 193.435 166.824C193.593 177.275 188.545 188.491 184.212 198.115C183.157 200.459 182.144 202.708 181.26 204.829C181.219 204.91 181.048 205.296 180.739 205.988C179.541 208.679 176.278 216.005 170.655 228.066C168.626 232.389 166.679 236.713 164.707 241.09C163.626 243.491 162.538 245.907 161.425 248.348Z",fill:"currentColor"}),l.jsx("path",{d:"M687.728 310.153H689.549C690.447 310.153 691.167 309.923 691.706 309.462C692.256 308.99 692.532 308.395 692.532 307.676C692.532 306.833 692.29 306.232 691.807 305.872C691.324 305.502 690.56 305.316 689.515 305.316H687.728V310.153ZM695.043 307.608C695.043 308.507 694.801 309.305 694.318 310.002C693.846 310.687 693.178 311.198 692.313 311.535L696.324 318.193H693.492L690.004 312.226H687.728V318.193H685.234V303.176H689.633C691.498 303.176 692.863 303.541 693.728 304.271C694.605 305.002 695.043 306.114 695.043 307.608ZM677.228 310.676C677.228 308.429 677.79 306.322 678.914 304.356C680.037 302.389 681.582 300.839 683.549 299.704C685.515 298.569 687.633 298.002 689.902 298.002C692.15 298.002 694.256 298.564 696.223 299.687C698.189 300.811 699.74 302.356 700.874 304.322C702.009 306.288 702.577 308.406 702.577 310.676C702.577 312.889 702.032 314.968 700.942 316.912C699.852 318.856 698.324 320.412 696.358 321.58C694.391 322.749 692.24 323.333 689.902 323.333C687.577 323.333 685.431 322.754 683.464 321.597C681.498 320.429 679.964 318.872 678.863 316.929C677.773 314.985 677.228 312.901 677.228 310.676ZM678.998 310.676C678.998 312.62 679.487 314.44 680.464 316.136C681.442 317.822 682.773 319.153 684.459 320.131C686.155 321.097 687.97 321.58 689.902 321.58C691.858 321.58 693.672 321.092 695.346 320.114C697.02 319.136 698.346 317.816 699.324 316.153C700.313 314.479 700.807 312.653 700.807 310.676C700.807 308.721 700.318 306.906 699.341 305.232C698.363 303.558 697.037 302.232 695.363 301.255C693.7 300.266 691.88 299.771 689.902 299.771C687.947 299.771 686.133 300.26 684.459 301.238C682.785 302.215 681.453 303.541 680.464 305.215C679.487 306.878 678.998 308.698 678.998 310.676Z",fill:"currentColor"})]})}),YGe=({className:e})=>l.jsx(B,{className:z("w-10",e),children:l.jsx(KGe,{})}),QGe=({className:e})=>l.jsx(B,{className:z("w-[70px]",e),children:l.jsx(WGe,{})}),Iz=e=>{const t=f.useMemo(()=>Va(e).with($i.string.includes("yelp.com"),()=>YGe).with($i.string.includes("tripadvisor.com"),()=>QGe).otherwise(()=>null),[e]);return f.useMemo(()=>({SearchClientLogo:t}),[t])},XGe=A.memo(function({day:t,hours:n}){return l.jsxs("div",{className:"gap-xs flex items-center",children:[l.jsx(B,{variant:"tiny",children:t}),l.jsx(Y,{className:"h-one grow",variant:"subtler"}),l.jsx(B,{variant:"tiny",color:"light",children:n})]})});function w2(e,t,n,r=0){return e*24*3600+t*3600+n*60+r}function b9(e,t,n){const r=new Date(Date.UTC(2e3,0,1,e,t,0));return t===0?new Intl.DateTimeFormat(n,{hour:"numeric",timeZone:"UTC"}).format(r):new Intl.DateTimeFormat(n,{hour:"numeric",minute:"numeric",timeZone:"UTC"}).format(r)}function w5(e,t,n){const{locale:r,$t:s}=Q(),[a,o]=f.useState([]);return f.useEffect(()=>{if(!e||e.length===0)return o([]),()=>{};const i=()=>{const d=Date.now(),m=I2(d,t),p=(m.weekday+6)%7,h=w2(p,m.hour,m.minute,m.second),g=[];for(const v of e){const C=v.open.weekday_idx,w=v.open.hour,S=v.open.minute,E=v.close.weekday_idx,T=v.close.hour,k=v.close.minute;let M=w2(C,w,S),N=w2(E,T,k);N<=M&&(N+=168*3600),p===v.close.weekday_idx&&v.open.weekday_idx!==v.close.weekday_idx&&(M-=168*3600,N-=168*3600),g.push({openWeekday:C,openHour:w,openMinute:S,closeWeekday:E,closeHour:T,closeMinute:k,openSeconds:M,closeSeconds:N})}g.sort((v,C)=>v.openWeekday!==C.openWeekday?v.openWeekday-C.openWeekday:v.openSeconds-C.openSeconds);const y=[];for(let v=0;v<7;v++){const w=(v-p+7)%7*24*60*60*1e3,S=new Date(d+w);y.push({day:Intl.DateTimeFormat(r,{weekday:n,timeZone:t}).format(S),isToday:v===p,hours:[],joinedHours:s({defaultMessage:"Closed",id:"Fv1ZSzMOV6"})})}let b=null;for(const v of g){const C=y[v.openWeekday],w=b9(v.openHour,v.openMinute,r),S=b9(v.closeHour,v.closeMinute,r),E=w===S?s({defaultMessage:"Open 24 hours",id:"mdcm71ltJq"}):`${w} - ${S}`,T=v.openWeekday===p&&h>=v.openSeconds&&h<v.closeSeconds;if(C.hours.push({open:w,close:S,openCloseString:E,isOpenNow:T}),v.openSeconds>h){const k=v.openSeconds-h;(b===null||k<b)&&(b=k)}if(v.closeSeconds>h){const k=v.closeSeconds-h;(b===null||k<b)&&(b=k)}}const _=(p+1)*24*3600-h;_>0&&(b===null||_<b)&&(b=_);for(const v of y)v.hours.length>0&&(v.joinedHours=v.hours.map(C=>C.openCloseString).join(", "));return o(v=>Ff(v,y)?v:y),b!==null?b*1e3:null},c=()=>{const d=i();if(d!==null&&d>0){const m=Math.min(d,864e5);return setTimeout(c,m)}else return setTimeout(c,1440*60*1e3)},u=c();return()=>clearTimeout(u)},[e,t,r,n,s]),a}const ZGe=A.memo(function({hours:t,timezone:n}){const[r,s]=f.useState(!1),a=f.useCallback(()=>{s(d=>!d)},[]),o=w5(t,n,"long"),i=o.find(d=>d.isToday===!0),c=i?.hours.some(d=>d.isOpenNow)??!1,{$t:u}=Q();return l.jsxs(Y,{children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"gap-x-sm flex items-center",children:[c!=null&&l.jsx(Y,{variant:c?"super":"red",className:"px-sm py-xs rounded",children:l.jsx(B,{variant:"tiny",color:"defaultInverted",children:u(c?{defaultMessage:"Open now",id:"AbmghRJVfD"}:{defaultMessage:"Closed",id:"Fv1ZSzMOV6"})})}),i!==void 0&&l.jsxs(B,{variant:"tiny",className:"block",children:[i.joinedHours," today"]})]}),l.jsx(pt,{size:"tiny",text:u({defaultMessage:"More",id:"I5NMJ8llIi"}),onClick:a,chevron:!0,chevronIcon:r?D("chevron-up"):D("chevron-down")})]}),r&&l.jsx("div",{className:"my-sm gap-xs flex flex-col",children:o.map((d,m)=>l.jsx(XGe,{day:d.day,hours:d.joinedHours},m))})]})}),JGe=A.memo(function({className:t,title:n,url:r,subtitle:s,imageUrl:a,withImagePlaceholder:o,clickable:i,withinContent:c,bgHover:u,variant:d,...m}){return l.jsxs(Y,{variant:c?"subtler":d,bgHover:i?c?"subtle":"subtler":u,className:z("gap-x-md p-sm flex rounded-lg",{"cursor-pointer":i},t),...m,children:[a&&l.jsx("div",{className:"size-20 flex-none overflow-hidden",children:l.jsx(to,{alt:"title",hasShadow:!1,includeLightBoxModal:!1,containerClassName:"size-20",imageClassName:"object-cover w-full h-full",maskClassName:"size-20 flex items-center justify-center",rounded:"md",src:a})}),!a&&o&&l.jsx("div",{className:"size-20 flex-none overflow-hidden",children:l.jsx("div",{className:"bg-subtler flex size-20 items-center justify-center rounded-md"})}),l.jsxs("div",{className:"-mt-xs flex grow flex-col justify-center",children:[l.jsxs("div",{className:"gap-x-sm flex justify-between",children:[l.jsx(B,{lineClamp:1,className:"whitespace-normal break-words capitalize leading-8",variant:"smallBold",children:n}),r&&l.jsx(B,{variant:"small",color:"light",className:"mr-xs",children:l.jsx(ye,{icon:D("external-link"),size:"md"})})]}),s]})]})}),eze=4,zg=A.memo(function({priceSymbols:t,priceRange:n,className:r="",dollarColor:s="default",textVariant:a="tiny",currencySymbol:o,...i}){const c=n&&/^(.+?)\s*(\1\s*)+$/.test(n.trim());let u=0;return c?u=n.replace(/\u200A/g,"").length:t&&(u=t.replace(/\u200A/g,"").length),l.jsx("div",{className:`flex items-center ${r}`,...i,children:n&&!c?l.jsx(B,{variant:a,color:s,children:n}):l.jsx("div",{className:"flex gap-px",children:Array.from({length:eze},(d,m)=>l.jsx(B,{variant:a,className:"inline-flex",color:m<u?s:"ultraLight",children:o||"$"},m))})})}),tze=5,nze=A.memo(function({starCount:t,testId:n}){return l.jsxs("div",{className:"flex items-center","data-test-id":n,children:[Array.from({length:tze},(r,s)=>{const a=t>s&&s>=Math.floor(t);return l.jsxs("div",{className:"relative",children:[l.jsx(B,{variant:"tiny",color:s<t?"default":"ultraLight",children:l.jsx(ye,{icon:a?D("star-half"):D("star"),size:"xs"},s)}),a&&l.jsx(B,{variant:"tiny",color:"ultraLight",className:"absolute left-0 top-0",children:l.jsx(ye,{icon:D("star"),size:"xs"},s)})]},s)}),l.jsx(B,{className:"ml-xs",variant:"tiny",children:t})]})}),rze=A.memo(function({location:t,withImagePlaceholder:n,onClick:r,onMouseEnter:s,onMouseLeave:a,SearchClientLogo:o}){const i=o&&!!t.price,c=f.useMemo(()=>l.jsxs("div",{children:[l.jsxs("div",{className:"gap-xs flex items-center",children:[t.rating&&l.jsx(nze,{starCount:t.rating}),t.num_reviews&&l.jsxs(B,{lineClamp:1,color:"light",variant:"tiny",children:["  ",OW(t.num_reviews)," reviews"]})]}),l.jsxs("div",{className:"mt-sm gap-sm flex items-center",children:[o&&l.jsx(o,{className:"-mt-two"}),i&&l.jsx(B,{color:"light",variant:"tiny",children:"  "}),(t.price||t.price_range)&&l.jsx("div",{className:"gap-sm line-clamp-1 flex items-center",children:l.jsx(zg,{priceSymbols:t.price,priceRange:t.price_range})})]})]}),[o,t.num_reviews,t.price,t.price_range,t.rating,i]);return l.jsx(Y,{onClick:r,children:l.jsx(JGe,{title:t.name??"",clickable:r!==void 0,onMouseEnter:s,onMouseLeave:a,imageUrl:t.image_url??void 0,withImagePlaceholder:n,subtitle:c})})}),jz=A.memo(function({showPulse:t=!1,style:n="default"}){return l.jsxs("div",{className:"relative size-[12px]",children:[l.jsx("div",{className:z("bg-super relative z-[1] size-[12px] rounded-full shadow-[0_1px_6px_rgba(0,0,0,0.25)] transition-all duration-150 dark:shadow-[0_1px_4px_rgba(0,0,0,0.5)]",{"bg-white shadow-[0_1px_6px_rgba(0,0,0,0.35),0_0_0_1px_rgba(0,0,0,0.05)]":n==="recede"})}),t&&l.jsx(ze.div,{className:"bg-super pointer-events-none absolute left-0 top-0 size-[12px] rounded-full",initial:{scale:1,opacity:.75},animate:{scale:[1,2.5],opacity:[.75,0]},transition:{duration:1.5,ease:[0,0,.2,1],repeat:1/0,repeatType:"loop",repeatDelay:.01}})]})}),sze=A.memo(function({isContentCardOpen:t,location:n,selectedLocation:r,onClick:s,onClose:a,isHighlighted:o=!1,isSelected:i=!1,setHighlightedLocation:c,deemphasize:u=!1,setOffset:d,showRating:m=!1}){const{SearchClientLogo:p}=Iz(n.url),h=n.description,g=n.attributes?.ambience,y=g&&Object.keys(g).find(O=>g[O]===!0),{isMobileStyle:b}=Be(),x=6,_=n.categories?.slice(0,x),v=n.categories?.slice(x),[C,w]=f.useState(!1),S=n.address?.join(", "),E=360,[T,k]=f.useState(null);f.useEffect(()=>{T&&i&&d(T)},[i,T,d]);const M=f.useCallback(()=>w(!0),[w]),N=f.useMemo(()=>l.jsxs("div",{children:[l.jsx(Dt,{href:n.url??"#",target:"_blank",children:l.jsx(rze,{location:n,SearchClientLogo:p})}),(S||n.phone||n.entity_url)&&l.jsxs(Y,{className:"mx-sm py-sm mt-xs gap-sm flex flex-col border-t",children:[S&&l.jsx(S2,{icon:D("map-pin"),label:S,href:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(S)}`,showCopyButton:!0}),n.phone&&l.jsx(S2,{icon:D("device-mobile"),label:n.phone,href:`tel:${n.phone}`,showCopyButton:!0}),n.entity_url&&l.jsx(S2,{icon:D("world"),label:s$(fN(n.entity_url)),href:n.entity_url})]}),h&&l.jsx(Y,{className:"mx-sm gap-sm py-sm flex flex-wrap border-t",children:l.jsx(B,{lineClamp:3,variant:"small",children:h})}),!!n.standardized_hours?.length&&l.jsx(Y,{className:"mx-sm py-sm scrollbar-subtle max-h-[120px] overflow-auto border-t",children:l.jsx(ZGe,{hours:n.standardized_hours,timezone:n.timezone??""})}),(y||n.categories)&&l.jsxs(Y,{className:"mx-sm gap-xs py-sm flex flex-wrap border-t",children:[y&&l.jsx(ah,{text:y}),_?.map((O,L)=>l.jsx(ah,{text:O},L)),!C&&v&&v.length>0&&l.jsx(ah,{text:`+${v.length}`,onClick:M}),C&&v?.map((O,L)=>l.jsx(ah,{text:O},L))]})]}),[S,h,_,n,M,v,C,y,p]),P=f.useMemo(()=>({zIndex:i||o?10:0}),[o,i]);return l.jsxs(l.Fragment,{children:[T?null:l.jsx("div",{ref:O=>{O&&k(O.offsetHeight)},className:"pointer-events-none invisible absolute left-[10vw] top-[10vh]",style:{width:E},children:N}),l.jsx(BGe,{longitude:n.lng??0,latitude:n.lat??0,anchor:"bottom",onClick:s,style:P,children:l.jsx(h5,{isMobileStyle:b,canOutsideClickClose:!0,isOpen:t,placement:"bottom",removeScroll:!1,onClose:a,contentWidth:E,content:N,children:l.jsxs(B,{variant:"tiny",className:z("group pointer-events-none relative flex cursor-pointer flex-col items-center",{"z-[10]":o||t}),children:[l.jsx(ze.div,{animate:{opacity:i||o?1:0},transition:ui,className:z("bg-super px-sm py-xs text-light pointer-events-none absolute left-1/2 top-[-20px] -translate-x-1/2 whitespace-nowrap rounded-full shadow-sm group-hover:shadow-md dark:text-black",{}),children:n.name}),l.jsx("div",{onMouseEnter:()=>{c&&!i&&!r&&c(n)},onMouseLeave:()=>{c&&!i&&c(null)},className:"pointer-events-auto block",children:m&&n.rating?l.jsx(aze,{rating:n.rating,isSelected:i,isHighlighted:o,deemphasize:u}):l.jsx("div",{className:"p-sm rounded-full",children:l.jsx(jz,{style:u?"recede":"default",showPulse:i||o})})})]})})})]})}),ah=A.memo(function({text:t,onClick:n}){return l.jsx(Y,{className:z("py-xs px-sm rounded border",{"cursor-pointer":n}),onClick:n,as:n?"button":"div",bgHover:n?"subtle":void 0,children:l.jsx(B,{variant:"tiny",color:"light",children:t})})}),aze=A.memo(function({rating:t,isSelected:n,isHighlighted:r,deemphasize:s}){return l.jsx(ze.div,{animate:{scale:n||r?1.1:1,opacity:s?.6:1},transition:{type:"spring",bounce:.2,duration:.28},className:"relative",children:l.jsxs("div",{className:z("bg-super mt-sm px-sm py-xs font-sans text-light relative rounded-xl text-xs font-medium shadow-sm group-hover:shadow-md dark:text-black",{"shadow-md":n||r}),children:[t.toFixed(1),l.jsx("div",{className:"border-t-super absolute left-1/2 top-full -translate-x-1/2 -translate-y-px border-x-4 border-t-[5px] border-x-transparent"})]})})}),S2=A.memo(function({icon:t,label:n,href:r,showCopyButton:s=!1}){const{$t:a}=Q(),{session:o}=je(),{trackEvent:i}=Ze(o),c=f.useCallback(m=>{m.stopPropagation(),i("place link clicked",{link:r})},[i,r]),u=f.useCallback(()=>{navigator.clipboard.writeText(n),i("place link copied",{link:r})},[n,i,r]),d=a({defaultMessage:"Copy",id:"4l6vz1/eZ5"});return l.jsxs("div",{className:"gap-sm group/all flex items-start",children:[l.jsx(Dt,{href:r,target:"_blank",className:"group flex-1 cursor-pointer",onClick:c,children:l.jsxs(B,{variant:"small",color:"default",className:"gap-sm group-hover:text-super flex items-start text-balance transition-colors duration-200",children:[l.jsx(ye,{icon:t,size:"sm",className:"top-two relative shrink-0"}),n]})}),s&&l.jsx(B,{variant:"small",color:"default",className:"-mr-xs flex h-[1lh] items-center",children:l.jsx(pt,{icon:D("copy"),onClick:u,size:"small",toolTip:d,clickFeedback:!0,pill:!0})})]})});function Pz(e){return{lat:e.lat??0,lng:e.lng??0,name:e.name??"",description:e.description??"",image_url:e.image_url??"",price:e.price??"",rating:e.rating??0,num_reviews:e.num_reviews??0,url:e.url??"",attributes:e.attributes,categories:e.categories,operating_hours:e.operating_hours??[],is_open:e.is_open??!1,map_boundary_buffer:0,price_range:e.price_range??"",canonical_page_path:e.canonical_page_path??"",address:e.address??[],phone:e.phone??"",entity_url:e.entity_url??"",timezone:e.timezone??"",standardized_hours:e.standardized_hours??[]}}const oze=({reason:e})=>{const t=Mi(),n=f.useCallback(async({entryUUID:r,lat_lng:s})=>{const{data:a,error:o,response:i}=await ve.POST("/rest/entry/map/search-map-locations",e,{body:{lat:s.latitude,lng:s.longitude,read_write_token:t,entry_uuid:r},timeoutMs:hs.HIGH});if(o)throw new Ue("API_CLIENTS_ERROR",{cause:o,status:i.status??0});return a?a.places.map(Pz):[]},[t,e]);return f.useMemo(()=>({searchForAdditionalLocations:n}),[n])},ize="pk.eyJ1Ijoiam9obm55cHBseCIsImEiOiJjbHBraWpwcnUwMHNzMmtwbWZyOTIyZnpxIn0.0I0RSAHhYftVDM6cLnj1wg",lze="mapbox://styles/johnnypplx/clps6e1xy015c01qt2u79a96f",cze="mapbox://styles/johnnypplx/clpmzsapf00zy01po5t7ge9zd",_9=16,v9=17,oh=6,uze=A.memo(function({entryUUID:t,contextUUID:n,selectedLocation:r,setSelectedLocation:s,selectedLocationFocused:a=!0,setSelectedLocationFocused:o,highlightedLocation:i,setHighlightedLocation:c,setRenderedLocations:u,searchByLocationOverride:d,locations:m,navControlPosition:p="bottom-right",showNavControl:h=!0,showRating:g=!1,answerMode:y}){const b="perplexity-map",x=f.useRef(null),[_,v]=f.useState(!1),[C,w]=f.useState(!1),[S,E]=f.useState(!1),[T,k]=f.useState(null),{colorScheme:M}=Cs(),{searchForAdditionalLocations:N}=oze({reason:b}),P=m[0]?.map_boundary_buffer??0,O=m.map(de=>de.lat??0),L=m.map(de=>de.lng??0),H=Math.min(...O)-P,R=Math.max(...O)+P,I=Math.min(...L)-P,F=Math.max(...L)+P,G=()=>{s(null),v(!1)},j=f.useCallback(()=>{x.current&&x.current.fitBounds([[I,H],[F,R]],{duration:500,padding:50,maxZoom:v9})},[I,H,F,R]);f.useEffect(()=>{if(r!=null&&T!=null&&a){const de=r.lng??0,oe=r.lat??0;x.current.getCenter().lng.toFixed(oh)==de.toFixed(oh)&&x.current.getCenter().lat.toFixed(oh)==oe.toFixed(oh)&&x.current.getZoom()==_9?v(!0):(x.current.flyTo({center:[de,oe],padding:{bottom:T},zoom:_9,duration:500}),w(!0))}},[r,a,T]),f.useEffect(()=>{if(!x.current||!i)return;const de=x.current.getBounds();if(!de)return;de.contains([i.lng??0,i.lat??0])||j()},[i,H,R,I,F,j]),f.useEffect(()=>{r?o?.(!0):j()},[r,j,o]);const $=f.useMemo(()=>m.map((de,oe)=>l.jsx(dze,{location:de,highlightedLocation:i??null,selectedLocation:r,showContentCard:_,contextUUID:n,entryUUID:t,isFlying:C,setHighlightedLocation:c,setSelectedLocation:s,setShowContentCard:v,setOffset:k,showRating:g,answerMode:y},`marker-${oe}`)),[m,i,r,_,n,t,C,c,s,g,y]);f.useCallback(async()=>{if(x.current){E(!0);try{const de=d?await d({latLng:{latitude:x.current.getCenter().lat,longitude:x.current.getCenter().lng}}):await N({entryUUID:t,lat_lng:{latitude:x.current.getCenter().lat,longitude:x.current.getCenter().lng}});de&&de.length>0&&u(de)}catch(de){Z.error("Error searching for additional locations:",de)}finally{E(!1)}}},[N,t,u,E,d]);const q=f.useMemo(()=>({bounds:[[I,H],[F,R]],fitBoundsOptions:{maxZoom:v9,padding:50}}),[R,F,H,I]),U=f.useCallback(()=>v(!1),[]),X=f.useCallback(()=>o?.(!1),[o]),J=f.useCallback(()=>{C?(v(!0),w(!1)):s(null)},[C,s]),ne=f.useMemo(()=>({name:"mercator"}),[]),ae=f.useCallback(de=>{de?.target?.resize?.()},[]);return l.jsxs(Y,{variant:"subtler",className:"relative flex size-full overflow-hidden rounded-xl",children:[!1,l.jsxs(FGe,{ref:x,mapboxAccessToken:ize,initialViewState:q,onClick:G,doubleClickZoom:!1,mapStyle:M==="dark"?lze:cze,attributionControl:!1,logoPosition:"top-left",onMoveStart:U,onDragStart:X,onZoomEnd:J,projection:ne,onRender:ae,children:[$,h&&l.jsx(qGe,{position:p,showCompass:!1,showZoom:!0})]})]})}),dze=A.memo(function({location:t,highlightedLocation:n,selectedLocation:r,showContentCard:s,contextUUID:a,entryUUID:o,isFlying:i,setHighlightedLocation:c,setSelectedLocation:u,setShowContentCard:d,setOffset:m,showRating:p,answerMode:h}){const{session:g}=je(),{trackEvent:y}=Ze(g),b=f.useCallback(()=>{!i&&t!=r&&(y("map marker clicked",{entryUUID:o,contextUUID:a,itemID:t.url,answerMode:h}),d(!1),u(t),c&&c(null))},[i,t,r,y,o,a,d,u,c,h]),x=f.useCallback(()=>{u(null),d(!1)},[u,d]);return l.jsx(sze,{isContentCardOpen:s&&r?.url===t.url,location:t,onClick:b,onClose:x,isHighlighted:n?.url===t.url,isSelected:r?.url===t.url,setHighlightedLocation:c,selectedLocation:r,setOffset:m,deemphasize:n!==null&&n?.url!==t.url,showRating:p})}),Oz=Bt("ImageCarouselContext",{images:[],onImageClick:()=>{},handleNext:()=>{},handlePrevious:()=>{},currentIndex:0,showControls:!1,direction:1,totalVisibleCarousels:0,setTotalVisibleCarousels:()=>{},fillMode:"cover",useCurrentIndex:()=>0}),C9=A.memo(function({images:t,showControls:n,onImageClick:r,children:s,fillMode:a="cover"}){const[o,i]=f.useState(0),[c,u]=f.useState(1),[d,m]=f.useState(0);f.useEffect(()=>{i(0)},[t.length]);const p=f.useCallback(()=>{i(v=>v+1>=t.length?0:v+1),u(1)},[i,t.length]),h=f.useCallback(()=>{i(v=>v==0?t.length-1:v-1),u(-1)},[i,t.length]),g=f.useCallback(v=>{m(v),b(Date.now())},[]),[y,b]=f.useState(),x=f.useCallback(v=>!v.current||y===void 0?-1:fze(v.current),[y]),_=f.useMemo(()=>({images:t,onImageClick:r,handleNext:p,handlePrevious:h,currentIndex:o,showControls:n,direction:c,totalVisibleCarousels:d,setTotalVisibleCarousels:g,fillMode:a,useCurrentIndex:x}),[t,o,n,c,d,p,h,g,r,a,x]);return l.jsx(Oz.Provider,{value:_,children:l.jsx("div",{"data-paged-carousel":"parent",children:s})})}),fze=e=>{const t=e.closest('[data-paged-carousel="parent"]');if(!t)return-1;const n=t.querySelectorAll('[data-paged-carousel="child"]');return Array.from(n).filter(s=>{const a=s.getBoundingClientRect();return a.width>0&&a.height>0}).indexOf(e)},E2=A.memo(function({className:t}){const{images:n,onImageClick:r,handleNext:s,handlePrevious:a,currentIndex:o,showControls:i,direction:c,totalVisibleCarousels:u,setTotalVisibleCarousels:d,fillMode:m,useCurrentIndex:p}=f.useContext(Oz),h=f.useRef(null),g=p(h),[y,{width:b,height:x}]=Ni(),_=b>0&&x>0;f.useEffect(()=>{if(_)return d(N=>N+1),()=>d(N=>N-1)},[d,_]);const[v,C]=f.useState(!1),{isMobileUserAgent:w}=Be(),S=f.useMemo(()=>{const N=o+g;return N>=n.length?N%n.length:N},[g,o,n.length]),E=f.useCallback(()=>{r?.(S)},[S,r]),T={hiddenEnter:N=>({x:N===1?"100%":"-100%"}),hiddenExit:N=>({x:N===1?"-100%":"100%"}),visible:{x:0}};f.useEffect(()=>{const N=()=>{const P=(S+1)%n.length,O=S===0?n.length-1:S-1,L=new Image,H=new Image,R=n[P],I=n[O];R&&(L.src=R),I&&(H.src=I)};n.length>1&&N()},[S,n]);const k=n.length>1&&g===0,M=n.length>1&&g+1==u;return n.length?l.jsxs("div",{ref:h,"data-paged-carousel":"child",onMouseEnter:()=>C(!0),onMouseLeave:()=>C(!1),className:z("group relative size-full",t),children:[l.jsx("div",{ref:y,className:"size-full cursor-pointer overflow-hidden",onClick:E,children:g===-1?null:l.jsx(Wt,{initial:!1,custom:c,children:l.jsx(ze.img,{custom:c,src:n[S],alt:"",className:z("absolute inset-0 size-full",{"p-sm object-contain":m==="contain","object-cover":m==="cover"}),variants:T,initial:"hiddenEnter",animate:"visible",exit:"hiddenExit",transition:ui},n[S])})}),k&&l.jsx(ze.div,{initial:{opacity:0},animate:{opacity:v||i||w?1:0},transition:ui,children:l.jsx(Y,{as:"button",variant:"raised",className:"shadow-overlay active:bg-subtler absolute left-2 top-1/2 flex size-6 -translate-y-1/2 items-center justify-center rounded-full",onClick:a,children:l.jsx(ye,{icon:D("chevron-left"),size:"sm"})})}),M&&l.jsx(ze.div,{initial:{opacity:0},animate:{opacity:v||i||w?1:0},transition:ui,children:l.jsx(Y,{as:"button",variant:"raised",className:"shadow-overlay active:bg-subtler absolute right-2 top-1/2 flex size-6 -translate-y-1/2 items-center justify-center rounded-full",onClick:s,children:l.jsx(ye,{icon:D("chevron-right"),size:"sm"})})})]}):null}),w9=({children:e})=>l.jsx("div",{className:"gap-md flex w-full flex-row",children:e}),mze=({children:e})=>l.jsx("div",{className:"w-[180px] shrink-0",children:e}),pze=({children:e})=>l.jsx("div",{className:"gap-xs flex flex-col justify-center",children:e}),hze=({children:e,onClick:t})=>l.jsx(Ls,{onClick:t,className:"gap-xs group flex flex-col",children:e}),gze=({children:e})=>l.jsx("div",{className:"group-hover:underline",children:l.jsx(T$,{size:"tiny",weight:"medium",level:3,align:"left",children:e})}),yze=({children:e})=>l.jsx("div",{className:"gap-xs -mt-sm flex flex-row justify-between",children:e}),dc=Object.assign(w9,{Root:w9,Image:mze,Title:gze,Content:pze,Action:hze,Footer:yze}),xze=({actions:e})=>l.jsx(Ao,{className:"text-quietest flex flex-row flex-wrap items-center",delimiter:"|",children:e.map((t,n)=>{const r=l.jsx(Y,{className:"gap-xs flex items-center",children:l.jsx(pt,{variant:t.emphasize?"super":"common",size:"small",onClick:t.onClick,icon:t.icon,trailingComponent:t.trailingComponent,text:t.label,textClassName:t.textClassName,noPadding:!0})});return l.jsx(Un,{id:t.label,children:r},n)})}),bze=A.memo(function({title:t,href:n,linkType:r="external",onClick:s,noFollow:a=!1,variant:o="entry-title-300"}){const{$t:i}=Q(),c=i({defaultMessage:"Open in Perplexity",id:"EUx7i7X2Vq"}),u=i({defaultMessage:"Open site",id:"X8dxWhlpJl"}),d=i({defaultMessage:"View details",id:"MnpUD7ksb+"}),m=l.jsx(B,{as:s?"button":void 0,onClick:s,variant:o,lineClamp:3,className:"decoration-subtle animate-underlineFade hover:text-super hover:decoration-super/80 dark:decoration-subtler inline-block w-fit cursor-pointer overflow-visible text-left align-baseline underline decoration-1 underline-offset-[5px] transition-all hover:underline-offset-[7px] motion-reduce:transition-none",children:t});return n?l.jsx(wn,{content:r==="external"?u:c,side:"right",children:l.jsx(Dt,{href:n,target:"_blank",rel:a?void 0:"nofollow",className:"w-fit",onClick:s,children:m})}):s?l.jsx(wn,{content:d,side:"right",children:m}):m}),_ze="pk.eyJ1Ijoiam9obm55cHBseCIsImEiOiJjbG9zeWVsaHUwNGU5Mmpudm95bGpmcTJjIn0.ztIaHlLUvTpLq8EVD7LjDQ",vze="clpmzsapf00zy01po5t7ge9zd",Cze="clps6e1xy015c01qt2u79a96f";function S9({mode:e="light",width:t,height:n,lat:r,long:s,zoom:a=12,scale:o}){return"https://api.mapbox.com/styles/v1/johnnypplx/"+(e==="light"?vze:Cze)+`/static/${s},${r},${a}/${t}x${n}${o==2?"@2x":""}?access_token=${_ze}&logo=false`}function wze(e){const t=S9({...e,scale:1}),n=S9({...e,scale:2});return{src:t,srcSet:`${t} 1x, ${n} 2x`}}const Sze=A.memo(function({standardizedHours:t,timezone:n}){const r=w5(t,n,"short");return r.length===0?null:l.jsx("div",{className:"gap-xs flex flex-col",children:r.map(({day:s,joinedHours:a,isToday:o})=>l.jsxs("div",{className:"gap-md flex items-center justify-between",children:[l.jsx(B,{variant:"tiny",color:"white",className:o?void 0:"opacity-50",children:s}),l.jsx(B,{variant:"tiny",color:"white",className:o?void 0:"opacity-50",children:a})]},`place-hours-${s}`))})}),Eze=(e,t,n)=>{let r=Math.min(Math.ceil(n/2),e.length),s=Math.min(Math.floor(n/2),t.length);return r+s<n&&(r=Math.min(n-s,e.length)),r+s<n&&(s=Math.min(n-r,t.length)),[...e.slice(0,r).map(a=>({...a,type:"pro"})),...t.slice(0,s).map(a=>({...a,type:"con"}))]},kze=A.memo(function({pros:t,cons:n,loading:r}){const[s,a]=f.useState(0),[o,i]=f.useState(!1),[c,u]=f.useState(1),[d,m]=f.useState(1),[p,h]=f.useState(0),[g,{width:y,height:b}]=Ni(),[x,_]=f.useState(_e),v=f.useRef(null),{isMobileUserAgent:C}=Be(),w=Math.floor(y??0),S=Math.floor(b??0),E=f.useCallback(P=>!t?.length&&!n?.length||P<=0?_e:Eze(t,n,P),[t,n]),T=f.useCallback((P,O,L,H)=>{const R=Math.floor(P/L),I=Math.floor(O/H);return{columns:Math.max(1,R),rows:Math.max(1,I)}},[]);f.useEffect(()=>{const{columns:P,rows:O}=T(w,S,180,56);u(P),m(O),s>x.length-1&&x.length-1>=0&&a(x.length-1)},[w,S,s,x.length,T]),f.useEffect(()=>{h(d*c),_(E(d*c))},[d,c,E]),f.useEffect(()=>{if(v.current){const P=v.current.scrollWidth,O=x.length,L=P/O*s;v.current.scrollTo({left:L})}},[o]),f.useEffect(()=>{const P=v.current;if(!P)return;const O=()=>{const L=P.scrollLeft,H=P.scrollWidth/x.length,R=Math.round(L/H);R!==s&&a(R)};return P.addEventListener("scroll",O),()=>P.removeEventListener("scroll",O)},[s,x.length]);const k=f.useCallback(P=>{if(!v.current)return;const L=v.current.scrollWidth/x.length*P;v.current.scrollTo({left:L})},[x.length]),M=f.useCallback(()=>{if(!v.current)return;const P=s+1>=x.length?0:s+1;k(P)},[s,x.length,k]),N=f.useCallback(()=>{if(!v.current)return;const P=s-1<0?x.length-1:s-1;k(P)},[s,x.length,k]);return l.jsx("div",{className:"size-full",style:{transformStyle:"preserve-3d",perspective:"1000px"},onMouseLeave:()=>{C||i(!1)},children:l.jsxs(ze.div,{initial:{rotateY:0},animate:{rotateY:o?180:0},transition:{type:"spring",stiffness:200,damping:30},style:{willChange:"transform",transformStyle:"preserve-3d"},className:"relative size-full",children:[l.jsx("div",{ref:g,className:"gap-sm grid size-full",style:{gridTemplateColumns:`repeat(${c}, 1fr)`,gridTemplateRows:`repeat(${d}, 1fr)`,backfaceVisibility:"hidden"},children:[...Array(p)].map((P,O)=>{const L=x[O];return!L&&!r?null:r?l.jsx(Tr,{children:l.jsx("div",{className:"bg-subtler size-full rounded-xl"})},O):L?l.jsx(Mze,{item:L,index:O,setIsFlipped:i,setDetailIndex:a},O):null})}),l.jsx("div",{className:"absolute inset-0 size-full",style:{backfaceVisibility:"hidden",willChange:"transform",transform:"rotateY(180deg)"},children:l.jsxs(Xn,{className:"gap-xs relative flex size-full flex-col text-left",children:[C&&l.jsx("button",{className:"shadow-overlay active:bg-subtler absolute right-[-8px] top-[-8px] z-[1] flex size-[24px] items-center justify-center rounded-full bg-white dark:bg-black",onClick:P=>{P.stopPropagation(),i(!1)},children:l.jsx(B,{color:"light",children:l.jsx(ye,{icon:D("x"),size:"sm"})})}),l.jsx("div",{ref:v,className:z("scrollbar-none absolute inset-0 snap-x snap-mandatory overflow-x-hidden",{"!overflow-x-scroll":C}),children:l.jsx("div",{className:"flex h-full flex-row flex-nowrap",style:{width:`${x.length*100}%`},children:x.map((P,O)=>l.jsx(Tze,{item:P,next:M,prev:N},O))})}),l.jsx("div",{className:"gap-xs bottom-sm absolute left-1/2 flex -translate-x-1/2 flex-row",children:Array.from({length:x.length},(P,O)=>l.jsx("div",{onClick:()=>{k(O)},className:z("size-[6px] cursor-pointer rounded-full bg-black dark:bg-white",{"opacity-50":O===s,"opacity-[10%]":O!==s})},O))})]})})]})})}),Mze=A.memo(function({item:t,index:n,setIsFlipped:r,setDetailIndex:s}){const a=f.useCallback(()=>{r(!0),s(n)},[n,s,r]);return l.jsx(Xn,{as:"button",onClick:a,className:"px-md active:bg-subtler dark:active:bg-subtle cursor-pointer",children:l.jsxs("div",{className:"gap-sm flex flex-row items-center",children:[l.jsx(B,{variant:"smallBold",className:"leading-tight",color:t.type==="pro"?"super":"light",children:l.jsx(ye,{icon:t.type==="pro"?D("check"):D("x"),size:"sm"})}),l.jsx(B,{variant:"smallBold",lineClamp:2,className:"text-left leading-tight",color:t.type==="pro"?"super":"light",children:t.label})]})})}),Tze=A.memo(function({item:t,next:n,prev:r}){const{isMobileUserAgent:s}=Be();return l.jsx("div",{onClick:a=>{if(s)return;const o=a.currentTarget.getBoundingClientRect();a.clientX-o.left>o.width/2?n():r()},className:"scrollbar-none size-full cursor-pointer select-none snap-center overflow-y-scroll",style:{mask:"linear-gradient(to bottom, black calc(100% - 40px), transparent calc(100% - 12px))",WebkitMask:"linear-gradient(to bottom, black calc(100% - 40px), transparent calc(100% - 12px))"},children:l.jsxs("div",{className:"p-md gap-xs flex flex-col pb-[32px] text-left",children:[l.jsxs(B,{variant:"smallBold",className:"gap-xs flex flex-row leading-tight",color:t.type==="pro"?"super":"default",children:[l.jsx(ye,{icon:t.type==="pro"?D("check"):D("x"),size:"sm",className:"translate-y-half shrink-0"}),t.label]}),l.jsx(B,{variant:"small",color:"light",children:t.description})]})})});function Lz(){const{locale:e}=Q(),t=new Intl.Locale(e),{value:n,loading:r}=zC({flag:"canonical-hotel-pages-enabled",defaultValue:!1,extraAttributes:{cfLanguage:t.language,appApiVersion:_u}});return f.useMemo(()=>({initialized:!r,value:n}),[n,r])}const Aze=({entity_id:e,entity_name:t,data_source:n,entry_uuid:r,url:s,reason:a,address:o})=>{const i=It(),c=Se.makeQueryKey("place_result_reviews",`${n}_${s}`),{refetch:u,data:d,isFetching:m,error:p}=gt({queryKey:c,enabled:!1,queryFn:async()=>{let h={summary:"",review_quality_score:0,pros:[],cons:[],key_features:[],review_search_results:[]},g="PENDING",y="";try{await ve.SSE("/rest/sse/places_review_summary_bulk",a,{params:{places:[{entity_id:e,entity_name:t,data_source:n,entry_uuid:r,url:s,address:o}]},handlers:{message:b=>{b.blocks?.[0]?.review_summary_block&&(h={...h,...b.blocks[0].review_summary_block}),g=b.status??"FAILED",y=b.id??"",i.setQueryData(c,{review_summary:h,status:g,id:y})}}})}catch{}return{review_summary:h,status:g,id:y}}});return f.useMemo(()=>({generateReviewSummaryForPlace:u,reviewSummary:d?.review_summary,isFetching:m,error:p}),[d?.review_summary,p,u,m])},Fz=()=>{const{session:e}=je(),t=e?.user?.org_uuid;return{uuid:t==="none"?void 0:t}};function Nze(){const{value:e}=Lz(),{locale:t}=Q(),n=new Intl.Locale(t),{uuid:r}=Fz(),{value:s,loading:a}=zC({flag:"can-book-hotels",defaultValue:!1,extraAttributes:{cfLanguage:n.language,appApiVersion:_u,dependent_flag:"canonical-hotel-pages-enabled",variation_served:e,orgUUID:r??""}});return f.useMemo(()=>({initialized:!a,value:s}),[a,s])}function E9(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${r}`}const Rze=async({tripadvisorIds:e,searchPayload:t,reason:n})=>{const{checkIn:r,checkOut:s,numAdults:a,numChildren:o}=t,{data:i}=await ve.POST("/rest/travel/hotels/search-availability",n,{body:{currency:"USD",filter:{tripadvisor_ids:e},stay_info:{check_in_date:E9(r),check_out_date:E9(s),guests:{adults:a,children:o}}},timeoutMs:hs.HIGH,retries:2});return i?{availability:i.results,currencyExchangeRates:i.currency_exchange_rates,otaOffers:i.ota_hotel_offers}:null};function k9(e){return new Date(`${e}T00:00:00`)}function Dze(e,t){const n=[],r=new Date(e);for(;r<=t;)n.push(new Date(r)),r.setDate(r.getDate()+1);return n.length}const Ize=({amount:e,currency:t,targetCurrency:n,exchangeRates:r,options:s})=>{const a=M9(e,t,s),o=e/1e6,i=r?.find(({source_currency:u,target_currency:d})=>u===t&&d===n);if(!i||n===t)return{original:a,originalAmount:o};const c=M9(e*i.conversion_factor,n,s);return{original:a,originalAmount:o,adjusted:c,adjustedAmount:e*i.conversion_factor/1e6}},M9=(e,t,n)=>Z_(e!==null?e/1e6:e,t,n);function bQe(e){const t=new Date;return t.setDate(t.getDate()+e),t}const jze=({hotelIds:e,availabilitySearchPayload:t,priceConstraint:n,reason:r,enabled:s=!0})=>{const a=gt({queryKey:Se.makeEphemeralQueryKey("hotelAvailabilities",e,t),queryFn:async()=>{if(t&&e.length>0){const c=await Rze({tripadvisorIds:e,searchPayload:t,reason:r});if(c)return c;throw new Error("Failed to fetch availabilities")}return null},placeholderData:Ja,enabled:s&&!!t&&e.length>0}),o=n?.max_price,i=f.useMemo(()=>{if(!t||!a.data?.availability&&!a.data?.otaOffers)return;const c=a.data.currencyExchangeRates,u=Dze(t.checkIn,t.checkOut)-1;if(u<=0)return;const d={};a.data.availability?.forEach(g=>{const y=g.tripadvisor_id,b=g.rooms?.reduce((C,w)=>{const S=w.rates?.slice()??[];S.sort((T,k)=>T.price.base_price-k.price.base_price);const E=S[0];return E?C?E.price.base_price<C.price.base_price?E:C:E:C},null);if(!b)return;const x=Ize({amount:b.price.base_price,currency:b.price.currency_code,targetCurrency:"USD",exchangeRates:c,options:{roundToMajor:!0}}),_=x.adjustedAmount??x.originalAmount,v=d[y];(!v||v>_)&&(d[y]=_)});const m={};a.data.otaOffers?.forEach(g=>{const y=g.tripadvisor_id,b=g.offers.map(({price:x})=>x);if(b.sort(),ko(b)){const _=b[0]*u;m[y]=_}});const p={},h=new Set([...Object.keys(d),...Object.keys(m)]);for(const g of h){const y=d[g],b=m[g],x=y!==void 0?y/u:void 0,_=b!==void 0?b/u:void 0;if(x!==void 0&&(o==null||x<=o)&&y!==void 0){p[g]={price:y,source:"selfbook"};continue}_!==void 0&&(o==null||_<=o)&&b!==void 0&&(p[g]={price:b,source:"ota"})}return Object.entries(p).reduce((g,[y,b])=>(g[y]={total:Z_(b.price,"USD",{roundToMajor:!0,renderZero:!0}),daily:Z_(b.price/u,"USD",{roundToMajor:!0,renderZero:!0}),source:b.source},g),{})},[t,a.data,o]);return f.useMemo(()=>({lowestRatesByHotel:i,isFetching:a.isFetching,isError:a.isError,refetch:a.refetch}),[i,a.isFetching,a.isError,a.refetch])},Pze=(e,t)=>{const{value:n,loading:r}=Lt({flag:"get-opentable-enabled",defaultValue:e,extraAttributes:t,subjectType:"user_nextauth_id"});return f.useMemo(()=>({variation:n,loading:r}),[n,r])};function Oze(){const{locale:e}=Q(),t=new Intl.Locale(e),{uuid:n}=Fz(),{variation:r,loading:s}=Pze(!1,{language:t.language,country:t.region??"",appApiVersion:_u,orgUUID:n??""});return f.useMemo(()=>({initialized:!s,value:r}),[s,r])}const Lze=Pe(async()=>{const{RestaurantBookingModal:e}=await W(async()=>{const{RestaurantBookingModal:t}=await import("./RestaurantBookingModal-DPm2cGhs.js");return{RestaurantBookingModal:t}},__vite__mapDeps([420,2,3,6,5,1,7,8,9,421,422,423,15,424,11,36,411,412,34,35,13,12,14,16,17]));return{default:e}},{loading:()=>null}),Fze=({place:e,entryUUID:t,contextUUID:n,mode:r,reason:s,hotelRate:a})=>{const{$t:o}=Q(),{SearchClientLogo:i}=Iz(e.url),{session:c}=je(),{trackEvent:u}=Ze(c),{openModal:d}=Kt(),m=Lz(),p=Nze(),h=Oze(),{generateReviewSummaryForPlace:g,reviewSummary:y,isFetching:b}=Aze({entity_id:String(e.id),entity_name:e.name,entry_uuid:t??"",data_source:e.client,url:e.url,reason:s,address:e.address});f.useEffect(()=>{e.review_summary||y||g()},[e.review_summary,y]);const x="user_filters"in e?e.user_filters:void 0,_=f.useMemo(()=>{if(x?.start_date&&x?.end_date&&x?.num_guests)return{checkIn:k9(x.start_date),checkOut:k9(x.end_date),numAdults:x.num_guests,numChildren:0}},[x]),{lowestRatesByHotel:v}=jze({hotelIds:[e.id],availabilitySearchPayload:_,priceConstraint:x?.price_constraint,reason:s,enabled:e.entity_type==="hotel"}),C=f.useMemo(()=>e.review_summary??y,[e.review_summary,y]),{hasProsOrCons:w,isLoadingProsCons:S}=f.useMemo(()=>{const F=C?.pros_detailed?.length??0,G=C?.cons_detailed?.length??0;return{hasProsOrCons:F||G||b,isLoadingProsCons:b&&!C?.summary?.length&&(F+G<3||!F||!G)}},[C?.pros_detailed,C?.cons_detailed,C?.summary?.length,b]),E=!!C?.summary,T=C?.key_features&&C.key_features.length>0,k=!E&&b,M=f.useCallback(()=>{const F=e.entity_url??e.url;return m.initialized&&m.value?e.canonical_page_path??F:F},[m,e.canonical_page_path,e.entity_url,e.url]),N=f.useCallback(()=>{const F=M();if(p.initialized&&p.value&&e.canonical_page_path&&e.entity_type==="hotel"&&"user_filters"in e&&e.user_filters){const G=new URLSearchParams;if(e.user_filters.start_date&&G.set("check-in",e.user_filters.start_date),e.user_filters.end_date&&G.set("check-out",e.user_filters.end_date),e.user_filters.num_guests&&G.set("adults",String(e.user_filters.num_guests)),G.toString())return`${F}?${G.toString()}`}return F},[M,p,e]),P=o({defaultMessage:"See Prices",description:"button label",id:"AOhh9Wa3/S"}),O=o({defaultMessage:"Reserve",description:"button label",id:"Rl2ClHM49w"}),L=f.useCallback(F=>{u("place button clicked",{answerMode:r,entryUUID:t,contextUUID:n,itemID:F})},[n,t,r,u]),H=f.useCallback(F=>{window.open(F,"_blank")},[]),R=f.useMemo(()=>{if(p.initialized&&p.value&&e.canonical_page_path&&e.entity_type==="hotel"){const F=a??v?.[e.id],G=N();return F?{ctaText:o({defaultMessage:"From {price} per night",id:"fkXL6pzn0I",description:"Button text indicating the starting price per night for a hotel"},{price:F.daily}),ctaURL:G,onClick:()=>{H(G)},ctaSubtitle:void 0,icon:D("tag")}:{ctaText:P,ctaURL:G,ctaSubtitle:void 0,onClick:()=>{H(G)},icon:D("tag")}}else if(e.booking_urls){const F=e.booking_urls[0];if(F?.booking_type==="HOTEL"&&p.value)return{ctaText:P,ctaURL:F.url,onClick:()=>{H(F.url)},icon:D("moneybag")};if(F?.booking_type==="RESTAURANT"){const G=h.initialized&&h.value&&F.provider_entity_id,j=F.booking_provider;return{ctaText:O,ctaURL:F.url,icon:D("calendar-event"),onClick:G?()=>{u("restaurant reservation CTA clicked",{booking_provider:j}),d(Lze,{restaurantId:F.provider_entity_id??"",provider:j})}:()=>{H(F.url)}}}}},[a,p,h,e,N,O,P,d,o,v,u,H]),I=f.useCallback(F=>{F.stopPropagation()},[]);return{generatedReviewSummary:C,hasProsOrCons:!!w,isLoadingProsCons:S,hasReviewSummary:E,hasKeyFeatures:!!T,reviewSummaryLoading:k,getEntityUrl:M,getEntityUrlWithParams:N,bookingCTAProperties:R,SearchClientLogo:i,handleClientLogoClick:I,trackPlaceButtonClicked:L}},Uze=Pe(async()=>{const{PlaceModal:e}=await W(async()=>{const{PlaceModal:t}=await import("./PlaceModal-C7O6zn12.js");return{PlaceModal:t}},__vite__mapDeps([421,3,2,5,1,6,7,8,9,422,423,15,424,11,36,411,412,34,35,13,12,14,16,17]));return{default:e}}),_Qe=A.memo(function({place:t,entryUUID:n,contextUUID:r,context:s="medium",children:a}){const o="place-inline-card",{$t:i}=Q(),[c,u]=f.useState(!1),[d,m]=f.useState(_e),{openModal:p}=Kt(),{generatedReviewSummary:h,hasProsOrCons:g,isLoadingProsCons:y,bookingCTAProperties:b,SearchClientLogo:x,handleClientLogoClick:_}=Fze({place:t,entryUUID:n,contextUUID:r,reason:o}),{session:v}=je(),{trackEvent:C,trackEventOnce:w}=Ze(v);f.useEffect(()=>{n&&(w("entity card shown",{entryUUID:n,entityType:"places"}),r&&C("place card viewed",{inline:!0,entryUUID:n,contextUUID:r,itemID:t.url}))},[n,r,t.url,C,w]);const S=f.useCallback(()=>{C("entity card clicked",{entryUUID:n,entityType:"places"})},[n,C]),E=f.useCallback(async()=>{const $=[];if(t.image_url&&$.push(t.image_url),t.images&&t.images.forEach(U=>{U!==t.image_url&&$.push(U)}),!$.length){m(_e);return}const q=[];for await(const U of a$($))q.length===0&&m(U.map(X=>({image:X,url:X.includes("tripadvisor.com")?t.url:t.entity_url??t.url}))),q.push(...U);m(q.map(U=>({image:U,url:U.includes("tripadvisor.com")?t.url:t.entity_url??t.url})))},[t.image_url,t.images,t.url,t.entity_url]);f.useEffect(()=>{E()},[E]);const T=f.useMemo(()=>d.map($=>$.image),[d.length]),{colorScheme:k}=Cs(),M=f.useCallback(()=>u(!0),[]),N=f.useCallback(()=>u(!1),[]),P=f.useCallback(()=>{window.open(o$(t.name,t.address?.join(", ")??""),"_blank")},[t.name,t.address]),O=f.useCallback($=>{S(),$==="cta"&&b?b.onClick():p(Uze,{place:t,entryUUID:n,contextUUID:r})},[S,p,n,r,t,b]),L=i({defaultMessage:"Website",id:"JkLHGwmS9L"}),H=i({defaultMessage:"Directions",id:"fuwkSr5Bz7"}),R=i({defaultMessage:"Call",id:"f+GKc4i1Gc"}),I=f.useMemo(()=>[(t.price||t.price_range)&&l.jsx(Un,{id:"price",children:l.jsx(zg,{textVariant:"smallBold",priceSymbols:t.price,priceRange:t.price_range,currencySymbol:t.currency_char})},"price"),t.rating&&l.jsx(Un,{id:"rating",children:l.jsx(NC,{minReviewCount:1,reviewCount:t.num_reviews,rating:t.rating,size:"sm",variant:"truncated",textVariant:"smallBold",reviewTextVariant:"small",color:"default",url:x&&t.url?t.url:void 0})},"rating"),!!t.standardized_hours&&l.jsx(Un,{id:"open-until",children:l.jsx(RC,{place:t})},"open-until"),x&&l.jsx(Un,{id:"logo",children:l.jsx(Bze,{SearchClientLogo:x,url:t.url,handleClick:_})},"logo"),...s==="medium"?[l.jsx(Un,{id:"website",children:l.jsx(k2,{label:L,href:t.entity_url??t.url})},"website"),!!t.address?.length&&l.jsx(Un,{id:"directions",children:l.jsx(k2,{label:H,href:i$(t.name,t.address.join(", "))})},"directions"),!!t.phone&&l.jsx(Un,{id:"call",children:l.jsx(k2,{label:t.phone,href:`tel:${t.phone}`})},"call")]:_e].filter($=>!!$),[x,_,t,L,H,s]),F=f.useMemo(()=>[b&&{label:b.ctaText,icon:b.icon,onClick:()=>O("cta"),emphasize:!0},t.address?.length&&{label:H,onClick:()=>P(),icon:D("map-pin")},(t.entity_url||t.url)&&{label:L,onClick:()=>window.open(t.entity_url??t.url,"_blank"),icon:D("world")},t.phone&&{label:R,onClick:()=>window.open(`tel:${t.phone}`,"_blank"),icon:D("phone")}].filter($=>!!$),[b,O,t.entity_url,t.url,L,H,P,t.address?.length,t.phone,R]),G=f.useMemo(()=>b?l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("span",{className:"text-[16px]",children:b.ctaText}),b.ctaSubtitle&&l.jsx("span",{className:"text-quiet -mt-1 text-xs font-normal",children:b.ctaSubtitle})]}):null,[b]),j=f.useMemo(()=>b?l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("span",{className:"text-lg",children:b.ctaText}),b.ctaSubtitle&&l.jsx("span",{className:"text-quiet -mt-0.5 text-sm font-normal",children:b.ctaSubtitle})]}):null,[b]);return s==="small"?l.jsx(C9,{images:T,showControls:c,onImageClick:()=>O("title"),children:l.jsxs(dc.Root,{children:[l.jsx(dc.Image,{children:l.jsx(Xn,{fullBleed:!0,className:"aspect-[4/3] w-full overflow-hidden",children:l.jsx(E2,{})})}),l.jsxs(dc.Content,{children:[l.jsx(dc.Action,{onClick:()=>O("title"),children:l.jsx(dc.Title,{children:t.name})}),l.jsx(B,{color:"light",children:l.jsx(Ao,{className:"gap-xs flex flex-row flex-wrap",children:I})}),l.jsx("div",{className:"-mt-sm",children:a}),l.jsx(dc.Footer,{children:l.jsx(xze,{actions:F})})]})]})}):l.jsx("div",{className:"group relative","data-testid":"place-inline-card",children:l.jsx(C9,{images:T,showControls:c,onImageClick:()=>O("title"),children:l.jsxs("div",{className:"gap-md @container mt-4 flex flex-col",children:[l.jsxs("div",{className:"gap-sm flex flex-row items-end",children:[l.jsxs("div",{className:"gap-xs flex flex-col",children:[l.jsx(bze,{title:t.name,onClick:()=>O("title")}),l.jsx(B,{color:"light",children:l.jsx(Ao,{className:"gap-xs flex flex-row flex-wrap",children:I})})]}),b&&l.jsx("div",{className:"@[420px]:block ml-auto hidden",children:l.jsx(st,{variant:"primaryGhost",icon:b.icon,size:"regular",pill:!0,onClick:()=>O("cta"),text:G})})]}),(!d||d.length<1)&&!g?null:l.jsxs("div",{className:"gap-sm @[420px]:grid-cols-2 @[640px]:grid-cols-3 grid w-full grid-cols-1",children:[d&&d[0]&&l.jsx(Xn,{onMouseEnter:M,onMouseLeave:N,fullBleed:!0,className:"aspect-[4/3] overflow-hidden",children:l.jsx(E2,{})}),l.jsx(Xn,{onMouseEnter:M,onMouseLeave:N,fullBleed:!0,className:z("overflow-hidden",{"aspect-[4/3]":d&&d.length>1&&(g||!g&&d&&d[2]),"@[640px]:block hidden h-full":g||!g&&d&&d[2],"@[420px]:block @[640px]:col-span-2 hidden h-full":!g&&d&&d.length===1||g&&(!d||d.length<1)}),children:l.jsxs(Y,{as:"button",onClick:P,className:"relative size-full",children:[l.jsx("img",{className:"absolute left-1/2 top-1/2 max-w-[unset] -translate-x-1/2 -translate-y-1/2",...wze({mode:k,width:512,height:512,lat:t.lat??0,long:t.lng??0}),alt:""}),l.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 overflow-visible",children:l.jsx(jz,{})})]})}),g?l.jsx("div",{className:z("@[420px]:h-full h-[124px]",{"aspect-[4/3]":!d?.length}),children:l.jsx(kze,{pros:h?.pros_detailed??_e,cons:h?.cons_detailed??_e,loading:y})}):d&&d[2]?l.jsx(Xn,{onMouseEnter:M,onMouseLeave:N,fullBleed:!0,className:"@[420px]:block hidden aspect-[4/3] overflow-hidden",children:l.jsx(E2,{})}):null]}),b&&t.canonical_page_path?l.jsx("div",{className:"-mt-sm @[420px]:hidden block",children:l.jsx(st,{variant:"primaryGhost",icon:b.icon,fullWidth:!0,size:"regular",pill:!0,onClick:()=>O("cta"),text:j})}):null,a]})})})}),RC=A.memo(function({place:t,textVariant:n="smallBold",condensed:r=!1,showTooltip:s=!0}){const{$t:a}=Q(),o=w5(t.standardized_hours,t.timezone??"","short"),[i,c]=f.useMemo(()=>{for(const p of o)if(p.isToday){for(const h of p.hours)if(h.isOpenNow)return h.open!==h.close?[!0,h.close]:[!0,null]}return[!1,null]},[o]),u=f.useMemo(()=>l.jsx(Sze,{standardizedHours:t.standardized_hours,timezone:t.timezone??""}),[t.standardized_hours,t.timezone]),d=i?c&&!r?a({defaultMessage:"Open until {time}",id:"abDRIJdom/"},{time:c}):a({defaultMessage:"Open",id:"JfG49wNHKP"}):a({defaultMessage:"Closed",id:"Fv1ZSzMOV6"}),m=l.jsx(B,{variant:n,color:i?"super":"red",children:d});return s?l.jsx(fa,{triggerElement:m,interaction:"hover",appearance:"dark",side:"bottom",align:"center",children:u}):m}),k2=A.memo(function({label:t,href:n,textVariant:r="smallBold",icon:s}){const a=f.useCallback(i=>{i.stopPropagation()},[]),o=l.jsxs(B,{variant:r,color:"light",className:z("gap-xs flex items-center truncate transition-colors duration-150",{"hover:text-super":n}),children:[s?l.jsx(_n,{icon:s,size:"tiny"}):null,t]});return n?l.jsx(Dt,{href:n,target:"_blank",className:"cursor-pointer truncate",onClick:a,children:o}):o}),Bze=A.memo(function({SearchClientLogo:t,url:n,handleClick:r}){const s=f.useCallback(o=>{o.stopPropagation()},[]),a=r||s;return t?n?l.jsx(Dt,{href:n,target:"_blank",className:"cursor-pointer duration-150 hover:opacity-70",onClick:a,children:l.jsx(t,{})}):l.jsx(t,{}):null}),Hze={ANSWER:"default",IMAGE:"images",VIDEO:"videos",SHOPPING:"shopping",MAPS:"places",SOURCES:"sources",JOBS:"jobs",HOTELS:"hotels",ASSETS:"assets",SEARCH:"search",CHAT:"chat",APPS:"apps",NEWS:"news"};function Uz(e){return Hze[e]??null}const Vze=e=>e==="default",Gze=e=>Va(e).with("default",()=>"default").with("shopping",()=>"default").with("jobs",()=>"full").with("hotels",()=>"full").with("places",()=>"full").with("images",()=>"full").with("videos",()=>"full").with("sources",()=>"default").with("assets",()=>"full").with("apps",()=>"full").with("search",()=>"default").otherwise(()=>"default"),zze=e=>({mode:e,width:Gze(e)}),Bz=(e,t)=>{for(let n=e.length-1;n>=0;n--){const r=e[n],s=r?.[0];if(!s)continue;if(s.blocks?.find(i=>i.answer_tabs_block)?.answer_tabs_block?.modes?.some(i=>i.answer_mode_type?Uz(i.answer_mode_type)===t:!1))return[r]}return null},Hz={ANSWER_MODE_TYPE_UNSPECIFIED:{i18nKey:V({defaultMessage:"Unknown",id:"5jeq8PJZg7"}),id:Er.default,mode:"default",show:!0},ANSWER:{i18nKey:V({defaultMessage:"Answer",id:"DwjT1HpUgU"}),id:Er.default,mode:"default",show:!0},SHOPPING:{i18nKey:V({defaultMessage:"Shopping",id:"my1MLnIMoS"}),icon:D("shopping-cart"),id:Er.shopping,mode:"shopping",show:!0},JOBS:{i18nKey:V({defaultMessage:"Jobs",id:"9AcATFXaoo"}),icon:D("briefcase"),id:Er.jobs,mode:"jobs",show:!0},HOTELS:{i18nKey:V({defaultMessage:"Hotels",id:"+dqK4hw0if"}),icon:D("building"),id:Er.hotels,mode:"hotels",show:!0},MAPS:{i18nKey:V({defaultMessage:"Places",id:"QQInFSbbwr"}),icon:D("map-pin"),id:Er.places,mode:"places",show:!0},IMAGE:{i18nKey:V({defaultMessage:"Images",id:"Fip4H8CuWD"}),icon:D("photo"),id:Er.images,mode:"images",show:!0},VIDEO:{i18nKey:V({defaultMessage:"Videos",id:"4XfMuxy3FO"}),icon:D("movie"),id:Er.videos,mode:"videos",show:!0},SOURCES:{i18nKey:V({defaultMessage:"Links",id:"qCcwo3DU78"}),icon:D("world"),id:Er.sources,mode:"sources",show:!0},ASSETS:{i18nKey:V({defaultMessage:"Documents",id:"vBlT6yzK/6"}),icon:D("stack-2"),id:Er.assets,mode:"assets",show:!0},APPS:{i18nKey:V({defaultMessage:"App",id:"2rUVsUf259"}),icon:D("layout-collage"),id:Er.apps,mode:"apps",show:!1},SEARCH:{i18nKey:V({defaultMessage:"Search",id:"xmcVZ0BU63"}),icon:D("search"),id:Er.search,mode:"search",show:!1},CHAT:{i18nKey:V({defaultMessage:"Chat",id:"WTrOy36sdu"}),icon:D("message"),id:Er.chat,mode:"chat",show:!1},NEWS:{i18nKey:V({defaultMessage:"News",id:"NZyhSXwwOq"}),icon:D("news"),id:Er.news,mode:"news",show:!0}};(()=>{const e={};return Object.values(Hz).forEach(t=>{e[t.mode]=t}),e})();function qze(e,t){return{...e.icon&&{icon:e.icon},id:e.id,mode:e.mode,text:t(e.i18nKey),show:e.show??!0}}function $ze(e){const t=e.sourcesCount||e.attachmentsLength||0,n=e.sourcesProgress!=="DONE"&&!e.attachmentsLength;return{count:t,disabled:n}}const T9={images:[],videos:[],shopping:[],jobs:[],places:[],assets:[],news:[],sources:{count:0,results:[],progress:void 0,rows:void 0}},Vz=Bt("ThreadAnswerModesContext",null);function Gz(){const e=f.useContext(Vz);if(!e)throw new Error("useThreadAnswerModes must be used within a ThreadAnswerModesProvider");return e.useProxy()}function vQe(){const{entries:e,results:t}=Gz(),{activeThreadTab:n}=Oo();return f.useMemo(()=>{let r=null;if(n==="default")r=t[t.length-1]?.backend_uuid??null;else{const s=d0(t);r=Bz(s,n)?.[0]?.[0]?.backend_uuid??null}return!r&&t.length>0&&(r=t[t.length-1]?.backend_uuid??null),r?e.get(r)??T9:T9},[e,t,n])}const Wze=A.memo(function({children:t}){const{$t:n}=Q(),r=qf(),{results:s}=Ht(),a=eo(),{variation:o}=LG(!1),i=f.useCallback(u=>{const d=new Map;s.forEach(T=>{if(T.backend_uuid&&T.blocks){const k={images:Tme(T.blocks),videos:Ame(T.blocks),shopping:Nme(T.blocks),jobs:Rme(T.blocks),places:Dme(T.blocks),assets:xE(T.blocks,{orderedByPriority:!0}),news:Ime(T.blocks),sources:jme(T.blocks)};d.set(T.backend_uuid,k)}});const m=new Set;s.forEach(T=>{T.blocks?.forEach(k=>{k.answer_tabs_block&&k.answer_tabs_block.modes?.forEach(M=>{M.answer_mode_type&&m.add(M.answer_mode_type)})})});const p=Object.fromEntries(Object.entries(Hz).map(([T,k])=>[T,qze(k,n)])),h=s[s.length-1],g=h?.backend_uuid,b=(g?d.get(g):void 0)?.sources,{count:x,disabled:_}=$ze({sourcesCount:b?.count??0,sourcesProgress:b?.progress,attachmentsLength:h?.attachments?.length??0}),v={...p,SOURCES:{...p.SOURCES,count:x,disabled:_}},C=n(a?{defaultMessage:"Assistant",id:"wSAvhubuX6"}:{defaultMessage:"Answer",id:"DwjT1HpUgU"}),w=a?D("custom-brand-comet"):D("align-justified"),S=Array.from(m).map(T=>{const k=Uz(T);if(!k)return Z.warn("Unsupported Answer Mode",{mode:T.valueOf()}),null;const M=v[T];return M||(Z.warn("Missing mode action mapping",{mode:T.valueOf(),modeString:k}),null)}).filter(T=>!!T),E=[{text:C,icon:w,id:"d",mode:"default"},...S.filter(T=>T.mode==="news"&&!o?!1:T.show!==!1)];return{entries:d,answerModeActionList:E,results:s}},[n,s,a,o]),c=nN(r,i);return l.jsx(Vz.Provider,{value:c,children:t})}),Kze=3,Yze=A.memo(function({placeWidgets:t,backendUuid:n,contextUuid:r,isLastResult:s}){const{$t:a}=Q(),o=YC(),{setActiveThreadTab:i,handleTabScrollBehavior:c,activeThreadTab:u}=Oo(),{session:d}=je(),{trackEventOnce:m,trackEvent:p}=Ze(d),{answerModeActionList:h}=Gz(),[g,y]=f.useState(null),[b,x]=f.useState(null);f.useEffect(()=>{m("maps preview viewed",{entryUUID:n,contextUUID:r})},[m,n,r]);const _=f.useMemo(()=>t.slice(0,Kze),[t]),v=f.useMemo(()=>t.map(S=>Pz(S)),[t]),C=f.useMemo(()=>{const S=h.some(T=>T.mode==="hotels"),E=h.some(T=>T.mode==="places");return S?"hotels":E?"places":"default"},[h]),w=f.useCallback(()=>{p("maps preview see more clicked",{entryUUID:n,contextUUID:r}),c(C),i(C)},[i,c,C,n,r,p]);return t.length?l.jsxs(Y,{className:"bg-subtler relative flex h-96 w-full overflow-hidden rounded-xl border",children:[l.jsx("div",{className:"absolute inset-0",children:l.jsx(uze,{entryUUID:n,contextUUID:r,selectedLocation:g,setSelectedLocation:y,highlightedLocation:b,setHighlightedLocation:x,setRenderedLocations:jr,locations:v,showNavControl:!1,showRating:!0,answerMode:u})}),l.jsx("div",{className:"pointer-events-none absolute inset-0 overflow-hidden",children:o?l.jsx("div",{className:"bottom-sm gap-sm pointer-events-auto absolute inset-x-0 flex flex-col",children:l.jsxs("div",{className:"px-sm gap-sm flex overflow-x-auto [-ms-overflow-style:none] [scrollbar-width:none] [&::-webkit-scrollbar]:hidden",children:[_.map(S=>{const E=v.findIndex(k=>k.url===S.url),T=v[E];return T?l.jsx(A9,{place:S,isSelected:g?.url===S.url,onSelect:()=>{y(T)},onMouseEnter:()=>{x(T)},onMouseLeave:()=>x(null),isMobile:!0},S.url):null}),l.jsx("span",{className:"inline-flex items-center",children:l.jsx(at,{icon:D("chevron-right"),"aria-label":a({defaultMessage:"See more places",id:"q6PxnN/+4O"}),variant:"secondary",size:"default",rounded:!0,disabled:!s,onClick:w})})]})}):l.jsxs("div",{className:"inset-y-sm right-sm pointer-events-auto absolute flex w-64 flex-col justify-between truncate",children:[_.map(S=>{const E=v.findIndex(k=>k.url===S.url),T=v[E];return T?l.jsx(A9,{place:S,isSelected:g?.url===S.url,onSelect:()=>{y(T)},onMouseEnter:()=>{x(T)},onMouseLeave:()=>x(null)},S.url):null}),l.jsx("span",{className:"bg-base rounded-lg",children:l.jsx(at,{variant:"secondary",size:"small",fullWidth:!0,disabled:!s,onClick:w,trailingIcon:D("arrow-right"),children:a({defaultMessage:"See more places",id:"q6PxnN/+4O"})})})]})})]}):null},(e,t)=>xn(e,t)),A9=({place:e,isSelected:t,onSelect:n,onMouseEnter:r,onMouseLeave:s,isMobile:a=!1})=>l.jsx(Y,{as:"button",onClick:n,onMouseEnter:r,onMouseLeave:s,className:z("hover:bg-subtler bg-base flex cursor-pointer overflow-visible rounded-lg border backdrop-blur-lg transition-colors z-10",{"shadow-md":t,"shadow-sm":!t,"min-h-20 w-64 flex-shrink-0 flex-col p-2":a,"min-h-24 w-full items-center justify-between p-2.5":!a}),children:a?l.jsxs("div",{className:"gap-xs flex flex-col text-left",children:[l.jsx(B,{variant:"small",className:"!overflow-clip truncate font-medium leading-tight",children:e.name}),!!e.address?.length&&l.jsx(B,{variant:"tiny",color:"light",className:"!overflow-clip truncate",children:e.address?.join(", ")}),l.jsx("div",{className:"flex items-center",children:l.jsxs(Ao,{className:"gap-xs flex items-center",children:[e.rating&&l.jsx(Un,{id:"rating",children:l.jsx(NC,{minReviewCount:1,reviewCount:e.num_reviews,rating:e.rating,size:"xs",variant:"truncated",textVariant:"tiny",reviewTextVariant:"tiny",color:"default"})}),(e.price||e.price_range)&&l.jsx(Un,{id:"price",children:l.jsx(zg,{textVariant:"tiny",priceSymbols:e.price,priceRange:e.price_range,dollarColor:"light",currencySymbol:e.currency_char})})]})}),e.operating_hours&&l.jsx(RC,{place:e,textVariant:"tiny",showTooltip:!1}),l.jsx("div",{className:"invisible flex-1"})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"gap-xs flex h-20 min-w-0 flex-1 flex-col justify-start text-left",children:[l.jsx(B,{variant:"small",className:"!overflow-clip truncate font-medium leading-tight",children:e.name}),!!e.address?.length&&l.jsx(B,{variant:"tiny",color:"light",className:"!overflow-clip truncate",children:e.address?.join(", ")}),l.jsx("div",{className:"flex items-center",children:l.jsxs(Ao,{className:"gap-xs flex items-center",children:[e.rating&&l.jsx(Un,{id:"rating",children:l.jsx(NC,{minReviewCount:1,reviewCount:e.num_reviews,rating:e.rating,size:"xs",variant:"truncated",textVariant:"tiny",reviewTextVariant:"tiny",color:"default"})}),(e.price||e.price_range)&&l.jsx(Un,{id:"price",children:l.jsx(zg,{textVariant:"tiny",priceSymbols:e.price,priceRange:e.price_range,dollarColor:"light",currencySymbol:e.currency_char})})]})}),e.operating_hours&&l.jsx(RC,{place:e,textVariant:"tiny",showTooltip:!1}),l.jsx("div",{className:"invisible flex-1"})]}),e.image_url&&l.jsx("div",{className:"ml-sm size-20 flex-shrink-0 overflow-hidden rounded-sm",children:l.jsx(to,{alt:`${e.name} image`,src:e.image_url,includeLightBoxModal:!1,containerClassName:"size-full",imageClassName:"size-full object-cover"})})]})}),Qze=A.memo(function({submitQuery:t}){const{$t:n}=Q(),{session:r}=je(),{trackEvent:s}=Ze(r),{removeWidgetFromEntry:a}=uS({reason:"thread-content"}),o=bx(),i=OE(),{hasAccessToProFeatures:c}=Mt(),{result:u,widgetData:d,isEntryInFlight:m,financeWidgetData:p,newsWidgetData:h,weatherWidgetData:g,timeWidgetData:y,timerWidgetData:b,currencyExchangeWidgetData:x,predictionMarketWidgetData:_,calculatorWidgetData:v,flightStatusWidgetData:C,sportsWidgetData:w,priceComparisonWidgetData:S,genericFallbackWidgetData:E,taskWidgetData:T,highPriorityWidgets:k,lowPriorityWidgets:M,mapsPreviewData:N,isLastResult:P,onboardingWidgetData:O}=Pt(),{variation:L}=pLe(!1);FG({widgetType:"news",widgetName:"news_block",hasData:!!h?.web_results?.length,metricName:"web.frontend.news_block_received"});const{standardWidgetData:H,codeInterpreterImages:R}=d.reduce((ce,me)=>(me.is_code_interpreter&&me.is_image?ce.codeInterpreterImages.push(me):ce.standardWidgetData.push(me),ce),{standardWidgetData:[],codeInterpreterImages:[]}),I=f.useMemo(()=>R.length>0,[R]),F=f.useMemo(()=>!I&&H.length>0,[I,H]),G=f.useMemo(()=>!1,[h?.web_results,u?.display_model,L]),j=f.useCallback(ce=>{u?.frontend_context_uuid&&u?.backend_uuid&&(a({entryUUID:u.backend_uuid,data:ce}),s("remove widget",{url:"url"in ce?ce.url??"":"links"in ce?ce.links?.[0]?.url??"":"",entryUUID:u.backend_uuid,source:"thread"}))},[a,u?.backend_uuid,s,u?.frontend_context_uuid]),$=f.useCallback((ce,me,pe,xe)=>{const Oe=xe||("name"in ce?ce.name:"url"in ce?ce.url:"links"in ce?ce.links?.[0]?.url??"":"");return l.jsx(vGe,{data:ce,submit:t,isReadonly:me,menuItems:me||m?[]:[{type:"default",text:n({defaultMessage:"Report",id:"x5Tz6MZH82"}),icon:D("thumb-down"),onClick:()=>pe&&pe(ce)}],inFlight:m,entryUUID:u?.backend_uuid??null},Oe)},[m,t,n,u?.backend_uuid]),q=f.useCallback((ce,me,pe)=>{const xe={name:`${me}-widget`,snippet:"",timestamp:"",url:"",meta_data:ce,is_attachment:!1,is_image:!1,is_code_interpreter:!1,is_knowledge_card:!1,is_navigational:!1,is_widget:!0,sitelinks:[],inline_entity_id:""};return $(xe,o,j,pe)},[j,o,$]),U=f.useCallback(ce=>$(ce,o,j),[j,o,$]),X=f.useCallback(ce=>q(ce,"sports"),[q]),J=f.useCallback(ce=>q(ce,"weather"),[q]),ne=f.useCallback(ce=>q(ce,"time"),[q]),ae=f.useCallback(ce=>q(ce,"timer"),[q]),de=f.useCallback(ce=>q(ce,"currency_exchange"),[q]),oe=f.useCallback(ce=>q(ce,"prediction-market"),[q]),le=f.useCallback(ce=>q(ce,"calculator"),[q]),se=f.useCallback(ce=>q(ce,"flight-status"),[q]),re=f.useCallback(ce=>q(ce,"price-comparison"),[q]),he=f.useCallback(ce=>q(ce,"generic-fallback"),[q]),ie=f.useCallback(ce=>q(ce,"task"),[q]),ue=f.useCallback(ce=>q(ce,"onboarding"),[q]);return l.jsxs(l.Fragment,{children:[_&&oe(_),p&&l.jsx(OG,{data:p}),G&&h&&l.jsx(vLe,{results:h.web_results,entryUUID:u.backend_uuid,frontendContextUUID:u.frontend_context_uuid,contextUUID:u.context_uuid}),I&&R.map(ce=>l.jsx("div",{children:$(ce,o)},ce.url)),F&&k.map(U),E&&he(E),g&&J(g),y&&ne(y),b&&ae(b),x&&de(x),v&&le(v),C&&se(C),w&&X(w),S&&re(S),F&&M.map(U),N&&(N.place_widgets?.length??0)>0&&l.jsx(Yze,{placeWidgets:N.place_widgets??_e,backendUuid:u?.backend_uuid??"",contextUuid:u?.context_uuid??"",isLastResult:P}),c&&i&&T&&ie(T),O&&ue(O)]})}),zz=({target:e,entryUUID:t,frontendContextUUID:n,targetVisibilityPortionThreshold:r=.5,hasLLMToken:s,result:a})=>{const o=f.useRef(null),i=f.useRef(null),c=f.useRef(!1),{session:u}=je(),{trackEvent:d}=Ze(u),m=yr(),p=f.useRef(a);f.useEffect(()=>{p.current=a},[a]);const h=f.useCallback(()=>{if(o.current){const y=Math.round(performance.now()-o.current);d("thread entry exited",{entryUUID:t,frontendContextUUID:n,timeOnEntryMs:y}),o.current=null}if(i.current){const y=p.current;y&&m(y.display_model)==K.STUDIO&&Yt.isStatusPending(y)&&d("answer processing exited",{entryUUID:t,frontendContextUUID:n,timeOnEntryMs:Math.round(performance.now()-i.current)}),i.current=null}},[d,t,n,m]),g=f.useCallback(()=>{s&&(o.current=performance.now()),i.current||(i.current=performance.now())},[s]);return f.useEffect(()=>{const y=new IntersectionObserver(x=>{x.forEach(_=>{c.current=_.isIntersecting,_.isIntersecting&&document.visibilityState==="visible"?g():h()})},{threshold:r}),b=e.current;return b&&y.observe(b),()=>{b&&y.unobserve(b),h()}},[e,r,g,h]),f.useEffect(()=>{const y=()=>{document.visibilityState==="hidden"?h():document.visibilityState==="visible"&&c.current&&g()};return document.addEventListener("visibilitychange",y),()=>{document.removeEventListener("visibilitychange",y)}},[g,h]),f.useEffect(()=>{const y=()=>{c.current&&o.current&&h()};return window.addEventListener("beforeunload",y),()=>{window.removeEventListener("beforeunload",y)}},[h]),null},M2=({children:e})=>l.jsx("div",{className:"text-xs text-quieter italic flex gap-sm align-center",children:e});A.memo(function({displayModel:t,userSelectedModel:n,proactiveUpgradeReason:r,searchMode:s}){const a="model-display",o=Q(),{isMax:i,isEnterpriseMax:c}=Mt(),{getSearchModelLabel:u}=X0({reason:a}),d=Array.isArray(t)?t:null,m=typeof t=="string"?t:null;if(d&&d.length>1){const y=h0e({displayModels:d,intl:o,getSearchModelLabel:u});return y?l.jsx(M2,{children:y}):null}const p=m??d?.[0]??null;if(!p)return null;if(qX(p)===Ge.PERPLEXITY)return s==="RESEARCH"?l.jsx(M2,{children:o.formatMessage({defaultMessage:"Prepared by Deep Research",id:"QwN2NsLuLB"})}):null;const g=m0e({displayModel:p,userSelectedModel:n,getSearchModelLabel:u,intl:o,isMaxSubscriber:i||c,proactiveUpgradeReason:r});return g?l.jsx(M2,{children:g}):null});const Xze="pplx.browser.temporary-threads-enabled",Zze=A.memo(function({onDismiss:t}){const{$t:n}=Q(),{setCookie:r}=rN(Xze),s=f.useCallback(()=>{r("false"),t()},[r,t]);return l.jsx("div",{className:"mb-md",children:l.jsx(Zi,{title:n({defaultMessage:"Temporary thread",id:"SqQBmKTPH0"}),description:n({defaultMessage:"Threads that use your tabs expire after 30 days. Want Comet to learn from them? You can choose to keep them longer.",id:"C54sGvr6UW"}),size:"compact",leadingAccessory:D("custom-perplexity-temporary-thread"),onClose:t,closeButtonLabel:"Close",children:l.jsx(Zi.Action,{variant:"secondary",onClick:s,children:n({defaultMessage:"Keep threads longer",id:"FdgbPaLfOx"})})})})}),Jze=()=>{const{organization:e,isEnterprise:t,isLoading:n}=Hs({reason:"check-upsell-enterprise-consent"});return n?!0:t?!e?.settings?.product_communications_enabled:!1},N9=f.memo(function({isSamsungBrowser:t,isWindowsApp:n,isIPad:r,isComet:s,isFirefoxDefaultSearch:a,isPartnershipCampaign:o,isGovernment:i,isEnterpriseWithoutConsent:c,children:u}){const d=eo(),m=LP(),p=FP(),{isGovernmentRequestOrigin:h}=gr(),{device:{isWindowsApp:g,isSamsungBrowser:y,isIPad:b}}=jn(),x=h===void 0,_=Jze();return f.useMemo(()=>!!(s&&d||n&&g||t&&y||r&&b||a&&m||o&&p||i&&(x||h)||c&&_),[d,g,y,b,s,t,n,r,a,m,o,p,i,h,x,c,_])?null:u}),eqe=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"should-show-temporary-threads-banner",defaultValue:e,extraAttributes:t,subjectType:"comet_device_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])};function tqe({expiryTime:e,idx:t}){const[n,r]=f.useState(l$),s=mn(),a=!!e,o=t===0,{variation:i}=eqe(!1),c=f.useCallback(()=>{c$(),r(!0)},[]);return{shouldShow:s&&a&&o&&i&&!n,handleDismiss:c}}const nqe=Pe(async()=>{const{ThreadEntryFooter:e}=await W(async()=>{const{ThreadEntryFooter:t}=await import("./ThreadEntryFooter-Dpx0Skt6.js");return{ThreadEntryFooter:t}},__vite__mapDeps([425,3,2,12,1,9,5,7,8,6,426,24,25,15,26,13,427,36,428,429,430,83,431,432,433,434,14,16,17]));return{default:e}}),rqe=Pe(async()=>{const{RelatedContent:e}=await W(async()=>{const{RelatedContent:t}=await import("./RelatedContent-CAAdYSPE.js");return{RelatedContent:t}},__vite__mapDeps([435,2,3,5,1,430,15,6,7,8,9,35,13,12,14,16,17]));return{default:e}}),sqe=Pe(async()=>{const{ThreadContentResponse:e}=await W(async()=>{const{ThreadContentResponse:t}=await import("./ThreadContentResponse-DxK0IFrj.js");return{ThreadContentResponse:t}},__vite__mapDeps([436,3,2,5,1,6,7,8,9,437,438,12,13,427,426,24,25,15,26,36,428,429,430,83,431,432,433,14,16,17]));return{default:e}}),aqe=Pe(async()=>{const{SideBySideThreadContent:e}=await W(async()=>{const{SideBySideThreadContent:t}=await import("./SideBySideThreadContent-BXNO2P88.js");return{SideBySideThreadContent:t}},__vite__mapDeps([439,3,2,5,1,6,7,8,9,13,12,14,15,16,17]));return{default:e}}),oqe=A.memo(function({streamId:t,backendUuid:n}){throw new Lh("STREAM_FAILED_PLACEHOLDER_ERROR",{details:{request_id:t,backend_uuid:n}})}),iqe=A.memo(function({submitQuery:t,shouldShowProductFeedback:n,feedbackEntryUUID:r,deleteLastResult:s,setQuote:a,shouldShowRelatedContent:o=!0,sbsEntriesGroup:i,lastResultBuffer:c}){const u="thread-content",{session:d}=je();uS({reason:u});const{result:m,isEntryInFlight:p,response:h,hasLLMToken:g,isAnswerSkipped:y,steps:b,isPending:x,hasMediaOnlyLayout:_,isAgentWorkflowInFlight:v,isFinalStep:C,hasFastWidget:w,isLastResult:S,idx:E,hasAnswer:T,hasWebResults:k,searchImplementationMode:M,reasoningPlan:N,inlineClaims:P}=Pt(),{display_model:O,display_models:L,user_selected_model:H,status:R,text_completed:I,proactive_upgrade_reason:F,search_mode:G}=m;L?.[0];const j=N?.goals&&N.goals.length>0,$=M!=="multi_step"&&!j,q=cK(),U=OE(),X=f.useRef(null),{shouldShow:J,handleDismiss:ne}=tqe({expiryTime:m?.expiry_time,idx:E}),ae=f.useRef(null);zz({entryUUID:m?.backend_uuid??"",target:ae,targetVisibilityPortionThreshold:.3,frontendContextUUID:m?.frontend_context_uuid??"",hasLLMToken:g,result:m});const de=Xt(),oe=nhe(),le=BN(m?.frontend_uuid),se=uK(m?.backend_uuid),re=Yt.isStatusFailed(m),he=re&&m.reconnectable&&le;f.useEffect(()=>{de.maybeSendSearchResult(h,b,x)},[x,k,h,de,b]);const ie=f.useCallback(()=>{q(m.backend_uuid??"")||Jg("Retry stream")},[m.backend_uuid,q]),ue=f.useMemo(()=>()=>l.jsx(om,{retryFn:ie,errorCode:se?.code}),[ie,se?.code]),me=f.useMemo(()=>!!(_||y||w||!v&&(C||w)),[_,y,v,C,w])?"thread":"steps",pe=Yt.isStatusCompleted({status:R})||I;return l.jsxs(l.Fragment,{children:[i.length>1&&l.jsx(aqe,{result:m,sbsEntriesGroup:i,isThreadAuthor:U,hasAnswer:T,session:d}),l.jsx(N9,{isSamsungBrowser:!0,isFirefoxDefaultSearch:!0,children:l.jsx(Cf,{position:"top",idx:E,upsellInformation:m.blocking_banner_information,backendUuid:m?.backend_uuid,isLastResult:S,inFlight:p})}),oe&&p&&l.jsx(the,{data:oe}),l.jsxs($d,{value:me,animation:"fade",children:[l.jsx($d.Panel,{value:"steps",children:l.jsx(J1,{loading:v,isFastSearch:$})}),l.jsx($d.Panel,{value:"thread",children:l.jsx(C7e,{children:l.jsxs("div",{className:"gap-y-md flex flex-col",children:[!w&&l.jsx(J1,{isFastSearch:$,loading:v}),l.jsx(Qze,{submitQuery:t}),w&&l.jsx(J1,{isFastSearch:$,loading:v}),l.jsx(sqe,{submitQuery:t,setQuote:a,markdownRef:X,response:h,inlineClaims:P}),!1,pe&&l.jsx(nqe,{submitQuery:t,deleteLastResult:s,showFeedbackCue:n,markdownRef:X,bottomOffsetPx:c}),l.jsx(N9,{isSamsungBrowser:!0,isFirefoxDefaultSearch:!0,children:l.jsx(Cf,{position:"bottom",idx:E,upsellInformation:m.upsell_information,backendUuid:m?.backend_uuid,isLastResult:S,inFlight:p,contextUuid:m?.context_uuid})}),J&&l.jsx(Zze,{onDismiss:ne})]})})})]}),l.jsxs("div",{className:"gap-y-lg flex flex-col first:mt-0",children:[re&&!he&&l.jsx(ar,{fallback:ue,children:l.jsx(oqe,{streamId:se?.id.description??"unknown",backendUuid:se?.entryId??"unknown"})}),o&&l.jsx(rqe,{shouldShowProductFeedback:n,feedbackEntryUUID:r,submitQuery:t})]})]})}),T2=2,lqe=1,R9={number:5,threshold:.93},cqe=e=>{if(!mn())return lqe;if(!e)return T2;const t=e.mhe_predictions_full?.comet_nav_widget?.probability;return t&&t>=R9.threshold?R9.number:T2},uqe=({source:e,isCometNavigation:t,querySource:n,omnisearch:r,navigationTimer:s,addStreamTimingOnce:a})=>{if(s?.addTimingOnce("web.frontend.nav_results_shown_v2",{omnisearch:r,is_comet_navigation:t}),n==="default_search"){a("web.frontend.omnisearch_nav_results_shown",{omnisearch:r,is_comet_navigation:t,source:e});return}a("web.frontend.nav_results_shown",{is_comet_navigation:t,source:e})},dqe=e=>{const{result:{classifier_results:t,query_source:n}}=Pt(),r=yE(),{data:s}=gt({queryKey:SR(e),enabled:!1}),{classifierResults:a}=Sn(),o=t,i=typeof o<"u",c=a[e],u=typeof c<"u",d=n==="default_search";return f.useEffect(()=>{d&&(i&&r("web.frontend.browser.mhe_loaded_ms"),u&&r("web.frontend.browser.mhe_extension_loaded_ms"))},[i,u,d,r]),s??c??o},fqe=(e,t,n)=>{const{value:r,loading:s}=Nl({flag:"nav-intent-classifier",defaultValue:e,extraAttributes:t,subjectType:"visitor_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])},mqe=(e,t)=>t.classifier==="comet_nav_widget"?e.mhe_predictions_full?.comet_nav_widget:t.classifier==="comet_nav_widget_combined_target"?e.mhe_predictions_full?.comet_nav_widget_combined_target:e.mhe_predictions_full?.comet_nav_widget,pqe=(e,t)=>{const n=eo(),r=mqe(e,t);if(!n)return"top";if(t.use_default_threshold)return r?.is_true?"top":"hidden";const a=t.threshold,o=r?.probability,i=o!=null&&!isNaN(o)&&!isNaN(a)&&o>=a;return r&&i?"top":"hidden"},hqe=(e,t)=>{if(!t)return"hidden";const n=t?.mhe_predictions;return n?.personal_search||n?.skip_search||n?.image_generation_intent||n?.time_widget||n?.weather_widget||n?.calculator_widget?"hidden":e.classifier==="nav_intent"?"top":e.classifier==="comet_nav_widget"||e.classifier==="comet_nav_widget_combined_target"?pqe(t,e):"top"},gqe={classifier:"nav_intent",use_default_threshold:!0,threshold:0},yqe=({classifierResults:e,resultStatus:t})=>{const n=typeof e>"u",{variation:r,loading:s}=fqe(gqe),a=hqe(r,e),o=f.useMemo(()=>s||n||Object.keys(e??{}).length===0&&t==="COMPLETED"?!0:a==="hidden",[a,n,e,t,s]),i=f.useMemo(()=>!n,[n]);return f.useMemo(()=>({shouldHideNavResults:o,classificationsLoaded:i,navResultsPosition:a}),[o,i,a])};function xqe(e){if(e)return[{...e,url:e?.url??"",title:e?.name??"",snippet:e?.snippet??"",sitelinks:e?.sitelinks?.slice(),site_name:e?.meta_data?.domain_name||e?.meta_data?.citation_domain_name}]}const bqe=({queryStr:e,webResults:t,streamId:n,resultUuid:r,searchMode:s,isFirstResult:a,attachmentsLength:o,focusIsWriting:i,isStudyMode:c,resultStatus:u,querySource:d})=>{const m=It(),p=yE(),h=FC(),g=dqe(n??""),y=f.useMemo(()=>t?.filter(H=>H.is_navigational)?.flatMap(H=>xqe(H)||[]),[t]),{data:b}=gt({queryKey:P2(e??""),enabled:!1}),x=eo(),{navigationResults:_,actions:{getNavigationResultsTimer:v}}=Sn(),C=_[n??""]??_e,w=BN(n),S=f.useMemo(()=>C.length>0,[C]),E=f.useMemo(()=>cqe(g),[g]),T=f.useMemo(()=>x?w||C.length>0?C:y?.map(H=>({...H,is_cached:!1,navigation_source:Td.WEB_RESULTS}))??_e:w||(b?.length??0)>0?b?.map(H=>({...H,is_cached:!0,navigation_source:Td.SEARCH_V3_NAVIGATE}))??_e:y?.map(H=>({...H,is_cached:!1,navigation_source:Td.WEB_RESULTS}))??_e,[x,w,C,b,y]),k=f.useMemo(()=>T?{serverRequestTimestamp:m.getQueryData(["serverRequestTimestamp",e??void 0,r??void 0])}:{serverRequestTimestamp:void 0},[m,e,T,r]),M=f.useMemo(()=>T?.slice(0,E)?.map((H,R)=>({...H,position:R,source:k.serverRequestTimestamp?"default_search":"client_search",client_request_timestamp:h(),unstable_server_request_timestamp:k.serverRequestTimestamp||void 0,sitelinks:H.sitelinks?.map((I,F)=>({url:I.url,title:I.title,position:F,snippet:I?.snippet??""})),is_comet_navigation:S,navigation_source:S?Td.COMET:"navigation_source"in H?H.navigation_source:void 0})),[h,T,k.serverRequestTimestamp,S,E]),{shouldHideNavResults:N,navResultsPosition:P}=yqe({classifierResults:g,resultStatus:u}),O=f.useMemo(()=>a&&!1,[N,M,o,i,s,c,a,P]),L=f.useCallback(()=>{const H=M?.[0]?.navigation_source,R=v(n??"")??null;uqe({source:H,isCometNavigation:S,querySource:d,omnisearch:h()!==0,navigationTimer:R,addStreamTimingOnce:p})},[M,S,d,p,h,n,v]);return{navResults:M,shouldShowNavResults:O,trackNavResultsShown:L}},_qe=A.memo(function({sbsEntriesGroup:t,submitQuery:n,shouldShowProductFeedback:r,feedbackEntryUUID:s,deleteLastResult:a,setQuote:o,lastResultBuffer:i}){const{result:c,response:u,hasLLMToken:d,searchMode:m,isFirstResult:p,webResults:h,steps:g,isPending:y}=Pt();Lme(),Ome();const b=f.useMemo(()=>{if(!c?.query_str)return"";const{actualQuery:M}=hD(c.query_str);return M||""},[c?.query_str]),x=f.useRef(null);zz({entryUUID:c?.backend_uuid??"",target:x,targetVisibilityPortionThreshold:.3,frontendContextUUID:c?.frontend_context_uuid??"",hasLLMToken:d,result:c});const _=c?.frontend_uuid,v=f.useMemo(()=>c?.search_focus==="writing",[c?.search_focus]),C=f.useMemo(()=>c?.display_model==="pplx_study",[c?.display_model]),{navResults:w,shouldShowNavResults:S,trackNavResultsShown:E}=bqe({queryStr:c?.query_str,webResults:h,streamId:_,resultUuid:c?.uuid,searchMode:m,isFirstResult:p,attachmentsLength:c.attachments?.length??0,focusIsWriting:v,isStudyMode:C,resultStatus:c?.status??"",querySource:c?.query_source}),T=Xt(),k=f.useMemo(()=>!!h&&h.length>0,[h]);return f.useEffect(()=>{T.maybeSendSearchResult(u,g,y)},[y,k,u,T,g]),l.jsxs("div",{className:"gap-y-lg flex flex-col",ref:x,children:[S&&w&&l.jsx(Qme,{navResults:w,queryStr:b,querySource:c?.query_source,backendUUID:c?.backend_uuid,frontendUUID:c?.frontend_uuid,contextUUID:c?.context_uuid,webResults:h??[],isEntryInFlight:y,onMount:E}),l.jsx(iqe,{submitQuery:n,shouldShowProductFeedback:r,feedbackEntryUUID:s,deleteLastResult:a,setQuote:o,sbsEntriesGroup:t,lastResultBuffer:i})]})}),vqe=Pe(async()=>{const{ThreadEntryDebugTiming:e}=await W(async()=>{const{ThreadEntryDebugTiming:t}=await import("./ThreadEntryDebugTiming-BiuqRejy.js");return{ThreadEntryDebugTiming:t}},__vite__mapDeps([440,2,3,5,1,22,12,9,7,8,407,14]));return{default:e}},{restricted:!0}),Cqe=Pe(async()=>{const{BugReportModal:e}=await W(async()=>{const{BugReportModal:t}=await import("./DebugModal-SWCju8ge.js");return{BugReportModal:t}},__vite__mapDeps([441,2,3,5,1,7,8,6,9,434,12,22,13,14,15,16,17]));return{default:e}},{loading:()=>l.jsx(Il,{}),restricted:!0}),wqe=({isLastResult:e,title:t,backend_uuid:n,width:r,children:s,animate:a=!1})=>{const{openModal:o}=Kt(),i=f.useCallback(()=>{o(Cqe,{})},[o]),c=WS({from:{opacity:0,y:30},to:{opacity:1,y:0},config:$w,immediate:!a});return l.jsx(Jr.div,{style:c,className:"bg-base erp-sidecar:pt-0 erp-mobile-sidecar:pt-0",children:l.jsxs("div",{className:z("mx-auto",{"max-w-threadContentWidth":r==="default","max-w-none":r==="full","max-w-threadWidth":r==="wide"}),children:[t&&l.jsx("div",{className:"max-w-threadContentWidth relative isolate z-20 mx-auto",children:t}),s&&l.jsx("div",{className:"mt-xs",children:s}),l.jsx(vqe,{backend_uuid:n,onBugReportClick:i,expandedDefault:e})]})})},Sqe=A.memo(wqe),Eqe=A.memo(function({submitQuery:t}){const n="trigger-entry-rewrite",r=nn(),{result:{backend_uuid:s,frontend_context_uuid:a,attachments:o,display_model:i,query_str:c},idx:u}=Pt(),d=bx(),m=window.location.hash.slice(1),p=parseInt(m,10),h=r?.get("rw")==="true";return f.useEffect(()=>{if(!h||isNaN(p)||u!==p)return;zh({rw:void 0});const g=()=>t({rawQuery:c??"",existingEntryUUID:s,redoSearch:!0,collection:null,newFrontendContextUUID:null,existingFrontendContextUUID:d?void 0:a,promptSource:"user",querySource:"rewrite-url-param",attachments:o,modelPreferenceOverride:i});s?Cu({entryUUID:s,reason:n}).catch(y=>{Z.error("Error terminating entry",y)}).finally(g):g()},[h,d,t,p,u,s,c,a,o,i]),null}),kqe=A.memo(function(){return l.jsx(Tr,{children:l.jsx(Y,{variant:"subtler",className:"h-[180px] w-full overflow-hidden rounded-xl [mask-image:linear-gradient(to_bottom,#000_0%,transparent_160px)]"})})}),zm=A.memo(function({type:t,className:n,queryString:r}){const s=Q(),a=f.useMemo(()=>{const o="font-medium",i="opacity-80";switch(t){case"images":return s.formatMessage({defaultMessage:"<light>Image results for:</light> <bold>{queryString}</bold>",id:"VzXivLJ8I5"},{queryString:r,bold:c=>l.jsx("span",{className:o,children:c}),light:c=>l.jsx("span",{className:i,children:c})});case"videos":return s.formatMessage({defaultMessage:"<light>Video results for:</light> <bold>{queryString}</bold>",id:"2ZaRrQuRh/"},{queryString:r,bold:c=>l.jsx("span",{className:o,children:c}),light:c=>l.jsx("span",{className:i,children:c})});case"sources":return s.formatMessage({defaultMessage:"<light>Search results for:</light> <bold>{queryString}</bold>",id:"Fjmx7PbD5i"},{queryString:r,bold:c=>l.jsx("span",{className:o,children:c}),light:c=>l.jsx("span",{className:i,children:c})});case"shopping":return s.formatMessage({defaultMessage:"<light>Shopping results for:</light> <bold>{queryString}</bold>",id:"pB1ogBtGI4"},{queryString:r,bold:c=>l.jsx("span",{className:o,children:c}),light:c=>l.jsx("span",{className:i,children:c})});case"jobs":return s.formatMessage({defaultMessage:"<light>Job results for:</light> <bold>{queryString}</bold>",id:"NLhbH5fRMB"},{queryString:r,bold:c=>l.jsx("span",{className:o,children:c}),light:c=>l.jsx("span",{className:i,children:c})});case"places":return s.formatMessage({defaultMessage:"<light>Place results for:</light> <bold>{queryString}</bold>",id:"0FDKKyti5d"},{queryString:r,bold:c=>l.jsx("span",{className:o,children:c}),light:c=>l.jsx("span",{className:i,children:c})});case"news":return s.formatMessage({defaultMessage:"<light>News results for:</light> <bold>{queryString}</bold>",id:"1WNrJFhFTc"},{queryString:r,bold:c=>l.jsx("span",{className:o,children:c}),light:c=>l.jsx("span",{className:i,children:c})});default:return""}},[r,t,s]);return r?l.jsx(B,{variant:"small",color:"light",className:z("mb-md",n),children:a}):null}),Mqe=f.memo(function(){const{isMobileStyle:t}=Be();return l.jsxs(l.Fragment,{children:[l.jsx(zm,{type:"shopping",queryString:""}),l.jsxs(Tr,{className:"-mx-md pl-md md:mx-auto md:pl-0",children:[l.jsx("div",{className:"gap-md md:mb-lg mb-md flex auto-rows-fr grid-cols-2 overflow-hidden md:grid md:grid-cols-3",children:Array.from({length:3}).map((n,r)=>l.jsx(Tqe,{},r))}),l.jsxs("div",{className:"gap-sm flex flex-col",children:[l.jsxs("div",{className:"grid grid-cols-1 grid-rows-1 items-center",children:[l.jsx(B,{variant:t?"base":"section-title",className:"col-start-1 row-start-1",children:""}),l.jsx("div",{className:"bg-subtler col-start-1 row-start-1 h-3 w-32 grow rounded-full md:h-4"})]}),l.jsx("div",{className:"gap-md pr-md flex auto-rows-fr grid-cols-2 flex-col md:grid md:pr-0",children:Array.from({length:2}).map((n,r)=>l.jsx(Aqe,{},r))})]})]})]})}),Tqe=f.memo(function(){return l.jsx("div",{className:"bg-subtler aspect-video h-[327px] w-[70vw] grow rounded-xl md:h-[413px] md:w-full"})}),Aqe=f.memo(function(){return l.jsx("div",{className:"bg-subtler aspect-video h-[144px] w-full grow rounded-md"})}),CQe=()=>Se.makeQueryKey("/rest/jobs/filters",{}),Nqe=e=>Se.makeQueryKey("/rest/sources/search",e),Rqe=10,Dqe=async({request:e,reason:t})=>{if(e.page&&e.page>Rqe)throw new Ue("API_CLIENTS_ERROR",{message:"Max search results page number is too large",status:400});const{data:n}=await ve.POST("/rest/sources/search",t,{body:{entry_uuid:e.entry_uuid,limit:e.limit,page:e.page??null},timeoutMs:hs.MEDIUM});return n},Iqe=({request:e,enabled:t,reason:n})=>gt({queryKey:Nqe(e.entry_uuid),queryFn:async()=>(await Dqe({request:e,reason:n})).results,enabled:t}),jqe=A.memo(function({webResult:t,citationIndex:n,isRelatedResult:r}){const s="sources-row",{result:{backend_uuid:a,context_uuid:o,frontend_context_uuid:i}}=Pt(),c=Xt(),u=mn(),d=t.url??"",m=d?Xr(d):!1,p=Qf(t),{session:h}=je(),{trackEvent:g}=Ze(h),y=f.useCallback((T,k)=>{u&&c.openTab({url:T,tabId:k})},[u,c]),{mutate:b}=uE({reason:s,onSuccess:u?y:void 0}),x=LE(),_=cF(t),v=jE(t),{getImageDownloadUrl:C}=J0({reason:s}),[w,S]=f.useState(null);f.useEffect(()=>{w===null&&(async()=>{if(!m){S(d||null);return}if(d&&iN(d)){S(d);return}try{const k=await C({url:d,thread_id:a});S(k)}catch(k){Z.error(`Failed to fetch image source ${k}`),S(d||null)}})()},[C,a,t,m,w,d]),f.useEffect(()=>{g("source card viewed",{citation_url:d,position:n,title:t.name??"",contextUUID:o,frontendContextUUID:i,entryUUID:a,source:r?"sourcesTabViewMore":"sourcesTab"})},[t,g,n,r,o,i,a,d]);const E=f.useCallback(async T=>{const k=t.meta_data;try{const N=k?.file_uuid?"fileRepositoryFile":t.is_attachment?"fileAttachment":r?"sourcesTabViewMore":"sourcesTab",P=AF(t),{type:O,memoryKey:L}=P,H=vS(t);g("click citation",{citation_url:d,contextUUID:o,frontendContextUUID:i,entryUUID:a,isMemory:t.is_memory,isConversationHistory:t.is_conversation_history,source:N,...H,...O==="memory"&&{memory_key:L}})}catch(N){Z.error("Failed to send click citation event:",N)}if(_&&!v){T.preventDefault(),x(t);return}if(p){T.preventDefault();return}if(Yf(t)){T.preventDefault(),b({file_url:d});return}if(Mw(T)){T.preventDefault(),c.openTab({url:d,tabId:t.tab_id}).catch(()=>{window.open(d,"_blank")});return}},[_,t,r,g,o,i,a,x,c,b,v,p,d]);return l.jsx(lm.WebResult,{result:t,onClick:E,badge:xo(t)&&l.jsx(FI,{result:t})})});function Pqe(){const{blocksByIntendedUsage:{answer_tabs:e},steps:t,result:{query_str:n}}=Pt(),r=f.useMemo(()=>{const s=e?.answer_tabs_block?.reformulated_queries??[];if(s[0])return s[0];const a=t.find(o=>o.step_type==="SEARCH_WEB")?.content.queries?.[0]?.query;return a||(n??"")},[e?.answer_tabs_block?.reformulated_queries,n,t]);return f.useMemo(()=>({reformulatedQuery:r}),[r])}const Oqe=Pe(async()=>{const{LoginModal:e}=await W(async()=>{const{LoginModal:t}=await import("./LoginModal-D844be60.js");return{LoginModal:t}},__vite__mapDeps([48,2,3,5,1,6,7,8,9,10,11,12,13,49,14,15,16,17]));return{default:e}}),Lqe=10,Fqe=2,Uqe=A.memo(function(){const t="sources-mode",{$t:n}=Q(),r=Bqe({dedupeAttachments:!0}),{isEntryInFlight:s,result:a}=Pt(),{firstResult:o}=Ht(),{reformulatedQuery:i}=Pqe(),u=a===o?a.query_str??"":i,d=wt(),{openModal:m}=Kt(),p=d&&!s&&r.selectedSources.length==0&&r.reviewedSources.length==0&&r.unsortedSources.length==0,{data:h,isLoading:g,refetch:y}=Iqe({request:{entry_uuid:a.backend_uuid??"",limit:Lqe,page:Fqe},enabled:p,reason:t});f.useCallback(()=>{if(!d){m(Oqe,{origin:Ke.SOURCES_VIEW_MORE});return}y()},[y,d,m]);const b=!1,x=f.useMemo(()=>r.attachedSources.length>0||r.selectedSources.length>0||r.reviewedSources.length>0||r.reviewingSources.length>0||r.unsortedSources.length>0,[r.attachedSources.length,r.selectedSources.length,r.reviewedSources.length,r.reviewingSources.length,r.unsortedSources.length]);return l.jsxs(l.Fragment,{children:[l.jsx(zm,{type:"sources",queryString:u,className:x?"pb-sm":void 0}),l.jsxs("div",{children:[l.jsx(Ed,{heading:r.selectedSources?.length>0?n({defaultMessage:"Attached",id:"2IacYt8NB7"}):void 0,sources:r.attachedSources}),l.jsx(Ed,{heading:r.attachedSources?.length>0?n({defaultMessage:"Sourced",id:"P5KqlvUgRC"}):void 0,sources:r.selectedSources}),l.jsx(Ed,{heading:n({defaultMessage:"Reviewed",id:"wiy+GNv+BV"}),sources:r.reviewedSources}),l.jsx(Ed,{heading:n({defaultMessage:"Reviewing",id:"L+ISAVX7+d"}),sources:r.reviewingSources,shimmer:!0}),l.jsx(Ed,{sources:r.unsortedSources}),b]})]})}),Ed=A.memo(function({sources:t,heading:n,shimmer:r=!1}){return t.length===0?null:l.jsxs("div",{className:"my-md md:mt-lg group first:mt-0",children:[n?l.jsxs("div",{className:"mb-md relative",children:[l.jsx("hr",{className:"bg-subtle absolute top-1/2 h-px w-full border-0 group-first:hidden"}),l.jsx("div",{className:"bg-base",children:l.jsx(B,{variant:"tiny",color:"light",className:"mb-md bg-base pr-sm relative z-[1] w-fit",children:l.jsx(Tr,{variant:"super",active:r,as:"span",children:n})})})]}):null,l.jsx(lm.List,{children:t.map(s=>l.jsx(jqe,{webResult:s.web_result,citationIndex:s.citation??0},s.web_result?.url))})]})}),Bqe=({dedupeAttachments:e=!1})=>{const{result:t,blocksByIntendedUsage:{web_results:n}}=Pt(),r=Hqe({attachments:t.attachments??_e});return f.useMemo(()=>{const s=new Map,a=[],o=(n?.web_result_block?.web_results??[]).map(h=>({status:"UNSORTED",web_result:h,citation:0})),i=o.some(h=>h.web_result?Xk(h.web_result):!1);for(const h of o){const g=h.web_result?.is_attachment&&!Xk(h.web_result);if(g&&a.push(h),!g||!e){const y=s.get(h.status)??[];y.push(h),s.set(h.status,y)}}const c=s.get("SELECTED")??_e,u=s.get("REVIEWED")??_e,d=s.get("REVIEWING")??_e,m=s.get("UNSORTED")??_e;!i&&a.length===0&&r.length>0&&a.push(...r);const p=[...c,...u,...d,...m].slice(0,3)?.map(h=>h.web_result?.url??"");return{attachedSources:a,selectedSources:c,reviewedSources:u,reviewingSources:d,unsortedSources:m,topSources:p}},[n?.web_result_block?.web_results,r,e])},Hqe=({attachments:e})=>e.map(t=>({web_result:{name:El(t),url:t,is_attachment:!0,is_image:Xr(t),is_code_interpreter:!1,is_knowledge_card:!1,is_navigational:!1,is_widget:!1,sitelinks:[],snippet:"",timestamp:"",meta_data:{},inline_entity_id:""},status:"UNKNOWN",citation:0})),Vqe=({webResults:e})=>vi(t=>({isShowing:!1,webResults:e,actions:{hide:()=>t({isShowing:!1}),show:n=>t({...n,isShowing:!0})}})),{Context:Gqe,useTrackedState:zqe}=dN("SourcesListContext"),qqe=f.memo(function({children:t,webResults:n}){const[r]=A.useState(()=>Vqe({webResults:n}));return f.useEffect(()=>{r.setState({webResults:n})},[n,r]),l.jsx(Gqe.Provider,{value:r,children:t})}),wQe=zqe,qz=A.memo(function(){return l.jsxs("div",{className:"gap-md @container flex w-full flex-row",children:[l.jsx("div",{className:"md:@[1458px]:w-[874px] md:@[1458px]:shrink-0 w-full md:w-3/5",children:l.jsx(Wqe,{})}),l.jsx("div",{className:"@md:w-[570px] @md:@[1458px]:w-full hidden md:block",children:l.jsx($qe,{})})]})}),$qe=A.memo(function(){return l.jsx(Tr,{children:l.jsx(Y,{variant:"subtler",className:"sticky h-[180px] w-full overflow-hidden rounded-xl [mask-image:linear-gradient(to_bottom,#000_0%,transparent_160px)]"})})}),Wqe=A.memo(function(){return l.jsx(Tr,{children:l.jsx("div",{className:"gap-md grid h-[180px] grid-cols-[repeat(auto-fill,minmax(220px,1fr))] overflow-hidden [mask-image:linear-gradient(to_bottom,#000_0%,transparent_160px)]",children:Array.from({length:8}).map((t,n)=>l.jsx(Kqe,{},n))})})}),Kqe=A.memo(function(){return l.jsx("div",{className:"bg-subtler aspect-[4/3] w-full rounded-xl"})}),Yqe=(e,t,n)=>{const{value:r,loading:s}=Lt({flag:"enable-share-prompts",defaultValue:e,extraAttributes:t,subjectType:"user_nextauth_id",shortCircuitCases:n});return f.useMemo(()=>({variation:r,loading:s}),[r,s])};function Qqe({entryUUID:e,reason:t,callback:n}){const[r,s]=f.useState(!1),a=f.useRef(!1),{inFlight:o}=Ht();return f.useEffect(()=>{!o&&a.current&&(a.current=!1,s(!1),n())},[o,n]),{terminateEntry:async()=>{a.current=!0,s(!0),await Cu({entryUUID:e,reason:t})},isTerminating:r}}const Xqe=({maxHeightPx:e})=>{const[t,n]=f.useState(null),[r,s]=f.useState(!1),[a,o]=f.useState(!1),[i,c]=f.useState(0),u=f.useCallback(d=>{n(d),d&&o(!1)},[]);return f.useLayoutEffect(()=>{if(!t||typeof window>"u")return;const d=new ResizeObserver(m=>{for(const p of m){const h=p.target.scrollHeight;o(!0),c(h),s(h>e)}});return d.observe(t),()=>{d.disconnect()}},[t,e]),f.useMemo(()=>({ref:u,isTruncated:r,hasMeasured:a,scrollHeight:i}),[r,a,i,u])},Zqe=({maxHeight:e,children:t,buttonLabels:n,buttonTestId:r,className:s,onExpandedChange:a,onTruncatedChange:o})=>{const{ref:i,isTruncated:c,hasMeasured:u,scrollHeight:d}=Xqe({maxHeightPx:e}),[m,p]=f.useState(!1);f.useEffect(()=>{u&&o?.(c)},[c,u,o]);const h=f.useCallback(()=>{p(v=>{const C=!v;return a?.(C),C})},[a]),g=Mo(u),y=u&&g,b=f.useMemo(()=>u?{height:c&&!m?e:d,transition:y?"height 200ms cubic-bezier(0.16, 1, 0.3, 1)":"none",overflow:"hidden"}:{maxHeight:e,transition:"none",overflow:"hidden"},[u,c,m,d,y,e]),x=u&&c&&!m,_=f.useMemo(()=>({maskImage:x?"linear-gradient(to bottom, black 70%, transparent 97%)":void 0}),[x]);return l.jsxs("div",{className:s,children:[l.jsx("div",{style:_,children:l.jsx("div",{style:b,children:l.jsx("div",{ref:i,children:t})})}),c&&l.jsx("div",{className:z("top-xs relative flex",{"-mt-2":!m}),children:l.jsx("div",{className:"-mt-0.5","data-testid":r,children:l.jsx(at,{size:"tiny",variant:"text",onClick:h,trailingIcon:m?D("chevron-up"):D("chevron-down"),children:m?n.showLess:n.showMore})})})]})},Jqe=f.memo(function({children:t,className:n,hasAttachments:r}){return l.jsx("div",{className:z("flex min-w-[48px] items-center justify-center","bg-offset text-foreground rounded-2xl p-3 font-sans text-base font-normal select-none",{"rounded-br-none":r},n),children:l.jsx("span",{className:"select-text",style:{overflowWrap:"anywhere"},children:t})})}),e$e={maskImage:"linear-gradient(to bottom, black 50%, transparent)"};function t$e({entryUUID:e,displayQueryStr:t,inFlight:n,onSubmitEdit:r}){const[s,a]=f.useState(t??""),[o,i]=f.useState(!1),{trackEvent:c}=fE(),u=Mi(),{setActiveThreadTab:d}=Oo();f.useEffect(()=>{n&&i(!1)},[n]);const m=f.useCallback(()=>{s!==t&&r(s),i(!1),d("default")},[s,t,r,i,d]),{terminateEntry:p,isTerminating:h}=Qqe({entryUUID:e,reason:"editable-thread-title",callback:m}),g=f.useCallback(async()=>{u&&await p()},[u,p]),y=f.useCallback(()=>{u&&(c("confirm edit query click",{entryUUID:e,newQuery:s}),m())},[u,e,m,c,s]),b=f.useCallback(()=>{n?g():y()},[n,g,y]),x=f.useCallback(()=>{a(t??""),i(!1),c("cancel edit query click",{entryUUID:e})},[e,t,c]),_=f.useCallback(()=>{a(t??""),i(!0)},[t]),v=!!u;return f.useMemo(()=>({handleEditButtonClick:_,handleCancelEditQuery:x,handleConfirmEditQuery:b,isTerminating:h,canEdit:v,editQueryValue:s,setEditQueryValue:a,isEditingQuery:o}),[_,x,b,h,v,s,o])}function n$e({entryUUID:e,displayQueryStr:t}){const{$t:n}=Q(),{trackEvent:r}=fE(),{openToast:s}=cn(),[a,o]=f.useState(!1),{variation:i}=Yqe(!1),c=i&&!1,u=f.useCallback(d=>{d.preventDefault(),navigator.clipboard.writeText(t??""),o(!0),setTimeout(()=>o(!1),2e3),r("click copy query button",{entryUUID:e})},[t,c,s,n,r,e]);return f.useMemo(()=>({handleCopyButtonClick:u,showCopyCheckmark:a}),[u,a])}const r$e=f.memo(function({entryUUID:t,onSubmitEdit:n,isFirstResult:r,hasAttachments:s,inFlight:a,isFailed:o,isEditDisabled:i,selectedRefinementQuery:c,queryStr:u}){const d=f.useRef(null),[m,p]=f.useState(!1),[h,g]=f.useState(!1);mu("thread-title",{skip:!r});const y=c??u,{quote:b,actualQuery:x}=hD(y),{handleEditButtonClick:_,handleCancelEditQuery:v,handleConfirmEditQuery:C,isTerminating:w,canEdit:S,editQueryValue:E,setEditQueryValue:T,isEditingQuery:k}=t$e({entryUUID:t,displayQueryStr:x,inFlight:a,onSubmitEdit:n}),{handleCopyButtonClick:M,showCopyCheckmark:N}=n$e({entryUUID:t,displayQueryStr:y}),P=f.useCallback(O=>{Zr.isEnterKeyWithoutShift(O)?(O.preventDefault(),C()):Zr.isEscapeKey(O)&&v()},[C,v]);return l.jsxs("div",{className:"relative z-10",children:[b&&l.jsx(s$e,{quote:b}),l.jsxs("div",{className:"group relative flex items-end gap-0.5",children:[l.jsx("div",{className:"-inset-md pointer-events-none absolute select-none"}),l.jsx("div",{className:"relative min-w-0 flex-1 flex justify-end",children:k?l.jsx(f$e,{onKeyDown:P,editQueryValue:E,setEditQueryValue:T,inputRef:d}):l.jsxs("div",{className:"flex items-start gap-2",children:[l.jsx(a$e,{showActions:S,isEditButtonDisabled:i,showCopyCheckmark:N,onEditClick:_,onCopyClick:M,isExpanded:m,isTruncated:h}),l.jsx(d$e,{hasAttachments:s,queryString:x??"",isFirstResult:r,isFailed:o,onExpandedChange:p,onTruncatedChange:g})]})})]}),k&&l.jsx(o$e,{style:e$e,isTerminating:w,onCancel:v,onConfirm:C})]})}),s$e=f.memo(function({quote:t}){return l.jsx("div",{className:"mb-sm flex justify-end",children:l.jsxs(B,{variant:"small",color:"light",className:"bg-offset rounded-2xl py-sm px-3 inline-flex items-center",children:[l.jsx(ut,{name:D("quote"),size:18,className:"text-super mr-sm shrink-0 -translate-y-px rotate-180"}),l.jsx("span",{className:"line-clamp-1",children:t})]})})}),a$e=f.memo(function({showActions:t,isEditButtonDisabled:n,showCopyCheckmark:r,onEditClick:s,onCopyClick:a,isExpanded:o,isTruncated:i}){const{$t:c}=Q(),{isMobileUserAgent:u}=Be();return l.jsxs("div",{className:z("flex shrink-0 items-center gap-1","opacity-0","transition-opacity duration-150","sticky",u?"top-[calc(var(--mobile-tab-bar-height)+var(--size-md))]":"top-sm","py-sm",i&&(o?"pb-8":"pb-6"),"pointer-events-none",t&&"group-hover:pointer-events-auto group-hover:opacity-100 focus-within:pointer-events-auto focus-within:opacity-100"),"aria-hidden":!t,children:[l.jsx(at,{icon:D("pencil"),variant:"text",size:"small",rounded:!0,onClick:s,disabled:n,"aria-label":c({defaultMessage:"Edit Query",id:"b3OoXBV5TQ"})}),l.jsx(at,{icon:r?D("check"):D("copy"),variant:"text",size:"small",rounded:!0,onClick:a,"aria-label":c({defaultMessage:"Copy Query",id:"pLS6m4WFYK"})})]})}),o$e=f.memo(function({style:t,isTerminating:n,onCancel:r,onConfirm:s}){return l.jsxs("div",{className:"gap-x-sm my-sm pb-sm w-full absolute top-full flex justify-end",children:[l.jsx(Y,{className:"-inset-lg -top-sm absolute",variant:"background",style:t}),l.jsxs("div",{className:"gap-x-sm relative z-10 flex",children:[l.jsx(at,{size:"small",variant:"secondary",onClick:r,disabled:n,children:l.jsx(be,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),l.jsx(at,{size:"small",variant:"primary",onClick:s,disabled:n,children:l.jsx(be,{defaultMessage:"Done",id:"JXdbo8Vnlw"})})]})]})}),i$e=f.memo(function({url:t,text:n}){const r=f.useMemo(()=>l.jsx("span",{role:"button",tabIndex:0,className:"underline hover:opacity-70 cursor-pointer",title:t,children:n}),[n,t]);return l.jsx(fa,{triggerElement:r,side:"bottom",align:"start",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"whitespace-nowrap",children:l.jsx(be,{defaultMessage:"Go to: ",id:"r9nTuorenA"})}),l.jsx(Dt,{href:t,target:"_blank",rel:"noopener",className:"underline break-all","aria-label":t,children:ure(t,60)})]})})}),l$e=f.memo(function({title:t}){const{displayTitle:n,links:r}=Cte(t);if(r.length===0)return n;const s=[];let a=0;return r.forEach((o,i)=>{o.startOffset>a&&s.push(l.jsx(A.Fragment,{children:n.substring(a,o.startOffset)},`text-${i}`)),s.push(l.jsx(i$e,{url:o.url,text:n.substring(o.startOffset,o.endOffset)},`link-${i}`)),a=o.endOffset}),a<n.length&&s.push(l.jsx(A.Fragment,{children:n.substring(a)},"text-end")),s}),c$e=144,u$e=A.memo(function({queryString:t="",className:n="",isFirstResult:r,isFailed:s,hasAttachments:a=!1,onExpandedChange:o,onTruncatedChange:i}){const{$t:c}=Q(),u=f.useCallback(()=>s&&!t?c({defaultMessage:"Something went wrong.",id:"iuY8kxCDQT"}):l.jsx(Jqe,{className:"max-w-[600px]",hasAttachments:a,children:l.jsx(l$e,{title:t})}),[s,t,c,a]),d=f.useMemo(()=>({showMore:l.jsx(be,{defaultMessage:"Show more",id:"kgNFsmh2uY",description:"Show more of the query."}),showLess:l.jsx(be,{defaultMessage:"Show less",id:"qyJtWyZ0yt"})}),[]);return l.jsx(Zqe,{maxHeight:c$e,className:"group/title relative inline-flex flex-col",buttonLabels:d,buttonTestId:"toggle-query-expand-button",onExpandedChange:o,onTruncatedChange:i,children:l.jsx(B,{as:r?"h1":"div",className:z("group/query relative whitespace-pre-line !text-wrap break-words [word-break:break-word]",n),children:u()})})}),d$e=f.memo(u$e),f$e=({onKeyDown:e,editQueryValue:t,setEditQueryValue:n,inputRef:r})=>{const s=t==="";return l.jsxs("div",{className:"relative w-full min-w-0",children:[l.jsx("div",{className:"absolute border border-subtlest bg-subtlest inset-0 rounded-lg"}),l.jsxs("div",{className:"relative grid",children:[l.jsx(D9,{onKeyDown:e,editQueryValue:t,onChange:n,inputRef:r}),l.jsx("div",{className:z("pointer-events-none col-start-1 row-start-1 opacity-0","text-base font-normal leading-normal"),children:s?l.jsx(l.Fragment,{children:""}):l.jsx(D9,{editQueryValue:t,disabled:!0})})]})]})},D9=({onKeyDown:e,editQueryValue:t,disabled:n,onChange:r,inputRef:s})=>{const{$t:a}=Q(),{isMobileUserAgent:o}=Be();return l.jsx("div",{className:z("text-foreground block h-auto w-full resize-none appearance-none overflow-hidden bg-transparent focus:outline-none","caret-super selection:bg-super/50 selection:text-foreground dark:selection:bg-super/10 dark:selection:text-super","text-base font-normal p-3 leading-normal","[&_[contenteditable]]:!font-sans","[&_[contenteditable]]:!bg-transparent","[&_[contenteditable]]:max-h-none [&_[contenteditable]]:!overflow-hidden [&_[contenteditable]]:sm:max-h-none [&_[contenteditable]]:lg:max-h-none","[&_[contenteditable]+*>*]:opacity-80","[&>*]:p-0"),style:{gridArea:"1/-1"},children:l.jsx(xP,{onKeyDown:e,placeholder:a({defaultMessage:"Ask anything",id:"AUouhaZgFv"}),value:t,onChange:r,minRows:0,isMobileStyle:!1,isMobileUserAgent:o,autoFocus:!0,disableInput:n,ref:s})})},m$e=Pe(async()=>{const{ShoppingMode:e}=await W(async()=>{const{ShoppingMode:t}=await import("./ShoppingMode-tje89tdY.js");return{ShoppingMode:t}},__vite__mapDeps([442,2,3,12,1,9,5,7,8,6,443,13,11,422,423,15,432,429,430,83,444,65,14,16,17]));return{default:e}},{loading:()=>l.jsx(Mqe,{})}),p$e=Pe(async()=>{const{HotelsMode:e}=await W(async()=>{const{HotelsMode:t}=await import("./HotelsMode-CzIPWpIY.js");return{HotelsMode:t}},__vite__mapDeps([445,2,3,443,13,1,5,7,8,12,9,6,446,11,444,422,423,15,14,16,17]));return{default:e}},{loading:()=>l.jsx(qz,{})}),h$e=Pe(async()=>{const{JobsMode:e}=await W(async()=>{const{JobsMode:t}=await import("./JobsMode-npdb6dOb.js");return{JobsMode:t}},__vite__mapDeps([447,2,3,5,1,6,7,8,9,12,11,412,15,432,433,13,14,16,17]));return{default:e}},{loading:()=>l.jsx(kqe,{})}),g$e=Pe(async()=>{const{VideosMode:e}=await W(async()=>{const{VideosMode:t}=await import("./VideosMode-CKc6Iaqh.js");return{VideosMode:t}},__vite__mapDeps([448,2,3,5,1,7,8,449,12,9,6,11,36,444,13,14,15,16,17]));return{default:e}},{loading:()=>l.jsx(zm,{type:"videos",queryString:""})}),y$e=Pe(async()=>{const{ImagesMode:e}=await W(async()=>{const{ImagesMode:t}=await import("./ImagesMode-BjiOYSqW.js");return{ImagesMode:t}},__vite__mapDeps([450,3,2,5,1,6,7,8,9,449,12,11,427,431,444,13,14,15,16,17]));return{default:e}},{loading:()=>l.jsx(zm,{type:"images",queryString:""})}),x$e=Pe(async()=>{const{MapsMode:e}=await W(async()=>{const{MapsMode:t}=await import("./MapsMode-BCR9o3qH.js");return{MapsMode:t}},__vite__mapDeps([451,2,3,1,12,9,5,7,8,443,13,446,6,11,444,422,423,15,14,16,17]));return{default:e}},{loading:()=>l.jsx(qz,{})}),b$e=Pe(async()=>{const{AssetsMode:e}=await W(async()=>{const{AssetsMode:t}=await import("./AssetsMode-BKyKnJvi.js");return{AssetsMode:t}},__vite__mapDeps([452,2,3,5,1,6,7,8,9,27,26,13,12,14,15,16,17]));return{default:e}},{loading:()=>l.jsx(Vde,{})}),_$e=Pe(async()=>{const{NewsMode:e}=await W(async()=>{const{NewsMode:t}=await import("./NewsMode-2OJMnSwJ.js");return{NewsMode:t}},__vite__mapDeps([453,2,3,7,1,8,12,9,5,13,6,14,15,16,17]));return{default:e}},{loading:()=>l.jsx(zm,{type:"news",queryString:""})}),v$e=A.memo(function({children:t,isFirstResult:n=!1,isLastResult:r=!1,hasParent:s=!1,mode:a,width:o}){return l.jsx(Y,{className:z({"pt-[var(--thread-visual-spacing)]":!n,"md:pt-lg":a==="default"&&!(n&&s),"pb-[var(--thread-visual-spacing)]":!0,"pb-lg":"","px-[var(--thread-visual-spacing)]":!0,"md:px-lg":o==="wide"}),children:t})});function C$e(e){const{result:{backend_uuid:t,frontend_context_uuid:n,attachments:r,display_model:s,sources:a}}=Pt(),o=bx();return f.useCallback(i=>{if(!n){Z.warn(new Error(`No frontend UUID for thread backendUUID=${t}`));return}e({rawQuery:i,existingEntryUUID:t,redoSearch:!0,collection:null,newFrontendContextUUID:null,existingFrontendContextUUID:o?void 0:n,promptSource:"user",querySource:"edit",attachments:r,modelPreferenceOverride:s,sourcesOverride:jw(a?.sources)})},[t,n,o,r,a,s,e])}const w$e=A.memo(function({sbsEntriesGroup:t,shouldShowProductFeedback:n,feedbackEntryUUID:r,deleteLastResult:s,setQuote:a,lastResultBuffer:o}){const{activeThreadTab:i}=Oo(),c=zze(i),{result:{backend_uuid:u,attachments:d,status:m,query_str:p,parent_info:{mode:h,url_slug:g}={},side_by_side_metadata:y},isEntryInFlight:b,webResults:x,inFlight:_,isFailed:v,selectedRefinementQuery:C,isFirstResult:w,isLastResult:S,submitQuery:E,scrollToListItem:T,idx:k}=Pt(),{results:M}=Ht(),N=C$e(E),P=!!(h&&g),O=f.useCallback(()=>{T?.(k,{smooth:!0})},[T,k]);f.useEffect(()=>{typeof window>"u"||m!=="PENDING"||O()},[b,m,O]);const L=!!(d&&d.length>0),H=Yt.hasUnspecifiedSelectionStatus(y)&&Yt.hasMultipleSiblingEntries(M,y?.sibling_uuid),R=f.useMemo(()=>l.jsx(r$e,{entryUUID:u,onSubmitEdit:N,isFirstResult:w,hasAttachments:L,inFlight:_,isFailed:v,isEditDisabled:H,selectedRefinementQuery:C,queryStr:p??""}),[u,N,w,L,_,v,H,C,p]),I=f.useMemo(()=>{if(!L)return new Map;const U=new Map;for(const X of x)X.url&&X.file_metadata?.file_source&&U.set(X.url,X.file_metadata.file_source);return U},[L,x]),{isMobileStyle:F,isMobileUserAgent:G}=Be(),j=f.useMemo(()=>0,[w,P,F,G]),$=f.useMemo(()=>S&&o?o+(L?52:0):0,[S,o,L]),q=w&&F;return l.jsx("div",{className:z({"erp-sidecar:min-h-[var(--sidecar-content-height)]":S,"erp-mobile-sidecar:min-h-[var(--mobile-sidecar-content-height)]":S,"min-h-[var(--page-content-height)]":S&&!q,"min-h-[var(--mobile-content-height)]":S&&q}),style:{marginTop:j,paddingBottom:$},children:l.jsxs(v$e,{isFirstResult:w,isLastResult:S,hasParent:!!P,mode:c.mode,width:c.width,children:[l.jsx(Eqe,{submitQuery:E}),l.jsx(qqe,{webResults:x,children:l.jsx("div",{className:z("isolate mx-auto flex flex-col",{"max-w-none":c.width==="full","max-w-threadWidth":c.width==="wide","max-w-threadContentWidth":c.width==="default"}),children:l.jsxs(Wt,{initial:!1,children:[l.jsx(Sa,{id:"default",children:l.jsxs("div",{className:"flex flex-col gap-y-lg",children:[l.jsx(Sqe,{isLastResult:S,title:R,backend_uuid:u,width:c.width,children:L&&l.jsx(Gde,{attachments:d,backend_uuid:u,fileSourceMap:I})}),l.jsx(_qe,{sbsEntriesGroup:t,submitQuery:E,shouldShowProductFeedback:n,feedbackEntryUUID:r,deleteLastResult:s,setQuote:a,lastResultBuffer:o})]})},"default"),l.jsx(Sa,{id:"shopping",children:l.jsx(m$e,{})},"shopping"),l.jsx(Sa,{id:"hotels",children:l.jsx(p$e,{})},"hotels"),l.jsx(Sa,{id:"places",children:l.jsx(x$e,{})},"places"),l.jsx(Sa,{id:"jobs",children:l.jsx(h$e,{})},"jobs"),l.jsx(Sa,{id:"videos",children:l.jsx(g$e,{})},"videos"),l.jsx(Sa,{id:"images",children:l.jsx(y$e,{})},"images"),l.jsx(Sa,{id:"sources",children:l.jsx(Uqe,{})},"sources"),l.jsx(Sa,{id:"assets",children:l.jsx(b$e,{})},"assets"),l.jsx(Sa,{id:"news",children:l.jsx(_$e,{})},"news")]})})})]})})}),S$e=Bt("EntityGroupContext",void 0),E$e=A.memo(function({children:t}){const[n,r]=f.useState(!1);return l.jsx(S$e.Provider,{value:{viewMoreOpen:n,setViewMoreOpen:r},children:t})}),k$e=e=>{const t=ry(e);if(t)switch(t.object){case"ShopifyWidget":return!0;default:return!1}return!1},M$e=f.memo(function({idx:t,result:n,sbsEntriesGroup:r,isLastResult:s,isFirstResult:a,lastResultBuffer:o}){const{inFlight:i}=Ht(),{scrollToListItem:c}=lE(),{submitQuery:u,shouldShowProductFeedback:d,feedbackEntryUUID:m,deleteLastResult:p,setQuote:h}=ya(),g=f.useCallback(async y=>{i&&y.querySource!=="edit"||u(y)},[u,i]);return l.jsx(jO,{idx:t,result:n,inFlight:i,isLastResult:s,isFirstResult:a,scrollToListItem:c,submitQuery:g,children:l.jsx(E$e,{children:l.jsx(w$e,{sbsEntriesGroup:r,shouldShowProductFeedback:d,feedbackEntryUUID:m??"",deleteLastResult:p,setQuote:h,lastResultBuffer:o})})})}),T$e=A.memo(function({children:t,forceVisible:n=!1,unmeasuredHeight:r,disableObservation:s,rootMargin:a,threshold:o,root:i,ref:c}){const[u,d]=f.useState(0),[m,p]=f.useState(n),[h,g]=f.useTransition(),y=f.useRef(null),b=f.useRef(null);f.useEffect(()=>{const _=y.current,v=b.current;if(!_||!v)return;const C=new ResizeObserver(([S])=>{if(!S)return;if(s?.current){C.unobserve(_),requestAnimationFrame(function T(){s.current?requestAnimationFrame(T):C.observe(_)});return}const E=S.contentRect.height;g(()=>d(T=>E||T))}),w=new IntersectionObserver(([S])=>{if(S){if(s?.current){w.unobserve(_),requestAnimationFrame(function E(){s.current?requestAnimationFrame(E):w.observe(_)});return}g(()=>p(S.isIntersecting))}},{rootMargin:a,threshold:o,root:i});return C.observe(_),n||w.observe(v),()=>{C.disconnect(),w.disconnect()}},[n,r,a,o,i,s]);const x=f.useCallback(_=>{y.current=_,c instanceof Function?c(_):c&&(c.current=_)},[c]);return l.jsx("div",{style:n?void 0:{minHeight:`${u||r}px`},ref:b,children:l.jsx("div",{ref:x,children:n||m?t:null})})}),A$e=Pe(async()=>{const{LoginModal:e}=await W(async()=>{const{LoginModal:t}=await import("./LoginModal-D844be60.js");return{LoginModal:t}},__vite__mapDeps([48,2,3,5,1,6,7,8,9,10,11,12,13,49,14,15,16,17]));return{default:e}}),N$e={"treatment-a":3,"treatment-b":9},R$e=({visitorDailyQueryCount:e})=>{const{openModal:t}=Kt(),n=wt(),{variation:r,loading:s}=aE({visitorDailyQueryCount:e}),a=N$e[r]??null,o=!n&&!!a;f.useEffect(()=>{!o||e===void 0||s||e>=a&&t(A$e,{origin:Ke.HARD_VISITOR_GATE,sheetModalDesign:"full-sheet-blurred",disallowClose:!0})},[o,a,t,e,s])},D$e=3,I9=6,I$e=2,j$e=({submissionQueryCount:e,visitorDailyQueryCount:t})=>{const n=wt(),{isMobileUserAgent:r}=Be(),{openVisitorLoginUpsell:s}=ws({enabled:!n}),{openInstallUpsell:a}=UP(),{variation:o,loading:i}=aE({visitorDailyQueryCount:t}),c=o==="treatment-a"||o==="treatment-b";f.useEffect(()=>{if(n||i||c||e===0)return;const u=e,d=r&&!lN(),m=u%I$e===1,p=u%I9===0,h=u%D$e===0&&u%I9!==0;if(d){m&&a({origin:Ke.VISITOR_GATE,sheetModalVariant:"inset-centered-sheet"});return}if(p){s({origin:Ke.VISITOR_GATE});return}h&&s({origin:Ke.VISITOR_GATE,sheetModalVariant:"bottom-sheet-gradient"})},[n,i,c,e,r,s,a])},P$e=({submissionQueryCount:e})=>{const{data:t}=pD({reason:"login-gates"}),n=t?.visitor_queries_past_day;R$e({visitorDailyQueryCount:n}),j$e({submissionQueryCount:e,visitorDailyQueryCount:n})},j9=1e3,O$e=1,P9=3,L$e=A.memo(function(t){const n="thread",{openToast:r}=cn(),{submissionQueryCount:s,setQuote:a}=ya();P$e({submissionQueryCount:s});const o=Ow(C=>C.results),{scrollContainerRef:i}=xa(),{refs:c,isScrollingRef:u}=lE(),d=sr(),[m,p]=f.useState(!1),h=Q(),{activeThreadTab:g}=Oo();Ude({reason:n});const y=f.useMemo(()=>{const C=d0(o?.length?o:t.placeholderResults||[]);return g!=="default"?Bz(C,g)??C.slice(-1):C},[o,t.placeholderResults,g]);f.useEffect(()=>{y.some(w=>w[0]?.has_expired_attachments)&&r({message:h.formatMessage({id:"zR3dvwKUWo",defaultMessage:"Some files have expired. Please reupload files to continue."}),variant:"error",timeout:3})},[y,r,h]);const b=f.useMemo(()=>{if(typeof window>"u")return-1;const C=window.location.hash.slice(1);return C?Number.isNaN(Number(C))?y?.findIndex(w=>w[0]?.backend_uuid===C):Number(C):-1},[y]),x=f.useCallback((C,w)=>{w?c[C]={current:w}:delete c[C]},[c]),_=f.useCallback((C,w)=>C<P9||C>=w-P9||!m&&C<=b,[b,m]);f.useEffect(()=>{if(~b){const C=setTimeout(()=>{p(!0)},1e4);return()=>{clearTimeout(C)}}},[b]),f.useEffect(()=>{const C=i.current;return C&&(C.scrollTop=0),()=>{p(!1)}},[d,i]),f.useEffect(()=>()=>{a(null)},[]);const v=f.useMemo(()=>y.map((C,w)=>{const S=C[0],E=w===0,T=w===y.length-1;return S?l.jsx(F$e,{result:S,resultsGroup:C.length>1?C:_e,isLastResult:T,isFirstResult:E,lastResultBuffer:T?t.lastResultBuffer:void 0,forceVisible:_(w,y.length),idx:w,scrollContainerRef:i,setRef:x,isScrollingRef:u},S.uuid||S.backend_uuid):null}),[y,t.lastResultBuffer,_,i,x,u]);return l.jsx("div",{children:v})}),F$e=A.memo(function({result:t,resultsGroup:n,isLastResult:r,isFirstResult:s,forceVisible:a,idx:o,scrollContainerRef:i,lastResultBuffer:c,setRef:u,isScrollingRef:d}){const m=(t.attachments?.length??0)>0,p=f.useMemo(()=>()=>l.jsx(om,{className:z("pt-headerHeight",{"pb-threadInputHeightWithPadding":r&&!m,"pb-threadAttachmentsHeightWithPadding":r&&m})}),[m,r]),h=f.useCallback(g=>u(o,g),[o,u]);return l.jsx(ar,{fallback:p,code:"SOMETHING_WENT_WRONG_ERROR",children:l.jsx(T$e,{forceVisible:a,unmeasuredHeight:j9,rootMargin:`${j9*O$e}px 0px`,threshold:0,root:i.current,ref:h,disableObservation:d,children:l.jsx(M$e,{idx:o,result:t,sbsEntriesGroup:n,isLastResult:r,isFirstResult:s,lastResultBuffer:c})})},t.uuid||t.backend_uuid)}),U$e=A.memo(function(){const{$t:t}=Q(),{firstResult:n}=Ht(),r=n?.parent_info,a=f.useContext(cE)?.activeThreadTab??"default";if(!r?.mode||!r?.url_slug||a!=="default")return null;const o=(()=>{switch(r?.mode){case"ARTICLE":return"page";default:return"search"}})(),i=!!r?.preview_image_url;return l.jsx(Dt,{href:`/${o}/${r?.url_slug}`,children:l.jsxs(Y,{variant:"background",bgHover:"subtler",className:"mt-md p-md shadow-subtle relative mx-auto flex justify-between rounded-lg border",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs(B,{color:"light",variant:"tiny",className:"mb-xs gap-x-xs flex items-center",children:[l.jsx(ye,{icon:D("git-fork"),size:"xs"}),l.jsx("div",{children:t({defaultMessage:"Follow up to",id:"D3eCB2NeGQ"})})]}),l.jsx(B,{variant:"baseSemi",color:"light",lineClamp:1,className:"break-all",children:r?.title})]}),i&&l.jsx("div",{className:"ml-md shrink-0",children:l.jsx(to,{src:r?.preview_image_url,alt:r?.title||"Preview",imageClassName:"h-16 w-16 rounded object-cover",rounded:"sm",fadeIn:!1})})]})})}),B$e=A.memo(function({children:t,className:n,innerClassName:r}){return l.jsx("div",{className:z("px-md md:px-lg","overflow-hidden",n),children:l.jsx("div",{className:z("max-w-threadContentWidth mx-auto",r),children:t})})});function H$e(e){return e?.length?e.filter(Ga):void 0}const V$e=(e,t,n)=>{const r=f.useRef(null),{submitQuery:s}=ya(),a=hn(),o=FC(),{preferredSearchModels:i}=Ol(),c=i[K.SEARCH];f.useLayoutEffect(()=>{const d=new URL(window.location.href).searchParams,m=d.get("copilot"),p=d.get("pro"),h=d.get("q"),g=d.get("utm_source"),y=d.get("in_page"),b=d.get("attachments"),x=d.get("tabs"),_=d.get("nav_suggestions"),v=d.get("sources"),C=d.get("pc"),w=d.get("pt");C&&WY(C),w&&QY(w);const S=d.get("qabi")??void 0,E=b?.replace(/[[\]]/g,"").split(","),T=d.get("newFrontendContextUUID"),k=[];if(x)try{const M=JSON.parse(x);if(Array.isArray(M))for(const N of M)k.push({type:"tab",id:N,url:""})}catch(M){Z.error("Failed to parse tabsParam:",M)}if(e&&h&&!T&&t&&r.current!==t){const M=Array.isArray(h)?h[0]:h,N=d.get("source");if(M==="pending")return;const P=O=>{if(r.current!==t)return;const L=g?`/search/${O}?utm_source=${g}`:`/search/${O}`;a.replace(L,"Omni search query")};s({rawQuery:M,copilotOverride:m==="true"||p==="true"||JR(g??void 0),collection:null,newFrontendContextUUID:crypto.randomUUID(),frontendUUID:t,attachments:E,inPage:y??void 0,promptSource:GC(N)?N:"user",querySource:"default_search",utmSource:g??void 0,quickActionButtonId:S,isNavSuggestionsDisabled:_==="false",modelPreferenceOverride:c,shouldRedirectToBackendUUID:!1,mentions:k,sourcesOverride:v?H$e(v?.split(",")):void 0,shouldUsePageStartTime:!0,onThreadSlugReceived:P}),r.current=t,u$()}},[e,s,t,o,a,n,c])},G$e=A.memo(function({error:t}){throw t});function z$e({active:e,query:t,copilot:n,source:r,streamId:s}){const a=f.useMemo(()=>t&&e?[mK({query_str:t,frontend_uuid:s,query_source:r??"default_search",mode:n==="true"?"COPILOT":"CONCISE"})]:_e,[t,e,s,r,n]);return f.useMemo(()=>e?{hasFrontendUUID:!!s,placeholderResults:a}:void 0,[e,a,s])}function q$e({active:e,frontendContextUUID:t}){const r=qf().getState().streams,a=(e?Object.values(r).find(i=>i.params?.frontend_context_uuid===t):void 0)?.placeholderChunk,o=f.useMemo(()=>a?[a]:void 0,[a]);return f.useMemo(()=>e?{skipLoadingUI:!0,placeholderResults:o}:void 0,[e,o])}function $$e({active:e,slugOrUUID:t}){const n="search-components",r=hn(),s=f.useRef(new Map),a=qf(),o=f.useRef(a.getState());o.current=a.getState();const i=e?Object.values(o.current.entries).find(g=>g?.thread_url_slug===t||g?.backend_uuid===t||g?.backend_uuid===s.current.get(t)):void 0;i&&s.current.set(t,i?.backend_uuid??"");const c=e&&!i,{data:u,error:d,isLoading:m,dataUpdatedAt:p}=yQ({slugOrUUID:t,enabled:c,isSidecar:!0,reason:n}),h=f.useMemo(()=>u?.length?u:i?[i]:_e,[u,i]);return f.useEffect(()=>{if(d instanceof Ue){let g=null;const y=d.detail;y?.error_code===Vk?(g=kc.ThreadAccessNotAllowed,Z.error(Vk,{error:d,slugOrUUID:t})):y?.error_code===RJ?(g=kc.ThreadExpired,Z.error(d?.message,{error:d,slugOrUUID:t})):(g=kc.InvalidThread,Z.error(d?.message,{error:d,slugOrUUID:t})),r.replace(`/?error=${g}&id=${t}`,"Search error")}},[d,t,r]),f.useMemo(()=>e?{entries:h,slugOrUUID:t,isLoadingEntries:!p,error:d}:void 0,[e,h,d,p,t])}function W$e(){const{clear:e}=u0(),t=fu(),n=!!(t?.new&&t?.uuid),r=!!(t?.new&&!t?.uuid),s=!!(!t?.new&&t?.uuid),a=!n&&!r&&!s,o=new URLSearchParams(window.location.search),i=o?.get("q")??void 0,c=o?.get("copilot")??void 0,u=o?.get("source")??void 0,d=o?.get(jx),m=f.useMemo(()=>d??crypto.randomUUID(),[d]);a&&!o.has(jx)&&o.set(jx,m);const p=a?o.toString():"",h=q$e({active:n,frontendContextUUID:t?.uuid??""}),g=z$e({active:r,query:i,copilot:c,streamId:m,source:u}),y=$$e({active:s,slugOrUUID:t?.uuid??""});return f.useEffect(()=>()=>e(),[e]),f.useLayoutEffect(()=>{g?.hasFrontendUUID&&e()},[e,g?.hasFrontendUUID]),V$e(r,m,"new-query-search-components"),f.useMemo(()=>{if(n){const b=t?.uuid;if(!b||!sN(b))return{component:l.jsx(np,{to:"/"})}}else if(r){if(!i||i==="pending")return{component:l.jsx(np,{to:"/"})}}else if(s){const b=t?.uuid;if(!b||b==="undefined")return{component:l.jsx(np,{to:"/"})};if(y?.error instanceof Ue)return null;if(y?.error instanceof d$&&!y.entries.length)return{component:l.jsx(ar,{fallback:()=>l.jsx(om,{}),code:"SOMETHING_WENT_WRONG_ERROR",children:l.jsx(G$e,{error:y.error})})}}else return{component:l.jsx(np,{to:i?`/search/new?${p}`:"/"})};return{props:{...h,...g,...y}}},[y,s,g,r,h,n,t?.uuid,i,p])}function K$e(e){const t=dK(),{setCurrentThreadId:n}=u0(),r=fK(),s=e.entries,a=!!s?.length,o=e.isLoadingEntries,i=f.useMemo(()=>s?.[0]?.context_uuid,[s]);f.useEffect(()=>{a&&n(i??crypto.randomUUID())},[a,n,i]),f.useEffect(()=>{o||s&&(s.forEach(u=>{u.reconnectable&&!Yt.isStatusCompleted(u)&&r(u.backend_uuid)}),t(s))},[t,s,r,i,o]);const c=f.useMemo(()=>e.entries?.length?e.entries:e.placeholderResults?.length?e.placeholderResults:_e,[e.placeholderResults,e.entries]);return f.useMemo(()=>({placeholderResults:c}),[c])}const Y$e=A.memo(function({children:t}){return l.jsx(Ode,{children:l.jsx(Lde,{children:l.jsx(Wze,{children:t})})})}),Q$e=A.memo(function({children:t}){return l.jsx(Xde,{children:l.jsx(Y$e,{children:t})})}),X$e=A.memo(function({children:t}){const{results:n}=Ht(),r=f.useMemo(()=>{const s=[];return n.map(a=>{a.widget_data?.map(o=>{k$e(o)&&s.push(o)})}),s},[n]);return l.jsx(fUe,{entities:r,children:t})}),Z$e=async({entryUUID:e,clarification:t,reason:n})=>{try{await ve.POST("/rest/sse/perplexity_clarifying_answer",n,{headers:{"content-type":"application/json"},body:{entry_uuid:e,clarification:t},timeoutMs:Ct({productionMs:5e3}),numRetries:0})}catch(r){Z.error("Failed to give clarifying answer",r)}},J$e=(e,t,n)=>{const r=uP(),{addClarification:s}=ny(),{session:a}=je(),{trackEventOnce:o}=Ze(a),i=n?.length??0,c=n?.filter(y=>y.markdown_block).length??0,u=f.useMemo(()=>{if(!n)return!1;if(ig(t?.display_model))return!0;const y=n.find(_=>_.intended_usage==="pro_search_steps");if(!y?.plan_block?.steps)return!1;const b=y.plan_block.steps;return b[b.length-1]?.step_type==="ENTROPY_REQUEST"},[n,t?.display_model]),d=yr(),m=f.useMemo(()=>u?!0:r?d(t?.display_model)===K.RESEARCH||d(t?.display_model)===K.STUDIO:!1,[r,u,t?.display_model,d]),p=f.useMemo(()=>m&&!t?.reasoning_plan&&i>0&&c===0,[t?.reasoning_plan,i,c,m]),h=f.useMemo(()=>!p||!m||!n?null:{clarificationQuestion:ig(t?.display_model)?"I'll consider the details you added.":"Add details or clarifications",isDefaultClarification:!0,clarificationCount:0},[p,m,n,t?.display_model]),g=f.useCallback((y,b,x)=>{const _=crypto.randomUUID(),v={uuid:_,clarification_type:"FREEFORM_CLARIFICATION",freeform_clarification:{text:x.query??"",question:"Add details or clarifications",attachments:x.attachments??[]}};Z$e({entryUUID:y,clarification:v,reason:e}),s({content:v.freeform_clarification?.text??x.query??"",UUID:_,entryUUID:y,question:h?.clarificationQuestion??void 0}),h&&o("clarifying query submitted",{entry_uuid:y,context_uuid:b,query:x.query??"",attachments:x.attachments})},[s,h,e,o]);return{shouldAcceptClarification:p,handleSubmitClarification:g,clarificationData:h}},eWe=({selectedSearchMode:e,shouldAcceptClarification:t,isBrowserAgent:n,$t:r})=>r(t?n?{defaultMessage:"Add details to this task...",id:"9/d5+NqCeH"}:{defaultMessage:"Add details or clarifications...",id:"RkaMsxpXoz"}:Yn[e].askInputPlaceholder),tWe=A.memo(function(t){const n="sidecar-thread-floating-footer",{$t:r}=Q(),s=Xt(),o=nn()?.get("q"),i=wt(),{inFlightEntry:c,inFlight:u,firstResult:d,lastResult:m,resultsLength:p}=Ht(),h=c?.backend_uuid,g=c?.context_uuid,y=c?.blocks,b=d?.frontend_context_uuid,x=d?.collection_info,{shouldAcceptClarification:_,handleSubmitClarification:v}=J$e(n,m,y),C=y?.length??0,w=b,{activeThreadTab:S}=Oo(),{submitQuery:E}=ya(),{specialCapabilities:T}=gr(),k=ns(),M=bx(),N=f.useMemo(()=>{try{return u&&C>0}catch(G){throw Z.error("Unable to parse non-Pro search inFlightEntry.",G),G}},[u,C]),P=f.useCallback(G=>{if(h&&_&&(v(h,g,G),I.setUserInput("")),u&&!G.forceFork)return;const j=G.forceFork||M,$=wo();E({rawQuery:G.query??"",copilotOverride:i||T.unlimitedProSearch?void 0:!1,attachments:G.attachments,collection:x??null,newFrontendContextUUID:j?$:null,existingFrontendContextUUID:j?void 0:w,promptSource:G.promptSource??"user",querySource:"followup",timeFromFirstType:G.timeFromFirstType,shouldRedirectToBackendUUID:j,modelPreferenceOverride:G.modelPreferenceOverride,forceEnableBrowserAgent:G.forceEnableBrowserAgent}),t.onSubmit?.()},[u,E,i,M,x,w,h,_,g,v]),O=f.useRef(!1),L=f.useCallback(G=>{O.current||(O.current=!0,setTimeout(()=>O.current=!1,iS),P(G))},[P]);f.useEffect(()=>{_&&(O.current=!1)},[_]);const[H,R,I]=zD({onSubmit:L}),F=f.useCallback(()=>{h&&(Cu({entryUUID:h,reason:n}),s.cleanupTasks(h,"query_stopped"))},[h,s]);return f.useEffect(()=>s.subscribeToSidecarBrowserTaskStop(G=>{G||F()}),[s,F]),f.useEffect(()=>{o!==null&&o!==""&&I.setUserInput("")},[o]),l.jsx(Y,{className:"erp-sidecar:fixed bottom-safeAreaInsetBottom p-md pointer-events-none absolute z-10 w-full",ref:t.ref,children:l.jsx("div",{className:"max-w-threadContentWidth mx-auto",children:l.jsx("div",{className:"pointer-events-auto",children:Vze(S)&&l.jsx(Y,{className:z("mt-lg static w-full grow flex-col items-center justify-center md:mt-0 md:flex","z-10"),children:l.jsx("div",{className:"w-full",children:l.jsxs(x0,{children:[l.jsx(Cf,{position:"input",idx:p-1,upsellInformation:m?.upsell_information,inFlight:u,isLastResult:!0,backendUuid:h,animateExpand:!1}),f.createElement(IP,{...I,key:"ask-input",value:H,json:R,isFollowUp:!0,disableSubmission:u&&!_,placeholder:eWe({selectedSearchMode:k,shouldAcceptClarification:_,isBrowserAgent:ig(m?.display_model),$t:r}),showStopButton:N,showFileUpload:!0,inFlightEntryUUID:h,onStopButtonClick:F,querySource:"followup",layoutKey:"sidecar-input"})]})})})})})})}),nWe=A.memo(function(){return l.jsx(om,{})}),rWe=A.memo(function(t){const{placeholderResults:n}=K$e(t),[r,{height:s}]=Ni();return l.jsx(ar,{fallback:nWe,code:"SOMETHING_WENT_WRONG_ERROR",children:l.jsx(Q$e,{children:l.jsxs(X$e,{children:[l.jsx("div",{className:"mx-auto h-fit pb-0",children:l.jsxs(Y,{variant:"background",className:"relative",children:[l.jsx(B$e,{children:l.jsx(U$e,{})}),l.jsx(L$e,{...t,placeholderResults:n,lastResultBuffer:s})]})}),l.jsx(tWe,{ref:r},"footer")]})})})}),sWe=A.memo(function(){const t=W$e();return t?"component"in t?t.component:l.jsx(dS,{children:l.jsx(rWe,{...t.props})}):null}),aWe=["button_click","modal_close","settings_change"];function SQe(){return"sidecar_thread"}function Ih(e,t){switch(e("voice mode connection updated",t),t.connection_status){case"connected":Is(`ppl.${ft}.connection.connected`,{startTime:Date.now()-t.time_to_voice_ready_ms,duration:t.time_to_voice_ready_ms,model_name:t.model_name,language:t.language,voice:t.voice,active_noise_reduction:t.active_noise_reduction,mic_pre_granted:t.mic_pre_granted});break;case"closed":t.voice_session_duration_ms!==null&&Is(`ppl.${ft}.connection.closed`,{startTime:Date.now()-t.voice_session_duration_ms,duration:t.voice_session_duration_ms});break;case"failed to connect":Z.error("[realtime] Voice connection failed",t.reason),Jt(`ppl.${ft}.connection.failed`,{error_code:t.error_code??"unknown"});break}}function $z(e,t,n){const s=aWe.includes(t)?"user initiated":"backgrounded";Jt(`ppl.${ft}.voice.ended`,{reason:s}),e("end voice mode",{reason:s,comet_surface:n})}function O9(e){try{const t=new AudioContext,n=t.createAnalyser();n.fftSize=kP;const r=t.createMediaStreamSource(e);return r.connect(n),t.state==="suspended"&&t.resume().catch(()=>{Z.warn("[realtime/v2/core] Failed to resume audio context")}),{audioContext:t,analyser:n,source:r}}catch{return null}}function ih(e){e&&(e.source.disconnect(),e.analyser.disconnect(),e.audioContext.state!=="closed"&&e.audioContext.close())}function L9(e,t){e.getByteFrequencyData(t);let n=0;for(let r=0;r<t.length;r++)n+=t[r]??0;return n/t.length/255*100}function Wz({voiceEvents:e}){const t=Cce;let n=0,r=0,s=null,a=!1,o=null,i=null;const c=new Uint8Array(kP/2);function u(){o?.analyser?n=L9(o.analyser,c):n=0,i?.analyser?r=L9(i.analyser,c):r=0;const d=r>0;d!==a&&(e.emit("voice_assistant_speaking_changed",d),a=d);const m=r>0?r:n;e.emit("audio_level_changed",m)}return{get level(){return r>0?r:n},get userLevel(){return n},get voiceAssistantLevel(){return r},setUserStream(d){ih(o),o=O9(d)},setVoiceAssistantStream(d){ih(i),i=O9(d)},start(){if(s!==null){Z.error("[realtime/v2/core] Audio analyzer already started");return}s=setInterval(u,t)},stop(){s!==null&&(clearInterval(s),s=null),ih(o),ih(i),o=null,i=null,n=0,r=0,a=!1}}}async function oWe(e){const t=e.find(n=>n.kind==="audioinput"&&n.deviceId==="default");return await navigator.mediaDevices.getUserMedia({audio:t?{deviceId:{exact:t.deviceId}}:!0})}const EQe=500,kQe=280,MQe=e=>{new Audio(e).play().catch(()=>{})},TQe=({state:e,isMuted:t,thinkingStatus:n,$t:r})=>{if(t)return r({defaultMessage:"Muted",id:"HOzFdo4wh5"});switch(e){case"connecting":case"buffering":return r({defaultMessage:"Waking up...",id:"DgbC2DZlba"});case"idle":return r({defaultMessage:"Say something...",id:"YoiwCDuR2E"});case"searching":return r(n==="querying_video"?{defaultMessage:"Scanning video",id:"9yujlLRD7Y"}:{defaultMessage:"Searching for information",id:"+asfYtz5lh"});case"speaking":return r({defaultMessage:"Speaking response",id:"TBFSwE9AkJ"});case"listening":return r({defaultMessage:"Listening to you",id:"VlnQdWwzct"});case"working":return r({defaultMessage:"Processing",id:"1Ia8qNPf7T"});default:return r({defaultMessage:"Voice Mode active",id:"Ciz7yvQioO"})}},AQe=({voiceState:e,isMuted:t})=>{switch(e){case"idle":return t?"idle":"ready";case"searching":case"speaking":case"listening":case"connecting":return e;default:return"idle"}};class pr extends pN{name="VoiceSessionError"}function Kz(){let e=null,t=!1,n=!1,r=null,s=null;const a=()=>{const o=e?.getAudioTracks()[0];if(o)try{const i=!t&&!n;o.enabled=i}catch(i){Z.warn("[realtime/core] Failed to sync mic track state:",i)}};return{async acquire({onTrackEnded:o,onDeviceChange:i}){try{const c=t;this.release();const u=await navigator.mediaDevices.enumerateDevices(),d=u.some(p=>p.kind==="audioinput"&&p.label!=="");e=await oWe(u);const m=e.getAudioTracks()[0];return t=c||(m?!m.enabled:!1),n=!1,r=o,m?.addEventListener("ended",r),s=i,navigator.mediaDevices.addEventListener("devicechange",s),a(),{stream:e,wasPreGranted:d}}catch(c){const u=c instanceof Error?c:new Error(String(c));throw new pr("VOICE_SESSION_MIC_ACQUISITION_FAILED",{message:u.message,cause:u})}},release(){s&&navigator.mediaDevices.removeEventListener("devicechange",s),e&&e.getTracks().forEach(o=>{try{r&&o.removeEventListener("ended",r),o.stop()}catch(i){Z.warn("[realtime/core] Failed to stop track:",i)}}),r=null,s=null,e=null,t=!1,n=!1},getStream(){return e},isMuted(){return t},setMuted(o){t=o,a()},setSuppressed(o){n=o,a()}}}function Yz(){return X9()}const iWe={open_page:"open_url",close_browser_tabs:"close_tabs",search_browser:"query_tabs",search_web:"search_web",search_video:"search_video",query_video:"query_video",terminate:"terminate"};function Qz(e){return iWe[e]??e}function Xz(e){const t=e.map(n=>["*result*",`- name: ${n.name}`,`- url: ${n.url}`,`- summary: ${n.summary||n.snippet||""}`].join(`
`)).join(`

`);return t?`**search results**
${t}`:`**search results**
No results found`}function lWe(e){return e?.url&&e?.meta_data?.title?`**video result**
- title: ${e.meta_data.title}
- url: ${e.url}`:`**video result**
No video found`}function cWe(e){if(!e?.url||!e?.title)return`**query video result**
No video found`;const t=["**query video result**",`- title: ${e.title}`,`- url: ${e.url}`];return e.summary&&t.push(`- summary: ${e.summary}`),t.join(`
`)}const uWe=async({sessionId:e,source:t,args:n,reason:r,requestId:s})=>{const a=JSON.parse(n);if(!a.query||typeof a.query!="string")throw new Error("Invalid search_video arguments: missing query field");return await hce({body:{session_id:e,query:a.query,source:t},reason:r,requestId:s})},dWe=async({sessionId:e,source:t,args:n,reason:r,requestId:s})=>{const a=JSON.parse(n);if(!a.video_url||typeof a.video_url!="string")throw new Error("Invalid query_video arguments: missing video_url field");if(!a.query||typeof a.query!="string")throw new Error("Invalid query_video arguments: missing query field");return await EP({body:{session_id:e,video_url:a.video_url,query:a.query,source:t},reason:r,requestId:s})},Zz=async({sessionId:e,source:t,args:n,reason:r,requestId:s})=>{const a=JSON.parse(n);let o;if(a.queries&&Array.isArray(a.queries))o=a.queries;else if(a.query&&typeof a.query=="string")o=[a.query];else throw new Error("Invalid search_web arguments: missing query or queries field");return await gce({body:{session_id:e,source:t,queries:o},reason:r,requestId:s})};let kd=null;const Jz=async()=>kd||(kd=W(()=>import("./livekit-client.esm-CQq1GznS.js"),[]).then(e=>(e.setLogLevel(e.LogLevel.silent),e)).catch(e=>{throw kd=null,e}),kd),fWe=1500,F9=256,mWe=e=>{const t=new TextEncoder().encode(e);if(t.length<=F9)return e;const n=t.slice(0,F9);return new TextDecoder().decode(n).replace(/\uFFFD$/,"")};class pWe extends Error{code;data;constructor(t,n){super(mWe(n)),this.code=t}}const hWe=e=>{const t=async n=>{const r=await Jz().then(s=>s.RpcError).catch(()=>pWe);return new r(fWe,n)};return async n=>{Z.debug("[clientTools] Received search_web RPC request",{requestId:n.requestId,callerIdentity:n.callerIdentity});let r;try{r=JSON.parse(n.payload)}catch{throw await t("Invalid JSON payload")}if(!r.queries||!Array.isArray(r.queries))throw await t("Missing or invalid queries field");e.startThinking("quick_search");try{const a=((await Zz({sessionId:e.sessionId,source:e.source,args:n.payload,reason:e.reason,requestId:n.requestId}))?.web_results??[]).slice(0,TP);return e.completeThinking(a),Xz(a)}catch(s){const a=s instanceof Error?s.message:"Search failed";throw await t(a)}}};function gWe(e){return[{name:"search_web",handler:hWe(e)}]}const A2="lk.agent.state";function yWe(e){const{voiceEvents:t,voiceState:n}=e;let r=null,s=null,a=null,o=null,i=null,c=null,u=null,d=null,m=null,p=null,h=null;return{async connect(g,y){a=await Jz();const{ConnectionState:b,ParticipantEvent:x,ParticipantKind:_,Room:v,RoomEvent:C,Track:w}=a;function S(T){switch(Z.debug("[livekit/room] Agent state changed:",T),T!=="initializing"&&n.setAudioReady(!0),T){case"speaking":n.startVoiceAssistantSpeech();break;case"listening":case"thinking":case"initializing":n.endVoiceAssistantSpeech();break}}function E(T){T.on(x.AttributesChanged,k=>{if(A2 in k){const M=T.attributes[A2];S(M)}})}o=T=>{switch(Z.info("[livekit/room] Connection state changed:",T),T){case b.Connected:n.canTransition("connected")&&n.transition("connected");break;case b.Disconnected:n.canTransition("disconnected")&&n.transition("disconnected");break;case b.Reconnecting:Z.warn("[livekit/room] Reconnecting...");break}},i=T=>{if(Z.info("[livekit/room] Participant connected:",T.identity,T.kind),T.kind===_.AGENT){s=T,E(T);const k=T.attributes[A2];k&&S(k)}},c=T=>{Z.info("[livekit/room] Participant disconnected:",T.identity),T===s&&(s=null,n.endVoiceAssistantSpeech())},u=(T,k,M)=>{if(Z.info("[livekit/room] Track subscribed:",T.kind,M.identity),T.kind==="audio"&&M.kind===_.AGENT){const N=T.attach();if(N instanceof HTMLAudioElement){N.autoplay=!0;const P=new MediaStream,O=T.mediaStreamTrack;O&&(P.addTrack(O),e.onAgentAudioTrack?.(T,P))}}},d=(T,k,M)=>{Z.info("[livekit/room] Track unsubscribed:",T.kind,M.identity),T.detach()},m=(T,k)=>{if(!k||k.kind!==_.AGENT)return;const M=T[T.length-1];M!==void 0&&n.receiveTranscript(M.text)},h=T=>{Z.debug("[livekit/room] Local speaking changed:",T),T?n.startUserSpeech():n.endUserSpeech(),t.emit("user_speaking_changed",T)},p=()=>{Z.info("[livekit/room] Room disconnected"),n.canTransition("disconnected")&&n.transition("disconnected")};try{const T=await bce({body:{source:y.source,timezone:y.timezone,voice:y.voice,response_language:y.language},reason:y.reason});if(T.error||!T.data)throw new pr("VOICE_SESSION_CONNECTION_FAILED",{message:T.error??"Failed to get LiveKit connection"});const{server_url:k,participant_token:M}=T.data;r=new v({adaptiveStream:!0,dynacast:!0}),r.on(C.ConnectionStateChanged,o),r.on(C.ParticipantConnected,i),r.on(C.ParticipantDisconnected,c),r.on(C.TrackSubscribed,u),r.on(C.TrackUnsubscribed,d),r.on(C.TranscriptionReceived,m),r.on(C.Disconnected,p),await r.connect(k,M);for(const O of e.clientTools??[])Z.debug("[livekit/room] Registering RPC method:",O.name),r.registerRpcMethod(O.name,O.handler);r.localParticipant.on(x.IsSpeakingChanged,h);const N=g.getAudioTracks()[0];N&&await r.localParticipant.publishTrack(N,{name:"microphone",source:w.Source.Microphone});const P=Array.from(r.remoteParticipants.values());for(const O of P)O.kind===_.AGENT&&i(O);Z.info("[livekit/room] Connected to room:",r.name)}catch(T){const k=T instanceof Error?T:new Error(String(T));throw Z.error("[livekit/room] Connection failed:",k),e.onError?.(new pr("VOICE_SESSION_CONNECTION_FAILED",{message:k.message,cause:k})),k}},disconnect(){if(!r||!a)return;const{RoomEvent:g,ParticipantEvent:y}=a;o&&r.off(g.ConnectionStateChanged,o),i&&r.off(g.ParticipantConnected,i),c&&r.off(g.ParticipantDisconnected,c),u&&r.off(g.TrackSubscribed,u),d&&r.off(g.TrackUnsubscribed,d),m&&r.off(g.TranscriptionReceived,m),p&&r.off(g.Disconnected,p),h&&r.localParticipant.off(y.IsSpeakingChanged,h),r.disconnect(),r=null,s=null,o=null,i=null,c=null,u=null,d=null,m=null,p=null,h=null,Z.info("[livekit/room] Disconnected from room")}}}function DC(e){return e instanceof pr?e:new pr("VOICE_SESSION_UNKNOWN_ERROR",{message:e instanceof Error?e.message:String(e),cause:e instanceof Error?e:void 0})}function eq({voiceState:e,destroySession:t,trackEvent:n,source:r,platform:s,cometSurface:a}){return{onTrackEnded:()=>{e.connectionState==="connected"&&(e.setError(new pr("VOICE_SESSION_DEVICE_REMOVED",{message:"Microphone disconnected or permission revoked"})),t("device_removed"),n("voice mode device changed",{source:r,platform:s,reason:"all audio devices removed or permission revoked",comet_surface:a}))},onDeviceChange:()=>{e.connectionState==="connected"&&(e.setError(new pr("VOICE_SESSION_DEVICE_CHANGED",{message:"Audio device changed"})),t("device_change"),n("voice mode device changed",{source:r,platform:s,reason:"audio device changed",comet_surface:a}))}}}function tq(){let e=Promise.resolve(),t=null;return{enqueue(n){e=e.then(n).catch(r=>{const s=r instanceof Error?r:new Error(String(r));t?.(s)})},setErrorHandler(n){t=n},onIdle(){return e},flush(){e=Promise.resolve()}}}function xWe(e,t){if(e.length===0)return t;const n=/[.!?]$/.test(e),r=/^[a-zA-Z]/.test(t);return n&&r?e+" "+t:e+t}const U9={idle:["connecting"],connecting:["connected","disconnected","error"],connected:["disconnecting","error"],disconnecting:["disconnected","error"],disconnected:["connecting","idle"],error:["connecting","disconnected","idle"]};function nq({voiceEvents:e,initialConnectionState:t="idle"}){let n=t,r=!1,s=!1,a="",o=!1,i=!1,c="idle",u=[],d=null,m=null,p=null,h=!1,g=null,y=null;return{get connectionState(){return n},canTransition(b){return U9[n]?.includes(b)??!1},transition(b){return U9[n]?.includes(b)?(n=b,e.emit("connection_state_changed",b),!0):(Z.error(`Invalid voice state transition attempted: ${n}  ${b}`),!1)},get isMuted(){return r},setMuted(b){r!==b&&(r=b,e.emit("muted_changed",b))},get isAudioReady(){return s},setAudioReady(b){s!==b&&(s=b,e.emit("audio_ready_changed",b))},get transcript(){return a},get isUserSpeaking(){return o},get isVoiceAssistantSpeaking(){return i},get thinkingStatus(){return c},get webResults(){return[...u]},get error(){return d},get openaiSessionId(){return m},get modelName(){return p},get shouldClearTranscriptOnNextDelta(){return h},get lastInputAudioItemId(){return g},get abortController(){return y},startUserSpeech(){const b=o,x=i,_=c,v=u.length>0;o=!0,i=!1,c="idle",h=!0,u=[],b||e.emit("user_speaking_changed",!0),x&&e.emit("voice_assistant_speaking_changed",!1),_!=="idle"&&e.emit("thinking_status_changed","idle"),v&&e.emit("web_results_changed",[])},endUserSpeech(){o&&(o=!1,e.emit("user_speaking_changed",!1))},startVoiceAssistantSpeech(){i||(i=!0,e.emit("voice_assistant_speaking_changed",!0))},endVoiceAssistantSpeech(){i&&(i=!1,e.emit("voice_assistant_speaking_changed",!1))},receiveTranscriptDelta(b){h?(a=b,h=!1):a=xWe(a,b),e.emit("voice_assistant_transcript_changed",a)},receiveTranscript(b){h&&(h=!1),a=b,e.emit("voice_assistant_transcript_changed",a)},startThinking(b){c==="idle"&&(c=b,e.emit("thinking_status_changed",b))},completeThinking(b){const x=c;c="idle",u=[...b],x!=="idle"&&e.emit("thinking_status_changed","idle"),e.emit("web_results_changed",u)},createSession(b){m=b},setModelName(b){p=b},setError(b){d=b,b&&(Z.error("[realtime] Voice session error",b),e.emit("error",b))},setLastInputAudioItemId(b){g=b},setAbortController(b){y=b},reset(){const b=n,x=r,_=s,v=a!=="",C=o,w=i,S=c,E=u.length>0;n="idle",r=!1,s=!1,a="",o=!1,i=!1,c="idle",u=[],d=null,m=null,p=null,h=!1,g=null,y=null,b!=="idle"&&e.emit("connection_state_changed","idle"),x&&e.emit("muted_changed",!1),_&&e.emit("audio_ready_changed",!1),v&&e.emit("voice_assistant_transcript_changed",""),C&&e.emit("user_speaking_changed",!1),w&&e.emit("voice_assistant_speaking_changed",!1),S!=="idle"&&e.emit("thinking_status_changed","idle"),E&&e.emit("web_results_changed",[])}}}function bWe(e){const t=crypto.randomUUID(),n=Yz(),r=tq(),s=Kz(),a=Wz({voiceEvents:n}),o=nq({voiceEvents:n}),i=e.trackEvent;let c=null,u=null;r.setErrorHandler(m=>{o.abortController?.abort(),o.setAbortController(null),o.setAudioReady(!1),s.release(),a.stop(),c?.disconnect(),c=null,Ih(i,{connection_status:"failed to connect",reason:m instanceof Error?m.message:String(m),error_code:m instanceof pr?m.code:void 0,comet_surface:e.cometSurface}),o.setError(DC(m)),o.transition("error")});const d={get id(){return t},get connectionState(){return o.connectionState},get entries(){return[]},get transcript(){return o.transcript},get isMuted(){return o.isMuted},get isAudioOutputMuted(){return!1},get isUserSpeaking(){return o.isUserSpeaking},get isVoiceAssistantSpeaking(){return o.isVoiceAssistantSpeaking},get thinkingStatus(){return o.thinkingStatus},get isAudioReady(){return o.isAudioReady},get error(){return o.error},get webResults(){return o.webResults},get audioLevel(){return a.level},start(){Jt(`ppl.${ft}.voice.started`,{provider:"livekit"}),i("start voice mode",{provider:"livekit",comet_surface:e.cometSurface}),o.connectionState==="idle"&&(o.transition("connecting"),r.enqueue(async()=>{o.setAbortController(new AbortController);const m=eq({voiceState:o,destroySession:g=>d.destroy(g),trackEvent:i,source:e.source,platform:e.platform,cometSurface:e.cometSurface}),p=mi({}),{stream:h}=await s.acquire(m);if(p.addTiming(`${ft}.microphone_ready`),a.setUserStream(h),o.abortController?.signal.aborted){s.release();return}c=yWe({voiceEvents:n,voiceState:o,clientTools:gWe({sessionId:t,source:e.source,reason:e.reason,startThinking:o.startThinking,completeThinking:o.completeThinking}),onAgentAudioTrack:(g,y)=>{a.setVoiceAssistantStream(y)},onError:g=>{o.setError(DC(g)),o.canTransition("error")&&o.transition("error")}});try{await c.connect(h,{source:e.source,timezone:e.timezone,voice:e.voice,language:e.language,reason:e.reason}),p.addTiming(`${ft}.room_connected`),u=Date.now(),p.addTiming(`${ft}.started`),e.cometBrowser?.voiceAssistantNotifyConnected(),a.start()}catch(g){throw Z.error("[createLiveKitSession] Connection failed:",g),g}}))},destroy(m="unmount"){r.enqueue(async()=>{if(o.canTransition("disconnecting")&&o.transition("disconnecting"),o.abortController?.abort(),o.setAbortController(null),a.stop(),s.release(),c?.disconnect(),c=null,o.canTransition("disconnected")?o.transition("disconnected"):o.reset(),m!=="settings_change"&&e.cometBrowser?.voiceAssistantStop(),u){const p=Date.now()-u;$z(i,m,e.cometSurface),Is(`ppl.${ft}.voice.stopped`,{startTime:u,duration:p,provider:"livekit"})}u=null})},mute(){s.setMuted(!0),o.setMuted(!0)},unmute(){s.setMuted(!1),o.setMuted(!1)},toggleMute(){const m=!o.isMuted;s.setMuted(m),o.setMuted(m)},muteAudioOutput(){n.emit("audio_output_muted_changed",!0)},unmuteAudioOutput(){n.emit("audio_output_muted_changed",!1)},async syncPageContext(m,p,h){return Promise.resolve()},on(m,p){return n.on(m,p)}};return d}class rq extends pN{name="RealtimeVoiceError"}const _We="... ",sq="Answer skipped.",aq=e=>{if(e.sent)return!1;const t=!!(e.query&&e.query.trim().length>0),n=!!(e.answer&&e.answer.trim().length>0);return t&&!n},B9=(e,t,n)=>{const r=[];for(let s=t;s<n;s++){const a=e[s];a&&aq(a)&&r.push(s)}return r},oq=e=>e.join(_We),iq=(e,t)=>{t.forEach(n=>{n.forEach(r=>e.add(r))})},vWe=(e,t)=>{const n=e[t];if(!n)return null;const r=B9(e,0,t),s=B9(e,t+1,e.length);if(r.length===0&&s.length===0)return{adjustedIndex:t,mergedCount:0};const a=[];r.forEach(u=>{const d=e[u]?.query.trim();d&&a.push(d)}),a.push(n.query.trim()),s.forEach(u=>{const d=e[u]?.query.trim();d&&a.push(d)}),n.query=oq(a);const o=[...r,...s].map(u=>e[u]?.tool_ids).filter(u=>u!==void 0);iq(n.tool_ids,o);const i=[...r,...s].sort((u,d)=>d-u);i.forEach(u=>{e.splice(u,1)});const c=e.indexOf(n);return{adjustedIndex:c>=0?c:t,mergedCount:i.length}},CWe=e=>{const t=e.filter(aq);if(t.length===0)return null;const n=oq(t.map(i=>i.query.trim()).filter(Boolean)),r=t[t.length-1];if(!r)return null;r.query=n,r.answer=sq;const s=t.slice(0,-1);iq(r.tool_ids,s.map(i=>i.tool_ids)),s.map(i=>e.indexOf(i)).filter(i=>i>=0).sort((i,c)=>c-i).forEach(i=>{e.splice(i,1)});const o=e.indexOf(r);return o>=0?{entryIndex:o,entry:r}:null},IC=({name:e,result:t,trackEvent:n,entryMetadata:r,uuid:s,pplxSessionId:a,modelName:o,inputLength:i,outputLength:c,cometSurface:u})=>{const d=Qz(e);t.result==="failed"&&Z.warn("[realtime] Tool call failed",{tool_name:d,errorReason:t.errorReason,entry_uuid:r?.entryUuid,uuid:s}),Jt(`ppl.${ft}.tool_executed`,{output_length:c,tool_name:d,result:t.result,model:o}),n("voice mode tool executed",{tool_name:d,result:t.result,entry_uuid:r?.entryUuid,uuid:s,pplx_session_id:a,model:o,input_length:i,output_length:c,comet_surface:u})};function wWe(e){return{pplxSessionId:e.pplxSessionId,sessionId:e.openaiSessionId,inputAudioItemId:e.inputAudioItemId,outputAudioItemId:"",query:"",answer:"",usage:null,tool_ids:new Set,language:e.language,modelName:e.modelName,turnNumber:e.turnNumber,hasResponseDone:!1,pendingToolCalls:[]}}function SWe(e){const{voiceEvents:t}=e,n=[],r=e.trackEvent;let s=[],a=0;const o=async c=>{try{const u=await yce({entry:{pplx_session_id:c.pplxSessionId,session_id:c.sessionId,source:e.source,query:c.query,answer:c.answer||sq,timestamp:Date.now(),tool_ids:[...c.tool_ids],model_name:e.getModelName(),usage:c.usage??null,tool_call_usage:c.tool_call_usage??null,transcription_usage:c.transcription_usage??null,web_results:s},analyticsParams:{is_voice_to_voice:!0,voice_to_voice_query_count:a,language:c.language,platform:e.platform},reason:e.reason,requestId:e.requestId});return s=[],u}catch(u){const d=new rq("VOICE_ENTRY_SEND_FAILED",{cause:u,details:{sessionId:c.sessionId}});throw Z.error(d),u}},i=async c=>{const u=n[c];if(!u||u.sent)return;u.sent=!0;const d={...u};try{const m=await o(d);if(m&&u.pendingToolCalls&&u.pendingToolCalls.length>0){const p={entryUuid:m.entry_uuid,createdAt:m.created_at,userId:m.user_id};u.pendingToolCalls.forEach(h=>{IC({name:h.name,result:h.result==="failed"?{result:"failed",errorReason:h.errorReason}:{result:"successful"},trackEvent:h.trackEvent,entryMetadata:p,uuid:h.uuid,pplxSessionId:h.pplxSessionId,modelName:h.modelName,inputLength:h.inputLength,outputLength:h.outputLength,cometSurface:h.cometSurface})}),u.pendingToolCalls=[]}n.splice(c,1),t.emit("entry_committed",d),r("voice mode entry",{pplx_session_id:d.pplxSessionId,turn_number:d.turnNumber,query:d.query,answer:d.answer,total_tokens:d.usage?.total_tokens??null,input_tokens:d.usage?.input_tokens??null,output_tokens:d.usage?.output_tokens??null,cached_tokens:d.usage?.input_token_details?.cached_tokens??null,tool_count:d.tool_ids.size,tools_used:[...d.tool_ids],comet_surface:e.cometSurface}),Jt(`ppl.${ft}.entry_created`,{})}catch(m){Z.error("[entryStore] Failed to create entry",{query:d.query,answer:d.answer,sessionId:d.sessionId,error:m})}};return{createEntry(c){a++;const u=wWe({pplxSessionId:e.pplxSessionId,openaiSessionId:e.getOpenAISessionId(),language:e.language,modelName:e.getModelName(),inputAudioItemId:c,turnNumber:a});n.push(u),t.emit("entry_created",u)},getEntries(){return n},appendVoiceAssistantTranscript(c){const u=n[n.length-1];u&&(u.answer=(u.answer||"")+c)},markResponseDone(){const c=n[n.length-1];c&&(c.hasResponseDone=!0)},setUsage(c){const u=n[n.length-1];u&&(u.usage=c)},async checkSendEntry(c){const u=n[c];if(!u||u.sent)return;const d=u.query&&u.query.trim().length>0,m=u.answer&&u.answer.trim().length>0,p=u.usage!==null&&u.usage!==void 0,h=u.hasResponseDone===!0;if(!m||!d||!p&&!h)return;const g=vWe(n,c);if(!g)return;const{adjustedIndex:y}=g;p||(Z.warn("[entryStore] Sending entry without usage despite response.done",{sessionId:u.sessionId,inputAudioItemId:u.inputAudioItemId,hasResponseDone:h}),Jt(`ppl.${ft}.entry_sent_without_usage`,{})),await i(y)},async flushPreviousEntry(){const c=CWe(n);c&&await i(c.entryIndex)},setWebResults(c){s=c},reset(){n.length=0,s=[],a=0}}}const H9=2400;function EWe(e){const t=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);let n="";for(let r=0;r<t.length;r++)n+=String.fromCharCode(t[r]??0);return btoa(n)}function kWe(){let e=null,t=null,n=null,r=!1,s=[];const a=i=>{if(!r)return;const c=i.data;c?.length>0&&s.push(c)},o=()=>{r=!1,t&&(t.port.onmessage=null,t.disconnect(),t=null),n&&(n.disconnect(),n=null),e&&e.state!=="closed"&&(e.close().catch(()=>{}),e=null),s=[]};return{start(i){r||(s=[],e=new AudioContext({latencyHint:"interactive"}),e.resume().catch(()=>{}),e.audioWorklet.addModule("/audio-worklet.js").then(()=>{e&&(t=new AudioWorkletNode(e,"pcm-worklet-processor"),t.port.onmessage=a,n=e.createMediaStreamSource(i),n.connect(t),t.connect(e.destination),r=!0)}).catch(c=>{Z.warn("[realtime/core] Pre-connect buffer failed to start:",c),o()}))},stop(){r=!1},flush(i){const c=performance.now();if(r=!1,s.length===0){o();return}const u=s.reduce((h,g)=>h+g.length,0),d=new Int16Array(u);let m=0;for(const h of s)d.set(h,m),m+=h.length;let p=0;for(let h=0;h<d.length;h+=H9){const g=d.subarray(h,Math.min(h+H9,d.length));i({event_id:`preconnect-${p}`,type:"input_audio_buffer.append",audio:EWe(g)}),p++}Is(`ppl.${ft}.preconnect_buffer.flush_duration`,{startTime:c,duration:performance.now()-c}),o()},destroy(){o()}}}function MWe(e){let t=null,n=null,r=!1;return{createConnection(s,a){t&&this.disconnect(),t=new RTCPeerConnection(a),t.onconnectionstatechange=()=>{t&&e.onConnectionStateChange(t.connectionState)},t.ontrack=o=>{const[i]=o.streams;i&&e.onTrack&&e.onTrack(i)},s.getTracks().forEach(o=>{t?.addTrack(o,s)})},createDataChannel(s){if(!t)throw new pr("VOICE_SESSION_DATA_CHANNEL_FAILED",{message:"[realtime/core] Cannot create data channel: peer connection not initialized"});return n&&n.close(),n=t.createDataChannel(s),n.onmessage=a=>{e.onMessage(a)},n.onopen=()=>{e.onDataChannelOpen?.()},n.onclose=()=>{e.onDataChannelClose?.()},n},getPeerConnection(){if(!t)throw new pr("VOICE_SESSION_PEER_CONNECTION_NOT_INITIALIZED",{message:"[realtime/core] Peer connection not initialized"});return t},sendMessage(s){if(r){Z.warn("[realtime/core] Session aborted, skipping message send");return}if(!n){Z.warn("[realtime/core] Data channel not ready, cannot send message");return}if(n.readyState!=="open"){Z.warn(`[realtime/core] Data channel not open (state: ${n.readyState}), cannot send message`);return}try{n.send(JSON.stringify(s))}catch(a){throw new pr("VOICE_SESSION_DATA_CHANNEL_FAILED",{message:"[realtime/core] Failed to send data channel message",cause:a instanceof Error?a:void 0})}},disconnect(){n?.close(),n=null,t?.close(),t=null,r=!1},isAborted(){return r},abort(){r=!0}}}const TWe="pplx_debug_mode";class AWe{session=null;enabled=!1;constructor(){this.setupGlobalFunctions()}isDebugMode(){return typeof window>"u"?!1:yt.getItem(TWe)==="true"}isInternalUser(t){return t?.endsWith("@perplexity.ai")??!1}setupGlobalFunctions(){typeof window>"u"||(window.__voiceDebugDownload=()=>{this.downloadAsFile()})}startSession(t){const n=this.isDebugMode(),r=this.isInternalUser(t.userEmail);if(!n||!r){Z.debug("[voice-debug] disabled",{debugMode:n,internalUser:r}),this.enabled=!1;return}Z.debug("[voice-debug] enabled - starting session"),this.enabled=!0,this.session={sessionId:t.sessionId,requestId:t.requestId,startTime:Date.now(),config:t.config,events:[]},this.log("session","started",{sessionId:t.sessionId,requestId:t.requestId,config:t.config})}log(t,n,r){if(!this.enabled||!this.session)return;const s={timestamp:Date.now(),category:t,type:n,data:this.sanitizeData(r)};this.session.events.push(s),Z.debug(`[voice-debug] ${t}:${n}`,r)}setCometPayload(t){!this.enabled||!this.session||(this.session.cometPayload=this.sanitizeData(t),this.log("comet","payload_set",{payloadSize:JSON.stringify(t).length}))}logMessage(t,n){this.enabled&&this.log("message",t,n)}logWebRTCState(t,n){this.enabled&&this.log("webrtc",t,n)}logError(t){this.enabled&&this.log("error","error",{message:t instanceof Error?t.message:String(t),stack:t instanceof Error?t.stack:void 0})}endSession(t){!this.enabled||!this.session||this.log("session","ended",{reason:t,duration:Date.now()-this.session.startTime,totalEvents:this.session.events.length})}sanitizeData(t){try{return JSON.parse(JSON.stringify(t))}catch{return{_error:"Could not serialize data",type:typeof t}}}downloadAsFile(){if(!this.session)return;const t=JSON.stringify(this.session,null,2),n=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download=`voice-debug-${this.session.sessionId}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}}const Xs=new AWe;function NWe(e){let t=0,n=!1,r=null;const s=()=>{n&&(n=!1,r&&clearTimeout(r),e.setSuppressed(!1))};return{onTranscriptDelta(){!n&&t===0&&(n=!0,e.setSuppressed(!0),r=setTimeout(s,_ce)),n&&(t++,t>=vce&&s())},destroy(){s()}}}function RWe(e){return e.type==="function_call"}function V9(e){return e.type!=="function_call"}const DWe=new Set(["session.created","input_audio_buffer.speech_started","input_audio_buffer.committed","conversation.item.done","conversation.item.input_audio_transcription.completed","response.output_audio.delta","response.output_audio_transcript.delta","response.output_audio.done","response.output_audio_transcript.done","response.done"]);function IWe(e){try{const t=JSON.parse(e.data);return!t.type||typeof t.type!="string"?(Z.warn("[realtime/eventParser] Message missing type field:",t),null):DWe.has(t.type)?t:null}catch{return Z.warn("[realtime/eventParser] Failed to parse message:",e.data),null}}const jWe={chunkSize:wce,maxChunks:Sce};function lq(e,t={}){const{chunkSize:n,maxChunks:r}={...jWe,...t},s=[];for(let i=0;i<e.length;i+=n)s.push(e.substring(i,i+n));const a=s.length>r;return{chunks:a?s.slice(0,r):s,isTruncated:a,originalLength:e.length}}async function cq({chunks:e,batchId:t,sendMessage:n,alertType:r,contentType:s}){for(let a=0;a<e.length;a++)await Promise.resolve(),n({type:"conversation.item.create",item:{type:"message",role:"system",content:[{type:"input_text",text:[`**Alert**: ${r} batch update`,`- batch_id: ${t}`,`- type: ${s}`,`- chunk: ${a+1} of ${e.length}`,`- content: ${e[a]}`].join(`
`)}]}})}async function G9({content:e,config:t={},sendMessage:n,alertType:r,contentType:s,context:a={}}){const{chunks:o,isTruncated:i,originalLength:c}=lq(e,t),u=crypto.randomUUID(),d=Object.entries(a).map(([m,p])=>`- ${m}: ${p}`);return n({type:"conversation.item.create",item:{type:"message",role:"system",content:[{type:"input_text",text:[`**Alert**: ${r}`,...d,`- batch_id: ${u}`,`- chunk_count: ${o.length}`,i?"- note: content has been truncated":""].filter(Boolean).join(`
`)}]}}),await cq({chunks:o,batchId:u,sendMessage:n,alertType:r,contentType:s}),{batchId:u,chunkCount:o.length,isTruncated:i,originalLength:c}}async function N2({content:e,config:t={},sendMessage:n,callId:r,toolName:s}){const{chunks:a,isTruncated:o,originalLength:i}=lq(e,t),c=crypto.randomUUID();return n({type:"conversation.item.create",item:{type:"function_call_output",call_id:r,output:JSON.stringify({type:"chunked_response",batch_id:c,total_chunks:a.length,truncated:o,message:`Results are being sent in ${a.length} chunks. Process all chunks before responding.`})}}),await cq({chunks:a,batchId:c,sendMessage:n,alertType:s,contentType:`${s}_chunk`}),n({type:"response.create"}),{batchId:c,chunkCount:a.length,isTruncated:o,originalLength:i}}const uq=({sendData:e,call_id:t,output:n})=>{e({type:"conversation.item.create",item:{type:"function_call_output",call_id:t,output:JSON.stringify(n)}}),e({type:"response.create"})},z9=({sendData:e,name:t,call_id:n})=>{uq({sendData:e,call_id:n,output:{result:`${t} tool call failed and we could not recover.`}})},PWe=(e,t)=>{const n=Object.values(go);return!!e&&n.includes(t)},OWe=async({cometBrowser:e,payload:t,step_uuid:n})=>{const r=t.pages.map(s=>({url:s.url,id:s.browser_tab_id}));return e.GetContent({pages:r,key:n})},LWe=async({cometBrowser:e,payload:t,step_uuid:n})=>e.closeTabs({tabIds:(t?.tab_ids??[]).map(r=>parseInt(r))},n,ey),FWe=async({cometBrowser:e,payload:t,step_uuid:n})=>{const r=t.tab_groups[0]??{};return e.groupTabs({tabIds:(r?.tab_ids??[]).map(s=>parseInt(s)),title:r?.title??"",collapsed:r?.collapsed??!1,color:r?.color??"blue"},n,ey)},UWe=async({cometBrowser:e,payload:t,step_uuid:n})=>e.openTab({tabId:t?.tab_id,url:t?.url??"",key:n,request_id:ey}),BWe=async({cometBrowser:e,payload:t,step_uuid:n})=>{const r=t?.search_scope??[],s=t?.time_filter?.start,a=t?.time_filter?.end,o=s?ok(new Date(s)):void 0,i=a?ok(new Date(a)):void 0;return e.SearchBrowser({key:n,request_id:"",queries:t?.queries??[],start_time:o,end_time:i,sources:r.reduce((c,u)=>{switch(u){case Zh.ActiveTabs:c.push("OPEN_TABS");break;case Zh.BrowsingHistory:c.push("HISTORY"),c.push("RECENTLY_CLOSED_TABS");break}return c},[]),history_max_results:t?.max_results??100,open_tabs_max_results:t?.max_results??100,closed_tabs_max_results:t?.max_results??100})},HWe=async({cometBrowser:e,payload:t,step_uuid:n})=>e.ungroupTabs({groupIds:(t.group_ids??[]).map(r=>parseInt(r)),tabIds:(t.tab_ids??[]).map(r=>parseInt(r))},n,ey),VWe=async({cometBrowser:e,name:t,call_id:n,args:r,sendData:s})=>{if(!e)throw new Error("[realtime] cometBrowser undefined");const a=mi(),o=JSON.parse(r)??{},i={cometBrowser:e,payload:o,step_uuid:n};let c=null;switch(t){case go.BrowserGetUrlContent:{c=await OWe(i);break}case go.CloseBrowserTabs:{c=await LWe(i);break}case go.GroupOpenBrowserTabs:{c=await FWe(i);break}case go.OpenNewBrowserTab:{c=await UWe(i);break}case go.SearchBrowser:{c=await BWe(i);break}case go.UngroupOpenBrowserTabs:{c=await HWe(i);break}default:Z.warn("[realtime] No support for tool:",t);break}uq({sendData:s,call_id:n,output:c}),a.addTiming(`ppl.${ft}.tool_call`,{toolName:t})},Gi="[realtime] Session aborted during tool execution, skipping response";async function GWe(e,t,n){if(t.abortSignal.aborted)return;const{onWebResults:r,onTerminate:s,onToolComplete:a}=n??{},o=Date.now();try{switch(e.name){case"search_web":{const i=await Zz({sessionId:t.sessionId,source:t.source,args:e.args,reason:t.reason,requestId:t.requestId});if(t.abortSignal.aborted){Z.debug(Gi);return}const c=(i?.web_results??[]).slice(0,TP);r?.(c);const u=Xz(c);if(await N2({content:u,sendMessage:t.sendMessage,callId:e.callId,toolName:"search_web"}),t.abortSignal.aborted){Z.debug(Gi);return}a?.(e.name,{result:"successful"},o,e.args.length,u.length);break}case"search_video":{const i=await uWe({sessionId:t.sessionId,source:t.source,args:e.args,reason:t.reason,requestId:t.requestId});if(t.abortSignal.aborted){Z.debug(Gi);return}const c=lWe(i);if(await N2({content:c,sendMessage:t.sendMessage,callId:e.callId,toolName:"search_video"}),t.abortSignal.aborted){Z.debug(Gi);return}a?.(e.name,{result:"successful"},o,e.args.length,c.length);break}case"query_video":{const i=await dWe({sessionId:t.sessionId,source:t.source,args:e.args,reason:t.reason,requestId:t.requestId});if(t.abortSignal.aborted){Z.debug(Gi);return}const c=cWe(i);if(await N2({content:c,sendMessage:t.sendMessage,callId:e.callId,toolName:"query_video"}),t.abortSignal.aborted){Z.debug(Gi);return}a?.(e.name,{result:"successful"},o,e.args.length,c.length);break}case"terminate":{a?.(e.name,{result:"successful"},o,e.args.length,0),s?.();break}default:if(PWe(t.cometBrowser??null,e.name)){if(await VWe({cometBrowser:t.cometBrowser??null,name:e.name,call_id:e.callId,args:e.args,sendData:t.sendMessage}),t.abortSignal.aborted){Z.debug(Gi);return}a?.(e.name,{result:"successful"},o,e.args.length,0)}else Z.warn("[tool-executor] Unknown tool:",e.name),z9({sendData:t.sendMessage,name:e.name,call_id:e.callId}),a?.(e.name,{result:"failed",errorReason:"Unknown tool"},o,e.args.length,0)}}catch(i){const c=i instanceof Error?i.message:String(i);Z.error(new rq("TOOL_CALL_FAILED",{details:{name:e.name,callId:e.callId,sessionId:t.sessionId},cause:i})),t.abortSignal.aborted||z9({sendData:t.sendMessage,name:e.name,call_id:e.callId}),a?.(e.name,{result:"failed",errorReason:c},o,e.args.length,0)}}const zWe=-1;function qWe(e){const{voiceState:t,getEntryStore:n,sessionMetrics:r,onTranscriptDelta:s}=e;return async a=>{const o=IWe(a);if(o)try{switch(o.type){case"session.created":{const i=o.session?.id;i&&t.createSession(i);break}case"input_audio_buffer.speech_started":{t.startUserSpeech();break}case"input_audio_buffer.committed":{t.endUserSpeech();const i=o.item_id??"";t.setLastInputAudioItemId(i),n()?.createEntry(i),r?.recordUserTurn();break}case"conversation.item.done":{const i=o.previous_item_id;if(!i)break;const u=n()?.getEntries()??[],d=u.findIndex(m=>m.inputAudioItemId===i||m.outputAudioItemId===i);d>=0&&u[d]!==void 0&&(u[d].outputAudioItemId=o.item?.id||"");break}case"conversation.item.input_audio_transcription.completed":{const i=o.item_id,c=o.transcript||"",d=n()?.getEntries()??[],m=d.findIndex(p=>p.inputAudioItemId===i);if(m>=0&&d[m]!==void 0){const p=d[m];p.transcription_usage=o.usage,p.query=c}else Jt(`ppl.${ft}.transcript_assign_failed`,{});break}case"response.output_audio_transcript.delta":{const i=o.delta||"";t.receiveTranscriptDelta(i),s?.();break}case"response.done":{const i=o.response;if(!i?.output?.length)break;const c=i.output.filter(RWe).find(p=>p.status==="completed");c&&await $We({callId:c.call_id,name:c.name,args:c.arguments},c.id,e);const u=i.output[0];u&&V9(u)&&!c&&r?.recordAssistantTurn(),i.usage&&r?.recordUsage(i.usage);const m=u?.id;if(m){const p=n(),h=p?.getEntries()??[],g=h.findIndex(b=>b.outputAudioItemId===m),y=g>=0?h[g]:void 0;if(y){const b=i.usage;y.answer=V9(u)&&u.content?.[0]?.transcript||"",c?y.tool_call_usage=b??null:y.usage=b??null,y.hasResponseDone=!0,b||(Z.warn("[message-handler] response.done event has no usage data",{contentId:m,responseStatus:i.status,statusDetails:i.status_details}),Jt(`ppl.${ft}.response_done_missing_usage`,{status:i.status})),await p?.checkSendEntry(g)}else Z.warn("[message-handler] response.done cannot find entry by outputAudioItemId",{contentId:m,availableEntries:h.map(b=>({inputAudioItemId:b.inputAudioItemId,outputAudioItemId:b.outputAudioItemId}))}),Jt(`ppl.${ft}.response_done_entry_not_found`,{})}break}}}catch(i){Z.warn("[message-handler] Error processing event:",o.type,i)}}}async function $We(e,t,n){const{voiceState:r,getEntryStore:s,getSendMessage:a,destroySession:o,toolConfig:i,sessionMetrics:c}=n;switch(e.name){case"search_web":case"search_video":r.startThinking("quick_search");break;case"query_video":r.startThinking("querying_video");break}const u=r.abortController?.signal??new AbortController().signal,d=a(),m=s()?.getEntries()??[],p=t?m.find(g=>g.outputAudioItemId===t):void 0,h={sessionId:r.openaiSessionId??"",pplxSessionId:i.pplxSessionId,sendMessage:g=>d?.(g),abortSignal:u,cometBrowser:i.cometBrowser,source:i.source,reason:i.reason,requestId:i.requestId,modelName:r.modelName??"",trackEvent:i.trackEvent};try{await GWe(e,h,{onWebResults:g=>{s()?.setWebResults(g),r.completeThinking(g)},onTerminate:()=>{o("llm_terminate")},onToolComplete:(g,y,b,x,_)=>{const v=Qz(g),C=Date.now()-b,w=y.result==="successful",S=r.modelName??"";if(Is(`ppl.${ft}.execute_tool`,{startTime:b,duration:C,success:w,toolName:v}),c?.recordToolCall({name:v,inputLength:x,outputLength:_,durationMs:C,success:w}),p?.entryUuid&&p?.createdAt){IC({name:g,result:y,trackEvent:i.trackEvent,entryMetadata:{entryUuid:p.entryUuid,createdAt:p.createdAt,userId:p.userId??zWe},uuid:i.pplxSessionId,pplxSessionId:i.pplxSessionId,modelName:S,inputLength:x,outputLength:_,cometSurface:i.cometSurface});return}if(p){p.pendingToolCalls||(p.pendingToolCalls=[]),p.pendingToolCalls.push({name:g,...y,trackEvent:i.trackEvent,uuid:i.pplxSessionId,pplxSessionId:i.pplxSessionId,modelName:S,inputLength:x,outputLength:_,cometSurface:i.cometSurface});return}const E=i.getCurrentEntryMetadata?.();E&&IC({name:g,result:y,trackEvent:i.trackEvent,entryMetadata:E,uuid:i.pplxSessionId,pplxSessionId:i.pplxSessionId,modelName:S,inputLength:x,outputLength:_,cometSurface:i.cometSurface})}}),r.thinkingStatus!=="idle"&&r.completeThinking([])}catch(g){Z.error("[message-handler] Tool execution error:",g),r.completeThinking([])}}const q9="youtube.com",WWe="youtu.be";function dq(e){try{const t=new URL(e),n=t.hostname.toLowerCase();if(n===WWe){const a=t.pathname.split("/").filter(Boolean)[0];return a?`https://www.youtube.com/watch?v=${a}`:null}if(!(n===q9||n.endsWith(`.${q9}`))||t.pathname!=="/watch")return null;const s=t.searchParams.get("v");return s?`https://www.youtube.com/watch?v=${s}`:null}catch{return null}}function KWe(e){return dq(e)!==null}const YWe={id:"default",pageChangeFilter:"ALL"},QWe={id:"youtube_watch",pageChangeFilter:"VIEWPORT"};function XWe(e){return KWe(e)?QWe:YWe}const ZWe="chrome://newtab/",JWe="page_content_chunk",eKe="video_context_chunk",tKe="This content represents what's currently visible in the user's viewport";function nKe({tabId:e,url:t,pageContent:n}){const r=t===ZWe;return{agentContext:!n.trim()&&!r?{tabId:-1,url:""}:{tabId:e,url:t}}}function $9(e){return e<1e3?"0-1k":e<3e3?"1k-3k":e<6e3?"3k-6k":e<9e3?"6k-9k":e<25e3?"9k-25k":e<1e5?"25k-100k":"100k+"}function rKe({cometBrowser:e,requestId:t,sendMessage:n,sessionMetrics:r,sessionId:s,source:a,reason:o}){async function i({tabId:u,url:d,filter:m}){const p=mi(),g=(await e.GetContent({pages:[{url:d,id:u}],key:t,filter:m})).contents?.[0]?.markdown??"",{agentContext:y}=nKe({tabId:u,url:d,pageContent:g}),b=m==="VIEWPORT",x=await G9({content:g,sendMessage:n,alertType:b?"viewport content updated":"active page changed",contentType:JWe,context:{"active tab id":y.tabId,url:y.url,...b&&{note:tKe}}});p.addTiming(`ppl.${ft}.page_context_sync.duration`,{content_length:$9(g.length),truncated:x.isTruncated}),r?.recordPageContextSync({charLength:g.length,truncated:x.isTruncated})}async function c(u){const d=dq(u);if(!d)return;const m=mi();try{const p=await EP({body:{session_id:s,video_url:d,query:"",source:a},reason:o,requestId:t}),h=p?.summary??"";if(!h)return;await G9({content:h,sendMessage:n,alertType:"preliminary video context synced",contentType:eKe,context:{video_url:d,...p?.title?{video_title:p.title}:{}}}),m.addTiming(`ppl.${ft}.youtube_context_sync.duration`,{content_length:$9(h.length)})}catch(p){Z.error("[realtime] Failed to sync YouTube video context:",p)}}return{async sync(u,d,{trigger:m}){if(!e||!t)return;const p=XWe(d),h=m==="viewport"?"VIEWPORT":p.pageChangeFilter;await i({tabId:u,url:d,filter:h}),p.id==="youtube_watch"&&await c(d)}}}async function sKe(e,t,n,r){const s=await e.createOffer();if(r?.addTiming(`${ft}.sdp_offer_created`),n?.aborted)return Z.debug("[sdp-exchange] [realtime] Session aborted before setLocalDescription, skipping"),{success:!1,reason:"aborted"};if(await e.setLocalDescription(s),r?.addTiming(`${ft}.local_description_set`),!s.sdp)throw new pr("VOICE_SESSION_SDP_EXCHANGE_FAILED",{message:"SDP offer is missing"});const a={sdp:s.sdp,source:t.source,voice:t.voice,timezone:t.timezone,turn_detection_threshold:t.turnDetectionThreshold,response_language:t.language,client_payload_cache_key:t.clientPayloadCacheKey,input_audio_noise_reduction:t.inputAudioNoiseReduction},o=await xce({body:a,reason:"realtime-sdp-exchange"});if(r?.addTiming(`${ft}.backend_session_created`),n?.aborted)return Z.debug("[sdp-exchange] Aborted after backend call"),{success:!1,reason:"aborted"};if(o.status===429)return Z.warn("[sdp-exchange] Rate limit exceeded"),{success:!1,reason:"rate_limited",statusCode:429};if(o.status===401)return Z.warn("[sdp-exchange] Authentication failed"),{success:!1,reason:"auth_error",statusCode:401,message:"Authentication failed"};if(o.status===403)return Z.warn("[sdp-exchange] Access denied"),{success:!1,reason:"auth_error",statusCode:403,message:"Access denied"};if(o.error||!o.data){const u=o.error??"Failed to create realtime session";return Z.error("[sdp-exchange] Session creation failed:",u),{success:!1,reason:"error",statusCode:o.status,message:u}}const i=o.data.sdp;if(!i)throw new pr("VOICE_SESSION_SDP_EXCHANGE_FAILED",{message:"Backend response missing SDP answer"});const c={type:"answer",sdp:i};return n?.aborted?(Z.debug("[sdp-exchange] Aborted before setRemoteDescription"),{success:!1,reason:"aborted"}):(await e.setRemoteDescription(c),r?.addTiming(`${ft}.remote_description_set`),{success:!0,sdpAnswer:i,modelName:o.data.model_name})}async function aKe(e,t,n,r){const s=await sKe(e,t,n,r);if(s.success)return{modelName:s.modelName};switch(s.reason){case"aborted":return null;case"rate_limited":throw new pr("VOICE_SESSION_RATE_LIMITED",{message:"Rate limit exceeded",details:{statusCode:s.statusCode}});case"auth_error":throw new pr(s.statusCode===403?"VOICE_SESSION_FORBIDDEN":"VOICE_SESSION_AUTH_ERROR",{message:s.message??"Authentication failed",details:{statusCode:s.statusCode}});case"error":throw new pr("VOICE_SESSION_SDP_EXCHANGE_FAILED",{message:s.message??"SDP exchange failed",details:{statusCode:s.statusCode}})}}function oKe(e){const{trackEvent:t,pplxSessionId:n,cometSurface:r}=e,s=[],a=[],o=[];let i=0,c=0;return{recordToolCall(u){s.push(u),Jt(`ppl.${ft}.tool.output_length`,{value:u.outputLength,tool_name:u.name})},recordUserTurn(){i++},recordAssistantTurn(){c++},recordPageContextSync(u){a.push(u),Jt(`ppl.${ft}.page_context.sync`,{char_length:u.charLength,truncated:u.truncated})},recordUsage(u){o.push(u)},flush(){let u=0,d=0,m=0,p=0,h=0,g=0,y=0,b=0,x=0,_=0;for(const C of a)_+=C.charLength;let v=0;for(const C of s)v+=C.outputLength;for(const C of o)u+=C.total_tokens,d+=C.input_tokens??0,m+=C.output_tokens??0,p+=C.input_token_details?.cached_tokens??0,h+=C.input_token_details?.text_tokens??0,g+=C.input_token_details?.audio_tokens??0,y+=C.output_token_details?.text_tokens??0,b+=C.output_token_details?.audio_tokens??0,x=Math.max(x,C.input_tokens??0);Jt(`ppl.${ft}.session.user_turns`,{value:i}),Jt(`ppl.${ft}.session.assistant_turns`,{value:c}),Jt(`ppl.${ft}.session.tool_call_count`,{value:s.length}),Jt(`ppl.${ft}.session.total_tool_output_length`,{value:v}),o.length>0&&(Jt(`ppl.${ft}.session.total_tokens_consumed`,{value:u}),Jt(`ppl.${ft}.session.input_tokens_consumed`,{value:d}),Jt(`ppl.${ft}.session.output_tokens_consumed`,{value:m}),Jt(`ppl.${ft}.session.peak_input_tokens`,{value:x}),Jt(`ppl.${ft}.session.cached_tokens`,{value:p}),Jt(`ppl.${ft}.session.input_audio_tokens`,{value:g}),Jt(`ppl.${ft}.session.output_audio_tokens`,{value:b})),Jt(`ppl.${ft}.session.page_context_syncs`,{value:a.length}),Jt(`ppl.${ft}.session.total_page_context_chars`,{value:_}),t("voice session summary",{pplx_session_id:n,user_turns:i,assistant_turns:c,response_done_count:o.length,tool_call_count:s.length,total_tool_output_length:v,page_context_syncs:a.length,total_page_context_chars:_,total_tokens_consumed:u,input_tokens_consumed:d,output_tokens_consumed:m,peak_input_tokens:x,cached_tokens:p,input_text_tokens:h,input_audio_tokens:g,output_text_tokens:y,output_audio_tokens:b,comet_surface:r})}}}function iKe(e){const t=crypto.randomUUID(),n=crypto.randomUUID(),r=Yz(),s=tq(),a=Kz(),o=Wz({voiceEvents:r}),i=nq({voiceEvents:r}),c=new Audio,u=e.trackEvent;c.autoplay=!0;let d=null,m=null,p=null,h=null,g=null,y=null,b=null,x=null;s.setErrorHandler(v=>{Xs.logError(v),i.abortController?.abort(),i.setAbortController(null),a.release(),o.stop(),c.srcObject=null,d?.disconnect(),d=null,y?.destroy(),y=null,Ih(u,{connection_status:"failed to connect",reason:v instanceof Error?v.message:String(v),error_code:v instanceof pr?v.code:void 0,comet_surface:e.cometSurface}),i.setError(DC(v)),i.transition("error")});const _={get id(){return t},get connectionState(){return i.connectionState},get entries(){return m?.getEntries()??[]},get transcript(){return i.transcript},get isMuted(){return i.isMuted},get isAudioOutputMuted(){return c.muted},get isUserSpeaking(){return i.isUserSpeaking},get isVoiceAssistantSpeaking(){return i.isVoiceAssistantSpeaking},get thinkingStatus(){return i.thinkingStatus},get isAudioReady(){return i.isAudioReady},get error(){return i.error},get webResults(){return i.webResults},get audioLevel(){return o.level},start(){const v=Date.now(),C=mi();Jt(`ppl.${ft}.voice.started`,{}),u("start voice mode",{comet_surface:e.cometSurface}),i.connectionState==="idle"&&(i.transition("connecting"),Xs.startSession({sessionId:t,requestId:n,config:{source:e.source,voice:e.voice,language:e.language,timezone:e.timezone},userEmail:e.userEmail}),s.enqueue(async()=>{C.addTiming(`${ft}.queue_started`),i.setAbortController(new AbortController);const w=eq({voiceState:i,destroySession:L=>_.destroy(L),trackEvent:u,source:e.source,platform:e.platform,cometSurface:e.cometSurface});let S=!1;const E=a.acquire(w).then(({stream:L,wasPreGranted:H})=>(S=H,C.addTiming(`${ft}.microphone_ready`,{mic_pre_granted:H}),L)),T=mn()&&e.cometBrowser&&e.cometState?HC({clientPayloadCacheKey:n,cometBrowser:e.cometBrowser,maxChars:5e4,includeSidecar:!0,attachedTabs:[],reason:e.reason,cometState:e.cometState}).then(L=>(C.addTiming(`${ft}.comet_payload_ready`),Xs.setCometPayload({clientPayloadCacheKey:n,maxChars:5e4,includeSidecar:!0,reason:e.reason,cometStateKeys:e.cometState?Object.keys(e.cometState):[]}),L)):Promise.resolve(),[k]=await Promise.all([E,T]);C.addTiming(`${ft}.parallel_setup_ready`,{mic_pre_granted:S});const M=Ece(k.getAudioTracks()[0]?.label??"");o.setUserStream(k),o.start(),e.enablePreConnectBuffer&&(y=kWe(),y.start(k),i.setAudioReady(!0),C.addTiming(`${ft}.audio_ready_buffered`,{mic_pre_granted:S})),m=SWe({voiceEvents:r,pplxSessionId:t,getOpenAISessionId:()=>i.openaiSessionId??`uuid_${n}`,language:e.language,getModelName:()=>i.modelName,source:e.source,platform:e.platform,reason:e.reason,trackEvent:u,requestId:n,cometSurface:e.cometSurface}),h=oKe({trackEvent:u,pplxSessionId:t,cometSurface:e.cometSurface});const N=qWe({voiceState:i,getEntryStore:()=>m,getSendMessage:()=>L=>{Xs.logMessage("outgoing",L),d?.sendMessage(L)},destroySession:L=>_.destroy(L),toolConfig:{cometBrowser:e.cometBrowser,source:e.source,reason:e.reason,requestId:n,trackEvent:u,pplxSessionId:t,cometSurface:e.cometSurface},sessionMetrics:h,onTranscriptDelta:()=>g?.onTranscriptDelta()});if(i.abortController?.signal.aborted){a.release(),y?.destroy(),y=null;return}d=MWe({onMessage:async L=>{try{const H=JSON.parse(L.data);Xs.logMessage("incoming",H)}catch{Xs.logMessage("incoming",{raw:L.data})}return N(L)},onConnectionStateChange:L=>{Xs.logWebRTCState(L),L==="connected"&&(C.addTiming(`${ft}.ice_connected`,{mic_pre_granted:S}),y?a.setSuppressed(!0):i.setAudioReady(!0)),(L==="failed"||L==="disconnected")&&(y&&a.setSuppressed(!1),i.setAudioReady(!1),i.canTransition("error")&&(i.setError(new pr("VOICE_SESSION_CONNECTION_FAILED",{message:`WebRTC connection ${L}`})),i.transition("error")))},onTrack:L=>{o.setVoiceAssistantStream(L),c.srcObject=L,c.play().catch(H=>{Z.warn("[realtime] Audio autoplay blocked:",H)})},onDataChannelOpen:()=>{x=Date.now(),C.addTiming(`${ft}.data_channel_open`,{mic_pre_granted:S}),Xs.log("webrtc","data_channel_open",{timeToOpen:Date.now()-v}),g=NWe(a),y&&(y.stop(),y.flush(L=>d?.sendMessage(L)),y=null,a.setSuppressed(!1)),i.canTransition("connected")&&i.transition("connected"),Ih(u,{connection_status:"connected",model_name:i.modelName??"unknown",language:e.language,voice:e.voice,active_noise_reduction:M??"none",time_to_voice_ready_ms:Date.now()-v,mic_pre_granted:S,comet_surface:e.cometSurface})},onDataChannelClose:()=>{const L=x?Date.now()-x:null;Xs.log("webrtc","data_channel_close",{sessionDuration:L}),Ih(u,{connection_status:"closed",voice_session_duration_ms:L,comet_surface:e.cometSurface}),x=null}}),d.createConnection(k),d.createDataChannel("oai-events");const P=d.getPeerConnection();p=rKe({cometBrowser:e.cometBrowser,requestId:n,sendMessage:L=>{Xs.logMessage("outgoing",L),d?.sendMessage(L)},sessionMetrics:h,sessionId:t,source:e.source,reason:e.reason});const O=await aKe(P,{source:e.source,voice:e.voice,timezone:e.timezone,turnDetectionThreshold:MP,language:e.language,clientPayloadCacheKey:n,inputAudioNoiseReduction:M},i.abortController?.signal??new AbortController().signal,C);if(O===null){o.stop(),a.release(),d.disconnect(),d=null,y?.destroy(),y=null,i.reset();return}C.addTiming(`${ft}.sdp_answered`,{mic_pre_granted:S}),b=Date.now(),C.addTiming(`${ft}.started`,{mic_pre_granted:S}),i.setModelName(O.modelName??null),e.cometBrowser?.voiceAssistantNotifyConnected()}))},destroy(v="unmount"){s.enqueue(async()=>{if(Xs.endSession(v),i.canTransition("disconnecting")&&i.transition("disconnecting"),i.setAudioReady(!1),m&&(await m.flushPreviousEntry(),m.reset(),m=null),i.abortController?.abort(),i.setAbortController(null),d?.abort(),o.stop(),a.release(),c.srcObject=null,d?.disconnect(),d=null,g?.destroy(),g=null,y?.destroy(),y=null,i.canTransition("disconnected")?i.transition("disconnected"):i.reset(),v!=="settings_change"&&e.cometBrowser?.voiceAssistantStop(),b){const C=Date.now()-b;$z(u,v,e.cometSurface),Is(`ppl.${ft}.voice.stopped`,{startTime:b,duration:C}),h?.flush()}h=null,b=null})},mute(){a.setMuted(!0),i.setMuted(!0)},unmute(){a.setMuted(!1),i.setMuted(!1)},toggleMute(){const v=!i.isMuted;a.setMuted(v),i.setMuted(v)},muteAudioOutput(){c.muted=!0,r.emit("audio_output_muted_changed",!0)},unmuteAudioOutput(){c.muted=!1,r.emit("audio_output_muted_changed",!1)},async syncPageContext(v,C,w){await p?.sync(v,C,w)},on(v,C){return r.on(v,C)}};return _}function W9(e){const{provider:t,...n}=e;switch(t){case"openai":return iKe(n);case"livekit":return bWe(n);default:throw new Error(`Unknown voice provider: ${t}`)}}function NQe(){return S5.useStore()}function K9(e,t){const n=[e.on("connection_state_changed",r=>{t({connectionState:r})}),e.on("audio_ready_changed",r=>{t({isAudioReady:r})}),e.on("user_speaking_changed",r=>{t({isUserSpeaking:r})}),e.on("voice_assistant_speaking_changed",r=>{t({isVoiceAssistantSpeaking:r})}),e.on("voice_assistant_transcript_changed",r=>{t({voiceAssistantTranscript:r})}),e.on("thinking_status_changed",r=>{t({thinkingStatus:r})}),e.on("muted_changed",r=>{t({isMuted:r})}),e.on("audio_output_muted_changed",r=>{t({isAudioOutputMuted:r})}),e.on("audio_level_changed",r=>{t({audioLevel:r})}),e.on("web_results_changed",r=>{t({webResults:r})}),e.on("entry_committed",()=>{t({hasCreatedEntry:!0})}),e.on("error",r=>{t({error:r})})];return()=>{n.forEach(r=>r())}}const S5=du("RealtimeVoiceCoreContext",()=>vi((e,t)=>({session:null,unbindEvents:null,connectionState:"idle",isAudioReady:!1,isUserSpeaking:!1,isVoiceAssistantSpeaking:!1,voiceAssistantTranscript:"",thinkingStatus:"idle",isMuted:!1,isAudioOutputMuted:!1,audioLevel:0,webResults:[],hasCreatedEntry:!1,error:null,actions:{startSession:n=>{const r=t();if(r.session!==null)return;r.unbindEvents?.();const s=W9(n),a=K9(s,e);e({session:s,unbindEvents:a,connectionState:s.connectionState,isAudioReady:!1,isUserSpeaking:!1,isVoiceAssistantSpeaking:!1,voiceAssistantTranscript:"",thinkingStatus:"idle",isMuted:!1,isAudioOutputMuted:!1,audioLevel:0,webResults:[],hasCreatedEntry:!1,error:null}),s.start()},endSession:n=>{const r=t();r.session!==null&&(r.session.destroy(n),r.unbindEvents?.(),e({session:null,unbindEvents:null,connectionState:"idle",isAudioReady:!1,isUserSpeaking:!1,isVoiceAssistantSpeaking:!1,voiceAssistantTranscript:"",thinkingStatus:"idle",isMuted:!1,isAudioOutputMuted:!1,audioLevel:0,webResults:[],error:null}))},restartSession:n=>{const r=t(),s=r.isMuted;r.session!==null&&(r.session.destroy("settings_change"),r.unbindEvents?.());const a=W9(n),o=K9(a,e);e({session:a,unbindEvents:o,connectionState:a.connectionState,isAudioReady:!1,isUserSpeaking:!1,isVoiceAssistantSpeaking:!1,voiceAssistantTranscript:"",thinkingStatus:"idle",isMuted:!1,isAudioOutputMuted:!1,audioLevel:0,webResults:[],hasCreatedEntry:!1,error:null}),a.start(),s&&a.mute()},mute:()=>{t().session?.mute()},unmute:()=>{t().session?.unmute()},toggleMute:()=>{t().session?.toggleMute()},muteAudioOutput:()=>{t().session?.muteAudioOutput()},unmuteAudioOutput:()=>{t().session?.unmuteAudioOutput()},syncPageContext:(n,r,s)=>t().session?.syncPageContext(n,r,s)??Promise.resolve()}}))),lKe=S5.Provider;function RQe(){const{connectionState:e,isAudioReady:t,isUserSpeaking:n,isVoiceAssistantSpeaking:r,voiceAssistantTranscript:s,thinkingStatus:a,isMuted:o,isAudioOutputMuted:i,webResults:c,hasCreatedEntry:u,error:d,actions:m}=S5.useTrackedState(),p=f.useMemo(()=>({startSession:m.startSession,endSession:m.endSession,restartSession:m.restartSession,mute:m.mute,unmute:m.unmute,toggleMute:m.toggleMute,muteAudioOutput:m.muteAudioOutput,unmuteAudioOutput:m.unmuteAudioOutput,syncPageContext:m.syncPageContext}),[m]);return{connectionState:e,isAudioReady:t,isUserSpeaking:n,isVoiceAssistantSpeaking:r,voiceAssistantTranscript:s,thinkingStatus:a,isMuted:o,isAudioOutputMuted:i,webResults:c,hasCreatedEntry:u,error:d,actions:p}}const cKe=Pe(async()=>{const{VoiceToVoiceContent:e}=await W(async()=>{const{VoiceToVoiceContent:t}=await import("./VoiceToVoiceContent-gCSq5tF8.js");return{VoiceToVoiceContent:t}},__vite__mapDeps([454,2,3,62,5,1,6,7,8,9,63,64,15,65,13,12,14,16,17]));return{default:e}},{loading:()=>l.jsx(Z0,{})}),uKe=A.memo(function(){const t=hn(),n=f.useCallback(()=>{t.push("/",void 0,"voice to sidecar")},[t]),r=wt(),s=pR();return f.useEffect(()=>{!r&&!s&&(window.open(oN("/auth/signin"),"_blank"),n())},[r,s,n]),!r||s?l.jsx(Z0,{}):l.jsx(cKe,{onClose:n})}),dKe=A.memo(function(){return l.jsx(dS,{withoutHeader:!0,disableOpenInTab:!0,children:l.jsx($D,{childrenWidth:"none",mobileHeader:!1,children:l.jsx(lKe,{children:l.jsx(uKe,{})})})})}),fKe={[HD]:{Component:sWe,modules:zee},"/speak":{Component:dKe,modules:_e},"/":{Component:PP,modules:VD}},mKe=A.memo(function(){return l.jsxs(f$,{children:[Object.entries(fKe).map(([t,{Component:n,modules:r}])=>l.jsx(B5,{path:t.startsWith("^")?new RegExp(t):t,children:l.jsx(H5,{modules:r,children:l.jsx(n,{})})},t)),l.jsx(B5,{children:l.jsx(H5,{modules:VD,children:l.jsx(PP,{})})})]})}),E5=[HD,"/speak","/"],k5="pplx-next-auth-session";let lh=null;const pKe=()=>{try{const e=yt.getItem(k5);return e?JSON.parse(e):null}catch{return null}},Y9=e=>{e&&yt.setItem(k5,JSON.stringify(e))},fq=()=>{yt.removeItem(k5)},hKe=(e=!1)=>{lh??=m$().then(n=>(n?Y9(n):fq(),n)).catch(n=>{throw(!(n instanceof p$)||n.code!=="AUTH_NO_STATUS_CODE_ERROR")&&Y9(null),n}).finally(()=>{lh=null});const t=pKe();return t&&(e||new Date(t.expires)>new Date)?{cachedSession:t,sessionFetchPromise:lh}:{cachedSession:null,sessionFetchPromise:lh}};async function gKe(){await UN(),await LD(),yt.keys().forEach(e=>{e.startsWith(ZR)&&yt.removeItem(e)}),fq()}function yKe(e,t){if(e?.pathname.startsWith("/sidecar"))return"sidecar";if(e?.pathname.startsWith("/mobile-sidecar"))return"mobile-sidecar";if(t)return"tab"}function xKe(){const{cachedSession:e,sessionFetchPromise:t}=hKe(),n=mn(),r=document.querySelector("meta[name='version']")?.getAttribute("content")||"",s=+(document.querySelector("meta[name='min-version']")?.getAttribute("content")||0),a=document.querySelector("meta[name='web-resources-build']")?.getAttribute("content")||"",o=new URL(window.location.href);return{cachedSession:e,sessionFetchPromise:t.then(i=>(e&&!i&&gKe().then(()=>{Jg("Auth changed")}),i)).catch(i=>(console.error("Error getting session",i),null)),config:{env:FW(),version:r,minVersion:s,webResourcesBuild:a,erp:yKe(o,n)}}}const vx="/sidecar",bKe=document.getElementById("root"),_Ke=Sq.createRoot(bKe),vKe=UW(vx),CKe=navigator.userAgent;function wKe(e,t){ik(KW),ik(pK,"pplx-logo-sprites"),_Ke.render(l.jsx(ar,{fallback:vKe,children:l.jsx(BW,{host:Q9,userAgent:CKe,session:t??void 0,children:l.jsxs(Pee,{hostname:Q9,buildTimestamp:e.minVersion,buildVersion:e.webResourcesBuild,spaRoutes:E5,shouldOpenNonSpaRouteInNewTab:!0,base:vx,buildVersionRefresh:!0,children:[l.jsx(hK,{}),l.jsx(mKe,{})]})})}))}const{config:Cx,cachedSession:qg,sessionFetchPromise:SKe}=xKe();window.__PPL_CONFIG__=Cx;const Q9=window.location.host;h$();qg&&BD({bootstrapConfig:Cx,user:qg.user,routes:E5,base:vx});wKe(Cx,qg);qg||SKe.then(e=>{BD({bootstrapConfig:Cx,user:e?.user,routes:E5,base:vx})});export{Ow as $,dL as A,y0 as B,hl as C,Rn as D,Qpe as E,Dl as F,zKe as G,GKe as H,Ht as I,un as J,er as K,Ba as L,z6e as M,GYe as N,Tw as O,fX as P,Ll as Q,uE as R,Tr as S,Nle as T,vu as U,lm as V,xo as W,FI as X,ui as Y,LO as Z,PO as _,Ze as a,Kf as a$,oQe as a0,CS as a1,da as a2,tw as a3,Xt as a4,e1e as a5,Zxe as a6,rYe as a7,ao as a8,xi as a9,kQe as aA,On as aB,MQe as aC,ft as aD,TQe as aE,EQe as aF,AQe as aG,MYe as aH,NQe as aI,Mce as aJ,Sn as aK,SQe as aL,RQe as aM,bee as aN,xs as aO,qd as aP,LD as aQ,h0 as aR,DK as aS,HKe as aT,VKe as aU,eo as aV,Zr as aW,oR as aX,HI as aY,CYe as aZ,Mt as a_,N9 as aa,fc as ab,IYe as ac,pYe as ad,to as ae,Ni as af,rO as ag,Xn as ah,Vye as ai,Qf as aj,oYe as ak,cF as al,jE as am,Uye as an,gl as ao,Io as ap,Ote as aq,EI as ar,b0 as as,Xye as at,BO as au,Xk as av,vS as aw,Je as ax,bf as ay,vf as az,cn as b,Oo as b$,fJ as b0,Gs as b1,Hs as b2,wu as b3,c0 as b4,zn as b5,pde as b6,WKe as b7,Exe as b8,Zw as b9,x0 as bA,Ul as bB,Qi as bC,eCe as bD,cie as bE,K as bF,Sf as bG,Xve as bH,Jve as bI,ba as bJ,rr as bK,bs as bL,Ay as bM,m2 as bN,NC as bO,tz as bP,dQe as bQ,QD as bR,Pt as bS,Pqe as bT,vQe as bU,Mi as bV,bx as bW,DUe as bX,ry as bY,zm as bZ,Mqe as b_,vde as ba,sP as bb,fYe as bc,rP as bd,Pl as be,ki as bf,Wf as bg,cYe as bh,lYe as bi,kYe as bj,Fxe as bk,Ixe as bl,lKe as bm,vP as bn,EYe as bo,Vs as bp,yr as bq,FSe as br,TYe as bs,Ole as bt,_P as bu,XVe as bv,PU as bw,SYe as bx,Zf as by,k0 as bz,yte as c,Nve as c$,ws as c0,NI as c1,k9 as c2,E9 as c3,_I as c4,bQe as c5,JF as c6,h5 as c7,jze as c8,Pz as c9,Qo as cA,Lw as cB,Fx as cC,Iue as cD,h_ as cE,AYe as cF,Lue as cG,Fse as cH,Cu as cI,jw as cJ,te as cK,DYe as cL,En as cM,gr as cN,Gd as cO,yZ as cP,zj as cQ,fE as cR,wQe as cS,BKe as cT,ro as cU,JI as cV,Fie as cW,qYe as cX,WYe as cY,$Ye as cZ,kR as c_,Fze as ca,Ao as cb,Un as cc,RC as cd,zg as ce,k2 as cf,Eze as cg,Wqe as ch,$qe as ci,uze as cj,CQe as ck,mF as cl,PR as cm,hD as cn,kw as co,OO as cp,Eme as cq,RYe as cr,jYe as cs,PYe as ct,Wi as cu,Ki as cv,gLe as cw,QKe as cx,l4 as cy,$Ke as cz,_te as d,mne as d$,ig as d0,FFe as d1,eE as d2,fl as d3,Zi as d4,bze as d5,pAe as d6,aF as d7,Nze as d8,Iz as d9,Ly as dA,ox as dB,UOe as dC,bF as dD,ZL as dE,Qw as dF,Lxe as dG,n6e as dH,qKe as dI,xR as dJ,Fw as dK,FAe as dL,LX as dM,UR as dN,R1e as dO,LE as dP,J0 as dQ,BR as dR,Gw as dS,iYe as dT,lE as dU,sYe as dV,FGe as dW,BGe as dX,une as dY,dne as dZ,fne as d_,dc as da,_Qe as db,E2 as dc,C9 as dd,xze as de,kze as df,Lz as dg,uS as dh,_Ge as di,kF as dj,MF as dk,abe as dl,Sh as dm,KYe as dn,YYe as dp,AT as dq,che as dr,QU as ds,Jue as dt,nYe as du,iQe as dv,C7e as dw,_l as dx,r3 as dy,Nm as dz,aYe as e,vYe as e$,Z_ as e0,Yf as e1,ZD as e2,xa as e3,Mw as e4,Yt as e5,eYe as e6,JKe as e7,ZKe as e8,rm as e9,Pse as eA,gre as eB,Jw as eC,zh as eD,QN as eE,xQe as eF,fQe as eG,pQe as eH,hQe as eI,mQe as eJ,T8 as eK,yQe as eL,Sze as eM,fa as eN,PE as eO,QYe as eP,_g as eQ,cQe as eR,B7e as eS,lQe as eT,K7e as eU,z7e as eV,$7e as eW,nl as eX,e3 as eY,mP as eZ,pR as e_,$w as ea,Jr as eb,Qqe as ec,Gn as ed,JT as ee,L1e as ef,Gve as eg,Yve as eh,Vve as ei,ZSe as ej,sEe as ek,Bve as el,nEe as em,ms as en,sa as eo,ay as ep,kI as eq,mYe as er,Jd as es,YKe as et,Do as eu,$h as ev,Xi as ew,Oue as ex,I0 as ey,TS as ez,Pme as f,ug as f$,Il as f0,ACe as f1,NCe as f2,LSe as f3,E0e as f4,ZE as f5,LM as f6,BCe as f7,E0 as f8,KSe as f9,tQe as fA,rQe as fB,nQe as fC,zSe as fD,_U as fE,ZYe as fF,IU as fG,JYe as fH,zOe as fI,uQe as fJ,qOe as fK,$Oe as fL,kG as fM,vg as fN,jEe as fO,FEe as fP,aQe as fQ,J_ as fR,LEe as fS,a3 as fT,Iy as fU,PB as fV,DB as fW,Lr as fX,uF as fY,$ye as fZ,nxe as f_,gU as fa,vU as fb,nt as fc,QCe as fd,hU as fe,jT as ff,XYe as fg,Os as fh,tG as fi,rx as fj,Hu as fk,So as fl,Fo as fm,ix as fn,aGe as fo,fx as fp,_i as fq,us as fr,ql as fs,tS as ft,Q1e as fu,mg as fv,YCe as fw,sQe as fx,BSe as fy,eQe as fz,p0 as g,UKe as g$,Bye as g0,dYe as g1,vH as g2,wR as g3,tYe as g4,f2 as g5,tI as g6,FO as g7,AF as g8,j_ as g9,wYe as gA,U2 as gB,oX as gC,XKe as gD,rce as gE,uw as gF,WI as gG,KI as gH,yie as gI,cw as gJ,zw as gK,Pw as gL,aX as gM,Uw as gN,Bw as gO,OR as gP,gX as gQ,GR as gR,xie as gS,DR as gT,oce as gU,YI as gV,ga as gW,xK as gX,SX as gY,jR as gZ,Bce as g_,gQe as ga,_Ue as gb,aQ as gc,FKe as gd,vne as ge,uYe as gf,kne as gg,wne as gh,WP as gi,Yme as gj,gde as gk,Qye as gl,zYe as gm,_Ye as gn,F2 as go,jk as gp,yc as gq,bYe as gr,hYe as gs,gYe as gt,yYe as gu,xYe as gv,KKe as gw,RR as gx,$2 as gy,Qre as gz,ya as h,NYe as h0,tE as h1,Ave as i,WO as j,Sme as k,YO as l,QO as m,XO as n,ZO as o,KO as p,eL as q,JO as r,rL as s,tL as t,wt as u,nL as v,sL as w,aL as x,R6e as y,s1 as z};
//# sourceMappingURL=https://pplx-static-sourcemaps.perplexity.ai/_sidecar/assets/index-D2xDM-At.js.map
